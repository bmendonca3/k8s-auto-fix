[
  {
    "id": "001",
    "manifest_path": "data/manifests/001.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: nginx-latest\n  namespace: default\nspec:\n  containers:\n    - name: nginx\n      image: nginx:latest\n      ports:\n        - containerPort: 80\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"nginx\" is using an invalid container image, \"nginx:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "002",
    "manifest_path": "data/manifests/001.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: nginx-latest\n  namespace: default\nspec:\n  containers:\n    - name: nginx\n      image: nginx:latest\n      ports:\n        - containerPort: 80\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"nginx\" does not have a read-only root file system"
  },
  {
    "id": "003",
    "manifest_path": "data/manifests/001.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: nginx-latest\n  namespace: default\nspec:\n  containers:\n    - name: nginx\n      image: nginx:latest\n      ports:\n        - containerPort: 80\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"nginx\" is not set to runAsNonRoot"
  },
  {
    "id": "004",
    "manifest_path": "data/manifests/001.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: nginx-latest\n  namespace: default\nspec:\n  containers:\n    - name: nginx\n      image: nginx:latest\n      ports:\n        - containerPort: 80\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"nginx\" has cpu request 0"
  },
  {
    "id": "005",
    "manifest_path": "data/manifests/001.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: nginx-latest\n  namespace: default\nspec:\n  containers:\n    - name: nginx\n      image: nginx:latest\n      ports:\n        - containerPort: 80\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"nginx\" has memory limit 0"
  },
  {
    "id": "006",
    "manifest_path": "data/manifests/001.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: nginx-latest\n  namespace: default\nspec:\n  containers:\n    - name: nginx\n      image: nginx:latest\n      ports:\n        - containerPort: 80\n",
    "policy_id": "check-requests-limits",
    "violation_text": "validation error: Containers must define resource requests and limits. rule check-requests-limits failed at path /spec/containers/0/resources/"
  },
  {
    "id": "007",
    "manifest_path": "data/manifests/001.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: nginx-latest\n  namespace: default\nspec:\n  containers:\n    - name: nginx\n      image: nginx:latest\n      ports:\n        - containerPort: 80\n",
    "policy_id": "check-runasnonroot",
    "violation_text": "validation error: Containers must set securityContext.runAsNonRoot=true. rule check-runasnonroot failed at path /spec/containers/0/securityContext/"
  },
  {
    "id": "008",
    "manifest_path": "data/manifests/002.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: privileged-pod\n  namespace: default\nspec:\n  containers:\n    - name: ubuntu\n      image: ubuntu:22.04\n      securityContext:\n        privileged: true\n      command: [\"sleep\", \"3600\"]\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"ubuntu\" does not have a read-only root file system"
  },
  {
    "id": "009",
    "manifest_path": "data/manifests/002.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: privileged-pod\n  namespace: default\nspec:\n  containers:\n    - name: ubuntu\n      image: ubuntu:22.04\n      securityContext:\n        privileged: true\n      command: [\"sleep\", \"3600\"]\n",
    "policy_id": "privilege-escalation-container",
    "violation_text": "container \"ubuntu\" is Privileged hence allows privilege escalation."
  },
  {
    "id": "010",
    "manifest_path": "data/manifests/002.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: privileged-pod\n  namespace: default\nspec:\n  containers:\n    - name: ubuntu\n      image: ubuntu:22.04\n      securityContext:\n        privileged: true\n      command: [\"sleep\", \"3600\"]\n",
    "policy_id": "privileged-container",
    "violation_text": "container \"ubuntu\" is privileged"
  },
  {
    "id": "011",
    "manifest_path": "data/manifests/002.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: privileged-pod\n  namespace: default\nspec:\n  containers:\n    - name: ubuntu\n      image: ubuntu:22.04\n      securityContext:\n        privileged: true\n      command: [\"sleep\", \"3600\"]\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"ubuntu\" is not set to runAsNonRoot"
  },
  {
    "id": "012",
    "manifest_path": "data/manifests/002.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: privileged-pod\n  namespace: default\nspec:\n  containers:\n    - name: ubuntu\n      image: ubuntu:22.04\n      securityContext:\n        privileged: true\n      command: [\"sleep\", \"3600\"]\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"ubuntu\" has cpu request 0"
  },
  {
    "id": "013",
    "manifest_path": "data/manifests/002.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: privileged-pod\n  namespace: default\nspec:\n  containers:\n    - name: ubuntu\n      image: ubuntu:22.04\n      securityContext:\n        privileged: true\n      command: [\"sleep\", \"3600\"]\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"ubuntu\" has memory limit 0"
  },
  {
    "id": "014",
    "manifest_path": "data/manifests/002.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: privileged-pod\n  namespace: default\nspec:\n  containers:\n    - name: ubuntu\n      image: ubuntu:22.04\n      securityContext:\n        privileged: true\n      command: [\"sleep\", \"3600\"]\n",
    "policy_id": "check-requests-limits",
    "violation_text": "validation error: Containers must define resource requests and limits. rule check-requests-limits failed at path /spec/containers/0/resources/"
  },
  {
    "id": "015",
    "manifest_path": "data/manifests/002.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: privileged-pod\n  namespace: default\nspec:\n  containers:\n    - name: ubuntu\n      image: ubuntu:22.04\n      securityContext:\n        privileged: true\n      command: [\"sleep\", \"3600\"]\n",
    "policy_id": "check-runasnonroot",
    "violation_text": "validation error: Containers must set securityContext.runAsNonRoot=true. rule check-runasnonroot failed at path /spec/containers/0/securityContext/runAsNonRoot/"
  },
  {
    "id": "016",
    "manifest_path": "data/manifests/003.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: security-risk\n  namespace: default\nspec:\n  containers:\n    - name: web\n      image: nginx:latest\n      ports:\n        - containerPort: 8080\n          hostPort: 30080\n      securityContext:\n        capabilities:\n          add:\n            - NET_RAW\n            - SYS_ADMIN\n  volumes:\n    - name: host-data\n      hostPath:\n        path: /var/lib/data\n",
    "policy_id": "host-path",
    "violation_text": "hostPath volume host-data mounts /var/lib/data from the node"
  },
  {
    "id": "017",
    "manifest_path": "data/manifests/003.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: security-risk\n  namespace: default\nspec:\n  containers:\n    - name: web\n      image: nginx:latest\n      ports:\n        - containerPort: 8080\n          hostPort: 30080\n      securityContext:\n        capabilities:\n          add:\n            - NET_RAW\n            - SYS_ADMIN\n  volumes:\n    - name: host-data\n      hostPath:\n        path: /var/lib/data\n",
    "policy_id": "host-ports",
    "violation_text": "container web exposes hostPort 30080"
  },
  {
    "id": "018",
    "manifest_path": "data/manifests/003.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: security-risk\n  namespace: default\nspec:\n  containers:\n    - name: web\n      image: nginx:latest\n      ports:\n        - containerPort: 8080\n          hostPort: 30080\n      securityContext:\n        capabilities:\n          add:\n            - NET_RAW\n            - SYS_ADMIN\n  volumes:\n    - name: host-data\n      hostPath:\n        path: /var/lib/data\n",
    "policy_id": "run-as-user",
    "violation_text": "container web does not set securityContext.runAsUser"
  },
  {
    "id": "019",
    "manifest_path": "data/manifests/003.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: security-risk\n  namespace: default\nspec:\n  containers:\n    - name: web\n      image: nginx:latest\n      ports:\n        - containerPort: 8080\n          hostPort: 30080\n      securityContext:\n        capabilities:\n          add:\n            - NET_RAW\n            - SYS_ADMIN\n  volumes:\n    - name: host-data\n      hostPath:\n        path: /var/lib/data\n",
    "policy_id": "seccomp",
    "violation_text": "container web does not define a seccompProfile"
  },
  {
    "id": "020",
    "manifest_path": "data/manifests/003.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: security-risk\n  namespace: default\nspec:\n  containers:\n    - name: web\n      image: nginx:latest\n      ports:\n        - containerPort: 8080\n          hostPort: 30080\n      securityContext:\n        capabilities:\n          add:\n            - NET_RAW\n            - SYS_ADMIN\n  volumes:\n    - name: host-data\n      hostPath:\n        path: /var/lib/data\n",
    "policy_id": "drop-capabilities",
    "violation_text": "container web adds dangerous Linux capabilities"
  }
]
