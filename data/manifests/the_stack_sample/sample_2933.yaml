apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-dashboards-valence
data:
  valence.json: "{\n  \"annotations\": {\n    \"list\": [\n      {\n        \"builtIn\"\
    : 1,\n        \"datasource\": \"-- Grafana --\",\n        \"enable\": true,\n\
    \        \"hide\": true,\n        \"iconColor\": \"rgba(0, 211, 255, 1)\",\n \
    \       \"name\": \"Annotations & Alerts\",\n        \"type\": \"dashboard\"\n\
    \      }\n    ]\n  },\n  \"editable\": true,\n  \"gnetId\": null,\n  \"graphTooltip\"\
    : 0,\n  \"id\": 1,\n  \"iteration\": 1559313049824,\n  \"links\": [],\n  \"panels\"\
    : [\n    {\n      \"aliasColors\": {},\n      \"bars\": false,\n      \"dashLength\"\
    : 10,\n      \"dashes\": false,\n      \"datasource\": \"-- Mixed --\",\n    \
    \  \"description\": \"Recommendations of Memory requests and limits to set for\
    \ $deployment\",\n      \"fill\": 1,\n      \"gridPos\": {\n        \"h\": 8,\n\
    \        \"w\": 24,\n        \"x\": 0,\n        \"y\": 0\n      },\n      \"id\"\
    : 2,\n      \"legend\": {\n        \"avg\": false,\n        \"current\": true,\n\
    \        \"max\": false,\n        \"min\": false,\n        \"show\": true,\n \
    \       \"total\": false,\n        \"values\": true\n      },\n      \"lines\"\
    : true,\n      \"linewidth\": 1,\n      \"links\": [],\n      \"nullPointMode\"\
    : \"null\",\n      \"percentage\": false,\n      \"pointradius\": 5,\n      \"\
    points\": false,\n      \"renderer\": \"flot\",\n      \"seriesOverrides\": [],\n\
    \      \"spaceLength\": 10,\n      \"stack\": false,\n      \"steppedLine\": false,\n\
    \      \"targets\": [\n        {\n          \"datasource\": \"DS_PROM_VALENCE\"\
    ,\n          \"expr\": \"max(container_memory_working_set_bytes{container_name=\\\
    \"$deployment\\\"})\",\n          \"format\": \"time_series\",\n          \"instant\"\
    : false,\n          \"interval\": \"5s\",\n          \"intervalFactor\": 1,\n\
    \          \"legendFormat\": \"Observed Memory Value\",\n          \"refId\":\
    \ \"A\"\n        },\n        {\n          \"datasource\": \"DS_PROM_VALENCE\"\
    ,\n          \"expr\": \"max(valence_recommendations_memory_requests{container_name=\\\
    \"$deployment\\\"})\",\n          \"format\": \"time_series\",\n          \"hide\"\
    : false,\n          \"instant\": false,\n          \"interval\": \"60s\",\n  \
    \        \"intervalFactor\": 1,\n          \"legendFormat\": \"Recommended Memory\
    \ Request\",\n          \"refId\": \"B\"\n        },\n        {\n          \"\
    datasource\": \"DS_PROM_VALENCE\",\n          \"expr\": \"max(valence_recommendations_memory_limits{container_name=\\\
    \"$deployment\\\"})\",\n          \"format\": \"time_series\",\n          \"hide\"\
    : false,\n          \"interval\": \"60s\",\n          \"intervalFactor\": 1,\n\
    \          \"legendFormat\": \"Recommended Memory Limit\",\n          \"refId\"\
    : \"C\"\n        },\n        {\n          \"datasource\": \"DS_PROM_VALENCE\"\
    ,\n          \"expr\": \"max(kube_pod_container_resource_requests_memory_bytes{container=\\\
    \"$deployment\\\"})\",\n          \"format\": \"time_series\",\n          \"intervalFactor\"\
    : 1,\n          \"legendFormat\": \"Requests\",\n          \"refId\": \"D\"\n\
    \        },\n        {\n          \"datasource\": \"DS_PROM_VALENCE\",\n     \
    \     \"expr\": \"max(kube_pod_container_resource_limits_memory_bytes{container=\\\
    \"$deployment\\\"})\",\n          \"format\": \"time_series\",\n          \"intervalFactor\"\
    : 1,\n          \"legendFormat\": \"Limits\",\n          \"refId\": \"E\"\n  \
    \      }\n      ],\n      \"thresholds\": [],\n      \"timeFrom\": null,\n   \
    \   \"timeShift\": null,\n      \"title\": \"Memory recommendations: $deployment\"\
    ,\n      \"tooltip\": {\n        \"shared\": true,\n        \"sort\": 0,\n   \
    \     \"value_type\": \"individual\"\n      },\n      \"transparent\": false,\n\
    \      \"type\": \"graph\",\n      \"xaxis\": {\n        \"buckets\": null,\n\
    \        \"mode\": \"time\",\n        \"name\": null,\n        \"show\": true,\n\
    \        \"values\": []\n      },\n      \"yaxes\": [\n        {\n          \"\
    format\": \"bytes\",\n          \"label\": \"Memory\",\n          \"logBase\"\
    : 1,\n          \"max\": null,\n          \"min\": null,\n          \"show\":\
    \ true\n        },\n        {\n          \"format\": \"short\",\n          \"\
    label\": null,\n          \"logBase\": 1,\n          \"max\": null,\n        \
    \  \"min\": null,\n          \"show\": true\n        }\n      ],\n      \"yaxis\"\
    : {\n        \"align\": false,\n        \"alignLevel\": null\n      }\n    },\n\
    \    {\n      \"aliasColors\": {},\n      \"bars\": false,\n      \"dashLength\"\
    : 10,\n      \"dashes\": false,\n      \"datasource\": \"-- Mixed --\",\n    \
    \  \"description\": \"Recommendations of CPU requests and limits to set for $deployment\"\
    ,\n      \"fill\": 1,\n      \"gridPos\": {\n        \"h\": 8,\n        \"w\"\
    : 24,\n        \"x\": 0,\n        \"y\": 8\n      },\n      \"id\": 4,\n     \
    \ \"legend\": {\n        \"avg\": false,\n        \"current\": true,\n       \
    \ \"max\": false,\n        \"min\": false,\n        \"show\": true,\n        \"\
    total\": false,\n        \"values\": true\n      },\n      \"lines\": true,\n\
    \      \"linewidth\": 1,\n      \"links\": [],\n      \"nullPointMode\": \"null\"\
    ,\n      \"percentage\": false,\n      \"pointradius\": 5,\n      \"points\":\
    \ false,\n      \"renderer\": \"flot\",\n      \"seriesOverrides\": [],\n    \
    \  \"spaceLength\": 10,\n      \"stack\": false,\n      \"steppedLine\": false,\n\
    \      \"targets\": [\n        {\n          \"datasource\": \"DS_PROM_VALENCE\"\
    ,\n          \"expr\": \"avg(rate(container_cpu_usage_seconds_total{container_name=\\\
    \"$deployment\\\"}[2m]))\",\n          \"format\": \"time_series\",\n        \
    \  \"instant\": false,\n          \"interval\": \"5s\",\n          \"intervalFactor\"\
    : 1,\n          \"legendFormat\": \"Observed CPU Value\",\n          \"refId\"\
    : \"A\"\n        },\n        {\n          \"datasource\": \"DS_PROM_VALENCE\"\
    ,\n          \"expr\": \"max(valence_recommendations_cpu_requests{container_name=\\\
    \"$deployment\\\"} / 1000)\",\n          \"format\": \"time_series\",\n      \
    \    \"hide\": false,\n          \"instant\": false,\n          \"interval\":\
    \ \"60s\",\n          \"intervalFactor\": 1,\n          \"legendFormat\": \"Recommended\
    \ CPU Request\",\n          \"refId\": \"B\"\n        },\n        {\n        \
    \  \"datasource\": \"DS_PROM_VALENCE\",\n          \"expr\": \"max(valence_recommendations_cpu_limits{container_name=\\\
    \"$deployment\\\"} / 1000)\",\n          \"format\": \"time_series\",\n      \
    \    \"hide\": false,\n          \"interval\": \"60s\",\n          \"intervalFactor\"\
    : 1,\n          \"legendFormat\": \"Recommended CPU Limit\",\n          \"refId\"\
    : \"C\"\n        },\n        {\n          \"datasource\": \"DS_PROM_VALENCE\"\
    ,\n          \"expr\": \"max(kube_pod_container_resource_requests_cpu_cores{container=\\\
    \"$deployment\\\"})\",\n          \"format\": \"time_series\",\n          \"intervalFactor\"\
    : 1,\n          \"legendFormat\": \"Requests\",\n          \"refId\": \"D\"\n\
    \        },\n        {\n          \"datasource\": \"DS_PROM_VALENCE\",\n     \
    \     \"expr\": \"max(kube_pod_container_resource_limits_cpu_cores{container=\\\
    \"$deployment\\\"})\",\n          \"format\": \"time_series\",\n          \"intervalFactor\"\
    : 1,\n          \"legendFormat\": \"Limits\",\n          \"refId\": \"E\"\n  \
    \      }\n      ],\n      \"thresholds\": [],\n      \"timeFrom\": null,\n   \
    \   \"timeShift\": null,\n      \"title\": \"Cpu recommendations: $deployment\"\
    ,\n      \"tooltip\": {\n        \"shared\": true,\n        \"sort\": 0,\n   \
    \     \"value_type\": \"individual\"\n      },\n      \"transparent\": false,\n\
    \      \"type\": \"graph\",\n      \"xaxis\": {\n        \"buckets\": null,\n\
    \        \"mode\": \"time\",\n        \"name\": null,\n        \"show\": true,\n\
    \        \"values\": []\n      },\n      \"yaxes\": [\n        {\n          \"\
    format\": \"short\",\n          \"label\": \"CPU\",\n          \"logBase\": 1,\n\
    \          \"max\": null,\n          \"min\": null,\n          \"show\": true\n\
    \        },\n        {\n          \"format\": \"short\",\n          \"label\"\
    : null,\n          \"logBase\": 1,\n          \"max\": null,\n          \"min\"\
    : null,\n          \"show\": true\n        }\n      ],\n      \"yaxis\": {\n \
    \       \"align\": false,\n        \"alignLevel\": null\n      }\n    },\n   \
    \ {\n      \"aliasColors\": {},\n      \"bars\": false,\n      \"dashLength\"\
    : 10,\n      \"dashes\": false,\n      \"datasource\": \"DS_PROM_VALENCE\",\n\
    \      \"fill\": 1,\n      \"gridPos\": {\n        \"h\": 8,\n        \"w\": 24,\n\
    \        \"x\": 0,\n        \"y\": 16\n      },\n      \"id\": 6,\n      \"legend\"\
    : {\n        \"avg\": false,\n        \"current\": true,\n        \"max\": false,\n\
    \        \"min\": false,\n        \"show\": true,\n        \"total\": false,\n\
    \        \"values\": true\n      },\n      \"lines\": true,\n      \"linewidth\"\
    : 1,\n      \"links\": [],\n      \"nullPointMode\": \"null\",\n      \"percentage\"\
    : false,\n      \"pointradius\": 5,\n      \"points\": false,\n      \"renderer\"\
    : \"flot\",\n      \"seriesOverrides\": [],\n      \"spaceLength\": 10,\n    \
    \  \"stack\": false,\n      \"steppedLine\": false,\n      \"targets\": [\n  \
    \      {\n          \"expr\": \"sum(rate(envoy_http_downstream_rq_total{service=\\\
    \"$deployment\\\"}[1m]))\",\n          \"format\": \"time_series\",\n        \
    \  \"instant\": false,\n          \"interval\": \"\",\n          \"intervalFactor\"\
    : 1,\n          \"legendFormat\": \"HTTP Queries Per Second\",\n          \"refId\"\
    : \"A\"\n        },\n        {\n          \"expr\": \"\",\n          \"format\"\
    : \"time_series\",\n          \"intervalFactor\": 1,\n          \"refId\": \"\
    B\"\n        }\n      ],\n      \"thresholds\": [],\n      \"timeFrom\": null,\n\
    \      \"timeShift\": null,\n      \"title\": \"HTTP Request Count: $deployment\"\
    ,\n      \"tooltip\": {\n        \"shared\": true,\n        \"sort\": 0,\n   \
    \     \"value_type\": \"individual\"\n      },\n      \"type\": \"graph\",\n \
    \     \"xaxis\": {\n        \"buckets\": null,\n        \"mode\": \"time\",\n\
    \        \"name\": null,\n        \"show\": true,\n        \"values\": []\n  \
    \    },\n      \"yaxes\": [\n        {\n          \"format\": \"short\",\n   \
    \       \"label\": \"QpS\",\n          \"logBase\": 1,\n          \"max\": null,\n\
    \          \"min\": null,\n          \"show\": true\n        },\n        {\n \
    \         \"format\": \"short\",\n          \"label\": null,\n          \"logBase\"\
    : 1,\n          \"max\": null,\n          \"min\": null,\n          \"show\":\
    \ true\n        }\n      ],\n      \"yaxis\": {\n        \"align\": false,\n \
    \       \"alignLevel\": null\n      }\n    },\n    {\n      \"aliasColors\": {},\n\
    \      \"bars\": false,\n      \"dashLength\": 10,\n      \"dashes\": false,\n\
    \      \"datasource\": \"DS_PROM_VALENCE\",\n      \"fill\": 1,\n      \"gridPos\"\
    : {\n        \"h\": 8,\n        \"w\": 24,\n        \"x\": 0,\n        \"y\":\
    \ 24\n      },\n      \"id\": 7,\n      \"legend\": {\n        \"avg\": false,\n\
    \        \"current\": true,\n        \"max\": false,\n        \"min\": false,\n\
    \        \"show\": true,\n        \"total\": false,\n        \"values\": true\n\
    \      },\n      \"lines\": true,\n      \"linewidth\": 1,\n      \"links\": [],\n\
    \      \"nullPointMode\": \"null\",\n      \"percentage\": false,\n      \"pointradius\"\
    : 5,\n      \"points\": false,\n      \"renderer\": \"flot\",\n      \"seriesOverrides\"\
    : [],\n      \"spaceLength\": 10,\n      \"stack\": false,\n      \"steppedLine\"\
    : false,\n      \"targets\": [\n        {\n          \"expr\": \"avg(histogram_quantile($LatencyPercentile,\
    \ sum(rate(envoy_http_downstream_rq_time_bucket{service=\\\"$deployment\\\"}[1m]))\
    \ by(le, pod)))\",\n          \"format\": \"time_series\",\n          \"instant\"\
    : false,\n          \"interval\": \"\",\n          \"intervalFactor\": 1,\n  \
    \        \"legendFormat\": \"HTTP Request Latency\",\n          \"refId\": \"\
    A\"\n        },\n        {\n          \"expr\": \"valence_slo_http_latency{name=\\\
    \"$deployment\\\"}\",\n          \"format\": \"time_series\",\n          \"intervalFactor\"\
    : 1,\n          \"refId\": \"B\"\n        }\n      ],\n      \"thresholds\": [],\n\
    \      \"timeFrom\": null,\n      \"timeShift\": null,\n      \"title\": \"HTTP\
    \ Request Latency: $deployment\",\n      \"tooltip\": {\n        \"shared\": true,\n\
    \        \"sort\": 0,\n        \"value_type\": \"individual\"\n      },\n    \
    \  \"type\": \"graph\",\n      \"xaxis\": {\n        \"buckets\": null,\n    \
    \    \"mode\": \"time\",\n        \"name\": null,\n        \"show\": true,\n \
    \       \"values\": []\n      },\n      \"yaxes\": [\n        {\n          \"\
    format\": \"ms\",\n          \"label\": \"\",\n          \"logBase\": 1,\n   \
    \       \"max\": null,\n          \"min\": \"0\",\n          \"show\": true\n\
    \        },\n        {\n          \"format\": \"short\",\n          \"label\"\
    : null,\n          \"logBase\": 1,\n          \"max\": null,\n          \"min\"\
    : null,\n          \"show\": true\n        }\n      ],\n      \"yaxis\": {\n \
    \       \"align\": false,\n        \"alignLevel\": null\n      }\n    },\n   \
    \ {\n      \"aliasColors\": {},\n      \"bars\": false,\n      \"dashLength\"\
    : 10,\n      \"dashes\": false,\n      \"datasource\": \"-- Mixed --\",\n    \
    \  \"description\": \"Number of replicas observed and recommended for: $deployment\"\
    ,\n      \"fill\": 1,\n      \"gridPos\": {\n        \"h\": 8,\n        \"w\"\
    : 24,\n        \"x\": 0,\n        \"y\": 32\n      },\n      \"id\": 9,\n    \
    \  \"legend\": {\n        \"avg\": false,\n        \"current\": true,\n      \
    \  \"max\": false,\n        \"min\": false,\n        \"show\": true,\n       \
    \ \"total\": false,\n        \"values\": true\n      },\n      \"lines\": true,\n\
    \      \"linewidth\": 1,\n      \"links\": [],\n      \"nullPointMode\": \"null\"\
    ,\n      \"percentage\": false,\n      \"pointradius\": 5,\n      \"points\":\
    \ false,\n      \"renderer\": \"flot\",\n      \"seriesOverrides\": [],\n    \
    \  \"spaceLength\": 10,\n      \"stack\": false,\n      \"steppedLine\": false,\n\
    \      \"targets\": [\n        {\n          \"datasource\": \"DS_PROM_VALENCE\"\
    ,\n          \"expr\": \"valence_recommendations_replicas{name=\\\"$deployment\\\
    \"}\",\n          \"format\": \"time_series\",\n          \"hide\": false,\n \
    \         \"intervalFactor\": 1,\n          \"legendFormat\": \"Recommended Replicas\"\
    ,\n          \"refId\": \"A\"\n        },\n        {\n          \"datasource\"\
    : \"DS_PROM_VALENCE\",\n          \"expr\": \"kube_deployment_status_replicas_available{deployment=\\\
    \"$deployment\\\"}\",\n          \"format\": \"time_series\",\n          \"intervalFactor\"\
    : 1,\n          \"legendFormat\": \"Current Replicas\",\n          \"refId\":\
    \ \"B\"\n        }\n      ],\n      \"thresholds\": [],\n      \"timeFrom\": null,\n\
    \      \"timeShift\": null,\n      \"title\": \"Replicas: $deployment\",\n   \
    \   \"tooltip\": {\n        \"shared\": true,\n        \"sort\": 0,\n        \"\
    value_type\": \"individual\"\n      },\n      \"type\": \"graph\",\n      \"xaxis\"\
    : {\n        \"buckets\": null,\n        \"mode\": \"time\",\n        \"name\"\
    : null,\n        \"show\": true,\n        \"values\": []\n      },\n      \"yaxes\"\
    : [\n        {\n          \"decimals\": null,\n          \"format\": \"short\"\
    ,\n          \"label\": null,\n          \"logBase\": 1,\n          \"max\": null,\n\
    \          \"min\": null,\n          \"show\": true\n        },\n        {\n \
    \         \"format\": \"short\",\n          \"label\": null,\n          \"logBase\"\
    : 1,\n          \"max\": null,\n          \"min\": null,\n          \"show\":\
    \ true\n        }\n      ],\n      \"yaxis\": {\n        \"align\": false,\n \
    \       \"alignLevel\": null\n      }\n    }\n  ],\n  \"refresh\": \"5s\",\n \
    \ \"schemaVersion\": 16,\n  \"style\": \"dark\",\n  \"tags\": [],\n  \"templating\"\
    : {\n    \"list\": [\n      {\n        \"allValue\": null,\n        \"current\"\
    : {\n          \"selected\": false,\n          \"tags\": [],\n          \"text\"\
    : \"todo-backend-django-valence\",\n          \"value\": \"todo-backend-django-valence\"\
    \n        },\n        \"datasource\": \"DS_PROM_VALENCE\",\n        \"hide\":\
    \ 0,\n        \"includeAll\": false,\n        \"label\": \"Deployment\",\n   \
    \     \"multi\": false,\n        \"name\": \"deployment\",\n        \"options\"\
    : [],\n        \"query\": \"label_values(envoy_http_downstream_rq_total, service)\"\
    ,\n        \"refresh\": 1,\n        \"regex\": \"\",\n        \"sort\": 0,\n \
    \       \"tagValuesQuery\": \"\",\n        \"tags\": [],\n        \"tagsQuery\"\
    : \"\",\n        \"type\": \"query\",\n        \"useTags\": false\n      },\n\
    \      {\n        \"allValue\": null,\n        \"current\": {\n          \"selected\"\
    : true,\n          \"tags\": [],\n          \"text\": \"0.95\",\n          \"\
    value\": \"0.95\"\n        },\n        \"hide\": 0,\n        \"includeAll\": false,\n\
    \        \"label\": \"Latency Percentile\",\n        \"multi\": false,\n     \
    \   \"name\": \"LatencyPercentile\",\n        \"options\": [\n          {\n  \
    \          \"selected\": false,\n            \"text\": \"0.5\",\n            \"\
    value\": \"0.5\"\n          },\n          {\n            \"selected\": false,\n\
    \            \"text\": \"0.75\",\n            \"value\": \"0.75\"\n          },\n\
    \          {\n            \"selected\": false,\n            \"text\": \"0.9\"\
    ,\n            \"value\": \"0.9\"\n          },\n          {\n            \"selected\"\
    : true,\n            \"text\": \"0.95\",\n            \"value\": \"0.95\"\n  \
    \        },\n          {\n            \"selected\": false,\n            \"text\"\
    : \"0.99\",\n            \"value\": \"0.99\"\n          }\n        ],\n      \
    \  \"query\": \"0.5, 0.75, 0.9, 0.95, 0.99\",\n        \"type\": \"custom\"\n\
    \      }\n    ]\n  },\n  \"time\": {\n    \"from\": \"now-1h\",\n    \"to\": \"\
    now\"\n  },\n  \"timepicker\": {\n    \"refresh_intervals\": [\n      \"1s\",\n\
    \      \"5s\",\n      \"30s\",\n      \"1m\"\n    ],\n    \"time_options\": [\n\
    \      \"5m\",\n      \"15m\",\n      \"1h\",\n      \"6h\",\n      \"12h\",\n\
    \      \"24h\",\n      \"2d\",\n      \"7d\",\n      \"30d\"\n    ]\n  },\n  \"\
    timezone\": \"\",\n  \"title\": \"Valence\",\n  \"uid\": \"9ri9X0Qiz\",\n  \"\
    version\": 1\n}"
