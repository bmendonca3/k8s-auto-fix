apiVersion: v1
kind: ConfigMap
metadata:
  name: gitlab-webservice
  namespace: public-service
  labels:
    app: gitlab
    component: webservice
data:
  installation_type: 'gitlab-helm-chart

    '
  database.yml.erb: "production:\n  adapter: postgresql\n  encoding: unicode\n  database:\
    \ gitlabhq_production\n  username: gitlab\n  password: \"<%= File.read(\"/etc/gitlab/postgres/psql-password\"\
    ).strip.dump[1..-2] %>\"\n  host: \"gitlab-postgresql\"\n  port: 5432\n  pool:\
    \ 1\n  connect_timeout: \n  prepared_statements: false\n  \n"
  smtp_settings.rb: ''
  resque.yml.erb: "production:\n  url: redis://:<%= ERB::Util::url_encode(File.read(\"\
    /etc/gitlab/redis/redis-password\").strip) %>@gitlab-redis-master:6379\n  id:\n"
  cable.yml.erb: "production:\n  url: redis://:<%= ERB::Util::url_encode(File.read(\"\
    /etc/gitlab/redis/redis-password\").strip) %>@gitlab-redis-master:6379\n  id:\n\
    \  adapter: redis\n  \n"
  gitlab.yml.erb: "production: &base\n  gitlab:\n    host: gitlab.lzxlinux.com\n \
    \   https: false\n    max_request_duration_seconds: 57\n    impersonation_enabled:\
    \ \n    usage_ping_enabled: true\n    seat_link_enabled: true\n    default_can_create_group:\
    \ true\n    username_changing_enabled: true\n    issue_closing_pattern: \n   \
    \ default_theme: \n    default_projects_features:\n      issues: true\n      merge_requests:\
    \ true\n      wiki: true\n      snippets: true\n      builds: true\n      container_registry:\
    \ true\n    webhook_timeout: \n    trusted_proxies:\n    time_zone: \"UTC\"  \
    \      \n    email_from: \"gitlab@lzxlinux.com\"\n    email_display_name: \"GitLab\"\
    \n    email_reply_to: \"noreply@lzxlinux.com\"\n    email_subject_suffix: \"\"\
    \n  \n  gravatar:\n    plain_url: \n    ssl_url: \n  extra:\n\n  object_store:\n\
    \    enabled: true\n    direct_upload: true\n    background_upload: false\n  \
    \  proxy_download: true\n    connection:\n      provider: AWS\n      region: us-east-1\n\
    \      host: minio.lzxlinux.com\n      endpoint: http://gitlab-minio-svc:9000\n\
    \      path_style: true\n      aws_access_key_id: \"<%= File.read('/etc/gitlab/minio/accesskey').strip.dump[1..-2]\
    \ %>\"\n      aws_secret_access_key: \"<%= File.read('/etc/gitlab/minio/secretkey').strip.dump[1..-2]\
    \ %>\"\n    objects:\n      artifacts:\n        bucket: gitlab-artifacts\n   \
    \   lfs:\n        bucket: git-lfs\n      uploads:\n        bucket: gitlab-uploads\n\
    \      packages:\n        bucket: gitlab-packages\n      external_diffs:\n   \
    \     bucket: gitlab-mr-diffs\n      terraform_state:\n        bucket: gitlab-terraform-state\n\
    \      dependency_proxy:\n        bucket: gitlab-dependency-proxy\n        \n\
    \  artifacts:\n    enabled: true\n  lfs:\n    enabled: true\n  uploads:\n    enabled:\
    \ true\n  packages:\n    enabled: true\n  external_diffs:\n    enabled: \n   \
    \ when: \n  terraform_state:\n    enabled: false\n  dependency_proxy:\n    enabled:\
    \ false\n  \n  sentry:\n    enabled: false\n    dsn: \n    clientside_dsn: \n\
    \    environment: \n  pages:\n    enabled: false\n  mattermost:\n    enabled:\
    \ false\n  gitlab_ci:\n  ldap:\n    enabled: false\n  \n  omniauth:\n    enabled:\
    \ false\n    sync_profile_from_provider: []\n    sync_profile_attributes: [\"\
    email\"]\n    allow_single_sign_on: [\"saml\"]\n    block_auto_created_users:\
    \ true\n    auto_link_ldap_user: false\n    auto_link_saml_user: false\n    external_providers:\
    \ []\n  kerberos:\n    enabled: false\n  shared:\n  gitaly:\n    client_path:\
    \ /home/git/gitaly/bin\n    token: \"<%= File.read('/etc/gitlab/gitaly/gitaly_token').strip.dump[1..-2]\
    \ %>\"\n  repositories:\n    storages: # You must have at least a `default` storage\
    \ path.\n      default:\n        path: /var/opt/gitlab/repo\n        gitaly_address:\
    \ tcp://gitlab-gitaly-0.gitlab-gitaly.public-service:8075\n      \n  backup:\n\
    \    path: \"tmp/backups\"   # Relative paths are relative to Rails.root (default:\
    \ tmp/backups/)\n  \n  gitlab_shell:\n    path: /home/git/gitlab-shell/\n    hooks_path:\
    \ /home/git/gitlab-shell/hooks/\n    upload_pack: true\n    receive_pack: true\n\
    \    ssh_port: 22\n    secret_file: /etc/gitlab/shell/.gitlab_shell_secret\n \
    \ workhorse:\n    secret_file: /etc/gitlab/gitlab-workhorse/secret\n  git:\n \
    \   bin_path: /usr/bin/git\n  webpack:\n  monitoring:\n    ip_whitelist:\n   \
    \   - 0.0.0.0/0\n    web_exporter:\n      enabled: false\n      address: 0.0.0.0\n\
    \      port: 8083\n    sidekiq_exporter:\n  shutdown:\n    blackout_seconds: 10\n\
    \  rack_attack:\n    git_basic_auth:\n\n  registry:\n    enabled: true\n    host:\
    \ registry.lzxlinux.com\n    api_url: http://gitlab-registry:5000\n    key: /etc/gitlab/registry/gitlab-registry.key\n\
    \    issuer: gitlab-issuer\n  smartcard:\n    enabled: false\n    ca_file: '/etc/gitlab/rails-secrets/smartcard-ca.crt'\n\
    \    client_certificate_required_host: smartcard.lzxlinux.com\n    client_certificate_required_port:\
    \ 443\n    san_extensions: false\n    required_for_git_access: false\n    \n"
  configure: "set -e\nconfig_dir=\"/init-config\"\nsecret_dir=\"/init-secrets\"\n\n\
    for secret in shell gitaly registry rails-secrets gitlab-workhorse ; do\n  mkdir\
    \ -p \"${secret_dir}/${secret}\"\n  cp -v -r -L \"${config_dir}/${secret}/.\"\
    \ \"${secret_dir}/${secret}/\"\ndone\nfor secret in redis minio objectstorage\
    \ postgres ldap omniauth smtp kas ; do\n  if [ -e \"${config_dir}/${secret}\"\
    \ ]; then\n    mkdir -p \"${secret_dir}/${secret}\"\n    cp -v -r -L \"${config_dir}/${secret}/.\"\
    \ \"${secret_dir}/${secret}/\"\n  fi\ndone"
