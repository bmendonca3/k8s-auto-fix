[
  {
    "id": "001",
    "policy_id": "no_latest_tag",
    "source": "rules",
    "patch": [
      {
        "op": "replace",
        "path": "/spec/containers/0/image",
        "value": "nginx:stable"
      }
    ]
  },
  {
    "id": "002",
    "policy_id": "read_only_root_fs",
    "source": "rules",
    "patch": [
      {
        "op": "add",
        "path": "/spec/containers/0/securityContext",
        "value": {
          "readOnlyRootFilesystem": true
        }
      }
    ]
  },
  {
    "id": "003",
    "policy_id": "run_as_non_root",
    "source": "rules",
    "patch": [
      {
        "op": "add",
        "path": "/spec/containers/0/securityContext",
        "value": {
          "runAsNonRoot": true
        }
      }
    ]
  },
  {
    "id": "004",
    "policy_id": "set_requests_limits",
    "source": "rules",
    "patch": [
      {
        "op": "add",
        "path": "/spec/containers/0/resources",
        "value": {
          "requests": {
            "cpu": "100m",
            "memory": "128Mi"
          },
          "limits": {
            "cpu": "500m",
            "memory": "256Mi"
          }
        }
      }
    ]
  },
  {
    "id": "005",
    "policy_id": "set_requests_limits",
    "source": "rules",
    "patch": [
      {
        "op": "add",
        "path": "/spec/containers/0/resources",
        "value": {
          "requests": {
            "cpu": "100m",
            "memory": "128Mi"
          },
          "limits": {
            "cpu": "500m",
            "memory": "256Mi"
          }
        }
      }
    ]
  },
  {
    "id": "006",
    "policy_id": "set_requests_limits",
    "source": "rules",
    "patch": [
      {
        "op": "add",
        "path": "/spec/containers/0/resources",
        "value": {
          "requests": {
            "cpu": "100m",
            "memory": "128Mi"
          },
          "limits": {
            "cpu": "500m",
            "memory": "256Mi"
          }
        }
      }
    ]
  },
  {
    "id": "007",
    "policy_id": "run_as_non_root",
    "source": "rules",
    "patch": [
      {
        "op": "add",
        "path": "/spec/containers/0/securityContext",
        "value": {
          "runAsNonRoot": true
        }
      }
    ]
  },
  {
    "id": "008",
    "policy_id": "read_only_root_fs",
    "source": "rules",
    "patch": [
      {
        "op": "add",
        "path": "/spec/containers/0/securityContext/readOnlyRootFilesystem",
        "value": true
      }
    ]
  },
  {
    "id": "009",
    "policy_id": "no_privileged",
    "source": "rules",
    "patch": [
      {
        "op": "replace",
        "path": "/spec/containers/0/securityContext/privileged",
        "value": false
      }
    ]
  },
  {
    "id": "010",
    "policy_id": "no_privileged",
    "source": "rules",
    "patch": [
      {
        "op": "replace",
        "path": "/spec/containers/0/securityContext/privileged",
        "value": false
      }
    ]
  },
  {
    "id": "011",
    "policy_id": "run_as_non_root",
    "source": "rules",
    "patch": [
      {
        "op": "add",
        "path": "/spec/containers/0/securityContext/runAsNonRoot",
        "value": true
      }
    ]
  },
  {
    "id": "012",
    "policy_id": "set_requests_limits",
    "source": "rules",
    "patch": [
      {
        "op": "add",
        "path": "/spec/containers/0/resources",
        "value": {
          "requests": {
            "cpu": "100m",
            "memory": "128Mi"
          },
          "limits": {
            "cpu": "500m",
            "memory": "256Mi"
          }
        }
      }
    ]
  },
  {
    "id": "013",
    "policy_id": "set_requests_limits",
    "source": "rules",
    "patch": [
      {
        "op": "add",
        "path": "/spec/containers/0/resources",
        "value": {
          "requests": {
            "cpu": "100m",
            "memory": "128Mi"
          },
          "limits": {
            "cpu": "500m",
            "memory": "256Mi"
          }
        }
      }
    ]
  },
  {
    "id": "014",
    "policy_id": "set_requests_limits",
    "source": "rules",
    "patch": [
      {
        "op": "add",
        "path": "/spec/containers/0/resources",
        "value": {
          "requests": {
            "cpu": "100m",
            "memory": "128Mi"
          },
          "limits": {
            "cpu": "500m",
            "memory": "256Mi"
          }
        }
      }
    ]
  },
  {
    "id": "015",
    "policy_id": "run_as_non_root",
    "source": "rules",
    "patch": [
      {
        "op": "add",
        "path": "/spec/containers/0/securityContext/runAsNonRoot",
        "value": true
      }
    ]
  },
  {
    "id": "016",
    "policy_id": "no_host_path",
    "source": "rules",
    "patch": [
      {
        "op": "remove",
        "path": "/spec/volumes/0/hostPath"
      },
      {
        "op": "add",
        "path": "/spec/volumes/0/emptyDir",
        "value": {}
      }
    ]
  },
  {
    "id": "017",
    "policy_id": "no_host_ports",
    "source": "rules",
    "patch": [
      {
        "op": "remove",
        "path": "/spec/containers/0/ports/0/hostPort"
      }
    ]
  },
  {
    "id": "018",
    "policy_id": "run_as_user",
    "source": "rules",
    "patch": [
      {
        "op": "add",
        "path": "/spec/containers/0/securityContext/runAsUser",
        "value": 1000
      }
    ]
  },
  {
    "id": "019",
    "policy_id": "enforce_seccomp",
    "source": "rules",
    "patch": [
      {
        "op": "add",
        "path": "/spec/containers/0/securityContext/seccompProfile",
        "value": {
          "type": "RuntimeDefault"
        }
      }
    ]
  },
  {
    "id": "020",
    "policy_id": "drop_capabilities",
    "source": "rules",
    "patch": [
      {
        "op": "add",
        "path": "/spec/containers/0/securityContext/capabilities/drop",
        "value": [
          "NET_RAW",
          "NET_ADMIN",
          "SYS_ADMIN",
          "SYS_MODULE",
          "SYS_PTRACE",
          "SYS_CHROOT"
        ]
      },
      {
        "op": "replace",
        "path": "/spec/containers/0/securityContext/capabilities/add",
        "value": []
      }
    ]
  }
]