[
  {
    "id": "521",
    "manifest_path": "data/manifests/artifacthub/ingress-nginx/ingress-nginx/009_deployment_release-name-ingress-nginx-controller.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    helm.sh/chart: ingress-nginx-4.13.3\n    app.kubernetes.io/name: ingress-nginx\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/version: 1.13.3\n    app.kubernetes.io/part-of: ingress-nginx\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/component: controller\n  name: release-name-ingress-nginx-controller\n  namespace: default\nspec:\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: ingress-nginx\n      app.kubernetes.io/instance: release-name\n      app.kubernetes.io/component: controller\n  replicas: 1\n  revisionHistoryLimit: 10\n  minReadySeconds: 0\n  template:\n    metadata:\n      labels:\n        helm.sh/chart: ingress-nginx-4.13.3\n        app.kubernetes.io/name: ingress-nginx\n        app.kubernetes.io/instance: release-name\n        app.kubernetes.io/version: 1.13.3\n        app.kubernetes.io/part-of: ingress-nginx\n        app.kubernetes.io/managed-by: Helm\n        app.kubernetes.io/component: controller\n    spec:\n      dnsPolicy: ClusterFirst\n      containers:\n      - name: controller\n        image: registry.k8s.io/ingress-nginx/controller:v1.13.3@sha256:1b044f6dcac3afbb59e05d98463f1dec6f3d3fb99940bc12ca5d80270358e3bd\n        imagePullPolicy: IfNotPresent\n        lifecycle:\n          preStop:\n            exec:\n              command:\n              - /wait-shutdown\n        args:\n        - /nginx-ingress-controller\n        - --publish-service=$(POD_NAMESPACE)/release-name-ingress-nginx-controller\n        - --election-id=release-name-ingress-nginx-leader\n        - --controller-class=k8s.io/ingress-nginx\n        - --ingress-class=nginx\n        - --configmap=$(POD_NAMESPACE)/release-name-ingress-nginx-controller\n        - --validating-webhook=:8443\n        - --validating-webhook-certificate=/usr/local/certificates/cert\n        - --validating-webhook-key=/usr/local/certificates/key\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 101\n          runAsGroup: 82\n          allowPrivilegeEscalation: false\n          seccompProfile:\n            type: RuntimeDefault\n          capabilities:\n            drop:\n            - ALL\n            add:\n            - NET_BIND_SERVICE\n          readOnlyRootFilesystem: false\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: LD_PRELOAD\n          value: /usr/local/lib/libmimalloc.so\n        livenessProbe:\n          failureThreshold: 5\n          httpGet:\n            path: /healthz\n            port: 10254\n            scheme: HTTP\n          initialDelaySeconds: 10\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        readinessProbe:\n          failureThreshold: 3\n          httpGet:\n            path: /healthz\n            port: 10254\n            scheme: HTTP\n          initialDelaySeconds: 10\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        ports:\n        - name: http\n          containerPort: 80\n          protocol: TCP\n        - name: https\n          containerPort: 443\n          protocol: TCP\n        - name: webhook\n          containerPort: 8443\n          protocol: TCP\n        volumeMounts:\n        - name: webhook-cert\n          mountPath: /usr/local/certificates/\n          readOnly: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 90Mi\n      nodeSelector:\n        kubernetes.io/os: linux\n      serviceAccountName: release-name-ingress-nginx\n      automountServiceAccountToken: true\n      terminationGracePeriodSeconds: 300\n      volumes:\n      - name: webhook-cert\n        secret:\n          secretName: release-name-ingress-nginx-admission\n",
    "policy_id": "liveness-port",
    "violation_text": "container \"controller\" does not expose port 10254 for the HTTPGet"
  },
  {
    "id": "522",
    "manifest_path": "data/manifests/artifacthub/ingress-nginx/ingress-nginx/009_deployment_release-name-ingress-nginx-controller.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    helm.sh/chart: ingress-nginx-4.13.3\n    app.kubernetes.io/name: ingress-nginx\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/version: 1.13.3\n    app.kubernetes.io/part-of: ingress-nginx\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/component: controller\n  name: release-name-ingress-nginx-controller\n  namespace: default\nspec:\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: ingress-nginx\n      app.kubernetes.io/instance: release-name\n      app.kubernetes.io/component: controller\n  replicas: 1\n  revisionHistoryLimit: 10\n  minReadySeconds: 0\n  template:\n    metadata:\n      labels:\n        helm.sh/chart: ingress-nginx-4.13.3\n        app.kubernetes.io/name: ingress-nginx\n        app.kubernetes.io/instance: release-name\n        app.kubernetes.io/version: 1.13.3\n        app.kubernetes.io/part-of: ingress-nginx\n        app.kubernetes.io/managed-by: Helm\n        app.kubernetes.io/component: controller\n    spec:\n      dnsPolicy: ClusterFirst\n      containers:\n      - name: controller\n        image: registry.k8s.io/ingress-nginx/controller:v1.13.3@sha256:1b044f6dcac3afbb59e05d98463f1dec6f3d3fb99940bc12ca5d80270358e3bd\n        imagePullPolicy: IfNotPresent\n        lifecycle:\n          preStop:\n            exec:\n              command:\n              - /wait-shutdown\n        args:\n        - /nginx-ingress-controller\n        - --publish-service=$(POD_NAMESPACE)/release-name-ingress-nginx-controller\n        - --election-id=release-name-ingress-nginx-leader\n        - --controller-class=k8s.io/ingress-nginx\n        - --ingress-class=nginx\n        - --configmap=$(POD_NAMESPACE)/release-name-ingress-nginx-controller\n        - --validating-webhook=:8443\n        - --validating-webhook-certificate=/usr/local/certificates/cert\n        - --validating-webhook-key=/usr/local/certificates/key\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 101\n          runAsGroup: 82\n          allowPrivilegeEscalation: false\n          seccompProfile:\n            type: RuntimeDefault\n          capabilities:\n            drop:\n            - ALL\n            add:\n            - NET_BIND_SERVICE\n          readOnlyRootFilesystem: false\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: LD_PRELOAD\n          value: /usr/local/lib/libmimalloc.so\n        livenessProbe:\n          failureThreshold: 5\n          httpGet:\n            path: /healthz\n            port: 10254\n            scheme: HTTP\n          initialDelaySeconds: 10\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        readinessProbe:\n          failureThreshold: 3\n          httpGet:\n            path: /healthz\n            port: 10254\n            scheme: HTTP\n          initialDelaySeconds: 10\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        ports:\n        - name: http\n          containerPort: 80\n          protocol: TCP\n        - name: https\n          containerPort: 443\n          protocol: TCP\n        - name: webhook\n          containerPort: 8443\n          protocol: TCP\n        volumeMounts:\n        - name: webhook-cert\n          mountPath: /usr/local/certificates/\n          readOnly: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 90Mi\n      nodeSelector:\n        kubernetes.io/os: linux\n      serviceAccountName: release-name-ingress-nginx\n      automountServiceAccountToken: true\n      terminationGracePeriodSeconds: 300\n      volumes:\n      - name: webhook-cert\n        secret:\n          secretName: release-name-ingress-nginx-admission\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"controller\" does not have a read-only root file system"
  },
  {
    "id": "523",
    "manifest_path": "data/manifests/artifacthub/ingress-nginx/ingress-nginx/009_deployment_release-name-ingress-nginx-controller.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    helm.sh/chart: ingress-nginx-4.13.3\n    app.kubernetes.io/name: ingress-nginx\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/version: 1.13.3\n    app.kubernetes.io/part-of: ingress-nginx\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/component: controller\n  name: release-name-ingress-nginx-controller\n  namespace: default\nspec:\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: ingress-nginx\n      app.kubernetes.io/instance: release-name\n      app.kubernetes.io/component: controller\n  replicas: 1\n  revisionHistoryLimit: 10\n  minReadySeconds: 0\n  template:\n    metadata:\n      labels:\n        helm.sh/chart: ingress-nginx-4.13.3\n        app.kubernetes.io/name: ingress-nginx\n        app.kubernetes.io/instance: release-name\n        app.kubernetes.io/version: 1.13.3\n        app.kubernetes.io/part-of: ingress-nginx\n        app.kubernetes.io/managed-by: Helm\n        app.kubernetes.io/component: controller\n    spec:\n      dnsPolicy: ClusterFirst\n      containers:\n      - name: controller\n        image: registry.k8s.io/ingress-nginx/controller:v1.13.3@sha256:1b044f6dcac3afbb59e05d98463f1dec6f3d3fb99940bc12ca5d80270358e3bd\n        imagePullPolicy: IfNotPresent\n        lifecycle:\n          preStop:\n            exec:\n              command:\n              - /wait-shutdown\n        args:\n        - /nginx-ingress-controller\n        - --publish-service=$(POD_NAMESPACE)/release-name-ingress-nginx-controller\n        - --election-id=release-name-ingress-nginx-leader\n        - --controller-class=k8s.io/ingress-nginx\n        - --ingress-class=nginx\n        - --configmap=$(POD_NAMESPACE)/release-name-ingress-nginx-controller\n        - --validating-webhook=:8443\n        - --validating-webhook-certificate=/usr/local/certificates/cert\n        - --validating-webhook-key=/usr/local/certificates/key\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 101\n          runAsGroup: 82\n          allowPrivilegeEscalation: false\n          seccompProfile:\n            type: RuntimeDefault\n          capabilities:\n            drop:\n            - ALL\n            add:\n            - NET_BIND_SERVICE\n          readOnlyRootFilesystem: false\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: LD_PRELOAD\n          value: /usr/local/lib/libmimalloc.so\n        livenessProbe:\n          failureThreshold: 5\n          httpGet:\n            path: /healthz\n            port: 10254\n            scheme: HTTP\n          initialDelaySeconds: 10\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        readinessProbe:\n          failureThreshold: 3\n          httpGet:\n            path: /healthz\n            port: 10254\n            scheme: HTTP\n          initialDelaySeconds: 10\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        ports:\n        - name: http\n          containerPort: 80\n          protocol: TCP\n        - name: https\n          containerPort: 443\n          protocol: TCP\n        - name: webhook\n          containerPort: 8443\n          protocol: TCP\n        volumeMounts:\n        - name: webhook-cert\n          mountPath: /usr/local/certificates/\n          readOnly: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 90Mi\n      nodeSelector:\n        kubernetes.io/os: linux\n      serviceAccountName: release-name-ingress-nginx\n      automountServiceAccountToken: true\n      terminationGracePeriodSeconds: 300\n      volumes:\n      - name: webhook-cert\n        secret:\n          secretName: release-name-ingress-nginx-admission\n",
    "policy_id": "non-existent-service-account",
    "violation_text": "serviceAccount \"release-name-ingress-nginx\" not found"
  },
  {
    "id": "524",
    "manifest_path": "data/manifests/artifacthub/ingress-nginx/ingress-nginx/009_deployment_release-name-ingress-nginx-controller.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    helm.sh/chart: ingress-nginx-4.13.3\n    app.kubernetes.io/name: ingress-nginx\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/version: 1.13.3\n    app.kubernetes.io/part-of: ingress-nginx\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/component: controller\n  name: release-name-ingress-nginx-controller\n  namespace: default\nspec:\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: ingress-nginx\n      app.kubernetes.io/instance: release-name\n      app.kubernetes.io/component: controller\n  replicas: 1\n  revisionHistoryLimit: 10\n  minReadySeconds: 0\n  template:\n    metadata:\n      labels:\n        helm.sh/chart: ingress-nginx-4.13.3\n        app.kubernetes.io/name: ingress-nginx\n        app.kubernetes.io/instance: release-name\n        app.kubernetes.io/version: 1.13.3\n        app.kubernetes.io/part-of: ingress-nginx\n        app.kubernetes.io/managed-by: Helm\n        app.kubernetes.io/component: controller\n    spec:\n      dnsPolicy: ClusterFirst\n      containers:\n      - name: controller\n        image: registry.k8s.io/ingress-nginx/controller:v1.13.3@sha256:1b044f6dcac3afbb59e05d98463f1dec6f3d3fb99940bc12ca5d80270358e3bd\n        imagePullPolicy: IfNotPresent\n        lifecycle:\n          preStop:\n            exec:\n              command:\n              - /wait-shutdown\n        args:\n        - /nginx-ingress-controller\n        - --publish-service=$(POD_NAMESPACE)/release-name-ingress-nginx-controller\n        - --election-id=release-name-ingress-nginx-leader\n        - --controller-class=k8s.io/ingress-nginx\n        - --ingress-class=nginx\n        - --configmap=$(POD_NAMESPACE)/release-name-ingress-nginx-controller\n        - --validating-webhook=:8443\n        - --validating-webhook-certificate=/usr/local/certificates/cert\n        - --validating-webhook-key=/usr/local/certificates/key\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 101\n          runAsGroup: 82\n          allowPrivilegeEscalation: false\n          seccompProfile:\n            type: RuntimeDefault\n          capabilities:\n            drop:\n            - ALL\n            add:\n            - NET_BIND_SERVICE\n          readOnlyRootFilesystem: false\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: LD_PRELOAD\n          value: /usr/local/lib/libmimalloc.so\n        livenessProbe:\n          failureThreshold: 5\n          httpGet:\n            path: /healthz\n            port: 10254\n            scheme: HTTP\n          initialDelaySeconds: 10\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        readinessProbe:\n          failureThreshold: 3\n          httpGet:\n            path: /healthz\n            port: 10254\n            scheme: HTTP\n          initialDelaySeconds: 10\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        ports:\n        - name: http\n          containerPort: 80\n          protocol: TCP\n        - name: https\n          containerPort: 443\n          protocol: TCP\n        - name: webhook\n          containerPort: 8443\n          protocol: TCP\n        volumeMounts:\n        - name: webhook-cert\n          mountPath: /usr/local/certificates/\n          readOnly: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 90Mi\n      nodeSelector:\n        kubernetes.io/os: linux\n      serviceAccountName: release-name-ingress-nginx\n      automountServiceAccountToken: true\n      terminationGracePeriodSeconds: 300\n      volumes:\n      - name: webhook-cert\n        secret:\n          secretName: release-name-ingress-nginx-admission\n",
    "policy_id": "readiness-port",
    "violation_text": "container \"controller\" does not expose port 10254 for the HTTPGet"
  },
  {
    "id": "525",
    "manifest_path": "data/manifests/artifacthub/ingress-nginx/ingress-nginx/009_deployment_release-name-ingress-nginx-controller.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    helm.sh/chart: ingress-nginx-4.13.3\n    app.kubernetes.io/name: ingress-nginx\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/version: 1.13.3\n    app.kubernetes.io/part-of: ingress-nginx\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/component: controller\n  name: release-name-ingress-nginx-controller\n  namespace: default\nspec:\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: ingress-nginx\n      app.kubernetes.io/instance: release-name\n      app.kubernetes.io/component: controller\n  replicas: 1\n  revisionHistoryLimit: 10\n  minReadySeconds: 0\n  template:\n    metadata:\n      labels:\n        helm.sh/chart: ingress-nginx-4.13.3\n        app.kubernetes.io/name: ingress-nginx\n        app.kubernetes.io/instance: release-name\n        app.kubernetes.io/version: 1.13.3\n        app.kubernetes.io/part-of: ingress-nginx\n        app.kubernetes.io/managed-by: Helm\n        app.kubernetes.io/component: controller\n    spec:\n      dnsPolicy: ClusterFirst\n      containers:\n      - name: controller\n        image: registry.k8s.io/ingress-nginx/controller:v1.13.3@sha256:1b044f6dcac3afbb59e05d98463f1dec6f3d3fb99940bc12ca5d80270358e3bd\n        imagePullPolicy: IfNotPresent\n        lifecycle:\n          preStop:\n            exec:\n              command:\n              - /wait-shutdown\n        args:\n        - /nginx-ingress-controller\n        - --publish-service=$(POD_NAMESPACE)/release-name-ingress-nginx-controller\n        - --election-id=release-name-ingress-nginx-leader\n        - --controller-class=k8s.io/ingress-nginx\n        - --ingress-class=nginx\n        - --configmap=$(POD_NAMESPACE)/release-name-ingress-nginx-controller\n        - --validating-webhook=:8443\n        - --validating-webhook-certificate=/usr/local/certificates/cert\n        - --validating-webhook-key=/usr/local/certificates/key\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 101\n          runAsGroup: 82\n          allowPrivilegeEscalation: false\n          seccompProfile:\n            type: RuntimeDefault\n          capabilities:\n            drop:\n            - ALL\n            add:\n            - NET_BIND_SERVICE\n          readOnlyRootFilesystem: false\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: LD_PRELOAD\n          value: /usr/local/lib/libmimalloc.so\n        livenessProbe:\n          failureThreshold: 5\n          httpGet:\n            path: /healthz\n            port: 10254\n            scheme: HTTP\n          initialDelaySeconds: 10\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        readinessProbe:\n          failureThreshold: 3\n          httpGet:\n            path: /healthz\n            port: 10254\n            scheme: HTTP\n          initialDelaySeconds: 10\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        ports:\n        - name: http\n          containerPort: 80\n          protocol: TCP\n        - name: https\n          containerPort: 443\n          protocol: TCP\n        - name: webhook\n          containerPort: 8443\n          protocol: TCP\n        volumeMounts:\n        - name: webhook-cert\n          mountPath: /usr/local/certificates/\n          readOnly: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 90Mi\n      nodeSelector:\n        kubernetes.io/os: linux\n      serviceAccountName: release-name-ingress-nginx\n      automountServiceAccountToken: true\n      terminationGracePeriodSeconds: 300\n      volumes:\n      - name: webhook-cert\n        secret:\n          secretName: release-name-ingress-nginx-admission\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"controller\" has memory limit 0"
  },
  {
    "id": "526",
    "manifest_path": "data/manifests/artifacthub/ingress-nginx/ingress-nginx/017_job_release-name-ingress-nginx-admission-create.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: release-name-ingress-nginx-admission-create\n  namespace: default\n  annotations:\n    helm.sh/hook: pre-install,pre-upgrade\n    helm.sh/hook-delete-policy: before-hook-creation,hook-succeeded\n  labels:\n    helm.sh/chart: ingress-nginx-4.13.3\n    app.kubernetes.io/name: ingress-nginx\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/version: 1.13.3\n    app.kubernetes.io/part-of: ingress-nginx\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/component: admission-webhook\nspec:\n  ttlSecondsAfterFinished: 0\n  template:\n    metadata:\n      name: release-name-ingress-nginx-admission-create\n      labels:\n        helm.sh/chart: ingress-nginx-4.13.3\n        app.kubernetes.io/name: ingress-nginx\n        app.kubernetes.io/instance: release-name\n        app.kubernetes.io/version: 1.13.3\n        app.kubernetes.io/part-of: ingress-nginx\n        app.kubernetes.io/managed-by: Helm\n        app.kubernetes.io/component: admission-webhook\n    spec:\n      containers:\n      - name: create\n        image: registry.k8s.io/ingress-nginx/kube-webhook-certgen:v1.6.3@sha256:3d671cf20a35cd94efc5dcd484970779eb21e7938c98fbc3673693b8a117cf39\n        imagePullPolicy: IfNotPresent\n        args:\n        - create\n        - --host=release-name-ingress-nginx-controller-admission,release-name-ingress-nginx-controller-admission.$(POD_NAMESPACE).svc\n        - --namespace=$(POD_NAMESPACE)\n        - --secret-name=release-name-ingress-nginx-admission\n        env:\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        securityContext:\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - ALL\n          readOnlyRootFilesystem: true\n          runAsGroup: 65532\n          runAsNonRoot: true\n          runAsUser: 65532\n          seccompProfile:\n            type: RuntimeDefault\n      restartPolicy: OnFailure\n      serviceAccountName: release-name-ingress-nginx-admission\n      automountServiceAccountToken: true\n      nodeSelector:\n        kubernetes.io/os: linux\n",
    "policy_id": "non-existent-service-account",
    "violation_text": "serviceAccount \"release-name-ingress-nginx-admission\" not found"
  },
  {
    "id": "527",
    "manifest_path": "data/manifests/artifacthub/ingress-nginx/ingress-nginx/017_job_release-name-ingress-nginx-admission-create.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: release-name-ingress-nginx-admission-create\n  namespace: default\n  annotations:\n    helm.sh/hook: pre-install,pre-upgrade\n    helm.sh/hook-delete-policy: before-hook-creation,hook-succeeded\n  labels:\n    helm.sh/chart: ingress-nginx-4.13.3\n    app.kubernetes.io/name: ingress-nginx\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/version: 1.13.3\n    app.kubernetes.io/part-of: ingress-nginx\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/component: admission-webhook\nspec:\n  ttlSecondsAfterFinished: 0\n  template:\n    metadata:\n      name: release-name-ingress-nginx-admission-create\n      labels:\n        helm.sh/chart: ingress-nginx-4.13.3\n        app.kubernetes.io/name: ingress-nginx\n        app.kubernetes.io/instance: release-name\n        app.kubernetes.io/version: 1.13.3\n        app.kubernetes.io/part-of: ingress-nginx\n        app.kubernetes.io/managed-by: Helm\n        app.kubernetes.io/component: admission-webhook\n    spec:\n      containers:\n      - name: create\n        image: registry.k8s.io/ingress-nginx/kube-webhook-certgen:v1.6.3@sha256:3d671cf20a35cd94efc5dcd484970779eb21e7938c98fbc3673693b8a117cf39\n        imagePullPolicy: IfNotPresent\n        args:\n        - create\n        - --host=release-name-ingress-nginx-controller-admission,release-name-ingress-nginx-controller-admission.$(POD_NAMESPACE).svc\n        - --namespace=$(POD_NAMESPACE)\n        - --secret-name=release-name-ingress-nginx-admission\n        env:\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        securityContext:\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - ALL\n          readOnlyRootFilesystem: true\n          runAsGroup: 65532\n          runAsNonRoot: true\n          runAsUser: 65532\n          seccompProfile:\n            type: RuntimeDefault\n      restartPolicy: OnFailure\n      serviceAccountName: release-name-ingress-nginx-admission\n      automountServiceAccountToken: true\n      nodeSelector:\n        kubernetes.io/os: linux\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"create\" has cpu request 0"
  },
  {
    "id": "528",
    "manifest_path": "data/manifests/artifacthub/ingress-nginx/ingress-nginx/017_job_release-name-ingress-nginx-admission-create.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: release-name-ingress-nginx-admission-create\n  namespace: default\n  annotations:\n    helm.sh/hook: pre-install,pre-upgrade\n    helm.sh/hook-delete-policy: before-hook-creation,hook-succeeded\n  labels:\n    helm.sh/chart: ingress-nginx-4.13.3\n    app.kubernetes.io/name: ingress-nginx\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/version: 1.13.3\n    app.kubernetes.io/part-of: ingress-nginx\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/component: admission-webhook\nspec:\n  ttlSecondsAfterFinished: 0\n  template:\n    metadata:\n      name: release-name-ingress-nginx-admission-create\n      labels:\n        helm.sh/chart: ingress-nginx-4.13.3\n        app.kubernetes.io/name: ingress-nginx\n        app.kubernetes.io/instance: release-name\n        app.kubernetes.io/version: 1.13.3\n        app.kubernetes.io/part-of: ingress-nginx\n        app.kubernetes.io/managed-by: Helm\n        app.kubernetes.io/component: admission-webhook\n    spec:\n      containers:\n      - name: create\n        image: registry.k8s.io/ingress-nginx/kube-webhook-certgen:v1.6.3@sha256:3d671cf20a35cd94efc5dcd484970779eb21e7938c98fbc3673693b8a117cf39\n        imagePullPolicy: IfNotPresent\n        args:\n        - create\n        - --host=release-name-ingress-nginx-controller-admission,release-name-ingress-nginx-controller-admission.$(POD_NAMESPACE).svc\n        - --namespace=$(POD_NAMESPACE)\n        - --secret-name=release-name-ingress-nginx-admission\n        env:\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        securityContext:\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - ALL\n          readOnlyRootFilesystem: true\n          runAsGroup: 65532\n          runAsNonRoot: true\n          runAsUser: 65532\n          seccompProfile:\n            type: RuntimeDefault\n      restartPolicy: OnFailure\n      serviceAccountName: release-name-ingress-nginx-admission\n      automountServiceAccountToken: true\n      nodeSelector:\n        kubernetes.io/os: linux\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"create\" has memory limit 0"
  },
  {
    "id": "529",
    "manifest_path": "data/manifests/artifacthub/ingress-nginx/ingress-nginx/018_job_release-name-ingress-nginx-admission-patch.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: release-name-ingress-nginx-admission-patch\n  namespace: default\n  annotations:\n    helm.sh/hook: post-install,post-upgrade\n    helm.sh/hook-delete-policy: before-hook-creation,hook-succeeded\n  labels:\n    helm.sh/chart: ingress-nginx-4.13.3\n    app.kubernetes.io/name: ingress-nginx\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/version: 1.13.3\n    app.kubernetes.io/part-of: ingress-nginx\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/component: admission-webhook\nspec:\n  ttlSecondsAfterFinished: 0\n  template:\n    metadata:\n      name: release-name-ingress-nginx-admission-patch\n      labels:\n        helm.sh/chart: ingress-nginx-4.13.3\n        app.kubernetes.io/name: ingress-nginx\n        app.kubernetes.io/instance: release-name\n        app.kubernetes.io/version: 1.13.3\n        app.kubernetes.io/part-of: ingress-nginx\n        app.kubernetes.io/managed-by: Helm\n        app.kubernetes.io/component: admission-webhook\n    spec:\n      containers:\n      - name: patch\n        image: registry.k8s.io/ingress-nginx/kube-webhook-certgen:v1.6.3@sha256:3d671cf20a35cd94efc5dcd484970779eb21e7938c98fbc3673693b8a117cf39\n        imagePullPolicy: IfNotPresent\n        args:\n        - patch\n        - --webhook-name=release-name-ingress-nginx-admission\n        - --namespace=$(POD_NAMESPACE)\n        - --patch-mutating=false\n        - --secret-name=release-name-ingress-nginx-admission\n        - --patch-failure-policy=Fail\n        env:\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        securityContext:\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - ALL\n          readOnlyRootFilesystem: true\n          runAsGroup: 65532\n          runAsNonRoot: true\n          runAsUser: 65532\n          seccompProfile:\n            type: RuntimeDefault\n      restartPolicy: OnFailure\n      serviceAccountName: release-name-ingress-nginx-admission\n      automountServiceAccountToken: true\n      nodeSelector:\n        kubernetes.io/os: linux\n",
    "policy_id": "non-existent-service-account",
    "violation_text": "serviceAccount \"release-name-ingress-nginx-admission\" not found"
  },
  {
    "id": "530",
    "manifest_path": "data/manifests/artifacthub/ingress-nginx/ingress-nginx/018_job_release-name-ingress-nginx-admission-patch.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: release-name-ingress-nginx-admission-patch\n  namespace: default\n  annotations:\n    helm.sh/hook: post-install,post-upgrade\n    helm.sh/hook-delete-policy: before-hook-creation,hook-succeeded\n  labels:\n    helm.sh/chart: ingress-nginx-4.13.3\n    app.kubernetes.io/name: ingress-nginx\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/version: 1.13.3\n    app.kubernetes.io/part-of: ingress-nginx\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/component: admission-webhook\nspec:\n  ttlSecondsAfterFinished: 0\n  template:\n    metadata:\n      name: release-name-ingress-nginx-admission-patch\n      labels:\n        helm.sh/chart: ingress-nginx-4.13.3\n        app.kubernetes.io/name: ingress-nginx\n        app.kubernetes.io/instance: release-name\n        app.kubernetes.io/version: 1.13.3\n        app.kubernetes.io/part-of: ingress-nginx\n        app.kubernetes.io/managed-by: Helm\n        app.kubernetes.io/component: admission-webhook\n    spec:\n      containers:\n      - name: patch\n        image: registry.k8s.io/ingress-nginx/kube-webhook-certgen:v1.6.3@sha256:3d671cf20a35cd94efc5dcd484970779eb21e7938c98fbc3673693b8a117cf39\n        imagePullPolicy: IfNotPresent\n        args:\n        - patch\n        - --webhook-name=release-name-ingress-nginx-admission\n        - --namespace=$(POD_NAMESPACE)\n        - --patch-mutating=false\n        - --secret-name=release-name-ingress-nginx-admission\n        - --patch-failure-policy=Fail\n        env:\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        securityContext:\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - ALL\n          readOnlyRootFilesystem: true\n          runAsGroup: 65532\n          runAsNonRoot: true\n          runAsUser: 65532\n          seccompProfile:\n            type: RuntimeDefault\n      restartPolicy: OnFailure\n      serviceAccountName: release-name-ingress-nginx-admission\n      automountServiceAccountToken: true\n      nodeSelector:\n        kubernetes.io/os: linux\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"patch\" has cpu request 0"
  },
  {
    "id": "531",
    "manifest_path": "data/manifests/artifacthub/ingress-nginx/ingress-nginx/018_job_release-name-ingress-nginx-admission-patch.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: release-name-ingress-nginx-admission-patch\n  namespace: default\n  annotations:\n    helm.sh/hook: post-install,post-upgrade\n    helm.sh/hook-delete-policy: before-hook-creation,hook-succeeded\n  labels:\n    helm.sh/chart: ingress-nginx-4.13.3\n    app.kubernetes.io/name: ingress-nginx\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/version: 1.13.3\n    app.kubernetes.io/part-of: ingress-nginx\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/component: admission-webhook\nspec:\n  ttlSecondsAfterFinished: 0\n  template:\n    metadata:\n      name: release-name-ingress-nginx-admission-patch\n      labels:\n        helm.sh/chart: ingress-nginx-4.13.3\n        app.kubernetes.io/name: ingress-nginx\n        app.kubernetes.io/instance: release-name\n        app.kubernetes.io/version: 1.13.3\n        app.kubernetes.io/part-of: ingress-nginx\n        app.kubernetes.io/managed-by: Helm\n        app.kubernetes.io/component: admission-webhook\n    spec:\n      containers:\n      - name: patch\n        image: registry.k8s.io/ingress-nginx/kube-webhook-certgen:v1.6.3@sha256:3d671cf20a35cd94efc5dcd484970779eb21e7938c98fbc3673693b8a117cf39\n        imagePullPolicy: IfNotPresent\n        args:\n        - patch\n        - --webhook-name=release-name-ingress-nginx-admission\n        - --namespace=$(POD_NAMESPACE)\n        - --patch-mutating=false\n        - --secret-name=release-name-ingress-nginx-admission\n        - --patch-failure-policy=Fail\n        env:\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        securityContext:\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - ALL\n          readOnlyRootFilesystem: true\n          runAsGroup: 65532\n          runAsNonRoot: true\n          runAsUser: 65532\n          seccompProfile:\n            type: RuntimeDefault\n      restartPolicy: OnFailure\n      serviceAccountName: release-name-ingress-nginx-admission\n      automountServiceAccountToken: true\n      nodeSelector:\n        kubernetes.io/os: linux\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"patch\" has memory limit 0"
  },
  {
    "id": "532",
    "manifest_path": "data/manifests/artifacthub/istio-official/istiod/001_poddisruptionbudget_istiod.yaml",
    "manifest_yaml": "apiVersion: policy/v1\nkind: PodDisruptionBudget\nmetadata:\n  name: istiod\n  namespace: default\n  labels:\n    app: istiod\n    istio.io/rev: default\n    install.operator.istio.io/owning-resource: unknown\n    operator.istio.io/component: Pilot\n    release: release-name\n    istio: pilot\n    app.kubernetes.io/name: istiod\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/part-of: istio\n    app.kubernetes.io/version: 1.27.1\n    helm.sh/chart: istiod-1.27.1\nspec:\n  minAvailable: 1\n  selector:\n    matchLabels:\n      app: istiod\n      istio: pilot\n",
    "policy_id": "pdb-unhealthy-pod-eviction-policy",
    "violation_text": "unhealthyPodEvictionPolicy is not explicitly set"
  },
  {
    "id": "533",
    "manifest_path": "data/manifests/artifacthub/istio-official/istiod/014_service_istiod.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Service\nmetadata:\n  name: istiod\n  namespace: default\n  labels:\n    istio.io/rev: default\n    install.operator.istio.io/owning-resource: unknown\n    operator.istio.io/component: Pilot\n    app: istiod\n    istio: pilot\n    release: release-name\n    app.kubernetes.io/name: istiod\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/part-of: istio\n    app.kubernetes.io/version: 1.27.1\n    helm.sh/chart: istiod-1.27.1\nspec:\n  ports:\n  - port: 15010\n    name: grpc-xds\n    protocol: TCP\n  - port: 15012\n    name: https-dns\n    protocol: TCP\n  - port: 443\n    name: https-webhook\n    targetPort: 15017\n    protocol: TCP\n  - port: 15014\n    name: http-monitoring\n    protocol: TCP\n  selector:\n    app: istiod\n    istio: pilot\n",
    "policy_id": "dangling-service",
    "violation_text": "no pods found matching service labels (map[app:istiod istio:pilot])"
  },
  {
    "id": "534",
    "manifest_path": "data/manifests/artifacthub/istio-official/istiod/015_deployment_istiod.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: istiod\n  namespace: default\n  labels:\n    app: istiod\n    istio.io/rev: default\n    install.operator.istio.io/owning-resource: unknown\n    operator.istio.io/component: Pilot\n    istio: pilot\n    release: release-name\n    app.kubernetes.io/name: istiod\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/part-of: istio\n    app.kubernetes.io/version: 1.27.1\n    helm.sh/chart: istiod-1.27.1\nspec:\n  strategy:\n    rollingUpdate:\n      maxSurge: 100%\n      maxUnavailable: 25%\n  selector:\n    matchLabels:\n      istio: pilot\n  template:\n    metadata:\n      labels:\n        app: istiod\n        istio.io/rev: default\n        install.operator.istio.io/owning-resource: unknown\n        sidecar.istio.io/inject: 'false'\n        operator.istio.io/component: Pilot\n        istio: pilot\n        istio.io/dataplane-mode: none\n        app.kubernetes.io/name: istiod\n        app.kubernetes.io/managed-by: Helm\n        app.kubernetes.io/instance: release-name\n        app.kubernetes.io/part-of: istio\n        app.kubernetes.io/version: 1.27.1\n        helm.sh/chart: istiod-1.27.1\n      annotations:\n        prometheus.io/port: '15014'\n        prometheus.io/scrape: 'true'\n        sidecar.istio.io/inject: 'false'\n    spec:\n      tolerations:\n      - key: cni.istio.io/not-ready\n        operator: Exists\n      serviceAccountName: istiod\n      containers:\n      - name: discovery\n        image: docker.io/istio/pilot:1.27.1\n        args:\n        - discovery\n        - --monitoringAddr=:15014\n        - --log_output_level=default:info\n        - --domain\n        - cluster.local\n        - --keepaliveMaxServerConnectionAge\n        - 30m\n        ports:\n        - containerPort: 8080\n          protocol: TCP\n          name: http-debug\n        - containerPort: 15010\n          protocol: TCP\n          name: grpc-xds\n        - containerPort: 15012\n          protocol: TCP\n          name: tls-xds\n        - containerPort: 15017\n          protocol: TCP\n          name: https-webhooks\n        - containerPort: 15014\n          protocol: TCP\n          name: http-monitoring\n        readinessProbe:\n          httpGet:\n            path: /ready\n            port: 8080\n          initialDelaySeconds: 1\n          periodSeconds: 3\n          timeoutSeconds: 5\n        env:\n        - name: REVISION\n          value: default\n        - name: PILOT_CERT_PROVIDER\n          value: istiod\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              apiVersion: v1\n              fieldPath: metadata.name\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              apiVersion: v1\n              fieldPath: metadata.namespace\n        - name: SERVICE_ACCOUNT\n          valueFrom:\n            fieldRef:\n              apiVersion: v1\n              fieldPath: spec.serviceAccountName\n        - name: KUBECONFIG\n          value: /var/run/secrets/remote/config\n        - name: CA_TRUSTED_NODE_ACCOUNTS\n          value: default/ztunnel\n        - name: PILOT_TRACE_SAMPLING\n          value: '1'\n        - name: PILOT_ENABLE_ANALYSIS\n          value: 'false'\n        - name: CLUSTER_ID\n          value: Kubernetes\n        - name: GOMEMLIMIT\n          valueFrom:\n            resourceFieldRef:\n              resource: limits.memory\n              divisor: '1'\n        - name: GOMAXPROCS\n          valueFrom:\n            resourceFieldRef:\n              resource: limits.cpu\n              divisor: '1'\n        - name: PLATFORM\n          value: ''\n        resources:\n          requests:\n            cpu: 500m\n            memory: 2048Mi\n        securityContext:\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          runAsNonRoot: true\n          capabilities:\n            drop:\n            - ALL\n        volumeMounts:\n        - name: istio-token\n          mountPath: /var/run/secrets/tokens\n          readOnly: true\n        - name: local-certs\n          mountPath: /var/run/secrets/istio-dns\n        - name: cacerts\n          mountPath: /etc/cacerts\n          readOnly: true\n        - name: istio-kubeconfig\n          mountPath: /var/run/secrets/remote\n          readOnly: true\n        - name: istio-csr-dns-cert\n          mountPath: /var/run/secrets/istiod/tls\n          readOnly: true\n        - name: istio-csr-ca-configmap\n          mountPath: /var/run/secrets/istiod/ca\n          readOnly: true\n      volumes:\n      - emptyDir:\n          medium: Memory\n        name: local-certs\n      - name: istio-token\n        projected:\n          sources:\n          - serviceAccountToken:\n              audience: istio-ca\n              expirationSeconds: 43200\n              path: istio-token\n      - name: cacerts\n        secret:\n          secretName: cacerts\n          optional: true\n      - name: istio-kubeconfig\n        secret:\n          secretName: istio-kubeconfig\n          optional: true\n      - name: istio-csr-dns-cert\n        secret:\n          secretName: istiod-tls\n          optional: true\n      - name: istio-csr-ca-configmap\n        configMap:\n          name: istio-ca-root-cert\n          defaultMode: 420\n          optional: true\n",
    "policy_id": "non-existent-service-account",
    "violation_text": "serviceAccount \"istiod\" not found"
  },
  {
    "id": "535",
    "manifest_path": "data/manifests/artifacthub/istio-official/istiod/015_deployment_istiod.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: istiod\n  namespace: default\n  labels:\n    app: istiod\n    istio.io/rev: default\n    install.operator.istio.io/owning-resource: unknown\n    operator.istio.io/component: Pilot\n    istio: pilot\n    release: release-name\n    app.kubernetes.io/name: istiod\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/part-of: istio\n    app.kubernetes.io/version: 1.27.1\n    helm.sh/chart: istiod-1.27.1\nspec:\n  strategy:\n    rollingUpdate:\n      maxSurge: 100%\n      maxUnavailable: 25%\n  selector:\n    matchLabels:\n      istio: pilot\n  template:\n    metadata:\n      labels:\n        app: istiod\n        istio.io/rev: default\n        install.operator.istio.io/owning-resource: unknown\n        sidecar.istio.io/inject: 'false'\n        operator.istio.io/component: Pilot\n        istio: pilot\n        istio.io/dataplane-mode: none\n        app.kubernetes.io/name: istiod\n        app.kubernetes.io/managed-by: Helm\n        app.kubernetes.io/instance: release-name\n        app.kubernetes.io/part-of: istio\n        app.kubernetes.io/version: 1.27.1\n        helm.sh/chart: istiod-1.27.1\n      annotations:\n        prometheus.io/port: '15014'\n        prometheus.io/scrape: 'true'\n        sidecar.istio.io/inject: 'false'\n    spec:\n      tolerations:\n      - key: cni.istio.io/not-ready\n        operator: Exists\n      serviceAccountName: istiod\n      containers:\n      - name: discovery\n        image: docker.io/istio/pilot:1.27.1\n        args:\n        - discovery\n        - --monitoringAddr=:15014\n        - --log_output_level=default:info\n        - --domain\n        - cluster.local\n        - --keepaliveMaxServerConnectionAge\n        - 30m\n        ports:\n        - containerPort: 8080\n          protocol: TCP\n          name: http-debug\n        - containerPort: 15010\n          protocol: TCP\n          name: grpc-xds\n        - containerPort: 15012\n          protocol: TCP\n          name: tls-xds\n        - containerPort: 15017\n          protocol: TCP\n          name: https-webhooks\n        - containerPort: 15014\n          protocol: TCP\n          name: http-monitoring\n        readinessProbe:\n          httpGet:\n            path: /ready\n            port: 8080\n          initialDelaySeconds: 1\n          periodSeconds: 3\n          timeoutSeconds: 5\n        env:\n        - name: REVISION\n          value: default\n        - name: PILOT_CERT_PROVIDER\n          value: istiod\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              apiVersion: v1\n              fieldPath: metadata.name\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              apiVersion: v1\n              fieldPath: metadata.namespace\n        - name: SERVICE_ACCOUNT\n          valueFrom:\n            fieldRef:\n              apiVersion: v1\n              fieldPath: spec.serviceAccountName\n        - name: KUBECONFIG\n          value: /var/run/secrets/remote/config\n        - name: CA_TRUSTED_NODE_ACCOUNTS\n          value: default/ztunnel\n        - name: PILOT_TRACE_SAMPLING\n          value: '1'\n        - name: PILOT_ENABLE_ANALYSIS\n          value: 'false'\n        - name: CLUSTER_ID\n          value: Kubernetes\n        - name: GOMEMLIMIT\n          valueFrom:\n            resourceFieldRef:\n              resource: limits.memory\n              divisor: '1'\n        - name: GOMAXPROCS\n          valueFrom:\n            resourceFieldRef:\n              resource: limits.cpu\n              divisor: '1'\n        - name: PLATFORM\n          value: ''\n        resources:\n          requests:\n            cpu: 500m\n            memory: 2048Mi\n        securityContext:\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          runAsNonRoot: true\n          capabilities:\n            drop:\n            - ALL\n        volumeMounts:\n        - name: istio-token\n          mountPath: /var/run/secrets/tokens\n          readOnly: true\n        - name: local-certs\n          mountPath: /var/run/secrets/istio-dns\n        - name: cacerts\n          mountPath: /etc/cacerts\n          readOnly: true\n        - name: istio-kubeconfig\n          mountPath: /var/run/secrets/remote\n          readOnly: true\n        - name: istio-csr-dns-cert\n          mountPath: /var/run/secrets/istiod/tls\n          readOnly: true\n        - name: istio-csr-ca-configmap\n          mountPath: /var/run/secrets/istiod/ca\n          readOnly: true\n      volumes:\n      - emptyDir:\n          medium: Memory\n        name: local-certs\n      - name: istio-token\n        projected:\n          sources:\n          - serviceAccountToken:\n              audience: istio-ca\n              expirationSeconds: 43200\n              path: istio-token\n      - name: cacerts\n        secret:\n          secretName: cacerts\n          optional: true\n      - name: istio-kubeconfig\n        secret:\n          secretName: istio-kubeconfig\n          optional: true\n      - name: istio-csr-dns-cert\n        secret:\n          secretName: istiod-tls\n          optional: true\n      - name: istio-csr-ca-configmap\n        configMap:\n          name: istio-ca-root-cert\n          defaultMode: 420\n          optional: true\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"discovery\" has memory limit 0"
  },
  {
    "id": "536",
    "manifest_path": "data/manifests/artifacthub/jenkinsci/jenkins/010_service_release-name-jenkins-agent.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Service\nmetadata:\n  name: release-name-jenkins-agent\n  namespace: default\n  labels:\n    app.kubernetes.io/name: jenkins\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/component: jenkins-controller\n    helm.sh/chart: jenkins-5.8.98\nspec:\n  ports:\n  - port: 50000\n    targetPort: 50000\n    name: agent-listener\n  selector:\n    app.kubernetes.io/component: jenkins-controller\n    app.kubernetes.io/instance: release-name\n  type: ClusterIP\n",
    "policy_id": "dangling-service",
    "violation_text": "no pods found matching service labels (map[app.kubernetes.io/component:jenkins-controller app.kubernetes.io/instance:release-name])"
  },
  {
    "id": "537",
    "manifest_path": "data/manifests/artifacthub/jenkinsci/jenkins/011_service_release-name-jenkins.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Service\nmetadata:\n  name: release-name-jenkins\n  namespace: default\n  labels:\n    app.kubernetes.io/name: jenkins\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/component: jenkins-controller\n    helm.sh/chart: jenkins-5.8.98\nspec:\n  ports:\n  - port: 8080\n    name: http\n    targetPort: 8080\n  selector:\n    app.kubernetes.io/component: jenkins-controller\n    app.kubernetes.io/instance: release-name\n  type: ClusterIP\n",
    "policy_id": "dangling-service",
    "violation_text": "no pods found matching service labels (map[app.kubernetes.io/component:jenkins-controller app.kubernetes.io/instance:release-name])"
  },
  {
    "id": "538",
    "manifest_path": "data/manifests/artifacthub/jenkinsci/jenkins/012_statefulset_release-name-jenkins.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: release-name-jenkins\n  namespace: default\n  labels:\n    app.kubernetes.io/name: jenkins\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/component: jenkins-controller\n    helm.sh/chart: jenkins-5.8.98\nspec:\n  serviceName: release-name-jenkins\n  replicas: 1\n  selector:\n    matchLabels:\n      app.kubernetes.io/component: jenkins-controller\n      app.kubernetes.io/instance: release-name\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/name: jenkins\n        app.kubernetes.io/managed-by: Helm\n        app.kubernetes.io/instance: release-name\n        app.kubernetes.io/component: jenkins-controller\n        helm.sh/chart: jenkins-5.8.98\n      annotations:\n        checksum/config: e05b6d43d9ba96c1b1cd78116a387bdc4a776b05046455033c876ade1617360e\n    spec:\n      enableServiceLinks: false\n      securityContext:\n        runAsUser: 1000\n        fsGroup: 1000\n        runAsNonRoot: true\n      serviceAccountName: release-name-jenkins\n      automountServiceAccountToken: true\n      initContainers:\n      - name: config-reload-init\n        image: docker.io/kiwigrid/k8s-sidecar:1.30.7\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: LABEL\n          value: release-name-jenkins-jenkins-config\n        - name: FOLDER\n          value: /var/jenkins_home/casc_configs\n        - name: NAMESPACE\n          value: default\n        - name: METHOD\n          value: LIST\n        resources: {}\n        volumeMounts:\n        - name: sc-config-volume\n          mountPath: /var/jenkins_home/casc_configs\n        - name: jenkins-home\n          mountPath: /var/jenkins_home\n      - name: init\n        image: docker.io/jenkins/jenkins:2.516.3-jdk21\n        imagePullPolicy: Always\n        securityContext:\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          runAsGroup: 1000\n          runAsUser: 1000\n        command:\n        - sh\n        - /var/jenkins_config/apply_config.sh\n        resources:\n          limits:\n            cpu: 2000m\n            memory: 4096Mi\n          requests:\n            cpu: 50m\n            memory: 256Mi\n        volumeMounts:\n        - mountPath: /var/jenkins_home\n          name: jenkins-home\n        - mountPath: /var/jenkins_config\n          name: jenkins-config\n        - mountPath: /usr/share/jenkins/ref/plugins\n          name: plugins\n        - mountPath: /var/jenkins_plugins\n          name: plugin-dir\n        - mountPath: /tmp\n          name: tmp-volume\n      containers:\n      - name: jenkins\n        image: docker.io/jenkins/jenkins:2.516.3-jdk21\n        imagePullPolicy: Always\n        securityContext:\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          runAsGroup: 1000\n          runAsUser: 1000\n        args:\n        - --httpPort=8080\n        env:\n        - name: SECRETS\n          value: /run/secrets/additional\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: JAVA_OPTS\n          value: '-Dcasc.reload.token=$(POD_NAME) '\n        - name: JENKINS_OPTS\n          value: '--webroot=/var/jenkins_cache/war '\n        - name: JENKINS_SLAVE_AGENT_PORT\n          value: '50000'\n        - name: CASC_JENKINS_CONFIG\n          value: /var/jenkins_home/casc_configs\n        ports:\n        - containerPort: 8080\n          name: http\n        - containerPort: 50000\n          name: agent-listener\n        startupProbe:\n          failureThreshold: 12\n          httpGet:\n            path: /login\n            port: http\n          periodSeconds: 10\n          timeoutSeconds: 5\n        livenessProbe:\n          failureThreshold: 5\n          httpGet:\n            path: /login\n            port: http\n          initialDelaySeconds: null\n          periodSeconds: 10\n          timeoutSeconds: 5\n        readinessProbe:\n          failureThreshold: 3\n          httpGet:\n            path: /login\n            port: http\n          initialDelaySeconds: null\n          periodSeconds: 10\n          timeoutSeconds: 5\n        resources:\n          limits:\n            cpu: 2000m\n            memory: 4096Mi\n          requests:\n            cpu: 50m\n            memory: 256Mi\n        volumeMounts:\n        - mountPath: /var/jenkins_home\n          name: jenkins-home\n          readOnly: false\n        - mountPath: /var/jenkins_config\n          name: jenkins-config\n          readOnly: true\n        - mountPath: /usr/share/jenkins/ref/plugins/\n          name: plugin-dir\n          readOnly: false\n        - name: sc-config-volume\n          mountPath: /var/jenkins_home/casc_configs\n        - name: jenkins-secrets\n          mountPath: /run/secrets/additional\n          readOnly: true\n        - name: jenkins-cache\n          mountPath: /var/jenkins_cache\n        - mountPath: /tmp\n          name: tmp-volume\n      - name: config-reload\n        image: docker.io/kiwigrid/k8s-sidecar:1.30.7\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: LABEL\n          value: release-name-jenkins-jenkins-config\n        - name: FOLDER\n          value: /var/jenkins_home/casc_configs\n        - name: NAMESPACE\n          value: default\n        - name: REQ_URL\n          value: http://localhost:8080/reload-configuration-as-code/?casc-reload-token=$(POD_NAME)\n        - name: REQ_METHOD\n          value: POST\n        - name: REQ_RETRY_CONNECT\n          value: '10'\n        resources: {}\n        volumeMounts:\n        - name: sc-config-volume\n          mountPath: /var/jenkins_home/casc_configs\n        - name: jenkins-home\n          mountPath: /var/jenkins_home\n      volumes:\n      - name: plugins\n        emptyDir: {}\n      - name: jenkins-config\n        configMap:\n          name: release-name-jenkins\n      - name: plugin-dir\n        emptyDir: {}\n      - name: jenkins-secrets\n        projected:\n          sources:\n          - secret:\n              name: release-name-jenkins\n              items:\n              - key: jenkins-admin-user\n                path: chart-admin-username\n              - key: jenkins-admin-password\n                path: chart-admin-password\n      - name: jenkins-cache\n        emptyDir: {}\n      - name: jenkins-home\n        persistentVolumeClaim:\n          claimName: release-name-jenkins\n      - name: sc-config-volume\n        emptyDir: {}\n      - name: tmp-volume\n        emptyDir: {}\n",
    "policy_id": "env-var-secret",
    "violation_text": "environment variable SECRETS in container \"jenkins\" found"
  },
  {
    "id": "539",
    "manifest_path": "data/manifests/artifacthub/jenkinsci/jenkins/012_statefulset_release-name-jenkins.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: release-name-jenkins\n  namespace: default\n  labels:\n    app.kubernetes.io/name: jenkins\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/component: jenkins-controller\n    helm.sh/chart: jenkins-5.8.98\nspec:\n  serviceName: release-name-jenkins\n  replicas: 1\n  selector:\n    matchLabels:\n      app.kubernetes.io/component: jenkins-controller\n      app.kubernetes.io/instance: release-name\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/name: jenkins\n        app.kubernetes.io/managed-by: Helm\n        app.kubernetes.io/instance: release-name\n        app.kubernetes.io/component: jenkins-controller\n        helm.sh/chart: jenkins-5.8.98\n      annotations:\n        checksum/config: e05b6d43d9ba96c1b1cd78116a387bdc4a776b05046455033c876ade1617360e\n    spec:\n      enableServiceLinks: false\n      securityContext:\n        runAsUser: 1000\n        fsGroup: 1000\n        runAsNonRoot: true\n      serviceAccountName: release-name-jenkins\n      automountServiceAccountToken: true\n      initContainers:\n      - name: config-reload-init\n        image: docker.io/kiwigrid/k8s-sidecar:1.30.7\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: LABEL\n          value: release-name-jenkins-jenkins-config\n        - name: FOLDER\n          value: /var/jenkins_home/casc_configs\n        - name: NAMESPACE\n          value: default\n        - name: METHOD\n          value: LIST\n        resources: {}\n        volumeMounts:\n        - name: sc-config-volume\n          mountPath: /var/jenkins_home/casc_configs\n        - name: jenkins-home\n          mountPath: /var/jenkins_home\n      - name: init\n        image: docker.io/jenkins/jenkins:2.516.3-jdk21\n        imagePullPolicy: Always\n        securityContext:\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          runAsGroup: 1000\n          runAsUser: 1000\n        command:\n        - sh\n        - /var/jenkins_config/apply_config.sh\n        resources:\n          limits:\n            cpu: 2000m\n            memory: 4096Mi\n          requests:\n            cpu: 50m\n            memory: 256Mi\n        volumeMounts:\n        - mountPath: /var/jenkins_home\n          name: jenkins-home\n        - mountPath: /var/jenkins_config\n          name: jenkins-config\n        - mountPath: /usr/share/jenkins/ref/plugins\n          name: plugins\n        - mountPath: /var/jenkins_plugins\n          name: plugin-dir\n        - mountPath: /tmp\n          name: tmp-volume\n      containers:\n      - name: jenkins\n        image: docker.io/jenkins/jenkins:2.516.3-jdk21\n        imagePullPolicy: Always\n        securityContext:\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          runAsGroup: 1000\n          runAsUser: 1000\n        args:\n        - --httpPort=8080\n        env:\n        - name: SECRETS\n          value: /run/secrets/additional\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: JAVA_OPTS\n          value: '-Dcasc.reload.token=$(POD_NAME) '\n        - name: JENKINS_OPTS\n          value: '--webroot=/var/jenkins_cache/war '\n        - name: JENKINS_SLAVE_AGENT_PORT\n          value: '50000'\n        - name: CASC_JENKINS_CONFIG\n          value: /var/jenkins_home/casc_configs\n        ports:\n        - containerPort: 8080\n          name: http\n        - containerPort: 50000\n          name: agent-listener\n        startupProbe:\n          failureThreshold: 12\n          httpGet:\n            path: /login\n            port: http\n          periodSeconds: 10\n          timeoutSeconds: 5\n        livenessProbe:\n          failureThreshold: 5\n          httpGet:\n            path: /login\n            port: http\n          initialDelaySeconds: null\n          periodSeconds: 10\n          timeoutSeconds: 5\n        readinessProbe:\n          failureThreshold: 3\n          httpGet:\n            path: /login\n            port: http\n          initialDelaySeconds: null\n          periodSeconds: 10\n          timeoutSeconds: 5\n        resources:\n          limits:\n            cpu: 2000m\n            memory: 4096Mi\n          requests:\n            cpu: 50m\n            memory: 256Mi\n        volumeMounts:\n        - mountPath: /var/jenkins_home\n          name: jenkins-home\n          readOnly: false\n        - mountPath: /var/jenkins_config\n          name: jenkins-config\n          readOnly: true\n        - mountPath: /usr/share/jenkins/ref/plugins/\n          name: plugin-dir\n          readOnly: false\n        - name: sc-config-volume\n          mountPath: /var/jenkins_home/casc_configs\n        - name: jenkins-secrets\n          mountPath: /run/secrets/additional\n          readOnly: true\n        - name: jenkins-cache\n          mountPath: /var/jenkins_cache\n        - mountPath: /tmp\n          name: tmp-volume\n      - name: config-reload\n        image: docker.io/kiwigrid/k8s-sidecar:1.30.7\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: LABEL\n          value: release-name-jenkins-jenkins-config\n        - name: FOLDER\n          value: /var/jenkins_home/casc_configs\n        - name: NAMESPACE\n          value: default\n        - name: REQ_URL\n          value: http://localhost:8080/reload-configuration-as-code/?casc-reload-token=$(POD_NAME)\n        - name: REQ_METHOD\n          value: POST\n        - name: REQ_RETRY_CONNECT\n          value: '10'\n        resources: {}\n        volumeMounts:\n        - name: sc-config-volume\n          mountPath: /var/jenkins_home/casc_configs\n        - name: jenkins-home\n          mountPath: /var/jenkins_home\n      volumes:\n      - name: plugins\n        emptyDir: {}\n      - name: jenkins-config\n        configMap:\n          name: release-name-jenkins\n      - name: plugin-dir\n        emptyDir: {}\n      - name: jenkins-secrets\n        projected:\n          sources:\n          - secret:\n              name: release-name-jenkins\n              items:\n              - key: jenkins-admin-user\n                path: chart-admin-username\n              - key: jenkins-admin-password\n                path: chart-admin-password\n      - name: jenkins-cache\n        emptyDir: {}\n      - name: jenkins-home\n        persistentVolumeClaim:\n          claimName: release-name-jenkins\n      - name: sc-config-volume\n        emptyDir: {}\n      - name: tmp-volume\n        emptyDir: {}\n",
    "policy_id": "non-existent-service-account",
    "violation_text": "serviceAccount \"release-name-jenkins\" not found"
  },
  {
    "id": "540",
    "manifest_path": "data/manifests/artifacthub/jenkinsci/jenkins/012_statefulset_release-name-jenkins.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: release-name-jenkins\n  namespace: default\n  labels:\n    app.kubernetes.io/name: jenkins\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/component: jenkins-controller\n    helm.sh/chart: jenkins-5.8.98\nspec:\n  serviceName: release-name-jenkins\n  replicas: 1\n  selector:\n    matchLabels:\n      app.kubernetes.io/component: jenkins-controller\n      app.kubernetes.io/instance: release-name\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/name: jenkins\n        app.kubernetes.io/managed-by: Helm\n        app.kubernetes.io/instance: release-name\n        app.kubernetes.io/component: jenkins-controller\n        helm.sh/chart: jenkins-5.8.98\n      annotations:\n        checksum/config: e05b6d43d9ba96c1b1cd78116a387bdc4a776b05046455033c876ade1617360e\n    spec:\n      enableServiceLinks: false\n      securityContext:\n        runAsUser: 1000\n        fsGroup: 1000\n        runAsNonRoot: true\n      serviceAccountName: release-name-jenkins\n      automountServiceAccountToken: true\n      initContainers:\n      - name: config-reload-init\n        image: docker.io/kiwigrid/k8s-sidecar:1.30.7\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: LABEL\n          value: release-name-jenkins-jenkins-config\n        - name: FOLDER\n          value: /var/jenkins_home/casc_configs\n        - name: NAMESPACE\n          value: default\n        - name: METHOD\n          value: LIST\n        resources: {}\n        volumeMounts:\n        - name: sc-config-volume\n          mountPath: /var/jenkins_home/casc_configs\n        - name: jenkins-home\n          mountPath: /var/jenkins_home\n      - name: init\n        image: docker.io/jenkins/jenkins:2.516.3-jdk21\n        imagePullPolicy: Always\n        securityContext:\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          runAsGroup: 1000\n          runAsUser: 1000\n        command:\n        - sh\n        - /var/jenkins_config/apply_config.sh\n        resources:\n          limits:\n            cpu: 2000m\n            memory: 4096Mi\n          requests:\n            cpu: 50m\n            memory: 256Mi\n        volumeMounts:\n        - mountPath: /var/jenkins_home\n          name: jenkins-home\n        - mountPath: /var/jenkins_config\n          name: jenkins-config\n        - mountPath: /usr/share/jenkins/ref/plugins\n          name: plugins\n        - mountPath: /var/jenkins_plugins\n          name: plugin-dir\n        - mountPath: /tmp\n          name: tmp-volume\n      containers:\n      - name: jenkins\n        image: docker.io/jenkins/jenkins:2.516.3-jdk21\n        imagePullPolicy: Always\n        securityContext:\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          runAsGroup: 1000\n          runAsUser: 1000\n        args:\n        - --httpPort=8080\n        env:\n        - name: SECRETS\n          value: /run/secrets/additional\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: JAVA_OPTS\n          value: '-Dcasc.reload.token=$(POD_NAME) '\n        - name: JENKINS_OPTS\n          value: '--webroot=/var/jenkins_cache/war '\n        - name: JENKINS_SLAVE_AGENT_PORT\n          value: '50000'\n        - name: CASC_JENKINS_CONFIG\n          value: /var/jenkins_home/casc_configs\n        ports:\n        - containerPort: 8080\n          name: http\n        - containerPort: 50000\n          name: agent-listener\n        startupProbe:\n          failureThreshold: 12\n          httpGet:\n            path: /login\n            port: http\n          periodSeconds: 10\n          timeoutSeconds: 5\n        livenessProbe:\n          failureThreshold: 5\n          httpGet:\n            path: /login\n            port: http\n          initialDelaySeconds: null\n          periodSeconds: 10\n          timeoutSeconds: 5\n        readinessProbe:\n          failureThreshold: 3\n          httpGet:\n            path: /login\n            port: http\n          initialDelaySeconds: null\n          periodSeconds: 10\n          timeoutSeconds: 5\n        resources:\n          limits:\n            cpu: 2000m\n            memory: 4096Mi\n          requests:\n            cpu: 50m\n            memory: 256Mi\n        volumeMounts:\n        - mountPath: /var/jenkins_home\n          name: jenkins-home\n          readOnly: false\n        - mountPath: /var/jenkins_config\n          name: jenkins-config\n          readOnly: true\n        - mountPath: /usr/share/jenkins/ref/plugins/\n          name: plugin-dir\n          readOnly: false\n        - name: sc-config-volume\n          mountPath: /var/jenkins_home/casc_configs\n        - name: jenkins-secrets\n          mountPath: /run/secrets/additional\n          readOnly: true\n        - name: jenkins-cache\n          mountPath: /var/jenkins_cache\n        - mountPath: /tmp\n          name: tmp-volume\n      - name: config-reload\n        image: docker.io/kiwigrid/k8s-sidecar:1.30.7\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: LABEL\n          value: release-name-jenkins-jenkins-config\n        - name: FOLDER\n          value: /var/jenkins_home/casc_configs\n        - name: NAMESPACE\n          value: default\n        - name: REQ_URL\n          value: http://localhost:8080/reload-configuration-as-code/?casc-reload-token=$(POD_NAME)\n        - name: REQ_METHOD\n          value: POST\n        - name: REQ_RETRY_CONNECT\n          value: '10'\n        resources: {}\n        volumeMounts:\n        - name: sc-config-volume\n          mountPath: /var/jenkins_home/casc_configs\n        - name: jenkins-home\n          mountPath: /var/jenkins_home\n      volumes:\n      - name: plugins\n        emptyDir: {}\n      - name: jenkins-config\n        configMap:\n          name: release-name-jenkins\n      - name: plugin-dir\n        emptyDir: {}\n      - name: jenkins-secrets\n        projected:\n          sources:\n          - secret:\n              name: release-name-jenkins\n              items:\n              - key: jenkins-admin-user\n                path: chart-admin-username\n              - key: jenkins-admin-password\n                path: chart-admin-password\n      - name: jenkins-cache\n        emptyDir: {}\n      - name: jenkins-home\n        persistentVolumeClaim:\n          claimName: release-name-jenkins\n      - name: sc-config-volume\n        emptyDir: {}\n      - name: tmp-volume\n        emptyDir: {}\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"config-reload\" has cpu request 0"
  },
  {
    "id": "541",
    "manifest_path": "data/manifests/artifacthub/jenkinsci/jenkins/012_statefulset_release-name-jenkins.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: release-name-jenkins\n  namespace: default\n  labels:\n    app.kubernetes.io/name: jenkins\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/component: jenkins-controller\n    helm.sh/chart: jenkins-5.8.98\nspec:\n  serviceName: release-name-jenkins\n  replicas: 1\n  selector:\n    matchLabels:\n      app.kubernetes.io/component: jenkins-controller\n      app.kubernetes.io/instance: release-name\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/name: jenkins\n        app.kubernetes.io/managed-by: Helm\n        app.kubernetes.io/instance: release-name\n        app.kubernetes.io/component: jenkins-controller\n        helm.sh/chart: jenkins-5.8.98\n      annotations:\n        checksum/config: e05b6d43d9ba96c1b1cd78116a387bdc4a776b05046455033c876ade1617360e\n    spec:\n      enableServiceLinks: false\n      securityContext:\n        runAsUser: 1000\n        fsGroup: 1000\n        runAsNonRoot: true\n      serviceAccountName: release-name-jenkins\n      automountServiceAccountToken: true\n      initContainers:\n      - name: config-reload-init\n        image: docker.io/kiwigrid/k8s-sidecar:1.30.7\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: LABEL\n          value: release-name-jenkins-jenkins-config\n        - name: FOLDER\n          value: /var/jenkins_home/casc_configs\n        - name: NAMESPACE\n          value: default\n        - name: METHOD\n          value: LIST\n        resources: {}\n        volumeMounts:\n        - name: sc-config-volume\n          mountPath: /var/jenkins_home/casc_configs\n        - name: jenkins-home\n          mountPath: /var/jenkins_home\n      - name: init\n        image: docker.io/jenkins/jenkins:2.516.3-jdk21\n        imagePullPolicy: Always\n        securityContext:\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          runAsGroup: 1000\n          runAsUser: 1000\n        command:\n        - sh\n        - /var/jenkins_config/apply_config.sh\n        resources:\n          limits:\n            cpu: 2000m\n            memory: 4096Mi\n          requests:\n            cpu: 50m\n            memory: 256Mi\n        volumeMounts:\n        - mountPath: /var/jenkins_home\n          name: jenkins-home\n        - mountPath: /var/jenkins_config\n          name: jenkins-config\n        - mountPath: /usr/share/jenkins/ref/plugins\n          name: plugins\n        - mountPath: /var/jenkins_plugins\n          name: plugin-dir\n        - mountPath: /tmp\n          name: tmp-volume\n      containers:\n      - name: jenkins\n        image: docker.io/jenkins/jenkins:2.516.3-jdk21\n        imagePullPolicy: Always\n        securityContext:\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          runAsGroup: 1000\n          runAsUser: 1000\n        args:\n        - --httpPort=8080\n        env:\n        - name: SECRETS\n          value: /run/secrets/additional\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: JAVA_OPTS\n          value: '-Dcasc.reload.token=$(POD_NAME) '\n        - name: JENKINS_OPTS\n          value: '--webroot=/var/jenkins_cache/war '\n        - name: JENKINS_SLAVE_AGENT_PORT\n          value: '50000'\n        - name: CASC_JENKINS_CONFIG\n          value: /var/jenkins_home/casc_configs\n        ports:\n        - containerPort: 8080\n          name: http\n        - containerPort: 50000\n          name: agent-listener\n        startupProbe:\n          failureThreshold: 12\n          httpGet:\n            path: /login\n            port: http\n          periodSeconds: 10\n          timeoutSeconds: 5\n        livenessProbe:\n          failureThreshold: 5\n          httpGet:\n            path: /login\n            port: http\n          initialDelaySeconds: null\n          periodSeconds: 10\n          timeoutSeconds: 5\n        readinessProbe:\n          failureThreshold: 3\n          httpGet:\n            path: /login\n            port: http\n          initialDelaySeconds: null\n          periodSeconds: 10\n          timeoutSeconds: 5\n        resources:\n          limits:\n            cpu: 2000m\n            memory: 4096Mi\n          requests:\n            cpu: 50m\n            memory: 256Mi\n        volumeMounts:\n        - mountPath: /var/jenkins_home\n          name: jenkins-home\n          readOnly: false\n        - mountPath: /var/jenkins_config\n          name: jenkins-config\n          readOnly: true\n        - mountPath: /usr/share/jenkins/ref/plugins/\n          name: plugin-dir\n          readOnly: false\n        - name: sc-config-volume\n          mountPath: /var/jenkins_home/casc_configs\n        - name: jenkins-secrets\n          mountPath: /run/secrets/additional\n          readOnly: true\n        - name: jenkins-cache\n          mountPath: /var/jenkins_cache\n        - mountPath: /tmp\n          name: tmp-volume\n      - name: config-reload\n        image: docker.io/kiwigrid/k8s-sidecar:1.30.7\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: LABEL\n          value: release-name-jenkins-jenkins-config\n        - name: FOLDER\n          value: /var/jenkins_home/casc_configs\n        - name: NAMESPACE\n          value: default\n        - name: REQ_URL\n          value: http://localhost:8080/reload-configuration-as-code/?casc-reload-token=$(POD_NAME)\n        - name: REQ_METHOD\n          value: POST\n        - name: REQ_RETRY_CONNECT\n          value: '10'\n        resources: {}\n        volumeMounts:\n        - name: sc-config-volume\n          mountPath: /var/jenkins_home/casc_configs\n        - name: jenkins-home\n          mountPath: /var/jenkins_home\n      volumes:\n      - name: plugins\n        emptyDir: {}\n      - name: jenkins-config\n        configMap:\n          name: release-name-jenkins\n      - name: plugin-dir\n        emptyDir: {}\n      - name: jenkins-secrets\n        projected:\n          sources:\n          - secret:\n              name: release-name-jenkins\n              items:\n              - key: jenkins-admin-user\n                path: chart-admin-username\n              - key: jenkins-admin-password\n                path: chart-admin-password\n      - name: jenkins-cache\n        emptyDir: {}\n      - name: jenkins-home\n        persistentVolumeClaim:\n          claimName: release-name-jenkins\n      - name: sc-config-volume\n        emptyDir: {}\n      - name: tmp-volume\n        emptyDir: {}\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"config-reload-init\" has cpu request 0"
  },
  {
    "id": "542",
    "manifest_path": "data/manifests/artifacthub/jenkinsci/jenkins/012_statefulset_release-name-jenkins.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: release-name-jenkins\n  namespace: default\n  labels:\n    app.kubernetes.io/name: jenkins\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/component: jenkins-controller\n    helm.sh/chart: jenkins-5.8.98\nspec:\n  serviceName: release-name-jenkins\n  replicas: 1\n  selector:\n    matchLabels:\n      app.kubernetes.io/component: jenkins-controller\n      app.kubernetes.io/instance: release-name\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/name: jenkins\n        app.kubernetes.io/managed-by: Helm\n        app.kubernetes.io/instance: release-name\n        app.kubernetes.io/component: jenkins-controller\n        helm.sh/chart: jenkins-5.8.98\n      annotations:\n        checksum/config: e05b6d43d9ba96c1b1cd78116a387bdc4a776b05046455033c876ade1617360e\n    spec:\n      enableServiceLinks: false\n      securityContext:\n        runAsUser: 1000\n        fsGroup: 1000\n        runAsNonRoot: true\n      serviceAccountName: release-name-jenkins\n      automountServiceAccountToken: true\n      initContainers:\n      - name: config-reload-init\n        image: docker.io/kiwigrid/k8s-sidecar:1.30.7\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: LABEL\n          value: release-name-jenkins-jenkins-config\n        - name: FOLDER\n          value: /var/jenkins_home/casc_configs\n        - name: NAMESPACE\n          value: default\n        - name: METHOD\n          value: LIST\n        resources: {}\n        volumeMounts:\n        - name: sc-config-volume\n          mountPath: /var/jenkins_home/casc_configs\n        - name: jenkins-home\n          mountPath: /var/jenkins_home\n      - name: init\n        image: docker.io/jenkins/jenkins:2.516.3-jdk21\n        imagePullPolicy: Always\n        securityContext:\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          runAsGroup: 1000\n          runAsUser: 1000\n        command:\n        - sh\n        - /var/jenkins_config/apply_config.sh\n        resources:\n          limits:\n            cpu: 2000m\n            memory: 4096Mi\n          requests:\n            cpu: 50m\n            memory: 256Mi\n        volumeMounts:\n        - mountPath: /var/jenkins_home\n          name: jenkins-home\n        - mountPath: /var/jenkins_config\n          name: jenkins-config\n        - mountPath: /usr/share/jenkins/ref/plugins\n          name: plugins\n        - mountPath: /var/jenkins_plugins\n          name: plugin-dir\n        - mountPath: /tmp\n          name: tmp-volume\n      containers:\n      - name: jenkins\n        image: docker.io/jenkins/jenkins:2.516.3-jdk21\n        imagePullPolicy: Always\n        securityContext:\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          runAsGroup: 1000\n          runAsUser: 1000\n        args:\n        - --httpPort=8080\n        env:\n        - name: SECRETS\n          value: /run/secrets/additional\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: JAVA_OPTS\n          value: '-Dcasc.reload.token=$(POD_NAME) '\n        - name: JENKINS_OPTS\n          value: '--webroot=/var/jenkins_cache/war '\n        - name: JENKINS_SLAVE_AGENT_PORT\n          value: '50000'\n        - name: CASC_JENKINS_CONFIG\n          value: /var/jenkins_home/casc_configs\n        ports:\n        - containerPort: 8080\n          name: http\n        - containerPort: 50000\n          name: agent-listener\n        startupProbe:\n          failureThreshold: 12\n          httpGet:\n            path: /login\n            port: http\n          periodSeconds: 10\n          timeoutSeconds: 5\n        livenessProbe:\n          failureThreshold: 5\n          httpGet:\n            path: /login\n            port: http\n          initialDelaySeconds: null\n          periodSeconds: 10\n          timeoutSeconds: 5\n        readinessProbe:\n          failureThreshold: 3\n          httpGet:\n            path: /login\n            port: http\n          initialDelaySeconds: null\n          periodSeconds: 10\n          timeoutSeconds: 5\n        resources:\n          limits:\n            cpu: 2000m\n            memory: 4096Mi\n          requests:\n            cpu: 50m\n            memory: 256Mi\n        volumeMounts:\n        - mountPath: /var/jenkins_home\n          name: jenkins-home\n          readOnly: false\n        - mountPath: /var/jenkins_config\n          name: jenkins-config\n          readOnly: true\n        - mountPath: /usr/share/jenkins/ref/plugins/\n          name: plugin-dir\n          readOnly: false\n        - name: sc-config-volume\n          mountPath: /var/jenkins_home/casc_configs\n        - name: jenkins-secrets\n          mountPath: /run/secrets/additional\n          readOnly: true\n        - name: jenkins-cache\n          mountPath: /var/jenkins_cache\n        - mountPath: /tmp\n          name: tmp-volume\n      - name: config-reload\n        image: docker.io/kiwigrid/k8s-sidecar:1.30.7\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: LABEL\n          value: release-name-jenkins-jenkins-config\n        - name: FOLDER\n          value: /var/jenkins_home/casc_configs\n        - name: NAMESPACE\n          value: default\n        - name: REQ_URL\n          value: http://localhost:8080/reload-configuration-as-code/?casc-reload-token=$(POD_NAME)\n        - name: REQ_METHOD\n          value: POST\n        - name: REQ_RETRY_CONNECT\n          value: '10'\n        resources: {}\n        volumeMounts:\n        - name: sc-config-volume\n          mountPath: /var/jenkins_home/casc_configs\n        - name: jenkins-home\n          mountPath: /var/jenkins_home\n      volumes:\n      - name: plugins\n        emptyDir: {}\n      - name: jenkins-config\n        configMap:\n          name: release-name-jenkins\n      - name: plugin-dir\n        emptyDir: {}\n      - name: jenkins-secrets\n        projected:\n          sources:\n          - secret:\n              name: release-name-jenkins\n              items:\n              - key: jenkins-admin-user\n                path: chart-admin-username\n              - key: jenkins-admin-password\n                path: chart-admin-password\n      - name: jenkins-cache\n        emptyDir: {}\n      - name: jenkins-home\n        persistentVolumeClaim:\n          claimName: release-name-jenkins\n      - name: sc-config-volume\n        emptyDir: {}\n      - name: tmp-volume\n        emptyDir: {}\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"config-reload\" has memory limit 0"
  },
  {
    "id": "543",
    "manifest_path": "data/manifests/artifacthub/jenkinsci/jenkins/012_statefulset_release-name-jenkins.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: release-name-jenkins\n  namespace: default\n  labels:\n    app.kubernetes.io/name: jenkins\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/component: jenkins-controller\n    helm.sh/chart: jenkins-5.8.98\nspec:\n  serviceName: release-name-jenkins\n  replicas: 1\n  selector:\n    matchLabels:\n      app.kubernetes.io/component: jenkins-controller\n      app.kubernetes.io/instance: release-name\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/name: jenkins\n        app.kubernetes.io/managed-by: Helm\n        app.kubernetes.io/instance: release-name\n        app.kubernetes.io/component: jenkins-controller\n        helm.sh/chart: jenkins-5.8.98\n      annotations:\n        checksum/config: e05b6d43d9ba96c1b1cd78116a387bdc4a776b05046455033c876ade1617360e\n    spec:\n      enableServiceLinks: false\n      securityContext:\n        runAsUser: 1000\n        fsGroup: 1000\n        runAsNonRoot: true\n      serviceAccountName: release-name-jenkins\n      automountServiceAccountToken: true\n      initContainers:\n      - name: config-reload-init\n        image: docker.io/kiwigrid/k8s-sidecar:1.30.7\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: LABEL\n          value: release-name-jenkins-jenkins-config\n        - name: FOLDER\n          value: /var/jenkins_home/casc_configs\n        - name: NAMESPACE\n          value: default\n        - name: METHOD\n          value: LIST\n        resources: {}\n        volumeMounts:\n        - name: sc-config-volume\n          mountPath: /var/jenkins_home/casc_configs\n        - name: jenkins-home\n          mountPath: /var/jenkins_home\n      - name: init\n        image: docker.io/jenkins/jenkins:2.516.3-jdk21\n        imagePullPolicy: Always\n        securityContext:\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          runAsGroup: 1000\n          runAsUser: 1000\n        command:\n        - sh\n        - /var/jenkins_config/apply_config.sh\n        resources:\n          limits:\n            cpu: 2000m\n            memory: 4096Mi\n          requests:\n            cpu: 50m\n            memory: 256Mi\n        volumeMounts:\n        - mountPath: /var/jenkins_home\n          name: jenkins-home\n        - mountPath: /var/jenkins_config\n          name: jenkins-config\n        - mountPath: /usr/share/jenkins/ref/plugins\n          name: plugins\n        - mountPath: /var/jenkins_plugins\n          name: plugin-dir\n        - mountPath: /tmp\n          name: tmp-volume\n      containers:\n      - name: jenkins\n        image: docker.io/jenkins/jenkins:2.516.3-jdk21\n        imagePullPolicy: Always\n        securityContext:\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          runAsGroup: 1000\n          runAsUser: 1000\n        args:\n        - --httpPort=8080\n        env:\n        - name: SECRETS\n          value: /run/secrets/additional\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: JAVA_OPTS\n          value: '-Dcasc.reload.token=$(POD_NAME) '\n        - name: JENKINS_OPTS\n          value: '--webroot=/var/jenkins_cache/war '\n        - name: JENKINS_SLAVE_AGENT_PORT\n          value: '50000'\n        - name: CASC_JENKINS_CONFIG\n          value: /var/jenkins_home/casc_configs\n        ports:\n        - containerPort: 8080\n          name: http\n        - containerPort: 50000\n          name: agent-listener\n        startupProbe:\n          failureThreshold: 12\n          httpGet:\n            path: /login\n            port: http\n          periodSeconds: 10\n          timeoutSeconds: 5\n        livenessProbe:\n          failureThreshold: 5\n          httpGet:\n            path: /login\n            port: http\n          initialDelaySeconds: null\n          periodSeconds: 10\n          timeoutSeconds: 5\n        readinessProbe:\n          failureThreshold: 3\n          httpGet:\n            path: /login\n            port: http\n          initialDelaySeconds: null\n          periodSeconds: 10\n          timeoutSeconds: 5\n        resources:\n          limits:\n            cpu: 2000m\n            memory: 4096Mi\n          requests:\n            cpu: 50m\n            memory: 256Mi\n        volumeMounts:\n        - mountPath: /var/jenkins_home\n          name: jenkins-home\n          readOnly: false\n        - mountPath: /var/jenkins_config\n          name: jenkins-config\n          readOnly: true\n        - mountPath: /usr/share/jenkins/ref/plugins/\n          name: plugin-dir\n          readOnly: false\n        - name: sc-config-volume\n          mountPath: /var/jenkins_home/casc_configs\n        - name: jenkins-secrets\n          mountPath: /run/secrets/additional\n          readOnly: true\n        - name: jenkins-cache\n          mountPath: /var/jenkins_cache\n        - mountPath: /tmp\n          name: tmp-volume\n      - name: config-reload\n        image: docker.io/kiwigrid/k8s-sidecar:1.30.7\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: LABEL\n          value: release-name-jenkins-jenkins-config\n        - name: FOLDER\n          value: /var/jenkins_home/casc_configs\n        - name: NAMESPACE\n          value: default\n        - name: REQ_URL\n          value: http://localhost:8080/reload-configuration-as-code/?casc-reload-token=$(POD_NAME)\n        - name: REQ_METHOD\n          value: POST\n        - name: REQ_RETRY_CONNECT\n          value: '10'\n        resources: {}\n        volumeMounts:\n        - name: sc-config-volume\n          mountPath: /var/jenkins_home/casc_configs\n        - name: jenkins-home\n          mountPath: /var/jenkins_home\n      volumes:\n      - name: plugins\n        emptyDir: {}\n      - name: jenkins-config\n        configMap:\n          name: release-name-jenkins\n      - name: plugin-dir\n        emptyDir: {}\n      - name: jenkins-secrets\n        projected:\n          sources:\n          - secret:\n              name: release-name-jenkins\n              items:\n              - key: jenkins-admin-user\n                path: chart-admin-username\n              - key: jenkins-admin-password\n                path: chart-admin-password\n      - name: jenkins-cache\n        emptyDir: {}\n      - name: jenkins-home\n        persistentVolumeClaim:\n          claimName: release-name-jenkins\n      - name: sc-config-volume\n        emptyDir: {}\n      - name: tmp-volume\n        emptyDir: {}\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"config-reload-init\" has memory limit 0"
  },
  {
    "id": "544",
    "manifest_path": "data/manifests/artifacthub/jenkinsci/jenkins/014_pod_release-name-ui-test-qwsqu.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: release-name-ui-test-qwsqu\n  namespace: default\n  annotations:\n    helm.sh/hook: test-success\nspec:\n  initContainers:\n  - name: test-framework\n    image: docker.io/bats/bats:1.12.0\n    command:\n    - bash\n    - -c\n    args:\n    - '# copy bats to tools dir\n\n      set -ex\n\n      cp -R /opt/bats /tools/bats/\n\n      '\n    volumeMounts:\n    - mountPath: /tools\n      name: tools\n  containers:\n  - name: release-name-ui-test\n    image: docker.io/jenkins/jenkins:2.516.3-jdk21\n    command:\n    - /tools/bats/bin/bats\n    - -t\n    - /tests/run.sh\n    volumeMounts:\n    - mountPath: /tests\n      name: tests\n      readOnly: true\n    - mountPath: /tools\n      name: tools\n  volumes:\n  - name: tests\n    configMap:\n      name: release-name-jenkins-tests\n  - name: tools\n    emptyDir: {}\n  restartPolicy: Never\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"release-name-ui-test\" does not have a read-only root file system"
  },
  {
    "id": "545",
    "manifest_path": "data/manifests/artifacthub/jenkinsci/jenkins/014_pod_release-name-ui-test-qwsqu.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: release-name-ui-test-qwsqu\n  namespace: default\n  annotations:\n    helm.sh/hook: test-success\nspec:\n  initContainers:\n  - name: test-framework\n    image: docker.io/bats/bats:1.12.0\n    command:\n    - bash\n    - -c\n    args:\n    - '# copy bats to tools dir\n\n      set -ex\n\n      cp -R /opt/bats /tools/bats/\n\n      '\n    volumeMounts:\n    - mountPath: /tools\n      name: tools\n  containers:\n  - name: release-name-ui-test\n    image: docker.io/jenkins/jenkins:2.516.3-jdk21\n    command:\n    - /tools/bats/bin/bats\n    - -t\n    - /tests/run.sh\n    volumeMounts:\n    - mountPath: /tests\n      name: tests\n      readOnly: true\n    - mountPath: /tools\n      name: tools\n  volumes:\n  - name: tests\n    configMap:\n      name: release-name-jenkins-tests\n  - name: tools\n    emptyDir: {}\n  restartPolicy: Never\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"test-framework\" does not have a read-only root file system"
  },
  {
    "id": "546",
    "manifest_path": "data/manifests/artifacthub/jenkinsci/jenkins/014_pod_release-name-ui-test-qwsqu.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: release-name-ui-test-qwsqu\n  namespace: default\n  annotations:\n    helm.sh/hook: test-success\nspec:\n  initContainers:\n  - name: test-framework\n    image: docker.io/bats/bats:1.12.0\n    command:\n    - bash\n    - -c\n    args:\n    - '# copy bats to tools dir\n\n      set -ex\n\n      cp -R /opt/bats /tools/bats/\n\n      '\n    volumeMounts:\n    - mountPath: /tools\n      name: tools\n  containers:\n  - name: release-name-ui-test\n    image: docker.io/jenkins/jenkins:2.516.3-jdk21\n    command:\n    - /tools/bats/bin/bats\n    - -t\n    - /tests/run.sh\n    volumeMounts:\n    - mountPath: /tests\n      name: tests\n      readOnly: true\n    - mountPath: /tools\n      name: tools\n  volumes:\n  - name: tests\n    configMap:\n      name: release-name-jenkins-tests\n  - name: tools\n    emptyDir: {}\n  restartPolicy: Never\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"release-name-ui-test\" is not set to runAsNonRoot"
  },
  {
    "id": "547",
    "manifest_path": "data/manifests/artifacthub/jenkinsci/jenkins/014_pod_release-name-ui-test-qwsqu.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: release-name-ui-test-qwsqu\n  namespace: default\n  annotations:\n    helm.sh/hook: test-success\nspec:\n  initContainers:\n  - name: test-framework\n    image: docker.io/bats/bats:1.12.0\n    command:\n    - bash\n    - -c\n    args:\n    - '# copy bats to tools dir\n\n      set -ex\n\n      cp -R /opt/bats /tools/bats/\n\n      '\n    volumeMounts:\n    - mountPath: /tools\n      name: tools\n  containers:\n  - name: release-name-ui-test\n    image: docker.io/jenkins/jenkins:2.516.3-jdk21\n    command:\n    - /tools/bats/bin/bats\n    - -t\n    - /tests/run.sh\n    volumeMounts:\n    - mountPath: /tests\n      name: tests\n      readOnly: true\n    - mountPath: /tools\n      name: tools\n  volumes:\n  - name: tests\n    configMap:\n      name: release-name-jenkins-tests\n  - name: tools\n    emptyDir: {}\n  restartPolicy: Never\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"test-framework\" is not set to runAsNonRoot"
  },
  {
    "id": "548",
    "manifest_path": "data/manifests/artifacthub/jenkinsci/jenkins/014_pod_release-name-ui-test-qwsqu.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: release-name-ui-test-qwsqu\n  namespace: default\n  annotations:\n    helm.sh/hook: test-success\nspec:\n  initContainers:\n  - name: test-framework\n    image: docker.io/bats/bats:1.12.0\n    command:\n    - bash\n    - -c\n    args:\n    - '# copy bats to tools dir\n\n      set -ex\n\n      cp -R /opt/bats /tools/bats/\n\n      '\n    volumeMounts:\n    - mountPath: /tools\n      name: tools\n  containers:\n  - name: release-name-ui-test\n    image: docker.io/jenkins/jenkins:2.516.3-jdk21\n    command:\n    - /tools/bats/bin/bats\n    - -t\n    - /tests/run.sh\n    volumeMounts:\n    - mountPath: /tests\n      name: tests\n      readOnly: true\n    - mountPath: /tools\n      name: tools\n  volumes:\n  - name: tests\n    configMap:\n      name: release-name-jenkins-tests\n  - name: tools\n    emptyDir: {}\n  restartPolicy: Never\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"release-name-ui-test\" has cpu request 0"
  },
  {
    "id": "549",
    "manifest_path": "data/manifests/artifacthub/jenkinsci/jenkins/014_pod_release-name-ui-test-qwsqu.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: release-name-ui-test-qwsqu\n  namespace: default\n  annotations:\n    helm.sh/hook: test-success\nspec:\n  initContainers:\n  - name: test-framework\n    image: docker.io/bats/bats:1.12.0\n    command:\n    - bash\n    - -c\n    args:\n    - '# copy bats to tools dir\n\n      set -ex\n\n      cp -R /opt/bats /tools/bats/\n\n      '\n    volumeMounts:\n    - mountPath: /tools\n      name: tools\n  containers:\n  - name: release-name-ui-test\n    image: docker.io/jenkins/jenkins:2.516.3-jdk21\n    command:\n    - /tools/bats/bin/bats\n    - -t\n    - /tests/run.sh\n    volumeMounts:\n    - mountPath: /tests\n      name: tests\n      readOnly: true\n    - mountPath: /tools\n      name: tools\n  volumes:\n  - name: tests\n    configMap:\n      name: release-name-jenkins-tests\n  - name: tools\n    emptyDir: {}\n  restartPolicy: Never\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"test-framework\" has cpu request 0"
  },
  {
    "id": "550",
    "manifest_path": "data/manifests/artifacthub/jenkinsci/jenkins/014_pod_release-name-ui-test-qwsqu.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: release-name-ui-test-qwsqu\n  namespace: default\n  annotations:\n    helm.sh/hook: test-success\nspec:\n  initContainers:\n  - name: test-framework\n    image: docker.io/bats/bats:1.12.0\n    command:\n    - bash\n    - -c\n    args:\n    - '# copy bats to tools dir\n\n      set -ex\n\n      cp -R /opt/bats /tools/bats/\n\n      '\n    volumeMounts:\n    - mountPath: /tools\n      name: tools\n  containers:\n  - name: release-name-ui-test\n    image: docker.io/jenkins/jenkins:2.516.3-jdk21\n    command:\n    - /tools/bats/bin/bats\n    - -t\n    - /tests/run.sh\n    volumeMounts:\n    - mountPath: /tests\n      name: tests\n      readOnly: true\n    - mountPath: /tools\n      name: tools\n  volumes:\n  - name: tests\n    configMap:\n      name: release-name-jenkins-tests\n  - name: tools\n    emptyDir: {}\n  restartPolicy: Never\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"release-name-ui-test\" has memory limit 0"
  },
  {
    "id": "551",
    "manifest_path": "data/manifests/artifacthub/jenkinsci/jenkins/014_pod_release-name-ui-test-qwsqu.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: release-name-ui-test-qwsqu\n  namespace: default\n  annotations:\n    helm.sh/hook: test-success\nspec:\n  initContainers:\n  - name: test-framework\n    image: docker.io/bats/bats:1.12.0\n    command:\n    - bash\n    - -c\n    args:\n    - '# copy bats to tools dir\n\n      set -ex\n\n      cp -R /opt/bats /tools/bats/\n\n      '\n    volumeMounts:\n    - mountPath: /tools\n      name: tools\n  containers:\n  - name: release-name-ui-test\n    image: docker.io/jenkins/jenkins:2.516.3-jdk21\n    command:\n    - /tools/bats/bin/bats\n    - -t\n    - /tests/run.sh\n    volumeMounts:\n    - mountPath: /tests\n      name: tests\n      readOnly: true\n    - mountPath: /tools\n      name: tools\n  volumes:\n  - name: tests\n    configMap:\n      name: release-name-jenkins-tests\n  - name: tools\n    emptyDir: {}\n  restartPolicy: Never\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"test-framework\" has memory limit 0"
  },
  {
    "id": "552",
    "manifest_path": "data/manifests/artifacthub/k8s-dashboard/kubernetes-dashboard/014_service_release-name-kong-proxy.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Service\nmetadata:\n  name: release-name-kong-proxy\n  namespace: default\n  labels:\n    app.kubernetes.io/name: kong\n    helm.sh/chart: kong-2.46.0\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/version: '3.8'\n    enable-metrics: 'true'\nspec:\n  type: ClusterIP\n  ports:\n  - name: kong-proxy-tls\n    port: 443\n    targetPort: 8443\n    protocol: TCP\n  selector:\n    app.kubernetes.io/name: kong\n    app.kubernetes.io/component: app\n    app.kubernetes.io/instance: release-name\n",
    "policy_id": "dangling-service",
    "violation_text": "no pods found matching service labels (map[app.kubernetes.io/component:app app.kubernetes.io/instance:release-name app.kubernetes.io/name:kong])"
  },
  {
    "id": "553",
    "manifest_path": "data/manifests/artifacthub/k8s-dashboard/kubernetes-dashboard/015_service_release-name-kubernetes-dashboard-api.yaml",
    "manifest_yaml": "kind: Service\napiVersion: v1\nmetadata:\n  labels:\n    helm.sh/chart: kubernetes-dashboard-7.13.0\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/part-of: kubernetes-dashboard\n    app.kubernetes.io/name: kubernetes-dashboard-api\n    app.kubernetes.io/version: 1.13.0\n    app.kubernetes.io/component: api\n  annotations: null\n  name: release-name-kubernetes-dashboard-api\nspec:\n  type: ClusterIP\n  ports:\n  - name: api\n    port: 8000\n    protocol: TCP\n  selector:\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/part-of: kubernetes-dashboard\n    app.kubernetes.io/name: kubernetes-dashboard-api\n",
    "policy_id": "dangling-service",
    "violation_text": "no pods found matching service labels (map[app.kubernetes.io/instance:release-name app.kubernetes.io/name:kubernetes-dashboard-api app.kubernetes.io/part-of:kubernetes-dashboard])"
  },
  {
    "id": "554",
    "manifest_path": "data/manifests/artifacthub/k8s-dashboard/kubernetes-dashboard/016_service_release-name-kubernetes-dashboard-auth.yaml",
    "manifest_yaml": "kind: Service\napiVersion: v1\nmetadata:\n  labels:\n    helm.sh/chart: kubernetes-dashboard-7.13.0\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/part-of: kubernetes-dashboard\n    app.kubernetes.io/name: kubernetes-dashboard-auth\n    app.kubernetes.io/version: 1.3.0\n    app.kubernetes.io/component: auth\n  annotations: null\n  name: release-name-kubernetes-dashboard-auth\nspec:\n  type: ClusterIP\n  ports:\n  - name: auth\n    port: 8000\n    protocol: TCP\n  selector:\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/part-of: kubernetes-dashboard\n    app.kubernetes.io/name: kubernetes-dashboard-auth\n",
    "policy_id": "dangling-service",
    "violation_text": "no pods found matching service labels (map[app.kubernetes.io/instance:release-name app.kubernetes.io/name:kubernetes-dashboard-auth app.kubernetes.io/part-of:kubernetes-dashboard])"
  },
  {
    "id": "555",
    "manifest_path": "data/manifests/artifacthub/k8s-dashboard/kubernetes-dashboard/017_service_release-name-kubernetes-dashboard-metrics-scraper.yaml",
    "manifest_yaml": "kind: Service\napiVersion: v1\nmetadata:\n  labels:\n    helm.sh/chart: kubernetes-dashboard-7.13.0\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/part-of: kubernetes-dashboard\n    app.kubernetes.io/name: kubernetes-dashboard-metrics-scraper\n    app.kubernetes.io/version: 1.2.2\n    app.kubernetes.io/component: metrics-scraper\n  annotations: null\n  name: release-name-kubernetes-dashboard-metrics-scraper\nspec:\n  type: ClusterIP\n  ports:\n  - port: 8000\n    protocol: TCP\n  selector:\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/part-of: kubernetes-dashboard\n    app.kubernetes.io/name: kubernetes-dashboard-metrics-scraper\n",
    "policy_id": "dangling-service",
    "violation_text": "no pods found matching service labels (map[app.kubernetes.io/instance:release-name app.kubernetes.io/name:kubernetes-dashboard-metrics-scraper app.kubernetes.io/part-of:kubernetes-dashboard])"
  },
  {
    "id": "556",
    "manifest_path": "data/manifests/artifacthub/k8s-dashboard/kubernetes-dashboard/018_service_release-name-kubernetes-dashboard-web.yaml",
    "manifest_yaml": "kind: Service\napiVersion: v1\nmetadata:\n  labels:\n    helm.sh/chart: kubernetes-dashboard-7.13.0\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/part-of: kubernetes-dashboard\n    app.kubernetes.io/name: kubernetes-dashboard-web\n    app.kubernetes.io/version: 1.7.0\n    app.kubernetes.io/component: web\n  annotations: null\n  name: release-name-kubernetes-dashboard-web\nspec:\n  type: ClusterIP\n  ports:\n  - name: web\n    port: 8000\n    protocol: TCP\n  selector:\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/part-of: kubernetes-dashboard\n    app.kubernetes.io/name: kubernetes-dashboard-web\n",
    "policy_id": "dangling-service",
    "violation_text": "no pods found matching service labels (map[app.kubernetes.io/instance:release-name app.kubernetes.io/name:kubernetes-dashboard-web app.kubernetes.io/part-of:kubernetes-dashboard])"
  },
  {
    "id": "557",
    "manifest_path": "data/manifests/artifacthub/k8s-dashboard/kubernetes-dashboard/019_deployment_release-name-kong.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: release-name-kong\n  namespace: default\n  labels:\n    app.kubernetes.io/name: kong\n    helm.sh/chart: kong-2.46.0\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/version: '3.8'\n    app.kubernetes.io/component: app\nspec:\n  replicas: 1\n  revisionHistoryLimit: 10\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: kong\n      app.kubernetes.io/component: app\n      app.kubernetes.io/instance: release-name\n  template:\n    metadata:\n      annotations:\n        kuma.io/service-account-token-volume: release-name-kong-token\n        kuma.io/gateway: enabled\n        traffic.sidecar.istio.io/includeInboundPorts: ''\n      labels:\n        app.kubernetes.io/name: kong\n        helm.sh/chart: kong-2.46.0\n        app.kubernetes.io/instance: release-name\n        app.kubernetes.io/managed-by: Helm\n        app.kubernetes.io/version: '3.8'\n        app.kubernetes.io/component: app\n        app: release-name-kong\n        version: '3.8'\n    spec:\n      serviceAccountName: release-name-kong\n      automountServiceAccountToken: false\n      initContainers:\n      - name: clear-stale-pid\n        image: kong:3.8\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - ALL\n          readOnlyRootFilesystem: true\n          runAsNonRoot: true\n          runAsUser: 1000\n          seccompProfile:\n            type: RuntimeDefault\n        resources: {}\n        command:\n        - rm\n        - -vrf\n        - $KONG_PREFIX/pids\n        env:\n        - name: KONG_ADMIN_ACCESS_LOG\n          value: /dev/stdout\n        - name: KONG_ADMIN_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_ADMIN_GUI_ACCESS_LOG\n          value: /dev/stdout\n        - name: KONG_ADMIN_GUI_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_ADMIN_LISTEN\n          value: 127.0.0.1:8444 http2 ssl, [::1]:8444 http2 ssl\n        - name: KONG_CLUSTER_LISTEN\n          value: 'off'\n        - name: KONG_DATABASE\n          value: 'off'\n        - name: KONG_DECLARATIVE_CONFIG\n          value: /kong_dbless/kong.yml\n        - name: KONG_DNS_ORDER\n          value: LAST,A,CNAME,AAAA,SRV\n        - name: KONG_LUA_PACKAGE_PATH\n          value: /opt/?.lua;/opt/?/init.lua;;\n        - name: KONG_NGINX_WORKER_PROCESSES\n          value: '1'\n        - name: KONG_PLUGINS\n          value: 'off'\n        - name: KONG_PORTAL_API_ACCESS_LOG\n          value: /dev/stdout\n        - name: KONG_PORTAL_API_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_PORT_MAPS\n          value: 443:8443\n        - name: KONG_PREFIX\n          value: /kong_prefix/\n        - name: KONG_PROXY_ACCESS_LOG\n          value: /dev/stdout\n        - name: KONG_PROXY_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_PROXY_LISTEN\n          value: 0.0.0.0:8443 http2 ssl, [::]:8443 http2 ssl\n        - name: KONG_PROXY_STREAM_ACCESS_LOG\n          value: /dev/stdout basic\n        - name: KONG_PROXY_STREAM_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_ROUTER_FLAVOR\n          value: traditional\n        - name: KONG_STATUS_ACCESS_LOG\n          value: 'off'\n        - name: KONG_STATUS_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_STATUS_LISTEN\n          value: 0.0.0.0:8100, [::]:8100\n        - name: KONG_STREAM_LISTEN\n          value: 'off'\n        volumeMounts:\n        - name: release-name-kong-prefix-dir\n          mountPath: /kong_prefix/\n        - name: release-name-kong-tmp\n          mountPath: /tmp\n        - name: kong-custom-dbless-config-volume\n          mountPath: /kong_dbless/\n      containers:\n      - name: proxy\n        image: kong:3.8\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - ALL\n          readOnlyRootFilesystem: true\n          runAsNonRoot: true\n          runAsUser: 1000\n          seccompProfile:\n            type: RuntimeDefault\n        env:\n        - name: KONG_ADMIN_ACCESS_LOG\n          value: /dev/stdout\n        - name: KONG_ADMIN_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_ADMIN_GUI_ACCESS_LOG\n          value: /dev/stdout\n        - name: KONG_ADMIN_GUI_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_ADMIN_LISTEN\n          value: 127.0.0.1:8444 http2 ssl, [::1]:8444 http2 ssl\n        - name: KONG_CLUSTER_LISTEN\n          value: 'off'\n        - name: KONG_DATABASE\n          value: 'off'\n        - name: KONG_DECLARATIVE_CONFIG\n          value: /kong_dbless/kong.yml\n        - name: KONG_DNS_ORDER\n          value: LAST,A,CNAME,AAAA,SRV\n        - name: KONG_LUA_PACKAGE_PATH\n          value: /opt/?.lua;/opt/?/init.lua;;\n        - name: KONG_NGINX_WORKER_PROCESSES\n          value: '1'\n        - name: KONG_PLUGINS\n          value: 'off'\n        - name: KONG_PORTAL_API_ACCESS_LOG\n          value: /dev/stdout\n        - name: KONG_PORTAL_API_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_PORT_MAPS\n          value: 443:8443\n        - name: KONG_PREFIX\n          value: /kong_prefix/\n        - name: KONG_PROXY_ACCESS_LOG\n          value: /dev/stdout\n        - name: KONG_PROXY_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_PROXY_LISTEN\n          value: 0.0.0.0:8443 http2 ssl, [::]:8443 http2 ssl\n        - name: KONG_PROXY_STREAM_ACCESS_LOG\n          value: /dev/stdout basic\n        - name: KONG_PROXY_STREAM_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_ROUTER_FLAVOR\n          value: traditional\n        - name: KONG_STATUS_ACCESS_LOG\n          value: 'off'\n        - name: KONG_STATUS_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_STATUS_LISTEN\n          value: 0.0.0.0:8100, [::]:8100\n        - name: KONG_STREAM_LISTEN\n          value: 'off'\n        - name: KONG_NGINX_DAEMON\n          value: 'off'\n        lifecycle:\n          preStop:\n            exec:\n              command:\n              - kong\n              - quit\n              - --wait=15\n        ports:\n        - name: proxy-tls\n          containerPort: 8443\n          protocol: TCP\n        - name: status\n          containerPort: 8100\n          protocol: TCP\n        volumeMounts:\n        - name: release-name-kong-prefix-dir\n          mountPath: /kong_prefix/\n        - name: release-name-kong-tmp\n          mountPath: /tmp\n        - name: kong-custom-dbless-config-volume\n          mountPath: /kong_dbless/\n        readinessProbe:\n          failureThreshold: 3\n          httpGet:\n            path: /status/ready\n            port: status\n            scheme: HTTP\n          initialDelaySeconds: 5\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 5\n        livenessProbe:\n          failureThreshold: 3\n          httpGet:\n            path: /status\n            port: status\n            scheme: HTTP\n          initialDelaySeconds: 5\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 5\n        resources: {}\n      securityContext: {}\n      terminationGracePeriodSeconds: 30\n      volumes:\n      - name: release-name-kong-prefix-dir\n        emptyDir:\n          sizeLimit: 256Mi\n      - name: release-name-kong-tmp\n        emptyDir:\n          sizeLimit: 1Gi\n      - name: release-name-kong-token\n        projected:\n          sources:\n          - serviceAccountToken:\n              expirationSeconds: 3607\n              path: token\n          - configMap:\n              items:\n              - key: ca.crt\n                path: ca.crt\n              name: kube-root-ca.crt\n          - downwardAPI:\n              items:\n              - fieldRef:\n                  apiVersion: v1\n                  fieldPath: metadata.namespace\n                path: namespace\n      - name: kong-custom-dbless-config-volume\n        configMap:\n          name: kong-dbless-config\n",
    "policy_id": "non-existent-service-account",
    "violation_text": "serviceAccount \"release-name-kong\" not found"
  },
  {
    "id": "558",
    "manifest_path": "data/manifests/artifacthub/k8s-dashboard/kubernetes-dashboard/019_deployment_release-name-kong.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: release-name-kong\n  namespace: default\n  labels:\n    app.kubernetes.io/name: kong\n    helm.sh/chart: kong-2.46.0\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/version: '3.8'\n    app.kubernetes.io/component: app\nspec:\n  replicas: 1\n  revisionHistoryLimit: 10\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: kong\n      app.kubernetes.io/component: app\n      app.kubernetes.io/instance: release-name\n  template:\n    metadata:\n      annotations:\n        kuma.io/service-account-token-volume: release-name-kong-token\n        kuma.io/gateway: enabled\n        traffic.sidecar.istio.io/includeInboundPorts: ''\n      labels:\n        app.kubernetes.io/name: kong\n        helm.sh/chart: kong-2.46.0\n        app.kubernetes.io/instance: release-name\n        app.kubernetes.io/managed-by: Helm\n        app.kubernetes.io/version: '3.8'\n        app.kubernetes.io/component: app\n        app: release-name-kong\n        version: '3.8'\n    spec:\n      serviceAccountName: release-name-kong\n      automountServiceAccountToken: false\n      initContainers:\n      - name: clear-stale-pid\n        image: kong:3.8\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - ALL\n          readOnlyRootFilesystem: true\n          runAsNonRoot: true\n          runAsUser: 1000\n          seccompProfile:\n            type: RuntimeDefault\n        resources: {}\n        command:\n        - rm\n        - -vrf\n        - $KONG_PREFIX/pids\n        env:\n        - name: KONG_ADMIN_ACCESS_LOG\n          value: /dev/stdout\n        - name: KONG_ADMIN_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_ADMIN_GUI_ACCESS_LOG\n          value: /dev/stdout\n        - name: KONG_ADMIN_GUI_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_ADMIN_LISTEN\n          value: 127.0.0.1:8444 http2 ssl, [::1]:8444 http2 ssl\n        - name: KONG_CLUSTER_LISTEN\n          value: 'off'\n        - name: KONG_DATABASE\n          value: 'off'\n        - name: KONG_DECLARATIVE_CONFIG\n          value: /kong_dbless/kong.yml\n        - name: KONG_DNS_ORDER\n          value: LAST,A,CNAME,AAAA,SRV\n        - name: KONG_LUA_PACKAGE_PATH\n          value: /opt/?.lua;/opt/?/init.lua;;\n        - name: KONG_NGINX_WORKER_PROCESSES\n          value: '1'\n        - name: KONG_PLUGINS\n          value: 'off'\n        - name: KONG_PORTAL_API_ACCESS_LOG\n          value: /dev/stdout\n        - name: KONG_PORTAL_API_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_PORT_MAPS\n          value: 443:8443\n        - name: KONG_PREFIX\n          value: /kong_prefix/\n        - name: KONG_PROXY_ACCESS_LOG\n          value: /dev/stdout\n        - name: KONG_PROXY_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_PROXY_LISTEN\n          value: 0.0.0.0:8443 http2 ssl, [::]:8443 http2 ssl\n        - name: KONG_PROXY_STREAM_ACCESS_LOG\n          value: /dev/stdout basic\n        - name: KONG_PROXY_STREAM_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_ROUTER_FLAVOR\n          value: traditional\n        - name: KONG_STATUS_ACCESS_LOG\n          value: 'off'\n        - name: KONG_STATUS_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_STATUS_LISTEN\n          value: 0.0.0.0:8100, [::]:8100\n        - name: KONG_STREAM_LISTEN\n          value: 'off'\n        volumeMounts:\n        - name: release-name-kong-prefix-dir\n          mountPath: /kong_prefix/\n        - name: release-name-kong-tmp\n          mountPath: /tmp\n        - name: kong-custom-dbless-config-volume\n          mountPath: /kong_dbless/\n      containers:\n      - name: proxy\n        image: kong:3.8\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - ALL\n          readOnlyRootFilesystem: true\n          runAsNonRoot: true\n          runAsUser: 1000\n          seccompProfile:\n            type: RuntimeDefault\n        env:\n        - name: KONG_ADMIN_ACCESS_LOG\n          value: /dev/stdout\n        - name: KONG_ADMIN_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_ADMIN_GUI_ACCESS_LOG\n          value: /dev/stdout\n        - name: KONG_ADMIN_GUI_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_ADMIN_LISTEN\n          value: 127.0.0.1:8444 http2 ssl, [::1]:8444 http2 ssl\n        - name: KONG_CLUSTER_LISTEN\n          value: 'off'\n        - name: KONG_DATABASE\n          value: 'off'\n        - name: KONG_DECLARATIVE_CONFIG\n          value: /kong_dbless/kong.yml\n        - name: KONG_DNS_ORDER\n          value: LAST,A,CNAME,AAAA,SRV\n        - name: KONG_LUA_PACKAGE_PATH\n          value: /opt/?.lua;/opt/?/init.lua;;\n        - name: KONG_NGINX_WORKER_PROCESSES\n          value: '1'\n        - name: KONG_PLUGINS\n          value: 'off'\n        - name: KONG_PORTAL_API_ACCESS_LOG\n          value: /dev/stdout\n        - name: KONG_PORTAL_API_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_PORT_MAPS\n          value: 443:8443\n        - name: KONG_PREFIX\n          value: /kong_prefix/\n        - name: KONG_PROXY_ACCESS_LOG\n          value: /dev/stdout\n        - name: KONG_PROXY_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_PROXY_LISTEN\n          value: 0.0.0.0:8443 http2 ssl, [::]:8443 http2 ssl\n        - name: KONG_PROXY_STREAM_ACCESS_LOG\n          value: /dev/stdout basic\n        - name: KONG_PROXY_STREAM_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_ROUTER_FLAVOR\n          value: traditional\n        - name: KONG_STATUS_ACCESS_LOG\n          value: 'off'\n        - name: KONG_STATUS_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_STATUS_LISTEN\n          value: 0.0.0.0:8100, [::]:8100\n        - name: KONG_STREAM_LISTEN\n          value: 'off'\n        - name: KONG_NGINX_DAEMON\n          value: 'off'\n        lifecycle:\n          preStop:\n            exec:\n              command:\n              - kong\n              - quit\n              - --wait=15\n        ports:\n        - name: proxy-tls\n          containerPort: 8443\n          protocol: TCP\n        - name: status\n          containerPort: 8100\n          protocol: TCP\n        volumeMounts:\n        - name: release-name-kong-prefix-dir\n          mountPath: /kong_prefix/\n        - name: release-name-kong-tmp\n          mountPath: /tmp\n        - name: kong-custom-dbless-config-volume\n          mountPath: /kong_dbless/\n        readinessProbe:\n          failureThreshold: 3\n          httpGet:\n            path: /status/ready\n            port: status\n            scheme: HTTP\n          initialDelaySeconds: 5\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 5\n        livenessProbe:\n          failureThreshold: 3\n          httpGet:\n            path: /status\n            port: status\n            scheme: HTTP\n          initialDelaySeconds: 5\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 5\n        resources: {}\n      securityContext: {}\n      terminationGracePeriodSeconds: 30\n      volumes:\n      - name: release-name-kong-prefix-dir\n        emptyDir:\n          sizeLimit: 256Mi\n      - name: release-name-kong-tmp\n        emptyDir:\n          sizeLimit: 1Gi\n      - name: release-name-kong-token\n        projected:\n          sources:\n          - serviceAccountToken:\n              expirationSeconds: 3607\n              path: token\n          - configMap:\n              items:\n              - key: ca.crt\n                path: ca.crt\n              name: kube-root-ca.crt\n          - downwardAPI:\n              items:\n              - fieldRef:\n                  apiVersion: v1\n                  fieldPath: metadata.namespace\n                path: namespace\n      - name: kong-custom-dbless-config-volume\n        configMap:\n          name: kong-dbless-config\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"clear-stale-pid\" has cpu request 0"
  },
  {
    "id": "559",
    "manifest_path": "data/manifests/artifacthub/k8s-dashboard/kubernetes-dashboard/019_deployment_release-name-kong.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: release-name-kong\n  namespace: default\n  labels:\n    app.kubernetes.io/name: kong\n    helm.sh/chart: kong-2.46.0\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/version: '3.8'\n    app.kubernetes.io/component: app\nspec:\n  replicas: 1\n  revisionHistoryLimit: 10\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: kong\n      app.kubernetes.io/component: app\n      app.kubernetes.io/instance: release-name\n  template:\n    metadata:\n      annotations:\n        kuma.io/service-account-token-volume: release-name-kong-token\n        kuma.io/gateway: enabled\n        traffic.sidecar.istio.io/includeInboundPorts: ''\n      labels:\n        app.kubernetes.io/name: kong\n        helm.sh/chart: kong-2.46.0\n        app.kubernetes.io/instance: release-name\n        app.kubernetes.io/managed-by: Helm\n        app.kubernetes.io/version: '3.8'\n        app.kubernetes.io/component: app\n        app: release-name-kong\n        version: '3.8'\n    spec:\n      serviceAccountName: release-name-kong\n      automountServiceAccountToken: false\n      initContainers:\n      - name: clear-stale-pid\n        image: kong:3.8\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - ALL\n          readOnlyRootFilesystem: true\n          runAsNonRoot: true\n          runAsUser: 1000\n          seccompProfile:\n            type: RuntimeDefault\n        resources: {}\n        command:\n        - rm\n        - -vrf\n        - $KONG_PREFIX/pids\n        env:\n        - name: KONG_ADMIN_ACCESS_LOG\n          value: /dev/stdout\n        - name: KONG_ADMIN_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_ADMIN_GUI_ACCESS_LOG\n          value: /dev/stdout\n        - name: KONG_ADMIN_GUI_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_ADMIN_LISTEN\n          value: 127.0.0.1:8444 http2 ssl, [::1]:8444 http2 ssl\n        - name: KONG_CLUSTER_LISTEN\n          value: 'off'\n        - name: KONG_DATABASE\n          value: 'off'\n        - name: KONG_DECLARATIVE_CONFIG\n          value: /kong_dbless/kong.yml\n        - name: KONG_DNS_ORDER\n          value: LAST,A,CNAME,AAAA,SRV\n        - name: KONG_LUA_PACKAGE_PATH\n          value: /opt/?.lua;/opt/?/init.lua;;\n        - name: KONG_NGINX_WORKER_PROCESSES\n          value: '1'\n        - name: KONG_PLUGINS\n          value: 'off'\n        - name: KONG_PORTAL_API_ACCESS_LOG\n          value: /dev/stdout\n        - name: KONG_PORTAL_API_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_PORT_MAPS\n          value: 443:8443\n        - name: KONG_PREFIX\n          value: /kong_prefix/\n        - name: KONG_PROXY_ACCESS_LOG\n          value: /dev/stdout\n        - name: KONG_PROXY_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_PROXY_LISTEN\n          value: 0.0.0.0:8443 http2 ssl, [::]:8443 http2 ssl\n        - name: KONG_PROXY_STREAM_ACCESS_LOG\n          value: /dev/stdout basic\n        - name: KONG_PROXY_STREAM_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_ROUTER_FLAVOR\n          value: traditional\n        - name: KONG_STATUS_ACCESS_LOG\n          value: 'off'\n        - name: KONG_STATUS_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_STATUS_LISTEN\n          value: 0.0.0.0:8100, [::]:8100\n        - name: KONG_STREAM_LISTEN\n          value: 'off'\n        volumeMounts:\n        - name: release-name-kong-prefix-dir\n          mountPath: /kong_prefix/\n        - name: release-name-kong-tmp\n          mountPath: /tmp\n        - name: kong-custom-dbless-config-volume\n          mountPath: /kong_dbless/\n      containers:\n      - name: proxy\n        image: kong:3.8\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - ALL\n          readOnlyRootFilesystem: true\n          runAsNonRoot: true\n          runAsUser: 1000\n          seccompProfile:\n            type: RuntimeDefault\n        env:\n        - name: KONG_ADMIN_ACCESS_LOG\n          value: /dev/stdout\n        - name: KONG_ADMIN_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_ADMIN_GUI_ACCESS_LOG\n          value: /dev/stdout\n        - name: KONG_ADMIN_GUI_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_ADMIN_LISTEN\n          value: 127.0.0.1:8444 http2 ssl, [::1]:8444 http2 ssl\n        - name: KONG_CLUSTER_LISTEN\n          value: 'off'\n        - name: KONG_DATABASE\n          value: 'off'\n        - name: KONG_DECLARATIVE_CONFIG\n          value: /kong_dbless/kong.yml\n        - name: KONG_DNS_ORDER\n          value: LAST,A,CNAME,AAAA,SRV\n        - name: KONG_LUA_PACKAGE_PATH\n          value: /opt/?.lua;/opt/?/init.lua;;\n        - name: KONG_NGINX_WORKER_PROCESSES\n          value: '1'\n        - name: KONG_PLUGINS\n          value: 'off'\n        - name: KONG_PORTAL_API_ACCESS_LOG\n          value: /dev/stdout\n        - name: KONG_PORTAL_API_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_PORT_MAPS\n          value: 443:8443\n        - name: KONG_PREFIX\n          value: /kong_prefix/\n        - name: KONG_PROXY_ACCESS_LOG\n          value: /dev/stdout\n        - name: KONG_PROXY_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_PROXY_LISTEN\n          value: 0.0.0.0:8443 http2 ssl, [::]:8443 http2 ssl\n        - name: KONG_PROXY_STREAM_ACCESS_LOG\n          value: /dev/stdout basic\n        - name: KONG_PROXY_STREAM_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_ROUTER_FLAVOR\n          value: traditional\n        - name: KONG_STATUS_ACCESS_LOG\n          value: 'off'\n        - name: KONG_STATUS_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_STATUS_LISTEN\n          value: 0.0.0.0:8100, [::]:8100\n        - name: KONG_STREAM_LISTEN\n          value: 'off'\n        - name: KONG_NGINX_DAEMON\n          value: 'off'\n        lifecycle:\n          preStop:\n            exec:\n              command:\n              - kong\n              - quit\n              - --wait=15\n        ports:\n        - name: proxy-tls\n          containerPort: 8443\n          protocol: TCP\n        - name: status\n          containerPort: 8100\n          protocol: TCP\n        volumeMounts:\n        - name: release-name-kong-prefix-dir\n          mountPath: /kong_prefix/\n        - name: release-name-kong-tmp\n          mountPath: /tmp\n        - name: kong-custom-dbless-config-volume\n          mountPath: /kong_dbless/\n        readinessProbe:\n          failureThreshold: 3\n          httpGet:\n            path: /status/ready\n            port: status\n            scheme: HTTP\n          initialDelaySeconds: 5\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 5\n        livenessProbe:\n          failureThreshold: 3\n          httpGet:\n            path: /status\n            port: status\n            scheme: HTTP\n          initialDelaySeconds: 5\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 5\n        resources: {}\n      securityContext: {}\n      terminationGracePeriodSeconds: 30\n      volumes:\n      - name: release-name-kong-prefix-dir\n        emptyDir:\n          sizeLimit: 256Mi\n      - name: release-name-kong-tmp\n        emptyDir:\n          sizeLimit: 1Gi\n      - name: release-name-kong-token\n        projected:\n          sources:\n          - serviceAccountToken:\n              expirationSeconds: 3607\n              path: token\n          - configMap:\n              items:\n              - key: ca.crt\n                path: ca.crt\n              name: kube-root-ca.crt\n          - downwardAPI:\n              items:\n              - fieldRef:\n                  apiVersion: v1\n                  fieldPath: metadata.namespace\n                path: namespace\n      - name: kong-custom-dbless-config-volume\n        configMap:\n          name: kong-dbless-config\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"proxy\" has cpu request 0"
  },
  {
    "id": "560",
    "manifest_path": "data/manifests/artifacthub/k8s-dashboard/kubernetes-dashboard/019_deployment_release-name-kong.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: release-name-kong\n  namespace: default\n  labels:\n    app.kubernetes.io/name: kong\n    helm.sh/chart: kong-2.46.0\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/version: '3.8'\n    app.kubernetes.io/component: app\nspec:\n  replicas: 1\n  revisionHistoryLimit: 10\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: kong\n      app.kubernetes.io/component: app\n      app.kubernetes.io/instance: release-name\n  template:\n    metadata:\n      annotations:\n        kuma.io/service-account-token-volume: release-name-kong-token\n        kuma.io/gateway: enabled\n        traffic.sidecar.istio.io/includeInboundPorts: ''\n      labels:\n        app.kubernetes.io/name: kong\n        helm.sh/chart: kong-2.46.0\n        app.kubernetes.io/instance: release-name\n        app.kubernetes.io/managed-by: Helm\n        app.kubernetes.io/version: '3.8'\n        app.kubernetes.io/component: app\n        app: release-name-kong\n        version: '3.8'\n    spec:\n      serviceAccountName: release-name-kong\n      automountServiceAccountToken: false\n      initContainers:\n      - name: clear-stale-pid\n        image: kong:3.8\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - ALL\n          readOnlyRootFilesystem: true\n          runAsNonRoot: true\n          runAsUser: 1000\n          seccompProfile:\n            type: RuntimeDefault\n        resources: {}\n        command:\n        - rm\n        - -vrf\n        - $KONG_PREFIX/pids\n        env:\n        - name: KONG_ADMIN_ACCESS_LOG\n          value: /dev/stdout\n        - name: KONG_ADMIN_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_ADMIN_GUI_ACCESS_LOG\n          value: /dev/stdout\n        - name: KONG_ADMIN_GUI_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_ADMIN_LISTEN\n          value: 127.0.0.1:8444 http2 ssl, [::1]:8444 http2 ssl\n        - name: KONG_CLUSTER_LISTEN\n          value: 'off'\n        - name: KONG_DATABASE\n          value: 'off'\n        - name: KONG_DECLARATIVE_CONFIG\n          value: /kong_dbless/kong.yml\n        - name: KONG_DNS_ORDER\n          value: LAST,A,CNAME,AAAA,SRV\n        - name: KONG_LUA_PACKAGE_PATH\n          value: /opt/?.lua;/opt/?/init.lua;;\n        - name: KONG_NGINX_WORKER_PROCESSES\n          value: '1'\n        - name: KONG_PLUGINS\n          value: 'off'\n        - name: KONG_PORTAL_API_ACCESS_LOG\n          value: /dev/stdout\n        - name: KONG_PORTAL_API_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_PORT_MAPS\n          value: 443:8443\n        - name: KONG_PREFIX\n          value: /kong_prefix/\n        - name: KONG_PROXY_ACCESS_LOG\n          value: /dev/stdout\n        - name: KONG_PROXY_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_PROXY_LISTEN\n          value: 0.0.0.0:8443 http2 ssl, [::]:8443 http2 ssl\n        - name: KONG_PROXY_STREAM_ACCESS_LOG\n          value: /dev/stdout basic\n        - name: KONG_PROXY_STREAM_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_ROUTER_FLAVOR\n          value: traditional\n        - name: KONG_STATUS_ACCESS_LOG\n          value: 'off'\n        - name: KONG_STATUS_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_STATUS_LISTEN\n          value: 0.0.0.0:8100, [::]:8100\n        - name: KONG_STREAM_LISTEN\n          value: 'off'\n        volumeMounts:\n        - name: release-name-kong-prefix-dir\n          mountPath: /kong_prefix/\n        - name: release-name-kong-tmp\n          mountPath: /tmp\n        - name: kong-custom-dbless-config-volume\n          mountPath: /kong_dbless/\n      containers:\n      - name: proxy\n        image: kong:3.8\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - ALL\n          readOnlyRootFilesystem: true\n          runAsNonRoot: true\n          runAsUser: 1000\n          seccompProfile:\n            type: RuntimeDefault\n        env:\n        - name: KONG_ADMIN_ACCESS_LOG\n          value: /dev/stdout\n        - name: KONG_ADMIN_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_ADMIN_GUI_ACCESS_LOG\n          value: /dev/stdout\n        - name: KONG_ADMIN_GUI_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_ADMIN_LISTEN\n          value: 127.0.0.1:8444 http2 ssl, [::1]:8444 http2 ssl\n        - name: KONG_CLUSTER_LISTEN\n          value: 'off'\n        - name: KONG_DATABASE\n          value: 'off'\n        - name: KONG_DECLARATIVE_CONFIG\n          value: /kong_dbless/kong.yml\n        - name: KONG_DNS_ORDER\n          value: LAST,A,CNAME,AAAA,SRV\n        - name: KONG_LUA_PACKAGE_PATH\n          value: /opt/?.lua;/opt/?/init.lua;;\n        - name: KONG_NGINX_WORKER_PROCESSES\n          value: '1'\n        - name: KONG_PLUGINS\n          value: 'off'\n        - name: KONG_PORTAL_API_ACCESS_LOG\n          value: /dev/stdout\n        - name: KONG_PORTAL_API_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_PORT_MAPS\n          value: 443:8443\n        - name: KONG_PREFIX\n          value: /kong_prefix/\n        - name: KONG_PROXY_ACCESS_LOG\n          value: /dev/stdout\n        - name: KONG_PROXY_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_PROXY_LISTEN\n          value: 0.0.0.0:8443 http2 ssl, [::]:8443 http2 ssl\n        - name: KONG_PROXY_STREAM_ACCESS_LOG\n          value: /dev/stdout basic\n        - name: KONG_PROXY_STREAM_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_ROUTER_FLAVOR\n          value: traditional\n        - name: KONG_STATUS_ACCESS_LOG\n          value: 'off'\n        - name: KONG_STATUS_ERROR_LOG\n          value: /dev/stderr\n        - name: KONG_STATUS_LISTEN\n          value: 0.0.0.0:8100, [::]:8100\n        - name: KONG_STREAM_LISTEN\n          value: 'off'\n        - name: KONG_NGINX_DAEMON\n          value: 'off'\n        lifecycle:\n          preStop:\n            exec:\n              command:\n              - kong\n              - quit\n              - --wait=15\n        ports:\n        - name: proxy-tls\n          containerPort: 8443\n          protocol: TCP\n        - name: status\n          containerPort: 8100\n          protocol: TCP\n        volumeMounts:\n        - name: release-name-kong-prefix-dir\n          mountPath: /kong_prefix/\n        - name: release-name-kong-tmp\n          mountPath: /tmp\n        - name: kong-custom-dbless-config-volume\n          mountPath: /kong_dbless/\n        readinessProbe:\n          failureThreshold: 3\n          httpGet:\n            path: /status/ready\n            port: status\n            scheme: HTTP\n          initialDelaySeconds: 5\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 5\n        livenessProbe:\n          failureThreshold: 3\n          httpGet:\n            path: /status\n            port: status\n            scheme: HTTP\n          initialDelaySeconds: 5\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 5\n        resources: {}\n      securityContext: {}\n      terminationGracePeriodSeconds: 30\n      volumes:\n      - name: release-name-kong-prefix-dir\n        emptyDir:\n          sizeLimit: 256Mi\n      - name: release-name-kong-tmp\n        emptyDir:\n          sizeLimit: 1Gi\n      - name: release-name-kong-token\n        projected:\n          sources:\n          - serviceAccountToken:\n              expirationSeconds: 3607\n              path: token\n          - configMap:\n              items:\n              - key: ca.crt\n                path: ca.crt\n              name: kube-root-ca.crt\n          - downwardAPI:\n              items:\n              - fieldRef:\n                  apiVersion: v1\n                  fieldPath: metadata.namespace\n                path: namespace\n      - name: kong-custom-dbless-config-volume\n        configMap:\n          name: kong-dbless-config\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"clear-stale-pid\" has memory limit 0"
  }
]