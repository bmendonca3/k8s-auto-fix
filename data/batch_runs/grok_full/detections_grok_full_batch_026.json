[
  {
    "id": "1041",
    "manifest_path": "data/manifests/the_stack_sample/sample_0082.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-984\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"nginx\" has cpu request 0"
  },
  {
    "id": "1042",
    "manifest_path": "data/manifests/the_stack_sample/sample_0082.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-984\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"nginx\" has memory limit 0"
  },
  {
    "id": "1043",
    "manifest_path": "data/manifests/the_stack_sample/sample_0083.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Service\nmetadata:\n  labels:\n    app.kubernetes.io/component: observability\n    app.kubernetes.io/instance: parca\n    app.kubernetes.io/name: parca\n    app.kubernetes.io/version: v0.7.1\n  name: parca\n  namespace: parca\nspec:\n  ports:\n  - name: http\n    port: 7070\n    targetPort: 7070\n  selector:\n    app.kubernetes.io/component: observability\n    app.kubernetes.io/instance: parca\n    app.kubernetes.io/name: parca\n",
    "policy_id": "dangling-service",
    "violation_text": "no pods found matching service labels (map[app.kubernetes.io/component:observability app.kubernetes.io/instance:parca app.kubernetes.io/name:parca])"
  },
  {
    "id": "1044",
    "manifest_path": "data/manifests/the_stack_sample/sample_0084.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: order\n  labels:\n    app: order\n    tier: frontend\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: order\n      tier: frontend\n  template:\n    metadata:\n      labels:\n        app: order\n        tier: frontend\n    spec:\n      containers:\n      - name: order\n        image: aankitatiwari24/air-pg:order\n        ports:\n        - containerPort: 5000\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"order\" does not have a read-only root file system"
  },
  {
    "id": "1045",
    "manifest_path": "data/manifests/the_stack_sample/sample_0084.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: order\n  labels:\n    app: order\n    tier: frontend\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: order\n      tier: frontend\n  template:\n    metadata:\n      labels:\n        app: order\n        tier: frontend\n    spec:\n      containers:\n      - name: order\n        image: aankitatiwari24/air-pg:order\n        ports:\n        - containerPort: 5000\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"order\" is not set to runAsNonRoot"
  },
  {
    "id": "1046",
    "manifest_path": "data/manifests/the_stack_sample/sample_0084.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: order\n  labels:\n    app: order\n    tier: frontend\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: order\n      tier: frontend\n  template:\n    metadata:\n      labels:\n        app: order\n        tier: frontend\n    spec:\n      containers:\n      - name: order\n        image: aankitatiwari24/air-pg:order\n        ports:\n        - containerPort: 5000\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"order\" has cpu request 0"
  },
  {
    "id": "1047",
    "manifest_path": "data/manifests/the_stack_sample/sample_0084.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: order\n  labels:\n    app: order\n    tier: frontend\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: order\n      tier: frontend\n  template:\n    metadata:\n      labels:\n        app: order\n        tier: frontend\n    spec:\n      containers:\n      - name: order\n        image: aankitatiwari24/air-pg:order\n        ports:\n        - containerPort: 5000\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"order\" has memory limit 0"
  },
  {
    "id": "1048",
    "manifest_path": "data/manifests/the_stack_sample/sample_0085.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: gateway-controller\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: gateway-controller\n  template:\n    metadata:\n      labels:\n        app: gateway-controller\n    spec:\n      serviceAccountName: argo-events-sa\n      containers:\n      - name: gateway-controller\n        image: argoproj/gateway-controller:v0.10-test\n        imagePullPolicy: Always\n        env:\n        - name: GATEWAY_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: GATEWAY_CONTROLLER_CONFIG_MAP\n          value: gateway-controller-configmap\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"gateway-controller\" does not have a read-only root file system"
  },
  {
    "id": "1049",
    "manifest_path": "data/manifests/the_stack_sample/sample_0085.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: gateway-controller\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: gateway-controller\n  template:\n    metadata:\n      labels:\n        app: gateway-controller\n    spec:\n      serviceAccountName: argo-events-sa\n      containers:\n      - name: gateway-controller\n        image: argoproj/gateway-controller:v0.10-test\n        imagePullPolicy: Always\n        env:\n        - name: GATEWAY_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: GATEWAY_CONTROLLER_CONFIG_MAP\n          value: gateway-controller-configmap\n",
    "policy_id": "non-existent-service-account",
    "violation_text": "serviceAccount \"argo-events-sa\" not found"
  },
  {
    "id": "1050",
    "manifest_path": "data/manifests/the_stack_sample/sample_0085.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: gateway-controller\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: gateway-controller\n  template:\n    metadata:\n      labels:\n        app: gateway-controller\n    spec:\n      serviceAccountName: argo-events-sa\n      containers:\n      - name: gateway-controller\n        image: argoproj/gateway-controller:v0.10-test\n        imagePullPolicy: Always\n        env:\n        - name: GATEWAY_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: GATEWAY_CONTROLLER_CONFIG_MAP\n          value: gateway-controller-configmap\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"gateway-controller\" is not set to runAsNonRoot"
  },
  {
    "id": "1051",
    "manifest_path": "data/manifests/the_stack_sample/sample_0085.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: gateway-controller\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: gateway-controller\n  template:\n    metadata:\n      labels:\n        app: gateway-controller\n    spec:\n      serviceAccountName: argo-events-sa\n      containers:\n      - name: gateway-controller\n        image: argoproj/gateway-controller:v0.10-test\n        imagePullPolicy: Always\n        env:\n        - name: GATEWAY_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: GATEWAY_CONTROLLER_CONFIG_MAP\n          value: gateway-controller-configmap\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"gateway-controller\" has cpu request 0"
  },
  {
    "id": "1052",
    "manifest_path": "data/manifests/the_stack_sample/sample_0085.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: gateway-controller\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: gateway-controller\n  template:\n    metadata:\n      labels:\n        app: gateway-controller\n    spec:\n      serviceAccountName: argo-events-sa\n      containers:\n      - name: gateway-controller\n        image: argoproj/gateway-controller:v0.10-test\n        imagePullPolicy: Always\n        env:\n        - name: GATEWAY_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: GATEWAY_CONTROLLER_CONFIG_MAP\n          value: gateway-controller-configmap\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"gateway-controller\" has memory limit 0"
  },
  {
    "id": "1053",
    "manifest_path": "data/manifests/the_stack_sample/sample_0087.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: frontend\nspec:\n  selector:\n    matchLabels:\n      app: frontend\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: frontend\n    spec:\n      containers:\n      - name: server\n        ports:\n        - containerPort: 8080\n        image: gcr.io/wise-coyote-827/frontend-server\n        env:\n        - name: BACKEND_SERVICE_ADDR\n          value: backend-internal:8080\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"server\" is using an invalid container image, \"gcr.io/wise-coyote-827/frontend-server\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "1054",
    "manifest_path": "data/manifests/the_stack_sample/sample_0087.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: frontend\nspec:\n  selector:\n    matchLabels:\n      app: frontend\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: frontend\n    spec:\n      containers:\n      - name: server\n        ports:\n        - containerPort: 8080\n        image: gcr.io/wise-coyote-827/frontend-server\n        env:\n        - name: BACKEND_SERVICE_ADDR\n          value: backend-internal:8080\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"server\" does not have a read-only root file system"
  },
  {
    "id": "1055",
    "manifest_path": "data/manifests/the_stack_sample/sample_0087.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: frontend\nspec:\n  selector:\n    matchLabels:\n      app: frontend\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: frontend\n    spec:\n      containers:\n      - name: server\n        ports:\n        - containerPort: 8080\n        image: gcr.io/wise-coyote-827/frontend-server\n        env:\n        - name: BACKEND_SERVICE_ADDR\n          value: backend-internal:8080\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"server\" is not set to runAsNonRoot"
  },
  {
    "id": "1056",
    "manifest_path": "data/manifests/the_stack_sample/sample_0087.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: frontend\nspec:\n  selector:\n    matchLabels:\n      app: frontend\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: frontend\n    spec:\n      containers:\n      - name: server\n        ports:\n        - containerPort: 8080\n        image: gcr.io/wise-coyote-827/frontend-server\n        env:\n        - name: BACKEND_SERVICE_ADDR\n          value: backend-internal:8080\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"server\" has cpu request 0"
  },
  {
    "id": "1057",
    "manifest_path": "data/manifests/the_stack_sample/sample_0087.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: frontend\nspec:\n  selector:\n    matchLabels:\n      app: frontend\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: frontend\n    spec:\n      containers:\n      - name: server\n        ports:\n        - containerPort: 8080\n        image: gcr.io/wise-coyote-827/frontend-server\n        env:\n        - name: BACKEND_SERVICE_ADDR\n          value: backend-internal:8080\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"server\" has memory limit 0"
  },
  {
    "id": "1058",
    "manifest_path": "data/manifests/the_stack_sample/sample_0088.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: lighthouse-keeper\n  labels:\n    chart: lighthouse-1.3.0\n    app: lighthouse-keeper\n    gitops.jenkins-x.io/pipeline: namespaces\n  annotations:\n    meta.helm.sh/release-name: lighthouse\n    wave.pusher.com/update-on-config-change: 'true'\n  namespace: jx\nspec:\n  replicas: 1\n  strategy:\n    type: RollingUpdate\n    rollingUpdate:\n      maxSurge: 1\n      maxUnavailable: 1\n  selector:\n    matchLabels:\n      app: lighthouse-keeper\n  template:\n    metadata:\n      annotations:\n        ad.datadoghq.com/keeper.logs: '[{\"source\":\"lighthouse\",\"service\":\"keeper\"}]'\n        prometheus.io/port: '9090'\n        prometheus.io/scrape: 'true'\n        jenkins-x.io/hash: efaf2824743f262428efac87b577e83419a9d9c1f7600f4815a09c7177935a0a\n      labels:\n        app: lighthouse-keeper\n    spec:\n      serviceAccountName: lighthouse-keeper\n      terminationGracePeriodSeconds: 30\n      containers:\n      - name: lighthouse-keeper\n        image: ghcr.io/jenkins-x/lighthouse-keeper:1.3.0\n        imagePullPolicy: IfNotPresent\n        args:\n        - --namespace=jx\n        ports:\n        - name: http\n          containerPort: 8888\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /\n            port: http\n          initialDelaySeconds: 120\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        readinessProbe:\n          httpGet:\n            path: /\n            port: http\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        env:\n        - name: GIT_KIND\n          value: github\n        - name: GIT_SERVER\n          value: https://github.com\n        - name: GIT_USER\n          value: demonccc\n        - name: GIT_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: lighthouse-oauth-token\n              key: oauth\n        - name: JX_LOG_FORMAT\n          value: json\n        - name: LOGRUS_FORMAT\n          value: json\n        - name: LOGRUS_SERVICE\n          value: lighthouse\n        - name: LOGRUS_SERVICE_VERSION\n          value: 1.3.0\n        - name: LOGRUS_STACK_SKIP\n          value: ''\n        - name: LIGHTHOUSE_KEEPER_STATUS_CONTEXT_LABEL\n          value: Lighthouse Merge Status\n        - name: LIGHTHOUSE_TRIGGER_ON_MISSING\n          value: enable\n        envFrom:\n        - secretRef:\n            name: jx-boot-job-env-vars\n            optional: true\n        resources:\n          limits:\n            cpu: 400m\n            memory: 512Mi\n          requests:\n            cpu: 100m\n            memory: 128Mi\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"lighthouse-keeper\" does not have a read-only root file system"
  },
  {
    "id": "1059",
    "manifest_path": "data/manifests/the_stack_sample/sample_0088.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: lighthouse-keeper\n  labels:\n    chart: lighthouse-1.3.0\n    app: lighthouse-keeper\n    gitops.jenkins-x.io/pipeline: namespaces\n  annotations:\n    meta.helm.sh/release-name: lighthouse\n    wave.pusher.com/update-on-config-change: 'true'\n  namespace: jx\nspec:\n  replicas: 1\n  strategy:\n    type: RollingUpdate\n    rollingUpdate:\n      maxSurge: 1\n      maxUnavailable: 1\n  selector:\n    matchLabels:\n      app: lighthouse-keeper\n  template:\n    metadata:\n      annotations:\n        ad.datadoghq.com/keeper.logs: '[{\"source\":\"lighthouse\",\"service\":\"keeper\"}]'\n        prometheus.io/port: '9090'\n        prometheus.io/scrape: 'true'\n        jenkins-x.io/hash: efaf2824743f262428efac87b577e83419a9d9c1f7600f4815a09c7177935a0a\n      labels:\n        app: lighthouse-keeper\n    spec:\n      serviceAccountName: lighthouse-keeper\n      terminationGracePeriodSeconds: 30\n      containers:\n      - name: lighthouse-keeper\n        image: ghcr.io/jenkins-x/lighthouse-keeper:1.3.0\n        imagePullPolicy: IfNotPresent\n        args:\n        - --namespace=jx\n        ports:\n        - name: http\n          containerPort: 8888\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /\n            port: http\n          initialDelaySeconds: 120\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        readinessProbe:\n          httpGet:\n            path: /\n            port: http\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        env:\n        - name: GIT_KIND\n          value: github\n        - name: GIT_SERVER\n          value: https://github.com\n        - name: GIT_USER\n          value: demonccc\n        - name: GIT_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: lighthouse-oauth-token\n              key: oauth\n        - name: JX_LOG_FORMAT\n          value: json\n        - name: LOGRUS_FORMAT\n          value: json\n        - name: LOGRUS_SERVICE\n          value: lighthouse\n        - name: LOGRUS_SERVICE_VERSION\n          value: 1.3.0\n        - name: LOGRUS_STACK_SKIP\n          value: ''\n        - name: LIGHTHOUSE_KEEPER_STATUS_CONTEXT_LABEL\n          value: Lighthouse Merge Status\n        - name: LIGHTHOUSE_TRIGGER_ON_MISSING\n          value: enable\n        envFrom:\n        - secretRef:\n            name: jx-boot-job-env-vars\n            optional: true\n        resources:\n          limits:\n            cpu: 400m\n            memory: 512Mi\n          requests:\n            cpu: 100m\n            memory: 128Mi\n",
    "policy_id": "non-existent-service-account",
    "violation_text": "serviceAccount \"lighthouse-keeper\" not found"
  },
  {
    "id": "1060",
    "manifest_path": "data/manifests/the_stack_sample/sample_0088.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: lighthouse-keeper\n  labels:\n    chart: lighthouse-1.3.0\n    app: lighthouse-keeper\n    gitops.jenkins-x.io/pipeline: namespaces\n  annotations:\n    meta.helm.sh/release-name: lighthouse\n    wave.pusher.com/update-on-config-change: 'true'\n  namespace: jx\nspec:\n  replicas: 1\n  strategy:\n    type: RollingUpdate\n    rollingUpdate:\n      maxSurge: 1\n      maxUnavailable: 1\n  selector:\n    matchLabels:\n      app: lighthouse-keeper\n  template:\n    metadata:\n      annotations:\n        ad.datadoghq.com/keeper.logs: '[{\"source\":\"lighthouse\",\"service\":\"keeper\"}]'\n        prometheus.io/port: '9090'\n        prometheus.io/scrape: 'true'\n        jenkins-x.io/hash: efaf2824743f262428efac87b577e83419a9d9c1f7600f4815a09c7177935a0a\n      labels:\n        app: lighthouse-keeper\n    spec:\n      serviceAccountName: lighthouse-keeper\n      terminationGracePeriodSeconds: 30\n      containers:\n      - name: lighthouse-keeper\n        image: ghcr.io/jenkins-x/lighthouse-keeper:1.3.0\n        imagePullPolicy: IfNotPresent\n        args:\n        - --namespace=jx\n        ports:\n        - name: http\n          containerPort: 8888\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /\n            port: http\n          initialDelaySeconds: 120\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        readinessProbe:\n          httpGet:\n            path: /\n            port: http\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        env:\n        - name: GIT_KIND\n          value: github\n        - name: GIT_SERVER\n          value: https://github.com\n        - name: GIT_USER\n          value: demonccc\n        - name: GIT_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: lighthouse-oauth-token\n              key: oauth\n        - name: JX_LOG_FORMAT\n          value: json\n        - name: LOGRUS_FORMAT\n          value: json\n        - name: LOGRUS_SERVICE\n          value: lighthouse\n        - name: LOGRUS_SERVICE_VERSION\n          value: 1.3.0\n        - name: LOGRUS_STACK_SKIP\n          value: ''\n        - name: LIGHTHOUSE_KEEPER_STATUS_CONTEXT_LABEL\n          value: Lighthouse Merge Status\n        - name: LIGHTHOUSE_TRIGGER_ON_MISSING\n          value: enable\n        envFrom:\n        - secretRef:\n            name: jx-boot-job-env-vars\n            optional: true\n        resources:\n          limits:\n            cpu: 400m\n            memory: 512Mi\n          requests:\n            cpu: 100m\n            memory: 128Mi\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"lighthouse-keeper\" is not set to runAsNonRoot"
  },
  {
    "id": "1061",
    "manifest_path": "data/manifests/the_stack_sample/sample_0089.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Service\nmetadata:\n  name: radarr\nspec:\n  ports:\n  - name: http\n    protocol: TCP\n    targetPort: http\n    port: 80\n  type: ClusterIP\n",
    "policy_id": "dangling-service",
    "violation_text": "service has no selector specified"
  },
  {
    "id": "1062",
    "manifest_path": "data/manifests/the_stack_sample/sample_0093.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: metabase\n  namespace: metabase\nspec:\n  selector:\n    matchLabels:\n      app: metabase\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: metabase\n    spec:\n      containers:\n      - name: metabase\n        image: metabase/metabase:v0.30.3\n        env:\n        - name: MB_DB_TYPE\n          value: mysql\n        - name: MB_DB_DBNAME\n          valueFrom:\n            secretKeyRef:\n              name: metabase-db\n              key: dbname\n        - name: MB_DB_PORT\n          valueFrom:\n            secretKeyRef:\n              name: metabase-db\n              key: port\n        - name: MB_DB_USER\n          valueFrom:\n            secretKeyRef:\n              name: metabase-db\n              key: user\n        - name: MB_DB_PASS\n          valueFrom:\n            secretKeyRef:\n              name: metabase-db\n              key: pass\n        - name: MB_DB_HOST\n          valueFrom:\n            secretKeyRef:\n              name: metabase-db\n              key: host\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"metabase\" does not have a read-only root file system"
  },
  {
    "id": "1063",
    "manifest_path": "data/manifests/the_stack_sample/sample_0093.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: metabase\n  namespace: metabase\nspec:\n  selector:\n    matchLabels:\n      app: metabase\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: metabase\n    spec:\n      containers:\n      - name: metabase\n        image: metabase/metabase:v0.30.3\n        env:\n        - name: MB_DB_TYPE\n          value: mysql\n        - name: MB_DB_DBNAME\n          valueFrom:\n            secretKeyRef:\n              name: metabase-db\n              key: dbname\n        - name: MB_DB_PORT\n          valueFrom:\n            secretKeyRef:\n              name: metabase-db\n              key: port\n        - name: MB_DB_USER\n          valueFrom:\n            secretKeyRef:\n              name: metabase-db\n              key: user\n        - name: MB_DB_PASS\n          valueFrom:\n            secretKeyRef:\n              name: metabase-db\n              key: pass\n        - name: MB_DB_HOST\n          valueFrom:\n            secretKeyRef:\n              name: metabase-db\n              key: host\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"metabase\" is not set to runAsNonRoot"
  },
  {
    "id": "1064",
    "manifest_path": "data/manifests/the_stack_sample/sample_0093.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: metabase\n  namespace: metabase\nspec:\n  selector:\n    matchLabels:\n      app: metabase\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: metabase\n    spec:\n      containers:\n      - name: metabase\n        image: metabase/metabase:v0.30.3\n        env:\n        - name: MB_DB_TYPE\n          value: mysql\n        - name: MB_DB_DBNAME\n          valueFrom:\n            secretKeyRef:\n              name: metabase-db\n              key: dbname\n        - name: MB_DB_PORT\n          valueFrom:\n            secretKeyRef:\n              name: metabase-db\n              key: port\n        - name: MB_DB_USER\n          valueFrom:\n            secretKeyRef:\n              name: metabase-db\n              key: user\n        - name: MB_DB_PASS\n          valueFrom:\n            secretKeyRef:\n              name: metabase-db\n              key: pass\n        - name: MB_DB_HOST\n          valueFrom:\n            secretKeyRef:\n              name: metabase-db\n              key: host\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"metabase\" has cpu request 0"
  },
  {
    "id": "1065",
    "manifest_path": "data/manifests/the_stack_sample/sample_0093.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: metabase\n  namespace: metabase\nspec:\n  selector:\n    matchLabels:\n      app: metabase\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: metabase\n    spec:\n      containers:\n      - name: metabase\n        image: metabase/metabase:v0.30.3\n        env:\n        - name: MB_DB_TYPE\n          value: mysql\n        - name: MB_DB_DBNAME\n          valueFrom:\n            secretKeyRef:\n              name: metabase-db\n              key: dbname\n        - name: MB_DB_PORT\n          valueFrom:\n            secretKeyRef:\n              name: metabase-db\n              key: port\n        - name: MB_DB_USER\n          valueFrom:\n            secretKeyRef:\n              name: metabase-db\n              key: user\n        - name: MB_DB_PASS\n          valueFrom:\n            secretKeyRef:\n              name: metabase-db\n              key: pass\n        - name: MB_DB_HOST\n          valueFrom:\n            secretKeyRef:\n              name: metabase-db\n              key: host\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"metabase\" has memory limit 0"
  },
  {
    "id": "1066",
    "manifest_path": "data/manifests/the_stack_sample/sample_0094.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: netbox\n  namespace: netbox-community\n  labels:\n    k8s-app: netbox\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      k8s-app: netbox\n  template:\n    metadata:\n      labels:\n        k8s-app: netbox\n    spec:\n      containers:\n      - name: netbox\n        image: quay.io/netboxcommunity/netbox:v2.11.12-ldap\n        ports:\n        - name: http\n          containerPort: 8080\n        readinessProbe:\n          httpGet:\n            path: /\n            port: http\n          initialDelaySeconds: 5\n          periodSeconds: 20\n        envFrom:\n        - configMapRef:\n            name: netbox-configmap\n        lifecycle:\n          postStart:\n            exec:\n              command:\n              - /bin/sh\n              - -c\n              - 'bash /home/install-plugins.sh && bash /home/start-rqworker.sh &&\n                bash /home/nginx-caching-fix.sh\n\n                '\n        volumeMounts:\n        - name: auth-ldap-bind-password\n          mountPath: /run/secrets/auth_ldap_bind_password\n          subPath: auth_ldap_bind_password\n          readOnly: true\n        - name: db-password\n          mountPath: /run/secrets/db_password\n          subPath: db_password\n          readOnly: true\n        - name: email-password\n          mountPath: /run/secrets/email_password\n          subPath: email_password\n          readOnly: true\n        - name: napalm-password\n          mountPath: /run/secrets/napalm_password\n          subPath: napalm_password\n          readOnly: true\n        - name: redis-password\n          mountPath: /run/secrets/redis_password\n          subPath: redis_password\n        - name: secret-key\n          mountPath: /run/secrets/secret_key\n          subPath: secret_key\n          readOnly: true\n        - name: superuser-api-token\n          mountPath: /run/secrets/superuser_api_token\n          subPath: superuser_api_token\n        - name: superuser-password\n          mountPath: /run/secrets/superuser_password\n          subPath: superuser_password\n          readOnly: true\n        - name: netbox-media-files\n          mountPath: /opt/netbox/netbox/media\n        - name: ldap-config\n          subPath: ldap_config.py\n          mountPath: /opt/netbox/netbox/netbox/ldap_config.py\n        - mountPath: /etc/netbox/config/netbox-plugins.py\n          name: netbox-plugins\n          subPath: netbox-plugins.py\n        - mountPath: /home/install-plugins.sh\n          name: install-plugins\n          subPath: install-plugins.sh\n        - mountPath: /home/start-rqworker.sh\n          name: start-rqworker\n          subPath: start-rqworker.sh\n        - mountPath: /home/nginx-caching-fix.sh\n          name: nginx-caching-fix\n          subPath: nginx-caching-fix.sh\n        - name: sso-saml2-xml\n          mountPath: /opt/netbox/sso-saml2.xml\n          subPath: sso-saml2-metadata.xml\n      restartPolicy: Always\n      volumes:\n      - name: netbox-media-files\n        persistentVolumeClaim:\n          claimName: netbox-media-pvc\n          readOnly: false\n      - name: ldap-config\n        configMap:\n          name: netbox-configmap\n          items:\n          - key: ldap_config.py\n            path: ldap_config.py\n      - name: netbox-plugins\n        configMap:\n          name: startup-configmap\n          items:\n          - key: netbox-plugins.py\n            path: netbox-plugins.py\n      - name: install-plugins\n        configMap:\n          name: startup-configmap\n          items:\n          - key: install-plugins.sh\n            path: install-plugins.sh\n      - name: start-rqworker\n        configMap:\n          name: startup-configmap\n          items:\n          - key: start-rqworker.sh\n            path: start-rqworker.sh\n      - name: nginx-caching-fix\n        configMap:\n          name: startup-configmap\n          items:\n          - key: nginx-caching-fix.sh\n            path: nginx-caching-fix.sh\n      - name: sso-saml2-xml\n        configMap:\n          name: sso-saml2-xml\n          items:\n          - key: sso-saml2-metadata.xml\n            path: sso-saml2-metadata.xml\n      - name: auth-ldap-bind-password\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: auth_ldap_bind_password\n            path: auth_ldap_bind_password\n      - name: db-password\n        secret:\n          secretName: netbox-postgresql\n          items:\n          - key: password\n            path: db_password\n      - name: email-password\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: email_password\n            path: email_password\n      - name: napalm-password\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: napalm_password\n            path: napalm_password\n      - name: redis-password\n        secret:\n          secretName: netbox-redis\n          items:\n          - key: redis-password\n            path: redis_password\n      - name: secret-key\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: secret_key\n            path: secret_key\n      - name: superuser-password\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: superuser_password\n            path: superuser_password\n      - name: superuser-api-token\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: superuser_api_token\n            path: superuser_api_token\n",
    "policy_id": "no-anti-affinity",
    "violation_text": "object has 3 replicas but does not specify inter pod anti-affinity"
  },
  {
    "id": "1067",
    "manifest_path": "data/manifests/the_stack_sample/sample_0094.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: netbox\n  namespace: netbox-community\n  labels:\n    k8s-app: netbox\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      k8s-app: netbox\n  template:\n    metadata:\n      labels:\n        k8s-app: netbox\n    spec:\n      containers:\n      - name: netbox\n        image: quay.io/netboxcommunity/netbox:v2.11.12-ldap\n        ports:\n        - name: http\n          containerPort: 8080\n        readinessProbe:\n          httpGet:\n            path: /\n            port: http\n          initialDelaySeconds: 5\n          periodSeconds: 20\n        envFrom:\n        - configMapRef:\n            name: netbox-configmap\n        lifecycle:\n          postStart:\n            exec:\n              command:\n              - /bin/sh\n              - -c\n              - 'bash /home/install-plugins.sh && bash /home/start-rqworker.sh &&\n                bash /home/nginx-caching-fix.sh\n\n                '\n        volumeMounts:\n        - name: auth-ldap-bind-password\n          mountPath: /run/secrets/auth_ldap_bind_password\n          subPath: auth_ldap_bind_password\n          readOnly: true\n        - name: db-password\n          mountPath: /run/secrets/db_password\n          subPath: db_password\n          readOnly: true\n        - name: email-password\n          mountPath: /run/secrets/email_password\n          subPath: email_password\n          readOnly: true\n        - name: napalm-password\n          mountPath: /run/secrets/napalm_password\n          subPath: napalm_password\n          readOnly: true\n        - name: redis-password\n          mountPath: /run/secrets/redis_password\n          subPath: redis_password\n        - name: secret-key\n          mountPath: /run/secrets/secret_key\n          subPath: secret_key\n          readOnly: true\n        - name: superuser-api-token\n          mountPath: /run/secrets/superuser_api_token\n          subPath: superuser_api_token\n        - name: superuser-password\n          mountPath: /run/secrets/superuser_password\n          subPath: superuser_password\n          readOnly: true\n        - name: netbox-media-files\n          mountPath: /opt/netbox/netbox/media\n        - name: ldap-config\n          subPath: ldap_config.py\n          mountPath: /opt/netbox/netbox/netbox/ldap_config.py\n        - mountPath: /etc/netbox/config/netbox-plugins.py\n          name: netbox-plugins\n          subPath: netbox-plugins.py\n        - mountPath: /home/install-plugins.sh\n          name: install-plugins\n          subPath: install-plugins.sh\n        - mountPath: /home/start-rqworker.sh\n          name: start-rqworker\n          subPath: start-rqworker.sh\n        - mountPath: /home/nginx-caching-fix.sh\n          name: nginx-caching-fix\n          subPath: nginx-caching-fix.sh\n        - name: sso-saml2-xml\n          mountPath: /opt/netbox/sso-saml2.xml\n          subPath: sso-saml2-metadata.xml\n      restartPolicy: Always\n      volumes:\n      - name: netbox-media-files\n        persistentVolumeClaim:\n          claimName: netbox-media-pvc\n          readOnly: false\n      - name: ldap-config\n        configMap:\n          name: netbox-configmap\n          items:\n          - key: ldap_config.py\n            path: ldap_config.py\n      - name: netbox-plugins\n        configMap:\n          name: startup-configmap\n          items:\n          - key: netbox-plugins.py\n            path: netbox-plugins.py\n      - name: install-plugins\n        configMap:\n          name: startup-configmap\n          items:\n          - key: install-plugins.sh\n            path: install-plugins.sh\n      - name: start-rqworker\n        configMap:\n          name: startup-configmap\n          items:\n          - key: start-rqworker.sh\n            path: start-rqworker.sh\n      - name: nginx-caching-fix\n        configMap:\n          name: startup-configmap\n          items:\n          - key: nginx-caching-fix.sh\n            path: nginx-caching-fix.sh\n      - name: sso-saml2-xml\n        configMap:\n          name: sso-saml2-xml\n          items:\n          - key: sso-saml2-metadata.xml\n            path: sso-saml2-metadata.xml\n      - name: auth-ldap-bind-password\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: auth_ldap_bind_password\n            path: auth_ldap_bind_password\n      - name: db-password\n        secret:\n          secretName: netbox-postgresql\n          items:\n          - key: password\n            path: db_password\n      - name: email-password\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: email_password\n            path: email_password\n      - name: napalm-password\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: napalm_password\n            path: napalm_password\n      - name: redis-password\n        secret:\n          secretName: netbox-redis\n          items:\n          - key: redis-password\n            path: redis_password\n      - name: secret-key\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: secret_key\n            path: secret_key\n      - name: superuser-password\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: superuser_password\n            path: superuser_password\n      - name: superuser-api-token\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: superuser_api_token\n            path: superuser_api_token\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"netbox\" does not have a read-only root file system"
  },
  {
    "id": "1068",
    "manifest_path": "data/manifests/the_stack_sample/sample_0094.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: netbox\n  namespace: netbox-community\n  labels:\n    k8s-app: netbox\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      k8s-app: netbox\n  template:\n    metadata:\n      labels:\n        k8s-app: netbox\n    spec:\n      containers:\n      - name: netbox\n        image: quay.io/netboxcommunity/netbox:v2.11.12-ldap\n        ports:\n        - name: http\n          containerPort: 8080\n        readinessProbe:\n          httpGet:\n            path: /\n            port: http\n          initialDelaySeconds: 5\n          periodSeconds: 20\n        envFrom:\n        - configMapRef:\n            name: netbox-configmap\n        lifecycle:\n          postStart:\n            exec:\n              command:\n              - /bin/sh\n              - -c\n              - 'bash /home/install-plugins.sh && bash /home/start-rqworker.sh &&\n                bash /home/nginx-caching-fix.sh\n\n                '\n        volumeMounts:\n        - name: auth-ldap-bind-password\n          mountPath: /run/secrets/auth_ldap_bind_password\n          subPath: auth_ldap_bind_password\n          readOnly: true\n        - name: db-password\n          mountPath: /run/secrets/db_password\n          subPath: db_password\n          readOnly: true\n        - name: email-password\n          mountPath: /run/secrets/email_password\n          subPath: email_password\n          readOnly: true\n        - name: napalm-password\n          mountPath: /run/secrets/napalm_password\n          subPath: napalm_password\n          readOnly: true\n        - name: redis-password\n          mountPath: /run/secrets/redis_password\n          subPath: redis_password\n        - name: secret-key\n          mountPath: /run/secrets/secret_key\n          subPath: secret_key\n          readOnly: true\n        - name: superuser-api-token\n          mountPath: /run/secrets/superuser_api_token\n          subPath: superuser_api_token\n        - name: superuser-password\n          mountPath: /run/secrets/superuser_password\n          subPath: superuser_password\n          readOnly: true\n        - name: netbox-media-files\n          mountPath: /opt/netbox/netbox/media\n        - name: ldap-config\n          subPath: ldap_config.py\n          mountPath: /opt/netbox/netbox/netbox/ldap_config.py\n        - mountPath: /etc/netbox/config/netbox-plugins.py\n          name: netbox-plugins\n          subPath: netbox-plugins.py\n        - mountPath: /home/install-plugins.sh\n          name: install-plugins\n          subPath: install-plugins.sh\n        - mountPath: /home/start-rqworker.sh\n          name: start-rqworker\n          subPath: start-rqworker.sh\n        - mountPath: /home/nginx-caching-fix.sh\n          name: nginx-caching-fix\n          subPath: nginx-caching-fix.sh\n        - name: sso-saml2-xml\n          mountPath: /opt/netbox/sso-saml2.xml\n          subPath: sso-saml2-metadata.xml\n      restartPolicy: Always\n      volumes:\n      - name: netbox-media-files\n        persistentVolumeClaim:\n          claimName: netbox-media-pvc\n          readOnly: false\n      - name: ldap-config\n        configMap:\n          name: netbox-configmap\n          items:\n          - key: ldap_config.py\n            path: ldap_config.py\n      - name: netbox-plugins\n        configMap:\n          name: startup-configmap\n          items:\n          - key: netbox-plugins.py\n            path: netbox-plugins.py\n      - name: install-plugins\n        configMap:\n          name: startup-configmap\n          items:\n          - key: install-plugins.sh\n            path: install-plugins.sh\n      - name: start-rqworker\n        configMap:\n          name: startup-configmap\n          items:\n          - key: start-rqworker.sh\n            path: start-rqworker.sh\n      - name: nginx-caching-fix\n        configMap:\n          name: startup-configmap\n          items:\n          - key: nginx-caching-fix.sh\n            path: nginx-caching-fix.sh\n      - name: sso-saml2-xml\n        configMap:\n          name: sso-saml2-xml\n          items:\n          - key: sso-saml2-metadata.xml\n            path: sso-saml2-metadata.xml\n      - name: auth-ldap-bind-password\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: auth_ldap_bind_password\n            path: auth_ldap_bind_password\n      - name: db-password\n        secret:\n          secretName: netbox-postgresql\n          items:\n          - key: password\n            path: db_password\n      - name: email-password\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: email_password\n            path: email_password\n      - name: napalm-password\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: napalm_password\n            path: napalm_password\n      - name: redis-password\n        secret:\n          secretName: netbox-redis\n          items:\n          - key: redis-password\n            path: redis_password\n      - name: secret-key\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: secret_key\n            path: secret_key\n      - name: superuser-password\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: superuser_password\n            path: superuser_password\n      - name: superuser-api-token\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: superuser_api_token\n            path: superuser_api_token\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"netbox\" is not set to runAsNonRoot"
  },
  {
    "id": "1069",
    "manifest_path": "data/manifests/the_stack_sample/sample_0094.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: netbox\n  namespace: netbox-community\n  labels:\n    k8s-app: netbox\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      k8s-app: netbox\n  template:\n    metadata:\n      labels:\n        k8s-app: netbox\n    spec:\n      containers:\n      - name: netbox\n        image: quay.io/netboxcommunity/netbox:v2.11.12-ldap\n        ports:\n        - name: http\n          containerPort: 8080\n        readinessProbe:\n          httpGet:\n            path: /\n            port: http\n          initialDelaySeconds: 5\n          periodSeconds: 20\n        envFrom:\n        - configMapRef:\n            name: netbox-configmap\n        lifecycle:\n          postStart:\n            exec:\n              command:\n              - /bin/sh\n              - -c\n              - 'bash /home/install-plugins.sh && bash /home/start-rqworker.sh &&\n                bash /home/nginx-caching-fix.sh\n\n                '\n        volumeMounts:\n        - name: auth-ldap-bind-password\n          mountPath: /run/secrets/auth_ldap_bind_password\n          subPath: auth_ldap_bind_password\n          readOnly: true\n        - name: db-password\n          mountPath: /run/secrets/db_password\n          subPath: db_password\n          readOnly: true\n        - name: email-password\n          mountPath: /run/secrets/email_password\n          subPath: email_password\n          readOnly: true\n        - name: napalm-password\n          mountPath: /run/secrets/napalm_password\n          subPath: napalm_password\n          readOnly: true\n        - name: redis-password\n          mountPath: /run/secrets/redis_password\n          subPath: redis_password\n        - name: secret-key\n          mountPath: /run/secrets/secret_key\n          subPath: secret_key\n          readOnly: true\n        - name: superuser-api-token\n          mountPath: /run/secrets/superuser_api_token\n          subPath: superuser_api_token\n        - name: superuser-password\n          mountPath: /run/secrets/superuser_password\n          subPath: superuser_password\n          readOnly: true\n        - name: netbox-media-files\n          mountPath: /opt/netbox/netbox/media\n        - name: ldap-config\n          subPath: ldap_config.py\n          mountPath: /opt/netbox/netbox/netbox/ldap_config.py\n        - mountPath: /etc/netbox/config/netbox-plugins.py\n          name: netbox-plugins\n          subPath: netbox-plugins.py\n        - mountPath: /home/install-plugins.sh\n          name: install-plugins\n          subPath: install-plugins.sh\n        - mountPath: /home/start-rqworker.sh\n          name: start-rqworker\n          subPath: start-rqworker.sh\n        - mountPath: /home/nginx-caching-fix.sh\n          name: nginx-caching-fix\n          subPath: nginx-caching-fix.sh\n        - name: sso-saml2-xml\n          mountPath: /opt/netbox/sso-saml2.xml\n          subPath: sso-saml2-metadata.xml\n      restartPolicy: Always\n      volumes:\n      - name: netbox-media-files\n        persistentVolumeClaim:\n          claimName: netbox-media-pvc\n          readOnly: false\n      - name: ldap-config\n        configMap:\n          name: netbox-configmap\n          items:\n          - key: ldap_config.py\n            path: ldap_config.py\n      - name: netbox-plugins\n        configMap:\n          name: startup-configmap\n          items:\n          - key: netbox-plugins.py\n            path: netbox-plugins.py\n      - name: install-plugins\n        configMap:\n          name: startup-configmap\n          items:\n          - key: install-plugins.sh\n            path: install-plugins.sh\n      - name: start-rqworker\n        configMap:\n          name: startup-configmap\n          items:\n          - key: start-rqworker.sh\n            path: start-rqworker.sh\n      - name: nginx-caching-fix\n        configMap:\n          name: startup-configmap\n          items:\n          - key: nginx-caching-fix.sh\n            path: nginx-caching-fix.sh\n      - name: sso-saml2-xml\n        configMap:\n          name: sso-saml2-xml\n          items:\n          - key: sso-saml2-metadata.xml\n            path: sso-saml2-metadata.xml\n      - name: auth-ldap-bind-password\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: auth_ldap_bind_password\n            path: auth_ldap_bind_password\n      - name: db-password\n        secret:\n          secretName: netbox-postgresql\n          items:\n          - key: password\n            path: db_password\n      - name: email-password\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: email_password\n            path: email_password\n      - name: napalm-password\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: napalm_password\n            path: napalm_password\n      - name: redis-password\n        secret:\n          secretName: netbox-redis\n          items:\n          - key: redis-password\n            path: redis_password\n      - name: secret-key\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: secret_key\n            path: secret_key\n      - name: superuser-password\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: superuser_password\n            path: superuser_password\n      - name: superuser-api-token\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: superuser_api_token\n            path: superuser_api_token\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"netbox\" has cpu request 0"
  },
  {
    "id": "1070",
    "manifest_path": "data/manifests/the_stack_sample/sample_0094.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: netbox\n  namespace: netbox-community\n  labels:\n    k8s-app: netbox\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      k8s-app: netbox\n  template:\n    metadata:\n      labels:\n        k8s-app: netbox\n    spec:\n      containers:\n      - name: netbox\n        image: quay.io/netboxcommunity/netbox:v2.11.12-ldap\n        ports:\n        - name: http\n          containerPort: 8080\n        readinessProbe:\n          httpGet:\n            path: /\n            port: http\n          initialDelaySeconds: 5\n          periodSeconds: 20\n        envFrom:\n        - configMapRef:\n            name: netbox-configmap\n        lifecycle:\n          postStart:\n            exec:\n              command:\n              - /bin/sh\n              - -c\n              - 'bash /home/install-plugins.sh && bash /home/start-rqworker.sh &&\n                bash /home/nginx-caching-fix.sh\n\n                '\n        volumeMounts:\n        - name: auth-ldap-bind-password\n          mountPath: /run/secrets/auth_ldap_bind_password\n          subPath: auth_ldap_bind_password\n          readOnly: true\n        - name: db-password\n          mountPath: /run/secrets/db_password\n          subPath: db_password\n          readOnly: true\n        - name: email-password\n          mountPath: /run/secrets/email_password\n          subPath: email_password\n          readOnly: true\n        - name: napalm-password\n          mountPath: /run/secrets/napalm_password\n          subPath: napalm_password\n          readOnly: true\n        - name: redis-password\n          mountPath: /run/secrets/redis_password\n          subPath: redis_password\n        - name: secret-key\n          mountPath: /run/secrets/secret_key\n          subPath: secret_key\n          readOnly: true\n        - name: superuser-api-token\n          mountPath: /run/secrets/superuser_api_token\n          subPath: superuser_api_token\n        - name: superuser-password\n          mountPath: /run/secrets/superuser_password\n          subPath: superuser_password\n          readOnly: true\n        - name: netbox-media-files\n          mountPath: /opt/netbox/netbox/media\n        - name: ldap-config\n          subPath: ldap_config.py\n          mountPath: /opt/netbox/netbox/netbox/ldap_config.py\n        - mountPath: /etc/netbox/config/netbox-plugins.py\n          name: netbox-plugins\n          subPath: netbox-plugins.py\n        - mountPath: /home/install-plugins.sh\n          name: install-plugins\n          subPath: install-plugins.sh\n        - mountPath: /home/start-rqworker.sh\n          name: start-rqworker\n          subPath: start-rqworker.sh\n        - mountPath: /home/nginx-caching-fix.sh\n          name: nginx-caching-fix\n          subPath: nginx-caching-fix.sh\n        - name: sso-saml2-xml\n          mountPath: /opt/netbox/sso-saml2.xml\n          subPath: sso-saml2-metadata.xml\n      restartPolicy: Always\n      volumes:\n      - name: netbox-media-files\n        persistentVolumeClaim:\n          claimName: netbox-media-pvc\n          readOnly: false\n      - name: ldap-config\n        configMap:\n          name: netbox-configmap\n          items:\n          - key: ldap_config.py\n            path: ldap_config.py\n      - name: netbox-plugins\n        configMap:\n          name: startup-configmap\n          items:\n          - key: netbox-plugins.py\n            path: netbox-plugins.py\n      - name: install-plugins\n        configMap:\n          name: startup-configmap\n          items:\n          - key: install-plugins.sh\n            path: install-plugins.sh\n      - name: start-rqworker\n        configMap:\n          name: startup-configmap\n          items:\n          - key: start-rqworker.sh\n            path: start-rqworker.sh\n      - name: nginx-caching-fix\n        configMap:\n          name: startup-configmap\n          items:\n          - key: nginx-caching-fix.sh\n            path: nginx-caching-fix.sh\n      - name: sso-saml2-xml\n        configMap:\n          name: sso-saml2-xml\n          items:\n          - key: sso-saml2-metadata.xml\n            path: sso-saml2-metadata.xml\n      - name: auth-ldap-bind-password\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: auth_ldap_bind_password\n            path: auth_ldap_bind_password\n      - name: db-password\n        secret:\n          secretName: netbox-postgresql\n          items:\n          - key: password\n            path: db_password\n      - name: email-password\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: email_password\n            path: email_password\n      - name: napalm-password\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: napalm_password\n            path: napalm_password\n      - name: redis-password\n        secret:\n          secretName: netbox-redis\n          items:\n          - key: redis-password\n            path: redis_password\n      - name: secret-key\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: secret_key\n            path: secret_key\n      - name: superuser-password\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: superuser_password\n            path: superuser_password\n      - name: superuser-api-token\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: superuser_api_token\n            path: superuser_api_token\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"netbox\" has memory limit 0"
  },
  {
    "id": "1071",
    "manifest_path": "data/manifests/the_stack_sample/sample_0098.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: kube-rn50-1\nspec:\n  containers:\n  - name: tf-mnist-1gpu\n    image: centaurusinfra/tf-onegpu-mnist:latest\n    workingDir: /tmp/test\n    command:\n    - sh\n    - -c\n    - python3 tf-cf-rn50-pack.py\n  restartPolicy: OnFailure\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"tf-mnist-1gpu\" is using an invalid container image, \"centaurusinfra/tf-onegpu-mnist:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "1072",
    "manifest_path": "data/manifests/the_stack_sample/sample_0098.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: kube-rn50-1\nspec:\n  containers:\n  - name: tf-mnist-1gpu\n    image: centaurusinfra/tf-onegpu-mnist:latest\n    workingDir: /tmp/test\n    command:\n    - sh\n    - -c\n    - python3 tf-cf-rn50-pack.py\n  restartPolicy: OnFailure\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"tf-mnist-1gpu\" does not have a read-only root file system"
  },
  {
    "id": "1073",
    "manifest_path": "data/manifests/the_stack_sample/sample_0098.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: kube-rn50-1\nspec:\n  containers:\n  - name: tf-mnist-1gpu\n    image: centaurusinfra/tf-onegpu-mnist:latest\n    workingDir: /tmp/test\n    command:\n    - sh\n    - -c\n    - python3 tf-cf-rn50-pack.py\n  restartPolicy: OnFailure\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"tf-mnist-1gpu\" is not set to runAsNonRoot"
  },
  {
    "id": "1074",
    "manifest_path": "data/manifests/the_stack_sample/sample_0098.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: kube-rn50-1\nspec:\n  containers:\n  - name: tf-mnist-1gpu\n    image: centaurusinfra/tf-onegpu-mnist:latest\n    workingDir: /tmp/test\n    command:\n    - sh\n    - -c\n    - python3 tf-cf-rn50-pack.py\n  restartPolicy: OnFailure\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"tf-mnist-1gpu\" has cpu request 0"
  },
  {
    "id": "1075",
    "manifest_path": "data/manifests/the_stack_sample/sample_0098.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: kube-rn50-1\nspec:\n  containers:\n  - name: tf-mnist-1gpu\n    image: centaurusinfra/tf-onegpu-mnist:latest\n    workingDir: /tmp/test\n    command:\n    - sh\n    - -c\n    - python3 tf-cf-rn50-pack.py\n  restartPolicy: OnFailure\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"tf-mnist-1gpu\" has memory limit 0"
  },
  {
    "id": "1076",
    "manifest_path": "data/manifests/the_stack_sample/sample_0099.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: mongo\n  labels:\n    app: reddit\n    component: mongo\n    comment-db: 'true'\n    post-db: 'true'\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: reddit\n      component: mongo\n  template:\n    metadata:\n      name: mongo\n      labels:\n        app: reddit\n        component: mongo\n        comment-db: 'true'\n        post-db: 'true'\n    spec:\n      containers:\n      - image: mongo:3.2\n        name: mongo\n        volumeMounts:\n        - name: mongo-gce-pd-storage\n          mountPath: /data/db\n      volumes:\n      - name: mongo-gce-pd-storage\n        persistentVolumeClaim:\n          claimName: mongo-pvc-dynamic\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"mongo\" does not have a read-only root file system"
  },
  {
    "id": "1077",
    "manifest_path": "data/manifests/the_stack_sample/sample_0099.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: mongo\n  labels:\n    app: reddit\n    component: mongo\n    comment-db: 'true'\n    post-db: 'true'\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: reddit\n      component: mongo\n  template:\n    metadata:\n      name: mongo\n      labels:\n        app: reddit\n        component: mongo\n        comment-db: 'true'\n        post-db: 'true'\n    spec:\n      containers:\n      - image: mongo:3.2\n        name: mongo\n        volumeMounts:\n        - name: mongo-gce-pd-storage\n          mountPath: /data/db\n      volumes:\n      - name: mongo-gce-pd-storage\n        persistentVolumeClaim:\n          claimName: mongo-pvc-dynamic\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"mongo\" is not set to runAsNonRoot"
  },
  {
    "id": "1078",
    "manifest_path": "data/manifests/the_stack_sample/sample_0099.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: mongo\n  labels:\n    app: reddit\n    component: mongo\n    comment-db: 'true'\n    post-db: 'true'\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: reddit\n      component: mongo\n  template:\n    metadata:\n      name: mongo\n      labels:\n        app: reddit\n        component: mongo\n        comment-db: 'true'\n        post-db: 'true'\n    spec:\n      containers:\n      - image: mongo:3.2\n        name: mongo\n        volumeMounts:\n        - name: mongo-gce-pd-storage\n          mountPath: /data/db\n      volumes:\n      - name: mongo-gce-pd-storage\n        persistentVolumeClaim:\n          claimName: mongo-pvc-dynamic\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"mongo\" has cpu request 0"
  },
  {
    "id": "1079",
    "manifest_path": "data/manifests/the_stack_sample/sample_0099.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: mongo\n  labels:\n    app: reddit\n    component: mongo\n    comment-db: 'true'\n    post-db: 'true'\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: reddit\n      component: mongo\n  template:\n    metadata:\n      name: mongo\n      labels:\n        app: reddit\n        component: mongo\n        comment-db: 'true'\n        post-db: 'true'\n    spec:\n      containers:\n      - image: mongo:3.2\n        name: mongo\n        volumeMounts:\n        - name: mongo-gce-pd-storage\n          mountPath: /data/db\n      volumes:\n      - name: mongo-gce-pd-storage\n        persistentVolumeClaim:\n          claimName: mongo-pvc-dynamic\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"mongo\" has memory limit 0"
  },
  {
    "id": "1080",
    "manifest_path": "data/manifests/the_stack_sample/sample_0100.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Service\nmetadata:\n  name: kyuubi-example-service\nspec:\n  ports:\n  - nodePort: 30009\n    port: 10009\n    protocol: TCP\n  type: NodePort\n  selector:\n    app: kyuubi-server\n",
    "policy_id": "dangling-service",
    "violation_text": "no pods found matching service labels (map[app:kyuubi-server])"
  }
]