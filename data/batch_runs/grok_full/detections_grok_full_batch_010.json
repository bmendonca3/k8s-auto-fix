[
  {
    "id": "401",
    "manifest_path": "data/manifests/artifacthub/fluent/fluent-bit/007_pod_release-name-fluent-bit-test-connection.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: release-name-fluent-bit-test-connection\n  namespace: default\n  labels:\n    helm.sh/chart: fluent-bit-0.53.0\n    app.kubernetes.io/version: 4.0.7\n    app.kubernetes.io/managed-by: Helm\n  annotations:\n    helm.sh/hook: test\n    helm.sh/hook-delete-policy: hook-succeeded\nspec:\n  containers:\n  - name: wget\n    image: busybox:latest\n    imagePullPolicy: Always\n    command:\n    - sh\n    args:\n    - -c\n    - sleep 5s && wget -O- release-name-fluent-bit:2020\n  restartPolicy: Never\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"wget\" does not have a read-only root file system"
  },
  {
    "id": "402",
    "manifest_path": "data/manifests/artifacthub/fluent/fluent-bit/007_pod_release-name-fluent-bit-test-connection.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: release-name-fluent-bit-test-connection\n  namespace: default\n  labels:\n    helm.sh/chart: fluent-bit-0.53.0\n    app.kubernetes.io/version: 4.0.7\n    app.kubernetes.io/managed-by: Helm\n  annotations:\n    helm.sh/hook: test\n    helm.sh/hook-delete-policy: hook-succeeded\nspec:\n  containers:\n  - name: wget\n    image: busybox:latest\n    imagePullPolicy: Always\n    command:\n    - sh\n    args:\n    - -c\n    - sleep 5s && wget -O- release-name-fluent-bit:2020\n  restartPolicy: Never\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"wget\" is not set to runAsNonRoot"
  },
  {
    "id": "403",
    "manifest_path": "data/manifests/artifacthub/fluent/fluent-bit/007_pod_release-name-fluent-bit-test-connection.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: release-name-fluent-bit-test-connection\n  namespace: default\n  labels:\n    helm.sh/chart: fluent-bit-0.53.0\n    app.kubernetes.io/version: 4.0.7\n    app.kubernetes.io/managed-by: Helm\n  annotations:\n    helm.sh/hook: test\n    helm.sh/hook-delete-policy: hook-succeeded\nspec:\n  containers:\n  - name: wget\n    image: busybox:latest\n    imagePullPolicy: Always\n    command:\n    - sh\n    args:\n    - -c\n    - sleep 5s && wget -O- release-name-fluent-bit:2020\n  restartPolicy: Never\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"wget\" has cpu request 0"
  },
  {
    "id": "404",
    "manifest_path": "data/manifests/artifacthub/fluent/fluent-bit/007_pod_release-name-fluent-bit-test-connection.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: release-name-fluent-bit-test-connection\n  namespace: default\n  labels:\n    helm.sh/chart: fluent-bit-0.53.0\n    app.kubernetes.io/version: 4.0.7\n    app.kubernetes.io/managed-by: Helm\n  annotations:\n    helm.sh/hook: test\n    helm.sh/hook-delete-policy: hook-succeeded\nspec:\n  containers:\n  - name: wget\n    image: busybox:latest\n    imagePullPolicy: Always\n    command:\n    - sh\n    args:\n    - -c\n    - sleep 5s && wget -O- release-name-fluent-bit:2020\n  restartPolicy: Never\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"wget\" has memory limit 0"
  },
  {
    "id": "405",
    "manifest_path": "data/manifests/artifacthub/gitea/gitea/004_poddisruptionbudget_release-name-postgresql-ha-pgpool.yaml",
    "manifest_yaml": "apiVersion: policy/v1\nkind: PodDisruptionBudget\nmetadata:\n  name: release-name-postgresql-ha-pgpool\n  namespace: default\n  labels:\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/name: postgresql-ha\n    app.kubernetes.io/version: 4.6.3\n    helm.sh/chart: postgresql-ha-16.3.2\n    app.kubernetes.io/component: pgpool\nspec:\n  maxUnavailable: 1\n  selector:\n    matchLabels:\n      app.kubernetes.io/instance: release-name\n      app.kubernetes.io/name: postgresql-ha\n      app.kubernetes.io/component: pgpool\n",
    "policy_id": "pdb-unhealthy-pod-eviction-policy",
    "violation_text": "unhealthyPodEvictionPolicy is not explicitly set"
  },
  {
    "id": "406",
    "manifest_path": "data/manifests/artifacthub/gitea/gitea/005_poddisruptionbudget_release-name-postgresql-ha-postgresql.yaml",
    "manifest_yaml": "apiVersion: policy/v1\nkind: PodDisruptionBudget\nmetadata:\n  name: release-name-postgresql-ha-postgresql\n  namespace: default\n  labels:\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/name: postgresql-ha\n    app.kubernetes.io/version: 17.6.0\n    helm.sh/chart: postgresql-ha-16.3.2\n    app.kubernetes.io/component: postgresql\nspec:\n  maxUnavailable: 1\n  selector:\n    matchLabels:\n      app.kubernetes.io/instance: release-name\n      app.kubernetes.io/name: postgresql-ha\n      app.kubernetes.io/component: postgresql\n",
    "policy_id": "pdb-unhealthy-pod-eviction-policy",
    "violation_text": "unhealthyPodEvictionPolicy is not explicitly set"
  },
  {
    "id": "407",
    "manifest_path": "data/manifests/artifacthub/gitea/gitea/006_poddisruptionbudget_release-name-postgresql-ha-postgresql-witness.yaml",
    "manifest_yaml": "apiVersion: policy/v1\nkind: PodDisruptionBudget\nmetadata:\n  name: release-name-postgresql-ha-postgresql-witness\n  namespace: default\n  labels:\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/name: postgresql-ha\n    app.kubernetes.io/version: 17.6.0\n    helm.sh/chart: postgresql-ha-16.3.2\n    app.kubernetes.io/component: postgresql\n    role: witness\nspec:\n  maxUnavailable: 1\n  selector:\n    matchLabels:\n      app.kubernetes.io/instance: release-name\n      app.kubernetes.io/name: postgresql-ha\n      app.kubernetes.io/component: postgresql\n      role: witness\n",
    "policy_id": "pdb-unhealthy-pod-eviction-policy",
    "violation_text": "unhealthyPodEvictionPolicy is not explicitly set"
  },
  {
    "id": "408",
    "manifest_path": "data/manifests/artifacthub/gitea/gitea/007_poddisruptionbudget_release-name-valkey-cluster.yaml",
    "manifest_yaml": "apiVersion: policy/v1\nkind: PodDisruptionBudget\nmetadata:\n  name: release-name-valkey-cluster\n  namespace: default\n  labels:\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/name: valkey-cluster\n    app.kubernetes.io/version: 8.1.3\n    helm.sh/chart: valkey-cluster-3.0.24\nspec:\n  maxUnavailable: 1\n  selector:\n    matchLabels:\n      app.kubernetes.io/instance: release-name\n      app.kubernetes.io/name: valkey-cluster\n    matchExpressions:\n    - key: job-name\n      operator: NotIn\n      values:\n      - release-name-valkey-cluster-cluster-update\n",
    "policy_id": "pdb-unhealthy-pod-eviction-policy",
    "violation_text": "unhealthyPodEvictionPolicy is not explicitly set"
  },
  {
    "id": "409",
    "manifest_path": "data/manifests/artifacthub/gitea/gitea/019_service_release-name-postgresql-ha-pgpool.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Service\nmetadata:\n  name: release-name-postgresql-ha-pgpool\n  namespace: default\n  labels:\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/name: postgresql-ha\n    app.kubernetes.io/version: 4.6.3\n    helm.sh/chart: postgresql-ha-16.3.2\n    app.kubernetes.io/component: pgpool\nspec:\n  type: ClusterIP\n  sessionAffinity: None\n  ports:\n  - name: postgresql\n    port: 5432\n    targetPort: postgresql\n    protocol: TCP\n    nodePort: null\n  selector:\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/name: postgresql-ha\n    app.kubernetes.io/component: pgpool\n",
    "policy_id": "dangling-service",
    "violation_text": "no pods found matching service labels (map[app.kubernetes.io/component:pgpool app.kubernetes.io/instance:release-name app.kubernetes.io/name:postgresql-ha])"
  },
  {
    "id": "410",
    "manifest_path": "data/manifests/artifacthub/gitea/gitea/020_service_release-name-postgresql-ha-postgresql-headless.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Service\nmetadata:\n  name: release-name-postgresql-ha-postgresql-headless\n  namespace: default\n  labels:\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/name: postgresql-ha\n    app.kubernetes.io/version: 17.6.0\n    helm.sh/chart: postgresql-ha-16.3.2\nspec:\n  type: ClusterIP\n  clusterIP: None\n  publishNotReadyAddresses: false\n  ports:\n  - name: postgresql\n    port: 5432\n    targetPort: postgresql\n    protocol: TCP\n  selector:\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/name: postgresql-ha\n    app.kubernetes.io/component: postgresql\n    role: data\n",
    "policy_id": "dangling-service",
    "violation_text": "no pods found matching service labels (map[app.kubernetes.io/component:postgresql app.kubernetes.io/instance:release-name app.kubernetes.io/name:postgresql-ha role:data])"
  },
  {
    "id": "411",
    "manifest_path": "data/manifests/artifacthub/gitea/gitea/021_service_release-name-postgresql-ha-postgresql.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Service\nmetadata:\n  name: release-name-postgresql-ha-postgresql\n  namespace: default\n  labels:\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/name: postgresql-ha\n    app.kubernetes.io/version: 17.6.0\n    helm.sh/chart: postgresql-ha-16.3.2\n    app.kubernetes.io/component: postgresql\nspec:\n  type: ClusterIP\n  ports:\n  - name: postgresql\n    port: 5432\n    targetPort: postgresql\n    protocol: TCP\n  selector:\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/name: postgresql-ha\n    app.kubernetes.io/component: postgresql\n    role: data\n",
    "policy_id": "dangling-service",
    "violation_text": "no pods found matching service labels (map[app.kubernetes.io/component:postgresql app.kubernetes.io/instance:release-name app.kubernetes.io/name:postgresql-ha role:data])"
  },
  {
    "id": "412",
    "manifest_path": "data/manifests/artifacthub/gitea/gitea/022_service_release-name-valkey-cluster-headless.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Service\nmetadata:\n  name: release-name-valkey-cluster-headless\n  namespace: default\n  labels:\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/name: valkey-cluster\n    app.kubernetes.io/version: 8.1.3\n    helm.sh/chart: valkey-cluster-3.0.24\nspec:\n  type: ClusterIP\n  clusterIP: None\n  publishNotReadyAddresses: true\n  ports:\n  - name: tcp-redis\n    port: 6379\n    targetPort: tcp-redis\n  - name: tcp-redis-bus\n    port: 16379\n    targetPort: tcp-redis-bus\n  selector:\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/name: valkey-cluster\n",
    "policy_id": "dangling-service",
    "violation_text": "no pods found matching service labels (map[app.kubernetes.io/instance:release-name app.kubernetes.io/name:valkey-cluster])"
  },
  {
    "id": "413",
    "manifest_path": "data/manifests/artifacthub/gitea/gitea/023_service_release-name-valkey-cluster.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Service\nmetadata:\n  name: release-name-valkey-cluster\n  namespace: default\n  labels:\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/name: valkey-cluster\n    app.kubernetes.io/version: 8.1.3\n    helm.sh/chart: valkey-cluster-3.0.24\nspec:\n  type: ClusterIP\n  sessionAffinity: None\n  ports:\n  - name: tcp-redis\n    port: 6379\n    targetPort: tcp-redis\n    protocol: TCP\n    nodePort: null\n  selector:\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/name: valkey-cluster\n",
    "policy_id": "dangling-service",
    "violation_text": "no pods found matching service labels (map[app.kubernetes.io/instance:release-name app.kubernetes.io/name:valkey-cluster])"
  },
  {
    "id": "414",
    "manifest_path": "data/manifests/artifacthub/gitea/gitea/024_service_release-name-gitea-http.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Service\nmetadata:\n  name: release-name-gitea-http\n  namespace: default\n  labels:\n    helm.sh/chart: gitea-12.4.0\n    app: gitea\n    app.kubernetes.io/name: gitea\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/version: 1.24.6\n    version: 1.24.6\n    app.kubernetes.io/managed-by: Helm\n  annotations: {}\nspec:\n  type: ClusterIP\n  clusterIP: None\n  ports:\n  - name: http\n    port: 3000\n    targetPort: null\n  selector:\n    app.kubernetes.io/name: gitea\n    app.kubernetes.io/instance: release-name\n",
    "policy_id": "dangling-service",
    "violation_text": "no pods found matching service labels (map[app.kubernetes.io/instance:release-name app.kubernetes.io/name:gitea])"
  },
  {
    "id": "415",
    "manifest_path": "data/manifests/artifacthub/gitea/gitea/025_service_release-name-gitea-ssh.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Service\nmetadata:\n  name: release-name-gitea-ssh\n  namespace: default\n  labels:\n    helm.sh/chart: gitea-12.4.0\n    app: gitea\n    app.kubernetes.io/name: gitea\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/version: 1.24.6\n    version: 1.24.6\n    app.kubernetes.io/managed-by: Helm\n  annotations: {}\nspec:\n  type: ClusterIP\n  clusterIP: None\n  ports:\n  - name: ssh\n    port: 22\n    targetPort: 2222\n    protocol: TCP\n  selector:\n    app.kubernetes.io/name: gitea\n    app.kubernetes.io/instance: release-name\n",
    "policy_id": "dangling-service",
    "violation_text": "no pods found matching service labels (map[app.kubernetes.io/instance:release-name app.kubernetes.io/name:gitea])"
  },
  {
    "id": "416",
    "manifest_path": "data/manifests/artifacthub/gitea/gitea/026_deployment_release-name-postgresql-ha-pgpool.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: release-name-postgresql-ha-pgpool\n  namespace: default\n  labels:\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/name: postgresql-ha\n    app.kubernetes.io/version: 4.6.3\n    helm.sh/chart: postgresql-ha-16.3.2\n    app.kubernetes.io/component: pgpool\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app.kubernetes.io/instance: release-name\n      app.kubernetes.io/name: postgresql-ha\n      app.kubernetes.io/component: pgpool\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/instance: release-name\n        app.kubernetes.io/managed-by: Helm\n        app.kubernetes.io/name: postgresql-ha\n        app.kubernetes.io/version: 4.6.3\n        helm.sh/chart: postgresql-ha-16.3.2\n        app.kubernetes.io/component: pgpool\n      annotations: null\n    spec:\n      automountServiceAccountToken: false\n      affinity:\n        podAffinity: null\n        podAntiAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - podAffinityTerm:\n              labelSelector:\n                matchLabels:\n                  app.kubernetes.io/instance: release-name\n                  app.kubernetes.io/name: postgresql-ha\n                  app.kubernetes.io/component: pgpool\n              topologyKey: kubernetes.io/hostname\n            weight: 1\n        nodeAffinity: null\n      securityContext:\n        fsGroup: 1001\n        fsGroupChangePolicy: Always\n        supplementalGroups: []\n        sysctls: []\n      serviceAccountName: release-name-postgresql-ha\n      containers:\n      - name: pgpool\n        image: docker.io/bitnamilegacy/pgpool:4.6.3-debian-12-r0\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - ALL\n          privileged: false\n          readOnlyRootFilesystem: true\n          runAsGroup: 1001\n          runAsNonRoot: true\n          runAsUser: 1001\n          seLinuxOptions: {}\n          seccompProfile:\n            type: RuntimeDefault\n        env:\n        - name: BITNAMI_DEBUG\n          value: 'false'\n        - name: REPMGR_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: PGPOOL_BACKEND_NODES\n          value: 0:release-name-postgresql-ha-postgresql-0.release-name-postgresql-ha-postgresql-headless.$(REPMGR_NAMESPACE).svc.cluster.local:5432,1:release-name-postgresql-ha-postgresql-1.release-name-postgresql-ha-postgresql-headless.$(REPMGR_NAMESPACE).svc.cluster.local:5432,2:release-name-postgresql-ha-postgresql-2.release-name-postgresql-ha-postgresql-headless.$(REPMGR_NAMESPACE).svc.cluster.local:5432,\n        - name: PGPOOL_SR_CHECK_USER\n          value: sr_check_user\n        - name: PGPOOL_SR_CHECK_PASSWORD_FILE\n          value: /opt/bitnami/pgpool/secrets/sr-check-password\n        - name: PGPOOL_SR_CHECK_DATABASE\n          value: postgres\n        - name: PGPOOL_ENABLE_LDAP\n          value: 'no'\n        - name: PGPOOL_POSTGRES_USERNAME\n          value: gitea\n        - name: PGPOOL_POSTGRES_PASSWORD_FILE\n          value: /opt/bitnami/pgpool/secrets/pgpool-password\n        - name: PGPOOL_ADMIN_USERNAME\n          value: admin\n        - name: PGPOOL_ADMIN_PASSWORD_FILE\n          value: /opt/bitnami/pgpool/secrets/admin-password\n        - name: PGPOOL_AUTHENTICATION_METHOD\n          value: scram-sha-256\n        - name: PGPOOL_ENABLE_LOAD_BALANCING\n          value: 'yes'\n        - name: PGPOOL_ENABLE_CONNECTION_CACHE\n          value: 'yes'\n        - name: PGPOOL_DISABLE_LOAD_BALANCE_ON_WRITE\n          value: transaction\n        - name: PGPOOL_ENABLE_LOG_CONNECTIONS\n          value: 'no'\n        - name: PGPOOL_ENABLE_LOG_HOSTNAME\n          value: 'yes'\n        - name: PGPOOL_ENABLE_LOG_PCP_PROCESSES\n          value: 'yes'\n        - name: PGPOOL_ENABLE_LOG_PER_NODE_STATEMENT\n          value: 'no'\n        - name: PGPOOL_RESERVED_CONNECTIONS\n          value: '1'\n        - name: PGPOOL_CHILD_LIFE_TIME\n          value: ''\n        - name: PGPOOL_ENABLE_TLS\n          value: 'no'\n        - name: PGPOOL_HEALTH_CHECK_PSQL_TIMEOUT\n          value: '6'\n        envFrom: null\n        ports:\n        - name: postgresql\n          containerPort: 5432\n          protocol: TCP\n        livenessProbe:\n          failureThreshold: 3\n          initialDelaySeconds: 30\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 5\n          exec:\n            command:\n            - /opt/bitnami/scripts/pgpool/healthcheck.sh\n        readinessProbe:\n          failureThreshold: 5\n          initialDelaySeconds: 5\n          periodSeconds: 5\n          successThreshold: 1\n          timeoutSeconds: 5\n          exec:\n            command:\n            - bash\n            - -ec\n            - PGPASSWORD=$(< $PGPOOL_POSTGRES_PASSWORD_FILE) psql -U \"gitea\" -d \"gitea\"\n              -h /opt/bitnami/pgpool/tmp -tA -c \"SELECT 1\" >/dev/null\n        resources:\n          limits:\n            cpu: 375m\n            ephemeral-storage: 2Gi\n            memory: 384Mi\n          requests:\n            cpu: 250m\n            ephemeral-storage: 50Mi\n            memory: 256Mi\n        volumeMounts:\n        - name: empty-dir\n          mountPath: /tmp\n          subPath: tmp-dir\n        - name: empty-dir\n          mountPath: /opt/bitnami/pgpool/etc\n          subPath: app-etc-dir\n        - name: empty-dir\n          mountPath: /opt/bitnami/pgpool/conf\n          subPath: app-conf-dir\n        - name: empty-dir\n          mountPath: /opt/bitnami/pgpool/tmp\n          subPath: app-tmp-dir\n        - name: empty-dir\n          mountPath: /opt/bitnami/pgpool/logs\n          subPath: app-logs-dir\n        - name: postgresql-creds\n          subPath: pgpool-password\n          mountPath: /opt/bitnami/pgpool/secrets/pgpool-password\n        - name: pgpool-creds\n          subPath: admin-password\n          mountPath: /opt/bitnami/pgpool/secrets/admin-password\n        - name: pgpool-creds\n          subPath: sr-check-password\n          mountPath: /opt/bitnami/pgpool/secrets/sr-check-password\n      volumes:\n      - name: empty-dir\n        emptyDir: {}\n      - name: postgresql-creds\n        secret:\n          secretName: release-name-postgresql-ha-postgresql\n          items:\n          - key: password\n            path: pgpool-password\n      - name: pgpool-creds\n        secret:\n          secretName: release-name-postgresql-ha-pgpool\n",
    "policy_id": "non-existent-service-account",
    "violation_text": "serviceAccount \"release-name-postgresql-ha\" not found"
  },
  {
    "id": "417",
    "manifest_path": "data/manifests/artifacthub/gitea/gitea/027_deployment_release-name-gitea.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: release-name-gitea\n  namespace: default\n  annotations: null\n  labels:\n    helm.sh/chart: gitea-12.4.0\n    app: gitea\n    app.kubernetes.io/name: gitea\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/version: 1.24.6\n    version: 1.24.6\n    app.kubernetes.io/managed-by: Helm\nspec:\n  replicas: 1\n  strategy:\n    type: RollingUpdate\n    rollingUpdate:\n      maxUnavailable: 0\n      maxSurge: 100%\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: gitea\n      app.kubernetes.io/instance: release-name\n  template:\n    metadata:\n      annotations:\n        checksum/config: bb454c57a0d08076ac35d4f54b5de0cf4b6d442941fd825366a47173d035eb5b\n      labels:\n        helm.sh/chart: gitea-12.4.0\n        app: gitea\n        app.kubernetes.io/name: gitea\n        app.kubernetes.io/instance: release-name\n        app.kubernetes.io/version: 1.24.6\n        version: 1.24.6\n        app.kubernetes.io/managed-by: Helm\n    spec:\n      securityContext:\n        fsGroup: 1000\n      initContainers:\n      - name: init-directories\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        imagePullPolicy: IfNotPresent\n        command:\n        - /usr/sbinx/init_directory_structure.sh\n        env:\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        volumeMounts:\n        - name: init\n          mountPath: /usr/sbinx\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n        securityContext: {}\n        resources:\n          limits: {}\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      - name: init-app-ini\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        imagePullPolicy: IfNotPresent\n        command:\n        - /usr/sbinx/config_environment.sh\n        env:\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        - name: TMP_EXISTING_ENVS_FILE\n          value: /tmp/existing-envs\n        - name: ENV_TO_INI_MOUNT_POINT\n          value: /env-to-ini-mounts\n        volumeMounts:\n        - name: config\n          mountPath: /usr/sbinx\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n        - name: inline-config-sources\n          mountPath: /env-to-ini-mounts/inlines/\n        securityContext: {}\n        resources:\n          limits: {}\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      - name: configure-gitea\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        command:\n        - /usr/sbinx/configure_gitea.sh\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          runAsUser: 1000\n        env:\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        - name: HOME\n          value: /data/gitea/git\n        - name: GITEA_ADMIN_USERNAME\n          value: gitea_admin\n        - name: GITEA_ADMIN_PASSWORD\n          value: r8sA8CPHD9!bt6d\n        - name: GITEA_ADMIN_PASSWORD_MODE\n          value: keepUpdated\n        volumeMounts:\n        - name: init\n          mountPath: /usr/sbinx\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n        resources:\n          limits: {}\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      terminationGracePeriodSeconds: 60\n      containers:\n      - name: gitea\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        imagePullPolicy: IfNotPresent\n        env:\n        - name: SSH_LISTEN_PORT\n          value: '2222'\n        - name: SSH_PORT\n          value: '22'\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        - name: TMPDIR\n          value: /tmp/gitea\n        - name: HOME\n          value: /data/gitea/git\n        ports:\n        - name: ssh\n          containerPort: 2222\n        - name: http\n          containerPort: 3000\n        livenessProbe:\n          failureThreshold: 10\n          initialDelaySeconds: 200\n          periodSeconds: 10\n          successThreshold: 1\n          tcpSocket:\n            port: http\n          timeoutSeconds: 1\n        readinessProbe:\n          failureThreshold: 3\n          initialDelaySeconds: 5\n          periodSeconds: 10\n          successThreshold: 1\n          tcpSocket:\n            port: http\n          timeoutSeconds: 1\n        resources: {}\n        securityContext: {}\n        volumeMounts:\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n      volumes:\n      - name: init\n        secret:\n          secretName: release-name-gitea-init\n          defaultMode: 110\n      - name: config\n        secret:\n          secretName: release-name-gitea\n          defaultMode: 110\n      - name: inline-config-sources\n        secret:\n          secretName: release-name-gitea-inline-config\n      - name: temp\n        emptyDir: {}\n      - name: data\n        persistentVolumeClaim:\n          claimName: gitea-shared-storage\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"configure-gitea\" does not have a read-only root file system"
  },
  {
    "id": "418",
    "manifest_path": "data/manifests/artifacthub/gitea/gitea/027_deployment_release-name-gitea.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: release-name-gitea\n  namespace: default\n  annotations: null\n  labels:\n    helm.sh/chart: gitea-12.4.0\n    app: gitea\n    app.kubernetes.io/name: gitea\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/version: 1.24.6\n    version: 1.24.6\n    app.kubernetes.io/managed-by: Helm\nspec:\n  replicas: 1\n  strategy:\n    type: RollingUpdate\n    rollingUpdate:\n      maxUnavailable: 0\n      maxSurge: 100%\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: gitea\n      app.kubernetes.io/instance: release-name\n  template:\n    metadata:\n      annotations:\n        checksum/config: bb454c57a0d08076ac35d4f54b5de0cf4b6d442941fd825366a47173d035eb5b\n      labels:\n        helm.sh/chart: gitea-12.4.0\n        app: gitea\n        app.kubernetes.io/name: gitea\n        app.kubernetes.io/instance: release-name\n        app.kubernetes.io/version: 1.24.6\n        version: 1.24.6\n        app.kubernetes.io/managed-by: Helm\n    spec:\n      securityContext:\n        fsGroup: 1000\n      initContainers:\n      - name: init-directories\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        imagePullPolicy: IfNotPresent\n        command:\n        - /usr/sbinx/init_directory_structure.sh\n        env:\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        volumeMounts:\n        - name: init\n          mountPath: /usr/sbinx\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n        securityContext: {}\n        resources:\n          limits: {}\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      - name: init-app-ini\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        imagePullPolicy: IfNotPresent\n        command:\n        - /usr/sbinx/config_environment.sh\n        env:\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        - name: TMP_EXISTING_ENVS_FILE\n          value: /tmp/existing-envs\n        - name: ENV_TO_INI_MOUNT_POINT\n          value: /env-to-ini-mounts\n        volumeMounts:\n        - name: config\n          mountPath: /usr/sbinx\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n        - name: inline-config-sources\n          mountPath: /env-to-ini-mounts/inlines/\n        securityContext: {}\n        resources:\n          limits: {}\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      - name: configure-gitea\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        command:\n        - /usr/sbinx/configure_gitea.sh\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          runAsUser: 1000\n        env:\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        - name: HOME\n          value: /data/gitea/git\n        - name: GITEA_ADMIN_USERNAME\n          value: gitea_admin\n        - name: GITEA_ADMIN_PASSWORD\n          value: r8sA8CPHD9!bt6d\n        - name: GITEA_ADMIN_PASSWORD_MODE\n          value: keepUpdated\n        volumeMounts:\n        - name: init\n          mountPath: /usr/sbinx\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n        resources:\n          limits: {}\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      terminationGracePeriodSeconds: 60\n      containers:\n      - name: gitea\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        imagePullPolicy: IfNotPresent\n        env:\n        - name: SSH_LISTEN_PORT\n          value: '2222'\n        - name: SSH_PORT\n          value: '22'\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        - name: TMPDIR\n          value: /tmp/gitea\n        - name: HOME\n          value: /data/gitea/git\n        ports:\n        - name: ssh\n          containerPort: 2222\n        - name: http\n          containerPort: 3000\n        livenessProbe:\n          failureThreshold: 10\n          initialDelaySeconds: 200\n          periodSeconds: 10\n          successThreshold: 1\n          tcpSocket:\n            port: http\n          timeoutSeconds: 1\n        readinessProbe:\n          failureThreshold: 3\n          initialDelaySeconds: 5\n          periodSeconds: 10\n          successThreshold: 1\n          tcpSocket:\n            port: http\n          timeoutSeconds: 1\n        resources: {}\n        securityContext: {}\n        volumeMounts:\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n      volumes:\n      - name: init\n        secret:\n          secretName: release-name-gitea-init\n          defaultMode: 110\n      - name: config\n        secret:\n          secretName: release-name-gitea\n          defaultMode: 110\n      - name: inline-config-sources\n        secret:\n          secretName: release-name-gitea-inline-config\n      - name: temp\n        emptyDir: {}\n      - name: data\n        persistentVolumeClaim:\n          claimName: gitea-shared-storage\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"gitea\" does not have a read-only root file system"
  },
  {
    "id": "419",
    "manifest_path": "data/manifests/artifacthub/gitea/gitea/027_deployment_release-name-gitea.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: release-name-gitea\n  namespace: default\n  annotations: null\n  labels:\n    helm.sh/chart: gitea-12.4.0\n    app: gitea\n    app.kubernetes.io/name: gitea\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/version: 1.24.6\n    version: 1.24.6\n    app.kubernetes.io/managed-by: Helm\nspec:\n  replicas: 1\n  strategy:\n    type: RollingUpdate\n    rollingUpdate:\n      maxUnavailable: 0\n      maxSurge: 100%\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: gitea\n      app.kubernetes.io/instance: release-name\n  template:\n    metadata:\n      annotations:\n        checksum/config: bb454c57a0d08076ac35d4f54b5de0cf4b6d442941fd825366a47173d035eb5b\n      labels:\n        helm.sh/chart: gitea-12.4.0\n        app: gitea\n        app.kubernetes.io/name: gitea\n        app.kubernetes.io/instance: release-name\n        app.kubernetes.io/version: 1.24.6\n        version: 1.24.6\n        app.kubernetes.io/managed-by: Helm\n    spec:\n      securityContext:\n        fsGroup: 1000\n      initContainers:\n      - name: init-directories\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        imagePullPolicy: IfNotPresent\n        command:\n        - /usr/sbinx/init_directory_structure.sh\n        env:\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        volumeMounts:\n        - name: init\n          mountPath: /usr/sbinx\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n        securityContext: {}\n        resources:\n          limits: {}\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      - name: init-app-ini\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        imagePullPolicy: IfNotPresent\n        command:\n        - /usr/sbinx/config_environment.sh\n        env:\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        - name: TMP_EXISTING_ENVS_FILE\n          value: /tmp/existing-envs\n        - name: ENV_TO_INI_MOUNT_POINT\n          value: /env-to-ini-mounts\n        volumeMounts:\n        - name: config\n          mountPath: /usr/sbinx\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n        - name: inline-config-sources\n          mountPath: /env-to-ini-mounts/inlines/\n        securityContext: {}\n        resources:\n          limits: {}\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      - name: configure-gitea\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        command:\n        - /usr/sbinx/configure_gitea.sh\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          runAsUser: 1000\n        env:\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        - name: HOME\n          value: /data/gitea/git\n        - name: GITEA_ADMIN_USERNAME\n          value: gitea_admin\n        - name: GITEA_ADMIN_PASSWORD\n          value: r8sA8CPHD9!bt6d\n        - name: GITEA_ADMIN_PASSWORD_MODE\n          value: keepUpdated\n        volumeMounts:\n        - name: init\n          mountPath: /usr/sbinx\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n        resources:\n          limits: {}\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      terminationGracePeriodSeconds: 60\n      containers:\n      - name: gitea\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        imagePullPolicy: IfNotPresent\n        env:\n        - name: SSH_LISTEN_PORT\n          value: '2222'\n        - name: SSH_PORT\n          value: '22'\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        - name: TMPDIR\n          value: /tmp/gitea\n        - name: HOME\n          value: /data/gitea/git\n        ports:\n        - name: ssh\n          containerPort: 2222\n        - name: http\n          containerPort: 3000\n        livenessProbe:\n          failureThreshold: 10\n          initialDelaySeconds: 200\n          periodSeconds: 10\n          successThreshold: 1\n          tcpSocket:\n            port: http\n          timeoutSeconds: 1\n        readinessProbe:\n          failureThreshold: 3\n          initialDelaySeconds: 5\n          periodSeconds: 10\n          successThreshold: 1\n          tcpSocket:\n            port: http\n          timeoutSeconds: 1\n        resources: {}\n        securityContext: {}\n        volumeMounts:\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n      volumes:\n      - name: init\n        secret:\n          secretName: release-name-gitea-init\n          defaultMode: 110\n      - name: config\n        secret:\n          secretName: release-name-gitea\n          defaultMode: 110\n      - name: inline-config-sources\n        secret:\n          secretName: release-name-gitea-inline-config\n      - name: temp\n        emptyDir: {}\n      - name: data\n        persistentVolumeClaim:\n          claimName: gitea-shared-storage\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"init-app-ini\" does not have a read-only root file system"
  },
  {
    "id": "420",
    "manifest_path": "data/manifests/artifacthub/gitea/gitea/027_deployment_release-name-gitea.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: release-name-gitea\n  namespace: default\n  annotations: null\n  labels:\n    helm.sh/chart: gitea-12.4.0\n    app: gitea\n    app.kubernetes.io/name: gitea\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/version: 1.24.6\n    version: 1.24.6\n    app.kubernetes.io/managed-by: Helm\nspec:\n  replicas: 1\n  strategy:\n    type: RollingUpdate\n    rollingUpdate:\n      maxUnavailable: 0\n      maxSurge: 100%\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: gitea\n      app.kubernetes.io/instance: release-name\n  template:\n    metadata:\n      annotations:\n        checksum/config: bb454c57a0d08076ac35d4f54b5de0cf4b6d442941fd825366a47173d035eb5b\n      labels:\n        helm.sh/chart: gitea-12.4.0\n        app: gitea\n        app.kubernetes.io/name: gitea\n        app.kubernetes.io/instance: release-name\n        app.kubernetes.io/version: 1.24.6\n        version: 1.24.6\n        app.kubernetes.io/managed-by: Helm\n    spec:\n      securityContext:\n        fsGroup: 1000\n      initContainers:\n      - name: init-directories\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        imagePullPolicy: IfNotPresent\n        command:\n        - /usr/sbinx/init_directory_structure.sh\n        env:\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        volumeMounts:\n        - name: init\n          mountPath: /usr/sbinx\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n        securityContext: {}\n        resources:\n          limits: {}\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      - name: init-app-ini\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        imagePullPolicy: IfNotPresent\n        command:\n        - /usr/sbinx/config_environment.sh\n        env:\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        - name: TMP_EXISTING_ENVS_FILE\n          value: /tmp/existing-envs\n        - name: ENV_TO_INI_MOUNT_POINT\n          value: /env-to-ini-mounts\n        volumeMounts:\n        - name: config\n          mountPath: /usr/sbinx\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n        - name: inline-config-sources\n          mountPath: /env-to-ini-mounts/inlines/\n        securityContext: {}\n        resources:\n          limits: {}\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      - name: configure-gitea\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        command:\n        - /usr/sbinx/configure_gitea.sh\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          runAsUser: 1000\n        env:\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        - name: HOME\n          value: /data/gitea/git\n        - name: GITEA_ADMIN_USERNAME\n          value: gitea_admin\n        - name: GITEA_ADMIN_PASSWORD\n          value: r8sA8CPHD9!bt6d\n        - name: GITEA_ADMIN_PASSWORD_MODE\n          value: keepUpdated\n        volumeMounts:\n        - name: init\n          mountPath: /usr/sbinx\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n        resources:\n          limits: {}\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      terminationGracePeriodSeconds: 60\n      containers:\n      - name: gitea\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        imagePullPolicy: IfNotPresent\n        env:\n        - name: SSH_LISTEN_PORT\n          value: '2222'\n        - name: SSH_PORT\n          value: '22'\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        - name: TMPDIR\n          value: /tmp/gitea\n        - name: HOME\n          value: /data/gitea/git\n        ports:\n        - name: ssh\n          containerPort: 2222\n        - name: http\n          containerPort: 3000\n        livenessProbe:\n          failureThreshold: 10\n          initialDelaySeconds: 200\n          periodSeconds: 10\n          successThreshold: 1\n          tcpSocket:\n            port: http\n          timeoutSeconds: 1\n        readinessProbe:\n          failureThreshold: 3\n          initialDelaySeconds: 5\n          periodSeconds: 10\n          successThreshold: 1\n          tcpSocket:\n            port: http\n          timeoutSeconds: 1\n        resources: {}\n        securityContext: {}\n        volumeMounts:\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n      volumes:\n      - name: init\n        secret:\n          secretName: release-name-gitea-init\n          defaultMode: 110\n      - name: config\n        secret:\n          secretName: release-name-gitea\n          defaultMode: 110\n      - name: inline-config-sources\n        secret:\n          secretName: release-name-gitea-inline-config\n      - name: temp\n        emptyDir: {}\n      - name: data\n        persistentVolumeClaim:\n          claimName: gitea-shared-storage\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"init-directories\" does not have a read-only root file system"
  },
  {
    "id": "421",
    "manifest_path": "data/manifests/artifacthub/gitea/gitea/027_deployment_release-name-gitea.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: release-name-gitea\n  namespace: default\n  annotations: null\n  labels:\n    helm.sh/chart: gitea-12.4.0\n    app: gitea\n    app.kubernetes.io/name: gitea\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/version: 1.24.6\n    version: 1.24.6\n    app.kubernetes.io/managed-by: Helm\nspec:\n  replicas: 1\n  strategy:\n    type: RollingUpdate\n    rollingUpdate:\n      maxUnavailable: 0\n      maxSurge: 100%\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: gitea\n      app.kubernetes.io/instance: release-name\n  template:\n    metadata:\n      annotations:\n        checksum/config: bb454c57a0d08076ac35d4f54b5de0cf4b6d442941fd825366a47173d035eb5b\n      labels:\n        helm.sh/chart: gitea-12.4.0\n        app: gitea\n        app.kubernetes.io/name: gitea\n        app.kubernetes.io/instance: release-name\n        app.kubernetes.io/version: 1.24.6\n        version: 1.24.6\n        app.kubernetes.io/managed-by: Helm\n    spec:\n      securityContext:\n        fsGroup: 1000\n      initContainers:\n      - name: init-directories\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        imagePullPolicy: IfNotPresent\n        command:\n        - /usr/sbinx/init_directory_structure.sh\n        env:\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        volumeMounts:\n        - name: init\n          mountPath: /usr/sbinx\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n        securityContext: {}\n        resources:\n          limits: {}\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      - name: init-app-ini\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        imagePullPolicy: IfNotPresent\n        command:\n        - /usr/sbinx/config_environment.sh\n        env:\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        - name: TMP_EXISTING_ENVS_FILE\n          value: /tmp/existing-envs\n        - name: ENV_TO_INI_MOUNT_POINT\n          value: /env-to-ini-mounts\n        volumeMounts:\n        - name: config\n          mountPath: /usr/sbinx\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n        - name: inline-config-sources\n          mountPath: /env-to-ini-mounts/inlines/\n        securityContext: {}\n        resources:\n          limits: {}\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      - name: configure-gitea\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        command:\n        - /usr/sbinx/configure_gitea.sh\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          runAsUser: 1000\n        env:\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        - name: HOME\n          value: /data/gitea/git\n        - name: GITEA_ADMIN_USERNAME\n          value: gitea_admin\n        - name: GITEA_ADMIN_PASSWORD\n          value: r8sA8CPHD9!bt6d\n        - name: GITEA_ADMIN_PASSWORD_MODE\n          value: keepUpdated\n        volumeMounts:\n        - name: init\n          mountPath: /usr/sbinx\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n        resources:\n          limits: {}\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      terminationGracePeriodSeconds: 60\n      containers:\n      - name: gitea\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        imagePullPolicy: IfNotPresent\n        env:\n        - name: SSH_LISTEN_PORT\n          value: '2222'\n        - name: SSH_PORT\n          value: '22'\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        - name: TMPDIR\n          value: /tmp/gitea\n        - name: HOME\n          value: /data/gitea/git\n        ports:\n        - name: ssh\n          containerPort: 2222\n        - name: http\n          containerPort: 3000\n        livenessProbe:\n          failureThreshold: 10\n          initialDelaySeconds: 200\n          periodSeconds: 10\n          successThreshold: 1\n          tcpSocket:\n            port: http\n          timeoutSeconds: 1\n        readinessProbe:\n          failureThreshold: 3\n          initialDelaySeconds: 5\n          periodSeconds: 10\n          successThreshold: 1\n          tcpSocket:\n            port: http\n          timeoutSeconds: 1\n        resources: {}\n        securityContext: {}\n        volumeMounts:\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n      volumes:\n      - name: init\n        secret:\n          secretName: release-name-gitea-init\n          defaultMode: 110\n      - name: config\n        secret:\n          secretName: release-name-gitea\n          defaultMode: 110\n      - name: inline-config-sources\n        secret:\n          secretName: release-name-gitea-inline-config\n      - name: temp\n        emptyDir: {}\n      - name: data\n        persistentVolumeClaim:\n          claimName: gitea-shared-storage\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"gitea\" is not set to runAsNonRoot"
  },
  {
    "id": "422",
    "manifest_path": "data/manifests/artifacthub/gitea/gitea/027_deployment_release-name-gitea.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: release-name-gitea\n  namespace: default\n  annotations: null\n  labels:\n    helm.sh/chart: gitea-12.4.0\n    app: gitea\n    app.kubernetes.io/name: gitea\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/version: 1.24.6\n    version: 1.24.6\n    app.kubernetes.io/managed-by: Helm\nspec:\n  replicas: 1\n  strategy:\n    type: RollingUpdate\n    rollingUpdate:\n      maxUnavailable: 0\n      maxSurge: 100%\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: gitea\n      app.kubernetes.io/instance: release-name\n  template:\n    metadata:\n      annotations:\n        checksum/config: bb454c57a0d08076ac35d4f54b5de0cf4b6d442941fd825366a47173d035eb5b\n      labels:\n        helm.sh/chart: gitea-12.4.0\n        app: gitea\n        app.kubernetes.io/name: gitea\n        app.kubernetes.io/instance: release-name\n        app.kubernetes.io/version: 1.24.6\n        version: 1.24.6\n        app.kubernetes.io/managed-by: Helm\n    spec:\n      securityContext:\n        fsGroup: 1000\n      initContainers:\n      - name: init-directories\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        imagePullPolicy: IfNotPresent\n        command:\n        - /usr/sbinx/init_directory_structure.sh\n        env:\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        volumeMounts:\n        - name: init\n          mountPath: /usr/sbinx\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n        securityContext: {}\n        resources:\n          limits: {}\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      - name: init-app-ini\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        imagePullPolicy: IfNotPresent\n        command:\n        - /usr/sbinx/config_environment.sh\n        env:\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        - name: TMP_EXISTING_ENVS_FILE\n          value: /tmp/existing-envs\n        - name: ENV_TO_INI_MOUNT_POINT\n          value: /env-to-ini-mounts\n        volumeMounts:\n        - name: config\n          mountPath: /usr/sbinx\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n        - name: inline-config-sources\n          mountPath: /env-to-ini-mounts/inlines/\n        securityContext: {}\n        resources:\n          limits: {}\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      - name: configure-gitea\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        command:\n        - /usr/sbinx/configure_gitea.sh\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          runAsUser: 1000\n        env:\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        - name: HOME\n          value: /data/gitea/git\n        - name: GITEA_ADMIN_USERNAME\n          value: gitea_admin\n        - name: GITEA_ADMIN_PASSWORD\n          value: r8sA8CPHD9!bt6d\n        - name: GITEA_ADMIN_PASSWORD_MODE\n          value: keepUpdated\n        volumeMounts:\n        - name: init\n          mountPath: /usr/sbinx\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n        resources:\n          limits: {}\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      terminationGracePeriodSeconds: 60\n      containers:\n      - name: gitea\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        imagePullPolicy: IfNotPresent\n        env:\n        - name: SSH_LISTEN_PORT\n          value: '2222'\n        - name: SSH_PORT\n          value: '22'\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        - name: TMPDIR\n          value: /tmp/gitea\n        - name: HOME\n          value: /data/gitea/git\n        ports:\n        - name: ssh\n          containerPort: 2222\n        - name: http\n          containerPort: 3000\n        livenessProbe:\n          failureThreshold: 10\n          initialDelaySeconds: 200\n          periodSeconds: 10\n          successThreshold: 1\n          tcpSocket:\n            port: http\n          timeoutSeconds: 1\n        readinessProbe:\n          failureThreshold: 3\n          initialDelaySeconds: 5\n          periodSeconds: 10\n          successThreshold: 1\n          tcpSocket:\n            port: http\n          timeoutSeconds: 1\n        resources: {}\n        securityContext: {}\n        volumeMounts:\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n      volumes:\n      - name: init\n        secret:\n          secretName: release-name-gitea-init\n          defaultMode: 110\n      - name: config\n        secret:\n          secretName: release-name-gitea\n          defaultMode: 110\n      - name: inline-config-sources\n        secret:\n          secretName: release-name-gitea-inline-config\n      - name: temp\n        emptyDir: {}\n      - name: data\n        persistentVolumeClaim:\n          claimName: gitea-shared-storage\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"init-app-ini\" is not set to runAsNonRoot"
  },
  {
    "id": "423",
    "manifest_path": "data/manifests/artifacthub/gitea/gitea/027_deployment_release-name-gitea.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: release-name-gitea\n  namespace: default\n  annotations: null\n  labels:\n    helm.sh/chart: gitea-12.4.0\n    app: gitea\n    app.kubernetes.io/name: gitea\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/version: 1.24.6\n    version: 1.24.6\n    app.kubernetes.io/managed-by: Helm\nspec:\n  replicas: 1\n  strategy:\n    type: RollingUpdate\n    rollingUpdate:\n      maxUnavailable: 0\n      maxSurge: 100%\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: gitea\n      app.kubernetes.io/instance: release-name\n  template:\n    metadata:\n      annotations:\n        checksum/config: bb454c57a0d08076ac35d4f54b5de0cf4b6d442941fd825366a47173d035eb5b\n      labels:\n        helm.sh/chart: gitea-12.4.0\n        app: gitea\n        app.kubernetes.io/name: gitea\n        app.kubernetes.io/instance: release-name\n        app.kubernetes.io/version: 1.24.6\n        version: 1.24.6\n        app.kubernetes.io/managed-by: Helm\n    spec:\n      securityContext:\n        fsGroup: 1000\n      initContainers:\n      - name: init-directories\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        imagePullPolicy: IfNotPresent\n        command:\n        - /usr/sbinx/init_directory_structure.sh\n        env:\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        volumeMounts:\n        - name: init\n          mountPath: /usr/sbinx\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n        securityContext: {}\n        resources:\n          limits: {}\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      - name: init-app-ini\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        imagePullPolicy: IfNotPresent\n        command:\n        - /usr/sbinx/config_environment.sh\n        env:\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        - name: TMP_EXISTING_ENVS_FILE\n          value: /tmp/existing-envs\n        - name: ENV_TO_INI_MOUNT_POINT\n          value: /env-to-ini-mounts\n        volumeMounts:\n        - name: config\n          mountPath: /usr/sbinx\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n        - name: inline-config-sources\n          mountPath: /env-to-ini-mounts/inlines/\n        securityContext: {}\n        resources:\n          limits: {}\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      - name: configure-gitea\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        command:\n        - /usr/sbinx/configure_gitea.sh\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          runAsUser: 1000\n        env:\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        - name: HOME\n          value: /data/gitea/git\n        - name: GITEA_ADMIN_USERNAME\n          value: gitea_admin\n        - name: GITEA_ADMIN_PASSWORD\n          value: r8sA8CPHD9!bt6d\n        - name: GITEA_ADMIN_PASSWORD_MODE\n          value: keepUpdated\n        volumeMounts:\n        - name: init\n          mountPath: /usr/sbinx\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n        resources:\n          limits: {}\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      terminationGracePeriodSeconds: 60\n      containers:\n      - name: gitea\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        imagePullPolicy: IfNotPresent\n        env:\n        - name: SSH_LISTEN_PORT\n          value: '2222'\n        - name: SSH_PORT\n          value: '22'\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        - name: TMPDIR\n          value: /tmp/gitea\n        - name: HOME\n          value: /data/gitea/git\n        ports:\n        - name: ssh\n          containerPort: 2222\n        - name: http\n          containerPort: 3000\n        livenessProbe:\n          failureThreshold: 10\n          initialDelaySeconds: 200\n          periodSeconds: 10\n          successThreshold: 1\n          tcpSocket:\n            port: http\n          timeoutSeconds: 1\n        readinessProbe:\n          failureThreshold: 3\n          initialDelaySeconds: 5\n          periodSeconds: 10\n          successThreshold: 1\n          tcpSocket:\n            port: http\n          timeoutSeconds: 1\n        resources: {}\n        securityContext: {}\n        volumeMounts:\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n      volumes:\n      - name: init\n        secret:\n          secretName: release-name-gitea-init\n          defaultMode: 110\n      - name: config\n        secret:\n          secretName: release-name-gitea\n          defaultMode: 110\n      - name: inline-config-sources\n        secret:\n          secretName: release-name-gitea-inline-config\n      - name: temp\n        emptyDir: {}\n      - name: data\n        persistentVolumeClaim:\n          claimName: gitea-shared-storage\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"init-directories\" is not set to runAsNonRoot"
  },
  {
    "id": "424",
    "manifest_path": "data/manifests/artifacthub/gitea/gitea/027_deployment_release-name-gitea.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: release-name-gitea\n  namespace: default\n  annotations: null\n  labels:\n    helm.sh/chart: gitea-12.4.0\n    app: gitea\n    app.kubernetes.io/name: gitea\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/version: 1.24.6\n    version: 1.24.6\n    app.kubernetes.io/managed-by: Helm\nspec:\n  replicas: 1\n  strategy:\n    type: RollingUpdate\n    rollingUpdate:\n      maxUnavailable: 0\n      maxSurge: 100%\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: gitea\n      app.kubernetes.io/instance: release-name\n  template:\n    metadata:\n      annotations:\n        checksum/config: bb454c57a0d08076ac35d4f54b5de0cf4b6d442941fd825366a47173d035eb5b\n      labels:\n        helm.sh/chart: gitea-12.4.0\n        app: gitea\n        app.kubernetes.io/name: gitea\n        app.kubernetes.io/instance: release-name\n        app.kubernetes.io/version: 1.24.6\n        version: 1.24.6\n        app.kubernetes.io/managed-by: Helm\n    spec:\n      securityContext:\n        fsGroup: 1000\n      initContainers:\n      - name: init-directories\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        imagePullPolicy: IfNotPresent\n        command:\n        - /usr/sbinx/init_directory_structure.sh\n        env:\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        volumeMounts:\n        - name: init\n          mountPath: /usr/sbinx\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n        securityContext: {}\n        resources:\n          limits: {}\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      - name: init-app-ini\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        imagePullPolicy: IfNotPresent\n        command:\n        - /usr/sbinx/config_environment.sh\n        env:\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        - name: TMP_EXISTING_ENVS_FILE\n          value: /tmp/existing-envs\n        - name: ENV_TO_INI_MOUNT_POINT\n          value: /env-to-ini-mounts\n        volumeMounts:\n        - name: config\n          mountPath: /usr/sbinx\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n        - name: inline-config-sources\n          mountPath: /env-to-ini-mounts/inlines/\n        securityContext: {}\n        resources:\n          limits: {}\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      - name: configure-gitea\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        command:\n        - /usr/sbinx/configure_gitea.sh\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          runAsUser: 1000\n        env:\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        - name: HOME\n          value: /data/gitea/git\n        - name: GITEA_ADMIN_USERNAME\n          value: gitea_admin\n        - name: GITEA_ADMIN_PASSWORD\n          value: r8sA8CPHD9!bt6d\n        - name: GITEA_ADMIN_PASSWORD_MODE\n          value: keepUpdated\n        volumeMounts:\n        - name: init\n          mountPath: /usr/sbinx\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n        resources:\n          limits: {}\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      terminationGracePeriodSeconds: 60\n      containers:\n      - name: gitea\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        imagePullPolicy: IfNotPresent\n        env:\n        - name: SSH_LISTEN_PORT\n          value: '2222'\n        - name: SSH_PORT\n          value: '22'\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        - name: TMPDIR\n          value: /tmp/gitea\n        - name: HOME\n          value: /data/gitea/git\n        ports:\n        - name: ssh\n          containerPort: 2222\n        - name: http\n          containerPort: 3000\n        livenessProbe:\n          failureThreshold: 10\n          initialDelaySeconds: 200\n          periodSeconds: 10\n          successThreshold: 1\n          tcpSocket:\n            port: http\n          timeoutSeconds: 1\n        readinessProbe:\n          failureThreshold: 3\n          initialDelaySeconds: 5\n          periodSeconds: 10\n          successThreshold: 1\n          tcpSocket:\n            port: http\n          timeoutSeconds: 1\n        resources: {}\n        securityContext: {}\n        volumeMounts:\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n      volumes:\n      - name: init\n        secret:\n          secretName: release-name-gitea-init\n          defaultMode: 110\n      - name: config\n        secret:\n          secretName: release-name-gitea\n          defaultMode: 110\n      - name: inline-config-sources\n        secret:\n          secretName: release-name-gitea-inline-config\n      - name: temp\n        emptyDir: {}\n      - name: data\n        persistentVolumeClaim:\n          claimName: gitea-shared-storage\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"gitea\" has cpu request 0"
  },
  {
    "id": "425",
    "manifest_path": "data/manifests/artifacthub/gitea/gitea/027_deployment_release-name-gitea.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: release-name-gitea\n  namespace: default\n  annotations: null\n  labels:\n    helm.sh/chart: gitea-12.4.0\n    app: gitea\n    app.kubernetes.io/name: gitea\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/version: 1.24.6\n    version: 1.24.6\n    app.kubernetes.io/managed-by: Helm\nspec:\n  replicas: 1\n  strategy:\n    type: RollingUpdate\n    rollingUpdate:\n      maxUnavailable: 0\n      maxSurge: 100%\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: gitea\n      app.kubernetes.io/instance: release-name\n  template:\n    metadata:\n      annotations:\n        checksum/config: bb454c57a0d08076ac35d4f54b5de0cf4b6d442941fd825366a47173d035eb5b\n      labels:\n        helm.sh/chart: gitea-12.4.0\n        app: gitea\n        app.kubernetes.io/name: gitea\n        app.kubernetes.io/instance: release-name\n        app.kubernetes.io/version: 1.24.6\n        version: 1.24.6\n        app.kubernetes.io/managed-by: Helm\n    spec:\n      securityContext:\n        fsGroup: 1000\n      initContainers:\n      - name: init-directories\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        imagePullPolicy: IfNotPresent\n        command:\n        - /usr/sbinx/init_directory_structure.sh\n        env:\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        volumeMounts:\n        - name: init\n          mountPath: /usr/sbinx\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n        securityContext: {}\n        resources:\n          limits: {}\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      - name: init-app-ini\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        imagePullPolicy: IfNotPresent\n        command:\n        - /usr/sbinx/config_environment.sh\n        env:\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        - name: TMP_EXISTING_ENVS_FILE\n          value: /tmp/existing-envs\n        - name: ENV_TO_INI_MOUNT_POINT\n          value: /env-to-ini-mounts\n        volumeMounts:\n        - name: config\n          mountPath: /usr/sbinx\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n        - name: inline-config-sources\n          mountPath: /env-to-ini-mounts/inlines/\n        securityContext: {}\n        resources:\n          limits: {}\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      - name: configure-gitea\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        command:\n        - /usr/sbinx/configure_gitea.sh\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          runAsUser: 1000\n        env:\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        - name: HOME\n          value: /data/gitea/git\n        - name: GITEA_ADMIN_USERNAME\n          value: gitea_admin\n        - name: GITEA_ADMIN_PASSWORD\n          value: r8sA8CPHD9!bt6d\n        - name: GITEA_ADMIN_PASSWORD_MODE\n          value: keepUpdated\n        volumeMounts:\n        - name: init\n          mountPath: /usr/sbinx\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n        resources:\n          limits: {}\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      terminationGracePeriodSeconds: 60\n      containers:\n      - name: gitea\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        imagePullPolicy: IfNotPresent\n        env:\n        - name: SSH_LISTEN_PORT\n          value: '2222'\n        - name: SSH_PORT\n          value: '22'\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        - name: TMPDIR\n          value: /tmp/gitea\n        - name: HOME\n          value: /data/gitea/git\n        ports:\n        - name: ssh\n          containerPort: 2222\n        - name: http\n          containerPort: 3000\n        livenessProbe:\n          failureThreshold: 10\n          initialDelaySeconds: 200\n          periodSeconds: 10\n          successThreshold: 1\n          tcpSocket:\n            port: http\n          timeoutSeconds: 1\n        readinessProbe:\n          failureThreshold: 3\n          initialDelaySeconds: 5\n          periodSeconds: 10\n          successThreshold: 1\n          tcpSocket:\n            port: http\n          timeoutSeconds: 1\n        resources: {}\n        securityContext: {}\n        volumeMounts:\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n      volumes:\n      - name: init\n        secret:\n          secretName: release-name-gitea-init\n          defaultMode: 110\n      - name: config\n        secret:\n          secretName: release-name-gitea\n          defaultMode: 110\n      - name: inline-config-sources\n        secret:\n          secretName: release-name-gitea-inline-config\n      - name: temp\n        emptyDir: {}\n      - name: data\n        persistentVolumeClaim:\n          claimName: gitea-shared-storage\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"configure-gitea\" has memory limit 0"
  },
  {
    "id": "426",
    "manifest_path": "data/manifests/artifacthub/gitea/gitea/027_deployment_release-name-gitea.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: release-name-gitea\n  namespace: default\n  annotations: null\n  labels:\n    helm.sh/chart: gitea-12.4.0\n    app: gitea\n    app.kubernetes.io/name: gitea\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/version: 1.24.6\n    version: 1.24.6\n    app.kubernetes.io/managed-by: Helm\nspec:\n  replicas: 1\n  strategy:\n    type: RollingUpdate\n    rollingUpdate:\n      maxUnavailable: 0\n      maxSurge: 100%\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: gitea\n      app.kubernetes.io/instance: release-name\n  template:\n    metadata:\n      annotations:\n        checksum/config: bb454c57a0d08076ac35d4f54b5de0cf4b6d442941fd825366a47173d035eb5b\n      labels:\n        helm.sh/chart: gitea-12.4.0\n        app: gitea\n        app.kubernetes.io/name: gitea\n        app.kubernetes.io/instance: release-name\n        app.kubernetes.io/version: 1.24.6\n        version: 1.24.6\n        app.kubernetes.io/managed-by: Helm\n    spec:\n      securityContext:\n        fsGroup: 1000\n      initContainers:\n      - name: init-directories\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        imagePullPolicy: IfNotPresent\n        command:\n        - /usr/sbinx/init_directory_structure.sh\n        env:\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        volumeMounts:\n        - name: init\n          mountPath: /usr/sbinx\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n        securityContext: {}\n        resources:\n          limits: {}\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      - name: init-app-ini\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        imagePullPolicy: IfNotPresent\n        command:\n        - /usr/sbinx/config_environment.sh\n        env:\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        - name: TMP_EXISTING_ENVS_FILE\n          value: /tmp/existing-envs\n        - name: ENV_TO_INI_MOUNT_POINT\n          value: /env-to-ini-mounts\n        volumeMounts:\n        - name: config\n          mountPath: /usr/sbinx\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n        - name: inline-config-sources\n          mountPath: /env-to-ini-mounts/inlines/\n        securityContext: {}\n        resources:\n          limits: {}\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      - name: configure-gitea\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        command:\n        - /usr/sbinx/configure_gitea.sh\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          runAsUser: 1000\n        env:\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        - name: HOME\n          value: /data/gitea/git\n        - name: GITEA_ADMIN_USERNAME\n          value: gitea_admin\n        - name: GITEA_ADMIN_PASSWORD\n          value: r8sA8CPHD9!bt6d\n        - name: GITEA_ADMIN_PASSWORD_MODE\n          value: keepUpdated\n        volumeMounts:\n        - name: init\n          mountPath: /usr/sbinx\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n        resources:\n          limits: {}\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      terminationGracePeriodSeconds: 60\n      containers:\n      - name: gitea\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        imagePullPolicy: IfNotPresent\n        env:\n        - name: SSH_LISTEN_PORT\n          value: '2222'\n        - name: SSH_PORT\n          value: '22'\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        - name: TMPDIR\n          value: /tmp/gitea\n        - name: HOME\n          value: /data/gitea/git\n        ports:\n        - name: ssh\n          containerPort: 2222\n        - name: http\n          containerPort: 3000\n        livenessProbe:\n          failureThreshold: 10\n          initialDelaySeconds: 200\n          periodSeconds: 10\n          successThreshold: 1\n          tcpSocket:\n            port: http\n          timeoutSeconds: 1\n        readinessProbe:\n          failureThreshold: 3\n          initialDelaySeconds: 5\n          periodSeconds: 10\n          successThreshold: 1\n          tcpSocket:\n            port: http\n          timeoutSeconds: 1\n        resources: {}\n        securityContext: {}\n        volumeMounts:\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n      volumes:\n      - name: init\n        secret:\n          secretName: release-name-gitea-init\n          defaultMode: 110\n      - name: config\n        secret:\n          secretName: release-name-gitea\n          defaultMode: 110\n      - name: inline-config-sources\n        secret:\n          secretName: release-name-gitea-inline-config\n      - name: temp\n        emptyDir: {}\n      - name: data\n        persistentVolumeClaim:\n          claimName: gitea-shared-storage\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"gitea\" has memory limit 0"
  },
  {
    "id": "427",
    "manifest_path": "data/manifests/artifacthub/gitea/gitea/027_deployment_release-name-gitea.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: release-name-gitea\n  namespace: default\n  annotations: null\n  labels:\n    helm.sh/chart: gitea-12.4.0\n    app: gitea\n    app.kubernetes.io/name: gitea\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/version: 1.24.6\n    version: 1.24.6\n    app.kubernetes.io/managed-by: Helm\nspec:\n  replicas: 1\n  strategy:\n    type: RollingUpdate\n    rollingUpdate:\n      maxUnavailable: 0\n      maxSurge: 100%\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: gitea\n      app.kubernetes.io/instance: release-name\n  template:\n    metadata:\n      annotations:\n        checksum/config: bb454c57a0d08076ac35d4f54b5de0cf4b6d442941fd825366a47173d035eb5b\n      labels:\n        helm.sh/chart: gitea-12.4.0\n        app: gitea\n        app.kubernetes.io/name: gitea\n        app.kubernetes.io/instance: release-name\n        app.kubernetes.io/version: 1.24.6\n        version: 1.24.6\n        app.kubernetes.io/managed-by: Helm\n    spec:\n      securityContext:\n        fsGroup: 1000\n      initContainers:\n      - name: init-directories\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        imagePullPolicy: IfNotPresent\n        command:\n        - /usr/sbinx/init_directory_structure.sh\n        env:\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        volumeMounts:\n        - name: init\n          mountPath: /usr/sbinx\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n        securityContext: {}\n        resources:\n          limits: {}\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      - name: init-app-ini\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        imagePullPolicy: IfNotPresent\n        command:\n        - /usr/sbinx/config_environment.sh\n        env:\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        - name: TMP_EXISTING_ENVS_FILE\n          value: /tmp/existing-envs\n        - name: ENV_TO_INI_MOUNT_POINT\n          value: /env-to-ini-mounts\n        volumeMounts:\n        - name: config\n          mountPath: /usr/sbinx\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n        - name: inline-config-sources\n          mountPath: /env-to-ini-mounts/inlines/\n        securityContext: {}\n        resources:\n          limits: {}\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      - name: configure-gitea\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        command:\n        - /usr/sbinx/configure_gitea.sh\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          runAsUser: 1000\n        env:\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        - name: HOME\n          value: /data/gitea/git\n        - name: GITEA_ADMIN_USERNAME\n          value: gitea_admin\n        - name: GITEA_ADMIN_PASSWORD\n          value: r8sA8CPHD9!bt6d\n        - name: GITEA_ADMIN_PASSWORD_MODE\n          value: keepUpdated\n        volumeMounts:\n        - name: init\n          mountPath: /usr/sbinx\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n        resources:\n          limits: {}\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      terminationGracePeriodSeconds: 60\n      containers:\n      - name: gitea\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        imagePullPolicy: IfNotPresent\n        env:\n        - name: SSH_LISTEN_PORT\n          value: '2222'\n        - name: SSH_PORT\n          value: '22'\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        - name: TMPDIR\n          value: /tmp/gitea\n        - name: HOME\n          value: /data/gitea/git\n        ports:\n        - name: ssh\n          containerPort: 2222\n        - name: http\n          containerPort: 3000\n        livenessProbe:\n          failureThreshold: 10\n          initialDelaySeconds: 200\n          periodSeconds: 10\n          successThreshold: 1\n          tcpSocket:\n            port: http\n          timeoutSeconds: 1\n        readinessProbe:\n          failureThreshold: 3\n          initialDelaySeconds: 5\n          periodSeconds: 10\n          successThreshold: 1\n          tcpSocket:\n            port: http\n          timeoutSeconds: 1\n        resources: {}\n        securityContext: {}\n        volumeMounts:\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n      volumes:\n      - name: init\n        secret:\n          secretName: release-name-gitea-init\n          defaultMode: 110\n      - name: config\n        secret:\n          secretName: release-name-gitea\n          defaultMode: 110\n      - name: inline-config-sources\n        secret:\n          secretName: release-name-gitea-inline-config\n      - name: temp\n        emptyDir: {}\n      - name: data\n        persistentVolumeClaim:\n          claimName: gitea-shared-storage\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"init-app-ini\" has memory limit 0"
  },
  {
    "id": "428",
    "manifest_path": "data/manifests/artifacthub/gitea/gitea/027_deployment_release-name-gitea.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: release-name-gitea\n  namespace: default\n  annotations: null\n  labels:\n    helm.sh/chart: gitea-12.4.0\n    app: gitea\n    app.kubernetes.io/name: gitea\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/version: 1.24.6\n    version: 1.24.6\n    app.kubernetes.io/managed-by: Helm\nspec:\n  replicas: 1\n  strategy:\n    type: RollingUpdate\n    rollingUpdate:\n      maxUnavailable: 0\n      maxSurge: 100%\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: gitea\n      app.kubernetes.io/instance: release-name\n  template:\n    metadata:\n      annotations:\n        checksum/config: bb454c57a0d08076ac35d4f54b5de0cf4b6d442941fd825366a47173d035eb5b\n      labels:\n        helm.sh/chart: gitea-12.4.0\n        app: gitea\n        app.kubernetes.io/name: gitea\n        app.kubernetes.io/instance: release-name\n        app.kubernetes.io/version: 1.24.6\n        version: 1.24.6\n        app.kubernetes.io/managed-by: Helm\n    spec:\n      securityContext:\n        fsGroup: 1000\n      initContainers:\n      - name: init-directories\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        imagePullPolicy: IfNotPresent\n        command:\n        - /usr/sbinx/init_directory_structure.sh\n        env:\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        volumeMounts:\n        - name: init\n          mountPath: /usr/sbinx\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n        securityContext: {}\n        resources:\n          limits: {}\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      - name: init-app-ini\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        imagePullPolicy: IfNotPresent\n        command:\n        - /usr/sbinx/config_environment.sh\n        env:\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        - name: TMP_EXISTING_ENVS_FILE\n          value: /tmp/existing-envs\n        - name: ENV_TO_INI_MOUNT_POINT\n          value: /env-to-ini-mounts\n        volumeMounts:\n        - name: config\n          mountPath: /usr/sbinx\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n        - name: inline-config-sources\n          mountPath: /env-to-ini-mounts/inlines/\n        securityContext: {}\n        resources:\n          limits: {}\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      - name: configure-gitea\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        command:\n        - /usr/sbinx/configure_gitea.sh\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          runAsUser: 1000\n        env:\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        - name: HOME\n          value: /data/gitea/git\n        - name: GITEA_ADMIN_USERNAME\n          value: gitea_admin\n        - name: GITEA_ADMIN_PASSWORD\n          value: r8sA8CPHD9!bt6d\n        - name: GITEA_ADMIN_PASSWORD_MODE\n          value: keepUpdated\n        volumeMounts:\n        - name: init\n          mountPath: /usr/sbinx\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n        resources:\n          limits: {}\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      terminationGracePeriodSeconds: 60\n      containers:\n      - name: gitea\n        image: docker.gitea.com/gitea:1.24.6-rootless\n        imagePullPolicy: IfNotPresent\n        env:\n        - name: SSH_LISTEN_PORT\n          value: '2222'\n        - name: SSH_PORT\n          value: '22'\n        - name: GITEA_APP_INI\n          value: /data/gitea/conf/app.ini\n        - name: GITEA_CUSTOM\n          value: /data/gitea\n        - name: GITEA_WORK_DIR\n          value: /data\n        - name: GITEA_TEMP\n          value: /tmp/gitea\n        - name: TMPDIR\n          value: /tmp/gitea\n        - name: HOME\n          value: /data/gitea/git\n        ports:\n        - name: ssh\n          containerPort: 2222\n        - name: http\n          containerPort: 3000\n        livenessProbe:\n          failureThreshold: 10\n          initialDelaySeconds: 200\n          periodSeconds: 10\n          successThreshold: 1\n          tcpSocket:\n            port: http\n          timeoutSeconds: 1\n        readinessProbe:\n          failureThreshold: 3\n          initialDelaySeconds: 5\n          periodSeconds: 10\n          successThreshold: 1\n          tcpSocket:\n            port: http\n          timeoutSeconds: 1\n        resources: {}\n        securityContext: {}\n        volumeMounts:\n        - name: temp\n          mountPath: /tmp\n        - name: data\n          mountPath: /data\n      volumes:\n      - name: init\n        secret:\n          secretName: release-name-gitea-init\n          defaultMode: 110\n      - name: config\n        secret:\n          secretName: release-name-gitea\n          defaultMode: 110\n      - name: inline-config-sources\n        secret:\n          secretName: release-name-gitea-inline-config\n      - name: temp\n        emptyDir: {}\n      - name: data\n        persistentVolumeClaim:\n          claimName: gitea-shared-storage\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"init-directories\" has memory limit 0"
  },
  {
    "id": "429",
    "manifest_path": "data/manifests/artifacthub/gitea/gitea/028_statefulset_release-name-postgresql-ha-postgresql.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: release-name-postgresql-ha-postgresql\n  namespace: default\n  labels:\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/name: postgresql-ha\n    app.kubernetes.io/version: 17.6.0\n    helm.sh/chart: postgresql-ha-16.3.2\n    app.kubernetes.io/component: postgresql\n    role: data\nspec:\n  replicas: 3\n  podManagementPolicy: Parallel\n  serviceName: release-name-postgresql-ha-postgresql-headless\n  updateStrategy:\n    type: RollingUpdate\n  selector:\n    matchLabels:\n      app.kubernetes.io/instance: release-name\n      app.kubernetes.io/name: postgresql-ha\n      app.kubernetes.io/component: postgresql\n      role: data\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/instance: release-name\n        app.kubernetes.io/managed-by: Helm\n        app.kubernetes.io/name: postgresql-ha\n        app.kubernetes.io/version: 17.6.0\n        helm.sh/chart: postgresql-ha-16.3.2\n        app.kubernetes.io/component: postgresql\n        role: data\n      annotations: null\n    spec:\n      automountServiceAccountToken: false\n      affinity:\n        podAffinity: null\n        podAntiAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - podAffinityTerm:\n              labelSelector:\n                matchLabels:\n                  app.kubernetes.io/instance: release-name\n                  app.kubernetes.io/name: postgresql-ha\n                  app.kubernetes.io/component: postgresql\n              topologyKey: kubernetes.io/hostname\n            weight: 1\n        nodeAffinity: null\n      securityContext:\n        fsGroup: 1001\n        fsGroupChangePolicy: Always\n        supplementalGroups: []\n        sysctls: []\n      serviceAccountName: release-name-postgresql-ha\n      hostNetwork: false\n      hostIPC: false\n      containers:\n      - name: postgresql\n        image: docker.io/bitnamilegacy/postgresql-repmgr:17.6.0-debian-12-r2\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - ALL\n          privileged: false\n          readOnlyRootFilesystem: true\n          runAsGroup: 1001\n          runAsNonRoot: true\n          runAsUser: 1001\n          seLinuxOptions: {}\n          seccompProfile:\n            type: RuntimeDefault\n        lifecycle:\n          preStop:\n            exec:\n              command:\n              - /pre-stop.sh\n              - '25'\n        env:\n        - name: BITNAMI_DEBUG\n          value: 'false'\n        - name: POSTGRESQL_VOLUME_DIR\n          value: /bitnami/postgresql\n        - name: PGDATA\n          value: /bitnami/postgresql/data\n        - name: POSTGRES_POSTGRES_PASSWORD_FILE\n          value: /opt/bitnami/postgresql/secrets/postgres-password\n        - name: POSTGRES_USER\n          value: gitea\n        - name: POSTGRES_PASSWORD_FILE\n          value: /opt/bitnami/postgresql/secrets/password\n        - name: POSTGRES_DB\n          value: gitea\n        - name: POSTGRESQL_LOG_HOSTNAME\n          value: 'true'\n        - name: POSTGRESQL_LOG_CONNECTIONS\n          value: 'false'\n        - name: POSTGRESQL_LOG_DISCONNECTIONS\n          value: 'false'\n        - name: POSTGRESQL_PGAUDIT_LOG_CATALOG\n          value: 'off'\n        - name: POSTGRESQL_CLIENT_MIN_MESSAGES\n          value: error\n        - name: POSTGRESQL_SHARED_PRELOAD_LIBRARIES\n          value: pgaudit, repmgr\n        - name: POSTGRESQL_ENABLE_TLS\n          value: 'no'\n        - name: POSTGRESQL_PORT_NUMBER\n          value: '5432'\n        - name: REPMGR_PORT_NUMBER\n          value: '5432'\n        - name: REPMGR_PRIMARY_PORT\n          value: '5432'\n        - name: MY_POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: REPMGR_UPGRADE_EXTENSION\n          value: 'no'\n        - name: REPMGR_PGHBA_TRUST_ALL\n          value: 'no'\n        - name: REPMGR_MOUNTED_CONF_DIR\n          value: /bitnami/repmgr/conf\n        - name: REPMGR_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: REPMGR_PARTNER_NODES\n          value: release-name-postgresql-ha-postgresql-0.release-name-postgresql-ha-postgresql-headless.$(REPMGR_NAMESPACE).svc.cluster.local,release-name-postgresql-ha-postgresql-1.release-name-postgresql-ha-postgresql-headless.$(REPMGR_NAMESPACE).svc.cluster.local,release-name-postgresql-ha-postgresql-2.release-name-postgresql-ha-postgresql-headless.$(REPMGR_NAMESPACE).svc.cluster.local,\n        - name: REPMGR_PRIMARY_HOST\n          value: release-name-postgresql-ha-postgresql-0.release-name-postgresql-ha-postgresql-headless.$(REPMGR_NAMESPACE).svc.cluster.local\n        - name: REPMGR_NODE_NAME\n          value: $(MY_POD_NAME)\n        - name: REPMGR_NODE_NETWORK_NAME\n          value: $(MY_POD_NAME).release-name-postgresql-ha-postgresql-headless.$(REPMGR_NAMESPACE).svc.cluster.local\n        - name: REPMGR_NODE_TYPE\n          value: data\n        - name: REPMGR_LOG_LEVEL\n          value: NOTICE\n        - name: REPMGR_CONNECT_TIMEOUT\n          value: '5'\n        - name: REPMGR_RECONNECT_ATTEMPTS\n          value: '2'\n        - name: REPMGR_RECONNECT_INTERVAL\n          value: '3'\n        - name: REPMGR_USERNAME\n          value: repmgr\n        - name: REPMGR_PASSWORD_FILE\n          value: /opt/bitnami/postgresql/secrets/repmgr-password\n        - name: REPMGR_USE_PASSFILE\n          value: 'true'\n        - name: REPMGR_PASSFILE_PATH\n          value: /opt/bitnami/repmgr/conf/.pgpass\n        - name: REPMGR_DATABASE\n          value: repmgr\n        - name: REPMGR_FENCE_OLD_PRIMARY\n          value: 'no'\n        - name: REPMGR_CHILD_NODES_CHECK_INTERVAL\n          value: '5'\n        - name: REPMGR_CHILD_NODES_CONNECTED_MIN_COUNT\n          value: '1'\n        - name: REPMGR_CHILD_NODES_DISCONNECT_TIMEOUT\n          value: '30'\n        - name: POSTGRESQL_SR_CHECK\n          value: 'yes'\n        - name: POSTGRESQL_SR_CHECK_USERNAME\n          value: sr_check_user\n        - name: POSTGRESQL_SR_CHECK_DATABASE\n          value: postgres\n        - name: POSTGRESQL_SR_CHECK_PASSWORD_FILE\n          value: /opt/bitnami/postgresql/secrets/sr-check-password\n        envFrom: null\n        ports:\n        - name: postgresql\n          containerPort: 5432\n          protocol: TCP\n        livenessProbe:\n          failureThreshold: 6\n          initialDelaySeconds: 15\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 5\n          exec:\n            command:\n            - /liveness-probe.sh\n        readinessProbe:\n          failureThreshold: 6\n          initialDelaySeconds: 5\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 5\n          exec:\n            command:\n            - /readiness-probe.sh\n        resources:\n          limits:\n            cpu: 375m\n            ephemeral-storage: 2Gi\n            memory: 384Mi\n          requests:\n            cpu: 250m\n            ephemeral-storage: 50Mi\n            memory: 256Mi\n        volumeMounts:\n        - name: empty-dir\n          mountPath: /tmp\n          subPath: tmp-dir\n        - name: empty-dir\n          mountPath: /opt/bitnami/postgresql/conf\n          subPath: app-conf-dir\n        - name: empty-dir\n          mountPath: /opt/bitnami/postgresql/tmp\n          subPath: app-tmp-dir\n        - name: empty-dir\n          mountPath: /opt/bitnami/repmgr/conf\n          subPath: repmgr-conf-dir\n        - name: empty-dir\n          mountPath: /opt/bitnami/repmgr/tmp\n          subPath: repmgr-tmp-dir\n        - name: empty-dir\n          mountPath: /opt/bitnami/repmgr/logs\n          subPath: repmgr-logs-dir\n        - name: postgresql-creds\n          mountPath: /opt/bitnami/postgresql/secrets/postgres-password\n          subPath: postgres-password\n        - name: postgresql-creds\n          subPath: password\n          mountPath: /opt/bitnami/postgresql/secrets/password\n        - name: postgresql-creds\n          subPath: repmgr-password\n          mountPath: /opt/bitnami/postgresql/secrets/repmgr-password\n        - name: pgpool-creds\n          subPath: sr-check-password\n          mountPath: /opt/bitnami/postgresql/secrets/sr-check-password\n        - name: data\n          mountPath: /bitnami/postgresql\n        - name: scripts\n          mountPath: /pre-stop.sh\n          subPath: pre-stop.sh\n        - name: scripts\n          mountPath: /liveness-probe.sh\n          subPath: liveness-probe.sh\n        - name: scripts\n          mountPath: /readiness-probe.sh\n          subPath: readiness-probe.sh\n      volumes:\n      - name: empty-dir\n        emptyDir: {}\n      - name: scripts\n        configMap:\n          name: release-name-postgresql-ha-postgresql-scripts\n          defaultMode: 493\n      - name: postgresql-creds\n        secret:\n          secretName: release-name-postgresql-ha-postgresql\n      - name: pgpool-creds\n        secret:\n          secretName: release-name-postgresql-ha-pgpool\n  volumeClaimTemplates:\n  - apiVersion: v1\n    kind: PersistentVolumeClaim\n    metadata:\n      name: data\n    spec:\n      accessModes:\n      - ReadWriteOnce\n      resources:\n        requests:\n          storage: 10Gi\n",
    "policy_id": "non-existent-service-account",
    "violation_text": "serviceAccount \"release-name-postgresql-ha\" not found"
  },
  {
    "id": "430",
    "manifest_path": "data/manifests/artifacthub/gitea/gitea/029_statefulset_release-name-valkey-cluster.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: release-name-valkey-cluster\n  namespace: default\n  labels:\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/name: valkey-cluster\n    app.kubernetes.io/version: 8.1.3\n    helm.sh/chart: valkey-cluster-3.0.24\nspec:\n  updateStrategy:\n    rollingUpdate:\n      partition: 0\n    type: RollingUpdate\n  selector:\n    matchLabels:\n      app.kubernetes.io/instance: release-name\n      app.kubernetes.io/name: valkey-cluster\n  replicas: 3\n  serviceName: release-name-valkey-cluster-headless\n  podManagementPolicy: Parallel\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/instance: release-name\n        app.kubernetes.io/managed-by: Helm\n        app.kubernetes.io/name: valkey-cluster\n        app.kubernetes.io/version: 8.1.3\n        helm.sh/chart: valkey-cluster-3.0.24\n      annotations:\n        checksum/scripts: b416f9c23ba0f844168db1fda55802c08f6e6158998b5dc543fb3e2827aee988\n        checksum/secret: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855\n        checksum/config: d260a75cea2840d303318eeb5409b6f6f190e3e221ea66f3e98857402f575fa0\n    spec:\n      hostNetwork: false\n      enableServiceLinks: false\n      securityContext:\n        fsGroup: 1001\n        fsGroupChangePolicy: Always\n        supplementalGroups: []\n        sysctls: []\n      serviceAccountName: release-name-valkey-cluster\n      automountServiceAccountToken: false\n      affinity:\n        podAffinity: null\n        podAntiAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - podAffinityTerm:\n              labelSelector:\n                matchLabels:\n                  app.kubernetes.io/instance: release-name\n                  app.kubernetes.io/name: valkey-cluster\n              topologyKey: kubernetes.io/hostname\n            weight: 1\n        nodeAffinity: null\n      containers:\n      - name: release-name-valkey-cluster\n        image: docker.io/bitnamilegacy/valkey-cluster:8.1.3-debian-12-r3\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - ALL\n          privileged: false\n          readOnlyRootFilesystem: true\n          runAsGroup: 1001\n          runAsNonRoot: true\n          runAsUser: 1001\n          seLinuxOptions: {}\n          seccompProfile:\n            type: RuntimeDefault\n        command:\n        - /bin/bash\n        - -c\n        args:\n        - \"# Backwards compatibility change\\nif ! [[ -f /opt/bitnami/valkey/etc/valkey.conf\\\n          \\ ]]; then\\n    echo COPYING FILE\\n    cp  /opt/bitnami/valkey/etc/valkey-default.conf\\\n          \\ /opt/bitnami/valkey/etc/valkey.conf\\nfi\\npod_index=($(echo \\\"$POD_NAME\\\"\\\n          \\ | tr \\\"-\\\" \\\"\\\\n\\\"))\\npod_index=\\\"${pod_index[-1]}\\\"\\nif [[ \\\"$pod_index\\\"\\\n          \\ == \\\"0\\\" ]]; then\\n  export VALKEY_CLUSTER_CREATOR=\\\"yes\\\"\\n  export VALKEY_CLUSTER_REPLICAS=\\\"\\\n          0\\\"\\nfi\\n/opt/bitnami/scripts/valkey-cluster/entrypoint.sh /opt/bitnami/scripts/valkey-cluster/run.sh\\n\"\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: VALKEY_NODES\n          value: 'release-name-valkey-cluster-0.release-name-valkey-cluster-headless\n            release-name-valkey-cluster-1.release-name-valkey-cluster-headless release-name-valkey-cluster-2.release-name-valkey-cluster-headless '\n        - name: ALLOW_EMPTY_PASSWORD\n          value: 'yes'\n        - name: VALKEY_AOF_ENABLED\n          value: 'yes'\n        - name: VALKEY_TLS_ENABLED\n          value: 'no'\n        - name: VALKEY_PORT_NUMBER\n          value: '6379'\n        ports:\n        - name: tcp-redis\n          containerPort: 6379\n        - name: tcp-redis-bus\n          containerPort: 16379\n        livenessProbe:\n          initialDelaySeconds: 5\n          periodSeconds: 5\n          timeoutSeconds: 6\n          successThreshold: 1\n          failureThreshold: 5\n          exec:\n            command:\n            - sh\n            - -c\n            - /scripts/ping_liveness_local.sh 5\n        readinessProbe:\n          initialDelaySeconds: 5\n          periodSeconds: 5\n          timeoutSeconds: 2\n          successThreshold: 1\n          failureThreshold: 5\n          exec:\n            command:\n            - sh\n            - -c\n            - /scripts/ping_readiness_local.sh 1\n        resources:\n          limits:\n            cpu: 150m\n            ephemeral-storage: 2Gi\n            memory: 192Mi\n          requests:\n            cpu: 100m\n            ephemeral-storage: 50Mi\n            memory: 128Mi\n        volumeMounts:\n        - name: scripts\n          mountPath: /scripts\n        - name: valkey-data\n          mountPath: /bitnami/valkey/data\n          subPath: null\n        - name: default-config\n          mountPath: /opt/bitnami/valkey/etc/valkey-default.conf\n          subPath: valkey-default.conf\n        - name: empty-dir\n          mountPath: /opt/bitnami/valkey/etc/\n          subPath: app-conf-dir\n        - name: empty-dir\n          mountPath: /opt/bitnami/valkey/tmp\n          subPath: app-tmp-dir\n        - name: empty-dir\n          mountPath: /opt/bitnami/valkey/logs\n          subPath: app-logs-dir\n        - name: empty-dir\n          mountPath: /tmp\n          subPath: tmp-dir\n      volumes:\n      - name: scripts\n        configMap:\n          name: release-name-valkey-cluster-scripts\n          defaultMode: 493\n      - name: default-config\n        configMap:\n          name: release-name-valkey-cluster-default\n      - name: empty-dir\n        emptyDir: {}\n  volumeClaimTemplates:\n  - metadata:\n      name: valkey-data\n      labels:\n        app.kubernetes.io/instance: release-name\n        app.kubernetes.io/name: valkey-cluster\n    spec:\n      accessModes:\n      - ReadWriteOnce\n      resources:\n        requests:\n          storage: 8Gi\n",
    "policy_id": "non-existent-service-account",
    "violation_text": "serviceAccount \"release-name-valkey-cluster\" not found"
  },
  {
    "id": "431",
    "manifest_path": "data/manifests/artifacthub/gitea/gitea/030_pod_release-name-gitea-test-connection.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: release-name-gitea-test-connection\n  namespace: default\n  labels:\n    helm.sh/chart: gitea-12.4.0\n    app: gitea\n    app.kubernetes.io/name: gitea\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/version: 1.24.6\n    version: 1.24.6\n    app.kubernetes.io/managed-by: Helm\n  annotations:\n    helm.sh/hook: test-success\nspec:\n  containers:\n  - name: wget\n    image: busybox:latest\n    command:\n    - wget\n    args:\n    - release-name-gitea-http:3000\n  restartPolicy: Never\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"wget\" is using an invalid container image, \"busybox:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "432",
    "manifest_path": "data/manifests/artifacthub/gitea/gitea/030_pod_release-name-gitea-test-connection.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: release-name-gitea-test-connection\n  namespace: default\n  labels:\n    helm.sh/chart: gitea-12.4.0\n    app: gitea\n    app.kubernetes.io/name: gitea\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/version: 1.24.6\n    version: 1.24.6\n    app.kubernetes.io/managed-by: Helm\n  annotations:\n    helm.sh/hook: test-success\nspec:\n  containers:\n  - name: wget\n    image: busybox:latest\n    command:\n    - wget\n    args:\n    - release-name-gitea-http:3000\n  restartPolicy: Never\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"wget\" does not have a read-only root file system"
  },
  {
    "id": "433",
    "manifest_path": "data/manifests/artifacthub/gitea/gitea/030_pod_release-name-gitea-test-connection.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: release-name-gitea-test-connection\n  namespace: default\n  labels:\n    helm.sh/chart: gitea-12.4.0\n    app: gitea\n    app.kubernetes.io/name: gitea\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/version: 1.24.6\n    version: 1.24.6\n    app.kubernetes.io/managed-by: Helm\n  annotations:\n    helm.sh/hook: test-success\nspec:\n  containers:\n  - name: wget\n    image: busybox:latest\n    command:\n    - wget\n    args:\n    - release-name-gitea-http:3000\n  restartPolicy: Never\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"wget\" is not set to runAsNonRoot"
  },
  {
    "id": "434",
    "manifest_path": "data/manifests/artifacthub/gitea/gitea/030_pod_release-name-gitea-test-connection.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: release-name-gitea-test-connection\n  namespace: default\n  labels:\n    helm.sh/chart: gitea-12.4.0\n    app: gitea\n    app.kubernetes.io/name: gitea\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/version: 1.24.6\n    version: 1.24.6\n    app.kubernetes.io/managed-by: Helm\n  annotations:\n    helm.sh/hook: test-success\nspec:\n  containers:\n  - name: wget\n    image: busybox:latest\n    command:\n    - wget\n    args:\n    - release-name-gitea-http:3000\n  restartPolicy: Never\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"wget\" has cpu request 0"
  },
  {
    "id": "435",
    "manifest_path": "data/manifests/artifacthub/gitea/gitea/030_pod_release-name-gitea-test-connection.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: release-name-gitea-test-connection\n  namespace: default\n  labels:\n    helm.sh/chart: gitea-12.4.0\n    app: gitea\n    app.kubernetes.io/name: gitea\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/version: 1.24.6\n    version: 1.24.6\n    app.kubernetes.io/managed-by: Helm\n  annotations:\n    helm.sh/hook: test-success\nspec:\n  containers:\n  - name: wget\n    image: busybox:latest\n    command:\n    - wget\n    args:\n    - release-name-gitea-http:3000\n  restartPolicy: Never\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"wget\" has memory limit 0"
  },
  {
    "id": "436",
    "manifest_path": "data/manifests/artifacthub/gitlab/gitlab-runner/002_deployment_release-name-gitlab-runner.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: release-name-gitlab-runner\n  namespace: default\n  labels:\n    app: release-name-gitlab-runner\n    chart: gitlab-runner-0.81.0\n    release: release-name\n    heritage: Helm\nspec:\n  revisionHistoryLimit: 10\n  selector:\n    matchLabels:\n      app: release-name-gitlab-runner\n  template:\n    metadata:\n      labels:\n        app: release-name-gitlab-runner\n        chart: gitlab-runner-0.81.0\n        release: release-name\n        heritage: Helm\n      annotations:\n        checksum/configmap: b9a97367f708f909d06f31603187138f92ff2d5db59610719b91b9901db1e075\n    spec:\n      securityContext:\n        fsGroup: 65533\n        runAsUser: 100\n      terminationGracePeriodSeconds: 3600\n      serviceAccountName: ''\n      containers:\n      - name: release-name-gitlab-runner\n        image: registry.gitlab.com/gitlab-org/gitlab-runner:alpine-v18.4.0\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - ALL\n          privileged: false\n          readOnlyRootFilesystem: false\n          runAsNonRoot: true\n        lifecycle:\n          preStop:\n            exec:\n              command:\n              - /entrypoint\n              - unregister\n              - --all-runners\n        command:\n        - /usr/bin/dumb-init\n        - --\n        - /bin/bash\n        - /configmaps/entrypoint\n        env:\n        - name: CI_SERVER_URL\n          value: null\n        - name: RUNNER_EXECUTOR\n          value: kubernetes\n        - name: REGISTER_LOCKED\n          value: 'true'\n        - name: RUNNER_TAG_LIST\n          value: ''\n        - name: SESSION_SERVER_ADDRESS\n          value: null\n        livenessProbe:\n          exec:\n            command:\n            - /bin/bash\n            - /configmaps/check-live\n            - '3'\n          initialDelaySeconds: 60\n          timeoutSeconds: 4\n          periodSeconds: 60\n          successThreshold: 1\n          failureThreshold: 3\n        readinessProbe:\n          exec:\n            command:\n            - /usr/bin/pgrep\n            - gitlab.*runner\n          initialDelaySeconds: 60\n          timeoutSeconds: 4\n          periodSeconds: 60\n          successThreshold: 1\n          failureThreshold: 3\n        ports:\n        - name: metrics\n          containerPort: 9252\n        volumeMounts:\n        - name: etc-gitlab-runner\n          mountPath: /home/gitlab-runner/.gitlab-runner\n        - name: configmaps\n          mountPath: /configmaps\n        resources: {}\n      volumes:\n      - name: runner-secrets\n        emptyDir:\n          medium: Memory\n      - name: etc-gitlab-runner\n        emptyDir:\n          medium: Memory\n      - name: configmaps\n        configMap:\n          name: release-name-gitlab-runner\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"release-name-gitlab-runner\" does not have a read-only root file system"
  },
  {
    "id": "437",
    "manifest_path": "data/manifests/artifacthub/gitlab/gitlab-runner/002_deployment_release-name-gitlab-runner.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: release-name-gitlab-runner\n  namespace: default\n  labels:\n    app: release-name-gitlab-runner\n    chart: gitlab-runner-0.81.0\n    release: release-name\n    heritage: Helm\nspec:\n  revisionHistoryLimit: 10\n  selector:\n    matchLabels:\n      app: release-name-gitlab-runner\n  template:\n    metadata:\n      labels:\n        app: release-name-gitlab-runner\n        chart: gitlab-runner-0.81.0\n        release: release-name\n        heritage: Helm\n      annotations:\n        checksum/configmap: b9a97367f708f909d06f31603187138f92ff2d5db59610719b91b9901db1e075\n    spec:\n      securityContext:\n        fsGroup: 65533\n        runAsUser: 100\n      terminationGracePeriodSeconds: 3600\n      serviceAccountName: ''\n      containers:\n      - name: release-name-gitlab-runner\n        image: registry.gitlab.com/gitlab-org/gitlab-runner:alpine-v18.4.0\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - ALL\n          privileged: false\n          readOnlyRootFilesystem: false\n          runAsNonRoot: true\n        lifecycle:\n          preStop:\n            exec:\n              command:\n              - /entrypoint\n              - unregister\n              - --all-runners\n        command:\n        - /usr/bin/dumb-init\n        - --\n        - /bin/bash\n        - /configmaps/entrypoint\n        env:\n        - name: CI_SERVER_URL\n          value: null\n        - name: RUNNER_EXECUTOR\n          value: kubernetes\n        - name: REGISTER_LOCKED\n          value: 'true'\n        - name: RUNNER_TAG_LIST\n          value: ''\n        - name: SESSION_SERVER_ADDRESS\n          value: null\n        livenessProbe:\n          exec:\n            command:\n            - /bin/bash\n            - /configmaps/check-live\n            - '3'\n          initialDelaySeconds: 60\n          timeoutSeconds: 4\n          periodSeconds: 60\n          successThreshold: 1\n          failureThreshold: 3\n        readinessProbe:\n          exec:\n            command:\n            - /usr/bin/pgrep\n            - gitlab.*runner\n          initialDelaySeconds: 60\n          timeoutSeconds: 4\n          periodSeconds: 60\n          successThreshold: 1\n          failureThreshold: 3\n        ports:\n        - name: metrics\n          containerPort: 9252\n        volumeMounts:\n        - name: etc-gitlab-runner\n          mountPath: /home/gitlab-runner/.gitlab-runner\n        - name: configmaps\n          mountPath: /configmaps\n        resources: {}\n      volumes:\n      - name: runner-secrets\n        emptyDir:\n          medium: Memory\n      - name: etc-gitlab-runner\n        emptyDir:\n          medium: Memory\n      - name: configmaps\n        configMap:\n          name: release-name-gitlab-runner\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"release-name-gitlab-runner\" has cpu request 0"
  },
  {
    "id": "438",
    "manifest_path": "data/manifests/artifacthub/gitlab/gitlab-runner/002_deployment_release-name-gitlab-runner.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: release-name-gitlab-runner\n  namespace: default\n  labels:\n    app: release-name-gitlab-runner\n    chart: gitlab-runner-0.81.0\n    release: release-name\n    heritage: Helm\nspec:\n  revisionHistoryLimit: 10\n  selector:\n    matchLabels:\n      app: release-name-gitlab-runner\n  template:\n    metadata:\n      labels:\n        app: release-name-gitlab-runner\n        chart: gitlab-runner-0.81.0\n        release: release-name\n        heritage: Helm\n      annotations:\n        checksum/configmap: b9a97367f708f909d06f31603187138f92ff2d5db59610719b91b9901db1e075\n    spec:\n      securityContext:\n        fsGroup: 65533\n        runAsUser: 100\n      terminationGracePeriodSeconds: 3600\n      serviceAccountName: ''\n      containers:\n      - name: release-name-gitlab-runner\n        image: registry.gitlab.com/gitlab-org/gitlab-runner:alpine-v18.4.0\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - ALL\n          privileged: false\n          readOnlyRootFilesystem: false\n          runAsNonRoot: true\n        lifecycle:\n          preStop:\n            exec:\n              command:\n              - /entrypoint\n              - unregister\n              - --all-runners\n        command:\n        - /usr/bin/dumb-init\n        - --\n        - /bin/bash\n        - /configmaps/entrypoint\n        env:\n        - name: CI_SERVER_URL\n          value: null\n        - name: RUNNER_EXECUTOR\n          value: kubernetes\n        - name: REGISTER_LOCKED\n          value: 'true'\n        - name: RUNNER_TAG_LIST\n          value: ''\n        - name: SESSION_SERVER_ADDRESS\n          value: null\n        livenessProbe:\n          exec:\n            command:\n            - /bin/bash\n            - /configmaps/check-live\n            - '3'\n          initialDelaySeconds: 60\n          timeoutSeconds: 4\n          periodSeconds: 60\n          successThreshold: 1\n          failureThreshold: 3\n        readinessProbe:\n          exec:\n            command:\n            - /usr/bin/pgrep\n            - gitlab.*runner\n          initialDelaySeconds: 60\n          timeoutSeconds: 4\n          periodSeconds: 60\n          successThreshold: 1\n          failureThreshold: 3\n        ports:\n        - name: metrics\n          containerPort: 9252\n        volumeMounts:\n        - name: etc-gitlab-runner\n          mountPath: /home/gitlab-runner/.gitlab-runner\n        - name: configmaps\n          mountPath: /configmaps\n        resources: {}\n      volumes:\n      - name: runner-secrets\n        emptyDir:\n          medium: Memory\n      - name: etc-gitlab-runner\n        emptyDir:\n          medium: Memory\n      - name: configmaps\n        configMap:\n          name: release-name-gitlab-runner\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"release-name-gitlab-runner\" has memory limit 0"
  },
  {
    "id": "439",
    "manifest_path": "data/manifests/artifacthub/grafana/grafana/008_service_release-name-grafana.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Service\nmetadata:\n  name: release-name-grafana\n  namespace: default\n  labels:\n    helm.sh/chart: grafana-10.0.0\n    app.kubernetes.io/name: grafana\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/version: 12.1.1\nspec:\n  type: ClusterIP\n  ports:\n  - name: service\n    port: 80\n    protocol: TCP\n    targetPort: grafana\n  selector:\n    app.kubernetes.io/name: grafana\n    app.kubernetes.io/instance: release-name\n",
    "policy_id": "dangling-service",
    "violation_text": "no pods found matching service labels (map[app.kubernetes.io/instance:release-name app.kubernetes.io/name:grafana])"
  },
  {
    "id": "440",
    "manifest_path": "data/manifests/artifacthub/grafana/grafana/009_deployment_release-name-grafana.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: release-name-grafana\n  namespace: default\n  labels:\n    helm.sh/chart: grafana-10.0.0\n    app.kubernetes.io/name: grafana\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/version: 12.1.1\nspec:\n  replicas: 1\n  revisionHistoryLimit: 10\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: grafana\n      app.kubernetes.io/instance: release-name\n  strategy:\n    type: RollingUpdate\n  template:\n    metadata:\n      labels:\n        helm.sh/chart: grafana-10.0.0\n        app.kubernetes.io/name: grafana\n        app.kubernetes.io/instance: release-name\n        app.kubernetes.io/version: 12.1.1\n      annotations:\n        checksum/config: 0e9cbd0ea8e24e32f7dfca5bab17a2ba05652642f0a09a4882833ae88e4cc4a3\n        checksum/sc-dashboard-provider-config: e70bf6a851099d385178a76de9757bb0bef8299da6d8443602590e44f05fdf24\n        checksum/secret: 76dc78574fdf5e7dc5f7e5c5ba10f46944b189b4f96f822030e16cd4ac0d7f90\n        kubectl.kubernetes.io/default-container: grafana\n    spec:\n      serviceAccountName: release-name-grafana\n      automountServiceAccountToken: true\n      shareProcessNamespace: false\n      securityContext:\n        fsGroup: 472\n        runAsGroup: 472\n        runAsNonRoot: true\n        runAsUser: 472\n      enableServiceLinks: true\n      containers:\n      - name: grafana\n        image: docker.io/grafana/grafana:12.1.1\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - ALL\n          seccompProfile:\n            type: RuntimeDefault\n        volumeMounts:\n        - name: config\n          mountPath: /etc/grafana/grafana.ini\n          subPath: grafana.ini\n        - name: storage\n          mountPath: /var/lib/grafana\n        ports:\n        - name: grafana\n          containerPort: 3000\n          protocol: TCP\n        - name: gossip-tcp\n          containerPort: 9094\n          protocol: TCP\n        - name: gossip-udp\n          containerPort: 9094\n          protocol: UDP\n        - name: profiling\n          containerPort: 6060\n          protocol: TCP\n        env:\n        - name: POD_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: GF_SECURITY_ADMIN_USER\n          valueFrom:\n            secretKeyRef:\n              name: release-name-grafana\n              key: admin-user\n        - name: GF_SECURITY_ADMIN_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: release-name-grafana\n              key: admin-password\n        - name: GF_PATHS_DATA\n          value: /var/lib/grafana/\n        - name: GF_PATHS_LOGS\n          value: /var/log/grafana\n        - name: GF_PATHS_PLUGINS\n          value: /var/lib/grafana/plugins\n        - name: GF_PATHS_PROVISIONING\n          value: /etc/grafana/provisioning\n        livenessProbe:\n          failureThreshold: 10\n          httpGet:\n            path: /api/health\n            port: 3000\n          initialDelaySeconds: 60\n          timeoutSeconds: 30\n        readinessProbe:\n          httpGet:\n            path: /api/health\n            port: 3000\n      volumes:\n      - name: config\n        configMap:\n          name: release-name-grafana\n      - name: storage\n        emptyDir: {}\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"grafana\" does not have a read-only root file system"
  }
]