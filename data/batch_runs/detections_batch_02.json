[
  {
    "id": "011",
    "manifest_path": "data/manifests/002.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: privileged-pod\n  namespace: default\nspec:\n  containers:\n    - name: ubuntu\n      image: ubuntu:22.04\n      securityContext:\n        privileged: true\n      command: [\"sleep\", \"3600\"]\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"ubuntu\" has memory limit 0"
  },
  {
    "id": "012",
    "manifest_path": "data/manifests/003.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: security-risk\n  namespace: default\nspec:\n  containers:\n    - name: web\n      image: nginx:latest\n      ports:\n        - containerPort: 8080\n          hostPort: 30080\n      securityContext:\n        capabilities:\n          add:\n            - NET_RAW\n            - SYS_ADMIN\n  volumes:\n    - name: host-data\n      hostPath:\n        path: /var/lib/data\n",
    "policy_id": "drop-net-raw-capability",
    "violation_text": "container \"web\" has ADD capability: \"NET_RAW\", which matched with the forbidden capability for containers"
  },
  {
    "id": "013",
    "manifest_path": "data/manifests/003.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: security-risk\n  namespace: default\nspec:\n  containers:\n    - name: web\n      image: nginx:latest\n      ports:\n        - containerPort: 8080\n          hostPort: 30080\n      securityContext:\n        capabilities:\n          add:\n            - NET_RAW\n            - SYS_ADMIN\n  volumes:\n    - name: host-data\n      hostPath:\n        path: /var/lib/data\n",
    "policy_id": "drop-net-raw-capability",
    "violation_text": "container \"web\" has DROP capabilities: [], but does not drop capability \"NET_RAW\" which is required"
  },
  {
    "id": "014",
    "manifest_path": "data/manifests/003.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: security-risk\n  namespace: default\nspec:\n  containers:\n    - name: web\n      image: nginx:latest\n      ports:\n        - containerPort: 8080\n          hostPort: 30080\n      securityContext:\n        capabilities:\n          add:\n            - NET_RAW\n            - SYS_ADMIN\n  volumes:\n    - name: host-data\n      hostPath:\n        path: /var/lib/data\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"web\" is using an invalid container image, \"nginx:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "015",
    "manifest_path": "data/manifests/003.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: security-risk\n  namespace: default\nspec:\n  containers:\n    - name: web\n      image: nginx:latest\n      ports:\n        - containerPort: 8080\n          hostPort: 30080\n      securityContext:\n        capabilities:\n          add:\n            - NET_RAW\n            - SYS_ADMIN\n  volumes:\n    - name: host-data\n      hostPath:\n        path: /var/lib/data\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"web\" does not have a read-only root file system"
  },
  {
    "id": "016",
    "manifest_path": "data/manifests/003.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: security-risk\n  namespace: default\nspec:\n  containers:\n    - name: web\n      image: nginx:latest\n      ports:\n        - containerPort: 8080\n          hostPort: 30080\n      securityContext:\n        capabilities:\n          add:\n            - NET_RAW\n            - SYS_ADMIN\n  volumes:\n    - name: host-data\n      hostPath:\n        path: /var/lib/data\n",
    "policy_id": "privilege-escalation-container",
    "violation_text": "container \"web\" has SYS_ADMIN capability hence allows privilege escalation."
  },
  {
    "id": "017",
    "manifest_path": "data/manifests/003.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: security-risk\n  namespace: default\nspec:\n  containers:\n    - name: web\n      image: nginx:latest\n      ports:\n        - containerPort: 8080\n          hostPort: 30080\n      securityContext:\n        capabilities:\n          add:\n            - NET_RAW\n            - SYS_ADMIN\n  volumes:\n    - name: host-data\n      hostPath:\n        path: /var/lib/data\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"web\" is not set to runAsNonRoot"
  },
  {
    "id": "018",
    "manifest_path": "data/manifests/003.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: security-risk\n  namespace: default\nspec:\n  containers:\n    - name: web\n      image: nginx:latest\n      ports:\n        - containerPort: 8080\n          hostPort: 30080\n      securityContext:\n        capabilities:\n          add:\n            - NET_RAW\n            - SYS_ADMIN\n  volumes:\n    - name: host-data\n      hostPath:\n        path: /var/lib/data\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"web\" has cpu request 0"
  },
  {
    "id": "019",
    "manifest_path": "data/manifests/003.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: security-risk\n  namespace: default\nspec:\n  containers:\n    - name: web\n      image: nginx:latest\n      ports:\n        - containerPort: 8080\n          hostPort: 30080\n      securityContext:\n        capabilities:\n          add:\n            - NET_RAW\n            - SYS_ADMIN\n  volumes:\n    - name: host-data\n      hostPath:\n        path: /var/lib/data\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"web\" has memory limit 0"
  },
  {
    "id": "020",
    "manifest_path": "data/manifests/artifacthub/apache-airflow/airflow/020_service_release-name-postgresql-hl.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Service\nmetadata:\n  name: release-name-postgresql-hl\n  namespace: default\n  labels:\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/name: postgresql\n    app.kubernetes.io/version: 16.1.0\n    helm.sh/chart: postgresql-13.2.24\n    app.kubernetes.io/component: primary\n  annotations:\n    service.alpha.kubernetes.io/tolerate-unready-endpoints: 'true'\nspec:\n  type: ClusterIP\n  clusterIP: None\n  publishNotReadyAddresses: true\n  ports:\n  - name: tcp-postgresql\n    port: 5432\n    targetPort: tcp-postgresql\n  selector:\n    app.kubernetes.io/instance: release-name\n    app.kubernetes.io/name: postgresql\n    app.kubernetes.io/component: primary\n",
    "policy_id": "dangling-service",
    "violation_text": "no pods found matching service labels (map[app.kubernetes.io/component:primary app.kubernetes.io/instance:release-name app.kubernetes.io/name:postgresql])"
  }
]