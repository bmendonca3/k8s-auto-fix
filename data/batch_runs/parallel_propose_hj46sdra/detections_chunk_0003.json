[
  {
    "id": "991",
    "manifest_path": "data/manifests/the_stack_sample/sample_0070.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: redis-master\n  namespace: default\n  labels:\n    name: redis-master\nspec:\n  serviceName: redis-master\n  replicas: 1\n  selector:\n    matchLabels:\n      app: redis-master\n  template:\n    metadata:\n      labels:\n        app: redis-master\n        redis-master: 'true'\n      annotations:\n        sidecar.istio.io/inject: 'false'\n    spec:\n      terminationGracePeriodSeconds: 10\n      securityContext:\n        sysctls:\n        - name: net.ipv4.tcp_syncookies\n          value: '0'\n        - name: net.ipv4.ip_local_port_range\n          value: 1024 65535\n        - name: net.core.somaxconn\n          value: '65535'\n        - name: net.ipv4.ip_unprivileged_port_start\n          value: '0'\n        - name: net.ipv4.tcp_tw_reuse\n          value: '1'\n        - name: net.ipv4.tcp_fin_timeout\n          value: '30'\n        - name: net.ipv4.tcp_keepalive_intvl\n          value: '10'\n        - name: net.ipv4.tcp_keepalive_probes\n          value: '2'\n        - name: net.ipv4.tcp_keepalive_time\n          value: '120'\n        - name: net.ipv4.tcp_ecn\n          value: '1'\n        - name: net.ipv4.tcp_max_syn_backlog\n          value: '65536'\n        - name: net.ipv4.tcp_rfc1337\n          value: '1'\n        - name: net.ipv4.tcp_slow_start_after_idle\n          value: '0'\n        - name: net.ipv4.tcp_fack\n          value: '1'\n        - name: net.ipv4.tcp_max_tw_buckets\n          value: '262144'\n        - name: net.ipv4.tcp_fastopen\n          value: '3'\n        - name: net.ipv4.icmp_ratelimit\n          value: '100'\n        - name: net.ipv4.tcp_abort_on_overflow\n          value: '1'\n        - name: net.ipv4.tcp_adv_win_scale\n          value: '2'\n        - name: net.ipv4.tcp_retries2\n          value: '8'\n        - name: net.ipv4.tcp_syn_retries\n          value: '3'\n        - name: net.ipv4.tcp_synack_retries\n          value: '2'\n        - name: net.unix.max_dgram_qlen\n          value: '512'\n        - name: net.ipv4.tcp_fwmark_accept\n          value: '1'\n        - name: net.ipv4.fwmark_reflect\n          value: '1'\n      containers:\n      - name: redis\n        image: redis:6.0\n        imagePullPolicy: IfNotPresent\n        ports:\n        - containerPort: 6379\n        env:\n        - name: MASTER\n          value: 'true'\n        resources:\n          requests:\n            memory: 256Mi\n            cpu: 250m\n          limits:\n            memory: 2Gi\n            cpu: 2000m\n        volumeMounts:\n        - name: redis-master-volume\n          mountPath: /data\n  volumeClaimTemplates:\n  - metadata:\n      name: redis-master-volume\n    spec:\n      accessModes:\n      - ReadWriteOnce\n      resources:\n        requests:\n          storage: 10Gi\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"redis\" does not have a read-only root file system"
  },
  {
    "id": "992",
    "manifest_path": "data/manifests/the_stack_sample/sample_0070.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: redis-master\n  namespace: default\n  labels:\n    name: redis-master\nspec:\n  serviceName: redis-master\n  replicas: 1\n  selector:\n    matchLabels:\n      app: redis-master\n  template:\n    metadata:\n      labels:\n        app: redis-master\n        redis-master: 'true'\n      annotations:\n        sidecar.istio.io/inject: 'false'\n    spec:\n      terminationGracePeriodSeconds: 10\n      securityContext:\n        sysctls:\n        - name: net.ipv4.tcp_syncookies\n          value: '0'\n        - name: net.ipv4.ip_local_port_range\n          value: 1024 65535\n        - name: net.core.somaxconn\n          value: '65535'\n        - name: net.ipv4.ip_unprivileged_port_start\n          value: '0'\n        - name: net.ipv4.tcp_tw_reuse\n          value: '1'\n        - name: net.ipv4.tcp_fin_timeout\n          value: '30'\n        - name: net.ipv4.tcp_keepalive_intvl\n          value: '10'\n        - name: net.ipv4.tcp_keepalive_probes\n          value: '2'\n        - name: net.ipv4.tcp_keepalive_time\n          value: '120'\n        - name: net.ipv4.tcp_ecn\n          value: '1'\n        - name: net.ipv4.tcp_max_syn_backlog\n          value: '65536'\n        - name: net.ipv4.tcp_rfc1337\n          value: '1'\n        - name: net.ipv4.tcp_slow_start_after_idle\n          value: '0'\n        - name: net.ipv4.tcp_fack\n          value: '1'\n        - name: net.ipv4.tcp_max_tw_buckets\n          value: '262144'\n        - name: net.ipv4.tcp_fastopen\n          value: '3'\n        - name: net.ipv4.icmp_ratelimit\n          value: '100'\n        - name: net.ipv4.tcp_abort_on_overflow\n          value: '1'\n        - name: net.ipv4.tcp_adv_win_scale\n          value: '2'\n        - name: net.ipv4.tcp_retries2\n          value: '8'\n        - name: net.ipv4.tcp_syn_retries\n          value: '3'\n        - name: net.ipv4.tcp_synack_retries\n          value: '2'\n        - name: net.unix.max_dgram_qlen\n          value: '512'\n        - name: net.ipv4.tcp_fwmark_accept\n          value: '1'\n        - name: net.ipv4.fwmark_reflect\n          value: '1'\n      containers:\n      - name: redis\n        image: redis:6.0\n        imagePullPolicy: IfNotPresent\n        ports:\n        - containerPort: 6379\n        env:\n        - name: MASTER\n          value: 'true'\n        resources:\n          requests:\n            memory: 256Mi\n            cpu: 250m\n          limits:\n            memory: 2Gi\n            cpu: 2000m\n        volumeMounts:\n        - name: redis-master-volume\n          mountPath: /data\n  volumeClaimTemplates:\n  - metadata:\n      name: redis-master-volume\n    spec:\n      accessModes:\n      - ReadWriteOnce\n      resources:\n        requests:\n          storage: 10Gi\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"redis\" is not set to runAsNonRoot"
  },
  {
    "id": "993",
    "manifest_path": "data/manifests/the_stack_sample/sample_0070.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: redis-master\n  namespace: default\n  labels:\n    name: redis-master\nspec:\n  serviceName: redis-master\n  replicas: 1\n  selector:\n    matchLabels:\n      app: redis-master\n  template:\n    metadata:\n      labels:\n        app: redis-master\n        redis-master: 'true'\n      annotations:\n        sidecar.istio.io/inject: 'false'\n    spec:\n      terminationGracePeriodSeconds: 10\n      securityContext:\n        sysctls:\n        - name: net.ipv4.tcp_syncookies\n          value: '0'\n        - name: net.ipv4.ip_local_port_range\n          value: 1024 65535\n        - name: net.core.somaxconn\n          value: '65535'\n        - name: net.ipv4.ip_unprivileged_port_start\n          value: '0'\n        - name: net.ipv4.tcp_tw_reuse\n          value: '1'\n        - name: net.ipv4.tcp_fin_timeout\n          value: '30'\n        - name: net.ipv4.tcp_keepalive_intvl\n          value: '10'\n        - name: net.ipv4.tcp_keepalive_probes\n          value: '2'\n        - name: net.ipv4.tcp_keepalive_time\n          value: '120'\n        - name: net.ipv4.tcp_ecn\n          value: '1'\n        - name: net.ipv4.tcp_max_syn_backlog\n          value: '65536'\n        - name: net.ipv4.tcp_rfc1337\n          value: '1'\n        - name: net.ipv4.tcp_slow_start_after_idle\n          value: '0'\n        - name: net.ipv4.tcp_fack\n          value: '1'\n        - name: net.ipv4.tcp_max_tw_buckets\n          value: '262144'\n        - name: net.ipv4.tcp_fastopen\n          value: '3'\n        - name: net.ipv4.icmp_ratelimit\n          value: '100'\n        - name: net.ipv4.tcp_abort_on_overflow\n          value: '1'\n        - name: net.ipv4.tcp_adv_win_scale\n          value: '2'\n        - name: net.ipv4.tcp_retries2\n          value: '8'\n        - name: net.ipv4.tcp_syn_retries\n          value: '3'\n        - name: net.ipv4.tcp_synack_retries\n          value: '2'\n        - name: net.unix.max_dgram_qlen\n          value: '512'\n        - name: net.ipv4.tcp_fwmark_accept\n          value: '1'\n        - name: net.ipv4.fwmark_reflect\n          value: '1'\n      containers:\n      - name: redis\n        image: redis:6.0\n        imagePullPolicy: IfNotPresent\n        ports:\n        - containerPort: 6379\n        env:\n        - name: MASTER\n          value: 'true'\n        resources:\n          requests:\n            memory: 256Mi\n            cpu: 250m\n          limits:\n            memory: 2Gi\n            cpu: 2000m\n        volumeMounts:\n        - name: redis-master-volume\n          mountPath: /data\n  volumeClaimTemplates:\n  - metadata:\n      name: redis-master-volume\n    spec:\n      accessModes:\n      - ReadWriteOnce\n      resources:\n        requests:\n          storage: 10Gi\n",
    "policy_id": "unsafe-sysctls",
    "violation_text": "resource specifies unsafe sysctl \"net.core.somaxconn\"."
  },
  {
    "id": "994",
    "manifest_path": "data/manifests/the_stack_sample/sample_0070.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: redis-master\n  namespace: default\n  labels:\n    name: redis-master\nspec:\n  serviceName: redis-master\n  replicas: 1\n  selector:\n    matchLabels:\n      app: redis-master\n  template:\n    metadata:\n      labels:\n        app: redis-master\n        redis-master: 'true'\n      annotations:\n        sidecar.istio.io/inject: 'false'\n    spec:\n      terminationGracePeriodSeconds: 10\n      securityContext:\n        sysctls:\n        - name: net.ipv4.tcp_syncookies\n          value: '0'\n        - name: net.ipv4.ip_local_port_range\n          value: 1024 65535\n        - name: net.core.somaxconn\n          value: '65535'\n        - name: net.ipv4.ip_unprivileged_port_start\n          value: '0'\n        - name: net.ipv4.tcp_tw_reuse\n          value: '1'\n        - name: net.ipv4.tcp_fin_timeout\n          value: '30'\n        - name: net.ipv4.tcp_keepalive_intvl\n          value: '10'\n        - name: net.ipv4.tcp_keepalive_probes\n          value: '2'\n        - name: net.ipv4.tcp_keepalive_time\n          value: '120'\n        - name: net.ipv4.tcp_ecn\n          value: '1'\n        - name: net.ipv4.tcp_max_syn_backlog\n          value: '65536'\n        - name: net.ipv4.tcp_rfc1337\n          value: '1'\n        - name: net.ipv4.tcp_slow_start_after_idle\n          value: '0'\n        - name: net.ipv4.tcp_fack\n          value: '1'\n        - name: net.ipv4.tcp_max_tw_buckets\n          value: '262144'\n        - name: net.ipv4.tcp_fastopen\n          value: '3'\n        - name: net.ipv4.icmp_ratelimit\n          value: '100'\n        - name: net.ipv4.tcp_abort_on_overflow\n          value: '1'\n        - name: net.ipv4.tcp_adv_win_scale\n          value: '2'\n        - name: net.ipv4.tcp_retries2\n          value: '8'\n        - name: net.ipv4.tcp_syn_retries\n          value: '3'\n        - name: net.ipv4.tcp_synack_retries\n          value: '2'\n        - name: net.unix.max_dgram_qlen\n          value: '512'\n        - name: net.ipv4.tcp_fwmark_accept\n          value: '1'\n        - name: net.ipv4.fwmark_reflect\n          value: '1'\n      containers:\n      - name: redis\n        image: redis:6.0\n        imagePullPolicy: IfNotPresent\n        ports:\n        - containerPort: 6379\n        env:\n        - name: MASTER\n          value: 'true'\n        resources:\n          requests:\n            memory: 256Mi\n            cpu: 250m\n          limits:\n            memory: 2Gi\n            cpu: 2000m\n        volumeMounts:\n        - name: redis-master-volume\n          mountPath: /data\n  volumeClaimTemplates:\n  - metadata:\n      name: redis-master-volume\n    spec:\n      accessModes:\n      - ReadWriteOnce\n      resources:\n        requests:\n          storage: 10Gi\n",
    "policy_id": "unsafe-sysctls",
    "violation_text": "resource specifies unsafe sysctl \"net.ipv4.fwmark_reflect\"."
  },
  {
    "id": "995",
    "manifest_path": "data/manifests/the_stack_sample/sample_0070.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: redis-master\n  namespace: default\n  labels:\n    name: redis-master\nspec:\n  serviceName: redis-master\n  replicas: 1\n  selector:\n    matchLabels:\n      app: redis-master\n  template:\n    metadata:\n      labels:\n        app: redis-master\n        redis-master: 'true'\n      annotations:\n        sidecar.istio.io/inject: 'false'\n    spec:\n      terminationGracePeriodSeconds: 10\n      securityContext:\n        sysctls:\n        - name: net.ipv4.tcp_syncookies\n          value: '0'\n        - name: net.ipv4.ip_local_port_range\n          value: 1024 65535\n        - name: net.core.somaxconn\n          value: '65535'\n        - name: net.ipv4.ip_unprivileged_port_start\n          value: '0'\n        - name: net.ipv4.tcp_tw_reuse\n          value: '1'\n        - name: net.ipv4.tcp_fin_timeout\n          value: '30'\n        - name: net.ipv4.tcp_keepalive_intvl\n          value: '10'\n        - name: net.ipv4.tcp_keepalive_probes\n          value: '2'\n        - name: net.ipv4.tcp_keepalive_time\n          value: '120'\n        - name: net.ipv4.tcp_ecn\n          value: '1'\n        - name: net.ipv4.tcp_max_syn_backlog\n          value: '65536'\n        - name: net.ipv4.tcp_rfc1337\n          value: '1'\n        - name: net.ipv4.tcp_slow_start_after_idle\n          value: '0'\n        - name: net.ipv4.tcp_fack\n          value: '1'\n        - name: net.ipv4.tcp_max_tw_buckets\n          value: '262144'\n        - name: net.ipv4.tcp_fastopen\n          value: '3'\n        - name: net.ipv4.icmp_ratelimit\n          value: '100'\n        - name: net.ipv4.tcp_abort_on_overflow\n          value: '1'\n        - name: net.ipv4.tcp_adv_win_scale\n          value: '2'\n        - name: net.ipv4.tcp_retries2\n          value: '8'\n        - name: net.ipv4.tcp_syn_retries\n          value: '3'\n        - name: net.ipv4.tcp_synack_retries\n          value: '2'\n        - name: net.unix.max_dgram_qlen\n          value: '512'\n        - name: net.ipv4.tcp_fwmark_accept\n          value: '1'\n        - name: net.ipv4.fwmark_reflect\n          value: '1'\n      containers:\n      - name: redis\n        image: redis:6.0\n        imagePullPolicy: IfNotPresent\n        ports:\n        - containerPort: 6379\n        env:\n        - name: MASTER\n          value: 'true'\n        resources:\n          requests:\n            memory: 256Mi\n            cpu: 250m\n          limits:\n            memory: 2Gi\n            cpu: 2000m\n        volumeMounts:\n        - name: redis-master-volume\n          mountPath: /data\n  volumeClaimTemplates:\n  - metadata:\n      name: redis-master-volume\n    spec:\n      accessModes:\n      - ReadWriteOnce\n      resources:\n        requests:\n          storage: 10Gi\n",
    "policy_id": "unsafe-sysctls",
    "violation_text": "resource specifies unsafe sysctl \"net.ipv4.icmp_ratelimit\"."
  },
  {
    "id": "996",
    "manifest_path": "data/manifests/the_stack_sample/sample_0070.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: redis-master\n  namespace: default\n  labels:\n    name: redis-master\nspec:\n  serviceName: redis-master\n  replicas: 1\n  selector:\n    matchLabels:\n      app: redis-master\n  template:\n    metadata:\n      labels:\n        app: redis-master\n        redis-master: 'true'\n      annotations:\n        sidecar.istio.io/inject: 'false'\n    spec:\n      terminationGracePeriodSeconds: 10\n      securityContext:\n        sysctls:\n        - name: net.ipv4.tcp_syncookies\n          value: '0'\n        - name: net.ipv4.ip_local_port_range\n          value: 1024 65535\n        - name: net.core.somaxconn\n          value: '65535'\n        - name: net.ipv4.ip_unprivileged_port_start\n          value: '0'\n        - name: net.ipv4.tcp_tw_reuse\n          value: '1'\n        - name: net.ipv4.tcp_fin_timeout\n          value: '30'\n        - name: net.ipv4.tcp_keepalive_intvl\n          value: '10'\n        - name: net.ipv4.tcp_keepalive_probes\n          value: '2'\n        - name: net.ipv4.tcp_keepalive_time\n          value: '120'\n        - name: net.ipv4.tcp_ecn\n          value: '1'\n        - name: net.ipv4.tcp_max_syn_backlog\n          value: '65536'\n        - name: net.ipv4.tcp_rfc1337\n          value: '1'\n        - name: net.ipv4.tcp_slow_start_after_idle\n          value: '0'\n        - name: net.ipv4.tcp_fack\n          value: '1'\n        - name: net.ipv4.tcp_max_tw_buckets\n          value: '262144'\n        - name: net.ipv4.tcp_fastopen\n          value: '3'\n        - name: net.ipv4.icmp_ratelimit\n          value: '100'\n        - name: net.ipv4.tcp_abort_on_overflow\n          value: '1'\n        - name: net.ipv4.tcp_adv_win_scale\n          value: '2'\n        - name: net.ipv4.tcp_retries2\n          value: '8'\n        - name: net.ipv4.tcp_syn_retries\n          value: '3'\n        - name: net.ipv4.tcp_synack_retries\n          value: '2'\n        - name: net.unix.max_dgram_qlen\n          value: '512'\n        - name: net.ipv4.tcp_fwmark_accept\n          value: '1'\n        - name: net.ipv4.fwmark_reflect\n          value: '1'\n      containers:\n      - name: redis\n        image: redis:6.0\n        imagePullPolicy: IfNotPresent\n        ports:\n        - containerPort: 6379\n        env:\n        - name: MASTER\n          value: 'true'\n        resources:\n          requests:\n            memory: 256Mi\n            cpu: 250m\n          limits:\n            memory: 2Gi\n            cpu: 2000m\n        volumeMounts:\n        - name: redis-master-volume\n          mountPath: /data\n  volumeClaimTemplates:\n  - metadata:\n      name: redis-master-volume\n    spec:\n      accessModes:\n      - ReadWriteOnce\n      resources:\n        requests:\n          storage: 10Gi\n",
    "policy_id": "unsafe-sysctls",
    "violation_text": "resource specifies unsafe sysctl \"net.ipv4.ip_local_port_range\"."
  },
  {
    "id": "997",
    "manifest_path": "data/manifests/the_stack_sample/sample_0070.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: redis-master\n  namespace: default\n  labels:\n    name: redis-master\nspec:\n  serviceName: redis-master\n  replicas: 1\n  selector:\n    matchLabels:\n      app: redis-master\n  template:\n    metadata:\n      labels:\n        app: redis-master\n        redis-master: 'true'\n      annotations:\n        sidecar.istio.io/inject: 'false'\n    spec:\n      terminationGracePeriodSeconds: 10\n      securityContext:\n        sysctls:\n        - name: net.ipv4.tcp_syncookies\n          value: '0'\n        - name: net.ipv4.ip_local_port_range\n          value: 1024 65535\n        - name: net.core.somaxconn\n          value: '65535'\n        - name: net.ipv4.ip_unprivileged_port_start\n          value: '0'\n        - name: net.ipv4.tcp_tw_reuse\n          value: '1'\n        - name: net.ipv4.tcp_fin_timeout\n          value: '30'\n        - name: net.ipv4.tcp_keepalive_intvl\n          value: '10'\n        - name: net.ipv4.tcp_keepalive_probes\n          value: '2'\n        - name: net.ipv4.tcp_keepalive_time\n          value: '120'\n        - name: net.ipv4.tcp_ecn\n          value: '1'\n        - name: net.ipv4.tcp_max_syn_backlog\n          value: '65536'\n        - name: net.ipv4.tcp_rfc1337\n          value: '1'\n        - name: net.ipv4.tcp_slow_start_after_idle\n          value: '0'\n        - name: net.ipv4.tcp_fack\n          value: '1'\n        - name: net.ipv4.tcp_max_tw_buckets\n          value: '262144'\n        - name: net.ipv4.tcp_fastopen\n          value: '3'\n        - name: net.ipv4.icmp_ratelimit\n          value: '100'\n        - name: net.ipv4.tcp_abort_on_overflow\n          value: '1'\n        - name: net.ipv4.tcp_adv_win_scale\n          value: '2'\n        - name: net.ipv4.tcp_retries2\n          value: '8'\n        - name: net.ipv4.tcp_syn_retries\n          value: '3'\n        - name: net.ipv4.tcp_synack_retries\n          value: '2'\n        - name: net.unix.max_dgram_qlen\n          value: '512'\n        - name: net.ipv4.tcp_fwmark_accept\n          value: '1'\n        - name: net.ipv4.fwmark_reflect\n          value: '1'\n      containers:\n      - name: redis\n        image: redis:6.0\n        imagePullPolicy: IfNotPresent\n        ports:\n        - containerPort: 6379\n        env:\n        - name: MASTER\n          value: 'true'\n        resources:\n          requests:\n            memory: 256Mi\n            cpu: 250m\n          limits:\n            memory: 2Gi\n            cpu: 2000m\n        volumeMounts:\n        - name: redis-master-volume\n          mountPath: /data\n  volumeClaimTemplates:\n  - metadata:\n      name: redis-master-volume\n    spec:\n      accessModes:\n      - ReadWriteOnce\n      resources:\n        requests:\n          storage: 10Gi\n",
    "policy_id": "unsafe-sysctls",
    "violation_text": "resource specifies unsafe sysctl \"net.ipv4.ip_unprivileged_port_start\"."
  },
  {
    "id": "998",
    "manifest_path": "data/manifests/the_stack_sample/sample_0070.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: redis-master\n  namespace: default\n  labels:\n    name: redis-master\nspec:\n  serviceName: redis-master\n  replicas: 1\n  selector:\n    matchLabels:\n      app: redis-master\n  template:\n    metadata:\n      labels:\n        app: redis-master\n        redis-master: 'true'\n      annotations:\n        sidecar.istio.io/inject: 'false'\n    spec:\n      terminationGracePeriodSeconds: 10\n      securityContext:\n        sysctls:\n        - name: net.ipv4.tcp_syncookies\n          value: '0'\n        - name: net.ipv4.ip_local_port_range\n          value: 1024 65535\n        - name: net.core.somaxconn\n          value: '65535'\n        - name: net.ipv4.ip_unprivileged_port_start\n          value: '0'\n        - name: net.ipv4.tcp_tw_reuse\n          value: '1'\n        - name: net.ipv4.tcp_fin_timeout\n          value: '30'\n        - name: net.ipv4.tcp_keepalive_intvl\n          value: '10'\n        - name: net.ipv4.tcp_keepalive_probes\n          value: '2'\n        - name: net.ipv4.tcp_keepalive_time\n          value: '120'\n        - name: net.ipv4.tcp_ecn\n          value: '1'\n        - name: net.ipv4.tcp_max_syn_backlog\n          value: '65536'\n        - name: net.ipv4.tcp_rfc1337\n          value: '1'\n        - name: net.ipv4.tcp_slow_start_after_idle\n          value: '0'\n        - name: net.ipv4.tcp_fack\n          value: '1'\n        - name: net.ipv4.tcp_max_tw_buckets\n          value: '262144'\n        - name: net.ipv4.tcp_fastopen\n          value: '3'\n        - name: net.ipv4.icmp_ratelimit\n          value: '100'\n        - name: net.ipv4.tcp_abort_on_overflow\n          value: '1'\n        - name: net.ipv4.tcp_adv_win_scale\n          value: '2'\n        - name: net.ipv4.tcp_retries2\n          value: '8'\n        - name: net.ipv4.tcp_syn_retries\n          value: '3'\n        - name: net.ipv4.tcp_synack_retries\n          value: '2'\n        - name: net.unix.max_dgram_qlen\n          value: '512'\n        - name: net.ipv4.tcp_fwmark_accept\n          value: '1'\n        - name: net.ipv4.fwmark_reflect\n          value: '1'\n      containers:\n      - name: redis\n        image: redis:6.0\n        imagePullPolicy: IfNotPresent\n        ports:\n        - containerPort: 6379\n        env:\n        - name: MASTER\n          value: 'true'\n        resources:\n          requests:\n            memory: 256Mi\n            cpu: 250m\n          limits:\n            memory: 2Gi\n            cpu: 2000m\n        volumeMounts:\n        - name: redis-master-volume\n          mountPath: /data\n  volumeClaimTemplates:\n  - metadata:\n      name: redis-master-volume\n    spec:\n      accessModes:\n      - ReadWriteOnce\n      resources:\n        requests:\n          storage: 10Gi\n",
    "policy_id": "unsafe-sysctls",
    "violation_text": "resource specifies unsafe sysctl \"net.ipv4.tcp_abort_on_overflow\"."
  },
  {
    "id": "999",
    "manifest_path": "data/manifests/the_stack_sample/sample_0070.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: redis-master\n  namespace: default\n  labels:\n    name: redis-master\nspec:\n  serviceName: redis-master\n  replicas: 1\n  selector:\n    matchLabels:\n      app: redis-master\n  template:\n    metadata:\n      labels:\n        app: redis-master\n        redis-master: 'true'\n      annotations:\n        sidecar.istio.io/inject: 'false'\n    spec:\n      terminationGracePeriodSeconds: 10\n      securityContext:\n        sysctls:\n        - name: net.ipv4.tcp_syncookies\n          value: '0'\n        - name: net.ipv4.ip_local_port_range\n          value: 1024 65535\n        - name: net.core.somaxconn\n          value: '65535'\n        - name: net.ipv4.ip_unprivileged_port_start\n          value: '0'\n        - name: net.ipv4.tcp_tw_reuse\n          value: '1'\n        - name: net.ipv4.tcp_fin_timeout\n          value: '30'\n        - name: net.ipv4.tcp_keepalive_intvl\n          value: '10'\n        - name: net.ipv4.tcp_keepalive_probes\n          value: '2'\n        - name: net.ipv4.tcp_keepalive_time\n          value: '120'\n        - name: net.ipv4.tcp_ecn\n          value: '1'\n        - name: net.ipv4.tcp_max_syn_backlog\n          value: '65536'\n        - name: net.ipv4.tcp_rfc1337\n          value: '1'\n        - name: net.ipv4.tcp_slow_start_after_idle\n          value: '0'\n        - name: net.ipv4.tcp_fack\n          value: '1'\n        - name: net.ipv4.tcp_max_tw_buckets\n          value: '262144'\n        - name: net.ipv4.tcp_fastopen\n          value: '3'\n        - name: net.ipv4.icmp_ratelimit\n          value: '100'\n        - name: net.ipv4.tcp_abort_on_overflow\n          value: '1'\n        - name: net.ipv4.tcp_adv_win_scale\n          value: '2'\n        - name: net.ipv4.tcp_retries2\n          value: '8'\n        - name: net.ipv4.tcp_syn_retries\n          value: '3'\n        - name: net.ipv4.tcp_synack_retries\n          value: '2'\n        - name: net.unix.max_dgram_qlen\n          value: '512'\n        - name: net.ipv4.tcp_fwmark_accept\n          value: '1'\n        - name: net.ipv4.fwmark_reflect\n          value: '1'\n      containers:\n      - name: redis\n        image: redis:6.0\n        imagePullPolicy: IfNotPresent\n        ports:\n        - containerPort: 6379\n        env:\n        - name: MASTER\n          value: 'true'\n        resources:\n          requests:\n            memory: 256Mi\n            cpu: 250m\n          limits:\n            memory: 2Gi\n            cpu: 2000m\n        volumeMounts:\n        - name: redis-master-volume\n          mountPath: /data\n  volumeClaimTemplates:\n  - metadata:\n      name: redis-master-volume\n    spec:\n      accessModes:\n      - ReadWriteOnce\n      resources:\n        requests:\n          storage: 10Gi\n",
    "policy_id": "unsafe-sysctls",
    "violation_text": "resource specifies unsafe sysctl \"net.ipv4.tcp_adv_win_scale\"."
  },
  {
    "id": "1000",
    "manifest_path": "data/manifests/the_stack_sample/sample_0070.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: redis-master\n  namespace: default\n  labels:\n    name: redis-master\nspec:\n  serviceName: redis-master\n  replicas: 1\n  selector:\n    matchLabels:\n      app: redis-master\n  template:\n    metadata:\n      labels:\n        app: redis-master\n        redis-master: 'true'\n      annotations:\n        sidecar.istio.io/inject: 'false'\n    spec:\n      terminationGracePeriodSeconds: 10\n      securityContext:\n        sysctls:\n        - name: net.ipv4.tcp_syncookies\n          value: '0'\n        - name: net.ipv4.ip_local_port_range\n          value: 1024 65535\n        - name: net.core.somaxconn\n          value: '65535'\n        - name: net.ipv4.ip_unprivileged_port_start\n          value: '0'\n        - name: net.ipv4.tcp_tw_reuse\n          value: '1'\n        - name: net.ipv4.tcp_fin_timeout\n          value: '30'\n        - name: net.ipv4.tcp_keepalive_intvl\n          value: '10'\n        - name: net.ipv4.tcp_keepalive_probes\n          value: '2'\n        - name: net.ipv4.tcp_keepalive_time\n          value: '120'\n        - name: net.ipv4.tcp_ecn\n          value: '1'\n        - name: net.ipv4.tcp_max_syn_backlog\n          value: '65536'\n        - name: net.ipv4.tcp_rfc1337\n          value: '1'\n        - name: net.ipv4.tcp_slow_start_after_idle\n          value: '0'\n        - name: net.ipv4.tcp_fack\n          value: '1'\n        - name: net.ipv4.tcp_max_tw_buckets\n          value: '262144'\n        - name: net.ipv4.tcp_fastopen\n          value: '3'\n        - name: net.ipv4.icmp_ratelimit\n          value: '100'\n        - name: net.ipv4.tcp_abort_on_overflow\n          value: '1'\n        - name: net.ipv4.tcp_adv_win_scale\n          value: '2'\n        - name: net.ipv4.tcp_retries2\n          value: '8'\n        - name: net.ipv4.tcp_syn_retries\n          value: '3'\n        - name: net.ipv4.tcp_synack_retries\n          value: '2'\n        - name: net.unix.max_dgram_qlen\n          value: '512'\n        - name: net.ipv4.tcp_fwmark_accept\n          value: '1'\n        - name: net.ipv4.fwmark_reflect\n          value: '1'\n      containers:\n      - name: redis\n        image: redis:6.0\n        imagePullPolicy: IfNotPresent\n        ports:\n        - containerPort: 6379\n        env:\n        - name: MASTER\n          value: 'true'\n        resources:\n          requests:\n            memory: 256Mi\n            cpu: 250m\n          limits:\n            memory: 2Gi\n            cpu: 2000m\n        volumeMounts:\n        - name: redis-master-volume\n          mountPath: /data\n  volumeClaimTemplates:\n  - metadata:\n      name: redis-master-volume\n    spec:\n      accessModes:\n      - ReadWriteOnce\n      resources:\n        requests:\n          storage: 10Gi\n",
    "policy_id": "unsafe-sysctls",
    "violation_text": "resource specifies unsafe sysctl \"net.ipv4.tcp_ecn\"."
  },
  {
    "id": "1001",
    "manifest_path": "data/manifests/the_stack_sample/sample_0070.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: redis-master\n  namespace: default\n  labels:\n    name: redis-master\nspec:\n  serviceName: redis-master\n  replicas: 1\n  selector:\n    matchLabels:\n      app: redis-master\n  template:\n    metadata:\n      labels:\n        app: redis-master\n        redis-master: 'true'\n      annotations:\n        sidecar.istio.io/inject: 'false'\n    spec:\n      terminationGracePeriodSeconds: 10\n      securityContext:\n        sysctls:\n        - name: net.ipv4.tcp_syncookies\n          value: '0'\n        - name: net.ipv4.ip_local_port_range\n          value: 1024 65535\n        - name: net.core.somaxconn\n          value: '65535'\n        - name: net.ipv4.ip_unprivileged_port_start\n          value: '0'\n        - name: net.ipv4.tcp_tw_reuse\n          value: '1'\n        - name: net.ipv4.tcp_fin_timeout\n          value: '30'\n        - name: net.ipv4.tcp_keepalive_intvl\n          value: '10'\n        - name: net.ipv4.tcp_keepalive_probes\n          value: '2'\n        - name: net.ipv4.tcp_keepalive_time\n          value: '120'\n        - name: net.ipv4.tcp_ecn\n          value: '1'\n        - name: net.ipv4.tcp_max_syn_backlog\n          value: '65536'\n        - name: net.ipv4.tcp_rfc1337\n          value: '1'\n        - name: net.ipv4.tcp_slow_start_after_idle\n          value: '0'\n        - name: net.ipv4.tcp_fack\n          value: '1'\n        - name: net.ipv4.tcp_max_tw_buckets\n          value: '262144'\n        - name: net.ipv4.tcp_fastopen\n          value: '3'\n        - name: net.ipv4.icmp_ratelimit\n          value: '100'\n        - name: net.ipv4.tcp_abort_on_overflow\n          value: '1'\n        - name: net.ipv4.tcp_adv_win_scale\n          value: '2'\n        - name: net.ipv4.tcp_retries2\n          value: '8'\n        - name: net.ipv4.tcp_syn_retries\n          value: '3'\n        - name: net.ipv4.tcp_synack_retries\n          value: '2'\n        - name: net.unix.max_dgram_qlen\n          value: '512'\n        - name: net.ipv4.tcp_fwmark_accept\n          value: '1'\n        - name: net.ipv4.fwmark_reflect\n          value: '1'\n      containers:\n      - name: redis\n        image: redis:6.0\n        imagePullPolicy: IfNotPresent\n        ports:\n        - containerPort: 6379\n        env:\n        - name: MASTER\n          value: 'true'\n        resources:\n          requests:\n            memory: 256Mi\n            cpu: 250m\n          limits:\n            memory: 2Gi\n            cpu: 2000m\n        volumeMounts:\n        - name: redis-master-volume\n          mountPath: /data\n  volumeClaimTemplates:\n  - metadata:\n      name: redis-master-volume\n    spec:\n      accessModes:\n      - ReadWriteOnce\n      resources:\n        requests:\n          storage: 10Gi\n",
    "policy_id": "unsafe-sysctls",
    "violation_text": "resource specifies unsafe sysctl \"net.ipv4.tcp_fack\"."
  },
  {
    "id": "1002",
    "manifest_path": "data/manifests/the_stack_sample/sample_0070.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: redis-master\n  namespace: default\n  labels:\n    name: redis-master\nspec:\n  serviceName: redis-master\n  replicas: 1\n  selector:\n    matchLabels:\n      app: redis-master\n  template:\n    metadata:\n      labels:\n        app: redis-master\n        redis-master: 'true'\n      annotations:\n        sidecar.istio.io/inject: 'false'\n    spec:\n      terminationGracePeriodSeconds: 10\n      securityContext:\n        sysctls:\n        - name: net.ipv4.tcp_syncookies\n          value: '0'\n        - name: net.ipv4.ip_local_port_range\n          value: 1024 65535\n        - name: net.core.somaxconn\n          value: '65535'\n        - name: net.ipv4.ip_unprivileged_port_start\n          value: '0'\n        - name: net.ipv4.tcp_tw_reuse\n          value: '1'\n        - name: net.ipv4.tcp_fin_timeout\n          value: '30'\n        - name: net.ipv4.tcp_keepalive_intvl\n          value: '10'\n        - name: net.ipv4.tcp_keepalive_probes\n          value: '2'\n        - name: net.ipv4.tcp_keepalive_time\n          value: '120'\n        - name: net.ipv4.tcp_ecn\n          value: '1'\n        - name: net.ipv4.tcp_max_syn_backlog\n          value: '65536'\n        - name: net.ipv4.tcp_rfc1337\n          value: '1'\n        - name: net.ipv4.tcp_slow_start_after_idle\n          value: '0'\n        - name: net.ipv4.tcp_fack\n          value: '1'\n        - name: net.ipv4.tcp_max_tw_buckets\n          value: '262144'\n        - name: net.ipv4.tcp_fastopen\n          value: '3'\n        - name: net.ipv4.icmp_ratelimit\n          value: '100'\n        - name: net.ipv4.tcp_abort_on_overflow\n          value: '1'\n        - name: net.ipv4.tcp_adv_win_scale\n          value: '2'\n        - name: net.ipv4.tcp_retries2\n          value: '8'\n        - name: net.ipv4.tcp_syn_retries\n          value: '3'\n        - name: net.ipv4.tcp_synack_retries\n          value: '2'\n        - name: net.unix.max_dgram_qlen\n          value: '512'\n        - name: net.ipv4.tcp_fwmark_accept\n          value: '1'\n        - name: net.ipv4.fwmark_reflect\n          value: '1'\n      containers:\n      - name: redis\n        image: redis:6.0\n        imagePullPolicy: IfNotPresent\n        ports:\n        - containerPort: 6379\n        env:\n        - name: MASTER\n          value: 'true'\n        resources:\n          requests:\n            memory: 256Mi\n            cpu: 250m\n          limits:\n            memory: 2Gi\n            cpu: 2000m\n        volumeMounts:\n        - name: redis-master-volume\n          mountPath: /data\n  volumeClaimTemplates:\n  - metadata:\n      name: redis-master-volume\n    spec:\n      accessModes:\n      - ReadWriteOnce\n      resources:\n        requests:\n          storage: 10Gi\n",
    "policy_id": "unsafe-sysctls",
    "violation_text": "resource specifies unsafe sysctl \"net.ipv4.tcp_fastopen\"."
  },
  {
    "id": "1003",
    "manifest_path": "data/manifests/the_stack_sample/sample_0070.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: redis-master\n  namespace: default\n  labels:\n    name: redis-master\nspec:\n  serviceName: redis-master\n  replicas: 1\n  selector:\n    matchLabels:\n      app: redis-master\n  template:\n    metadata:\n      labels:\n        app: redis-master\n        redis-master: 'true'\n      annotations:\n        sidecar.istio.io/inject: 'false'\n    spec:\n      terminationGracePeriodSeconds: 10\n      securityContext:\n        sysctls:\n        - name: net.ipv4.tcp_syncookies\n          value: '0'\n        - name: net.ipv4.ip_local_port_range\n          value: 1024 65535\n        - name: net.core.somaxconn\n          value: '65535'\n        - name: net.ipv4.ip_unprivileged_port_start\n          value: '0'\n        - name: net.ipv4.tcp_tw_reuse\n          value: '1'\n        - name: net.ipv4.tcp_fin_timeout\n          value: '30'\n        - name: net.ipv4.tcp_keepalive_intvl\n          value: '10'\n        - name: net.ipv4.tcp_keepalive_probes\n          value: '2'\n        - name: net.ipv4.tcp_keepalive_time\n          value: '120'\n        - name: net.ipv4.tcp_ecn\n          value: '1'\n        - name: net.ipv4.tcp_max_syn_backlog\n          value: '65536'\n        - name: net.ipv4.tcp_rfc1337\n          value: '1'\n        - name: net.ipv4.tcp_slow_start_after_idle\n          value: '0'\n        - name: net.ipv4.tcp_fack\n          value: '1'\n        - name: net.ipv4.tcp_max_tw_buckets\n          value: '262144'\n        - name: net.ipv4.tcp_fastopen\n          value: '3'\n        - name: net.ipv4.icmp_ratelimit\n          value: '100'\n        - name: net.ipv4.tcp_abort_on_overflow\n          value: '1'\n        - name: net.ipv4.tcp_adv_win_scale\n          value: '2'\n        - name: net.ipv4.tcp_retries2\n          value: '8'\n        - name: net.ipv4.tcp_syn_retries\n          value: '3'\n        - name: net.ipv4.tcp_synack_retries\n          value: '2'\n        - name: net.unix.max_dgram_qlen\n          value: '512'\n        - name: net.ipv4.tcp_fwmark_accept\n          value: '1'\n        - name: net.ipv4.fwmark_reflect\n          value: '1'\n      containers:\n      - name: redis\n        image: redis:6.0\n        imagePullPolicy: IfNotPresent\n        ports:\n        - containerPort: 6379\n        env:\n        - name: MASTER\n          value: 'true'\n        resources:\n          requests:\n            memory: 256Mi\n            cpu: 250m\n          limits:\n            memory: 2Gi\n            cpu: 2000m\n        volumeMounts:\n        - name: redis-master-volume\n          mountPath: /data\n  volumeClaimTemplates:\n  - metadata:\n      name: redis-master-volume\n    spec:\n      accessModes:\n      - ReadWriteOnce\n      resources:\n        requests:\n          storage: 10Gi\n",
    "policy_id": "unsafe-sysctls",
    "violation_text": "resource specifies unsafe sysctl \"net.ipv4.tcp_fin_timeout\"."
  },
  {
    "id": "1004",
    "manifest_path": "data/manifests/the_stack_sample/sample_0070.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: redis-master\n  namespace: default\n  labels:\n    name: redis-master\nspec:\n  serviceName: redis-master\n  replicas: 1\n  selector:\n    matchLabels:\n      app: redis-master\n  template:\n    metadata:\n      labels:\n        app: redis-master\n        redis-master: 'true'\n      annotations:\n        sidecar.istio.io/inject: 'false'\n    spec:\n      terminationGracePeriodSeconds: 10\n      securityContext:\n        sysctls:\n        - name: net.ipv4.tcp_syncookies\n          value: '0'\n        - name: net.ipv4.ip_local_port_range\n          value: 1024 65535\n        - name: net.core.somaxconn\n          value: '65535'\n        - name: net.ipv4.ip_unprivileged_port_start\n          value: '0'\n        - name: net.ipv4.tcp_tw_reuse\n          value: '1'\n        - name: net.ipv4.tcp_fin_timeout\n          value: '30'\n        - name: net.ipv4.tcp_keepalive_intvl\n          value: '10'\n        - name: net.ipv4.tcp_keepalive_probes\n          value: '2'\n        - name: net.ipv4.tcp_keepalive_time\n          value: '120'\n        - name: net.ipv4.tcp_ecn\n          value: '1'\n        - name: net.ipv4.tcp_max_syn_backlog\n          value: '65536'\n        - name: net.ipv4.tcp_rfc1337\n          value: '1'\n        - name: net.ipv4.tcp_slow_start_after_idle\n          value: '0'\n        - name: net.ipv4.tcp_fack\n          value: '1'\n        - name: net.ipv4.tcp_max_tw_buckets\n          value: '262144'\n        - name: net.ipv4.tcp_fastopen\n          value: '3'\n        - name: net.ipv4.icmp_ratelimit\n          value: '100'\n        - name: net.ipv4.tcp_abort_on_overflow\n          value: '1'\n        - name: net.ipv4.tcp_adv_win_scale\n          value: '2'\n        - name: net.ipv4.tcp_retries2\n          value: '8'\n        - name: net.ipv4.tcp_syn_retries\n          value: '3'\n        - name: net.ipv4.tcp_synack_retries\n          value: '2'\n        - name: net.unix.max_dgram_qlen\n          value: '512'\n        - name: net.ipv4.tcp_fwmark_accept\n          value: '1'\n        - name: net.ipv4.fwmark_reflect\n          value: '1'\n      containers:\n      - name: redis\n        image: redis:6.0\n        imagePullPolicy: IfNotPresent\n        ports:\n        - containerPort: 6379\n        env:\n        - name: MASTER\n          value: 'true'\n        resources:\n          requests:\n            memory: 256Mi\n            cpu: 250m\n          limits:\n            memory: 2Gi\n            cpu: 2000m\n        volumeMounts:\n        - name: redis-master-volume\n          mountPath: /data\n  volumeClaimTemplates:\n  - metadata:\n      name: redis-master-volume\n    spec:\n      accessModes:\n      - ReadWriteOnce\n      resources:\n        requests:\n          storage: 10Gi\n",
    "policy_id": "unsafe-sysctls",
    "violation_text": "resource specifies unsafe sysctl \"net.ipv4.tcp_fwmark_accept\"."
  },
  {
    "id": "1005",
    "manifest_path": "data/manifests/the_stack_sample/sample_0070.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: redis-master\n  namespace: default\n  labels:\n    name: redis-master\nspec:\n  serviceName: redis-master\n  replicas: 1\n  selector:\n    matchLabels:\n      app: redis-master\n  template:\n    metadata:\n      labels:\n        app: redis-master\n        redis-master: 'true'\n      annotations:\n        sidecar.istio.io/inject: 'false'\n    spec:\n      terminationGracePeriodSeconds: 10\n      securityContext:\n        sysctls:\n        - name: net.ipv4.tcp_syncookies\n          value: '0'\n        - name: net.ipv4.ip_local_port_range\n          value: 1024 65535\n        - name: net.core.somaxconn\n          value: '65535'\n        - name: net.ipv4.ip_unprivileged_port_start\n          value: '0'\n        - name: net.ipv4.tcp_tw_reuse\n          value: '1'\n        - name: net.ipv4.tcp_fin_timeout\n          value: '30'\n        - name: net.ipv4.tcp_keepalive_intvl\n          value: '10'\n        - name: net.ipv4.tcp_keepalive_probes\n          value: '2'\n        - name: net.ipv4.tcp_keepalive_time\n          value: '120'\n        - name: net.ipv4.tcp_ecn\n          value: '1'\n        - name: net.ipv4.tcp_max_syn_backlog\n          value: '65536'\n        - name: net.ipv4.tcp_rfc1337\n          value: '1'\n        - name: net.ipv4.tcp_slow_start_after_idle\n          value: '0'\n        - name: net.ipv4.tcp_fack\n          value: '1'\n        - name: net.ipv4.tcp_max_tw_buckets\n          value: '262144'\n        - name: net.ipv4.tcp_fastopen\n          value: '3'\n        - name: net.ipv4.icmp_ratelimit\n          value: '100'\n        - name: net.ipv4.tcp_abort_on_overflow\n          value: '1'\n        - name: net.ipv4.tcp_adv_win_scale\n          value: '2'\n        - name: net.ipv4.tcp_retries2\n          value: '8'\n        - name: net.ipv4.tcp_syn_retries\n          value: '3'\n        - name: net.ipv4.tcp_synack_retries\n          value: '2'\n        - name: net.unix.max_dgram_qlen\n          value: '512'\n        - name: net.ipv4.tcp_fwmark_accept\n          value: '1'\n        - name: net.ipv4.fwmark_reflect\n          value: '1'\n      containers:\n      - name: redis\n        image: redis:6.0\n        imagePullPolicy: IfNotPresent\n        ports:\n        - containerPort: 6379\n        env:\n        - name: MASTER\n          value: 'true'\n        resources:\n          requests:\n            memory: 256Mi\n            cpu: 250m\n          limits:\n            memory: 2Gi\n            cpu: 2000m\n        volumeMounts:\n        - name: redis-master-volume\n          mountPath: /data\n  volumeClaimTemplates:\n  - metadata:\n      name: redis-master-volume\n    spec:\n      accessModes:\n      - ReadWriteOnce\n      resources:\n        requests:\n          storage: 10Gi\n",
    "policy_id": "unsafe-sysctls",
    "violation_text": "resource specifies unsafe sysctl \"net.ipv4.tcp_keepalive_intvl\"."
  },
  {
    "id": "1006",
    "manifest_path": "data/manifests/the_stack_sample/sample_0070.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: redis-master\n  namespace: default\n  labels:\n    name: redis-master\nspec:\n  serviceName: redis-master\n  replicas: 1\n  selector:\n    matchLabels:\n      app: redis-master\n  template:\n    metadata:\n      labels:\n        app: redis-master\n        redis-master: 'true'\n      annotations:\n        sidecar.istio.io/inject: 'false'\n    spec:\n      terminationGracePeriodSeconds: 10\n      securityContext:\n        sysctls:\n        - name: net.ipv4.tcp_syncookies\n          value: '0'\n        - name: net.ipv4.ip_local_port_range\n          value: 1024 65535\n        - name: net.core.somaxconn\n          value: '65535'\n        - name: net.ipv4.ip_unprivileged_port_start\n          value: '0'\n        - name: net.ipv4.tcp_tw_reuse\n          value: '1'\n        - name: net.ipv4.tcp_fin_timeout\n          value: '30'\n        - name: net.ipv4.tcp_keepalive_intvl\n          value: '10'\n        - name: net.ipv4.tcp_keepalive_probes\n          value: '2'\n        - name: net.ipv4.tcp_keepalive_time\n          value: '120'\n        - name: net.ipv4.tcp_ecn\n          value: '1'\n        - name: net.ipv4.tcp_max_syn_backlog\n          value: '65536'\n        - name: net.ipv4.tcp_rfc1337\n          value: '1'\n        - name: net.ipv4.tcp_slow_start_after_idle\n          value: '0'\n        - name: net.ipv4.tcp_fack\n          value: '1'\n        - name: net.ipv4.tcp_max_tw_buckets\n          value: '262144'\n        - name: net.ipv4.tcp_fastopen\n          value: '3'\n        - name: net.ipv4.icmp_ratelimit\n          value: '100'\n        - name: net.ipv4.tcp_abort_on_overflow\n          value: '1'\n        - name: net.ipv4.tcp_adv_win_scale\n          value: '2'\n        - name: net.ipv4.tcp_retries2\n          value: '8'\n        - name: net.ipv4.tcp_syn_retries\n          value: '3'\n        - name: net.ipv4.tcp_synack_retries\n          value: '2'\n        - name: net.unix.max_dgram_qlen\n          value: '512'\n        - name: net.ipv4.tcp_fwmark_accept\n          value: '1'\n        - name: net.ipv4.fwmark_reflect\n          value: '1'\n      containers:\n      - name: redis\n        image: redis:6.0\n        imagePullPolicy: IfNotPresent\n        ports:\n        - containerPort: 6379\n        env:\n        - name: MASTER\n          value: 'true'\n        resources:\n          requests:\n            memory: 256Mi\n            cpu: 250m\n          limits:\n            memory: 2Gi\n            cpu: 2000m\n        volumeMounts:\n        - name: redis-master-volume\n          mountPath: /data\n  volumeClaimTemplates:\n  - metadata:\n      name: redis-master-volume\n    spec:\n      accessModes:\n      - ReadWriteOnce\n      resources:\n        requests:\n          storage: 10Gi\n",
    "policy_id": "unsafe-sysctls",
    "violation_text": "resource specifies unsafe sysctl \"net.ipv4.tcp_keepalive_probes\"."
  },
  {
    "id": "1007",
    "manifest_path": "data/manifests/the_stack_sample/sample_0070.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: redis-master\n  namespace: default\n  labels:\n    name: redis-master\nspec:\n  serviceName: redis-master\n  replicas: 1\n  selector:\n    matchLabels:\n      app: redis-master\n  template:\n    metadata:\n      labels:\n        app: redis-master\n        redis-master: 'true'\n      annotations:\n        sidecar.istio.io/inject: 'false'\n    spec:\n      terminationGracePeriodSeconds: 10\n      securityContext:\n        sysctls:\n        - name: net.ipv4.tcp_syncookies\n          value: '0'\n        - name: net.ipv4.ip_local_port_range\n          value: 1024 65535\n        - name: net.core.somaxconn\n          value: '65535'\n        - name: net.ipv4.ip_unprivileged_port_start\n          value: '0'\n        - name: net.ipv4.tcp_tw_reuse\n          value: '1'\n        - name: net.ipv4.tcp_fin_timeout\n          value: '30'\n        - name: net.ipv4.tcp_keepalive_intvl\n          value: '10'\n        - name: net.ipv4.tcp_keepalive_probes\n          value: '2'\n        - name: net.ipv4.tcp_keepalive_time\n          value: '120'\n        - name: net.ipv4.tcp_ecn\n          value: '1'\n        - name: net.ipv4.tcp_max_syn_backlog\n          value: '65536'\n        - name: net.ipv4.tcp_rfc1337\n          value: '1'\n        - name: net.ipv4.tcp_slow_start_after_idle\n          value: '0'\n        - name: net.ipv4.tcp_fack\n          value: '1'\n        - name: net.ipv4.tcp_max_tw_buckets\n          value: '262144'\n        - name: net.ipv4.tcp_fastopen\n          value: '3'\n        - name: net.ipv4.icmp_ratelimit\n          value: '100'\n        - name: net.ipv4.tcp_abort_on_overflow\n          value: '1'\n        - name: net.ipv4.tcp_adv_win_scale\n          value: '2'\n        - name: net.ipv4.tcp_retries2\n          value: '8'\n        - name: net.ipv4.tcp_syn_retries\n          value: '3'\n        - name: net.ipv4.tcp_synack_retries\n          value: '2'\n        - name: net.unix.max_dgram_qlen\n          value: '512'\n        - name: net.ipv4.tcp_fwmark_accept\n          value: '1'\n        - name: net.ipv4.fwmark_reflect\n          value: '1'\n      containers:\n      - name: redis\n        image: redis:6.0\n        imagePullPolicy: IfNotPresent\n        ports:\n        - containerPort: 6379\n        env:\n        - name: MASTER\n          value: 'true'\n        resources:\n          requests:\n            memory: 256Mi\n            cpu: 250m\n          limits:\n            memory: 2Gi\n            cpu: 2000m\n        volumeMounts:\n        - name: redis-master-volume\n          mountPath: /data\n  volumeClaimTemplates:\n  - metadata:\n      name: redis-master-volume\n    spec:\n      accessModes:\n      - ReadWriteOnce\n      resources:\n        requests:\n          storage: 10Gi\n",
    "policy_id": "unsafe-sysctls",
    "violation_text": "resource specifies unsafe sysctl \"net.ipv4.tcp_keepalive_time\"."
  },
  {
    "id": "1008",
    "manifest_path": "data/manifests/the_stack_sample/sample_0070.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: redis-master\n  namespace: default\n  labels:\n    name: redis-master\nspec:\n  serviceName: redis-master\n  replicas: 1\n  selector:\n    matchLabels:\n      app: redis-master\n  template:\n    metadata:\n      labels:\n        app: redis-master\n        redis-master: 'true'\n      annotations:\n        sidecar.istio.io/inject: 'false'\n    spec:\n      terminationGracePeriodSeconds: 10\n      securityContext:\n        sysctls:\n        - name: net.ipv4.tcp_syncookies\n          value: '0'\n        - name: net.ipv4.ip_local_port_range\n          value: 1024 65535\n        - name: net.core.somaxconn\n          value: '65535'\n        - name: net.ipv4.ip_unprivileged_port_start\n          value: '0'\n        - name: net.ipv4.tcp_tw_reuse\n          value: '1'\n        - name: net.ipv4.tcp_fin_timeout\n          value: '30'\n        - name: net.ipv4.tcp_keepalive_intvl\n          value: '10'\n        - name: net.ipv4.tcp_keepalive_probes\n          value: '2'\n        - name: net.ipv4.tcp_keepalive_time\n          value: '120'\n        - name: net.ipv4.tcp_ecn\n          value: '1'\n        - name: net.ipv4.tcp_max_syn_backlog\n          value: '65536'\n        - name: net.ipv4.tcp_rfc1337\n          value: '1'\n        - name: net.ipv4.tcp_slow_start_after_idle\n          value: '0'\n        - name: net.ipv4.tcp_fack\n          value: '1'\n        - name: net.ipv4.tcp_max_tw_buckets\n          value: '262144'\n        - name: net.ipv4.tcp_fastopen\n          value: '3'\n        - name: net.ipv4.icmp_ratelimit\n          value: '100'\n        - name: net.ipv4.tcp_abort_on_overflow\n          value: '1'\n        - name: net.ipv4.tcp_adv_win_scale\n          value: '2'\n        - name: net.ipv4.tcp_retries2\n          value: '8'\n        - name: net.ipv4.tcp_syn_retries\n          value: '3'\n        - name: net.ipv4.tcp_synack_retries\n          value: '2'\n        - name: net.unix.max_dgram_qlen\n          value: '512'\n        - name: net.ipv4.tcp_fwmark_accept\n          value: '1'\n        - name: net.ipv4.fwmark_reflect\n          value: '1'\n      containers:\n      - name: redis\n        image: redis:6.0\n        imagePullPolicy: IfNotPresent\n        ports:\n        - containerPort: 6379\n        env:\n        - name: MASTER\n          value: 'true'\n        resources:\n          requests:\n            memory: 256Mi\n            cpu: 250m\n          limits:\n            memory: 2Gi\n            cpu: 2000m\n        volumeMounts:\n        - name: redis-master-volume\n          mountPath: /data\n  volumeClaimTemplates:\n  - metadata:\n      name: redis-master-volume\n    spec:\n      accessModes:\n      - ReadWriteOnce\n      resources:\n        requests:\n          storage: 10Gi\n",
    "policy_id": "unsafe-sysctls",
    "violation_text": "resource specifies unsafe sysctl \"net.ipv4.tcp_max_syn_backlog\"."
  },
  {
    "id": "1009",
    "manifest_path": "data/manifests/the_stack_sample/sample_0070.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: redis-master\n  namespace: default\n  labels:\n    name: redis-master\nspec:\n  serviceName: redis-master\n  replicas: 1\n  selector:\n    matchLabels:\n      app: redis-master\n  template:\n    metadata:\n      labels:\n        app: redis-master\n        redis-master: 'true'\n      annotations:\n        sidecar.istio.io/inject: 'false'\n    spec:\n      terminationGracePeriodSeconds: 10\n      securityContext:\n        sysctls:\n        - name: net.ipv4.tcp_syncookies\n          value: '0'\n        - name: net.ipv4.ip_local_port_range\n          value: 1024 65535\n        - name: net.core.somaxconn\n          value: '65535'\n        - name: net.ipv4.ip_unprivileged_port_start\n          value: '0'\n        - name: net.ipv4.tcp_tw_reuse\n          value: '1'\n        - name: net.ipv4.tcp_fin_timeout\n          value: '30'\n        - name: net.ipv4.tcp_keepalive_intvl\n          value: '10'\n        - name: net.ipv4.tcp_keepalive_probes\n          value: '2'\n        - name: net.ipv4.tcp_keepalive_time\n          value: '120'\n        - name: net.ipv4.tcp_ecn\n          value: '1'\n        - name: net.ipv4.tcp_max_syn_backlog\n          value: '65536'\n        - name: net.ipv4.tcp_rfc1337\n          value: '1'\n        - name: net.ipv4.tcp_slow_start_after_idle\n          value: '0'\n        - name: net.ipv4.tcp_fack\n          value: '1'\n        - name: net.ipv4.tcp_max_tw_buckets\n          value: '262144'\n        - name: net.ipv4.tcp_fastopen\n          value: '3'\n        - name: net.ipv4.icmp_ratelimit\n          value: '100'\n        - name: net.ipv4.tcp_abort_on_overflow\n          value: '1'\n        - name: net.ipv4.tcp_adv_win_scale\n          value: '2'\n        - name: net.ipv4.tcp_retries2\n          value: '8'\n        - name: net.ipv4.tcp_syn_retries\n          value: '3'\n        - name: net.ipv4.tcp_synack_retries\n          value: '2'\n        - name: net.unix.max_dgram_qlen\n          value: '512'\n        - name: net.ipv4.tcp_fwmark_accept\n          value: '1'\n        - name: net.ipv4.fwmark_reflect\n          value: '1'\n      containers:\n      - name: redis\n        image: redis:6.0\n        imagePullPolicy: IfNotPresent\n        ports:\n        - containerPort: 6379\n        env:\n        - name: MASTER\n          value: 'true'\n        resources:\n          requests:\n            memory: 256Mi\n            cpu: 250m\n          limits:\n            memory: 2Gi\n            cpu: 2000m\n        volumeMounts:\n        - name: redis-master-volume\n          mountPath: /data\n  volumeClaimTemplates:\n  - metadata:\n      name: redis-master-volume\n    spec:\n      accessModes:\n      - ReadWriteOnce\n      resources:\n        requests:\n          storage: 10Gi\n",
    "policy_id": "unsafe-sysctls",
    "violation_text": "resource specifies unsafe sysctl \"net.ipv4.tcp_max_tw_buckets\"."
  },
  {
    "id": "1010",
    "manifest_path": "data/manifests/the_stack_sample/sample_0070.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: redis-master\n  namespace: default\n  labels:\n    name: redis-master\nspec:\n  serviceName: redis-master\n  replicas: 1\n  selector:\n    matchLabels:\n      app: redis-master\n  template:\n    metadata:\n      labels:\n        app: redis-master\n        redis-master: 'true'\n      annotations:\n        sidecar.istio.io/inject: 'false'\n    spec:\n      terminationGracePeriodSeconds: 10\n      securityContext:\n        sysctls:\n        - name: net.ipv4.tcp_syncookies\n          value: '0'\n        - name: net.ipv4.ip_local_port_range\n          value: 1024 65535\n        - name: net.core.somaxconn\n          value: '65535'\n        - name: net.ipv4.ip_unprivileged_port_start\n          value: '0'\n        - name: net.ipv4.tcp_tw_reuse\n          value: '1'\n        - name: net.ipv4.tcp_fin_timeout\n          value: '30'\n        - name: net.ipv4.tcp_keepalive_intvl\n          value: '10'\n        - name: net.ipv4.tcp_keepalive_probes\n          value: '2'\n        - name: net.ipv4.tcp_keepalive_time\n          value: '120'\n        - name: net.ipv4.tcp_ecn\n          value: '1'\n        - name: net.ipv4.tcp_max_syn_backlog\n          value: '65536'\n        - name: net.ipv4.tcp_rfc1337\n          value: '1'\n        - name: net.ipv4.tcp_slow_start_after_idle\n          value: '0'\n        - name: net.ipv4.tcp_fack\n          value: '1'\n        - name: net.ipv4.tcp_max_tw_buckets\n          value: '262144'\n        - name: net.ipv4.tcp_fastopen\n          value: '3'\n        - name: net.ipv4.icmp_ratelimit\n          value: '100'\n        - name: net.ipv4.tcp_abort_on_overflow\n          value: '1'\n        - name: net.ipv4.tcp_adv_win_scale\n          value: '2'\n        - name: net.ipv4.tcp_retries2\n          value: '8'\n        - name: net.ipv4.tcp_syn_retries\n          value: '3'\n        - name: net.ipv4.tcp_synack_retries\n          value: '2'\n        - name: net.unix.max_dgram_qlen\n          value: '512'\n        - name: net.ipv4.tcp_fwmark_accept\n          value: '1'\n        - name: net.ipv4.fwmark_reflect\n          value: '1'\n      containers:\n      - name: redis\n        image: redis:6.0\n        imagePullPolicy: IfNotPresent\n        ports:\n        - containerPort: 6379\n        env:\n        - name: MASTER\n          value: 'true'\n        resources:\n          requests:\n            memory: 256Mi\n            cpu: 250m\n          limits:\n            memory: 2Gi\n            cpu: 2000m\n        volumeMounts:\n        - name: redis-master-volume\n          mountPath: /data\n  volumeClaimTemplates:\n  - metadata:\n      name: redis-master-volume\n    spec:\n      accessModes:\n      - ReadWriteOnce\n      resources:\n        requests:\n          storage: 10Gi\n",
    "policy_id": "unsafe-sysctls",
    "violation_text": "resource specifies unsafe sysctl \"net.ipv4.tcp_retries2\"."
  },
  {
    "id": "1011",
    "manifest_path": "data/manifests/the_stack_sample/sample_0070.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: redis-master\n  namespace: default\n  labels:\n    name: redis-master\nspec:\n  serviceName: redis-master\n  replicas: 1\n  selector:\n    matchLabels:\n      app: redis-master\n  template:\n    metadata:\n      labels:\n        app: redis-master\n        redis-master: 'true'\n      annotations:\n        sidecar.istio.io/inject: 'false'\n    spec:\n      terminationGracePeriodSeconds: 10\n      securityContext:\n        sysctls:\n        - name: net.ipv4.tcp_syncookies\n          value: '0'\n        - name: net.ipv4.ip_local_port_range\n          value: 1024 65535\n        - name: net.core.somaxconn\n          value: '65535'\n        - name: net.ipv4.ip_unprivileged_port_start\n          value: '0'\n        - name: net.ipv4.tcp_tw_reuse\n          value: '1'\n        - name: net.ipv4.tcp_fin_timeout\n          value: '30'\n        - name: net.ipv4.tcp_keepalive_intvl\n          value: '10'\n        - name: net.ipv4.tcp_keepalive_probes\n          value: '2'\n        - name: net.ipv4.tcp_keepalive_time\n          value: '120'\n        - name: net.ipv4.tcp_ecn\n          value: '1'\n        - name: net.ipv4.tcp_max_syn_backlog\n          value: '65536'\n        - name: net.ipv4.tcp_rfc1337\n          value: '1'\n        - name: net.ipv4.tcp_slow_start_after_idle\n          value: '0'\n        - name: net.ipv4.tcp_fack\n          value: '1'\n        - name: net.ipv4.tcp_max_tw_buckets\n          value: '262144'\n        - name: net.ipv4.tcp_fastopen\n          value: '3'\n        - name: net.ipv4.icmp_ratelimit\n          value: '100'\n        - name: net.ipv4.tcp_abort_on_overflow\n          value: '1'\n        - name: net.ipv4.tcp_adv_win_scale\n          value: '2'\n        - name: net.ipv4.tcp_retries2\n          value: '8'\n        - name: net.ipv4.tcp_syn_retries\n          value: '3'\n        - name: net.ipv4.tcp_synack_retries\n          value: '2'\n        - name: net.unix.max_dgram_qlen\n          value: '512'\n        - name: net.ipv4.tcp_fwmark_accept\n          value: '1'\n        - name: net.ipv4.fwmark_reflect\n          value: '1'\n      containers:\n      - name: redis\n        image: redis:6.0\n        imagePullPolicy: IfNotPresent\n        ports:\n        - containerPort: 6379\n        env:\n        - name: MASTER\n          value: 'true'\n        resources:\n          requests:\n            memory: 256Mi\n            cpu: 250m\n          limits:\n            memory: 2Gi\n            cpu: 2000m\n        volumeMounts:\n        - name: redis-master-volume\n          mountPath: /data\n  volumeClaimTemplates:\n  - metadata:\n      name: redis-master-volume\n    spec:\n      accessModes:\n      - ReadWriteOnce\n      resources:\n        requests:\n          storage: 10Gi\n",
    "policy_id": "unsafe-sysctls",
    "violation_text": "resource specifies unsafe sysctl \"net.ipv4.tcp_rfc1337\"."
  },
  {
    "id": "1012",
    "manifest_path": "data/manifests/the_stack_sample/sample_0070.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: redis-master\n  namespace: default\n  labels:\n    name: redis-master\nspec:\n  serviceName: redis-master\n  replicas: 1\n  selector:\n    matchLabels:\n      app: redis-master\n  template:\n    metadata:\n      labels:\n        app: redis-master\n        redis-master: 'true'\n      annotations:\n        sidecar.istio.io/inject: 'false'\n    spec:\n      terminationGracePeriodSeconds: 10\n      securityContext:\n        sysctls:\n        - name: net.ipv4.tcp_syncookies\n          value: '0'\n        - name: net.ipv4.ip_local_port_range\n          value: 1024 65535\n        - name: net.core.somaxconn\n          value: '65535'\n        - name: net.ipv4.ip_unprivileged_port_start\n          value: '0'\n        - name: net.ipv4.tcp_tw_reuse\n          value: '1'\n        - name: net.ipv4.tcp_fin_timeout\n          value: '30'\n        - name: net.ipv4.tcp_keepalive_intvl\n          value: '10'\n        - name: net.ipv4.tcp_keepalive_probes\n          value: '2'\n        - name: net.ipv4.tcp_keepalive_time\n          value: '120'\n        - name: net.ipv4.tcp_ecn\n          value: '1'\n        - name: net.ipv4.tcp_max_syn_backlog\n          value: '65536'\n        - name: net.ipv4.tcp_rfc1337\n          value: '1'\n        - name: net.ipv4.tcp_slow_start_after_idle\n          value: '0'\n        - name: net.ipv4.tcp_fack\n          value: '1'\n        - name: net.ipv4.tcp_max_tw_buckets\n          value: '262144'\n        - name: net.ipv4.tcp_fastopen\n          value: '3'\n        - name: net.ipv4.icmp_ratelimit\n          value: '100'\n        - name: net.ipv4.tcp_abort_on_overflow\n          value: '1'\n        - name: net.ipv4.tcp_adv_win_scale\n          value: '2'\n        - name: net.ipv4.tcp_retries2\n          value: '8'\n        - name: net.ipv4.tcp_syn_retries\n          value: '3'\n        - name: net.ipv4.tcp_synack_retries\n          value: '2'\n        - name: net.unix.max_dgram_qlen\n          value: '512'\n        - name: net.ipv4.tcp_fwmark_accept\n          value: '1'\n        - name: net.ipv4.fwmark_reflect\n          value: '1'\n      containers:\n      - name: redis\n        image: redis:6.0\n        imagePullPolicy: IfNotPresent\n        ports:\n        - containerPort: 6379\n        env:\n        - name: MASTER\n          value: 'true'\n        resources:\n          requests:\n            memory: 256Mi\n            cpu: 250m\n          limits:\n            memory: 2Gi\n            cpu: 2000m\n        volumeMounts:\n        - name: redis-master-volume\n          mountPath: /data\n  volumeClaimTemplates:\n  - metadata:\n      name: redis-master-volume\n    spec:\n      accessModes:\n      - ReadWriteOnce\n      resources:\n        requests:\n          storage: 10Gi\n",
    "policy_id": "unsafe-sysctls",
    "violation_text": "resource specifies unsafe sysctl \"net.ipv4.tcp_slow_start_after_idle\"."
  },
  {
    "id": "1013",
    "manifest_path": "data/manifests/the_stack_sample/sample_0070.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: redis-master\n  namespace: default\n  labels:\n    name: redis-master\nspec:\n  serviceName: redis-master\n  replicas: 1\n  selector:\n    matchLabels:\n      app: redis-master\n  template:\n    metadata:\n      labels:\n        app: redis-master\n        redis-master: 'true'\n      annotations:\n        sidecar.istio.io/inject: 'false'\n    spec:\n      terminationGracePeriodSeconds: 10\n      securityContext:\n        sysctls:\n        - name: net.ipv4.tcp_syncookies\n          value: '0'\n        - name: net.ipv4.ip_local_port_range\n          value: 1024 65535\n        - name: net.core.somaxconn\n          value: '65535'\n        - name: net.ipv4.ip_unprivileged_port_start\n          value: '0'\n        - name: net.ipv4.tcp_tw_reuse\n          value: '1'\n        - name: net.ipv4.tcp_fin_timeout\n          value: '30'\n        - name: net.ipv4.tcp_keepalive_intvl\n          value: '10'\n        - name: net.ipv4.tcp_keepalive_probes\n          value: '2'\n        - name: net.ipv4.tcp_keepalive_time\n          value: '120'\n        - name: net.ipv4.tcp_ecn\n          value: '1'\n        - name: net.ipv4.tcp_max_syn_backlog\n          value: '65536'\n        - name: net.ipv4.tcp_rfc1337\n          value: '1'\n        - name: net.ipv4.tcp_slow_start_after_idle\n          value: '0'\n        - name: net.ipv4.tcp_fack\n          value: '1'\n        - name: net.ipv4.tcp_max_tw_buckets\n          value: '262144'\n        - name: net.ipv4.tcp_fastopen\n          value: '3'\n        - name: net.ipv4.icmp_ratelimit\n          value: '100'\n        - name: net.ipv4.tcp_abort_on_overflow\n          value: '1'\n        - name: net.ipv4.tcp_adv_win_scale\n          value: '2'\n        - name: net.ipv4.tcp_retries2\n          value: '8'\n        - name: net.ipv4.tcp_syn_retries\n          value: '3'\n        - name: net.ipv4.tcp_synack_retries\n          value: '2'\n        - name: net.unix.max_dgram_qlen\n          value: '512'\n        - name: net.ipv4.tcp_fwmark_accept\n          value: '1'\n        - name: net.ipv4.fwmark_reflect\n          value: '1'\n      containers:\n      - name: redis\n        image: redis:6.0\n        imagePullPolicy: IfNotPresent\n        ports:\n        - containerPort: 6379\n        env:\n        - name: MASTER\n          value: 'true'\n        resources:\n          requests:\n            memory: 256Mi\n            cpu: 250m\n          limits:\n            memory: 2Gi\n            cpu: 2000m\n        volumeMounts:\n        - name: redis-master-volume\n          mountPath: /data\n  volumeClaimTemplates:\n  - metadata:\n      name: redis-master-volume\n    spec:\n      accessModes:\n      - ReadWriteOnce\n      resources:\n        requests:\n          storage: 10Gi\n",
    "policy_id": "unsafe-sysctls",
    "violation_text": "resource specifies unsafe sysctl \"net.ipv4.tcp_syn_retries\"."
  },
  {
    "id": "1014",
    "manifest_path": "data/manifests/the_stack_sample/sample_0070.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: redis-master\n  namespace: default\n  labels:\n    name: redis-master\nspec:\n  serviceName: redis-master\n  replicas: 1\n  selector:\n    matchLabels:\n      app: redis-master\n  template:\n    metadata:\n      labels:\n        app: redis-master\n        redis-master: 'true'\n      annotations:\n        sidecar.istio.io/inject: 'false'\n    spec:\n      terminationGracePeriodSeconds: 10\n      securityContext:\n        sysctls:\n        - name: net.ipv4.tcp_syncookies\n          value: '0'\n        - name: net.ipv4.ip_local_port_range\n          value: 1024 65535\n        - name: net.core.somaxconn\n          value: '65535'\n        - name: net.ipv4.ip_unprivileged_port_start\n          value: '0'\n        - name: net.ipv4.tcp_tw_reuse\n          value: '1'\n        - name: net.ipv4.tcp_fin_timeout\n          value: '30'\n        - name: net.ipv4.tcp_keepalive_intvl\n          value: '10'\n        - name: net.ipv4.tcp_keepalive_probes\n          value: '2'\n        - name: net.ipv4.tcp_keepalive_time\n          value: '120'\n        - name: net.ipv4.tcp_ecn\n          value: '1'\n        - name: net.ipv4.tcp_max_syn_backlog\n          value: '65536'\n        - name: net.ipv4.tcp_rfc1337\n          value: '1'\n        - name: net.ipv4.tcp_slow_start_after_idle\n          value: '0'\n        - name: net.ipv4.tcp_fack\n          value: '1'\n        - name: net.ipv4.tcp_max_tw_buckets\n          value: '262144'\n        - name: net.ipv4.tcp_fastopen\n          value: '3'\n        - name: net.ipv4.icmp_ratelimit\n          value: '100'\n        - name: net.ipv4.tcp_abort_on_overflow\n          value: '1'\n        - name: net.ipv4.tcp_adv_win_scale\n          value: '2'\n        - name: net.ipv4.tcp_retries2\n          value: '8'\n        - name: net.ipv4.tcp_syn_retries\n          value: '3'\n        - name: net.ipv4.tcp_synack_retries\n          value: '2'\n        - name: net.unix.max_dgram_qlen\n          value: '512'\n        - name: net.ipv4.tcp_fwmark_accept\n          value: '1'\n        - name: net.ipv4.fwmark_reflect\n          value: '1'\n      containers:\n      - name: redis\n        image: redis:6.0\n        imagePullPolicy: IfNotPresent\n        ports:\n        - containerPort: 6379\n        env:\n        - name: MASTER\n          value: 'true'\n        resources:\n          requests:\n            memory: 256Mi\n            cpu: 250m\n          limits:\n            memory: 2Gi\n            cpu: 2000m\n        volumeMounts:\n        - name: redis-master-volume\n          mountPath: /data\n  volumeClaimTemplates:\n  - metadata:\n      name: redis-master-volume\n    spec:\n      accessModes:\n      - ReadWriteOnce\n      resources:\n        requests:\n          storage: 10Gi\n",
    "policy_id": "unsafe-sysctls",
    "violation_text": "resource specifies unsafe sysctl \"net.ipv4.tcp_synack_retries\"."
  },
  {
    "id": "1015",
    "manifest_path": "data/manifests/the_stack_sample/sample_0070.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: redis-master\n  namespace: default\n  labels:\n    name: redis-master\nspec:\n  serviceName: redis-master\n  replicas: 1\n  selector:\n    matchLabels:\n      app: redis-master\n  template:\n    metadata:\n      labels:\n        app: redis-master\n        redis-master: 'true'\n      annotations:\n        sidecar.istio.io/inject: 'false'\n    spec:\n      terminationGracePeriodSeconds: 10\n      securityContext:\n        sysctls:\n        - name: net.ipv4.tcp_syncookies\n          value: '0'\n        - name: net.ipv4.ip_local_port_range\n          value: 1024 65535\n        - name: net.core.somaxconn\n          value: '65535'\n        - name: net.ipv4.ip_unprivileged_port_start\n          value: '0'\n        - name: net.ipv4.tcp_tw_reuse\n          value: '1'\n        - name: net.ipv4.tcp_fin_timeout\n          value: '30'\n        - name: net.ipv4.tcp_keepalive_intvl\n          value: '10'\n        - name: net.ipv4.tcp_keepalive_probes\n          value: '2'\n        - name: net.ipv4.tcp_keepalive_time\n          value: '120'\n        - name: net.ipv4.tcp_ecn\n          value: '1'\n        - name: net.ipv4.tcp_max_syn_backlog\n          value: '65536'\n        - name: net.ipv4.tcp_rfc1337\n          value: '1'\n        - name: net.ipv4.tcp_slow_start_after_idle\n          value: '0'\n        - name: net.ipv4.tcp_fack\n          value: '1'\n        - name: net.ipv4.tcp_max_tw_buckets\n          value: '262144'\n        - name: net.ipv4.tcp_fastopen\n          value: '3'\n        - name: net.ipv4.icmp_ratelimit\n          value: '100'\n        - name: net.ipv4.tcp_abort_on_overflow\n          value: '1'\n        - name: net.ipv4.tcp_adv_win_scale\n          value: '2'\n        - name: net.ipv4.tcp_retries2\n          value: '8'\n        - name: net.ipv4.tcp_syn_retries\n          value: '3'\n        - name: net.ipv4.tcp_synack_retries\n          value: '2'\n        - name: net.unix.max_dgram_qlen\n          value: '512'\n        - name: net.ipv4.tcp_fwmark_accept\n          value: '1'\n        - name: net.ipv4.fwmark_reflect\n          value: '1'\n      containers:\n      - name: redis\n        image: redis:6.0\n        imagePullPolicy: IfNotPresent\n        ports:\n        - containerPort: 6379\n        env:\n        - name: MASTER\n          value: 'true'\n        resources:\n          requests:\n            memory: 256Mi\n            cpu: 250m\n          limits:\n            memory: 2Gi\n            cpu: 2000m\n        volumeMounts:\n        - name: redis-master-volume\n          mountPath: /data\n  volumeClaimTemplates:\n  - metadata:\n      name: redis-master-volume\n    spec:\n      accessModes:\n      - ReadWriteOnce\n      resources:\n        requests:\n          storage: 10Gi\n",
    "policy_id": "unsafe-sysctls",
    "violation_text": "resource specifies unsafe sysctl \"net.ipv4.tcp_syncookies\"."
  },
  {
    "id": "1016",
    "manifest_path": "data/manifests/the_stack_sample/sample_0070.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: redis-master\n  namespace: default\n  labels:\n    name: redis-master\nspec:\n  serviceName: redis-master\n  replicas: 1\n  selector:\n    matchLabels:\n      app: redis-master\n  template:\n    metadata:\n      labels:\n        app: redis-master\n        redis-master: 'true'\n      annotations:\n        sidecar.istio.io/inject: 'false'\n    spec:\n      terminationGracePeriodSeconds: 10\n      securityContext:\n        sysctls:\n        - name: net.ipv4.tcp_syncookies\n          value: '0'\n        - name: net.ipv4.ip_local_port_range\n          value: 1024 65535\n        - name: net.core.somaxconn\n          value: '65535'\n        - name: net.ipv4.ip_unprivileged_port_start\n          value: '0'\n        - name: net.ipv4.tcp_tw_reuse\n          value: '1'\n        - name: net.ipv4.tcp_fin_timeout\n          value: '30'\n        - name: net.ipv4.tcp_keepalive_intvl\n          value: '10'\n        - name: net.ipv4.tcp_keepalive_probes\n          value: '2'\n        - name: net.ipv4.tcp_keepalive_time\n          value: '120'\n        - name: net.ipv4.tcp_ecn\n          value: '1'\n        - name: net.ipv4.tcp_max_syn_backlog\n          value: '65536'\n        - name: net.ipv4.tcp_rfc1337\n          value: '1'\n        - name: net.ipv4.tcp_slow_start_after_idle\n          value: '0'\n        - name: net.ipv4.tcp_fack\n          value: '1'\n        - name: net.ipv4.tcp_max_tw_buckets\n          value: '262144'\n        - name: net.ipv4.tcp_fastopen\n          value: '3'\n        - name: net.ipv4.icmp_ratelimit\n          value: '100'\n        - name: net.ipv4.tcp_abort_on_overflow\n          value: '1'\n        - name: net.ipv4.tcp_adv_win_scale\n          value: '2'\n        - name: net.ipv4.tcp_retries2\n          value: '8'\n        - name: net.ipv4.tcp_syn_retries\n          value: '3'\n        - name: net.ipv4.tcp_synack_retries\n          value: '2'\n        - name: net.unix.max_dgram_qlen\n          value: '512'\n        - name: net.ipv4.tcp_fwmark_accept\n          value: '1'\n        - name: net.ipv4.fwmark_reflect\n          value: '1'\n      containers:\n      - name: redis\n        image: redis:6.0\n        imagePullPolicy: IfNotPresent\n        ports:\n        - containerPort: 6379\n        env:\n        - name: MASTER\n          value: 'true'\n        resources:\n          requests:\n            memory: 256Mi\n            cpu: 250m\n          limits:\n            memory: 2Gi\n            cpu: 2000m\n        volumeMounts:\n        - name: redis-master-volume\n          mountPath: /data\n  volumeClaimTemplates:\n  - metadata:\n      name: redis-master-volume\n    spec:\n      accessModes:\n      - ReadWriteOnce\n      resources:\n        requests:\n          storage: 10Gi\n",
    "policy_id": "unsafe-sysctls",
    "violation_text": "resource specifies unsafe sysctl \"net.ipv4.tcp_tw_reuse\"."
  },
  {
    "id": "1017",
    "manifest_path": "data/manifests/the_stack_sample/sample_0070.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: redis-master\n  namespace: default\n  labels:\n    name: redis-master\nspec:\n  serviceName: redis-master\n  replicas: 1\n  selector:\n    matchLabels:\n      app: redis-master\n  template:\n    metadata:\n      labels:\n        app: redis-master\n        redis-master: 'true'\n      annotations:\n        sidecar.istio.io/inject: 'false'\n    spec:\n      terminationGracePeriodSeconds: 10\n      securityContext:\n        sysctls:\n        - name: net.ipv4.tcp_syncookies\n          value: '0'\n        - name: net.ipv4.ip_local_port_range\n          value: 1024 65535\n        - name: net.core.somaxconn\n          value: '65535'\n        - name: net.ipv4.ip_unprivileged_port_start\n          value: '0'\n        - name: net.ipv4.tcp_tw_reuse\n          value: '1'\n        - name: net.ipv4.tcp_fin_timeout\n          value: '30'\n        - name: net.ipv4.tcp_keepalive_intvl\n          value: '10'\n        - name: net.ipv4.tcp_keepalive_probes\n          value: '2'\n        - name: net.ipv4.tcp_keepalive_time\n          value: '120'\n        - name: net.ipv4.tcp_ecn\n          value: '1'\n        - name: net.ipv4.tcp_max_syn_backlog\n          value: '65536'\n        - name: net.ipv4.tcp_rfc1337\n          value: '1'\n        - name: net.ipv4.tcp_slow_start_after_idle\n          value: '0'\n        - name: net.ipv4.tcp_fack\n          value: '1'\n        - name: net.ipv4.tcp_max_tw_buckets\n          value: '262144'\n        - name: net.ipv4.tcp_fastopen\n          value: '3'\n        - name: net.ipv4.icmp_ratelimit\n          value: '100'\n        - name: net.ipv4.tcp_abort_on_overflow\n          value: '1'\n        - name: net.ipv4.tcp_adv_win_scale\n          value: '2'\n        - name: net.ipv4.tcp_retries2\n          value: '8'\n        - name: net.ipv4.tcp_syn_retries\n          value: '3'\n        - name: net.ipv4.tcp_synack_retries\n          value: '2'\n        - name: net.unix.max_dgram_qlen\n          value: '512'\n        - name: net.ipv4.tcp_fwmark_accept\n          value: '1'\n        - name: net.ipv4.fwmark_reflect\n          value: '1'\n      containers:\n      - name: redis\n        image: redis:6.0\n        imagePullPolicy: IfNotPresent\n        ports:\n        - containerPort: 6379\n        env:\n        - name: MASTER\n          value: 'true'\n        resources:\n          requests:\n            memory: 256Mi\n            cpu: 250m\n          limits:\n            memory: 2Gi\n            cpu: 2000m\n        volumeMounts:\n        - name: redis-master-volume\n          mountPath: /data\n  volumeClaimTemplates:\n  - metadata:\n      name: redis-master-volume\n    spec:\n      accessModes:\n      - ReadWriteOnce\n      resources:\n        requests:\n          storage: 10Gi\n",
    "policy_id": "unsafe-sysctls",
    "violation_text": "resource specifies unsafe sysctl \"net.unix.max_dgram_qlen\"."
  },
  {
    "id": "1018",
    "manifest_path": "data/manifests/the_stack_sample/sample_0071.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: aplicacao\nspec:\n  containers:\n  - name: container-aplicacao-loja\n    image: rafanercessian/aplicacao-loja:v1\n    ports:\n    - containerPort: 80\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"container-aplicacao-loja\" does not have a read-only root file system"
  },
  {
    "id": "1019",
    "manifest_path": "data/manifests/the_stack_sample/sample_0071.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: aplicacao\nspec:\n  containers:\n  - name: container-aplicacao-loja\n    image: rafanercessian/aplicacao-loja:v1\n    ports:\n    - containerPort: 80\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"container-aplicacao-loja\" is not set to runAsNonRoot"
  },
  {
    "id": "1020",
    "manifest_path": "data/manifests/the_stack_sample/sample_0071.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: aplicacao\nspec:\n  containers:\n  - name: container-aplicacao-loja\n    image: rafanercessian/aplicacao-loja:v1\n    ports:\n    - containerPort: 80\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"container-aplicacao-loja\" has cpu request 0"
  },
  {
    "id": "1021",
    "manifest_path": "data/manifests/the_stack_sample/sample_0071.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: aplicacao\nspec:\n  containers:\n  - name: container-aplicacao-loja\n    image: rafanercessian/aplicacao-loja:v1\n    ports:\n    - containerPort: 80\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"container-aplicacao-loja\" has memory limit 0"
  },
  {
    "id": "1022",
    "manifest_path": "data/manifests/the_stack_sample/sample_0072.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Service\nmetadata:\n  name: open5gs-pgw-svc-pool\n  namespace: open5gs\n  labels:\n    epc-mode: pgw\nspec:\n  type: ClusterIP\n  ports:\n  - name: gtpc\n    port: 2123\n    protocol: UDP\n  - name: gtpu\n    port: 2152\n    protocol: UDP\n  - name: gx\n    port: 3868\n    protocol: TCP\n  selector:\n    epc-mode: pgw\n",
    "policy_id": "dangling-service",
    "violation_text": "no pods found matching service labels (map[epc-mode:pgw])"
  },
  {
    "id": "1023",
    "manifest_path": "data/manifests/the_stack_sample/sample_0073.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: mongo\nspec:\n  selector:\n    matchLabels:\n      app: mongo\n  serviceName: mongo\n  replicas: 3\n  template:\n    metadata:\n      labels:\n        app: mongo\n    spec:\n      terminationGracePeriodSeconds: 10\n      containers:\n      - name: mongo\n        image: mongo\n        command:\n        - mongod\n        - --bind_ip_all\n        - --replSet\n        - rs0\n        ports:\n        - containerPort: 27017\n        volumeMounts:\n        - name: mongo-volume\n          mountPath: /data/db\n  volumeClaimTemplates:\n  - metadata:\n      name: mongo-volume\n    spec:\n      accessModes:\n      - ReadWriteOnce\n      resources:\n        requests:\n          storage: 1Gi\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"mongo\" is using an invalid container image, \"mongo\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "1024",
    "manifest_path": "data/manifests/the_stack_sample/sample_0073.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: mongo\nspec:\n  selector:\n    matchLabels:\n      app: mongo\n  serviceName: mongo\n  replicas: 3\n  template:\n    metadata:\n      labels:\n        app: mongo\n    spec:\n      terminationGracePeriodSeconds: 10\n      containers:\n      - name: mongo\n        image: mongo\n        command:\n        - mongod\n        - --bind_ip_all\n        - --replSet\n        - rs0\n        ports:\n        - containerPort: 27017\n        volumeMounts:\n        - name: mongo-volume\n          mountPath: /data/db\n  volumeClaimTemplates:\n  - metadata:\n      name: mongo-volume\n    spec:\n      accessModes:\n      - ReadWriteOnce\n      resources:\n        requests:\n          storage: 1Gi\n",
    "policy_id": "no-anti-affinity",
    "violation_text": "object has 3 replicas but does not specify inter pod anti-affinity"
  },
  {
    "id": "1025",
    "manifest_path": "data/manifests/the_stack_sample/sample_0073.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: mongo\nspec:\n  selector:\n    matchLabels:\n      app: mongo\n  serviceName: mongo\n  replicas: 3\n  template:\n    metadata:\n      labels:\n        app: mongo\n    spec:\n      terminationGracePeriodSeconds: 10\n      containers:\n      - name: mongo\n        image: mongo\n        command:\n        - mongod\n        - --bind_ip_all\n        - --replSet\n        - rs0\n        ports:\n        - containerPort: 27017\n        volumeMounts:\n        - name: mongo-volume\n          mountPath: /data/db\n  volumeClaimTemplates:\n  - metadata:\n      name: mongo-volume\n    spec:\n      accessModes:\n      - ReadWriteOnce\n      resources:\n        requests:\n          storage: 1Gi\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"mongo\" does not have a read-only root file system"
  },
  {
    "id": "1026",
    "manifest_path": "data/manifests/the_stack_sample/sample_0073.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: mongo\nspec:\n  selector:\n    matchLabels:\n      app: mongo\n  serviceName: mongo\n  replicas: 3\n  template:\n    metadata:\n      labels:\n        app: mongo\n    spec:\n      terminationGracePeriodSeconds: 10\n      containers:\n      - name: mongo\n        image: mongo\n        command:\n        - mongod\n        - --bind_ip_all\n        - --replSet\n        - rs0\n        ports:\n        - containerPort: 27017\n        volumeMounts:\n        - name: mongo-volume\n          mountPath: /data/db\n  volumeClaimTemplates:\n  - metadata:\n      name: mongo-volume\n    spec:\n      accessModes:\n      - ReadWriteOnce\n      resources:\n        requests:\n          storage: 1Gi\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"mongo\" is not set to runAsNonRoot"
  },
  {
    "id": "1027",
    "manifest_path": "data/manifests/the_stack_sample/sample_0073.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: mongo\nspec:\n  selector:\n    matchLabels:\n      app: mongo\n  serviceName: mongo\n  replicas: 3\n  template:\n    metadata:\n      labels:\n        app: mongo\n    spec:\n      terminationGracePeriodSeconds: 10\n      containers:\n      - name: mongo\n        image: mongo\n        command:\n        - mongod\n        - --bind_ip_all\n        - --replSet\n        - rs0\n        ports:\n        - containerPort: 27017\n        volumeMounts:\n        - name: mongo-volume\n          mountPath: /data/db\n  volumeClaimTemplates:\n  - metadata:\n      name: mongo-volume\n    spec:\n      accessModes:\n      - ReadWriteOnce\n      resources:\n        requests:\n          storage: 1Gi\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"mongo\" has cpu request 0"
  },
  {
    "id": "1028",
    "manifest_path": "data/manifests/the_stack_sample/sample_0073.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: mongo\nspec:\n  selector:\n    matchLabels:\n      app: mongo\n  serviceName: mongo\n  replicas: 3\n  template:\n    metadata:\n      labels:\n        app: mongo\n    spec:\n      terminationGracePeriodSeconds: 10\n      containers:\n      - name: mongo\n        image: mongo\n        command:\n        - mongod\n        - --bind_ip_all\n        - --replSet\n        - rs0\n        ports:\n        - containerPort: 27017\n        volumeMounts:\n        - name: mongo-volume\n          mountPath: /data/db\n  volumeClaimTemplates:\n  - metadata:\n      name: mongo-volume\n    spec:\n      accessModes:\n      - ReadWriteOnce\n      resources:\n        requests:\n          storage: 1Gi\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"mongo\" has memory limit 0"
  },
  {
    "id": "1029",
    "manifest_path": "data/manifests/the_stack_sample/sample_0077.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Service\nmetadata:\n  labels:\n    k8s-app: node-exporter\n  name: node-exporter\n  namespace: monitoring\nspec:\n  clusterIP: None\n  ports:\n  - name: https\n    port: 9100\n    targetPort: https\n  selector:\n    app: node-exporter\n",
    "policy_id": "dangling-service",
    "violation_text": "no pods found matching service labels (map[app:node-exporter])"
  },
  {
    "id": "1030",
    "manifest_path": "data/manifests/the_stack_sample/sample_0078.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Service\nmetadata:\n  name: payment\n  labels:\n    name: payment\nspec:\n  ports:\n  - port: 80\n    targetPort: 80\n  selector:\n    name: payment\n",
    "policy_id": "dangling-service",
    "violation_text": "no pods found matching service labels (map[name:payment])"
  },
  {
    "id": "1031",
    "manifest_path": "data/manifests/the_stack_sample/sample_0079.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Service\nmetadata:\n  name: qod-api\n  labels:\n    app: qod-api\n    tier: api\nspec:\n  type: ClusterIP\n  ports:\n  - port: 3000\n    targetPort: 3000\n    protocol: TCP\n    name: http\n  selector:\n    app: qod-api\n",
    "policy_id": "dangling-service",
    "violation_text": "no pods found matching service labels (map[app:qod-api])"
  },
  {
    "id": "1032",
    "manifest_path": "data/manifests/the_stack_sample/sample_0080.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: job-04-exec-limit\n  namespace: doit-lab-02-d\n  labels:\n    k8s-app: job-03-exec-limit\n    k8s-scope: gke-ws-doit-lab-02-d\nspec:\n  backoffLimit: 5\n  activeDeadlineSeconds: 20\n  template:\n    metadata:\n      name: job-04-exec-limit-tpl\n    spec:\n      containers:\n      - name: job-04-exec-limit-c\n        image: busybox\n        command:\n        - /bin/sh\n        - -c\n        args:\n        - echo 'just running a (always failing) parallel-consumer job'; sleep 1; exit\n          1;\n      restartPolicy: OnFailure\n",
    "policy_id": "job-ttl-seconds-after-finished",
    "violation_text": "Standalone Job does not specify ttlSecondsAfterFinished"
  },
  {
    "id": "1033",
    "manifest_path": "data/manifests/the_stack_sample/sample_0080.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: job-04-exec-limit\n  namespace: doit-lab-02-d\n  labels:\n    k8s-app: job-03-exec-limit\n    k8s-scope: gke-ws-doit-lab-02-d\nspec:\n  backoffLimit: 5\n  activeDeadlineSeconds: 20\n  template:\n    metadata:\n      name: job-04-exec-limit-tpl\n    spec:\n      containers:\n      - name: job-04-exec-limit-c\n        image: busybox\n        command:\n        - /bin/sh\n        - -c\n        args:\n        - echo 'just running a (always failing) parallel-consumer job'; sleep 1; exit\n          1;\n      restartPolicy: OnFailure\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"job-04-exec-limit-c\" is using an invalid container image, \"busybox\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "1034",
    "manifest_path": "data/manifests/the_stack_sample/sample_0080.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: job-04-exec-limit\n  namespace: doit-lab-02-d\n  labels:\n    k8s-app: job-03-exec-limit\n    k8s-scope: gke-ws-doit-lab-02-d\nspec:\n  backoffLimit: 5\n  activeDeadlineSeconds: 20\n  template:\n    metadata:\n      name: job-04-exec-limit-tpl\n    spec:\n      containers:\n      - name: job-04-exec-limit-c\n        image: busybox\n        command:\n        - /bin/sh\n        - -c\n        args:\n        - echo 'just running a (always failing) parallel-consumer job'; sleep 1; exit\n          1;\n      restartPolicy: OnFailure\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"job-04-exec-limit-c\" does not have a read-only root file system"
  },
  {
    "id": "1035",
    "manifest_path": "data/manifests/the_stack_sample/sample_0080.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: job-04-exec-limit\n  namespace: doit-lab-02-d\n  labels:\n    k8s-app: job-03-exec-limit\n    k8s-scope: gke-ws-doit-lab-02-d\nspec:\n  backoffLimit: 5\n  activeDeadlineSeconds: 20\n  template:\n    metadata:\n      name: job-04-exec-limit-tpl\n    spec:\n      containers:\n      - name: job-04-exec-limit-c\n        image: busybox\n        command:\n        - /bin/sh\n        - -c\n        args:\n        - echo 'just running a (always failing) parallel-consumer job'; sleep 1; exit\n          1;\n      restartPolicy: OnFailure\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"job-04-exec-limit-c\" is not set to runAsNonRoot"
  },
  {
    "id": "1036",
    "manifest_path": "data/manifests/the_stack_sample/sample_0080.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: job-04-exec-limit\n  namespace: doit-lab-02-d\n  labels:\n    k8s-app: job-03-exec-limit\n    k8s-scope: gke-ws-doit-lab-02-d\nspec:\n  backoffLimit: 5\n  activeDeadlineSeconds: 20\n  template:\n    metadata:\n      name: job-04-exec-limit-tpl\n    spec:\n      containers:\n      - name: job-04-exec-limit-c\n        image: busybox\n        command:\n        - /bin/sh\n        - -c\n        args:\n        - echo 'just running a (always failing) parallel-consumer job'; sleep 1; exit\n          1;\n      restartPolicy: OnFailure\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"job-04-exec-limit-c\" has cpu request 0"
  },
  {
    "id": "1037",
    "manifest_path": "data/manifests/the_stack_sample/sample_0080.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: job-04-exec-limit\n  namespace: doit-lab-02-d\n  labels:\n    k8s-app: job-03-exec-limit\n    k8s-scope: gke-ws-doit-lab-02-d\nspec:\n  backoffLimit: 5\n  activeDeadlineSeconds: 20\n  template:\n    metadata:\n      name: job-04-exec-limit-tpl\n    spec:\n      containers:\n      - name: job-04-exec-limit-c\n        image: busybox\n        command:\n        - /bin/sh\n        - -c\n        args:\n        - echo 'just running a (always failing) parallel-consumer job'; sleep 1; exit\n          1;\n      restartPolicy: OnFailure\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"job-04-exec-limit-c\" has memory limit 0"
  },
  {
    "id": "1038",
    "manifest_path": "data/manifests/the_stack_sample/sample_0082.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-984\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"nginx\" is using an invalid container image, \"nginx\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "1039",
    "manifest_path": "data/manifests/the_stack_sample/sample_0082.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-984\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"nginx\" does not have a read-only root file system"
  },
  {
    "id": "1040",
    "manifest_path": "data/manifests/the_stack_sample/sample_0082.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-984\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"nginx\" is not set to runAsNonRoot"
  },
  {
    "id": "1041",
    "manifest_path": "data/manifests/the_stack_sample/sample_0082.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-984\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"nginx\" has cpu request 0"
  },
  {
    "id": "1042",
    "manifest_path": "data/manifests/the_stack_sample/sample_0082.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-984\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"nginx\" has memory limit 0"
  },
  {
    "id": "1043",
    "manifest_path": "data/manifests/the_stack_sample/sample_0083.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Service\nmetadata:\n  labels:\n    app.kubernetes.io/component: observability\n    app.kubernetes.io/instance: parca\n    app.kubernetes.io/name: parca\n    app.kubernetes.io/version: v0.7.1\n  name: parca\n  namespace: parca\nspec:\n  ports:\n  - name: http\n    port: 7070\n    targetPort: 7070\n  selector:\n    app.kubernetes.io/component: observability\n    app.kubernetes.io/instance: parca\n    app.kubernetes.io/name: parca\n",
    "policy_id": "dangling-service",
    "violation_text": "no pods found matching service labels (map[app.kubernetes.io/component:observability app.kubernetes.io/instance:parca app.kubernetes.io/name:parca])"
  },
  {
    "id": "1044",
    "manifest_path": "data/manifests/the_stack_sample/sample_0084.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: order\n  labels:\n    app: order\n    tier: frontend\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: order\n      tier: frontend\n  template:\n    metadata:\n      labels:\n        app: order\n        tier: frontend\n    spec:\n      containers:\n      - name: order\n        image: aankitatiwari24/air-pg:order\n        ports:\n        - containerPort: 5000\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"order\" does not have a read-only root file system"
  },
  {
    "id": "1045",
    "manifest_path": "data/manifests/the_stack_sample/sample_0084.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: order\n  labels:\n    app: order\n    tier: frontend\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: order\n      tier: frontend\n  template:\n    metadata:\n      labels:\n        app: order\n        tier: frontend\n    spec:\n      containers:\n      - name: order\n        image: aankitatiwari24/air-pg:order\n        ports:\n        - containerPort: 5000\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"order\" is not set to runAsNonRoot"
  },
  {
    "id": "1046",
    "manifest_path": "data/manifests/the_stack_sample/sample_0084.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: order\n  labels:\n    app: order\n    tier: frontend\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: order\n      tier: frontend\n  template:\n    metadata:\n      labels:\n        app: order\n        tier: frontend\n    spec:\n      containers:\n      - name: order\n        image: aankitatiwari24/air-pg:order\n        ports:\n        - containerPort: 5000\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"order\" has cpu request 0"
  },
  {
    "id": "1047",
    "manifest_path": "data/manifests/the_stack_sample/sample_0084.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: order\n  labels:\n    app: order\n    tier: frontend\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: order\n      tier: frontend\n  template:\n    metadata:\n      labels:\n        app: order\n        tier: frontend\n    spec:\n      containers:\n      - name: order\n        image: aankitatiwari24/air-pg:order\n        ports:\n        - containerPort: 5000\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"order\" has memory limit 0"
  },
  {
    "id": "1048",
    "manifest_path": "data/manifests/the_stack_sample/sample_0085.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: gateway-controller\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: gateway-controller\n  template:\n    metadata:\n      labels:\n        app: gateway-controller\n    spec:\n      serviceAccountName: argo-events-sa\n      containers:\n      - name: gateway-controller\n        image: argoproj/gateway-controller:v0.10-test\n        imagePullPolicy: Always\n        env:\n        - name: GATEWAY_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: GATEWAY_CONTROLLER_CONFIG_MAP\n          value: gateway-controller-configmap\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"gateway-controller\" does not have a read-only root file system"
  },
  {
    "id": "1049",
    "manifest_path": "data/manifests/the_stack_sample/sample_0085.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: gateway-controller\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: gateway-controller\n  template:\n    metadata:\n      labels:\n        app: gateway-controller\n    spec:\n      serviceAccountName: argo-events-sa\n      containers:\n      - name: gateway-controller\n        image: argoproj/gateway-controller:v0.10-test\n        imagePullPolicy: Always\n        env:\n        - name: GATEWAY_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: GATEWAY_CONTROLLER_CONFIG_MAP\n          value: gateway-controller-configmap\n",
    "policy_id": "non-existent-service-account",
    "violation_text": "serviceAccount \"argo-events-sa\" not found"
  },
  {
    "id": "1050",
    "manifest_path": "data/manifests/the_stack_sample/sample_0085.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: gateway-controller\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: gateway-controller\n  template:\n    metadata:\n      labels:\n        app: gateway-controller\n    spec:\n      serviceAccountName: argo-events-sa\n      containers:\n      - name: gateway-controller\n        image: argoproj/gateway-controller:v0.10-test\n        imagePullPolicy: Always\n        env:\n        - name: GATEWAY_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: GATEWAY_CONTROLLER_CONFIG_MAP\n          value: gateway-controller-configmap\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"gateway-controller\" is not set to runAsNonRoot"
  },
  {
    "id": "1051",
    "manifest_path": "data/manifests/the_stack_sample/sample_0085.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: gateway-controller\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: gateway-controller\n  template:\n    metadata:\n      labels:\n        app: gateway-controller\n    spec:\n      serviceAccountName: argo-events-sa\n      containers:\n      - name: gateway-controller\n        image: argoproj/gateway-controller:v0.10-test\n        imagePullPolicy: Always\n        env:\n        - name: GATEWAY_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: GATEWAY_CONTROLLER_CONFIG_MAP\n          value: gateway-controller-configmap\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"gateway-controller\" has cpu request 0"
  },
  {
    "id": "1052",
    "manifest_path": "data/manifests/the_stack_sample/sample_0085.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: gateway-controller\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: gateway-controller\n  template:\n    metadata:\n      labels:\n        app: gateway-controller\n    spec:\n      serviceAccountName: argo-events-sa\n      containers:\n      - name: gateway-controller\n        image: argoproj/gateway-controller:v0.10-test\n        imagePullPolicy: Always\n        env:\n        - name: GATEWAY_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: GATEWAY_CONTROLLER_CONFIG_MAP\n          value: gateway-controller-configmap\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"gateway-controller\" has memory limit 0"
  },
  {
    "id": "1053",
    "manifest_path": "data/manifests/the_stack_sample/sample_0087.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: frontend\nspec:\n  selector:\n    matchLabels:\n      app: frontend\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: frontend\n    spec:\n      containers:\n      - name: server\n        ports:\n        - containerPort: 8080\n        image: gcr.io/wise-coyote-827/frontend-server\n        env:\n        - name: BACKEND_SERVICE_ADDR\n          value: backend-internal:8080\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"server\" is using an invalid container image, \"gcr.io/wise-coyote-827/frontend-server\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "1054",
    "manifest_path": "data/manifests/the_stack_sample/sample_0087.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: frontend\nspec:\n  selector:\n    matchLabels:\n      app: frontend\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: frontend\n    spec:\n      containers:\n      - name: server\n        ports:\n        - containerPort: 8080\n        image: gcr.io/wise-coyote-827/frontend-server\n        env:\n        - name: BACKEND_SERVICE_ADDR\n          value: backend-internal:8080\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"server\" does not have a read-only root file system"
  },
  {
    "id": "1055",
    "manifest_path": "data/manifests/the_stack_sample/sample_0087.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: frontend\nspec:\n  selector:\n    matchLabels:\n      app: frontend\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: frontend\n    spec:\n      containers:\n      - name: server\n        ports:\n        - containerPort: 8080\n        image: gcr.io/wise-coyote-827/frontend-server\n        env:\n        - name: BACKEND_SERVICE_ADDR\n          value: backend-internal:8080\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"server\" is not set to runAsNonRoot"
  },
  {
    "id": "1056",
    "manifest_path": "data/manifests/the_stack_sample/sample_0087.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: frontend\nspec:\n  selector:\n    matchLabels:\n      app: frontend\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: frontend\n    spec:\n      containers:\n      - name: server\n        ports:\n        - containerPort: 8080\n        image: gcr.io/wise-coyote-827/frontend-server\n        env:\n        - name: BACKEND_SERVICE_ADDR\n          value: backend-internal:8080\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"server\" has cpu request 0"
  },
  {
    "id": "1057",
    "manifest_path": "data/manifests/the_stack_sample/sample_0087.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: frontend\nspec:\n  selector:\n    matchLabels:\n      app: frontend\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: frontend\n    spec:\n      containers:\n      - name: server\n        ports:\n        - containerPort: 8080\n        image: gcr.io/wise-coyote-827/frontend-server\n        env:\n        - name: BACKEND_SERVICE_ADDR\n          value: backend-internal:8080\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"server\" has memory limit 0"
  },
  {
    "id": "1058",
    "manifest_path": "data/manifests/the_stack_sample/sample_0088.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: lighthouse-keeper\n  labels:\n    chart: lighthouse-1.3.0\n    app: lighthouse-keeper\n    gitops.jenkins-x.io/pipeline: namespaces\n  annotations:\n    meta.helm.sh/release-name: lighthouse\n    wave.pusher.com/update-on-config-change: 'true'\n  namespace: jx\nspec:\n  replicas: 1\n  strategy:\n    type: RollingUpdate\n    rollingUpdate:\n      maxSurge: 1\n      maxUnavailable: 1\n  selector:\n    matchLabels:\n      app: lighthouse-keeper\n  template:\n    metadata:\n      annotations:\n        ad.datadoghq.com/keeper.logs: '[{\"source\":\"lighthouse\",\"service\":\"keeper\"}]'\n        prometheus.io/port: '9090'\n        prometheus.io/scrape: 'true'\n        jenkins-x.io/hash: efaf2824743f262428efac87b577e83419a9d9c1f7600f4815a09c7177935a0a\n      labels:\n        app: lighthouse-keeper\n    spec:\n      serviceAccountName: lighthouse-keeper\n      terminationGracePeriodSeconds: 30\n      containers:\n      - name: lighthouse-keeper\n        image: ghcr.io/jenkins-x/lighthouse-keeper:1.3.0\n        imagePullPolicy: IfNotPresent\n        args:\n        - --namespace=jx\n        ports:\n        - name: http\n          containerPort: 8888\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /\n            port: http\n          initialDelaySeconds: 120\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        readinessProbe:\n          httpGet:\n            path: /\n            port: http\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        env:\n        - name: GIT_KIND\n          value: github\n        - name: GIT_SERVER\n          value: https://github.com\n        - name: GIT_USER\n          value: demonccc\n        - name: GIT_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: lighthouse-oauth-token\n              key: oauth\n        - name: JX_LOG_FORMAT\n          value: json\n        - name: LOGRUS_FORMAT\n          value: json\n        - name: LOGRUS_SERVICE\n          value: lighthouse\n        - name: LOGRUS_SERVICE_VERSION\n          value: 1.3.0\n        - name: LOGRUS_STACK_SKIP\n          value: ''\n        - name: LIGHTHOUSE_KEEPER_STATUS_CONTEXT_LABEL\n          value: Lighthouse Merge Status\n        - name: LIGHTHOUSE_TRIGGER_ON_MISSING\n          value: enable\n        envFrom:\n        - secretRef:\n            name: jx-boot-job-env-vars\n            optional: true\n        resources:\n          limits:\n            cpu: 400m\n            memory: 512Mi\n          requests:\n            cpu: 100m\n            memory: 128Mi\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"lighthouse-keeper\" does not have a read-only root file system"
  },
  {
    "id": "1059",
    "manifest_path": "data/manifests/the_stack_sample/sample_0088.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: lighthouse-keeper\n  labels:\n    chart: lighthouse-1.3.0\n    app: lighthouse-keeper\n    gitops.jenkins-x.io/pipeline: namespaces\n  annotations:\n    meta.helm.sh/release-name: lighthouse\n    wave.pusher.com/update-on-config-change: 'true'\n  namespace: jx\nspec:\n  replicas: 1\n  strategy:\n    type: RollingUpdate\n    rollingUpdate:\n      maxSurge: 1\n      maxUnavailable: 1\n  selector:\n    matchLabels:\n      app: lighthouse-keeper\n  template:\n    metadata:\n      annotations:\n        ad.datadoghq.com/keeper.logs: '[{\"source\":\"lighthouse\",\"service\":\"keeper\"}]'\n        prometheus.io/port: '9090'\n        prometheus.io/scrape: 'true'\n        jenkins-x.io/hash: efaf2824743f262428efac87b577e83419a9d9c1f7600f4815a09c7177935a0a\n      labels:\n        app: lighthouse-keeper\n    spec:\n      serviceAccountName: lighthouse-keeper\n      terminationGracePeriodSeconds: 30\n      containers:\n      - name: lighthouse-keeper\n        image: ghcr.io/jenkins-x/lighthouse-keeper:1.3.0\n        imagePullPolicy: IfNotPresent\n        args:\n        - --namespace=jx\n        ports:\n        - name: http\n          containerPort: 8888\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /\n            port: http\n          initialDelaySeconds: 120\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        readinessProbe:\n          httpGet:\n            path: /\n            port: http\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        env:\n        - name: GIT_KIND\n          value: github\n        - name: GIT_SERVER\n          value: https://github.com\n        - name: GIT_USER\n          value: demonccc\n        - name: GIT_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: lighthouse-oauth-token\n              key: oauth\n        - name: JX_LOG_FORMAT\n          value: json\n        - name: LOGRUS_FORMAT\n          value: json\n        - name: LOGRUS_SERVICE\n          value: lighthouse\n        - name: LOGRUS_SERVICE_VERSION\n          value: 1.3.0\n        - name: LOGRUS_STACK_SKIP\n          value: ''\n        - name: LIGHTHOUSE_KEEPER_STATUS_CONTEXT_LABEL\n          value: Lighthouse Merge Status\n        - name: LIGHTHOUSE_TRIGGER_ON_MISSING\n          value: enable\n        envFrom:\n        - secretRef:\n            name: jx-boot-job-env-vars\n            optional: true\n        resources:\n          limits:\n            cpu: 400m\n            memory: 512Mi\n          requests:\n            cpu: 100m\n            memory: 128Mi\n",
    "policy_id": "non-existent-service-account",
    "violation_text": "serviceAccount \"lighthouse-keeper\" not found"
  },
  {
    "id": "1060",
    "manifest_path": "data/manifests/the_stack_sample/sample_0088.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: lighthouse-keeper\n  labels:\n    chart: lighthouse-1.3.0\n    app: lighthouse-keeper\n    gitops.jenkins-x.io/pipeline: namespaces\n  annotations:\n    meta.helm.sh/release-name: lighthouse\n    wave.pusher.com/update-on-config-change: 'true'\n  namespace: jx\nspec:\n  replicas: 1\n  strategy:\n    type: RollingUpdate\n    rollingUpdate:\n      maxSurge: 1\n      maxUnavailable: 1\n  selector:\n    matchLabels:\n      app: lighthouse-keeper\n  template:\n    metadata:\n      annotations:\n        ad.datadoghq.com/keeper.logs: '[{\"source\":\"lighthouse\",\"service\":\"keeper\"}]'\n        prometheus.io/port: '9090'\n        prometheus.io/scrape: 'true'\n        jenkins-x.io/hash: efaf2824743f262428efac87b577e83419a9d9c1f7600f4815a09c7177935a0a\n      labels:\n        app: lighthouse-keeper\n    spec:\n      serviceAccountName: lighthouse-keeper\n      terminationGracePeriodSeconds: 30\n      containers:\n      - name: lighthouse-keeper\n        image: ghcr.io/jenkins-x/lighthouse-keeper:1.3.0\n        imagePullPolicy: IfNotPresent\n        args:\n        - --namespace=jx\n        ports:\n        - name: http\n          containerPort: 8888\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /\n            port: http\n          initialDelaySeconds: 120\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        readinessProbe:\n          httpGet:\n            path: /\n            port: http\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        env:\n        - name: GIT_KIND\n          value: github\n        - name: GIT_SERVER\n          value: https://github.com\n        - name: GIT_USER\n          value: demonccc\n        - name: GIT_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: lighthouse-oauth-token\n              key: oauth\n        - name: JX_LOG_FORMAT\n          value: json\n        - name: LOGRUS_FORMAT\n          value: json\n        - name: LOGRUS_SERVICE\n          value: lighthouse\n        - name: LOGRUS_SERVICE_VERSION\n          value: 1.3.0\n        - name: LOGRUS_STACK_SKIP\n          value: ''\n        - name: LIGHTHOUSE_KEEPER_STATUS_CONTEXT_LABEL\n          value: Lighthouse Merge Status\n        - name: LIGHTHOUSE_TRIGGER_ON_MISSING\n          value: enable\n        envFrom:\n        - secretRef:\n            name: jx-boot-job-env-vars\n            optional: true\n        resources:\n          limits:\n            cpu: 400m\n            memory: 512Mi\n          requests:\n            cpu: 100m\n            memory: 128Mi\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"lighthouse-keeper\" is not set to runAsNonRoot"
  },
  {
    "id": "1061",
    "manifest_path": "data/manifests/the_stack_sample/sample_0089.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Service\nmetadata:\n  name: radarr\nspec:\n  ports:\n  - name: http\n    protocol: TCP\n    targetPort: http\n    port: 80\n  type: ClusterIP\n",
    "policy_id": "dangling-service",
    "violation_text": "service has no selector specified"
  },
  {
    "id": "1062",
    "manifest_path": "data/manifests/the_stack_sample/sample_0093.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: metabase\n  namespace: metabase\nspec:\n  selector:\n    matchLabels:\n      app: metabase\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: metabase\n    spec:\n      containers:\n      - name: metabase\n        image: metabase/metabase:v0.30.3\n        env:\n        - name: MB_DB_TYPE\n          value: mysql\n        - name: MB_DB_DBNAME\n          valueFrom:\n            secretKeyRef:\n              name: metabase-db\n              key: dbname\n        - name: MB_DB_PORT\n          valueFrom:\n            secretKeyRef:\n              name: metabase-db\n              key: port\n        - name: MB_DB_USER\n          valueFrom:\n            secretKeyRef:\n              name: metabase-db\n              key: user\n        - name: MB_DB_PASS\n          valueFrom:\n            secretKeyRef:\n              name: metabase-db\n              key: pass\n        - name: MB_DB_HOST\n          valueFrom:\n            secretKeyRef:\n              name: metabase-db\n              key: host\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"metabase\" does not have a read-only root file system"
  },
  {
    "id": "1063",
    "manifest_path": "data/manifests/the_stack_sample/sample_0093.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: metabase\n  namespace: metabase\nspec:\n  selector:\n    matchLabels:\n      app: metabase\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: metabase\n    spec:\n      containers:\n      - name: metabase\n        image: metabase/metabase:v0.30.3\n        env:\n        - name: MB_DB_TYPE\n          value: mysql\n        - name: MB_DB_DBNAME\n          valueFrom:\n            secretKeyRef:\n              name: metabase-db\n              key: dbname\n        - name: MB_DB_PORT\n          valueFrom:\n            secretKeyRef:\n              name: metabase-db\n              key: port\n        - name: MB_DB_USER\n          valueFrom:\n            secretKeyRef:\n              name: metabase-db\n              key: user\n        - name: MB_DB_PASS\n          valueFrom:\n            secretKeyRef:\n              name: metabase-db\n              key: pass\n        - name: MB_DB_HOST\n          valueFrom:\n            secretKeyRef:\n              name: metabase-db\n              key: host\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"metabase\" is not set to runAsNonRoot"
  },
  {
    "id": "1064",
    "manifest_path": "data/manifests/the_stack_sample/sample_0093.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: metabase\n  namespace: metabase\nspec:\n  selector:\n    matchLabels:\n      app: metabase\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: metabase\n    spec:\n      containers:\n      - name: metabase\n        image: metabase/metabase:v0.30.3\n        env:\n        - name: MB_DB_TYPE\n          value: mysql\n        - name: MB_DB_DBNAME\n          valueFrom:\n            secretKeyRef:\n              name: metabase-db\n              key: dbname\n        - name: MB_DB_PORT\n          valueFrom:\n            secretKeyRef:\n              name: metabase-db\n              key: port\n        - name: MB_DB_USER\n          valueFrom:\n            secretKeyRef:\n              name: metabase-db\n              key: user\n        - name: MB_DB_PASS\n          valueFrom:\n            secretKeyRef:\n              name: metabase-db\n              key: pass\n        - name: MB_DB_HOST\n          valueFrom:\n            secretKeyRef:\n              name: metabase-db\n              key: host\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"metabase\" has cpu request 0"
  },
  {
    "id": "1065",
    "manifest_path": "data/manifests/the_stack_sample/sample_0093.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: metabase\n  namespace: metabase\nspec:\n  selector:\n    matchLabels:\n      app: metabase\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: metabase\n    spec:\n      containers:\n      - name: metabase\n        image: metabase/metabase:v0.30.3\n        env:\n        - name: MB_DB_TYPE\n          value: mysql\n        - name: MB_DB_DBNAME\n          valueFrom:\n            secretKeyRef:\n              name: metabase-db\n              key: dbname\n        - name: MB_DB_PORT\n          valueFrom:\n            secretKeyRef:\n              name: metabase-db\n              key: port\n        - name: MB_DB_USER\n          valueFrom:\n            secretKeyRef:\n              name: metabase-db\n              key: user\n        - name: MB_DB_PASS\n          valueFrom:\n            secretKeyRef:\n              name: metabase-db\n              key: pass\n        - name: MB_DB_HOST\n          valueFrom:\n            secretKeyRef:\n              name: metabase-db\n              key: host\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"metabase\" has memory limit 0"
  },
  {
    "id": "1066",
    "manifest_path": "data/manifests/the_stack_sample/sample_0094.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: netbox\n  namespace: netbox-community\n  labels:\n    k8s-app: netbox\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      k8s-app: netbox\n  template:\n    metadata:\n      labels:\n        k8s-app: netbox\n    spec:\n      containers:\n      - name: netbox\n        image: quay.io/netboxcommunity/netbox:v2.11.12-ldap\n        ports:\n        - name: http\n          containerPort: 8080\n        readinessProbe:\n          httpGet:\n            path: /\n            port: http\n          initialDelaySeconds: 5\n          periodSeconds: 20\n        envFrom:\n        - configMapRef:\n            name: netbox-configmap\n        lifecycle:\n          postStart:\n            exec:\n              command:\n              - /bin/sh\n              - -c\n              - 'bash /home/install-plugins.sh && bash /home/start-rqworker.sh &&\n                bash /home/nginx-caching-fix.sh\n\n                '\n        volumeMounts:\n        - name: auth-ldap-bind-password\n          mountPath: /run/secrets/auth_ldap_bind_password\n          subPath: auth_ldap_bind_password\n          readOnly: true\n        - name: db-password\n          mountPath: /run/secrets/db_password\n          subPath: db_password\n          readOnly: true\n        - name: email-password\n          mountPath: /run/secrets/email_password\n          subPath: email_password\n          readOnly: true\n        - name: napalm-password\n          mountPath: /run/secrets/napalm_password\n          subPath: napalm_password\n          readOnly: true\n        - name: redis-password\n          mountPath: /run/secrets/redis_password\n          subPath: redis_password\n        - name: secret-key\n          mountPath: /run/secrets/secret_key\n          subPath: secret_key\n          readOnly: true\n        - name: superuser-api-token\n          mountPath: /run/secrets/superuser_api_token\n          subPath: superuser_api_token\n        - name: superuser-password\n          mountPath: /run/secrets/superuser_password\n          subPath: superuser_password\n          readOnly: true\n        - name: netbox-media-files\n          mountPath: /opt/netbox/netbox/media\n        - name: ldap-config\n          subPath: ldap_config.py\n          mountPath: /opt/netbox/netbox/netbox/ldap_config.py\n        - mountPath: /etc/netbox/config/netbox-plugins.py\n          name: netbox-plugins\n          subPath: netbox-plugins.py\n        - mountPath: /home/install-plugins.sh\n          name: install-plugins\n          subPath: install-plugins.sh\n        - mountPath: /home/start-rqworker.sh\n          name: start-rqworker\n          subPath: start-rqworker.sh\n        - mountPath: /home/nginx-caching-fix.sh\n          name: nginx-caching-fix\n          subPath: nginx-caching-fix.sh\n        - name: sso-saml2-xml\n          mountPath: /opt/netbox/sso-saml2.xml\n          subPath: sso-saml2-metadata.xml\n      restartPolicy: Always\n      volumes:\n      - name: netbox-media-files\n        persistentVolumeClaim:\n          claimName: netbox-media-pvc\n          readOnly: false\n      - name: ldap-config\n        configMap:\n          name: netbox-configmap\n          items:\n          - key: ldap_config.py\n            path: ldap_config.py\n      - name: netbox-plugins\n        configMap:\n          name: startup-configmap\n          items:\n          - key: netbox-plugins.py\n            path: netbox-plugins.py\n      - name: install-plugins\n        configMap:\n          name: startup-configmap\n          items:\n          - key: install-plugins.sh\n            path: install-plugins.sh\n      - name: start-rqworker\n        configMap:\n          name: startup-configmap\n          items:\n          - key: start-rqworker.sh\n            path: start-rqworker.sh\n      - name: nginx-caching-fix\n        configMap:\n          name: startup-configmap\n          items:\n          - key: nginx-caching-fix.sh\n            path: nginx-caching-fix.sh\n      - name: sso-saml2-xml\n        configMap:\n          name: sso-saml2-xml\n          items:\n          - key: sso-saml2-metadata.xml\n            path: sso-saml2-metadata.xml\n      - name: auth-ldap-bind-password\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: auth_ldap_bind_password\n            path: auth_ldap_bind_password\n      - name: db-password\n        secret:\n          secretName: netbox-postgresql\n          items:\n          - key: password\n            path: db_password\n      - name: email-password\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: email_password\n            path: email_password\n      - name: napalm-password\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: napalm_password\n            path: napalm_password\n      - name: redis-password\n        secret:\n          secretName: netbox-redis\n          items:\n          - key: redis-password\n            path: redis_password\n      - name: secret-key\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: secret_key\n            path: secret_key\n      - name: superuser-password\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: superuser_password\n            path: superuser_password\n      - name: superuser-api-token\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: superuser_api_token\n            path: superuser_api_token\n",
    "policy_id": "no-anti-affinity",
    "violation_text": "object has 3 replicas but does not specify inter pod anti-affinity"
  },
  {
    "id": "1067",
    "manifest_path": "data/manifests/the_stack_sample/sample_0094.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: netbox\n  namespace: netbox-community\n  labels:\n    k8s-app: netbox\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      k8s-app: netbox\n  template:\n    metadata:\n      labels:\n        k8s-app: netbox\n    spec:\n      containers:\n      - name: netbox\n        image: quay.io/netboxcommunity/netbox:v2.11.12-ldap\n        ports:\n        - name: http\n          containerPort: 8080\n        readinessProbe:\n          httpGet:\n            path: /\n            port: http\n          initialDelaySeconds: 5\n          periodSeconds: 20\n        envFrom:\n        - configMapRef:\n            name: netbox-configmap\n        lifecycle:\n          postStart:\n            exec:\n              command:\n              - /bin/sh\n              - -c\n              - 'bash /home/install-plugins.sh && bash /home/start-rqworker.sh &&\n                bash /home/nginx-caching-fix.sh\n\n                '\n        volumeMounts:\n        - name: auth-ldap-bind-password\n          mountPath: /run/secrets/auth_ldap_bind_password\n          subPath: auth_ldap_bind_password\n          readOnly: true\n        - name: db-password\n          mountPath: /run/secrets/db_password\n          subPath: db_password\n          readOnly: true\n        - name: email-password\n          mountPath: /run/secrets/email_password\n          subPath: email_password\n          readOnly: true\n        - name: napalm-password\n          mountPath: /run/secrets/napalm_password\n          subPath: napalm_password\n          readOnly: true\n        - name: redis-password\n          mountPath: /run/secrets/redis_password\n          subPath: redis_password\n        - name: secret-key\n          mountPath: /run/secrets/secret_key\n          subPath: secret_key\n          readOnly: true\n        - name: superuser-api-token\n          mountPath: /run/secrets/superuser_api_token\n          subPath: superuser_api_token\n        - name: superuser-password\n          mountPath: /run/secrets/superuser_password\n          subPath: superuser_password\n          readOnly: true\n        - name: netbox-media-files\n          mountPath: /opt/netbox/netbox/media\n        - name: ldap-config\n          subPath: ldap_config.py\n          mountPath: /opt/netbox/netbox/netbox/ldap_config.py\n        - mountPath: /etc/netbox/config/netbox-plugins.py\n          name: netbox-plugins\n          subPath: netbox-plugins.py\n        - mountPath: /home/install-plugins.sh\n          name: install-plugins\n          subPath: install-plugins.sh\n        - mountPath: /home/start-rqworker.sh\n          name: start-rqworker\n          subPath: start-rqworker.sh\n        - mountPath: /home/nginx-caching-fix.sh\n          name: nginx-caching-fix\n          subPath: nginx-caching-fix.sh\n        - name: sso-saml2-xml\n          mountPath: /opt/netbox/sso-saml2.xml\n          subPath: sso-saml2-metadata.xml\n      restartPolicy: Always\n      volumes:\n      - name: netbox-media-files\n        persistentVolumeClaim:\n          claimName: netbox-media-pvc\n          readOnly: false\n      - name: ldap-config\n        configMap:\n          name: netbox-configmap\n          items:\n          - key: ldap_config.py\n            path: ldap_config.py\n      - name: netbox-plugins\n        configMap:\n          name: startup-configmap\n          items:\n          - key: netbox-plugins.py\n            path: netbox-plugins.py\n      - name: install-plugins\n        configMap:\n          name: startup-configmap\n          items:\n          - key: install-plugins.sh\n            path: install-plugins.sh\n      - name: start-rqworker\n        configMap:\n          name: startup-configmap\n          items:\n          - key: start-rqworker.sh\n            path: start-rqworker.sh\n      - name: nginx-caching-fix\n        configMap:\n          name: startup-configmap\n          items:\n          - key: nginx-caching-fix.sh\n            path: nginx-caching-fix.sh\n      - name: sso-saml2-xml\n        configMap:\n          name: sso-saml2-xml\n          items:\n          - key: sso-saml2-metadata.xml\n            path: sso-saml2-metadata.xml\n      - name: auth-ldap-bind-password\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: auth_ldap_bind_password\n            path: auth_ldap_bind_password\n      - name: db-password\n        secret:\n          secretName: netbox-postgresql\n          items:\n          - key: password\n            path: db_password\n      - name: email-password\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: email_password\n            path: email_password\n      - name: napalm-password\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: napalm_password\n            path: napalm_password\n      - name: redis-password\n        secret:\n          secretName: netbox-redis\n          items:\n          - key: redis-password\n            path: redis_password\n      - name: secret-key\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: secret_key\n            path: secret_key\n      - name: superuser-password\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: superuser_password\n            path: superuser_password\n      - name: superuser-api-token\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: superuser_api_token\n            path: superuser_api_token\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"netbox\" does not have a read-only root file system"
  },
  {
    "id": "1068",
    "manifest_path": "data/manifests/the_stack_sample/sample_0094.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: netbox\n  namespace: netbox-community\n  labels:\n    k8s-app: netbox\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      k8s-app: netbox\n  template:\n    metadata:\n      labels:\n        k8s-app: netbox\n    spec:\n      containers:\n      - name: netbox\n        image: quay.io/netboxcommunity/netbox:v2.11.12-ldap\n        ports:\n        - name: http\n          containerPort: 8080\n        readinessProbe:\n          httpGet:\n            path: /\n            port: http\n          initialDelaySeconds: 5\n          periodSeconds: 20\n        envFrom:\n        - configMapRef:\n            name: netbox-configmap\n        lifecycle:\n          postStart:\n            exec:\n              command:\n              - /bin/sh\n              - -c\n              - 'bash /home/install-plugins.sh && bash /home/start-rqworker.sh &&\n                bash /home/nginx-caching-fix.sh\n\n                '\n        volumeMounts:\n        - name: auth-ldap-bind-password\n          mountPath: /run/secrets/auth_ldap_bind_password\n          subPath: auth_ldap_bind_password\n          readOnly: true\n        - name: db-password\n          mountPath: /run/secrets/db_password\n          subPath: db_password\n          readOnly: true\n        - name: email-password\n          mountPath: /run/secrets/email_password\n          subPath: email_password\n          readOnly: true\n        - name: napalm-password\n          mountPath: /run/secrets/napalm_password\n          subPath: napalm_password\n          readOnly: true\n        - name: redis-password\n          mountPath: /run/secrets/redis_password\n          subPath: redis_password\n        - name: secret-key\n          mountPath: /run/secrets/secret_key\n          subPath: secret_key\n          readOnly: true\n        - name: superuser-api-token\n          mountPath: /run/secrets/superuser_api_token\n          subPath: superuser_api_token\n        - name: superuser-password\n          mountPath: /run/secrets/superuser_password\n          subPath: superuser_password\n          readOnly: true\n        - name: netbox-media-files\n          mountPath: /opt/netbox/netbox/media\n        - name: ldap-config\n          subPath: ldap_config.py\n          mountPath: /opt/netbox/netbox/netbox/ldap_config.py\n        - mountPath: /etc/netbox/config/netbox-plugins.py\n          name: netbox-plugins\n          subPath: netbox-plugins.py\n        - mountPath: /home/install-plugins.sh\n          name: install-plugins\n          subPath: install-plugins.sh\n        - mountPath: /home/start-rqworker.sh\n          name: start-rqworker\n          subPath: start-rqworker.sh\n        - mountPath: /home/nginx-caching-fix.sh\n          name: nginx-caching-fix\n          subPath: nginx-caching-fix.sh\n        - name: sso-saml2-xml\n          mountPath: /opt/netbox/sso-saml2.xml\n          subPath: sso-saml2-metadata.xml\n      restartPolicy: Always\n      volumes:\n      - name: netbox-media-files\n        persistentVolumeClaim:\n          claimName: netbox-media-pvc\n          readOnly: false\n      - name: ldap-config\n        configMap:\n          name: netbox-configmap\n          items:\n          - key: ldap_config.py\n            path: ldap_config.py\n      - name: netbox-plugins\n        configMap:\n          name: startup-configmap\n          items:\n          - key: netbox-plugins.py\n            path: netbox-plugins.py\n      - name: install-plugins\n        configMap:\n          name: startup-configmap\n          items:\n          - key: install-plugins.sh\n            path: install-plugins.sh\n      - name: start-rqworker\n        configMap:\n          name: startup-configmap\n          items:\n          - key: start-rqworker.sh\n            path: start-rqworker.sh\n      - name: nginx-caching-fix\n        configMap:\n          name: startup-configmap\n          items:\n          - key: nginx-caching-fix.sh\n            path: nginx-caching-fix.sh\n      - name: sso-saml2-xml\n        configMap:\n          name: sso-saml2-xml\n          items:\n          - key: sso-saml2-metadata.xml\n            path: sso-saml2-metadata.xml\n      - name: auth-ldap-bind-password\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: auth_ldap_bind_password\n            path: auth_ldap_bind_password\n      - name: db-password\n        secret:\n          secretName: netbox-postgresql\n          items:\n          - key: password\n            path: db_password\n      - name: email-password\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: email_password\n            path: email_password\n      - name: napalm-password\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: napalm_password\n            path: napalm_password\n      - name: redis-password\n        secret:\n          secretName: netbox-redis\n          items:\n          - key: redis-password\n            path: redis_password\n      - name: secret-key\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: secret_key\n            path: secret_key\n      - name: superuser-password\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: superuser_password\n            path: superuser_password\n      - name: superuser-api-token\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: superuser_api_token\n            path: superuser_api_token\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"netbox\" is not set to runAsNonRoot"
  },
  {
    "id": "1069",
    "manifest_path": "data/manifests/the_stack_sample/sample_0094.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: netbox\n  namespace: netbox-community\n  labels:\n    k8s-app: netbox\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      k8s-app: netbox\n  template:\n    metadata:\n      labels:\n        k8s-app: netbox\n    spec:\n      containers:\n      - name: netbox\n        image: quay.io/netboxcommunity/netbox:v2.11.12-ldap\n        ports:\n        - name: http\n          containerPort: 8080\n        readinessProbe:\n          httpGet:\n            path: /\n            port: http\n          initialDelaySeconds: 5\n          periodSeconds: 20\n        envFrom:\n        - configMapRef:\n            name: netbox-configmap\n        lifecycle:\n          postStart:\n            exec:\n              command:\n              - /bin/sh\n              - -c\n              - 'bash /home/install-plugins.sh && bash /home/start-rqworker.sh &&\n                bash /home/nginx-caching-fix.sh\n\n                '\n        volumeMounts:\n        - name: auth-ldap-bind-password\n          mountPath: /run/secrets/auth_ldap_bind_password\n          subPath: auth_ldap_bind_password\n          readOnly: true\n        - name: db-password\n          mountPath: /run/secrets/db_password\n          subPath: db_password\n          readOnly: true\n        - name: email-password\n          mountPath: /run/secrets/email_password\n          subPath: email_password\n          readOnly: true\n        - name: napalm-password\n          mountPath: /run/secrets/napalm_password\n          subPath: napalm_password\n          readOnly: true\n        - name: redis-password\n          mountPath: /run/secrets/redis_password\n          subPath: redis_password\n        - name: secret-key\n          mountPath: /run/secrets/secret_key\n          subPath: secret_key\n          readOnly: true\n        - name: superuser-api-token\n          mountPath: /run/secrets/superuser_api_token\n          subPath: superuser_api_token\n        - name: superuser-password\n          mountPath: /run/secrets/superuser_password\n          subPath: superuser_password\n          readOnly: true\n        - name: netbox-media-files\n          mountPath: /opt/netbox/netbox/media\n        - name: ldap-config\n          subPath: ldap_config.py\n          mountPath: /opt/netbox/netbox/netbox/ldap_config.py\n        - mountPath: /etc/netbox/config/netbox-plugins.py\n          name: netbox-plugins\n          subPath: netbox-plugins.py\n        - mountPath: /home/install-plugins.sh\n          name: install-plugins\n          subPath: install-plugins.sh\n        - mountPath: /home/start-rqworker.sh\n          name: start-rqworker\n          subPath: start-rqworker.sh\n        - mountPath: /home/nginx-caching-fix.sh\n          name: nginx-caching-fix\n          subPath: nginx-caching-fix.sh\n        - name: sso-saml2-xml\n          mountPath: /opt/netbox/sso-saml2.xml\n          subPath: sso-saml2-metadata.xml\n      restartPolicy: Always\n      volumes:\n      - name: netbox-media-files\n        persistentVolumeClaim:\n          claimName: netbox-media-pvc\n          readOnly: false\n      - name: ldap-config\n        configMap:\n          name: netbox-configmap\n          items:\n          - key: ldap_config.py\n            path: ldap_config.py\n      - name: netbox-plugins\n        configMap:\n          name: startup-configmap\n          items:\n          - key: netbox-plugins.py\n            path: netbox-plugins.py\n      - name: install-plugins\n        configMap:\n          name: startup-configmap\n          items:\n          - key: install-plugins.sh\n            path: install-plugins.sh\n      - name: start-rqworker\n        configMap:\n          name: startup-configmap\n          items:\n          - key: start-rqworker.sh\n            path: start-rqworker.sh\n      - name: nginx-caching-fix\n        configMap:\n          name: startup-configmap\n          items:\n          - key: nginx-caching-fix.sh\n            path: nginx-caching-fix.sh\n      - name: sso-saml2-xml\n        configMap:\n          name: sso-saml2-xml\n          items:\n          - key: sso-saml2-metadata.xml\n            path: sso-saml2-metadata.xml\n      - name: auth-ldap-bind-password\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: auth_ldap_bind_password\n            path: auth_ldap_bind_password\n      - name: db-password\n        secret:\n          secretName: netbox-postgresql\n          items:\n          - key: password\n            path: db_password\n      - name: email-password\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: email_password\n            path: email_password\n      - name: napalm-password\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: napalm_password\n            path: napalm_password\n      - name: redis-password\n        secret:\n          secretName: netbox-redis\n          items:\n          - key: redis-password\n            path: redis_password\n      - name: secret-key\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: secret_key\n            path: secret_key\n      - name: superuser-password\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: superuser_password\n            path: superuser_password\n      - name: superuser-api-token\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: superuser_api_token\n            path: superuser_api_token\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"netbox\" has cpu request 0"
  },
  {
    "id": "1070",
    "manifest_path": "data/manifests/the_stack_sample/sample_0094.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: netbox\n  namespace: netbox-community\n  labels:\n    k8s-app: netbox\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      k8s-app: netbox\n  template:\n    metadata:\n      labels:\n        k8s-app: netbox\n    spec:\n      containers:\n      - name: netbox\n        image: quay.io/netboxcommunity/netbox:v2.11.12-ldap\n        ports:\n        - name: http\n          containerPort: 8080\n        readinessProbe:\n          httpGet:\n            path: /\n            port: http\n          initialDelaySeconds: 5\n          periodSeconds: 20\n        envFrom:\n        - configMapRef:\n            name: netbox-configmap\n        lifecycle:\n          postStart:\n            exec:\n              command:\n              - /bin/sh\n              - -c\n              - 'bash /home/install-plugins.sh && bash /home/start-rqworker.sh &&\n                bash /home/nginx-caching-fix.sh\n\n                '\n        volumeMounts:\n        - name: auth-ldap-bind-password\n          mountPath: /run/secrets/auth_ldap_bind_password\n          subPath: auth_ldap_bind_password\n          readOnly: true\n        - name: db-password\n          mountPath: /run/secrets/db_password\n          subPath: db_password\n          readOnly: true\n        - name: email-password\n          mountPath: /run/secrets/email_password\n          subPath: email_password\n          readOnly: true\n        - name: napalm-password\n          mountPath: /run/secrets/napalm_password\n          subPath: napalm_password\n          readOnly: true\n        - name: redis-password\n          mountPath: /run/secrets/redis_password\n          subPath: redis_password\n        - name: secret-key\n          mountPath: /run/secrets/secret_key\n          subPath: secret_key\n          readOnly: true\n        - name: superuser-api-token\n          mountPath: /run/secrets/superuser_api_token\n          subPath: superuser_api_token\n        - name: superuser-password\n          mountPath: /run/secrets/superuser_password\n          subPath: superuser_password\n          readOnly: true\n        - name: netbox-media-files\n          mountPath: /opt/netbox/netbox/media\n        - name: ldap-config\n          subPath: ldap_config.py\n          mountPath: /opt/netbox/netbox/netbox/ldap_config.py\n        - mountPath: /etc/netbox/config/netbox-plugins.py\n          name: netbox-plugins\n          subPath: netbox-plugins.py\n        - mountPath: /home/install-plugins.sh\n          name: install-plugins\n          subPath: install-plugins.sh\n        - mountPath: /home/start-rqworker.sh\n          name: start-rqworker\n          subPath: start-rqworker.sh\n        - mountPath: /home/nginx-caching-fix.sh\n          name: nginx-caching-fix\n          subPath: nginx-caching-fix.sh\n        - name: sso-saml2-xml\n          mountPath: /opt/netbox/sso-saml2.xml\n          subPath: sso-saml2-metadata.xml\n      restartPolicy: Always\n      volumes:\n      - name: netbox-media-files\n        persistentVolumeClaim:\n          claimName: netbox-media-pvc\n          readOnly: false\n      - name: ldap-config\n        configMap:\n          name: netbox-configmap\n          items:\n          - key: ldap_config.py\n            path: ldap_config.py\n      - name: netbox-plugins\n        configMap:\n          name: startup-configmap\n          items:\n          - key: netbox-plugins.py\n            path: netbox-plugins.py\n      - name: install-plugins\n        configMap:\n          name: startup-configmap\n          items:\n          - key: install-plugins.sh\n            path: install-plugins.sh\n      - name: start-rqworker\n        configMap:\n          name: startup-configmap\n          items:\n          - key: start-rqworker.sh\n            path: start-rqworker.sh\n      - name: nginx-caching-fix\n        configMap:\n          name: startup-configmap\n          items:\n          - key: nginx-caching-fix.sh\n            path: nginx-caching-fix.sh\n      - name: sso-saml2-xml\n        configMap:\n          name: sso-saml2-xml\n          items:\n          - key: sso-saml2-metadata.xml\n            path: sso-saml2-metadata.xml\n      - name: auth-ldap-bind-password\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: auth_ldap_bind_password\n            path: auth_ldap_bind_password\n      - name: db-password\n        secret:\n          secretName: netbox-postgresql\n          items:\n          - key: password\n            path: db_password\n      - name: email-password\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: email_password\n            path: email_password\n      - name: napalm-password\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: napalm_password\n            path: napalm_password\n      - name: redis-password\n        secret:\n          secretName: netbox-redis\n          items:\n          - key: redis-password\n            path: redis_password\n      - name: secret-key\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: secret_key\n            path: secret_key\n      - name: superuser-password\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: superuser_password\n            path: superuser_password\n      - name: superuser-api-token\n        secret:\n          secretName: netbox-secret\n          items:\n          - key: superuser_api_token\n            path: superuser_api_token\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"netbox\" has memory limit 0"
  },
  {
    "id": "1071",
    "manifest_path": "data/manifests/the_stack_sample/sample_0098.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: kube-rn50-1\nspec:\n  containers:\n  - name: tf-mnist-1gpu\n    image: centaurusinfra/tf-onegpu-mnist:latest\n    workingDir: /tmp/test\n    command:\n    - sh\n    - -c\n    - python3 tf-cf-rn50-pack.py\n  restartPolicy: OnFailure\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"tf-mnist-1gpu\" is using an invalid container image, \"centaurusinfra/tf-onegpu-mnist:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "1072",
    "manifest_path": "data/manifests/the_stack_sample/sample_0098.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: kube-rn50-1\nspec:\n  containers:\n  - name: tf-mnist-1gpu\n    image: centaurusinfra/tf-onegpu-mnist:latest\n    workingDir: /tmp/test\n    command:\n    - sh\n    - -c\n    - python3 tf-cf-rn50-pack.py\n  restartPolicy: OnFailure\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"tf-mnist-1gpu\" does not have a read-only root file system"
  },
  {
    "id": "1073",
    "manifest_path": "data/manifests/the_stack_sample/sample_0098.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: kube-rn50-1\nspec:\n  containers:\n  - name: tf-mnist-1gpu\n    image: centaurusinfra/tf-onegpu-mnist:latest\n    workingDir: /tmp/test\n    command:\n    - sh\n    - -c\n    - python3 tf-cf-rn50-pack.py\n  restartPolicy: OnFailure\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"tf-mnist-1gpu\" is not set to runAsNonRoot"
  },
  {
    "id": "1074",
    "manifest_path": "data/manifests/the_stack_sample/sample_0098.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: kube-rn50-1\nspec:\n  containers:\n  - name: tf-mnist-1gpu\n    image: centaurusinfra/tf-onegpu-mnist:latest\n    workingDir: /tmp/test\n    command:\n    - sh\n    - -c\n    - python3 tf-cf-rn50-pack.py\n  restartPolicy: OnFailure\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"tf-mnist-1gpu\" has cpu request 0"
  },
  {
    "id": "1075",
    "manifest_path": "data/manifests/the_stack_sample/sample_0098.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: kube-rn50-1\nspec:\n  containers:\n  - name: tf-mnist-1gpu\n    image: centaurusinfra/tf-onegpu-mnist:latest\n    workingDir: /tmp/test\n    command:\n    - sh\n    - -c\n    - python3 tf-cf-rn50-pack.py\n  restartPolicy: OnFailure\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"tf-mnist-1gpu\" has memory limit 0"
  },
  {
    "id": "1076",
    "manifest_path": "data/manifests/the_stack_sample/sample_0099.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: mongo\n  labels:\n    app: reddit\n    component: mongo\n    comment-db: 'true'\n    post-db: 'true'\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: reddit\n      component: mongo\n  template:\n    metadata:\n      name: mongo\n      labels:\n        app: reddit\n        component: mongo\n        comment-db: 'true'\n        post-db: 'true'\n    spec:\n      containers:\n      - image: mongo:3.2\n        name: mongo\n        volumeMounts:\n        - name: mongo-gce-pd-storage\n          mountPath: /data/db\n      volumes:\n      - name: mongo-gce-pd-storage\n        persistentVolumeClaim:\n          claimName: mongo-pvc-dynamic\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"mongo\" does not have a read-only root file system"
  },
  {
    "id": "1077",
    "manifest_path": "data/manifests/the_stack_sample/sample_0099.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: mongo\n  labels:\n    app: reddit\n    component: mongo\n    comment-db: 'true'\n    post-db: 'true'\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: reddit\n      component: mongo\n  template:\n    metadata:\n      name: mongo\n      labels:\n        app: reddit\n        component: mongo\n        comment-db: 'true'\n        post-db: 'true'\n    spec:\n      containers:\n      - image: mongo:3.2\n        name: mongo\n        volumeMounts:\n        - name: mongo-gce-pd-storage\n          mountPath: /data/db\n      volumes:\n      - name: mongo-gce-pd-storage\n        persistentVolumeClaim:\n          claimName: mongo-pvc-dynamic\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"mongo\" is not set to runAsNonRoot"
  },
  {
    "id": "1078",
    "manifest_path": "data/manifests/the_stack_sample/sample_0099.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: mongo\n  labels:\n    app: reddit\n    component: mongo\n    comment-db: 'true'\n    post-db: 'true'\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: reddit\n      component: mongo\n  template:\n    metadata:\n      name: mongo\n      labels:\n        app: reddit\n        component: mongo\n        comment-db: 'true'\n        post-db: 'true'\n    spec:\n      containers:\n      - image: mongo:3.2\n        name: mongo\n        volumeMounts:\n        - name: mongo-gce-pd-storage\n          mountPath: /data/db\n      volumes:\n      - name: mongo-gce-pd-storage\n        persistentVolumeClaim:\n          claimName: mongo-pvc-dynamic\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"mongo\" has cpu request 0"
  },
  {
    "id": "1079",
    "manifest_path": "data/manifests/the_stack_sample/sample_0099.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: mongo\n  labels:\n    app: reddit\n    component: mongo\n    comment-db: 'true'\n    post-db: 'true'\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: reddit\n      component: mongo\n  template:\n    metadata:\n      name: mongo\n      labels:\n        app: reddit\n        component: mongo\n        comment-db: 'true'\n        post-db: 'true'\n    spec:\n      containers:\n      - image: mongo:3.2\n        name: mongo\n        volumeMounts:\n        - name: mongo-gce-pd-storage\n          mountPath: /data/db\n      volumes:\n      - name: mongo-gce-pd-storage\n        persistentVolumeClaim:\n          claimName: mongo-pvc-dynamic\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"mongo\" has memory limit 0"
  },
  {
    "id": "1080",
    "manifest_path": "data/manifests/the_stack_sample/sample_0100.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Service\nmetadata:\n  name: kyuubi-example-service\nspec:\n  ports:\n  - nodePort: 30009\n    port: 10009\n    protocol: TCP\n  type: NodePort\n  selector:\n    app: kyuubi-server\n",
    "policy_id": "dangling-service",
    "violation_text": "no pods found matching service labels (map[app:kyuubi-server])"
  },
  {
    "id": "1081",
    "manifest_path": "data/manifests/the_stack_sample/sample_0101.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: paymentservice\n  labels:\n    app: paymentservice\nspec:\n  replicas: 3\n  strategy:\n    type: RollingUpdate\n  selector:\n    matchLabels:\n      app: paymentservice\n  template:\n    metadata:\n      labels:\n        app: paymentservice\n    spec:\n      containers:\n      - name: server\n        image: opcode/hipster-payment:v.0.0.2\n        env:\n        - name: PRODUCT_CATALOG_SERVICE_ADDR\n          value: productcatalogservice:3550\n        - name: CURRENCY_SERVICE_ADDR\n          value: currencyservice:7000\n        - name: CART_SERVICE_ADDR\n          value: cartservice:7070\n        - name: RECOMMENDATION_SERVICE_ADDR\n          value: recommendationservice:8080\n        - name: CHECKOUT_SERVICE_ADDR\n          value: checkoutservice:5050\n        - name: SHIPPING_SERVICE_ADDR\n          value: shippingservice:50051\n        - name: AD_SERVICE_ADDR\n          value: adservice:9555\n",
    "policy_id": "no-anti-affinity",
    "violation_text": "object has 3 replicas but does not specify inter pod anti-affinity"
  },
  {
    "id": "1082",
    "manifest_path": "data/manifests/the_stack_sample/sample_0101.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: paymentservice\n  labels:\n    app: paymentservice\nspec:\n  replicas: 3\n  strategy:\n    type: RollingUpdate\n  selector:\n    matchLabels:\n      app: paymentservice\n  template:\n    metadata:\n      labels:\n        app: paymentservice\n    spec:\n      containers:\n      - name: server\n        image: opcode/hipster-payment:v.0.0.2\n        env:\n        - name: PRODUCT_CATALOG_SERVICE_ADDR\n          value: productcatalogservice:3550\n        - name: CURRENCY_SERVICE_ADDR\n          value: currencyservice:7000\n        - name: CART_SERVICE_ADDR\n          value: cartservice:7070\n        - name: RECOMMENDATION_SERVICE_ADDR\n          value: recommendationservice:8080\n        - name: CHECKOUT_SERVICE_ADDR\n          value: checkoutservice:5050\n        - name: SHIPPING_SERVICE_ADDR\n          value: shippingservice:50051\n        - name: AD_SERVICE_ADDR\n          value: adservice:9555\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"server\" does not have a read-only root file system"
  },
  {
    "id": "1083",
    "manifest_path": "data/manifests/the_stack_sample/sample_0101.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: paymentservice\n  labels:\n    app: paymentservice\nspec:\n  replicas: 3\n  strategy:\n    type: RollingUpdate\n  selector:\n    matchLabels:\n      app: paymentservice\n  template:\n    metadata:\n      labels:\n        app: paymentservice\n    spec:\n      containers:\n      - name: server\n        image: opcode/hipster-payment:v.0.0.2\n        env:\n        - name: PRODUCT_CATALOG_SERVICE_ADDR\n          value: productcatalogservice:3550\n        - name: CURRENCY_SERVICE_ADDR\n          value: currencyservice:7000\n        - name: CART_SERVICE_ADDR\n          value: cartservice:7070\n        - name: RECOMMENDATION_SERVICE_ADDR\n          value: recommendationservice:8080\n        - name: CHECKOUT_SERVICE_ADDR\n          value: checkoutservice:5050\n        - name: SHIPPING_SERVICE_ADDR\n          value: shippingservice:50051\n        - name: AD_SERVICE_ADDR\n          value: adservice:9555\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"server\" is not set to runAsNonRoot"
  },
  {
    "id": "1084",
    "manifest_path": "data/manifests/the_stack_sample/sample_0101.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: paymentservice\n  labels:\n    app: paymentservice\nspec:\n  replicas: 3\n  strategy:\n    type: RollingUpdate\n  selector:\n    matchLabels:\n      app: paymentservice\n  template:\n    metadata:\n      labels:\n        app: paymentservice\n    spec:\n      containers:\n      - name: server\n        image: opcode/hipster-payment:v.0.0.2\n        env:\n        - name: PRODUCT_CATALOG_SERVICE_ADDR\n          value: productcatalogservice:3550\n        - name: CURRENCY_SERVICE_ADDR\n          value: currencyservice:7000\n        - name: CART_SERVICE_ADDR\n          value: cartservice:7070\n        - name: RECOMMENDATION_SERVICE_ADDR\n          value: recommendationservice:8080\n        - name: CHECKOUT_SERVICE_ADDR\n          value: checkoutservice:5050\n        - name: SHIPPING_SERVICE_ADDR\n          value: shippingservice:50051\n        - name: AD_SERVICE_ADDR\n          value: adservice:9555\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"server\" has cpu request 0"
  },
  {
    "id": "1085",
    "manifest_path": "data/manifests/the_stack_sample/sample_0101.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: paymentservice\n  labels:\n    app: paymentservice\nspec:\n  replicas: 3\n  strategy:\n    type: RollingUpdate\n  selector:\n    matchLabels:\n      app: paymentservice\n  template:\n    metadata:\n      labels:\n        app: paymentservice\n    spec:\n      containers:\n      - name: server\n        image: opcode/hipster-payment:v.0.0.2\n        env:\n        - name: PRODUCT_CATALOG_SERVICE_ADDR\n          value: productcatalogservice:3550\n        - name: CURRENCY_SERVICE_ADDR\n          value: currencyservice:7000\n        - name: CART_SERVICE_ADDR\n          value: cartservice:7070\n        - name: RECOMMENDATION_SERVICE_ADDR\n          value: recommendationservice:8080\n        - name: CHECKOUT_SERVICE_ADDR\n          value: checkoutservice:5050\n        - name: SHIPPING_SERVICE_ADDR\n          value: shippingservice:50051\n        - name: AD_SERVICE_ADDR\n          value: adservice:9555\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"server\" has memory limit 0"
  },
  {
    "id": "1086",
    "manifest_path": "data/manifests/the_stack_sample/sample_0102.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: cowweb\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: cowweb\n  strategy:\n    type: Recreate\n  template:\n    metadata:\n      labels:\n        app: cowweb\n        version: v1.0\n    spec:\n      containers:\n      - name: cowweb\n        image: iad.ocir.io/gse00014640/handson-002/cowweb:v1.0\n        ports:\n        - name: api\n          containerPort: 8080\n        readinessProbe:\n          httpGet:\n            path: /cowsay/ping\n            port: api\n          initialDelaySeconds: 5\n          periodSeconds: 10\n        livenessProbe:\n          httpGet:\n            path: /cowsay/ping\n            port: api\n          initialDelaySeconds: 15\n          periodSeconds: 20\n        imagePullPolicy: Always\n      imagePullSecrets:\n      - name: cowweb-secret\n",
    "policy_id": "no-anti-affinity",
    "violation_text": "object has 2 replicas but does not specify inter pod anti-affinity"
  },
  {
    "id": "1087",
    "manifest_path": "data/manifests/the_stack_sample/sample_0102.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: cowweb\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: cowweb\n  strategy:\n    type: Recreate\n  template:\n    metadata:\n      labels:\n        app: cowweb\n        version: v1.0\n    spec:\n      containers:\n      - name: cowweb\n        image: iad.ocir.io/gse00014640/handson-002/cowweb:v1.0\n        ports:\n        - name: api\n          containerPort: 8080\n        readinessProbe:\n          httpGet:\n            path: /cowsay/ping\n            port: api\n          initialDelaySeconds: 5\n          periodSeconds: 10\n        livenessProbe:\n          httpGet:\n            path: /cowsay/ping\n            port: api\n          initialDelaySeconds: 15\n          periodSeconds: 20\n        imagePullPolicy: Always\n      imagePullSecrets:\n      - name: cowweb-secret\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"cowweb\" does not have a read-only root file system"
  },
  {
    "id": "1088",
    "manifest_path": "data/manifests/the_stack_sample/sample_0102.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: cowweb\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: cowweb\n  strategy:\n    type: Recreate\n  template:\n    metadata:\n      labels:\n        app: cowweb\n        version: v1.0\n    spec:\n      containers:\n      - name: cowweb\n        image: iad.ocir.io/gse00014640/handson-002/cowweb:v1.0\n        ports:\n        - name: api\n          containerPort: 8080\n        readinessProbe:\n          httpGet:\n            path: /cowsay/ping\n            port: api\n          initialDelaySeconds: 5\n          periodSeconds: 10\n        livenessProbe:\n          httpGet:\n            path: /cowsay/ping\n            port: api\n          initialDelaySeconds: 15\n          periodSeconds: 20\n        imagePullPolicy: Always\n      imagePullSecrets:\n      - name: cowweb-secret\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"cowweb\" is not set to runAsNonRoot"
  },
  {
    "id": "1089",
    "manifest_path": "data/manifests/the_stack_sample/sample_0102.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: cowweb\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: cowweb\n  strategy:\n    type: Recreate\n  template:\n    metadata:\n      labels:\n        app: cowweb\n        version: v1.0\n    spec:\n      containers:\n      - name: cowweb\n        image: iad.ocir.io/gse00014640/handson-002/cowweb:v1.0\n        ports:\n        - name: api\n          containerPort: 8080\n        readinessProbe:\n          httpGet:\n            path: /cowsay/ping\n            port: api\n          initialDelaySeconds: 5\n          periodSeconds: 10\n        livenessProbe:\n          httpGet:\n            path: /cowsay/ping\n            port: api\n          initialDelaySeconds: 15\n          periodSeconds: 20\n        imagePullPolicy: Always\n      imagePullSecrets:\n      - name: cowweb-secret\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"cowweb\" has cpu request 0"
  },
  {
    "id": "1090",
    "manifest_path": "data/manifests/the_stack_sample/sample_0102.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: cowweb\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: cowweb\n  strategy:\n    type: Recreate\n  template:\n    metadata:\n      labels:\n        app: cowweb\n        version: v1.0\n    spec:\n      containers:\n      - name: cowweb\n        image: iad.ocir.io/gse00014640/handson-002/cowweb:v1.0\n        ports:\n        - name: api\n          containerPort: 8080\n        readinessProbe:\n          httpGet:\n            path: /cowsay/ping\n            port: api\n          initialDelaySeconds: 5\n          periodSeconds: 10\n        livenessProbe:\n          httpGet:\n            path: /cowsay/ping\n            port: api\n          initialDelaySeconds: 15\n          periodSeconds: 20\n        imagePullPolicy: Always\n      imagePullSecrets:\n      - name: cowweb-secret\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"cowweb\" has memory limit 0"
  },
  {
    "id": "1091",
    "manifest_path": "data/manifests/the_stack_sample/sample_0103.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: jenkins-operator\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: jenkins-operator\n  template:\n    metadata:\n      labels:\n        name: jenkins-operator\n    spec:\n      serviceAccountName: jenkins-operator\n      containers:\n      - name: jenkins-operator\n        image: virtuslab/jenkins-operator:v0.0.9\n        ports:\n        - containerPort: 60000\n          name: metrics\n        command:\n        - jenkins-operator\n        args: []\n        imagePullPolicy: IfNotPresent\n        env:\n        - name: WATCH_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: OPERATOR_NAME\n          value: jenkins-operator\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"jenkins-operator\" does not have a read-only root file system"
  },
  {
    "id": "1092",
    "manifest_path": "data/manifests/the_stack_sample/sample_0103.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: jenkins-operator\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: jenkins-operator\n  template:\n    metadata:\n      labels:\n        name: jenkins-operator\n    spec:\n      serviceAccountName: jenkins-operator\n      containers:\n      - name: jenkins-operator\n        image: virtuslab/jenkins-operator:v0.0.9\n        ports:\n        - containerPort: 60000\n          name: metrics\n        command:\n        - jenkins-operator\n        args: []\n        imagePullPolicy: IfNotPresent\n        env:\n        - name: WATCH_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: OPERATOR_NAME\n          value: jenkins-operator\n",
    "policy_id": "non-existent-service-account",
    "violation_text": "serviceAccount \"jenkins-operator\" not found"
  },
  {
    "id": "1093",
    "manifest_path": "data/manifests/the_stack_sample/sample_0103.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: jenkins-operator\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: jenkins-operator\n  template:\n    metadata:\n      labels:\n        name: jenkins-operator\n    spec:\n      serviceAccountName: jenkins-operator\n      containers:\n      - name: jenkins-operator\n        image: virtuslab/jenkins-operator:v0.0.9\n        ports:\n        - containerPort: 60000\n          name: metrics\n        command:\n        - jenkins-operator\n        args: []\n        imagePullPolicy: IfNotPresent\n        env:\n        - name: WATCH_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: OPERATOR_NAME\n          value: jenkins-operator\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"jenkins-operator\" is not set to runAsNonRoot"
  },
  {
    "id": "1094",
    "manifest_path": "data/manifests/the_stack_sample/sample_0103.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: jenkins-operator\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: jenkins-operator\n  template:\n    metadata:\n      labels:\n        name: jenkins-operator\n    spec:\n      serviceAccountName: jenkins-operator\n      containers:\n      - name: jenkins-operator\n        image: virtuslab/jenkins-operator:v0.0.9\n        ports:\n        - containerPort: 60000\n          name: metrics\n        command:\n        - jenkins-operator\n        args: []\n        imagePullPolicy: IfNotPresent\n        env:\n        - name: WATCH_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: OPERATOR_NAME\n          value: jenkins-operator\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"jenkins-operator\" has cpu request 0"
  },
  {
    "id": "1095",
    "manifest_path": "data/manifests/the_stack_sample/sample_0103.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: jenkins-operator\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: jenkins-operator\n  template:\n    metadata:\n      labels:\n        name: jenkins-operator\n    spec:\n      serviceAccountName: jenkins-operator\n      containers:\n      - name: jenkins-operator\n        image: virtuslab/jenkins-operator:v0.0.9\n        ports:\n        - containerPort: 60000\n          name: metrics\n        command:\n        - jenkins-operator\n        args: []\n        imagePullPolicy: IfNotPresent\n        env:\n        - name: WATCH_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: OPERATOR_NAME\n          value: jenkins-operator\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"jenkins-operator\" has memory limit 0"
  },
  {
    "id": "1096",
    "manifest_path": "data/manifests/the_stack_sample/sample_0104.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: libri-experimenter\nspec:\n  restartPolicy: Never\n  volumes:\n  - name: data\n    emptyDir: {}\n  containers:\n  - name: libri-experimenter\n    image: daedalus2718/libri-exp:snapshot-949fb64\n    args:\n    - run\n    - --librarians\n    - librarians-0.libri.default.svc.cluster.local:20100,librarians-1.libri.default.svc.cluster.local:20100,librarians-2.libri.default.svc.cluster.local:20100,librarians-3.libri.default.svc.cluster.local:20100,librarians-4.libri.default.svc.cluster.local:20100,librarians-5.libri.default.svc.cluster.local:20100,librarians-6.libri.default.svc.cluster.local:20100,librarians-7.libri.default.svc.cluster.local:20100\n    - --duration\n    - 30m\n    - --numAuthors\n    - '100'\n    - --docsPerDay\n    - '2560'\n    - --contentSizeKBGammaShape\n    - '1.5'\n    - --contentSizeKBGammaRate\n    - '0.00588'\n    - --sharesPerUpload\n    - '2'\n    - --nUploaders\n    - '64'\n    - --nDownloaders\n    - '192'\n    - --profile\n    env:\n    - name: GODEBUG\n      value: netdns=go\n    volumeMounts:\n    - name: data\n      mountPath: /data\n    resources:\n      limits:\n        memory: 2G\n        cpu: 400m\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"libri-experimenter\" does not have a read-only root file system"
  },
  {
    "id": "1097",
    "manifest_path": "data/manifests/the_stack_sample/sample_0104.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: libri-experimenter\nspec:\n  restartPolicy: Never\n  volumes:\n  - name: data\n    emptyDir: {}\n  containers:\n  - name: libri-experimenter\n    image: daedalus2718/libri-exp:snapshot-949fb64\n    args:\n    - run\n    - --librarians\n    - librarians-0.libri.default.svc.cluster.local:20100,librarians-1.libri.default.svc.cluster.local:20100,librarians-2.libri.default.svc.cluster.local:20100,librarians-3.libri.default.svc.cluster.local:20100,librarians-4.libri.default.svc.cluster.local:20100,librarians-5.libri.default.svc.cluster.local:20100,librarians-6.libri.default.svc.cluster.local:20100,librarians-7.libri.default.svc.cluster.local:20100\n    - --duration\n    - 30m\n    - --numAuthors\n    - '100'\n    - --docsPerDay\n    - '2560'\n    - --contentSizeKBGammaShape\n    - '1.5'\n    - --contentSizeKBGammaRate\n    - '0.00588'\n    - --sharesPerUpload\n    - '2'\n    - --nUploaders\n    - '64'\n    - --nDownloaders\n    - '192'\n    - --profile\n    env:\n    - name: GODEBUG\n      value: netdns=go\n    volumeMounts:\n    - name: data\n      mountPath: /data\n    resources:\n      limits:\n        memory: 2G\n        cpu: 400m\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"libri-experimenter\" is not set to runAsNonRoot"
  },
  {
    "id": "1098",
    "manifest_path": "data/manifests/the_stack_sample/sample_0104.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: libri-experimenter\nspec:\n  restartPolicy: Never\n  volumes:\n  - name: data\n    emptyDir: {}\n  containers:\n  - name: libri-experimenter\n    image: daedalus2718/libri-exp:snapshot-949fb64\n    args:\n    - run\n    - --librarians\n    - librarians-0.libri.default.svc.cluster.local:20100,librarians-1.libri.default.svc.cluster.local:20100,librarians-2.libri.default.svc.cluster.local:20100,librarians-3.libri.default.svc.cluster.local:20100,librarians-4.libri.default.svc.cluster.local:20100,librarians-5.libri.default.svc.cluster.local:20100,librarians-6.libri.default.svc.cluster.local:20100,librarians-7.libri.default.svc.cluster.local:20100\n    - --duration\n    - 30m\n    - --numAuthors\n    - '100'\n    - --docsPerDay\n    - '2560'\n    - --contentSizeKBGammaShape\n    - '1.5'\n    - --contentSizeKBGammaRate\n    - '0.00588'\n    - --sharesPerUpload\n    - '2'\n    - --nUploaders\n    - '64'\n    - --nDownloaders\n    - '192'\n    - --profile\n    env:\n    - name: GODEBUG\n      value: netdns=go\n    volumeMounts:\n    - name: data\n      mountPath: /data\n    resources:\n      limits:\n        memory: 2G\n        cpu: 400m\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"libri-experimenter\" has cpu request 0"
  },
  {
    "id": "1099",
    "manifest_path": "data/manifests/the_stack_sample/sample_0105.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: todo-table\n  namespace: todo\n  annotations:\n    argocd.argoproj.io/sync-wave: '1'\nspec:\n  ttlSecondsAfterFinished: 100\n  template:\n    spec:\n      containers:\n      - name: postgresql-client\n        image: postgres:12\n        imagePullPolicy: Always\n        env:\n        - name: PGPASSWORD\n          value: admin\n        command:\n        - psql\n        args:\n        - --host=postgresql\n        - --username=admin\n        - --no-password\n        - --dbname=todo\n        - --command=create table Todo (id bigint not null,completed boolean not null,ordering\n          integer,title varchar(255),url varchar(255),primary key (id));create sequence\n          hibernate_sequence start with 1 increment by 1;\n      restartPolicy: Never\n  backoffLimit: 1\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"postgresql-client\" does not have a read-only root file system"
  },
  {
    "id": "1100",
    "manifest_path": "data/manifests/the_stack_sample/sample_0105.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: todo-table\n  namespace: todo\n  annotations:\n    argocd.argoproj.io/sync-wave: '1'\nspec:\n  ttlSecondsAfterFinished: 100\n  template:\n    spec:\n      containers:\n      - name: postgresql-client\n        image: postgres:12\n        imagePullPolicy: Always\n        env:\n        - name: PGPASSWORD\n          value: admin\n        command:\n        - psql\n        args:\n        - --host=postgresql\n        - --username=admin\n        - --no-password\n        - --dbname=todo\n        - --command=create table Todo (id bigint not null,completed boolean not null,ordering\n          integer,title varchar(255),url varchar(255),primary key (id));create sequence\n          hibernate_sequence start with 1 increment by 1;\n      restartPolicy: Never\n  backoffLimit: 1\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"postgresql-client\" is not set to runAsNonRoot"
  },
  {
    "id": "1101",
    "manifest_path": "data/manifests/the_stack_sample/sample_0105.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: todo-table\n  namespace: todo\n  annotations:\n    argocd.argoproj.io/sync-wave: '1'\nspec:\n  ttlSecondsAfterFinished: 100\n  template:\n    spec:\n      containers:\n      - name: postgresql-client\n        image: postgres:12\n        imagePullPolicy: Always\n        env:\n        - name: PGPASSWORD\n          value: admin\n        command:\n        - psql\n        args:\n        - --host=postgresql\n        - --username=admin\n        - --no-password\n        - --dbname=todo\n        - --command=create table Todo (id bigint not null,completed boolean not null,ordering\n          integer,title varchar(255),url varchar(255),primary key (id));create sequence\n          hibernate_sequence start with 1 increment by 1;\n      restartPolicy: Never\n  backoffLimit: 1\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"postgresql-client\" has cpu request 0"
  },
  {
    "id": "1102",
    "manifest_path": "data/manifests/the_stack_sample/sample_0105.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: todo-table\n  namespace: todo\n  annotations:\n    argocd.argoproj.io/sync-wave: '1'\nspec:\n  ttlSecondsAfterFinished: 100\n  template:\n    spec:\n      containers:\n      - name: postgresql-client\n        image: postgres:12\n        imagePullPolicy: Always\n        env:\n        - name: PGPASSWORD\n          value: admin\n        command:\n        - psql\n        args:\n        - --host=postgresql\n        - --username=admin\n        - --no-password\n        - --dbname=todo\n        - --command=create table Todo (id bigint not null,completed boolean not null,ordering\n          integer,title varchar(255),url varchar(255),primary key (id));create sequence\n          hibernate_sequence start with 1 increment by 1;\n      restartPolicy: Never\n  backoffLimit: 1\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"postgresql-client\" has memory limit 0"
  },
  {
    "id": "1103",
    "manifest_path": "data/manifests/the_stack_sample/sample_0106.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: tf-r2.4.0-keras-api-custom-layers-v2-32\n  namespace: automated\nspec:\n  concurrencyPolicy: Forbid\n  jobTemplate:\n    spec:\n      activeDeadlineSeconds: 7200\n      backoffLimit: 1\n      template:\n        metadata:\n          annotations:\n            tf-version.cloud-tpus.google.com: 2.4.0\n        spec:\n          containers:\n          - env:\n            - name: POD_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.name\n            - name: POD_NAMESPACE\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.namespace\n            image: gcr.io/xl-ml-test/health-monitor:stable\n            imagePullPolicy: Always\n            name: monitor\n          - args:\n            - /bin/bash\n            - -c\n            - 'set -u\n\n              set -e\n\n              set -x\n\n\n              export PATH=$PATH:/root/google-cloud-sdk/bin\n\n              gcloud source repos clone tf2-api-tests --project=xl-ml-test\n\n              cd tf2-api-tests\n\n              pip3 install behave\n\n              behave -e ipynb_checkpoints --tags=-fails --tags=-failspod -i custom_layers_model\n\n              '\n            env:\n            - name: POD_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.name\n            - name: POD_UID\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.uid\n            - name: POD_NAMESPACE\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.namespace\n            - name: JOB_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.labels['job-name']\n            - name: MODEL_DIR\n              value: $(OUTPUT_BUCKET)/tf-r2.4.0/keras-api/custom-layers/v2-32/$(JOB_NAME)\n            envFrom:\n            - configMapRef:\n                name: gcs-buckets\n            image: gcr.io/xl-ml-test/tensorflow:r2.4.0\n            imagePullPolicy: Always\n            name: train\n            resources:\n              limits:\n                cloud-tpus.google.com/preemptible-v2: 32\n              requests:\n                cpu: 2\n                memory: 20G\n            volumeMounts:\n            - mountPath: /dev/shm\n              name: dshm\n              readOnly: false\n          initContainers:\n          - env:\n            - name: POD_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.name\n            - name: POD_UID\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.uid\n            - name: POD_NAMESPACE\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.namespace\n            - name: JOB_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.labels['job-name']\n            - name: MODEL_DIR\n              value: $(OUTPUT_BUCKET)/tf-r2.4.0/keras-api/custom-layers/v2-32/$(JOB_NAME)\n            - name: METRIC_CONFIG\n              value: \"{\\n \\\"metric_collection_config\\\": {\\n  \\\"default_aggregation_strategies\\\"\\\n                : [\\n   \\\"final\\\"\\n  ],\\n  \\\"metric_to_aggregation_strategies\\\": {\\n\\\n                \\   \\\"examples_per_second\\\": [\\n    \\\"average\\\"\\n   ]\\n  },\\n  \\\"\\\n                use_run_name_prefix\\\": true,\\n  \\\"write_to_bigquery\\\": true\\n },\\n\\\n                \\ \\\"regression_test_config\\\": {\\n  \\\"alert_for_failed_jobs\\\": true\\n\\\n                \\ },\\n \\\"test_name\\\": \\\"tf-r2.4.0-keras-api-custom-layers-v2-32\\\"\\n\\\n                }\\n\"\n            envFrom:\n            - configMapRef:\n                name: gcs-buckets\n            image: gcr.io/xl-ml-test/publisher:stable\n            imagePullPolicy: Always\n            name: publisher\n          nodeSelector:\n            tpu-available: 'true'\n          restartPolicy: Never\n          volumes:\n          - emptyDir:\n              medium: Memory\n            name: dshm\n  schedule: 0 10 * * *\n  successfulJobsHistoryLimit: 1\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"monitor\" does not have a read-only root file system"
  },
  {
    "id": "1104",
    "manifest_path": "data/manifests/the_stack_sample/sample_0106.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: tf-r2.4.0-keras-api-custom-layers-v2-32\n  namespace: automated\nspec:\n  concurrencyPolicy: Forbid\n  jobTemplate:\n    spec:\n      activeDeadlineSeconds: 7200\n      backoffLimit: 1\n      template:\n        metadata:\n          annotations:\n            tf-version.cloud-tpus.google.com: 2.4.0\n        spec:\n          containers:\n          - env:\n            - name: POD_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.name\n            - name: POD_NAMESPACE\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.namespace\n            image: gcr.io/xl-ml-test/health-monitor:stable\n            imagePullPolicy: Always\n            name: monitor\n          - args:\n            - /bin/bash\n            - -c\n            - 'set -u\n\n              set -e\n\n              set -x\n\n\n              export PATH=$PATH:/root/google-cloud-sdk/bin\n\n              gcloud source repos clone tf2-api-tests --project=xl-ml-test\n\n              cd tf2-api-tests\n\n              pip3 install behave\n\n              behave -e ipynb_checkpoints --tags=-fails --tags=-failspod -i custom_layers_model\n\n              '\n            env:\n            - name: POD_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.name\n            - name: POD_UID\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.uid\n            - name: POD_NAMESPACE\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.namespace\n            - name: JOB_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.labels['job-name']\n            - name: MODEL_DIR\n              value: $(OUTPUT_BUCKET)/tf-r2.4.0/keras-api/custom-layers/v2-32/$(JOB_NAME)\n            envFrom:\n            - configMapRef:\n                name: gcs-buckets\n            image: gcr.io/xl-ml-test/tensorflow:r2.4.0\n            imagePullPolicy: Always\n            name: train\n            resources:\n              limits:\n                cloud-tpus.google.com/preemptible-v2: 32\n              requests:\n                cpu: 2\n                memory: 20G\n            volumeMounts:\n            - mountPath: /dev/shm\n              name: dshm\n              readOnly: false\n          initContainers:\n          - env:\n            - name: POD_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.name\n            - name: POD_UID\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.uid\n            - name: POD_NAMESPACE\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.namespace\n            - name: JOB_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.labels['job-name']\n            - name: MODEL_DIR\n              value: $(OUTPUT_BUCKET)/tf-r2.4.0/keras-api/custom-layers/v2-32/$(JOB_NAME)\n            - name: METRIC_CONFIG\n              value: \"{\\n \\\"metric_collection_config\\\": {\\n  \\\"default_aggregation_strategies\\\"\\\n                : [\\n   \\\"final\\\"\\n  ],\\n  \\\"metric_to_aggregation_strategies\\\": {\\n\\\n                \\   \\\"examples_per_second\\\": [\\n    \\\"average\\\"\\n   ]\\n  },\\n  \\\"\\\n                use_run_name_prefix\\\": true,\\n  \\\"write_to_bigquery\\\": true\\n },\\n\\\n                \\ \\\"regression_test_config\\\": {\\n  \\\"alert_for_failed_jobs\\\": true\\n\\\n                \\ },\\n \\\"test_name\\\": \\\"tf-r2.4.0-keras-api-custom-layers-v2-32\\\"\\n\\\n                }\\n\"\n            envFrom:\n            - configMapRef:\n                name: gcs-buckets\n            image: gcr.io/xl-ml-test/publisher:stable\n            imagePullPolicy: Always\n            name: publisher\n          nodeSelector:\n            tpu-available: 'true'\n          restartPolicy: Never\n          volumes:\n          - emptyDir:\n              medium: Memory\n            name: dshm\n  schedule: 0 10 * * *\n  successfulJobsHistoryLimit: 1\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"publisher\" does not have a read-only root file system"
  },
  {
    "id": "1105",
    "manifest_path": "data/manifests/the_stack_sample/sample_0106.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: tf-r2.4.0-keras-api-custom-layers-v2-32\n  namespace: automated\nspec:\n  concurrencyPolicy: Forbid\n  jobTemplate:\n    spec:\n      activeDeadlineSeconds: 7200\n      backoffLimit: 1\n      template:\n        metadata:\n          annotations:\n            tf-version.cloud-tpus.google.com: 2.4.0\n        spec:\n          containers:\n          - env:\n            - name: POD_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.name\n            - name: POD_NAMESPACE\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.namespace\n            image: gcr.io/xl-ml-test/health-monitor:stable\n            imagePullPolicy: Always\n            name: monitor\n          - args:\n            - /bin/bash\n            - -c\n            - 'set -u\n\n              set -e\n\n              set -x\n\n\n              export PATH=$PATH:/root/google-cloud-sdk/bin\n\n              gcloud source repos clone tf2-api-tests --project=xl-ml-test\n\n              cd tf2-api-tests\n\n              pip3 install behave\n\n              behave -e ipynb_checkpoints --tags=-fails --tags=-failspod -i custom_layers_model\n\n              '\n            env:\n            - name: POD_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.name\n            - name: POD_UID\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.uid\n            - name: POD_NAMESPACE\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.namespace\n            - name: JOB_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.labels['job-name']\n            - name: MODEL_DIR\n              value: $(OUTPUT_BUCKET)/tf-r2.4.0/keras-api/custom-layers/v2-32/$(JOB_NAME)\n            envFrom:\n            - configMapRef:\n                name: gcs-buckets\n            image: gcr.io/xl-ml-test/tensorflow:r2.4.0\n            imagePullPolicy: Always\n            name: train\n            resources:\n              limits:\n                cloud-tpus.google.com/preemptible-v2: 32\n              requests:\n                cpu: 2\n                memory: 20G\n            volumeMounts:\n            - mountPath: /dev/shm\n              name: dshm\n              readOnly: false\n          initContainers:\n          - env:\n            - name: POD_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.name\n            - name: POD_UID\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.uid\n            - name: POD_NAMESPACE\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.namespace\n            - name: JOB_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.labels['job-name']\n            - name: MODEL_DIR\n              value: $(OUTPUT_BUCKET)/tf-r2.4.0/keras-api/custom-layers/v2-32/$(JOB_NAME)\n            - name: METRIC_CONFIG\n              value: \"{\\n \\\"metric_collection_config\\\": {\\n  \\\"default_aggregation_strategies\\\"\\\n                : [\\n   \\\"final\\\"\\n  ],\\n  \\\"metric_to_aggregation_strategies\\\": {\\n\\\n                \\   \\\"examples_per_second\\\": [\\n    \\\"average\\\"\\n   ]\\n  },\\n  \\\"\\\n                use_run_name_prefix\\\": true,\\n  \\\"write_to_bigquery\\\": true\\n },\\n\\\n                \\ \\\"regression_test_config\\\": {\\n  \\\"alert_for_failed_jobs\\\": true\\n\\\n                \\ },\\n \\\"test_name\\\": \\\"tf-r2.4.0-keras-api-custom-layers-v2-32\\\"\\n\\\n                }\\n\"\n            envFrom:\n            - configMapRef:\n                name: gcs-buckets\n            image: gcr.io/xl-ml-test/publisher:stable\n            imagePullPolicy: Always\n            name: publisher\n          nodeSelector:\n            tpu-available: 'true'\n          restartPolicy: Never\n          volumes:\n          - emptyDir:\n              medium: Memory\n            name: dshm\n  schedule: 0 10 * * *\n  successfulJobsHistoryLimit: 1\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"train\" does not have a read-only root file system"
  },
  {
    "id": "1106",
    "manifest_path": "data/manifests/the_stack_sample/sample_0106.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: tf-r2.4.0-keras-api-custom-layers-v2-32\n  namespace: automated\nspec:\n  concurrencyPolicy: Forbid\n  jobTemplate:\n    spec:\n      activeDeadlineSeconds: 7200\n      backoffLimit: 1\n      template:\n        metadata:\n          annotations:\n            tf-version.cloud-tpus.google.com: 2.4.0\n        spec:\n          containers:\n          - env:\n            - name: POD_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.name\n            - name: POD_NAMESPACE\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.namespace\n            image: gcr.io/xl-ml-test/health-monitor:stable\n            imagePullPolicy: Always\n            name: monitor\n          - args:\n            - /bin/bash\n            - -c\n            - 'set -u\n\n              set -e\n\n              set -x\n\n\n              export PATH=$PATH:/root/google-cloud-sdk/bin\n\n              gcloud source repos clone tf2-api-tests --project=xl-ml-test\n\n              cd tf2-api-tests\n\n              pip3 install behave\n\n              behave -e ipynb_checkpoints --tags=-fails --tags=-failspod -i custom_layers_model\n\n              '\n            env:\n            - name: POD_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.name\n            - name: POD_UID\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.uid\n            - name: POD_NAMESPACE\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.namespace\n            - name: JOB_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.labels['job-name']\n            - name: MODEL_DIR\n              value: $(OUTPUT_BUCKET)/tf-r2.4.0/keras-api/custom-layers/v2-32/$(JOB_NAME)\n            envFrom:\n            - configMapRef:\n                name: gcs-buckets\n            image: gcr.io/xl-ml-test/tensorflow:r2.4.0\n            imagePullPolicy: Always\n            name: train\n            resources:\n              limits:\n                cloud-tpus.google.com/preemptible-v2: 32\n              requests:\n                cpu: 2\n                memory: 20G\n            volumeMounts:\n            - mountPath: /dev/shm\n              name: dshm\n              readOnly: false\n          initContainers:\n          - env:\n            - name: POD_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.name\n            - name: POD_UID\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.uid\n            - name: POD_NAMESPACE\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.namespace\n            - name: JOB_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.labels['job-name']\n            - name: MODEL_DIR\n              value: $(OUTPUT_BUCKET)/tf-r2.4.0/keras-api/custom-layers/v2-32/$(JOB_NAME)\n            - name: METRIC_CONFIG\n              value: \"{\\n \\\"metric_collection_config\\\": {\\n  \\\"default_aggregation_strategies\\\"\\\n                : [\\n   \\\"final\\\"\\n  ],\\n  \\\"metric_to_aggregation_strategies\\\": {\\n\\\n                \\   \\\"examples_per_second\\\": [\\n    \\\"average\\\"\\n   ]\\n  },\\n  \\\"\\\n                use_run_name_prefix\\\": true,\\n  \\\"write_to_bigquery\\\": true\\n },\\n\\\n                \\ \\\"regression_test_config\\\": {\\n  \\\"alert_for_failed_jobs\\\": true\\n\\\n                \\ },\\n \\\"test_name\\\": \\\"tf-r2.4.0-keras-api-custom-layers-v2-32\\\"\\n\\\n                }\\n\"\n            envFrom:\n            - configMapRef:\n                name: gcs-buckets\n            image: gcr.io/xl-ml-test/publisher:stable\n            imagePullPolicy: Always\n            name: publisher\n          nodeSelector:\n            tpu-available: 'true'\n          restartPolicy: Never\n          volumes:\n          - emptyDir:\n              medium: Memory\n            name: dshm\n  schedule: 0 10 * * *\n  successfulJobsHistoryLimit: 1\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"monitor\" is not set to runAsNonRoot"
  },
  {
    "id": "1107",
    "manifest_path": "data/manifests/the_stack_sample/sample_0106.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: tf-r2.4.0-keras-api-custom-layers-v2-32\n  namespace: automated\nspec:\n  concurrencyPolicy: Forbid\n  jobTemplate:\n    spec:\n      activeDeadlineSeconds: 7200\n      backoffLimit: 1\n      template:\n        metadata:\n          annotations:\n            tf-version.cloud-tpus.google.com: 2.4.0\n        spec:\n          containers:\n          - env:\n            - name: POD_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.name\n            - name: POD_NAMESPACE\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.namespace\n            image: gcr.io/xl-ml-test/health-monitor:stable\n            imagePullPolicy: Always\n            name: monitor\n          - args:\n            - /bin/bash\n            - -c\n            - 'set -u\n\n              set -e\n\n              set -x\n\n\n              export PATH=$PATH:/root/google-cloud-sdk/bin\n\n              gcloud source repos clone tf2-api-tests --project=xl-ml-test\n\n              cd tf2-api-tests\n\n              pip3 install behave\n\n              behave -e ipynb_checkpoints --tags=-fails --tags=-failspod -i custom_layers_model\n\n              '\n            env:\n            - name: POD_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.name\n            - name: POD_UID\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.uid\n            - name: POD_NAMESPACE\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.namespace\n            - name: JOB_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.labels['job-name']\n            - name: MODEL_DIR\n              value: $(OUTPUT_BUCKET)/tf-r2.4.0/keras-api/custom-layers/v2-32/$(JOB_NAME)\n            envFrom:\n            - configMapRef:\n                name: gcs-buckets\n            image: gcr.io/xl-ml-test/tensorflow:r2.4.0\n            imagePullPolicy: Always\n            name: train\n            resources:\n              limits:\n                cloud-tpus.google.com/preemptible-v2: 32\n              requests:\n                cpu: 2\n                memory: 20G\n            volumeMounts:\n            - mountPath: /dev/shm\n              name: dshm\n              readOnly: false\n          initContainers:\n          - env:\n            - name: POD_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.name\n            - name: POD_UID\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.uid\n            - name: POD_NAMESPACE\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.namespace\n            - name: JOB_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.labels['job-name']\n            - name: MODEL_DIR\n              value: $(OUTPUT_BUCKET)/tf-r2.4.0/keras-api/custom-layers/v2-32/$(JOB_NAME)\n            - name: METRIC_CONFIG\n              value: \"{\\n \\\"metric_collection_config\\\": {\\n  \\\"default_aggregation_strategies\\\"\\\n                : [\\n   \\\"final\\\"\\n  ],\\n  \\\"metric_to_aggregation_strategies\\\": {\\n\\\n                \\   \\\"examples_per_second\\\": [\\n    \\\"average\\\"\\n   ]\\n  },\\n  \\\"\\\n                use_run_name_prefix\\\": true,\\n  \\\"write_to_bigquery\\\": true\\n },\\n\\\n                \\ \\\"regression_test_config\\\": {\\n  \\\"alert_for_failed_jobs\\\": true\\n\\\n                \\ },\\n \\\"test_name\\\": \\\"tf-r2.4.0-keras-api-custom-layers-v2-32\\\"\\n\\\n                }\\n\"\n            envFrom:\n            - configMapRef:\n                name: gcs-buckets\n            image: gcr.io/xl-ml-test/publisher:stable\n            imagePullPolicy: Always\n            name: publisher\n          nodeSelector:\n            tpu-available: 'true'\n          restartPolicy: Never\n          volumes:\n          - emptyDir:\n              medium: Memory\n            name: dshm\n  schedule: 0 10 * * *\n  successfulJobsHistoryLimit: 1\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"publisher\" is not set to runAsNonRoot"
  },
  {
    "id": "1108",
    "manifest_path": "data/manifests/the_stack_sample/sample_0106.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: tf-r2.4.0-keras-api-custom-layers-v2-32\n  namespace: automated\nspec:\n  concurrencyPolicy: Forbid\n  jobTemplate:\n    spec:\n      activeDeadlineSeconds: 7200\n      backoffLimit: 1\n      template:\n        metadata:\n          annotations:\n            tf-version.cloud-tpus.google.com: 2.4.0\n        spec:\n          containers:\n          - env:\n            - name: POD_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.name\n            - name: POD_NAMESPACE\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.namespace\n            image: gcr.io/xl-ml-test/health-monitor:stable\n            imagePullPolicy: Always\n            name: monitor\n          - args:\n            - /bin/bash\n            - -c\n            - 'set -u\n\n              set -e\n\n              set -x\n\n\n              export PATH=$PATH:/root/google-cloud-sdk/bin\n\n              gcloud source repos clone tf2-api-tests --project=xl-ml-test\n\n              cd tf2-api-tests\n\n              pip3 install behave\n\n              behave -e ipynb_checkpoints --tags=-fails --tags=-failspod -i custom_layers_model\n\n              '\n            env:\n            - name: POD_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.name\n            - name: POD_UID\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.uid\n            - name: POD_NAMESPACE\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.namespace\n            - name: JOB_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.labels['job-name']\n            - name: MODEL_DIR\n              value: $(OUTPUT_BUCKET)/tf-r2.4.0/keras-api/custom-layers/v2-32/$(JOB_NAME)\n            envFrom:\n            - configMapRef:\n                name: gcs-buckets\n            image: gcr.io/xl-ml-test/tensorflow:r2.4.0\n            imagePullPolicy: Always\n            name: train\n            resources:\n              limits:\n                cloud-tpus.google.com/preemptible-v2: 32\n              requests:\n                cpu: 2\n                memory: 20G\n            volumeMounts:\n            - mountPath: /dev/shm\n              name: dshm\n              readOnly: false\n          initContainers:\n          - env:\n            - name: POD_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.name\n            - name: POD_UID\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.uid\n            - name: POD_NAMESPACE\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.namespace\n            - name: JOB_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.labels['job-name']\n            - name: MODEL_DIR\n              value: $(OUTPUT_BUCKET)/tf-r2.4.0/keras-api/custom-layers/v2-32/$(JOB_NAME)\n            - name: METRIC_CONFIG\n              value: \"{\\n \\\"metric_collection_config\\\": {\\n  \\\"default_aggregation_strategies\\\"\\\n                : [\\n   \\\"final\\\"\\n  ],\\n  \\\"metric_to_aggregation_strategies\\\": {\\n\\\n                \\   \\\"examples_per_second\\\": [\\n    \\\"average\\\"\\n   ]\\n  },\\n  \\\"\\\n                use_run_name_prefix\\\": true,\\n  \\\"write_to_bigquery\\\": true\\n },\\n\\\n                \\ \\\"regression_test_config\\\": {\\n  \\\"alert_for_failed_jobs\\\": true\\n\\\n                \\ },\\n \\\"test_name\\\": \\\"tf-r2.4.0-keras-api-custom-layers-v2-32\\\"\\n\\\n                }\\n\"\n            envFrom:\n            - configMapRef:\n                name: gcs-buckets\n            image: gcr.io/xl-ml-test/publisher:stable\n            imagePullPolicy: Always\n            name: publisher\n          nodeSelector:\n            tpu-available: 'true'\n          restartPolicy: Never\n          volumes:\n          - emptyDir:\n              medium: Memory\n            name: dshm\n  schedule: 0 10 * * *\n  successfulJobsHistoryLimit: 1\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"train\" is not set to runAsNonRoot"
  },
  {
    "id": "1109",
    "manifest_path": "data/manifests/the_stack_sample/sample_0106.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: tf-r2.4.0-keras-api-custom-layers-v2-32\n  namespace: automated\nspec:\n  concurrencyPolicy: Forbid\n  jobTemplate:\n    spec:\n      activeDeadlineSeconds: 7200\n      backoffLimit: 1\n      template:\n        metadata:\n          annotations:\n            tf-version.cloud-tpus.google.com: 2.4.0\n        spec:\n          containers:\n          - env:\n            - name: POD_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.name\n            - name: POD_NAMESPACE\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.namespace\n            image: gcr.io/xl-ml-test/health-monitor:stable\n            imagePullPolicy: Always\n            name: monitor\n          - args:\n            - /bin/bash\n            - -c\n            - 'set -u\n\n              set -e\n\n              set -x\n\n\n              export PATH=$PATH:/root/google-cloud-sdk/bin\n\n              gcloud source repos clone tf2-api-tests --project=xl-ml-test\n\n              cd tf2-api-tests\n\n              pip3 install behave\n\n              behave -e ipynb_checkpoints --tags=-fails --tags=-failspod -i custom_layers_model\n\n              '\n            env:\n            - name: POD_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.name\n            - name: POD_UID\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.uid\n            - name: POD_NAMESPACE\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.namespace\n            - name: JOB_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.labels['job-name']\n            - name: MODEL_DIR\n              value: $(OUTPUT_BUCKET)/tf-r2.4.0/keras-api/custom-layers/v2-32/$(JOB_NAME)\n            envFrom:\n            - configMapRef:\n                name: gcs-buckets\n            image: gcr.io/xl-ml-test/tensorflow:r2.4.0\n            imagePullPolicy: Always\n            name: train\n            resources:\n              limits:\n                cloud-tpus.google.com/preemptible-v2: 32\n              requests:\n                cpu: 2\n                memory: 20G\n            volumeMounts:\n            - mountPath: /dev/shm\n              name: dshm\n              readOnly: false\n          initContainers:\n          - env:\n            - name: POD_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.name\n            - name: POD_UID\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.uid\n            - name: POD_NAMESPACE\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.namespace\n            - name: JOB_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.labels['job-name']\n            - name: MODEL_DIR\n              value: $(OUTPUT_BUCKET)/tf-r2.4.0/keras-api/custom-layers/v2-32/$(JOB_NAME)\n            - name: METRIC_CONFIG\n              value: \"{\\n \\\"metric_collection_config\\\": {\\n  \\\"default_aggregation_strategies\\\"\\\n                : [\\n   \\\"final\\\"\\n  ],\\n  \\\"metric_to_aggregation_strategies\\\": {\\n\\\n                \\   \\\"examples_per_second\\\": [\\n    \\\"average\\\"\\n   ]\\n  },\\n  \\\"\\\n                use_run_name_prefix\\\": true,\\n  \\\"write_to_bigquery\\\": true\\n },\\n\\\n                \\ \\\"regression_test_config\\\": {\\n  \\\"alert_for_failed_jobs\\\": true\\n\\\n                \\ },\\n \\\"test_name\\\": \\\"tf-r2.4.0-keras-api-custom-layers-v2-32\\\"\\n\\\n                }\\n\"\n            envFrom:\n            - configMapRef:\n                name: gcs-buckets\n            image: gcr.io/xl-ml-test/publisher:stable\n            imagePullPolicy: Always\n            name: publisher\n          nodeSelector:\n            tpu-available: 'true'\n          restartPolicy: Never\n          volumes:\n          - emptyDir:\n              medium: Memory\n            name: dshm\n  schedule: 0 10 * * *\n  successfulJobsHistoryLimit: 1\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"monitor\" has cpu request 0"
  },
  {
    "id": "1110",
    "manifest_path": "data/manifests/the_stack_sample/sample_0106.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: tf-r2.4.0-keras-api-custom-layers-v2-32\n  namespace: automated\nspec:\n  concurrencyPolicy: Forbid\n  jobTemplate:\n    spec:\n      activeDeadlineSeconds: 7200\n      backoffLimit: 1\n      template:\n        metadata:\n          annotations:\n            tf-version.cloud-tpus.google.com: 2.4.0\n        spec:\n          containers:\n          - env:\n            - name: POD_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.name\n            - name: POD_NAMESPACE\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.namespace\n            image: gcr.io/xl-ml-test/health-monitor:stable\n            imagePullPolicy: Always\n            name: monitor\n          - args:\n            - /bin/bash\n            - -c\n            - 'set -u\n\n              set -e\n\n              set -x\n\n\n              export PATH=$PATH:/root/google-cloud-sdk/bin\n\n              gcloud source repos clone tf2-api-tests --project=xl-ml-test\n\n              cd tf2-api-tests\n\n              pip3 install behave\n\n              behave -e ipynb_checkpoints --tags=-fails --tags=-failspod -i custom_layers_model\n\n              '\n            env:\n            - name: POD_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.name\n            - name: POD_UID\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.uid\n            - name: POD_NAMESPACE\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.namespace\n            - name: JOB_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.labels['job-name']\n            - name: MODEL_DIR\n              value: $(OUTPUT_BUCKET)/tf-r2.4.0/keras-api/custom-layers/v2-32/$(JOB_NAME)\n            envFrom:\n            - configMapRef:\n                name: gcs-buckets\n            image: gcr.io/xl-ml-test/tensorflow:r2.4.0\n            imagePullPolicy: Always\n            name: train\n            resources:\n              limits:\n                cloud-tpus.google.com/preemptible-v2: 32\n              requests:\n                cpu: 2\n                memory: 20G\n            volumeMounts:\n            - mountPath: /dev/shm\n              name: dshm\n              readOnly: false\n          initContainers:\n          - env:\n            - name: POD_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.name\n            - name: POD_UID\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.uid\n            - name: POD_NAMESPACE\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.namespace\n            - name: JOB_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.labels['job-name']\n            - name: MODEL_DIR\n              value: $(OUTPUT_BUCKET)/tf-r2.4.0/keras-api/custom-layers/v2-32/$(JOB_NAME)\n            - name: METRIC_CONFIG\n              value: \"{\\n \\\"metric_collection_config\\\": {\\n  \\\"default_aggregation_strategies\\\"\\\n                : [\\n   \\\"final\\\"\\n  ],\\n  \\\"metric_to_aggregation_strategies\\\": {\\n\\\n                \\   \\\"examples_per_second\\\": [\\n    \\\"average\\\"\\n   ]\\n  },\\n  \\\"\\\n                use_run_name_prefix\\\": true,\\n  \\\"write_to_bigquery\\\": true\\n },\\n\\\n                \\ \\\"regression_test_config\\\": {\\n  \\\"alert_for_failed_jobs\\\": true\\n\\\n                \\ },\\n \\\"test_name\\\": \\\"tf-r2.4.0-keras-api-custom-layers-v2-32\\\"\\n\\\n                }\\n\"\n            envFrom:\n            - configMapRef:\n                name: gcs-buckets\n            image: gcr.io/xl-ml-test/publisher:stable\n            imagePullPolicy: Always\n            name: publisher\n          nodeSelector:\n            tpu-available: 'true'\n          restartPolicy: Never\n          volumes:\n          - emptyDir:\n              medium: Memory\n            name: dshm\n  schedule: 0 10 * * *\n  successfulJobsHistoryLimit: 1\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"publisher\" has cpu request 0"
  },
  {
    "id": "1111",
    "manifest_path": "data/manifests/the_stack_sample/sample_0106.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: tf-r2.4.0-keras-api-custom-layers-v2-32\n  namespace: automated\nspec:\n  concurrencyPolicy: Forbid\n  jobTemplate:\n    spec:\n      activeDeadlineSeconds: 7200\n      backoffLimit: 1\n      template:\n        metadata:\n          annotations:\n            tf-version.cloud-tpus.google.com: 2.4.0\n        spec:\n          containers:\n          - env:\n            - name: POD_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.name\n            - name: POD_NAMESPACE\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.namespace\n            image: gcr.io/xl-ml-test/health-monitor:stable\n            imagePullPolicy: Always\n            name: monitor\n          - args:\n            - /bin/bash\n            - -c\n            - 'set -u\n\n              set -e\n\n              set -x\n\n\n              export PATH=$PATH:/root/google-cloud-sdk/bin\n\n              gcloud source repos clone tf2-api-tests --project=xl-ml-test\n\n              cd tf2-api-tests\n\n              pip3 install behave\n\n              behave -e ipynb_checkpoints --tags=-fails --tags=-failspod -i custom_layers_model\n\n              '\n            env:\n            - name: POD_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.name\n            - name: POD_UID\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.uid\n            - name: POD_NAMESPACE\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.namespace\n            - name: JOB_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.labels['job-name']\n            - name: MODEL_DIR\n              value: $(OUTPUT_BUCKET)/tf-r2.4.0/keras-api/custom-layers/v2-32/$(JOB_NAME)\n            envFrom:\n            - configMapRef:\n                name: gcs-buckets\n            image: gcr.io/xl-ml-test/tensorflow:r2.4.0\n            imagePullPolicy: Always\n            name: train\n            resources:\n              limits:\n                cloud-tpus.google.com/preemptible-v2: 32\n              requests:\n                cpu: 2\n                memory: 20G\n            volumeMounts:\n            - mountPath: /dev/shm\n              name: dshm\n              readOnly: false\n          initContainers:\n          - env:\n            - name: POD_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.name\n            - name: POD_UID\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.uid\n            - name: POD_NAMESPACE\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.namespace\n            - name: JOB_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.labels['job-name']\n            - name: MODEL_DIR\n              value: $(OUTPUT_BUCKET)/tf-r2.4.0/keras-api/custom-layers/v2-32/$(JOB_NAME)\n            - name: METRIC_CONFIG\n              value: \"{\\n \\\"metric_collection_config\\\": {\\n  \\\"default_aggregation_strategies\\\"\\\n                : [\\n   \\\"final\\\"\\n  ],\\n  \\\"metric_to_aggregation_strategies\\\": {\\n\\\n                \\   \\\"examples_per_second\\\": [\\n    \\\"average\\\"\\n   ]\\n  },\\n  \\\"\\\n                use_run_name_prefix\\\": true,\\n  \\\"write_to_bigquery\\\": true\\n },\\n\\\n                \\ \\\"regression_test_config\\\": {\\n  \\\"alert_for_failed_jobs\\\": true\\n\\\n                \\ },\\n \\\"test_name\\\": \\\"tf-r2.4.0-keras-api-custom-layers-v2-32\\\"\\n\\\n                }\\n\"\n            envFrom:\n            - configMapRef:\n                name: gcs-buckets\n            image: gcr.io/xl-ml-test/publisher:stable\n            imagePullPolicy: Always\n            name: publisher\n          nodeSelector:\n            tpu-available: 'true'\n          restartPolicy: Never\n          volumes:\n          - emptyDir:\n              medium: Memory\n            name: dshm\n  schedule: 0 10 * * *\n  successfulJobsHistoryLimit: 1\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"monitor\" has memory limit 0"
  },
  {
    "id": "1112",
    "manifest_path": "data/manifests/the_stack_sample/sample_0106.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: tf-r2.4.0-keras-api-custom-layers-v2-32\n  namespace: automated\nspec:\n  concurrencyPolicy: Forbid\n  jobTemplate:\n    spec:\n      activeDeadlineSeconds: 7200\n      backoffLimit: 1\n      template:\n        metadata:\n          annotations:\n            tf-version.cloud-tpus.google.com: 2.4.0\n        spec:\n          containers:\n          - env:\n            - name: POD_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.name\n            - name: POD_NAMESPACE\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.namespace\n            image: gcr.io/xl-ml-test/health-monitor:stable\n            imagePullPolicy: Always\n            name: monitor\n          - args:\n            - /bin/bash\n            - -c\n            - 'set -u\n\n              set -e\n\n              set -x\n\n\n              export PATH=$PATH:/root/google-cloud-sdk/bin\n\n              gcloud source repos clone tf2-api-tests --project=xl-ml-test\n\n              cd tf2-api-tests\n\n              pip3 install behave\n\n              behave -e ipynb_checkpoints --tags=-fails --tags=-failspod -i custom_layers_model\n\n              '\n            env:\n            - name: POD_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.name\n            - name: POD_UID\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.uid\n            - name: POD_NAMESPACE\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.namespace\n            - name: JOB_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.labels['job-name']\n            - name: MODEL_DIR\n              value: $(OUTPUT_BUCKET)/tf-r2.4.0/keras-api/custom-layers/v2-32/$(JOB_NAME)\n            envFrom:\n            - configMapRef:\n                name: gcs-buckets\n            image: gcr.io/xl-ml-test/tensorflow:r2.4.0\n            imagePullPolicy: Always\n            name: train\n            resources:\n              limits:\n                cloud-tpus.google.com/preemptible-v2: 32\n              requests:\n                cpu: 2\n                memory: 20G\n            volumeMounts:\n            - mountPath: /dev/shm\n              name: dshm\n              readOnly: false\n          initContainers:\n          - env:\n            - name: POD_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.name\n            - name: POD_UID\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.uid\n            - name: POD_NAMESPACE\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.namespace\n            - name: JOB_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.labels['job-name']\n            - name: MODEL_DIR\n              value: $(OUTPUT_BUCKET)/tf-r2.4.0/keras-api/custom-layers/v2-32/$(JOB_NAME)\n            - name: METRIC_CONFIG\n              value: \"{\\n \\\"metric_collection_config\\\": {\\n  \\\"default_aggregation_strategies\\\"\\\n                : [\\n   \\\"final\\\"\\n  ],\\n  \\\"metric_to_aggregation_strategies\\\": {\\n\\\n                \\   \\\"examples_per_second\\\": [\\n    \\\"average\\\"\\n   ]\\n  },\\n  \\\"\\\n                use_run_name_prefix\\\": true,\\n  \\\"write_to_bigquery\\\": true\\n },\\n\\\n                \\ \\\"regression_test_config\\\": {\\n  \\\"alert_for_failed_jobs\\\": true\\n\\\n                \\ },\\n \\\"test_name\\\": \\\"tf-r2.4.0-keras-api-custom-layers-v2-32\\\"\\n\\\n                }\\n\"\n            envFrom:\n            - configMapRef:\n                name: gcs-buckets\n            image: gcr.io/xl-ml-test/publisher:stable\n            imagePullPolicy: Always\n            name: publisher\n          nodeSelector:\n            tpu-available: 'true'\n          restartPolicy: Never\n          volumes:\n          - emptyDir:\n              medium: Memory\n            name: dshm\n  schedule: 0 10 * * *\n  successfulJobsHistoryLimit: 1\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"publisher\" has memory limit 0"
  },
  {
    "id": "1113",
    "manifest_path": "data/manifests/the_stack_sample/sample_0106.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: tf-r2.4.0-keras-api-custom-layers-v2-32\n  namespace: automated\nspec:\n  concurrencyPolicy: Forbid\n  jobTemplate:\n    spec:\n      activeDeadlineSeconds: 7200\n      backoffLimit: 1\n      template:\n        metadata:\n          annotations:\n            tf-version.cloud-tpus.google.com: 2.4.0\n        spec:\n          containers:\n          - env:\n            - name: POD_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.name\n            - name: POD_NAMESPACE\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.namespace\n            image: gcr.io/xl-ml-test/health-monitor:stable\n            imagePullPolicy: Always\n            name: monitor\n          - args:\n            - /bin/bash\n            - -c\n            - 'set -u\n\n              set -e\n\n              set -x\n\n\n              export PATH=$PATH:/root/google-cloud-sdk/bin\n\n              gcloud source repos clone tf2-api-tests --project=xl-ml-test\n\n              cd tf2-api-tests\n\n              pip3 install behave\n\n              behave -e ipynb_checkpoints --tags=-fails --tags=-failspod -i custom_layers_model\n\n              '\n            env:\n            - name: POD_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.name\n            - name: POD_UID\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.uid\n            - name: POD_NAMESPACE\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.namespace\n            - name: JOB_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.labels['job-name']\n            - name: MODEL_DIR\n              value: $(OUTPUT_BUCKET)/tf-r2.4.0/keras-api/custom-layers/v2-32/$(JOB_NAME)\n            envFrom:\n            - configMapRef:\n                name: gcs-buckets\n            image: gcr.io/xl-ml-test/tensorflow:r2.4.0\n            imagePullPolicy: Always\n            name: train\n            resources:\n              limits:\n                cloud-tpus.google.com/preemptible-v2: 32\n              requests:\n                cpu: 2\n                memory: 20G\n            volumeMounts:\n            - mountPath: /dev/shm\n              name: dshm\n              readOnly: false\n          initContainers:\n          - env:\n            - name: POD_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.name\n            - name: POD_UID\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.uid\n            - name: POD_NAMESPACE\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.namespace\n            - name: JOB_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.labels['job-name']\n            - name: MODEL_DIR\n              value: $(OUTPUT_BUCKET)/tf-r2.4.0/keras-api/custom-layers/v2-32/$(JOB_NAME)\n            - name: METRIC_CONFIG\n              value: \"{\\n \\\"metric_collection_config\\\": {\\n  \\\"default_aggregation_strategies\\\"\\\n                : [\\n   \\\"final\\\"\\n  ],\\n  \\\"metric_to_aggregation_strategies\\\": {\\n\\\n                \\   \\\"examples_per_second\\\": [\\n    \\\"average\\\"\\n   ]\\n  },\\n  \\\"\\\n                use_run_name_prefix\\\": true,\\n  \\\"write_to_bigquery\\\": true\\n },\\n\\\n                \\ \\\"regression_test_config\\\": {\\n  \\\"alert_for_failed_jobs\\\": true\\n\\\n                \\ },\\n \\\"test_name\\\": \\\"tf-r2.4.0-keras-api-custom-layers-v2-32\\\"\\n\\\n                }\\n\"\n            envFrom:\n            - configMapRef:\n                name: gcs-buckets\n            image: gcr.io/xl-ml-test/publisher:stable\n            imagePullPolicy: Always\n            name: publisher\n          nodeSelector:\n            tpu-available: 'true'\n          restartPolicy: Never\n          volumes:\n          - emptyDir:\n              medium: Memory\n            name: dshm\n  schedule: 0 10 * * *\n  successfulJobsHistoryLimit: 1\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"train\" has memory limit 0"
  },
  {
    "id": "1114",
    "manifest_path": "data/manifests/the_stack_sample/sample_0107.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: skipper-demo\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      application: skipper-demo\n  template:\n    metadata:\n      labels:\n        application: skipper-demo\n    spec:\n      containers:\n      - name: skipper-demo\n        image: registry.opensource.zalan.do/teapot/skipper:v0.12.0\n        args:\n        - skipper\n        - -inline-routes\n        - '* -> inlineContent(\"<body style=''color: white; background-color: green;''><h1>Hello!</h1>\")\n          -> <shunt>'\n        ports:\n        - containerPort: 9090\n",
    "policy_id": "no-anti-affinity",
    "violation_text": "object has 2 replicas but does not specify inter pod anti-affinity"
  },
  {
    "id": "1115",
    "manifest_path": "data/manifests/the_stack_sample/sample_0107.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: skipper-demo\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      application: skipper-demo\n  template:\n    metadata:\n      labels:\n        application: skipper-demo\n    spec:\n      containers:\n      - name: skipper-demo\n        image: registry.opensource.zalan.do/teapot/skipper:v0.12.0\n        args:\n        - skipper\n        - -inline-routes\n        - '* -> inlineContent(\"<body style=''color: white; background-color: green;''><h1>Hello!</h1>\")\n          -> <shunt>'\n        ports:\n        - containerPort: 9090\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"skipper-demo\" does not have a read-only root file system"
  },
  {
    "id": "1116",
    "manifest_path": "data/manifests/the_stack_sample/sample_0107.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: skipper-demo\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      application: skipper-demo\n  template:\n    metadata:\n      labels:\n        application: skipper-demo\n    spec:\n      containers:\n      - name: skipper-demo\n        image: registry.opensource.zalan.do/teapot/skipper:v0.12.0\n        args:\n        - skipper\n        - -inline-routes\n        - '* -> inlineContent(\"<body style=''color: white; background-color: green;''><h1>Hello!</h1>\")\n          -> <shunt>'\n        ports:\n        - containerPort: 9090\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"skipper-demo\" is not set to runAsNonRoot"
  },
  {
    "id": "1117",
    "manifest_path": "data/manifests/the_stack_sample/sample_0107.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: skipper-demo\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      application: skipper-demo\n  template:\n    metadata:\n      labels:\n        application: skipper-demo\n    spec:\n      containers:\n      - name: skipper-demo\n        image: registry.opensource.zalan.do/teapot/skipper:v0.12.0\n        args:\n        - skipper\n        - -inline-routes\n        - '* -> inlineContent(\"<body style=''color: white; background-color: green;''><h1>Hello!</h1>\")\n          -> <shunt>'\n        ports:\n        - containerPort: 9090\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"skipper-demo\" has cpu request 0"
  },
  {
    "id": "1118",
    "manifest_path": "data/manifests/the_stack_sample/sample_0107.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: skipper-demo\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      application: skipper-demo\n  template:\n    metadata:\n      labels:\n        application: skipper-demo\n    spec:\n      containers:\n      - name: skipper-demo\n        image: registry.opensource.zalan.do/teapot/skipper:v0.12.0\n        args:\n        - skipper\n        - -inline-routes\n        - '* -> inlineContent(\"<body style=''color: white; background-color: green;''><h1>Hello!</h1>\")\n          -> <shunt>'\n        ports:\n        - containerPort: 9090\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"skipper-demo\" has memory limit 0"
  },
  {
    "id": "1119",
    "manifest_path": "data/manifests/the_stack_sample/sample_0108.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Service\nmetadata:\n  name: minio\n  namespace: minio\nspec:\n  ports:\n  - port: 9000\n    protocol: TCP\n    targetPort: 9000\n  selector:\n    app.kubernetes.io/name: minio\n  type: ClusterIP\n",
    "policy_id": "dangling-service",
    "violation_text": "no pods found matching service labels (map[app.kubernetes.io/name:minio])"
  },
  {
    "id": "1120",
    "manifest_path": "data/manifests/the_stack_sample/sample_0109.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-8031\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"nginx\" is using an invalid container image, \"nginx\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "1121",
    "manifest_path": "data/manifests/the_stack_sample/sample_0109.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-8031\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"nginx\" does not have a read-only root file system"
  },
  {
    "id": "1122",
    "manifest_path": "data/manifests/the_stack_sample/sample_0109.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-8031\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"nginx\" is not set to runAsNonRoot"
  },
  {
    "id": "1123",
    "manifest_path": "data/manifests/the_stack_sample/sample_0109.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-8031\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"nginx\" has cpu request 0"
  },
  {
    "id": "1124",
    "manifest_path": "data/manifests/the_stack_sample/sample_0109.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-8031\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"nginx\" has memory limit 0"
  },
  {
    "id": "1125",
    "manifest_path": "data/manifests/the_stack_sample/sample_0110.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-9918\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"nginx\" is using an invalid container image, \"nginx\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "1126",
    "manifest_path": "data/manifests/the_stack_sample/sample_0110.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-9918\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"nginx\" does not have a read-only root file system"
  },
  {
    "id": "1127",
    "manifest_path": "data/manifests/the_stack_sample/sample_0110.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-9918\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"nginx\" is not set to runAsNonRoot"
  },
  {
    "id": "1128",
    "manifest_path": "data/manifests/the_stack_sample/sample_0110.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-9918\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"nginx\" has cpu request 0"
  },
  {
    "id": "1129",
    "manifest_path": "data/manifests/the_stack_sample/sample_0110.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-9918\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"nginx\" has memory limit 0"
  },
  {
    "id": "1131",
    "manifest_path": "data/manifests/the_stack_sample/sample_0113.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: prow-controller-manager\n  labels:\n    app: prow-controller-manager\nspec:\n  replicas: 1\n  strategy:\n    type: RollingUpdate\n    rollingUpdate:\n      maxSurge: 1\n      maxUnavailable: 1\n  revisionHistoryLimit: 2\n  selector:\n    matchLabels:\n      app: prow-controller-manager\n  template:\n    metadata:\n      labels:\n        app: prow-controller-manager\n    spec:\n      serviceAccountName: prow-controller-manager\n      containers:\n      - name: prow-controller-manager\n        image: gcr.io/k8s-prow/prow-controller-manager:v20220203-9315ecd1a0\n        args:\n        - --config-path=/etc/config/config.yaml\n        - --dry-run=false\n        - --enable-controller=plank\n        - --job-config-path=/etc/job-config\n        env:\n        - name: KUBECONFIG\n          value: /etc/kubeconfig/config:/etc/kubeconfig-build-test-infra-trusted/kubeconfig\n        ports:\n        - name: metrics\n          containerPort: 9090\n        volumeMounts:\n        - mountPath: /etc/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        - mountPath: /etc/kubeconfig-build-test-infra-trusted\n          name: kubeconfig-build-test-infra-trusted\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 5\n        readinessProbe:\n          httpGet:\n            path: /healthz/ready\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 3\n      volumes:\n      - name: kubeconfig\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig\n      - name: kubeconfig-build-test-infra-trusted\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig-build-test-infra-trusted\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"prow-controller-manager\" does not have a read-only root file system"
  },
  {
    "id": "1132",
    "manifest_path": "data/manifests/the_stack_sample/sample_0113.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: prow-controller-manager\n  labels:\n    app: prow-controller-manager\nspec:\n  replicas: 1\n  strategy:\n    type: RollingUpdate\n    rollingUpdate:\n      maxSurge: 1\n      maxUnavailable: 1\n  revisionHistoryLimit: 2\n  selector:\n    matchLabels:\n      app: prow-controller-manager\n  template:\n    metadata:\n      labels:\n        app: prow-controller-manager\n    spec:\n      serviceAccountName: prow-controller-manager\n      containers:\n      - name: prow-controller-manager\n        image: gcr.io/k8s-prow/prow-controller-manager:v20220203-9315ecd1a0\n        args:\n        - --config-path=/etc/config/config.yaml\n        - --dry-run=false\n        - --enable-controller=plank\n        - --job-config-path=/etc/job-config\n        env:\n        - name: KUBECONFIG\n          value: /etc/kubeconfig/config:/etc/kubeconfig-build-test-infra-trusted/kubeconfig\n        ports:\n        - name: metrics\n          containerPort: 9090\n        volumeMounts:\n        - mountPath: /etc/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        - mountPath: /etc/kubeconfig-build-test-infra-trusted\n          name: kubeconfig-build-test-infra-trusted\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 5\n        readinessProbe:\n          httpGet:\n            path: /healthz/ready\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 3\n      volumes:\n      - name: kubeconfig\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig\n      - name: kubeconfig-build-test-infra-trusted\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig-build-test-infra-trusted\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n",
    "policy_id": "non-existent-service-account",
    "violation_text": "serviceAccount \"prow-controller-manager\" not found"
  },
  {
    "id": "1134",
    "manifest_path": "data/manifests/the_stack_sample/sample_0113.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: prow-controller-manager\n  labels:\n    app: prow-controller-manager\nspec:\n  replicas: 1\n  strategy:\n    type: RollingUpdate\n    rollingUpdate:\n      maxSurge: 1\n      maxUnavailable: 1\n  revisionHistoryLimit: 2\n  selector:\n    matchLabels:\n      app: prow-controller-manager\n  template:\n    metadata:\n      labels:\n        app: prow-controller-manager\n    spec:\n      serviceAccountName: prow-controller-manager\n      containers:\n      - name: prow-controller-manager\n        image: gcr.io/k8s-prow/prow-controller-manager:v20220203-9315ecd1a0\n        args:\n        - --config-path=/etc/config/config.yaml\n        - --dry-run=false\n        - --enable-controller=plank\n        - --job-config-path=/etc/job-config\n        env:\n        - name: KUBECONFIG\n          value: /etc/kubeconfig/config:/etc/kubeconfig-build-test-infra-trusted/kubeconfig\n        ports:\n        - name: metrics\n          containerPort: 9090\n        volumeMounts:\n        - mountPath: /etc/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        - mountPath: /etc/kubeconfig-build-test-infra-trusted\n          name: kubeconfig-build-test-infra-trusted\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 5\n        readinessProbe:\n          httpGet:\n            path: /healthz/ready\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 3\n      volumes:\n      - name: kubeconfig\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig\n      - name: kubeconfig-build-test-infra-trusted\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig-build-test-infra-trusted\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"prow-controller-manager\" is not set to runAsNonRoot"
  },
  {
    "id": "1135",
    "manifest_path": "data/manifests/the_stack_sample/sample_0113.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: prow-controller-manager\n  labels:\n    app: prow-controller-manager\nspec:\n  replicas: 1\n  strategy:\n    type: RollingUpdate\n    rollingUpdate:\n      maxSurge: 1\n      maxUnavailable: 1\n  revisionHistoryLimit: 2\n  selector:\n    matchLabels:\n      app: prow-controller-manager\n  template:\n    metadata:\n      labels:\n        app: prow-controller-manager\n    spec:\n      serviceAccountName: prow-controller-manager\n      containers:\n      - name: prow-controller-manager\n        image: gcr.io/k8s-prow/prow-controller-manager:v20220203-9315ecd1a0\n        args:\n        - --config-path=/etc/config/config.yaml\n        - --dry-run=false\n        - --enable-controller=plank\n        - --job-config-path=/etc/job-config\n        env:\n        - name: KUBECONFIG\n          value: /etc/kubeconfig/config:/etc/kubeconfig-build-test-infra-trusted/kubeconfig\n        ports:\n        - name: metrics\n          containerPort: 9090\n        volumeMounts:\n        - mountPath: /etc/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        - mountPath: /etc/kubeconfig-build-test-infra-trusted\n          name: kubeconfig-build-test-infra-trusted\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 5\n        readinessProbe:\n          httpGet:\n            path: /healthz/ready\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 3\n      volumes:\n      - name: kubeconfig\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig\n      - name: kubeconfig-build-test-infra-trusted\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig-build-test-infra-trusted\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"prow-controller-manager\" has cpu request 0"
  },
  {
    "id": "1136",
    "manifest_path": "data/manifests/the_stack_sample/sample_0113.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: prow-controller-manager\n  labels:\n    app: prow-controller-manager\nspec:\n  replicas: 1\n  strategy:\n    type: RollingUpdate\n    rollingUpdate:\n      maxSurge: 1\n      maxUnavailable: 1\n  revisionHistoryLimit: 2\n  selector:\n    matchLabels:\n      app: prow-controller-manager\n  template:\n    metadata:\n      labels:\n        app: prow-controller-manager\n    spec:\n      serviceAccountName: prow-controller-manager\n      containers:\n      - name: prow-controller-manager\n        image: gcr.io/k8s-prow/prow-controller-manager:v20220203-9315ecd1a0\n        args:\n        - --config-path=/etc/config/config.yaml\n        - --dry-run=false\n        - --enable-controller=plank\n        - --job-config-path=/etc/job-config\n        env:\n        - name: KUBECONFIG\n          value: /etc/kubeconfig/config:/etc/kubeconfig-build-test-infra-trusted/kubeconfig\n        ports:\n        - name: metrics\n          containerPort: 9090\n        volumeMounts:\n        - mountPath: /etc/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        - mountPath: /etc/kubeconfig-build-test-infra-trusted\n          name: kubeconfig-build-test-infra-trusted\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 5\n        readinessProbe:\n          httpGet:\n            path: /healthz/ready\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 3\n      volumes:\n      - name: kubeconfig\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig\n      - name: kubeconfig-build-test-infra-trusted\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig-build-test-infra-trusted\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"prow-controller-manager\" has memory limit 0"
  },
  {
    "id": "1137",
    "manifest_path": "data/manifests/the_stack_sample/sample_0114.yaml",
    "manifest_yaml": "kind: Service\napiVersion: v1\nmetadata:\n  name: homeautomation-backend\n  labels:\n    app: homeautomation\n    tier: backend\nspec:\n  selector:\n    app: homeautomation\n    tier: backend\n  ports:\n  - name: http\n    protocol: TCP\n    port: 80\n    targetPort: 80\n  - name: https\n    protocol: TCP\n    port: 443\n    targetPort: 443\n  type: LoadBalancer\n",
    "policy_id": "dangling-service",
    "violation_text": "no pods found matching service labels (map[app:homeautomation tier:backend])"
  },
  {
    "id": "1138",
    "manifest_path": "data/manifests/the_stack_sample/sample_0116.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: ReplicaSet\nmetadata:\n  name: payment\n  labels:\n    app: payment\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: payment\n  template:\n    metadata:\n      labels:\n        app: payment\n    spec:\n      containers:\n      - name: server\n        image: hipster-paymentservice:v0.0.1\n        resources: {}\n        env:\n        - name: PORT\n          value: '8080'\n        - name: PRODUCT_CATALOG_SERVICE_ADDR\n          value: productcatalogservice:3550\n        - name: CURRENCY_SERVICE_ADDR\n          value: currencyservice:7000\n        - name: CART_SERVICE_ADDR\n          value: cartservice:7070\n        - name: RECOMMENDATION_SERVICE_ADDR\n          value: recommendationservice:8080\n        - name: SHIPPING_SERVICE_ADDR\n          value: shippingservice:50051\n        - name: CHECKOUT_SERVICE_ADDR\n          value: checkoutservice:5050\n        - name: AD_SERVICE_ADDR\n          value: adservice:9555\n        - name: ENV_PLATFORM\n          value: gcp\n",
    "policy_id": "no-anti-affinity",
    "violation_text": "object has 3 replicas but does not specify inter pod anti-affinity"
  },
  {
    "id": "1139",
    "manifest_path": "data/manifests/the_stack_sample/sample_0116.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: ReplicaSet\nmetadata:\n  name: payment\n  labels:\n    app: payment\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: payment\n  template:\n    metadata:\n      labels:\n        app: payment\n    spec:\n      containers:\n      - name: server\n        image: hipster-paymentservice:v0.0.1\n        resources: {}\n        env:\n        - name: PORT\n          value: '8080'\n        - name: PRODUCT_CATALOG_SERVICE_ADDR\n          value: productcatalogservice:3550\n        - name: CURRENCY_SERVICE_ADDR\n          value: currencyservice:7000\n        - name: CART_SERVICE_ADDR\n          value: cartservice:7070\n        - name: RECOMMENDATION_SERVICE_ADDR\n          value: recommendationservice:8080\n        - name: SHIPPING_SERVICE_ADDR\n          value: shippingservice:50051\n        - name: CHECKOUT_SERVICE_ADDR\n          value: checkoutservice:5050\n        - name: AD_SERVICE_ADDR\n          value: adservice:9555\n        - name: ENV_PLATFORM\n          value: gcp\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"server\" does not have a read-only root file system"
  },
  {
    "id": "1140",
    "manifest_path": "data/manifests/the_stack_sample/sample_0116.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: ReplicaSet\nmetadata:\n  name: payment\n  labels:\n    app: payment\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: payment\n  template:\n    metadata:\n      labels:\n        app: payment\n    spec:\n      containers:\n      - name: server\n        image: hipster-paymentservice:v0.0.1\n        resources: {}\n        env:\n        - name: PORT\n          value: '8080'\n        - name: PRODUCT_CATALOG_SERVICE_ADDR\n          value: productcatalogservice:3550\n        - name: CURRENCY_SERVICE_ADDR\n          value: currencyservice:7000\n        - name: CART_SERVICE_ADDR\n          value: cartservice:7070\n        - name: RECOMMENDATION_SERVICE_ADDR\n          value: recommendationservice:8080\n        - name: SHIPPING_SERVICE_ADDR\n          value: shippingservice:50051\n        - name: CHECKOUT_SERVICE_ADDR\n          value: checkoutservice:5050\n        - name: AD_SERVICE_ADDR\n          value: adservice:9555\n        - name: ENV_PLATFORM\n          value: gcp\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"server\" is not set to runAsNonRoot"
  },
  {
    "id": "1141",
    "manifest_path": "data/manifests/the_stack_sample/sample_0116.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: ReplicaSet\nmetadata:\n  name: payment\n  labels:\n    app: payment\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: payment\n  template:\n    metadata:\n      labels:\n        app: payment\n    spec:\n      containers:\n      - name: server\n        image: hipster-paymentservice:v0.0.1\n        resources: {}\n        env:\n        - name: PORT\n          value: '8080'\n        - name: PRODUCT_CATALOG_SERVICE_ADDR\n          value: productcatalogservice:3550\n        - name: CURRENCY_SERVICE_ADDR\n          value: currencyservice:7000\n        - name: CART_SERVICE_ADDR\n          value: cartservice:7070\n        - name: RECOMMENDATION_SERVICE_ADDR\n          value: recommendationservice:8080\n        - name: SHIPPING_SERVICE_ADDR\n          value: shippingservice:50051\n        - name: CHECKOUT_SERVICE_ADDR\n          value: checkoutservice:5050\n        - name: AD_SERVICE_ADDR\n          value: adservice:9555\n        - name: ENV_PLATFORM\n          value: gcp\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"server\" has cpu request 0"
  },
  {
    "id": "1142",
    "manifest_path": "data/manifests/the_stack_sample/sample_0116.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: ReplicaSet\nmetadata:\n  name: payment\n  labels:\n    app: payment\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: payment\n  template:\n    metadata:\n      labels:\n        app: payment\n    spec:\n      containers:\n      - name: server\n        image: hipster-paymentservice:v0.0.1\n        resources: {}\n        env:\n        - name: PORT\n          value: '8080'\n        - name: PRODUCT_CATALOG_SERVICE_ADDR\n          value: productcatalogservice:3550\n        - name: CURRENCY_SERVICE_ADDR\n          value: currencyservice:7000\n        - name: CART_SERVICE_ADDR\n          value: cartservice:7070\n        - name: RECOMMENDATION_SERVICE_ADDR\n          value: recommendationservice:8080\n        - name: SHIPPING_SERVICE_ADDR\n          value: shippingservice:50051\n        - name: CHECKOUT_SERVICE_ADDR\n          value: checkoutservice:5050\n        - name: AD_SERVICE_ADDR\n          value: adservice:9555\n        - name: ENV_PLATFORM\n          value: gcp\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"server\" has memory limit 0"
  },
  {
    "id": "1143",
    "manifest_path": "data/manifests/the_stack_sample/sample_0121.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: score-app\n    env: qa\n  name: sotr-app\n  namespace: mlops\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: sotr-app\n  template:\n    metadata:\n      labels:\n        app: sotr-app\n        env: qa\n    spec:\n      containers:\n      - image: wsosnowski2/sotr\n        name: sotr-project\n        ports:\n        - containerPort: 8010\n          protocol: TCP\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"sotr-project\" is using an invalid container image, \"wsosnowski2/sotr\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "1144",
    "manifest_path": "data/manifests/the_stack_sample/sample_0121.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: score-app\n    env: qa\n  name: sotr-app\n  namespace: mlops\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: sotr-app\n  template:\n    metadata:\n      labels:\n        app: sotr-app\n        env: qa\n    spec:\n      containers:\n      - image: wsosnowski2/sotr\n        name: sotr-project\n        ports:\n        - containerPort: 8010\n          protocol: TCP\n",
    "policy_id": "no-anti-affinity",
    "violation_text": "object has 2 replicas but does not specify inter pod anti-affinity"
  },
  {
    "id": "1145",
    "manifest_path": "data/manifests/the_stack_sample/sample_0121.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: score-app\n    env: qa\n  name: sotr-app\n  namespace: mlops\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: sotr-app\n  template:\n    metadata:\n      labels:\n        app: sotr-app\n        env: qa\n    spec:\n      containers:\n      - image: wsosnowski2/sotr\n        name: sotr-project\n        ports:\n        - containerPort: 8010\n          protocol: TCP\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"sotr-project\" does not have a read-only root file system"
  },
  {
    "id": "1146",
    "manifest_path": "data/manifests/the_stack_sample/sample_0121.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: score-app\n    env: qa\n  name: sotr-app\n  namespace: mlops\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: sotr-app\n  template:\n    metadata:\n      labels:\n        app: sotr-app\n        env: qa\n    spec:\n      containers:\n      - image: wsosnowski2/sotr\n        name: sotr-project\n        ports:\n        - containerPort: 8010\n          protocol: TCP\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"sotr-project\" is not set to runAsNonRoot"
  },
  {
    "id": "1147",
    "manifest_path": "data/manifests/the_stack_sample/sample_0121.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: score-app\n    env: qa\n  name: sotr-app\n  namespace: mlops\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: sotr-app\n  template:\n    metadata:\n      labels:\n        app: sotr-app\n        env: qa\n    spec:\n      containers:\n      - image: wsosnowski2/sotr\n        name: sotr-project\n        ports:\n        - containerPort: 8010\n          protocol: TCP\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"sotr-project\" has cpu request 0"
  },
  {
    "id": "1148",
    "manifest_path": "data/manifests/the_stack_sample/sample_0121.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: score-app\n    env: qa\n  name: sotr-app\n  namespace: mlops\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: sotr-app\n  template:\n    metadata:\n      labels:\n        app: sotr-app\n        env: qa\n    spec:\n      containers:\n      - image: wsosnowski2/sotr\n        name: sotr-project\n        ports:\n        - containerPort: 8010\n          protocol: TCP\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"sotr-project\" has memory limit 0"
  },
  {
    "id": "1149",
    "manifest_path": "data/manifests/the_stack_sample/sample_0122.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: akstest-3225\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: akstest-3225\n  template:\n    metadata:\n      labels:\n        app: akstest-3225\n    spec:\n      containers:\n      - name: akstest-3225\n        image: aaaatiwarishubregistry.azurecr.io/akstest\n        ports:\n        - containerPort: 8123\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"akstest-3225\" is using an invalid container image, \"aaaatiwarishubregistry.azurecr.io/akstest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "1150",
    "manifest_path": "data/manifests/the_stack_sample/sample_0122.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: akstest-3225\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: akstest-3225\n  template:\n    metadata:\n      labels:\n        app: akstest-3225\n    spec:\n      containers:\n      - name: akstest-3225\n        image: aaaatiwarishubregistry.azurecr.io/akstest\n        ports:\n        - containerPort: 8123\n",
    "policy_id": "no-anti-affinity",
    "violation_text": "object has 2 replicas but does not specify inter pod anti-affinity"
  },
  {
    "id": "1151",
    "manifest_path": "data/manifests/the_stack_sample/sample_0122.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: akstest-3225\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: akstest-3225\n  template:\n    metadata:\n      labels:\n        app: akstest-3225\n    spec:\n      containers:\n      - name: akstest-3225\n        image: aaaatiwarishubregistry.azurecr.io/akstest\n        ports:\n        - containerPort: 8123\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"akstest-3225\" does not have a read-only root file system"
  },
  {
    "id": "1152",
    "manifest_path": "data/manifests/the_stack_sample/sample_0122.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: akstest-3225\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: akstest-3225\n  template:\n    metadata:\n      labels:\n        app: akstest-3225\n    spec:\n      containers:\n      - name: akstest-3225\n        image: aaaatiwarishubregistry.azurecr.io/akstest\n        ports:\n        - containerPort: 8123\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"akstest-3225\" is not set to runAsNonRoot"
  },
  {
    "id": "1153",
    "manifest_path": "data/manifests/the_stack_sample/sample_0122.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: akstest-3225\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: akstest-3225\n  template:\n    metadata:\n      labels:\n        app: akstest-3225\n    spec:\n      containers:\n      - name: akstest-3225\n        image: aaaatiwarishubregistry.azurecr.io/akstest\n        ports:\n        - containerPort: 8123\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"akstest-3225\" has cpu request 0"
  },
  {
    "id": "1154",
    "manifest_path": "data/manifests/the_stack_sample/sample_0122.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: akstest-3225\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: akstest-3225\n  template:\n    metadata:\n      labels:\n        app: akstest-3225\n    spec:\n      containers:\n      - name: akstest-3225\n        image: aaaatiwarishubregistry.azurecr.io/akstest\n        ports:\n        - containerPort: 8123\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"akstest-3225\" has memory limit 0"
  },
  {
    "id": "1155",
    "manifest_path": "data/manifests/the_stack_sample/sample_0125.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Service\nmetadata:\n  name: music-server\n  namespace: mytunes\n  labels:\n    name: music-db\nspec:\n  selector:\n    name: music-db\n  ports:\n  - name: db\n    port: 9200\n    targetPort: es\n  type: LoadBalancer\n",
    "policy_id": "dangling-service",
    "violation_text": "no pods found matching service labels (map[name:music-db])"
  },
  {
    "id": "1156",
    "manifest_path": "data/manifests/the_stack_sample/sample_0128.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: hello-deployment\n  labels:\n    app: hello\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: hello\n  template:\n    metadata:\n      labels:\n        app: hello\n    spec:\n      containers:\n      - name: hello\n        image: gcr.io/google-samples/hello-app:1.0\n        ports:\n        - containerPort: 8080\n        env:\n        - name: MYSQL_ROOT_PASSWORD\n          value: password\n        resources:\n          requests:\n            memory: 61Mi\n            cpu: 200m\n          limits:\n            memory: 128Mi\n            cpu: 500m\n",
    "policy_id": "no-anti-affinity",
    "violation_text": "object has 2 replicas but does not specify inter pod anti-affinity"
  },
  {
    "id": "1157",
    "manifest_path": "data/manifests/the_stack_sample/sample_0128.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: hello-deployment\n  labels:\n    app: hello\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: hello\n  template:\n    metadata:\n      labels:\n        app: hello\n    spec:\n      containers:\n      - name: hello\n        image: gcr.io/google-samples/hello-app:1.0\n        ports:\n        - containerPort: 8080\n        env:\n        - name: MYSQL_ROOT_PASSWORD\n          value: password\n        resources:\n          requests:\n            memory: 61Mi\n            cpu: 200m\n          limits:\n            memory: 128Mi\n            cpu: 500m\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"hello\" does not have a read-only root file system"
  },
  {
    "id": "1158",
    "manifest_path": "data/manifests/the_stack_sample/sample_0128.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: hello-deployment\n  labels:\n    app: hello\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: hello\n  template:\n    metadata:\n      labels:\n        app: hello\n    spec:\n      containers:\n      - name: hello\n        image: gcr.io/google-samples/hello-app:1.0\n        ports:\n        - containerPort: 8080\n        env:\n        - name: MYSQL_ROOT_PASSWORD\n          value: password\n        resources:\n          requests:\n            memory: 61Mi\n            cpu: 200m\n          limits:\n            memory: 128Mi\n            cpu: 500m\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"hello\" is not set to runAsNonRoot"
  },
  {
    "id": "1159",
    "manifest_path": "data/manifests/the_stack_sample/sample_0129.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Service\nmetadata:\n  name: phpmyadmin-service\nspec:\n  type: NodePort\n  selector:\n    app: phpmyadmin\n  ports:\n  - protocol: TCP\n    port: 80\n    targetPort: 80\n",
    "policy_id": "dangling-service",
    "violation_text": "no pods found matching service labels (map[app:phpmyadmin])"
  },
  {
    "id": "1160",
    "manifest_path": "data/manifests/the_stack_sample/sample_0131.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: lighthouse-webhooks\n  labels:\n    chart: lighthouse-1.1.41\n    app: lighthouse-webhooks\n    git.jenkins-x.io/sha: annotate\n    gitops.jenkins-x.io/pipeline: namespaces\n  annotations:\n    checksum/config: cca6b2f42d7393045e9e749df2be9e7f342f64b4c723a82c3c7c4d0cb91793f6\n    meta.helm.sh/release-name: lighthouse\n    wave.pusher.com/update-on-config-change: 'true'\n  namespace: jx\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: lighthouse-webhooks\n  template:\n    metadata:\n      labels:\n        app: lighthouse-webhooks\n      annotations:\n        prometheus.io/port: '2112'\n        prometheus.io/scrape: 'true'\n        jenkins-x.io/hash: 5e6bccde9c3bac58bf04598ba5c0d440ede72b84637d58a98043893d7122417d\n    spec:\n      serviceAccountName: lighthouse-webhooks\n      containers:\n      - name: lighthouse-webhooks\n        image: ghcr.io/jenkins-x/lighthouse-webhooks:1.1.41\n        imagePullPolicy: IfNotPresent\n        args:\n        - --namespace=jx\n        env:\n        - name: GIT_KIND\n          value: github\n        - name: LH_CUSTOM_TRIGGER_COMMAND\n          value: jx\n        - name: GIT_SERVER\n          value: https://github.com\n        - name: GIT_USER\n          value: OHHYUN\n        - name: GIT_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: lighthouse-oauth-token\n              key: oauth\n        - name: HMAC_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: lighthouse-hmac-token\n              key: hmac\n              optional: false\n        - name: JX_LOG_FORMAT\n          value: json\n        - name: LOGRUS_FORMAT\n          value: json\n        - name: LOGRUS_SERVICE\n          value: lighthouse\n        - name: LOGRUS_SERVICE_VERSION\n          value: 1.1.41\n        - name: LOGRUS_STACK_SKIP\n          value: ''\n        - name: DEFAULT_PIPELINE_RUN_SERVICE_ACCOUNT\n          value: tekton-bot\n        - name: DEFAULT_PIPELINE_RUN_TIMEOUT\n          value: 2h0m0s\n        - name: FILE_BROWSER\n          value: git\n        - name: JX_DEFAULT_IMAGE\n          value: ghcr.io/jenkins-x/builder-maven:2.1.149-768\n        - name: LIGHTHOUSE_DASHBOARD_TEMPLATE\n          value: namespaces/{{ .Namespace }}/pipelineruns/{{ .PipelineRun }}\n        - name: LIGHTHOUSE_VERSIONSTREAM_JENKINS_X_JX3_PIPELINE_CATALOG\n          value: 974b52c387d1fabee626da3b78536faf4c7848e9\n        envFrom:\n        - secretRef:\n            name: jx-boot-job-env-vars\n            optional: true\n        ports:\n        - containerPort: 8080\n        livenessProbe:\n          httpGet:\n            path: /\n            port: 8080\n          initialDelaySeconds: 60\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        readinessProbe:\n          httpGet:\n            path: /\n            port: 8080\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        resources:\n          limits:\n            cpu: 100m\n            memory: 512Mi\n          requests:\n            cpu: 80m\n            memory: 128Mi\n      terminationGracePeriodSeconds: 180\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"lighthouse-webhooks\" does not have a read-only root file system"
  },
  {
    "id": "1161",
    "manifest_path": "data/manifests/the_stack_sample/sample_0131.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: lighthouse-webhooks\n  labels:\n    chart: lighthouse-1.1.41\n    app: lighthouse-webhooks\n    git.jenkins-x.io/sha: annotate\n    gitops.jenkins-x.io/pipeline: namespaces\n  annotations:\n    checksum/config: cca6b2f42d7393045e9e749df2be9e7f342f64b4c723a82c3c7c4d0cb91793f6\n    meta.helm.sh/release-name: lighthouse\n    wave.pusher.com/update-on-config-change: 'true'\n  namespace: jx\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: lighthouse-webhooks\n  template:\n    metadata:\n      labels:\n        app: lighthouse-webhooks\n      annotations:\n        prometheus.io/port: '2112'\n        prometheus.io/scrape: 'true'\n        jenkins-x.io/hash: 5e6bccde9c3bac58bf04598ba5c0d440ede72b84637d58a98043893d7122417d\n    spec:\n      serviceAccountName: lighthouse-webhooks\n      containers:\n      - name: lighthouse-webhooks\n        image: ghcr.io/jenkins-x/lighthouse-webhooks:1.1.41\n        imagePullPolicy: IfNotPresent\n        args:\n        - --namespace=jx\n        env:\n        - name: GIT_KIND\n          value: github\n        - name: LH_CUSTOM_TRIGGER_COMMAND\n          value: jx\n        - name: GIT_SERVER\n          value: https://github.com\n        - name: GIT_USER\n          value: OHHYUN\n        - name: GIT_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: lighthouse-oauth-token\n              key: oauth\n        - name: HMAC_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: lighthouse-hmac-token\n              key: hmac\n              optional: false\n        - name: JX_LOG_FORMAT\n          value: json\n        - name: LOGRUS_FORMAT\n          value: json\n        - name: LOGRUS_SERVICE\n          value: lighthouse\n        - name: LOGRUS_SERVICE_VERSION\n          value: 1.1.41\n        - name: LOGRUS_STACK_SKIP\n          value: ''\n        - name: DEFAULT_PIPELINE_RUN_SERVICE_ACCOUNT\n          value: tekton-bot\n        - name: DEFAULT_PIPELINE_RUN_TIMEOUT\n          value: 2h0m0s\n        - name: FILE_BROWSER\n          value: git\n        - name: JX_DEFAULT_IMAGE\n          value: ghcr.io/jenkins-x/builder-maven:2.1.149-768\n        - name: LIGHTHOUSE_DASHBOARD_TEMPLATE\n          value: namespaces/{{ .Namespace }}/pipelineruns/{{ .PipelineRun }}\n        - name: LIGHTHOUSE_VERSIONSTREAM_JENKINS_X_JX3_PIPELINE_CATALOG\n          value: 974b52c387d1fabee626da3b78536faf4c7848e9\n        envFrom:\n        - secretRef:\n            name: jx-boot-job-env-vars\n            optional: true\n        ports:\n        - containerPort: 8080\n        livenessProbe:\n          httpGet:\n            path: /\n            port: 8080\n          initialDelaySeconds: 60\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        readinessProbe:\n          httpGet:\n            path: /\n            port: 8080\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        resources:\n          limits:\n            cpu: 100m\n            memory: 512Mi\n          requests:\n            cpu: 80m\n            memory: 128Mi\n      terminationGracePeriodSeconds: 180\n",
    "policy_id": "non-existent-service-account",
    "violation_text": "serviceAccount \"lighthouse-webhooks\" not found"
  },
  {
    "id": "1162",
    "manifest_path": "data/manifests/the_stack_sample/sample_0131.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: lighthouse-webhooks\n  labels:\n    chart: lighthouse-1.1.41\n    app: lighthouse-webhooks\n    git.jenkins-x.io/sha: annotate\n    gitops.jenkins-x.io/pipeline: namespaces\n  annotations:\n    checksum/config: cca6b2f42d7393045e9e749df2be9e7f342f64b4c723a82c3c7c4d0cb91793f6\n    meta.helm.sh/release-name: lighthouse\n    wave.pusher.com/update-on-config-change: 'true'\n  namespace: jx\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: lighthouse-webhooks\n  template:\n    metadata:\n      labels:\n        app: lighthouse-webhooks\n      annotations:\n        prometheus.io/port: '2112'\n        prometheus.io/scrape: 'true'\n        jenkins-x.io/hash: 5e6bccde9c3bac58bf04598ba5c0d440ede72b84637d58a98043893d7122417d\n    spec:\n      serviceAccountName: lighthouse-webhooks\n      containers:\n      - name: lighthouse-webhooks\n        image: ghcr.io/jenkins-x/lighthouse-webhooks:1.1.41\n        imagePullPolicy: IfNotPresent\n        args:\n        - --namespace=jx\n        env:\n        - name: GIT_KIND\n          value: github\n        - name: LH_CUSTOM_TRIGGER_COMMAND\n          value: jx\n        - name: GIT_SERVER\n          value: https://github.com\n        - name: GIT_USER\n          value: OHHYUN\n        - name: GIT_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: lighthouse-oauth-token\n              key: oauth\n        - name: HMAC_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: lighthouse-hmac-token\n              key: hmac\n              optional: false\n        - name: JX_LOG_FORMAT\n          value: json\n        - name: LOGRUS_FORMAT\n          value: json\n        - name: LOGRUS_SERVICE\n          value: lighthouse\n        - name: LOGRUS_SERVICE_VERSION\n          value: 1.1.41\n        - name: LOGRUS_STACK_SKIP\n          value: ''\n        - name: DEFAULT_PIPELINE_RUN_SERVICE_ACCOUNT\n          value: tekton-bot\n        - name: DEFAULT_PIPELINE_RUN_TIMEOUT\n          value: 2h0m0s\n        - name: FILE_BROWSER\n          value: git\n        - name: JX_DEFAULT_IMAGE\n          value: ghcr.io/jenkins-x/builder-maven:2.1.149-768\n        - name: LIGHTHOUSE_DASHBOARD_TEMPLATE\n          value: namespaces/{{ .Namespace }}/pipelineruns/{{ .PipelineRun }}\n        - name: LIGHTHOUSE_VERSIONSTREAM_JENKINS_X_JX3_PIPELINE_CATALOG\n          value: 974b52c387d1fabee626da3b78536faf4c7848e9\n        envFrom:\n        - secretRef:\n            name: jx-boot-job-env-vars\n            optional: true\n        ports:\n        - containerPort: 8080\n        livenessProbe:\n          httpGet:\n            path: /\n            port: 8080\n          initialDelaySeconds: 60\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        readinessProbe:\n          httpGet:\n            path: /\n            port: 8080\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        resources:\n          limits:\n            cpu: 100m\n            memory: 512Mi\n          requests:\n            cpu: 80m\n            memory: 128Mi\n      terminationGracePeriodSeconds: 180\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"lighthouse-webhooks\" is not set to runAsNonRoot"
  },
  {
    "id": "1164",
    "manifest_path": "data/manifests/the_stack_sample/sample_0132.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: hive-controllers\n  namespace: hive\n  labels:\n    control-plane: controller-manager\n    controller-tools.k8s.io: '1.0'\nspec:\n  selector:\n    matchLabels:\n      control-plane: controller-manager\n      controller-tools.k8s.io: '1.0'\n  replicas: 1\n  revisionHistoryLimit: 4\n  template:\n    metadata:\n      labels:\n        control-plane: controller-manager\n        controller-tools.k8s.io: '1.0'\n    spec:\n      serviceAccountName: default\n      volumes:\n      - name: kubectl-cache\n        emptyDir: {}\n      containers:\n      - image: registry.svc.ci.openshift.org/openshift/hive-v4.0:hive\n        imagePullPolicy: Always\n        name: manager\n        resources:\n          requests:\n            cpu: 50m\n            memory: 512Mi\n        command:\n        - /opt/services/manager\n        volumeMounts:\n        - name: kubectl-cache\n          mountPath: /var/cache/kubectl\n        env:\n        - name: CLI_CACHE_DIR\n          value: /var/cache/kubectl\n        livenessProbe:\n          httpGet:\n            path: /debug/health\n            port: 8080\n          initialDelaySeconds: 10\n          failureThreshold: 1\n          periodSeconds: 10\n      terminationGracePeriodSeconds: 10\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"manager\" does not have a read-only root file system"
  },
  {
    "id": "1165",
    "manifest_path": "data/manifests/the_stack_sample/sample_0132.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: hive-controllers\n  namespace: hive\n  labels:\n    control-plane: controller-manager\n    controller-tools.k8s.io: '1.0'\nspec:\n  selector:\n    matchLabels:\n      control-plane: controller-manager\n      controller-tools.k8s.io: '1.0'\n  replicas: 1\n  revisionHistoryLimit: 4\n  template:\n    metadata:\n      labels:\n        control-plane: controller-manager\n        controller-tools.k8s.io: '1.0'\n    spec:\n      serviceAccountName: default\n      volumes:\n      - name: kubectl-cache\n        emptyDir: {}\n      containers:\n      - image: registry.svc.ci.openshift.org/openshift/hive-v4.0:hive\n        imagePullPolicy: Always\n        name: manager\n        resources:\n          requests:\n            cpu: 50m\n            memory: 512Mi\n        command:\n        - /opt/services/manager\n        volumeMounts:\n        - name: kubectl-cache\n          mountPath: /var/cache/kubectl\n        env:\n        - name: CLI_CACHE_DIR\n          value: /var/cache/kubectl\n        livenessProbe:\n          httpGet:\n            path: /debug/health\n            port: 8080\n          initialDelaySeconds: 10\n          failureThreshold: 1\n          periodSeconds: 10\n      terminationGracePeriodSeconds: 10\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"manager\" is not set to runAsNonRoot"
  },
  {
    "id": "1166",
    "manifest_path": "data/manifests/the_stack_sample/sample_0132.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: hive-controllers\n  namespace: hive\n  labels:\n    control-plane: controller-manager\n    controller-tools.k8s.io: '1.0'\nspec:\n  selector:\n    matchLabels:\n      control-plane: controller-manager\n      controller-tools.k8s.io: '1.0'\n  replicas: 1\n  revisionHistoryLimit: 4\n  template:\n    metadata:\n      labels:\n        control-plane: controller-manager\n        controller-tools.k8s.io: '1.0'\n    spec:\n      serviceAccountName: default\n      volumes:\n      - name: kubectl-cache\n        emptyDir: {}\n      containers:\n      - image: registry.svc.ci.openshift.org/openshift/hive-v4.0:hive\n        imagePullPolicy: Always\n        name: manager\n        resources:\n          requests:\n            cpu: 50m\n            memory: 512Mi\n        command:\n        - /opt/services/manager\n        volumeMounts:\n        - name: kubectl-cache\n          mountPath: /var/cache/kubectl\n        env:\n        - name: CLI_CACHE_DIR\n          value: /var/cache/kubectl\n        livenessProbe:\n          httpGet:\n            path: /debug/health\n            port: 8080\n          initialDelaySeconds: 10\n          failureThreshold: 1\n          periodSeconds: 10\n      terminationGracePeriodSeconds: 10\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"manager\" has memory limit 0"
  },
  {
    "id": "1167",
    "manifest_path": "data/manifests/the_stack_sample/sample_0133.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Service\nmetadata:\n  name: sugampipelinesjavascriptdocker\nspec:\n  type: LoadBalancer\n  ports:\n  - port: 8080\n  selector:\n    app: sugampipelinesjavascriptdocker\n",
    "policy_id": "dangling-service",
    "violation_text": "no pods found matching service labels (map[app:sugampipelinesjavascriptdocker])"
  },
  {
    "id": "1168",
    "manifest_path": "data/manifests/the_stack_sample/sample_0134.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Service\nmetadata:\n  name: bookinfo-uat-ratings\n  namespace: student063-bookinfo-uat\nspec:\n  type: ClusterIP\n  ports:\n  - port: 8080\n  selector:\n    app: bookinfo-uat-ratings\n",
    "policy_id": "dangling-service",
    "violation_text": "no pods found matching service labels (map[app:bookinfo-uat-ratings])"
  },
  {
    "id": "1169",
    "manifest_path": "data/manifests/the_stack_sample/sample_0138.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: api-db\nspec:\n  containers:\n  - name: api-database\n    image: postgres:latest\n    env:\n    - name: POSTGRES_PASSWORD\n      valueFrom:\n        secretKeyRef:\n          name: api-secret\n          key: POSTGRES_PASSWORD\n    volumeMounts:\n    - mountPath: /var/lib/postgresql\n      name: api-data\n  initContainers:\n  - name: pgsql-data-permission-fix\n    image: busybox\n    command:\n    - /bin/chmod\n    - -R\n    - '777'\n    - /data\n    volumeMounts:\n    - name: api-data\n      mountPath: /data\n  volumes:\n  - name: api-data\n    persistentVolumeClaim:\n      claimName: api-pvc\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"api-database\" is using an invalid container image, \"postgres:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "1170",
    "manifest_path": "data/manifests/the_stack_sample/sample_0138.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: api-db\nspec:\n  containers:\n  - name: api-database\n    image: postgres:latest\n    env:\n    - name: POSTGRES_PASSWORD\n      valueFrom:\n        secretKeyRef:\n          name: api-secret\n          key: POSTGRES_PASSWORD\n    volumeMounts:\n    - mountPath: /var/lib/postgresql\n      name: api-data\n  initContainers:\n  - name: pgsql-data-permission-fix\n    image: busybox\n    command:\n    - /bin/chmod\n    - -R\n    - '777'\n    - /data\n    volumeMounts:\n    - name: api-data\n      mountPath: /data\n  volumes:\n  - name: api-data\n    persistentVolumeClaim:\n      claimName: api-pvc\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"pgsql-data-permission-fix\" is using an invalid container image, \"busybox\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "1171",
    "manifest_path": "data/manifests/the_stack_sample/sample_0138.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: api-db\nspec:\n  containers:\n  - name: api-database\n    image: postgres:latest\n    env:\n    - name: POSTGRES_PASSWORD\n      valueFrom:\n        secretKeyRef:\n          name: api-secret\n          key: POSTGRES_PASSWORD\n    volumeMounts:\n    - mountPath: /var/lib/postgresql\n      name: api-data\n  initContainers:\n  - name: pgsql-data-permission-fix\n    image: busybox\n    command:\n    - /bin/chmod\n    - -R\n    - '777'\n    - /data\n    volumeMounts:\n    - name: api-data\n      mountPath: /data\n  volumes:\n  - name: api-data\n    persistentVolumeClaim:\n      claimName: api-pvc\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"api-database\" does not have a read-only root file system"
  },
  {
    "id": "1172",
    "manifest_path": "data/manifests/the_stack_sample/sample_0138.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: api-db\nspec:\n  containers:\n  - name: api-database\n    image: postgres:latest\n    env:\n    - name: POSTGRES_PASSWORD\n      valueFrom:\n        secretKeyRef:\n          name: api-secret\n          key: POSTGRES_PASSWORD\n    volumeMounts:\n    - mountPath: /var/lib/postgresql\n      name: api-data\n  initContainers:\n  - name: pgsql-data-permission-fix\n    image: busybox\n    command:\n    - /bin/chmod\n    - -R\n    - '777'\n    - /data\n    volumeMounts:\n    - name: api-data\n      mountPath: /data\n  volumes:\n  - name: api-data\n    persistentVolumeClaim:\n      claimName: api-pvc\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"pgsql-data-permission-fix\" does not have a read-only root file system"
  },
  {
    "id": "1173",
    "manifest_path": "data/manifests/the_stack_sample/sample_0138.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: api-db\nspec:\n  containers:\n  - name: api-database\n    image: postgres:latest\n    env:\n    - name: POSTGRES_PASSWORD\n      valueFrom:\n        secretKeyRef:\n          name: api-secret\n          key: POSTGRES_PASSWORD\n    volumeMounts:\n    - mountPath: /var/lib/postgresql\n      name: api-data\n  initContainers:\n  - name: pgsql-data-permission-fix\n    image: busybox\n    command:\n    - /bin/chmod\n    - -R\n    - '777'\n    - /data\n    volumeMounts:\n    - name: api-data\n      mountPath: /data\n  volumes:\n  - name: api-data\n    persistentVolumeClaim:\n      claimName: api-pvc\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"api-database\" is not set to runAsNonRoot"
  },
  {
    "id": "1174",
    "manifest_path": "data/manifests/the_stack_sample/sample_0138.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: api-db\nspec:\n  containers:\n  - name: api-database\n    image: postgres:latest\n    env:\n    - name: POSTGRES_PASSWORD\n      valueFrom:\n        secretKeyRef:\n          name: api-secret\n          key: POSTGRES_PASSWORD\n    volumeMounts:\n    - mountPath: /var/lib/postgresql\n      name: api-data\n  initContainers:\n  - name: pgsql-data-permission-fix\n    image: busybox\n    command:\n    - /bin/chmod\n    - -R\n    - '777'\n    - /data\n    volumeMounts:\n    - name: api-data\n      mountPath: /data\n  volumes:\n  - name: api-data\n    persistentVolumeClaim:\n      claimName: api-pvc\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"pgsql-data-permission-fix\" is not set to runAsNonRoot"
  },
  {
    "id": "1175",
    "manifest_path": "data/manifests/the_stack_sample/sample_0138.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: api-db\nspec:\n  containers:\n  - name: api-database\n    image: postgres:latest\n    env:\n    - name: POSTGRES_PASSWORD\n      valueFrom:\n        secretKeyRef:\n          name: api-secret\n          key: POSTGRES_PASSWORD\n    volumeMounts:\n    - mountPath: /var/lib/postgresql\n      name: api-data\n  initContainers:\n  - name: pgsql-data-permission-fix\n    image: busybox\n    command:\n    - /bin/chmod\n    - -R\n    - '777'\n    - /data\n    volumeMounts:\n    - name: api-data\n      mountPath: /data\n  volumes:\n  - name: api-data\n    persistentVolumeClaim:\n      claimName: api-pvc\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"api-database\" has cpu request 0"
  },
  {
    "id": "1176",
    "manifest_path": "data/manifests/the_stack_sample/sample_0138.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: api-db\nspec:\n  containers:\n  - name: api-database\n    image: postgres:latest\n    env:\n    - name: POSTGRES_PASSWORD\n      valueFrom:\n        secretKeyRef:\n          name: api-secret\n          key: POSTGRES_PASSWORD\n    volumeMounts:\n    - mountPath: /var/lib/postgresql\n      name: api-data\n  initContainers:\n  - name: pgsql-data-permission-fix\n    image: busybox\n    command:\n    - /bin/chmod\n    - -R\n    - '777'\n    - /data\n    volumeMounts:\n    - name: api-data\n      mountPath: /data\n  volumes:\n  - name: api-data\n    persistentVolumeClaim:\n      claimName: api-pvc\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"pgsql-data-permission-fix\" has cpu request 0"
  },
  {
    "id": "1177",
    "manifest_path": "data/manifests/the_stack_sample/sample_0138.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: api-db\nspec:\n  containers:\n  - name: api-database\n    image: postgres:latest\n    env:\n    - name: POSTGRES_PASSWORD\n      valueFrom:\n        secretKeyRef:\n          name: api-secret\n          key: POSTGRES_PASSWORD\n    volumeMounts:\n    - mountPath: /var/lib/postgresql\n      name: api-data\n  initContainers:\n  - name: pgsql-data-permission-fix\n    image: busybox\n    command:\n    - /bin/chmod\n    - -R\n    - '777'\n    - /data\n    volumeMounts:\n    - name: api-data\n      mountPath: /data\n  volumes:\n  - name: api-data\n    persistentVolumeClaim:\n      claimName: api-pvc\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"api-database\" has memory limit 0"
  },
  {
    "id": "1178",
    "manifest_path": "data/manifests/the_stack_sample/sample_0138.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: api-db\nspec:\n  containers:\n  - name: api-database\n    image: postgres:latest\n    env:\n    - name: POSTGRES_PASSWORD\n      valueFrom:\n        secretKeyRef:\n          name: api-secret\n          key: POSTGRES_PASSWORD\n    volumeMounts:\n    - mountPath: /var/lib/postgresql\n      name: api-data\n  initContainers:\n  - name: pgsql-data-permission-fix\n    image: busybox\n    command:\n    - /bin/chmod\n    - -R\n    - '777'\n    - /data\n    volumeMounts:\n    - name: api-data\n      mountPath: /data\n  volumes:\n  - name: api-data\n    persistentVolumeClaim:\n      claimName: api-pvc\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"pgsql-data-permission-fix\" has memory limit 0"
  },
  {
    "id": "1179",
    "manifest_path": "data/manifests/the_stack_sample/sample_0139.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: lighthouse-tekton-controller\n  labels:\n    chart: lighthouse-1.5.7\n    app: lighthouse-tekton-controller\n    gitops.jenkins-x.io/pipeline: namespaces\n  annotations:\n    meta.helm.sh/release-name: lighthouse\n    wave.pusher.com/update-on-config-change: 'true'\n  namespace: jx\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: lighthouse-tekton-controller\n  template:\n    metadata:\n      labels:\n        app: lighthouse-tekton-controller\n      annotations:\n        jenkins-x.io/hash: 60461a69ffa09bc8e76a211946cab1220740169ece13144fe59417d2d20f18ab\n    spec:\n      serviceAccountName: lighthouse-tekton-controller\n      containers:\n      - name: lighthouse-tekton-controller\n        image: ghcr.io/jenkins-x/lighthouse-tekton-controller:1.5.7\n        imagePullPolicy: IfNotPresent\n        args:\n        - --namespace=jx\n        - --dashboard-url=http://dashboard.jx.change.me\n        - --dashboard-template=namespaces/{{ .Namespace }}/pipelineruns/{{ .PipelineRun\n          }}\n        ports:\n        - name: metrics\n          containerPort: 8080\n        env:\n        - name: LOGRUS_FORMAT\n          value: json\n        - name: LOGRUS_SERVICE\n          value: lighthouse\n        - name: LOGRUS_SERVICE_VERSION\n          value: 1.5.7\n        - name: LOGRUS_STACK_SKIP\n          value: ''\n        - name: DEFAULT_PIPELINE_RUN_SERVICE_ACCOUNT\n          value: tekton-bot\n        - name: DEFAULT_PIPELINE_RUN_TIMEOUT\n          value: 2h0m0s\n        - name: FILE_BROWSER\n          value: git\n        - name: JX_DEFAULT_IMAGE\n          value: ghcr.io/jenkins-x/builder-maven:2.1.149-768\n        - name: LIGHTHOUSE_DASHBOARD_TEMPLATE\n          value: namespaces/{{ .Namespace }}/pipelineruns/{{ .PipelineRun }}\n        - name: LIGHTHOUSE_VERSIONSTREAM_JENKINS_X_JX3_PIPELINE_CATALOG\n          value: 9e58caa93ba0a07182b4512285c1b1d01a279995\n        envFrom:\n        - secretRef:\n            name: jx-boot-job-env-vars\n            optional: true\n        resources:\n          limits:\n            cpu: 100m\n            memory: 256Mi\n          requests:\n            cpu: 80m\n            memory: 128Mi\n      terminationGracePeriodSeconds: 180\n      nodeSelector: {}\n      affinity: {}\n      tolerations: []\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"lighthouse-tekton-controller\" does not have a read-only root file system"
  },
  {
    "id": "1180",
    "manifest_path": "data/manifests/the_stack_sample/sample_0139.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: lighthouse-tekton-controller\n  labels:\n    chart: lighthouse-1.5.7\n    app: lighthouse-tekton-controller\n    gitops.jenkins-x.io/pipeline: namespaces\n  annotations:\n    meta.helm.sh/release-name: lighthouse\n    wave.pusher.com/update-on-config-change: 'true'\n  namespace: jx\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: lighthouse-tekton-controller\n  template:\n    metadata:\n      labels:\n        app: lighthouse-tekton-controller\n      annotations:\n        jenkins-x.io/hash: 60461a69ffa09bc8e76a211946cab1220740169ece13144fe59417d2d20f18ab\n    spec:\n      serviceAccountName: lighthouse-tekton-controller\n      containers:\n      - name: lighthouse-tekton-controller\n        image: ghcr.io/jenkins-x/lighthouse-tekton-controller:1.5.7\n        imagePullPolicy: IfNotPresent\n        args:\n        - --namespace=jx\n        - --dashboard-url=http://dashboard.jx.change.me\n        - --dashboard-template=namespaces/{{ .Namespace }}/pipelineruns/{{ .PipelineRun\n          }}\n        ports:\n        - name: metrics\n          containerPort: 8080\n        env:\n        - name: LOGRUS_FORMAT\n          value: json\n        - name: LOGRUS_SERVICE\n          value: lighthouse\n        - name: LOGRUS_SERVICE_VERSION\n          value: 1.5.7\n        - name: LOGRUS_STACK_SKIP\n          value: ''\n        - name: DEFAULT_PIPELINE_RUN_SERVICE_ACCOUNT\n          value: tekton-bot\n        - name: DEFAULT_PIPELINE_RUN_TIMEOUT\n          value: 2h0m0s\n        - name: FILE_BROWSER\n          value: git\n        - name: JX_DEFAULT_IMAGE\n          value: ghcr.io/jenkins-x/builder-maven:2.1.149-768\n        - name: LIGHTHOUSE_DASHBOARD_TEMPLATE\n          value: namespaces/{{ .Namespace }}/pipelineruns/{{ .PipelineRun }}\n        - name: LIGHTHOUSE_VERSIONSTREAM_JENKINS_X_JX3_PIPELINE_CATALOG\n          value: 9e58caa93ba0a07182b4512285c1b1d01a279995\n        envFrom:\n        - secretRef:\n            name: jx-boot-job-env-vars\n            optional: true\n        resources:\n          limits:\n            cpu: 100m\n            memory: 256Mi\n          requests:\n            cpu: 80m\n            memory: 128Mi\n      terminationGracePeriodSeconds: 180\n      nodeSelector: {}\n      affinity: {}\n      tolerations: []\n",
    "policy_id": "non-existent-service-account",
    "violation_text": "serviceAccount \"lighthouse-tekton-controller\" not found"
  },
  {
    "id": "1181",
    "manifest_path": "data/manifests/the_stack_sample/sample_0139.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: lighthouse-tekton-controller\n  labels:\n    chart: lighthouse-1.5.7\n    app: lighthouse-tekton-controller\n    gitops.jenkins-x.io/pipeline: namespaces\n  annotations:\n    meta.helm.sh/release-name: lighthouse\n    wave.pusher.com/update-on-config-change: 'true'\n  namespace: jx\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: lighthouse-tekton-controller\n  template:\n    metadata:\n      labels:\n        app: lighthouse-tekton-controller\n      annotations:\n        jenkins-x.io/hash: 60461a69ffa09bc8e76a211946cab1220740169ece13144fe59417d2d20f18ab\n    spec:\n      serviceAccountName: lighthouse-tekton-controller\n      containers:\n      - name: lighthouse-tekton-controller\n        image: ghcr.io/jenkins-x/lighthouse-tekton-controller:1.5.7\n        imagePullPolicy: IfNotPresent\n        args:\n        - --namespace=jx\n        - --dashboard-url=http://dashboard.jx.change.me\n        - --dashboard-template=namespaces/{{ .Namespace }}/pipelineruns/{{ .PipelineRun\n          }}\n        ports:\n        - name: metrics\n          containerPort: 8080\n        env:\n        - name: LOGRUS_FORMAT\n          value: json\n        - name: LOGRUS_SERVICE\n          value: lighthouse\n        - name: LOGRUS_SERVICE_VERSION\n          value: 1.5.7\n        - name: LOGRUS_STACK_SKIP\n          value: ''\n        - name: DEFAULT_PIPELINE_RUN_SERVICE_ACCOUNT\n          value: tekton-bot\n        - name: DEFAULT_PIPELINE_RUN_TIMEOUT\n          value: 2h0m0s\n        - name: FILE_BROWSER\n          value: git\n        - name: JX_DEFAULT_IMAGE\n          value: ghcr.io/jenkins-x/builder-maven:2.1.149-768\n        - name: LIGHTHOUSE_DASHBOARD_TEMPLATE\n          value: namespaces/{{ .Namespace }}/pipelineruns/{{ .PipelineRun }}\n        - name: LIGHTHOUSE_VERSIONSTREAM_JENKINS_X_JX3_PIPELINE_CATALOG\n          value: 9e58caa93ba0a07182b4512285c1b1d01a279995\n        envFrom:\n        - secretRef:\n            name: jx-boot-job-env-vars\n            optional: true\n        resources:\n          limits:\n            cpu: 100m\n            memory: 256Mi\n          requests:\n            cpu: 80m\n            memory: 128Mi\n      terminationGracePeriodSeconds: 180\n      nodeSelector: {}\n      affinity: {}\n      tolerations: []\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"lighthouse-tekton-controller\" is not set to runAsNonRoot"
  },
  {
    "id": "1182",
    "manifest_path": "data/manifests/the_stack_sample/sample_0140.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: sinker\n  labels:\n    app: sinker\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: sinker\n  template:\n    metadata:\n      labels:\n        app: sinker\n    spec:\n      serviceAccountName: sinker\n      containers:\n      - name: sinker\n        args:\n        - --kubeconfig=/etc/kubeconfig/config\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        - --dry-run=false\n        image: gcr.io/k8s-prow/sinker:v20200628-cc1c099dad\n        volumeMounts:\n        - mountPath: /etc/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n      volumes:\n      - name: kubeconfig\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"sinker\" does not have a read-only root file system"
  },
  {
    "id": "1183",
    "manifest_path": "data/manifests/the_stack_sample/sample_0140.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: sinker\n  labels:\n    app: sinker\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: sinker\n  template:\n    metadata:\n      labels:\n        app: sinker\n    spec:\n      serviceAccountName: sinker\n      containers:\n      - name: sinker\n        args:\n        - --kubeconfig=/etc/kubeconfig/config\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        - --dry-run=false\n        image: gcr.io/k8s-prow/sinker:v20200628-cc1c099dad\n        volumeMounts:\n        - mountPath: /etc/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n      volumes:\n      - name: kubeconfig\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n",
    "policy_id": "non-existent-service-account",
    "violation_text": "serviceAccount \"sinker\" not found"
  },
  {
    "id": "1184",
    "manifest_path": "data/manifests/the_stack_sample/sample_0140.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: sinker\n  labels:\n    app: sinker\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: sinker\n  template:\n    metadata:\n      labels:\n        app: sinker\n    spec:\n      serviceAccountName: sinker\n      containers:\n      - name: sinker\n        args:\n        - --kubeconfig=/etc/kubeconfig/config\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        - --dry-run=false\n        image: gcr.io/k8s-prow/sinker:v20200628-cc1c099dad\n        volumeMounts:\n        - mountPath: /etc/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n      volumes:\n      - name: kubeconfig\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"sinker\" is not set to runAsNonRoot"
  },
  {
    "id": "1185",
    "manifest_path": "data/manifests/the_stack_sample/sample_0140.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: sinker\n  labels:\n    app: sinker\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: sinker\n  template:\n    metadata:\n      labels:\n        app: sinker\n    spec:\n      serviceAccountName: sinker\n      containers:\n      - name: sinker\n        args:\n        - --kubeconfig=/etc/kubeconfig/config\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        - --dry-run=false\n        image: gcr.io/k8s-prow/sinker:v20200628-cc1c099dad\n        volumeMounts:\n        - mountPath: /etc/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n      volumes:\n      - name: kubeconfig\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"sinker\" has cpu request 0"
  },
  {
    "id": "1186",
    "manifest_path": "data/manifests/the_stack_sample/sample_0140.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: sinker\n  labels:\n    app: sinker\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: sinker\n  template:\n    metadata:\n      labels:\n        app: sinker\n    spec:\n      serviceAccountName: sinker\n      containers:\n      - name: sinker\n        args:\n        - --kubeconfig=/etc/kubeconfig/config\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        - --dry-run=false\n        image: gcr.io/k8s-prow/sinker:v20200628-cc1c099dad\n        volumeMounts:\n        - mountPath: /etc/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n      volumes:\n      - name: kubeconfig\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"sinker\" has memory limit 0"
  },
  {
    "id": "1187",
    "manifest_path": "data/manifests/the_stack_sample/sample_0142.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Service\nmetadata:\n  name: nacos-svc\n  namespace: default\n  labels:\n    app: nacos-svc\nspec:\n  type: ClusterIP\n  ports:\n  - port: 8848\n    name: server\n    targetPort: 8848\n  selector:\n    app: nacos\n",
    "policy_id": "dangling-service",
    "violation_text": "no pods found matching service labels (map[app:nacos])"
  },
  {
    "id": "1188",
    "manifest_path": "data/manifests/the_stack_sample/sample_0145.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: tide\n  labels:\n    app: tide\nspec:\n  replicas: 1\n  strategy:\n    type: Recreate\n  selector:\n    matchLabels:\n      app: tide\n  template:\n    metadata:\n      labels:\n        app: tide\n    spec:\n      serviceAccountName: tide\n      containers:\n      - name: tide\n        image: gcr.io/k8s-prow/tide:v20200225-55a0aacbd\n        args:\n        - --dry-run=false\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        - --history-uri=gs://k8s-prow/tide-history.json\n        - --status-path=gs://k8s-prow/tide-status-checkpoint.yaml\n        ports:\n        - name: http\n          containerPort: 8888\n        volumeMounts:\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n      volumes:\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"tide\" does not have a read-only root file system"
  },
  {
    "id": "1189",
    "manifest_path": "data/manifests/the_stack_sample/sample_0145.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: tide\n  labels:\n    app: tide\nspec:\n  replicas: 1\n  strategy:\n    type: Recreate\n  selector:\n    matchLabels:\n      app: tide\n  template:\n    metadata:\n      labels:\n        app: tide\n    spec:\n      serviceAccountName: tide\n      containers:\n      - name: tide\n        image: gcr.io/k8s-prow/tide:v20200225-55a0aacbd\n        args:\n        - --dry-run=false\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        - --history-uri=gs://k8s-prow/tide-history.json\n        - --status-path=gs://k8s-prow/tide-status-checkpoint.yaml\n        ports:\n        - name: http\n          containerPort: 8888\n        volumeMounts:\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n      volumes:\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n",
    "policy_id": "non-existent-service-account",
    "violation_text": "serviceAccount \"tide\" not found"
  },
  {
    "id": "1190",
    "manifest_path": "data/manifests/the_stack_sample/sample_0145.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: tide\n  labels:\n    app: tide\nspec:\n  replicas: 1\n  strategy:\n    type: Recreate\n  selector:\n    matchLabels:\n      app: tide\n  template:\n    metadata:\n      labels:\n        app: tide\n    spec:\n      serviceAccountName: tide\n      containers:\n      - name: tide\n        image: gcr.io/k8s-prow/tide:v20200225-55a0aacbd\n        args:\n        - --dry-run=false\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        - --history-uri=gs://k8s-prow/tide-history.json\n        - --status-path=gs://k8s-prow/tide-status-checkpoint.yaml\n        ports:\n        - name: http\n          containerPort: 8888\n        volumeMounts:\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n      volumes:\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"tide\" is not set to runAsNonRoot"
  },
  {
    "id": "1191",
    "manifest_path": "data/manifests/the_stack_sample/sample_0145.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: tide\n  labels:\n    app: tide\nspec:\n  replicas: 1\n  strategy:\n    type: Recreate\n  selector:\n    matchLabels:\n      app: tide\n  template:\n    metadata:\n      labels:\n        app: tide\n    spec:\n      serviceAccountName: tide\n      containers:\n      - name: tide\n        image: gcr.io/k8s-prow/tide:v20200225-55a0aacbd\n        args:\n        - --dry-run=false\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        - --history-uri=gs://k8s-prow/tide-history.json\n        - --status-path=gs://k8s-prow/tide-status-checkpoint.yaml\n        ports:\n        - name: http\n          containerPort: 8888\n        volumeMounts:\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n      volumes:\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"tide\" has cpu request 0"
  },
  {
    "id": "1192",
    "manifest_path": "data/manifests/the_stack_sample/sample_0145.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: tide\n  labels:\n    app: tide\nspec:\n  replicas: 1\n  strategy:\n    type: Recreate\n  selector:\n    matchLabels:\n      app: tide\n  template:\n    metadata:\n      labels:\n        app: tide\n    spec:\n      serviceAccountName: tide\n      containers:\n      - name: tide\n        image: gcr.io/k8s-prow/tide:v20200225-55a0aacbd\n        args:\n        - --dry-run=false\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        - --history-uri=gs://k8s-prow/tide-history.json\n        - --status-path=gs://k8s-prow/tide-status-checkpoint.yaml\n        ports:\n        - name: http\n          containerPort: 8888\n        volumeMounts:\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n      volumes:\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"tide\" has memory limit 0"
  },
  {
    "id": "1193",
    "manifest_path": "data/manifests/the_stack_sample/sample_0149.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Service\nmetadata:\n  name: openldap\n  labels:\n    app: openldap\nspec:\n  selector:\n    app: openldap\n  type: ClusterIP\n  ports:\n  - name: notsecure\n    port: 389\n    targetPort: 389\n  - name: secure\n    port: 636\n    targetPort: 636\n",
    "policy_id": "dangling-service",
    "violation_text": "no pods found matching service labels (map[app:openldap])"
  },
  {
    "id": "1194",
    "manifest_path": "data/manifests/the_stack_sample/sample_0150.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Service\nmetadata:\n  labels:\n    control-plane: controller-manager\n  name: metrics-service\n  namespace: system\nspec:\n  ports:\n  - name: metrics\n    port: 8080\n    targetPort: 8080\n  selector:\n    control-plane: controller-manager\n",
    "policy_id": "dangling-service",
    "violation_text": "no pods found matching service labels (map[control-plane:controller-manager])"
  },
  {
    "id": "1195",
    "manifest_path": "data/manifests/the_stack_sample/sample_0153.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: my-pod\nspec:\n  containers:\n  - name: busybox\n    image: busybox:1.34.1\n    command:\n    - /bin/sh\n    - -c\n    - echo $MY_ENV_VAR && sleep 99d\n    env:\n    - name: MY_ENV_VAR\n      valueFrom:\n        configMapKeyRef:\n          key: a-key\n          name: a-configmap\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"busybox\" does not have a read-only root file system"
  },
  {
    "id": "1196",
    "manifest_path": "data/manifests/the_stack_sample/sample_0153.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: my-pod\nspec:\n  containers:\n  - name: busybox\n    image: busybox:1.34.1\n    command:\n    - /bin/sh\n    - -c\n    - echo $MY_ENV_VAR && sleep 99d\n    env:\n    - name: MY_ENV_VAR\n      valueFrom:\n        configMapKeyRef:\n          key: a-key\n          name: a-configmap\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"busybox\" is not set to runAsNonRoot"
  },
  {
    "id": "1197",
    "manifest_path": "data/manifests/the_stack_sample/sample_0153.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: my-pod\nspec:\n  containers:\n  - name: busybox\n    image: busybox:1.34.1\n    command:\n    - /bin/sh\n    - -c\n    - echo $MY_ENV_VAR && sleep 99d\n    env:\n    - name: MY_ENV_VAR\n      valueFrom:\n        configMapKeyRef:\n          key: a-key\n          name: a-configmap\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"busybox\" has cpu request 0"
  },
  {
    "id": "1198",
    "manifest_path": "data/manifests/the_stack_sample/sample_0153.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: my-pod\nspec:\n  containers:\n  - name: busybox\n    image: busybox:1.34.1\n    command:\n    - /bin/sh\n    - -c\n    - echo $MY_ENV_VAR && sleep 99d\n    env:\n    - name: MY_ENV_VAR\n      valueFrom:\n        configMapKeyRef:\n          key: a-key\n          name: a-configmap\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"busybox\" has memory limit 0"
  },
  {
    "id": "1199",
    "manifest_path": "data/manifests/the_stack_sample/sample_0154.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: dns-test\n  namespace: kube-system\nspec:\n  containers:\n  - image: busybox\n    command:\n    - sleep\n    - '3600'\n    imagePullPolicy: IfNotPresent\n    name: busybox\n  restartPolicy: Always\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"busybox\" is using an invalid container image, \"busybox\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "1200",
    "manifest_path": "data/manifests/the_stack_sample/sample_0154.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: dns-test\n  namespace: kube-system\nspec:\n  containers:\n  - image: busybox\n    command:\n    - sleep\n    - '3600'\n    imagePullPolicy: IfNotPresent\n    name: busybox\n  restartPolicy: Always\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"busybox\" does not have a read-only root file system"
  },
  {
    "id": "1201",
    "manifest_path": "data/manifests/the_stack_sample/sample_0154.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: dns-test\n  namespace: kube-system\nspec:\n  containers:\n  - image: busybox\n    command:\n    - sleep\n    - '3600'\n    imagePullPolicy: IfNotPresent\n    name: busybox\n  restartPolicy: Always\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"busybox\" is not set to runAsNonRoot"
  },
  {
    "id": "1202",
    "manifest_path": "data/manifests/the_stack_sample/sample_0154.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: dns-test\n  namespace: kube-system\nspec:\n  containers:\n  - image: busybox\n    command:\n    - sleep\n    - '3600'\n    imagePullPolicy: IfNotPresent\n    name: busybox\n  restartPolicy: Always\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"busybox\" has cpu request 0"
  },
  {
    "id": "1203",
    "manifest_path": "data/manifests/the_stack_sample/sample_0154.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: dns-test\n  namespace: kube-system\nspec:\n  containers:\n  - image: busybox\n    command:\n    - sleep\n    - '3600'\n    imagePullPolicy: IfNotPresent\n    name: busybox\n  restartPolicy: Always\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"busybox\" has memory limit 0"
  },
  {
    "id": "1204",
    "manifest_path": "data/manifests/the_stack_sample/sample_0155.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: statusreconciler\n  labels:\n    app: statusreconciler\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: statusreconciler\n  template:\n    metadata:\n      labels:\n        app: statusreconciler\n    spec:\n      serviceAccountName: statusreconciler\n      terminationGracePeriodSeconds: 180\n      containers:\n      - name: statusreconciler\n        image: gcr.io/k8s-prow/status-reconciler:v20211014-7ca1952a94\n        imagePullPolicy: Always\n        args:\n        - --dry-run=false\n        - --continue-on-error=true\n        - --plugin-config=/etc/plugins/plugins.yaml\n        - --config-path=/etc/config/config.yaml\n        - --github-token-path=/etc/github/oauth\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --job-config-path=/etc/job-config\n        - --denylist=kubernetes/kubernetes\n        volumeMounts:\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        - name: plugins\n          mountPath: /etc/plugins\n          readOnly: true\n      volumes:\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n      - name: plugins\n        configMap:\n          name: plugins\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"statusreconciler\" does not have a read-only root file system"
  },
  {
    "id": "1205",
    "manifest_path": "data/manifests/the_stack_sample/sample_0155.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: statusreconciler\n  labels:\n    app: statusreconciler\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: statusreconciler\n  template:\n    metadata:\n      labels:\n        app: statusreconciler\n    spec:\n      serviceAccountName: statusreconciler\n      terminationGracePeriodSeconds: 180\n      containers:\n      - name: statusreconciler\n        image: gcr.io/k8s-prow/status-reconciler:v20211014-7ca1952a94\n        imagePullPolicy: Always\n        args:\n        - --dry-run=false\n        - --continue-on-error=true\n        - --plugin-config=/etc/plugins/plugins.yaml\n        - --config-path=/etc/config/config.yaml\n        - --github-token-path=/etc/github/oauth\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --job-config-path=/etc/job-config\n        - --denylist=kubernetes/kubernetes\n        volumeMounts:\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        - name: plugins\n          mountPath: /etc/plugins\n          readOnly: true\n      volumes:\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n      - name: plugins\n        configMap:\n          name: plugins\n",
    "policy_id": "non-existent-service-account",
    "violation_text": "serviceAccount \"statusreconciler\" not found"
  },
  {
    "id": "1206",
    "manifest_path": "data/manifests/the_stack_sample/sample_0155.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: statusreconciler\n  labels:\n    app: statusreconciler\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: statusreconciler\n  template:\n    metadata:\n      labels:\n        app: statusreconciler\n    spec:\n      serviceAccountName: statusreconciler\n      terminationGracePeriodSeconds: 180\n      containers:\n      - name: statusreconciler\n        image: gcr.io/k8s-prow/status-reconciler:v20211014-7ca1952a94\n        imagePullPolicy: Always\n        args:\n        - --dry-run=false\n        - --continue-on-error=true\n        - --plugin-config=/etc/plugins/plugins.yaml\n        - --config-path=/etc/config/config.yaml\n        - --github-token-path=/etc/github/oauth\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --job-config-path=/etc/job-config\n        - --denylist=kubernetes/kubernetes\n        volumeMounts:\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        - name: plugins\n          mountPath: /etc/plugins\n          readOnly: true\n      volumes:\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n      - name: plugins\n        configMap:\n          name: plugins\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"statusreconciler\" is not set to runAsNonRoot"
  },
  {
    "id": "1207",
    "manifest_path": "data/manifests/the_stack_sample/sample_0155.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: statusreconciler\n  labels:\n    app: statusreconciler\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: statusreconciler\n  template:\n    metadata:\n      labels:\n        app: statusreconciler\n    spec:\n      serviceAccountName: statusreconciler\n      terminationGracePeriodSeconds: 180\n      containers:\n      - name: statusreconciler\n        image: gcr.io/k8s-prow/status-reconciler:v20211014-7ca1952a94\n        imagePullPolicy: Always\n        args:\n        - --dry-run=false\n        - --continue-on-error=true\n        - --plugin-config=/etc/plugins/plugins.yaml\n        - --config-path=/etc/config/config.yaml\n        - --github-token-path=/etc/github/oauth\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --job-config-path=/etc/job-config\n        - --denylist=kubernetes/kubernetes\n        volumeMounts:\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        - name: plugins\n          mountPath: /etc/plugins\n          readOnly: true\n      volumes:\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n      - name: plugins\n        configMap:\n          name: plugins\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"statusreconciler\" has cpu request 0"
  },
  {
    "id": "1208",
    "manifest_path": "data/manifests/the_stack_sample/sample_0155.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: statusreconciler\n  labels:\n    app: statusreconciler\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: statusreconciler\n  template:\n    metadata:\n      labels:\n        app: statusreconciler\n    spec:\n      serviceAccountName: statusreconciler\n      terminationGracePeriodSeconds: 180\n      containers:\n      - name: statusreconciler\n        image: gcr.io/k8s-prow/status-reconciler:v20211014-7ca1952a94\n        imagePullPolicy: Always\n        args:\n        - --dry-run=false\n        - --continue-on-error=true\n        - --plugin-config=/etc/plugins/plugins.yaml\n        - --config-path=/etc/config/config.yaml\n        - --github-token-path=/etc/github/oauth\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --job-config-path=/etc/job-config\n        - --denylist=kubernetes/kubernetes\n        volumeMounts:\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        - name: plugins\n          mountPath: /etc/plugins\n          readOnly: true\n      volumes:\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n      - name: plugins\n        configMap:\n          name: plugins\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"statusreconciler\" has memory limit 0"
  },
  {
    "id": "1209",
    "manifest_path": "data/manifests/the_stack_sample/sample_0156.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-5718\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"nginx\" is using an invalid container image, \"nginx\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "1210",
    "manifest_path": "data/manifests/the_stack_sample/sample_0156.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-5718\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"nginx\" does not have a read-only root file system"
  },
  {
    "id": "1211",
    "manifest_path": "data/manifests/the_stack_sample/sample_0156.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-5718\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"nginx\" is not set to runAsNonRoot"
  },
  {
    "id": "1212",
    "manifest_path": "data/manifests/the_stack_sample/sample_0156.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-5718\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"nginx\" has cpu request 0"
  },
  {
    "id": "1213",
    "manifest_path": "data/manifests/the_stack_sample/sample_0156.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-5718\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"nginx\" has memory limit 0"
  },
  {
    "id": "1214",
    "manifest_path": "data/manifests/the_stack_sample/sample_0157.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: deis-slugrunner\n  labels:\n    heritage: deis\n    version: 2015-sept\nspec:\n  restartPolicy: Never\n  containers:\n  - name: deis-slugrunner\n    imagePullPolicy: Always\n    image: smothiki/slugrunner:4\n    args:\n    - start\n    - web\n    env:\n    - name: PORT\n      value: '5000'\n    - name: DEBUG\n      value: '1'\n    - name: SLUG_URL\n      value: https://s3.amazonaws.com/mydaffa/myslug.tgz\n    volumeMounts:\n    - name: object-store\n      mountPath: /var/run/secrets/object/store\n      readOnly: true\n  volumes:\n  - name: object-store\n    secret:\n      secretName: object-store\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"deis-slugrunner\" does not have a read-only root file system"
  },
  {
    "id": "1215",
    "manifest_path": "data/manifests/the_stack_sample/sample_0157.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: deis-slugrunner\n  labels:\n    heritage: deis\n    version: 2015-sept\nspec:\n  restartPolicy: Never\n  containers:\n  - name: deis-slugrunner\n    imagePullPolicy: Always\n    image: smothiki/slugrunner:4\n    args:\n    - start\n    - web\n    env:\n    - name: PORT\n      value: '5000'\n    - name: DEBUG\n      value: '1'\n    - name: SLUG_URL\n      value: https://s3.amazonaws.com/mydaffa/myslug.tgz\n    volumeMounts:\n    - name: object-store\n      mountPath: /var/run/secrets/object/store\n      readOnly: true\n  volumes:\n  - name: object-store\n    secret:\n      secretName: object-store\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"deis-slugrunner\" is not set to runAsNonRoot"
  },
  {
    "id": "1216",
    "manifest_path": "data/manifests/the_stack_sample/sample_0157.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: deis-slugrunner\n  labels:\n    heritage: deis\n    version: 2015-sept\nspec:\n  restartPolicy: Never\n  containers:\n  - name: deis-slugrunner\n    imagePullPolicy: Always\n    image: smothiki/slugrunner:4\n    args:\n    - start\n    - web\n    env:\n    - name: PORT\n      value: '5000'\n    - name: DEBUG\n      value: '1'\n    - name: SLUG_URL\n      value: https://s3.amazonaws.com/mydaffa/myslug.tgz\n    volumeMounts:\n    - name: object-store\n      mountPath: /var/run/secrets/object/store\n      readOnly: true\n  volumes:\n  - name: object-store\n    secret:\n      secretName: object-store\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"deis-slugrunner\" has cpu request 0"
  },
  {
    "id": "1217",
    "manifest_path": "data/manifests/the_stack_sample/sample_0157.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: deis-slugrunner\n  labels:\n    heritage: deis\n    version: 2015-sept\nspec:\n  restartPolicy: Never\n  containers:\n  - name: deis-slugrunner\n    imagePullPolicy: Always\n    image: smothiki/slugrunner:4\n    args:\n    - start\n    - web\n    env:\n    - name: PORT\n      value: '5000'\n    - name: DEBUG\n      value: '1'\n    - name: SLUG_URL\n      value: https://s3.amazonaws.com/mydaffa/myslug.tgz\n    volumeMounts:\n    - name: object-store\n      mountPath: /var/run/secrets/object/store\n      readOnly: true\n  volumes:\n  - name: object-store\n    secret:\n      secretName: object-store\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"deis-slugrunner\" has memory limit 0"
  },
  {
    "id": "1218",
    "manifest_path": "data/manifests/the_stack_sample/sample_0158.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: go-server-rc\nspec:\n  replicas: 3\n  selector:\n    name: go-server\n    version: v8\n  template:\n    metadata:\n      labels:\n        name: go-server\n        version: v8\n    spec:\n      containers:\n      - name: go-server\n        image: gcr.io/pragmatic-mote-207921/amal-img:46d49ab\n        ports:\n        - containerPort: 5000\n",
    "policy_id": "no-anti-affinity",
    "violation_text": "object has 3 replicas but does not specify inter pod anti-affinity"
  },
  {
    "id": "1219",
    "manifest_path": "data/manifests/the_stack_sample/sample_0158.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: go-server-rc\nspec:\n  replicas: 3\n  selector:\n    name: go-server\n    version: v8\n  template:\n    metadata:\n      labels:\n        name: go-server\n        version: v8\n    spec:\n      containers:\n      - name: go-server\n        image: gcr.io/pragmatic-mote-207921/amal-img:46d49ab\n        ports:\n        - containerPort: 5000\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"go-server\" does not have a read-only root file system"
  },
  {
    "id": "1220",
    "manifest_path": "data/manifests/the_stack_sample/sample_0158.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: go-server-rc\nspec:\n  replicas: 3\n  selector:\n    name: go-server\n    version: v8\n  template:\n    metadata:\n      labels:\n        name: go-server\n        version: v8\n    spec:\n      containers:\n      - name: go-server\n        image: gcr.io/pragmatic-mote-207921/amal-img:46d49ab\n        ports:\n        - containerPort: 5000\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"go-server\" is not set to runAsNonRoot"
  },
  {
    "id": "1221",
    "manifest_path": "data/manifests/the_stack_sample/sample_0158.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: go-server-rc\nspec:\n  replicas: 3\n  selector:\n    name: go-server\n    version: v8\n  template:\n    metadata:\n      labels:\n        name: go-server\n        version: v8\n    spec:\n      containers:\n      - name: go-server\n        image: gcr.io/pragmatic-mote-207921/amal-img:46d49ab\n        ports:\n        - containerPort: 5000\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"go-server\" has cpu request 0"
  },
  {
    "id": "1222",
    "manifest_path": "data/manifests/the_stack_sample/sample_0158.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: go-server-rc\nspec:\n  replicas: 3\n  selector:\n    name: go-server\n    version: v8\n  template:\n    metadata:\n      labels:\n        name: go-server\n        version: v8\n    spec:\n      containers:\n      - name: go-server\n        image: gcr.io/pragmatic-mote-207921/amal-img:46d49ab\n        ports:\n        - containerPort: 5000\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"go-server\" has memory limit 0"
  },
  {
    "id": "1223",
    "manifest_path": "data/manifests/the_stack_sample/sample_0162.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nspec:\n  containers:\n  - name: docker\n    image: docker:stable-git\n    command:\n    - cat\n    tty: true\n    volumeMounts:\n    - name: dockersock\n      mountPath: /var/run/docker.sock\n  - name: vamp-cli-ee\n    image: vlesierse/vamp-cli-ee:latest\n    command:\n    - cat\n    tty: true\n  volumes:\n  - name: dockersock\n    hostPath:\n      path: /var/run/docker.sock\n",
    "policy_id": "docker-sock",
    "violation_text": "host system directory \"/var/run/docker.sock\" is mounted on container \"docker\""
  },
  {
    "id": "1224",
    "manifest_path": "data/manifests/the_stack_sample/sample_0162.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nspec:\n  containers:\n  - name: docker\n    image: docker:stable-git\n    command:\n    - cat\n    tty: true\n    volumeMounts:\n    - name: dockersock\n      mountPath: /var/run/docker.sock\n  - name: vamp-cli-ee\n    image: vlesierse/vamp-cli-ee:latest\n    command:\n    - cat\n    tty: true\n  volumes:\n  - name: dockersock\n    hostPath:\n      path: /var/run/docker.sock\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"vamp-cli-ee\" is using an invalid container image, \"vlesierse/vamp-cli-ee:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "1225",
    "manifest_path": "data/manifests/the_stack_sample/sample_0162.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nspec:\n  containers:\n  - name: docker\n    image: docker:stable-git\n    command:\n    - cat\n    tty: true\n    volumeMounts:\n    - name: dockersock\n      mountPath: /var/run/docker.sock\n  - name: vamp-cli-ee\n    image: vlesierse/vamp-cli-ee:latest\n    command:\n    - cat\n    tty: true\n  volumes:\n  - name: dockersock\n    hostPath:\n      path: /var/run/docker.sock\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"docker\" does not have a read-only root file system"
  },
  {
    "id": "1226",
    "manifest_path": "data/manifests/the_stack_sample/sample_0162.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nspec:\n  containers:\n  - name: docker\n    image: docker:stable-git\n    command:\n    - cat\n    tty: true\n    volumeMounts:\n    - name: dockersock\n      mountPath: /var/run/docker.sock\n  - name: vamp-cli-ee\n    image: vlesierse/vamp-cli-ee:latest\n    command:\n    - cat\n    tty: true\n  volumes:\n  - name: dockersock\n    hostPath:\n      path: /var/run/docker.sock\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"vamp-cli-ee\" does not have a read-only root file system"
  },
  {
    "id": "1227",
    "manifest_path": "data/manifests/the_stack_sample/sample_0162.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nspec:\n  containers:\n  - name: docker\n    image: docker:stable-git\n    command:\n    - cat\n    tty: true\n    volumeMounts:\n    - name: dockersock\n      mountPath: /var/run/docker.sock\n  - name: vamp-cli-ee\n    image: vlesierse/vamp-cli-ee:latest\n    command:\n    - cat\n    tty: true\n  volumes:\n  - name: dockersock\n    hostPath:\n      path: /var/run/docker.sock\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"docker\" is not set to runAsNonRoot"
  },
  {
    "id": "1228",
    "manifest_path": "data/manifests/the_stack_sample/sample_0162.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nspec:\n  containers:\n  - name: docker\n    image: docker:stable-git\n    command:\n    - cat\n    tty: true\n    volumeMounts:\n    - name: dockersock\n      mountPath: /var/run/docker.sock\n  - name: vamp-cli-ee\n    image: vlesierse/vamp-cli-ee:latest\n    command:\n    - cat\n    tty: true\n  volumes:\n  - name: dockersock\n    hostPath:\n      path: /var/run/docker.sock\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"vamp-cli-ee\" is not set to runAsNonRoot"
  },
  {
    "id": "1229",
    "manifest_path": "data/manifests/the_stack_sample/sample_0162.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nspec:\n  containers:\n  - name: docker\n    image: docker:stable-git\n    command:\n    - cat\n    tty: true\n    volumeMounts:\n    - name: dockersock\n      mountPath: /var/run/docker.sock\n  - name: vamp-cli-ee\n    image: vlesierse/vamp-cli-ee:latest\n    command:\n    - cat\n    tty: true\n  volumes:\n  - name: dockersock\n    hostPath:\n      path: /var/run/docker.sock\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"docker\" has cpu request 0"
  },
  {
    "id": "1230",
    "manifest_path": "data/manifests/the_stack_sample/sample_0162.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nspec:\n  containers:\n  - name: docker\n    image: docker:stable-git\n    command:\n    - cat\n    tty: true\n    volumeMounts:\n    - name: dockersock\n      mountPath: /var/run/docker.sock\n  - name: vamp-cli-ee\n    image: vlesierse/vamp-cli-ee:latest\n    command:\n    - cat\n    tty: true\n  volumes:\n  - name: dockersock\n    hostPath:\n      path: /var/run/docker.sock\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"vamp-cli-ee\" has cpu request 0"
  },
  {
    "id": "1231",
    "manifest_path": "data/manifests/the_stack_sample/sample_0162.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nspec:\n  containers:\n  - name: docker\n    image: docker:stable-git\n    command:\n    - cat\n    tty: true\n    volumeMounts:\n    - name: dockersock\n      mountPath: /var/run/docker.sock\n  - name: vamp-cli-ee\n    image: vlesierse/vamp-cli-ee:latest\n    command:\n    - cat\n    tty: true\n  volumes:\n  - name: dockersock\n    hostPath:\n      path: /var/run/docker.sock\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"docker\" has memory limit 0"
  },
  {
    "id": "1232",
    "manifest_path": "data/manifests/the_stack_sample/sample_0162.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nspec:\n  containers:\n  - name: docker\n    image: docker:stable-git\n    command:\n    - cat\n    tty: true\n    volumeMounts:\n    - name: dockersock\n      mountPath: /var/run/docker.sock\n  - name: vamp-cli-ee\n    image: vlesierse/vamp-cli-ee:latest\n    command:\n    - cat\n    tty: true\n  volumes:\n  - name: dockersock\n    hostPath:\n      path: /var/run/docker.sock\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"vamp-cli-ee\" has memory limit 0"
  },
  {
    "id": "1233",
    "manifest_path": "data/manifests/the_stack_sample/sample_0163.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: lighthouse-keeper\n  labels:\n    chart: lighthouse-1.1.51\n    app: lighthouse-keeper\n    gitops.jenkins-x.io/pipeline: namespaces\n  annotations:\n    meta.helm.sh/release-name: lighthouse\n    wave.pusher.com/update-on-config-change: 'true'\n  namespace: jx\nspec:\n  replicas: 1\n  strategy:\n    type: RollingUpdate\n    rollingUpdate:\n      maxSurge: 1\n      maxUnavailable: 1\n  selector:\n    matchLabels:\n      app: lighthouse-keeper\n  template:\n    metadata:\n      annotations:\n        ad.datadoghq.com/keeper.logs: '[{\"source\":\"lighthouse\",\"service\":\"keeper\"}]'\n        prometheus.io/port: '9090'\n        prometheus.io/scrape: 'true'\n        jenkins-x.io/hash: 96b3634b43df2329d5c73888957b70798af1e33b9bc37b02d5c340ae6962f9cd\n      labels:\n        app: lighthouse-keeper\n    spec:\n      serviceAccountName: lighthouse-keeper\n      terminationGracePeriodSeconds: 30\n      containers:\n      - name: lighthouse-keeper\n        image: ghcr.io/jenkins-x/lighthouse-keeper:1.1.51\n        imagePullPolicy: IfNotPresent\n        args:\n        - --namespace=jx\n        ports:\n        - name: http\n          containerPort: 8888\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /\n            port: http\n          initialDelaySeconds: 120\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        readinessProbe:\n          httpGet:\n            path: /\n            port: http\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        env:\n        - name: GIT_KIND\n          value: github\n        - name: GIT_SERVER\n          value: https://github.com\n        - name: GIT_USER\n          value: Sun-ifly\n        - name: GIT_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: lighthouse-oauth-token\n              key: oauth\n        - name: JX_LOG_FORMAT\n          value: json\n        - name: LOGRUS_FORMAT\n          value: json\n        - name: LOGRUS_SERVICE\n          value: lighthouse\n        - name: LOGRUS_SERVICE_VERSION\n          value: 1.1.51\n        - name: LOGRUS_STACK_SKIP\n          value: ''\n        - name: LIGHTHOUSE_KEEPER_STATUS_CONTEXT_LABEL\n          value: Lighthouse Merge Status\n        - name: LIGHTHOUSE_TRIGGER_ON_MISSING\n          value: enable\n        envFrom:\n        - secretRef:\n            name: jx-boot-job-env-vars\n            optional: true\n        resources:\n          limits:\n            cpu: 400m\n            memory: 512Mi\n          requests:\n            cpu: 100m\n            memory: 128Mi\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"lighthouse-keeper\" does not have a read-only root file system"
  },
  {
    "id": "1234",
    "manifest_path": "data/manifests/the_stack_sample/sample_0163.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: lighthouse-keeper\n  labels:\n    chart: lighthouse-1.1.51\n    app: lighthouse-keeper\n    gitops.jenkins-x.io/pipeline: namespaces\n  annotations:\n    meta.helm.sh/release-name: lighthouse\n    wave.pusher.com/update-on-config-change: 'true'\n  namespace: jx\nspec:\n  replicas: 1\n  strategy:\n    type: RollingUpdate\n    rollingUpdate:\n      maxSurge: 1\n      maxUnavailable: 1\n  selector:\n    matchLabels:\n      app: lighthouse-keeper\n  template:\n    metadata:\n      annotations:\n        ad.datadoghq.com/keeper.logs: '[{\"source\":\"lighthouse\",\"service\":\"keeper\"}]'\n        prometheus.io/port: '9090'\n        prometheus.io/scrape: 'true'\n        jenkins-x.io/hash: 96b3634b43df2329d5c73888957b70798af1e33b9bc37b02d5c340ae6962f9cd\n      labels:\n        app: lighthouse-keeper\n    spec:\n      serviceAccountName: lighthouse-keeper\n      terminationGracePeriodSeconds: 30\n      containers:\n      - name: lighthouse-keeper\n        image: ghcr.io/jenkins-x/lighthouse-keeper:1.1.51\n        imagePullPolicy: IfNotPresent\n        args:\n        - --namespace=jx\n        ports:\n        - name: http\n          containerPort: 8888\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /\n            port: http\n          initialDelaySeconds: 120\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        readinessProbe:\n          httpGet:\n            path: /\n            port: http\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        env:\n        - name: GIT_KIND\n          value: github\n        - name: GIT_SERVER\n          value: https://github.com\n        - name: GIT_USER\n          value: Sun-ifly\n        - name: GIT_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: lighthouse-oauth-token\n              key: oauth\n        - name: JX_LOG_FORMAT\n          value: json\n        - name: LOGRUS_FORMAT\n          value: json\n        - name: LOGRUS_SERVICE\n          value: lighthouse\n        - name: LOGRUS_SERVICE_VERSION\n          value: 1.1.51\n        - name: LOGRUS_STACK_SKIP\n          value: ''\n        - name: LIGHTHOUSE_KEEPER_STATUS_CONTEXT_LABEL\n          value: Lighthouse Merge Status\n        - name: LIGHTHOUSE_TRIGGER_ON_MISSING\n          value: enable\n        envFrom:\n        - secretRef:\n            name: jx-boot-job-env-vars\n            optional: true\n        resources:\n          limits:\n            cpu: 400m\n            memory: 512Mi\n          requests:\n            cpu: 100m\n            memory: 128Mi\n",
    "policy_id": "non-existent-service-account",
    "violation_text": "serviceAccount \"lighthouse-keeper\" not found"
  },
  {
    "id": "1235",
    "manifest_path": "data/manifests/the_stack_sample/sample_0163.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: lighthouse-keeper\n  labels:\n    chart: lighthouse-1.1.51\n    app: lighthouse-keeper\n    gitops.jenkins-x.io/pipeline: namespaces\n  annotations:\n    meta.helm.sh/release-name: lighthouse\n    wave.pusher.com/update-on-config-change: 'true'\n  namespace: jx\nspec:\n  replicas: 1\n  strategy:\n    type: RollingUpdate\n    rollingUpdate:\n      maxSurge: 1\n      maxUnavailable: 1\n  selector:\n    matchLabels:\n      app: lighthouse-keeper\n  template:\n    metadata:\n      annotations:\n        ad.datadoghq.com/keeper.logs: '[{\"source\":\"lighthouse\",\"service\":\"keeper\"}]'\n        prometheus.io/port: '9090'\n        prometheus.io/scrape: 'true'\n        jenkins-x.io/hash: 96b3634b43df2329d5c73888957b70798af1e33b9bc37b02d5c340ae6962f9cd\n      labels:\n        app: lighthouse-keeper\n    spec:\n      serviceAccountName: lighthouse-keeper\n      terminationGracePeriodSeconds: 30\n      containers:\n      - name: lighthouse-keeper\n        image: ghcr.io/jenkins-x/lighthouse-keeper:1.1.51\n        imagePullPolicy: IfNotPresent\n        args:\n        - --namespace=jx\n        ports:\n        - name: http\n          containerPort: 8888\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /\n            port: http\n          initialDelaySeconds: 120\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        readinessProbe:\n          httpGet:\n            path: /\n            port: http\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        env:\n        - name: GIT_KIND\n          value: github\n        - name: GIT_SERVER\n          value: https://github.com\n        - name: GIT_USER\n          value: Sun-ifly\n        - name: GIT_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: lighthouse-oauth-token\n              key: oauth\n        - name: JX_LOG_FORMAT\n          value: json\n        - name: LOGRUS_FORMAT\n          value: json\n        - name: LOGRUS_SERVICE\n          value: lighthouse\n        - name: LOGRUS_SERVICE_VERSION\n          value: 1.1.51\n        - name: LOGRUS_STACK_SKIP\n          value: ''\n        - name: LIGHTHOUSE_KEEPER_STATUS_CONTEXT_LABEL\n          value: Lighthouse Merge Status\n        - name: LIGHTHOUSE_TRIGGER_ON_MISSING\n          value: enable\n        envFrom:\n        - secretRef:\n            name: jx-boot-job-env-vars\n            optional: true\n        resources:\n          limits:\n            cpu: 400m\n            memory: 512Mi\n          requests:\n            cpu: 100m\n            memory: 128Mi\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"lighthouse-keeper\" is not set to runAsNonRoot"
  },
  {
    "id": "1236",
    "manifest_path": "data/manifests/the_stack_sample/sample_0164.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: flask-dep\n  labels:\n    app: flask-helloworld\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: flask-helloworld\n  template:\n    metadata:\n      labels:\n        app: flask-helloworld\n    spec:\n      containers:\n      - name: flask\n        image: grimsleepless/workshop_flask:v1\n        ports:\n        - containerPort: 5000\n        env:\n        - name: REDIS_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: redis-config\n              key: host\n        - name: REDIS_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: redis-config\n              key: port\n",
    "policy_id": "no-anti-affinity",
    "violation_text": "object has 2 replicas but does not specify inter pod anti-affinity"
  },
  {
    "id": "1237",
    "manifest_path": "data/manifests/the_stack_sample/sample_0164.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: flask-dep\n  labels:\n    app: flask-helloworld\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: flask-helloworld\n  template:\n    metadata:\n      labels:\n        app: flask-helloworld\n    spec:\n      containers:\n      - name: flask\n        image: grimsleepless/workshop_flask:v1\n        ports:\n        - containerPort: 5000\n        env:\n        - name: REDIS_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: redis-config\n              key: host\n        - name: REDIS_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: redis-config\n              key: port\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"flask\" does not have a read-only root file system"
  },
  {
    "id": "1238",
    "manifest_path": "data/manifests/the_stack_sample/sample_0164.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: flask-dep\n  labels:\n    app: flask-helloworld\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: flask-helloworld\n  template:\n    metadata:\n      labels:\n        app: flask-helloworld\n    spec:\n      containers:\n      - name: flask\n        image: grimsleepless/workshop_flask:v1\n        ports:\n        - containerPort: 5000\n        env:\n        - name: REDIS_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: redis-config\n              key: host\n        - name: REDIS_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: redis-config\n              key: port\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"flask\" is not set to runAsNonRoot"
  },
  {
    "id": "1239",
    "manifest_path": "data/manifests/the_stack_sample/sample_0164.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: flask-dep\n  labels:\n    app: flask-helloworld\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: flask-helloworld\n  template:\n    metadata:\n      labels:\n        app: flask-helloworld\n    spec:\n      containers:\n      - name: flask\n        image: grimsleepless/workshop_flask:v1\n        ports:\n        - containerPort: 5000\n        env:\n        - name: REDIS_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: redis-config\n              key: host\n        - name: REDIS_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: redis-config\n              key: port\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"flask\" has cpu request 0"
  },
  {
    "id": "1240",
    "manifest_path": "data/manifests/the_stack_sample/sample_0164.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: flask-dep\n  labels:\n    app: flask-helloworld\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: flask-helloworld\n  template:\n    metadata:\n      labels:\n        app: flask-helloworld\n    spec:\n      containers:\n      - name: flask\n        image: grimsleepless/workshop_flask:v1\n        ports:\n        - containerPort: 5000\n        env:\n        - name: REDIS_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: redis-config\n              key: host\n        - name: REDIS_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: redis-config\n              key: port\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"flask\" has memory limit 0"
  },
  {
    "id": "1241",
    "manifest_path": "data/manifests/the_stack_sample/sample_0170.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: CronJob\nmetadata:\n  name: mycronjob\nspec:\n  schedule: '*/1 * * * *'\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          containers:\n          - name: mycron-container\n            image: alpine\n            imagePullPolicy: IfNotPresent\n            command:\n            - sh\n            - -c\n            - echo elastic world ; sleep 5\n          restartPolicy: OnFailure\n          terminationGracePeriodSeconds: 0\n  concurrencyPolicy: Allow\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"mycron-container\" is using an invalid container image, \"alpine\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "1242",
    "manifest_path": "data/manifests/the_stack_sample/sample_0170.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: CronJob\nmetadata:\n  name: mycronjob\nspec:\n  schedule: '*/1 * * * *'\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          containers:\n          - name: mycron-container\n            image: alpine\n            imagePullPolicy: IfNotPresent\n            command:\n            - sh\n            - -c\n            - echo elastic world ; sleep 5\n          restartPolicy: OnFailure\n          terminationGracePeriodSeconds: 0\n  concurrencyPolicy: Allow\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"mycron-container\" does not have a read-only root file system"
  },
  {
    "id": "1243",
    "manifest_path": "data/manifests/the_stack_sample/sample_0170.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: CronJob\nmetadata:\n  name: mycronjob\nspec:\n  schedule: '*/1 * * * *'\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          containers:\n          - name: mycron-container\n            image: alpine\n            imagePullPolicy: IfNotPresent\n            command:\n            - sh\n            - -c\n            - echo elastic world ; sleep 5\n          restartPolicy: OnFailure\n          terminationGracePeriodSeconds: 0\n  concurrencyPolicy: Allow\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"mycron-container\" is not set to runAsNonRoot"
  },
  {
    "id": "1244",
    "manifest_path": "data/manifests/the_stack_sample/sample_0170.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: CronJob\nmetadata:\n  name: mycronjob\nspec:\n  schedule: '*/1 * * * *'\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          containers:\n          - name: mycron-container\n            image: alpine\n            imagePullPolicy: IfNotPresent\n            command:\n            - sh\n            - -c\n            - echo elastic world ; sleep 5\n          restartPolicy: OnFailure\n          terminationGracePeriodSeconds: 0\n  concurrencyPolicy: Allow\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"mycron-container\" has cpu request 0"
  },
  {
    "id": "1245",
    "manifest_path": "data/manifests/the_stack_sample/sample_0170.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: CronJob\nmetadata:\n  name: mycronjob\nspec:\n  schedule: '*/1 * * * *'\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          containers:\n          - name: mycron-container\n            image: alpine\n            imagePullPolicy: IfNotPresent\n            command:\n            - sh\n            - -c\n            - echo elastic world ; sleep 5\n          restartPolicy: OnFailure\n          terminationGracePeriodSeconds: 0\n  concurrencyPolicy: Allow\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"mycron-container\" has memory limit 0"
  },
  {
    "id": "1246",
    "manifest_path": "data/manifests/the_stack_sample/sample_0172.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: ecsdemo-nodejs\n  labels:\n    app: ecsdemo-nodejs\n  namespace: ecsdemo-nodejs\nspec:\n  replicas: 6\n  selector:\n    matchLabels:\n      app: ecsdemo-nodejs\n  strategy:\n    rollingUpdate:\n      maxSurge: 25%\n      maxUnavailable: 25%\n    type: RollingUpdate\n  template:\n    metadata:\n      labels:\n        app: ecsdemo-nodejs\n    spec:\n      containers:\n      - image: brentley/ecsdemo-nodejs:latest\n        imagePullPolicy: Always\n        name: ecsdemo-nodejs\n        ports:\n        - containerPort: 3000\n          protocol: TCP\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"ecsdemo-nodejs\" is using an invalid container image, \"brentley/ecsdemo-nodejs:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "1247",
    "manifest_path": "data/manifests/the_stack_sample/sample_0172.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: ecsdemo-nodejs\n  labels:\n    app: ecsdemo-nodejs\n  namespace: ecsdemo-nodejs\nspec:\n  replicas: 6\n  selector:\n    matchLabels:\n      app: ecsdemo-nodejs\n  strategy:\n    rollingUpdate:\n      maxSurge: 25%\n      maxUnavailable: 25%\n    type: RollingUpdate\n  template:\n    metadata:\n      labels:\n        app: ecsdemo-nodejs\n    spec:\n      containers:\n      - image: brentley/ecsdemo-nodejs:latest\n        imagePullPolicy: Always\n        name: ecsdemo-nodejs\n        ports:\n        - containerPort: 3000\n          protocol: TCP\n",
    "policy_id": "no-anti-affinity",
    "violation_text": "object has 6 replicas but does not specify inter pod anti-affinity"
  },
  {
    "id": "1248",
    "manifest_path": "data/manifests/the_stack_sample/sample_0172.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: ecsdemo-nodejs\n  labels:\n    app: ecsdemo-nodejs\n  namespace: ecsdemo-nodejs\nspec:\n  replicas: 6\n  selector:\n    matchLabels:\n      app: ecsdemo-nodejs\n  strategy:\n    rollingUpdate:\n      maxSurge: 25%\n      maxUnavailable: 25%\n    type: RollingUpdate\n  template:\n    metadata:\n      labels:\n        app: ecsdemo-nodejs\n    spec:\n      containers:\n      - image: brentley/ecsdemo-nodejs:latest\n        imagePullPolicy: Always\n        name: ecsdemo-nodejs\n        ports:\n        - containerPort: 3000\n          protocol: TCP\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"ecsdemo-nodejs\" does not have a read-only root file system"
  },
  {
    "id": "1249",
    "manifest_path": "data/manifests/the_stack_sample/sample_0172.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: ecsdemo-nodejs\n  labels:\n    app: ecsdemo-nodejs\n  namespace: ecsdemo-nodejs\nspec:\n  replicas: 6\n  selector:\n    matchLabels:\n      app: ecsdemo-nodejs\n  strategy:\n    rollingUpdate:\n      maxSurge: 25%\n      maxUnavailable: 25%\n    type: RollingUpdate\n  template:\n    metadata:\n      labels:\n        app: ecsdemo-nodejs\n    spec:\n      containers:\n      - image: brentley/ecsdemo-nodejs:latest\n        imagePullPolicy: Always\n        name: ecsdemo-nodejs\n        ports:\n        - containerPort: 3000\n          protocol: TCP\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"ecsdemo-nodejs\" is not set to runAsNonRoot"
  },
  {
    "id": "1250",
    "manifest_path": "data/manifests/the_stack_sample/sample_0172.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: ecsdemo-nodejs\n  labels:\n    app: ecsdemo-nodejs\n  namespace: ecsdemo-nodejs\nspec:\n  replicas: 6\n  selector:\n    matchLabels:\n      app: ecsdemo-nodejs\n  strategy:\n    rollingUpdate:\n      maxSurge: 25%\n      maxUnavailable: 25%\n    type: RollingUpdate\n  template:\n    metadata:\n      labels:\n        app: ecsdemo-nodejs\n    spec:\n      containers:\n      - image: brentley/ecsdemo-nodejs:latest\n        imagePullPolicy: Always\n        name: ecsdemo-nodejs\n        ports:\n        - containerPort: 3000\n          protocol: TCP\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"ecsdemo-nodejs\" has cpu request 0"
  },
  {
    "id": "1251",
    "manifest_path": "data/manifests/the_stack_sample/sample_0172.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: ecsdemo-nodejs\n  labels:\n    app: ecsdemo-nodejs\n  namespace: ecsdemo-nodejs\nspec:\n  replicas: 6\n  selector:\n    matchLabels:\n      app: ecsdemo-nodejs\n  strategy:\n    rollingUpdate:\n      maxSurge: 25%\n      maxUnavailable: 25%\n    type: RollingUpdate\n  template:\n    metadata:\n      labels:\n        app: ecsdemo-nodejs\n    spec:\n      containers:\n      - image: brentley/ecsdemo-nodejs:latest\n        imagePullPolicy: Always\n        name: ecsdemo-nodejs\n        ports:\n        - containerPort: 3000\n          protocol: TCP\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"ecsdemo-nodejs\" has memory limit 0"
  },
  {
    "id": "1252",
    "manifest_path": "data/manifests/the_stack_sample/sample_0173.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: apache-storm-nimbus\nspec:\n  replicas: 1\n  selector:\n    storm: nimbus\n  template:\n    metadata:\n      labels:\n        storm: nimbus\n        app: storm\n    spec:\n      containers:\n      - name: zookeeper\n        image: zcguan/storm-cluster:latest\n        env:\n        - name: CONFIGURE_ZOOKEEPER\n          value: 'true'\n        - name: STORM_CMD\n          value: nimbus\n        volumeMounts:\n        - name: storm-data\n          mountPath: /opt/apache-storm/storm-local\n      volumes:\n      - name: storm-data\n        emptyDir: {}\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"zookeeper\" is using an invalid container image, \"zcguan/storm-cluster:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "1253",
    "manifest_path": "data/manifests/the_stack_sample/sample_0173.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: apache-storm-nimbus\nspec:\n  replicas: 1\n  selector:\n    storm: nimbus\n  template:\n    metadata:\n      labels:\n        storm: nimbus\n        app: storm\n    spec:\n      containers:\n      - name: zookeeper\n        image: zcguan/storm-cluster:latest\n        env:\n        - name: CONFIGURE_ZOOKEEPER\n          value: 'true'\n        - name: STORM_CMD\n          value: nimbus\n        volumeMounts:\n        - name: storm-data\n          mountPath: /opt/apache-storm/storm-local\n      volumes:\n      - name: storm-data\n        emptyDir: {}\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"zookeeper\" does not have a read-only root file system"
  },
  {
    "id": "1254",
    "manifest_path": "data/manifests/the_stack_sample/sample_0173.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: apache-storm-nimbus\nspec:\n  replicas: 1\n  selector:\n    storm: nimbus\n  template:\n    metadata:\n      labels:\n        storm: nimbus\n        app: storm\n    spec:\n      containers:\n      - name: zookeeper\n        image: zcguan/storm-cluster:latest\n        env:\n        - name: CONFIGURE_ZOOKEEPER\n          value: 'true'\n        - name: STORM_CMD\n          value: nimbus\n        volumeMounts:\n        - name: storm-data\n          mountPath: /opt/apache-storm/storm-local\n      volumes:\n      - name: storm-data\n        emptyDir: {}\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"zookeeper\" is not set to runAsNonRoot"
  },
  {
    "id": "1255",
    "manifest_path": "data/manifests/the_stack_sample/sample_0173.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: apache-storm-nimbus\nspec:\n  replicas: 1\n  selector:\n    storm: nimbus\n  template:\n    metadata:\n      labels:\n        storm: nimbus\n        app: storm\n    spec:\n      containers:\n      - name: zookeeper\n        image: zcguan/storm-cluster:latest\n        env:\n        - name: CONFIGURE_ZOOKEEPER\n          value: 'true'\n        - name: STORM_CMD\n          value: nimbus\n        volumeMounts:\n        - name: storm-data\n          mountPath: /opt/apache-storm/storm-local\n      volumes:\n      - name: storm-data\n        emptyDir: {}\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"zookeeper\" has cpu request 0"
  },
  {
    "id": "1256",
    "manifest_path": "data/manifests/the_stack_sample/sample_0173.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: apache-storm-nimbus\nspec:\n  replicas: 1\n  selector:\n    storm: nimbus\n  template:\n    metadata:\n      labels:\n        storm: nimbus\n        app: storm\n    spec:\n      containers:\n      - name: zookeeper\n        image: zcguan/storm-cluster:latest\n        env:\n        - name: CONFIGURE_ZOOKEEPER\n          value: 'true'\n        - name: STORM_CMD\n          value: nimbus\n        volumeMounts:\n        - name: storm-data\n          mountPath: /opt/apache-storm/storm-local\n      volumes:\n      - name: storm-data\n        emptyDir: {}\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"zookeeper\" has memory limit 0"
  },
  {
    "id": "1259",
    "manifest_path": "data/manifests/the_stack_sample/sample_0176.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: image-build-cron-trigger\nspec:\n  schedule: 0 2 * * *\n  concurrencyPolicy: Forbid\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          initContainers:\n          - name: git\n            env:\n            - name: GIT_REPOSITORY\n              value: github.com/tektoncd/plumbing\n            - name: GIT_REVISION\n              value: main\n          containers:\n          - name: trigger\n            env:\n            - name: SINK_URL\n              value: el-image-builder.default.svc.cluster.local:8080\n            - name: TARGET_IMAGE\n              value: gcr.io/tekton-releases/dogfooding/buildx-gcloud\n            - name: CONTEXT_PATH\n              value: tekton/images/buildx-gcloud\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"git\" does not have a read-only root file system"
  },
  {
    "id": "1260",
    "manifest_path": "data/manifests/the_stack_sample/sample_0176.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: image-build-cron-trigger\nspec:\n  schedule: 0 2 * * *\n  concurrencyPolicy: Forbid\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          initContainers:\n          - name: git\n            env:\n            - name: GIT_REPOSITORY\n              value: github.com/tektoncd/plumbing\n            - name: GIT_REVISION\n              value: main\n          containers:\n          - name: trigger\n            env:\n            - name: SINK_URL\n              value: el-image-builder.default.svc.cluster.local:8080\n            - name: TARGET_IMAGE\n              value: gcr.io/tekton-releases/dogfooding/buildx-gcloud\n            - name: CONTEXT_PATH\n              value: tekton/images/buildx-gcloud\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"trigger\" does not have a read-only root file system"
  },
  {
    "id": "1261",
    "manifest_path": "data/manifests/the_stack_sample/sample_0176.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: image-build-cron-trigger\nspec:\n  schedule: 0 2 * * *\n  concurrencyPolicy: Forbid\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          initContainers:\n          - name: git\n            env:\n            - name: GIT_REPOSITORY\n              value: github.com/tektoncd/plumbing\n            - name: GIT_REVISION\n              value: main\n          containers:\n          - name: trigger\n            env:\n            - name: SINK_URL\n              value: el-image-builder.default.svc.cluster.local:8080\n            - name: TARGET_IMAGE\n              value: gcr.io/tekton-releases/dogfooding/buildx-gcloud\n            - name: CONTEXT_PATH\n              value: tekton/images/buildx-gcloud\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"git\" is not set to runAsNonRoot"
  },
  {
    "id": "1262",
    "manifest_path": "data/manifests/the_stack_sample/sample_0176.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: image-build-cron-trigger\nspec:\n  schedule: 0 2 * * *\n  concurrencyPolicy: Forbid\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          initContainers:\n          - name: git\n            env:\n            - name: GIT_REPOSITORY\n              value: github.com/tektoncd/plumbing\n            - name: GIT_REVISION\n              value: main\n          containers:\n          - name: trigger\n            env:\n            - name: SINK_URL\n              value: el-image-builder.default.svc.cluster.local:8080\n            - name: TARGET_IMAGE\n              value: gcr.io/tekton-releases/dogfooding/buildx-gcloud\n            - name: CONTEXT_PATH\n              value: tekton/images/buildx-gcloud\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"trigger\" is not set to runAsNonRoot"
  },
  {
    "id": "1263",
    "manifest_path": "data/manifests/the_stack_sample/sample_0176.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: image-build-cron-trigger\nspec:\n  schedule: 0 2 * * *\n  concurrencyPolicy: Forbid\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          initContainers:\n          - name: git\n            env:\n            - name: GIT_REPOSITORY\n              value: github.com/tektoncd/plumbing\n            - name: GIT_REVISION\n              value: main\n          containers:\n          - name: trigger\n            env:\n            - name: SINK_URL\n              value: el-image-builder.default.svc.cluster.local:8080\n            - name: TARGET_IMAGE\n              value: gcr.io/tekton-releases/dogfooding/buildx-gcloud\n            - name: CONTEXT_PATH\n              value: tekton/images/buildx-gcloud\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"git\" has cpu request 0"
  },
  {
    "id": "1264",
    "manifest_path": "data/manifests/the_stack_sample/sample_0176.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: image-build-cron-trigger\nspec:\n  schedule: 0 2 * * *\n  concurrencyPolicy: Forbid\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          initContainers:\n          - name: git\n            env:\n            - name: GIT_REPOSITORY\n              value: github.com/tektoncd/plumbing\n            - name: GIT_REVISION\n              value: main\n          containers:\n          - name: trigger\n            env:\n            - name: SINK_URL\n              value: el-image-builder.default.svc.cluster.local:8080\n            - name: TARGET_IMAGE\n              value: gcr.io/tekton-releases/dogfooding/buildx-gcloud\n            - name: CONTEXT_PATH\n              value: tekton/images/buildx-gcloud\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"trigger\" has cpu request 0"
  },
  {
    "id": "1265",
    "manifest_path": "data/manifests/the_stack_sample/sample_0176.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: image-build-cron-trigger\nspec:\n  schedule: 0 2 * * *\n  concurrencyPolicy: Forbid\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          initContainers:\n          - name: git\n            env:\n            - name: GIT_REPOSITORY\n              value: github.com/tektoncd/plumbing\n            - name: GIT_REVISION\n              value: main\n          containers:\n          - name: trigger\n            env:\n            - name: SINK_URL\n              value: el-image-builder.default.svc.cluster.local:8080\n            - name: TARGET_IMAGE\n              value: gcr.io/tekton-releases/dogfooding/buildx-gcloud\n            - name: CONTEXT_PATH\n              value: tekton/images/buildx-gcloud\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"git\" has memory limit 0"
  },
  {
    "id": "1266",
    "manifest_path": "data/manifests/the_stack_sample/sample_0176.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: image-build-cron-trigger\nspec:\n  schedule: 0 2 * * *\n  concurrencyPolicy: Forbid\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          initContainers:\n          - name: git\n            env:\n            - name: GIT_REPOSITORY\n              value: github.com/tektoncd/plumbing\n            - name: GIT_REVISION\n              value: main\n          containers:\n          - name: trigger\n            env:\n            - name: SINK_URL\n              value: el-image-builder.default.svc.cluster.local:8080\n            - name: TARGET_IMAGE\n              value: gcr.io/tekton-releases/dogfooding/buildx-gcloud\n            - name: CONTEXT_PATH\n              value: tekton/images/buildx-gcloud\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"trigger\" has memory limit 0"
  },
  {
    "id": "1267",
    "manifest_path": "data/manifests/the_stack_sample/sample_0178.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: nodehelloworld.example.com\n  labels:\n    app: helloworld\nspec:\n  containers:\n  - name: k8s-demo\n    image: diyblockchain/k8s-demo\n    ports:\n    - name: nodejs-port\n      containerPort: 3000\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"k8s-demo\" is using an invalid container image, \"diyblockchain/k8s-demo\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "1268",
    "manifest_path": "data/manifests/the_stack_sample/sample_0178.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: nodehelloworld.example.com\n  labels:\n    app: helloworld\nspec:\n  containers:\n  - name: k8s-demo\n    image: diyblockchain/k8s-demo\n    ports:\n    - name: nodejs-port\n      containerPort: 3000\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"k8s-demo\" does not have a read-only root file system"
  },
  {
    "id": "1269",
    "manifest_path": "data/manifests/the_stack_sample/sample_0178.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: nodehelloworld.example.com\n  labels:\n    app: helloworld\nspec:\n  containers:\n  - name: k8s-demo\n    image: diyblockchain/k8s-demo\n    ports:\n    - name: nodejs-port\n      containerPort: 3000\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"k8s-demo\" is not set to runAsNonRoot"
  },
  {
    "id": "1270",
    "manifest_path": "data/manifests/the_stack_sample/sample_0178.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: nodehelloworld.example.com\n  labels:\n    app: helloworld\nspec:\n  containers:\n  - name: k8s-demo\n    image: diyblockchain/k8s-demo\n    ports:\n    - name: nodejs-port\n      containerPort: 3000\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"k8s-demo\" has cpu request 0"
  },
  {
    "id": "1271",
    "manifest_path": "data/manifests/the_stack_sample/sample_0178.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: nodehelloworld.example.com\n  labels:\n    app: helloworld\nspec:\n  containers:\n  - name: k8s-demo\n    image: diyblockchain/k8s-demo\n    ports:\n    - name: nodejs-port\n      containerPort: 3000\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"k8s-demo\" has memory limit 0"
  },
  {
    "id": "1272",
    "manifest_path": "data/manifests/the_stack_sample/sample_0181.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-647\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"nginx\" is using an invalid container image, \"nginx\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "1273",
    "manifest_path": "data/manifests/the_stack_sample/sample_0181.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-647\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"nginx\" does not have a read-only root file system"
  },
  {
    "id": "1274",
    "manifest_path": "data/manifests/the_stack_sample/sample_0181.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-647\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"nginx\" is not set to runAsNonRoot"
  },
  {
    "id": "1275",
    "manifest_path": "data/manifests/the_stack_sample/sample_0181.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-647\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"nginx\" has cpu request 0"
  },
  {
    "id": "1276",
    "manifest_path": "data/manifests/the_stack_sample/sample_0181.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-647\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"nginx\" has memory limit 0"
  },
  {
    "id": "1277",
    "manifest_path": "data/manifests/the_stack_sample/sample_0183.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: maskrcnn-image-seg\nspec:\n  template:\n    spec:\n      containers:\n      - name: image-seg\n        image: centaurusinfra/test1_maskrcnn\n        command:\n        - python\n        args:\n        - -m\n        - torch.distributed.launch\n        - --nproc_per_node\n        - '2'\n        - tools/train_net.py\n        - --config-file\n        - configs/e2e_mask_rcnn_R_50_FPN_1x.yaml\n        - --max_steps\n        - '100'\n        - OUTPUT_DIR\n        - /results\n        resources:\n          limits:\n            nvidia.com/gpu: 2\n        volumeMounts:\n        - mountPath: /datasets/data\n          name: remote-data\n        - mountPath: /results\n          name: remote-results\n        - mountPath: /dev/shm\n          name: dshm\n      volumes:\n      - name: remote-data\n        hostPath:\n          path: /nfs_1/alnair/pytorch/segmentation/maskrcnn/coco_dataset/\n          type: Directory\n      - name: remote-results\n        hostPath:\n          path: /nfs_1/alnair/results\n          type: Directory\n      - name: dshm\n        emptyDir:\n          medium: Memory\n      restartPolicy: Never\n  backoffLimit: 0\n",
    "policy_id": "job-ttl-seconds-after-finished",
    "violation_text": "Standalone Job does not specify ttlSecondsAfterFinished"
  },
  {
    "id": "1278",
    "manifest_path": "data/manifests/the_stack_sample/sample_0183.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: maskrcnn-image-seg\nspec:\n  template:\n    spec:\n      containers:\n      - name: image-seg\n        image: centaurusinfra/test1_maskrcnn\n        command:\n        - python\n        args:\n        - -m\n        - torch.distributed.launch\n        - --nproc_per_node\n        - '2'\n        - tools/train_net.py\n        - --config-file\n        - configs/e2e_mask_rcnn_R_50_FPN_1x.yaml\n        - --max_steps\n        - '100'\n        - OUTPUT_DIR\n        - /results\n        resources:\n          limits:\n            nvidia.com/gpu: 2\n        volumeMounts:\n        - mountPath: /datasets/data\n          name: remote-data\n        - mountPath: /results\n          name: remote-results\n        - mountPath: /dev/shm\n          name: dshm\n      volumes:\n      - name: remote-data\n        hostPath:\n          path: /nfs_1/alnair/pytorch/segmentation/maskrcnn/coco_dataset/\n          type: Directory\n      - name: remote-results\n        hostPath:\n          path: /nfs_1/alnair/results\n          type: Directory\n      - name: dshm\n        emptyDir:\n          medium: Memory\n      restartPolicy: Never\n  backoffLimit: 0\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"image-seg\" is using an invalid container image, \"centaurusinfra/test1_maskrcnn\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "1279",
    "manifest_path": "data/manifests/the_stack_sample/sample_0183.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: maskrcnn-image-seg\nspec:\n  template:\n    spec:\n      containers:\n      - name: image-seg\n        image: centaurusinfra/test1_maskrcnn\n        command:\n        - python\n        args:\n        - -m\n        - torch.distributed.launch\n        - --nproc_per_node\n        - '2'\n        - tools/train_net.py\n        - --config-file\n        - configs/e2e_mask_rcnn_R_50_FPN_1x.yaml\n        - --max_steps\n        - '100'\n        - OUTPUT_DIR\n        - /results\n        resources:\n          limits:\n            nvidia.com/gpu: 2\n        volumeMounts:\n        - mountPath: /datasets/data\n          name: remote-data\n        - mountPath: /results\n          name: remote-results\n        - mountPath: /dev/shm\n          name: dshm\n      volumes:\n      - name: remote-data\n        hostPath:\n          path: /nfs_1/alnair/pytorch/segmentation/maskrcnn/coco_dataset/\n          type: Directory\n      - name: remote-results\n        hostPath:\n          path: /nfs_1/alnair/results\n          type: Directory\n      - name: dshm\n        emptyDir:\n          medium: Memory\n      restartPolicy: Never\n  backoffLimit: 0\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"image-seg\" does not have a read-only root file system"
  },
  {
    "id": "1280",
    "manifest_path": "data/manifests/the_stack_sample/sample_0183.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: maskrcnn-image-seg\nspec:\n  template:\n    spec:\n      containers:\n      - name: image-seg\n        image: centaurusinfra/test1_maskrcnn\n        command:\n        - python\n        args:\n        - -m\n        - torch.distributed.launch\n        - --nproc_per_node\n        - '2'\n        - tools/train_net.py\n        - --config-file\n        - configs/e2e_mask_rcnn_R_50_FPN_1x.yaml\n        - --max_steps\n        - '100'\n        - OUTPUT_DIR\n        - /results\n        resources:\n          limits:\n            nvidia.com/gpu: 2\n        volumeMounts:\n        - mountPath: /datasets/data\n          name: remote-data\n        - mountPath: /results\n          name: remote-results\n        - mountPath: /dev/shm\n          name: dshm\n      volumes:\n      - name: remote-data\n        hostPath:\n          path: /nfs_1/alnair/pytorch/segmentation/maskrcnn/coco_dataset/\n          type: Directory\n      - name: remote-results\n        hostPath:\n          path: /nfs_1/alnair/results\n          type: Directory\n      - name: dshm\n        emptyDir:\n          medium: Memory\n      restartPolicy: Never\n  backoffLimit: 0\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"image-seg\" is not set to runAsNonRoot"
  },
  {
    "id": "1281",
    "manifest_path": "data/manifests/the_stack_sample/sample_0183.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: maskrcnn-image-seg\nspec:\n  template:\n    spec:\n      containers:\n      - name: image-seg\n        image: centaurusinfra/test1_maskrcnn\n        command:\n        - python\n        args:\n        - -m\n        - torch.distributed.launch\n        - --nproc_per_node\n        - '2'\n        - tools/train_net.py\n        - --config-file\n        - configs/e2e_mask_rcnn_R_50_FPN_1x.yaml\n        - --max_steps\n        - '100'\n        - OUTPUT_DIR\n        - /results\n        resources:\n          limits:\n            nvidia.com/gpu: 2\n        volumeMounts:\n        - mountPath: /datasets/data\n          name: remote-data\n        - mountPath: /results\n          name: remote-results\n        - mountPath: /dev/shm\n          name: dshm\n      volumes:\n      - name: remote-data\n        hostPath:\n          path: /nfs_1/alnair/pytorch/segmentation/maskrcnn/coco_dataset/\n          type: Directory\n      - name: remote-results\n        hostPath:\n          path: /nfs_1/alnair/results\n          type: Directory\n      - name: dshm\n        emptyDir:\n          medium: Memory\n      restartPolicy: Never\n  backoffLimit: 0\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"image-seg\" has cpu request 0"
  },
  {
    "id": "1282",
    "manifest_path": "data/manifests/the_stack_sample/sample_0183.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: maskrcnn-image-seg\nspec:\n  template:\n    spec:\n      containers:\n      - name: image-seg\n        image: centaurusinfra/test1_maskrcnn\n        command:\n        - python\n        args:\n        - -m\n        - torch.distributed.launch\n        - --nproc_per_node\n        - '2'\n        - tools/train_net.py\n        - --config-file\n        - configs/e2e_mask_rcnn_R_50_FPN_1x.yaml\n        - --max_steps\n        - '100'\n        - OUTPUT_DIR\n        - /results\n        resources:\n          limits:\n            nvidia.com/gpu: 2\n        volumeMounts:\n        - mountPath: /datasets/data\n          name: remote-data\n        - mountPath: /results\n          name: remote-results\n        - mountPath: /dev/shm\n          name: dshm\n      volumes:\n      - name: remote-data\n        hostPath:\n          path: /nfs_1/alnair/pytorch/segmentation/maskrcnn/coco_dataset/\n          type: Directory\n      - name: remote-results\n        hostPath:\n          path: /nfs_1/alnair/results\n          type: Directory\n      - name: dshm\n        emptyDir:\n          medium: Memory\n      restartPolicy: Never\n  backoffLimit: 0\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"image-seg\" has memory limit 0"
  },
  {
    "id": "1283",
    "manifest_path": "data/manifests/the_stack_sample/sample_0184.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-6685\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"nginx\" is using an invalid container image, \"nginx\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "1284",
    "manifest_path": "data/manifests/the_stack_sample/sample_0184.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-6685\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"nginx\" does not have a read-only root file system"
  },
  {
    "id": "1285",
    "manifest_path": "data/manifests/the_stack_sample/sample_0184.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-6685\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"nginx\" is not set to runAsNonRoot"
  },
  {
    "id": "1286",
    "manifest_path": "data/manifests/the_stack_sample/sample_0184.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-6685\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"nginx\" has cpu request 0"
  },
  {
    "id": "1287",
    "manifest_path": "data/manifests/the_stack_sample/sample_0184.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-6685\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"nginx\" has memory limit 0"
  },
  {
    "id": "1288",
    "manifest_path": "data/manifests/the_stack_sample/sample_0189.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: hostnamespaces0\nspec:\n  containers:\n  - image: k8s.gcr.io/pause\n    name: container1\n    securityContext:\n      allowPrivilegeEscalation: false\n      capabilities:\n        drop:\n        - ALL\n  hostIPC: true\n  initContainers:\n  - image: k8s.gcr.io/pause\n    name: initcontainer1\n    securityContext:\n      allowPrivilegeEscalation: false\n      capabilities:\n        drop:\n        - ALL\n  securityContext:\n    runAsNonRoot: true\n    seccompProfile:\n      type: RuntimeDefault\n",
    "policy_id": "host-ipc",
    "violation_text": "resource shares host's IPC namespace (via hostIPC=true)."
  },
  {
    "id": "1289",
    "manifest_path": "data/manifests/the_stack_sample/sample_0189.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: hostnamespaces0\nspec:\n  containers:\n  - image: k8s.gcr.io/pause\n    name: container1\n    securityContext:\n      allowPrivilegeEscalation: false\n      capabilities:\n        drop:\n        - ALL\n  hostIPC: true\n  initContainers:\n  - image: k8s.gcr.io/pause\n    name: initcontainer1\n    securityContext:\n      allowPrivilegeEscalation: false\n      capabilities:\n        drop:\n        - ALL\n  securityContext:\n    runAsNonRoot: true\n    seccompProfile:\n      type: RuntimeDefault\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"container1\" is using an invalid container image, \"k8s.gcr.io/pause\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "1290",
    "manifest_path": "data/manifests/the_stack_sample/sample_0189.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: hostnamespaces0\nspec:\n  containers:\n  - image: k8s.gcr.io/pause\n    name: container1\n    securityContext:\n      allowPrivilegeEscalation: false\n      capabilities:\n        drop:\n        - ALL\n  hostIPC: true\n  initContainers:\n  - image: k8s.gcr.io/pause\n    name: initcontainer1\n    securityContext:\n      allowPrivilegeEscalation: false\n      capabilities:\n        drop:\n        - ALL\n  securityContext:\n    runAsNonRoot: true\n    seccompProfile:\n      type: RuntimeDefault\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"initcontainer1\" is using an invalid container image, \"k8s.gcr.io/pause\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "1291",
    "manifest_path": "data/manifests/the_stack_sample/sample_0189.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: hostnamespaces0\nspec:\n  containers:\n  - image: k8s.gcr.io/pause\n    name: container1\n    securityContext:\n      allowPrivilegeEscalation: false\n      capabilities:\n        drop:\n        - ALL\n  hostIPC: true\n  initContainers:\n  - image: k8s.gcr.io/pause\n    name: initcontainer1\n    securityContext:\n      allowPrivilegeEscalation: false\n      capabilities:\n        drop:\n        - ALL\n  securityContext:\n    runAsNonRoot: true\n    seccompProfile:\n      type: RuntimeDefault\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"container1\" does not have a read-only root file system"
  },
  {
    "id": "1292",
    "manifest_path": "data/manifests/the_stack_sample/sample_0189.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: hostnamespaces0\nspec:\n  containers:\n  - image: k8s.gcr.io/pause\n    name: container1\n    securityContext:\n      allowPrivilegeEscalation: false\n      capabilities:\n        drop:\n        - ALL\n  hostIPC: true\n  initContainers:\n  - image: k8s.gcr.io/pause\n    name: initcontainer1\n    securityContext:\n      allowPrivilegeEscalation: false\n      capabilities:\n        drop:\n        - ALL\n  securityContext:\n    runAsNonRoot: true\n    seccompProfile:\n      type: RuntimeDefault\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"initcontainer1\" does not have a read-only root file system"
  },
  {
    "id": "1293",
    "manifest_path": "data/manifests/the_stack_sample/sample_0189.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: hostnamespaces0\nspec:\n  containers:\n  - image: k8s.gcr.io/pause\n    name: container1\n    securityContext:\n      allowPrivilegeEscalation: false\n      capabilities:\n        drop:\n        - ALL\n  hostIPC: true\n  initContainers:\n  - image: k8s.gcr.io/pause\n    name: initcontainer1\n    securityContext:\n      allowPrivilegeEscalation: false\n      capabilities:\n        drop:\n        - ALL\n  securityContext:\n    runAsNonRoot: true\n    seccompProfile:\n      type: RuntimeDefault\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"container1\" has cpu request 0"
  },
  {
    "id": "1294",
    "manifest_path": "data/manifests/the_stack_sample/sample_0189.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: hostnamespaces0\nspec:\n  containers:\n  - image: k8s.gcr.io/pause\n    name: container1\n    securityContext:\n      allowPrivilegeEscalation: false\n      capabilities:\n        drop:\n        - ALL\n  hostIPC: true\n  initContainers:\n  - image: k8s.gcr.io/pause\n    name: initcontainer1\n    securityContext:\n      allowPrivilegeEscalation: false\n      capabilities:\n        drop:\n        - ALL\n  securityContext:\n    runAsNonRoot: true\n    seccompProfile:\n      type: RuntimeDefault\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"initcontainer1\" has cpu request 0"
  },
  {
    "id": "1295",
    "manifest_path": "data/manifests/the_stack_sample/sample_0189.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: hostnamespaces0\nspec:\n  containers:\n  - image: k8s.gcr.io/pause\n    name: container1\n    securityContext:\n      allowPrivilegeEscalation: false\n      capabilities:\n        drop:\n        - ALL\n  hostIPC: true\n  initContainers:\n  - image: k8s.gcr.io/pause\n    name: initcontainer1\n    securityContext:\n      allowPrivilegeEscalation: false\n      capabilities:\n        drop:\n        - ALL\n  securityContext:\n    runAsNonRoot: true\n    seccompProfile:\n      type: RuntimeDefault\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"container1\" has memory limit 0"
  },
  {
    "id": "1296",
    "manifest_path": "data/manifests/the_stack_sample/sample_0189.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: hostnamespaces0\nspec:\n  containers:\n  - image: k8s.gcr.io/pause\n    name: container1\n    securityContext:\n      allowPrivilegeEscalation: false\n      capabilities:\n        drop:\n        - ALL\n  hostIPC: true\n  initContainers:\n  - image: k8s.gcr.io/pause\n    name: initcontainer1\n    securityContext:\n      allowPrivilegeEscalation: false\n      capabilities:\n        drop:\n        - ALL\n  securityContext:\n    runAsNonRoot: true\n    seccompProfile:\n      type: RuntimeDefault\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"initcontainer1\" has memory limit 0"
  },
  {
    "id": "1297",
    "manifest_path": "data/manifests/the_stack_sample/sample_0190.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Service\nmetadata:\n  name: grafana\nspec:\n  ports:\n  - port: 3000\n    protocol: TCP\n    targetPort: 3000\n  type: NodePort\n",
    "policy_id": "dangling-service",
    "violation_text": "service has no selector specified"
  },
  {
    "id": "1298",
    "manifest_path": "data/manifests/the_stack_sample/sample_0191.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Service\nmetadata:\n  annotations:\n    xposer.stakater.com/annotations: 'kubernetes.io/ingress.class: external-ingress\n\n      ingress.kubernetes.io/force-ssl-redirect: true\n\n      exposeIngressUrl: globally'\n  labels:\n    app: hello-kubernetes\n    expose: 'true'\n  name: hello-kubernetes\nspec:\n  ports:\n  - name: http\n    port: 80\n    protocol: TCP\n    targetPort: 8080\n  selector:\n    app: hello-kubernetes\n  type: ClusterIP\n",
    "policy_id": "dangling-service",
    "violation_text": "no pods found matching service labels (map[app:hello-kubernetes])"
  },
  {
    "id": "1299",
    "manifest_path": "data/manifests/the_stack_sample/sample_0192.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Service\nmetadata:\n  name: redis\nspec:\n  selector:\n    app: redis\n  ports:\n  - protocol: TCP\n    port: 6379\n    targetPort: 6379\n",
    "policy_id": "dangling-service",
    "violation_text": "no pods found matching service labels (map[app:redis])"
  },
  {
    "id": "1300",
    "manifest_path": "data/manifests/the_stack_sample/sample_0193.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Service\nmetadata:\n  name: azconf-app\n  namespace: azconf\nspec:\n  type: LoadBalancer\n  selector:\n    app: azconf-app\n  ports:\n  - port: 8080\n",
    "policy_id": "dangling-service",
    "violation_text": "no pods found matching service labels (map[app:azconf-app])"
  },
  {
    "id": "1301",
    "manifest_path": "data/manifests/the_stack_sample/sample_0195.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: sabnzbd\n  namespace: usenet\n  annotations:\n    reloader.stakater.com/auto: 'true'\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: sabnzbd\n  strategy:\n    type: Recreate\n  template:\n    metadata:\n      labels:\n        app: sabnzbd\n    spec:\n      containers:\n      - name: sabnzbd\n        image: lscr.io/linuxserver/sabnzbd:3.4.2-ls51\n        env:\n        - name: PGID\n          value: '2000'\n        - name: PUID\n          value: '2000'\n        - name: TZ\n          value: Europe/Zurich\n        - name: DOCKER_MODS\n          value: containeroo/docker-mods:sabnzbd-mkvtoolnix|containeroo/docker-mods:sabnzbd-nzbnotify\n        ports:\n        - containerPort: 8080\n        volumeMounts:\n        - mountPath: /config\n          name: data\n        - mountPath: /incomplete-downloads\n          name: incomplete-downloads\n        - mountPath: /downloads\n          name: downloads\n        - mountPath: /app/sabnzbd/scripts/merge_subtitles.sh\n          name: merge-subtitles\n          subPath: merge_subtitles.sh\n        - mountPath: /tmp/startup_probe.sh\n          name: sabnzbd-startup\n          subPath: startup_probe.sh\n        startupProbe:\n          exec:\n            command:\n            - bash\n            - -c\n            - /tmp/startup_probe.sh\n          initialDelaySeconds: 30\n          failureThreshold: 30\n          timeoutSeconds: 10\n          periodSeconds: 5\n        livenessProbe:\n          tcpSocket:\n            port: 8080\n          failureThreshold: 2\n          timeoutSeconds: 5\n          periodSeconds: 30\n        resources: {}\n      restartPolicy: Always\n      automountServiceAccountToken: false\n      volumes:\n      - name: data\n        persistentVolumeClaim:\n          claimName: sabnzbd-data\n      - name: merge-subtitles\n        configMap:\n          name: merge-subtitles\n          items:\n          - key: merge_subtitles.sh\n            path: merge_subtitles.sh\n          defaultMode: 511\n      - name: sabnzbd-startup\n        configMap:\n          name: sabnzbd-startup\n          items:\n          - key: startup_probe.sh\n            path: startup_probe.sh\n          defaultMode: 511\n      - name: incomplete-downloads\n        hostPath:\n          path: /mnt/disk06/downloads/incomplete\n          type: Directory\n      - name: downloads\n        hostPath:\n          path: /mnt/disk06/downloads/complete\n          type: Directory\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"sabnzbd\" does not have a read-only root file system"
  },
  {
    "id": "1302",
    "manifest_path": "data/manifests/the_stack_sample/sample_0195.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: sabnzbd\n  namespace: usenet\n  annotations:\n    reloader.stakater.com/auto: 'true'\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: sabnzbd\n  strategy:\n    type: Recreate\n  template:\n    metadata:\n      labels:\n        app: sabnzbd\n    spec:\n      containers:\n      - name: sabnzbd\n        image: lscr.io/linuxserver/sabnzbd:3.4.2-ls51\n        env:\n        - name: PGID\n          value: '2000'\n        - name: PUID\n          value: '2000'\n        - name: TZ\n          value: Europe/Zurich\n        - name: DOCKER_MODS\n          value: containeroo/docker-mods:sabnzbd-mkvtoolnix|containeroo/docker-mods:sabnzbd-nzbnotify\n        ports:\n        - containerPort: 8080\n        volumeMounts:\n        - mountPath: /config\n          name: data\n        - mountPath: /incomplete-downloads\n          name: incomplete-downloads\n        - mountPath: /downloads\n          name: downloads\n        - mountPath: /app/sabnzbd/scripts/merge_subtitles.sh\n          name: merge-subtitles\n          subPath: merge_subtitles.sh\n        - mountPath: /tmp/startup_probe.sh\n          name: sabnzbd-startup\n          subPath: startup_probe.sh\n        startupProbe:\n          exec:\n            command:\n            - bash\n            - -c\n            - /tmp/startup_probe.sh\n          initialDelaySeconds: 30\n          failureThreshold: 30\n          timeoutSeconds: 10\n          periodSeconds: 5\n        livenessProbe:\n          tcpSocket:\n            port: 8080\n          failureThreshold: 2\n          timeoutSeconds: 5\n          periodSeconds: 30\n        resources: {}\n      restartPolicy: Always\n      automountServiceAccountToken: false\n      volumes:\n      - name: data\n        persistentVolumeClaim:\n          claimName: sabnzbd-data\n      - name: merge-subtitles\n        configMap:\n          name: merge-subtitles\n          items:\n          - key: merge_subtitles.sh\n            path: merge_subtitles.sh\n          defaultMode: 511\n      - name: sabnzbd-startup\n        configMap:\n          name: sabnzbd-startup\n          items:\n          - key: startup_probe.sh\n            path: startup_probe.sh\n          defaultMode: 511\n      - name: incomplete-downloads\n        hostPath:\n          path: /mnt/disk06/downloads/incomplete\n          type: Directory\n      - name: downloads\n        hostPath:\n          path: /mnt/disk06/downloads/complete\n          type: Directory\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"sabnzbd\" is not set to runAsNonRoot"
  },
  {
    "id": "1303",
    "manifest_path": "data/manifests/the_stack_sample/sample_0195.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: sabnzbd\n  namespace: usenet\n  annotations:\n    reloader.stakater.com/auto: 'true'\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: sabnzbd\n  strategy:\n    type: Recreate\n  template:\n    metadata:\n      labels:\n        app: sabnzbd\n    spec:\n      containers:\n      - name: sabnzbd\n        image: lscr.io/linuxserver/sabnzbd:3.4.2-ls51\n        env:\n        - name: PGID\n          value: '2000'\n        - name: PUID\n          value: '2000'\n        - name: TZ\n          value: Europe/Zurich\n        - name: DOCKER_MODS\n          value: containeroo/docker-mods:sabnzbd-mkvtoolnix|containeroo/docker-mods:sabnzbd-nzbnotify\n        ports:\n        - containerPort: 8080\n        volumeMounts:\n        - mountPath: /config\n          name: data\n        - mountPath: /incomplete-downloads\n          name: incomplete-downloads\n        - mountPath: /downloads\n          name: downloads\n        - mountPath: /app/sabnzbd/scripts/merge_subtitles.sh\n          name: merge-subtitles\n          subPath: merge_subtitles.sh\n        - mountPath: /tmp/startup_probe.sh\n          name: sabnzbd-startup\n          subPath: startup_probe.sh\n        startupProbe:\n          exec:\n            command:\n            - bash\n            - -c\n            - /tmp/startup_probe.sh\n          initialDelaySeconds: 30\n          failureThreshold: 30\n          timeoutSeconds: 10\n          periodSeconds: 5\n        livenessProbe:\n          tcpSocket:\n            port: 8080\n          failureThreshold: 2\n          timeoutSeconds: 5\n          periodSeconds: 30\n        resources: {}\n      restartPolicy: Always\n      automountServiceAccountToken: false\n      volumes:\n      - name: data\n        persistentVolumeClaim:\n          claimName: sabnzbd-data\n      - name: merge-subtitles\n        configMap:\n          name: merge-subtitles\n          items:\n          - key: merge_subtitles.sh\n            path: merge_subtitles.sh\n          defaultMode: 511\n      - name: sabnzbd-startup\n        configMap:\n          name: sabnzbd-startup\n          items:\n          - key: startup_probe.sh\n            path: startup_probe.sh\n          defaultMode: 511\n      - name: incomplete-downloads\n        hostPath:\n          path: /mnt/disk06/downloads/incomplete\n          type: Directory\n      - name: downloads\n        hostPath:\n          path: /mnt/disk06/downloads/complete\n          type: Directory\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"sabnzbd\" has cpu request 0"
  },
  {
    "id": "1304",
    "manifest_path": "data/manifests/the_stack_sample/sample_0195.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: sabnzbd\n  namespace: usenet\n  annotations:\n    reloader.stakater.com/auto: 'true'\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: sabnzbd\n  strategy:\n    type: Recreate\n  template:\n    metadata:\n      labels:\n        app: sabnzbd\n    spec:\n      containers:\n      - name: sabnzbd\n        image: lscr.io/linuxserver/sabnzbd:3.4.2-ls51\n        env:\n        - name: PGID\n          value: '2000'\n        - name: PUID\n          value: '2000'\n        - name: TZ\n          value: Europe/Zurich\n        - name: DOCKER_MODS\n          value: containeroo/docker-mods:sabnzbd-mkvtoolnix|containeroo/docker-mods:sabnzbd-nzbnotify\n        ports:\n        - containerPort: 8080\n        volumeMounts:\n        - mountPath: /config\n          name: data\n        - mountPath: /incomplete-downloads\n          name: incomplete-downloads\n        - mountPath: /downloads\n          name: downloads\n        - mountPath: /app/sabnzbd/scripts/merge_subtitles.sh\n          name: merge-subtitles\n          subPath: merge_subtitles.sh\n        - mountPath: /tmp/startup_probe.sh\n          name: sabnzbd-startup\n          subPath: startup_probe.sh\n        startupProbe:\n          exec:\n            command:\n            - bash\n            - -c\n            - /tmp/startup_probe.sh\n          initialDelaySeconds: 30\n          failureThreshold: 30\n          timeoutSeconds: 10\n          periodSeconds: 5\n        livenessProbe:\n          tcpSocket:\n            port: 8080\n          failureThreshold: 2\n          timeoutSeconds: 5\n          periodSeconds: 30\n        resources: {}\n      restartPolicy: Always\n      automountServiceAccountToken: false\n      volumes:\n      - name: data\n        persistentVolumeClaim:\n          claimName: sabnzbd-data\n      - name: merge-subtitles\n        configMap:\n          name: merge-subtitles\n          items:\n          - key: merge_subtitles.sh\n            path: merge_subtitles.sh\n          defaultMode: 511\n      - name: sabnzbd-startup\n        configMap:\n          name: sabnzbd-startup\n          items:\n          - key: startup_probe.sh\n            path: startup_probe.sh\n          defaultMode: 511\n      - name: incomplete-downloads\n        hostPath:\n          path: /mnt/disk06/downloads/incomplete\n          type: Directory\n      - name: downloads\n        hostPath:\n          path: /mnt/disk06/downloads/complete\n          type: Directory\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"sabnzbd\" has memory limit 0"
  },
  {
    "id": "1305",
    "manifest_path": "data/manifests/the_stack_sample/sample_0196.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nextepc-mme-deployment\nspec:\n  selector:\n    matchLabels:\n      app: nextepc-mme\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: nextepc-mme\n    spec:\n      containers:\n      - name: myapp-container\n        image: cewuandy/nextepc-base\n        imagePullPolicy: Always\n        command:\n        - /bin/sh\n        args:\n        - -c\n        - /root/nextepc/nextepc-mmed\n        volumeMounts:\n        - name: nextepc-conf\n          mountPath: /root/nextepc/install/etc/nextepc/\n      initContainers:\n      - name: init-network-client\n        image: sdnvortex/network-controller:v0.4.9\n        command:\n        - /go/bin/client\n        args:\n        - -s=unix:///tmp/vortex.sock\n        - -b=br0\n        - -n=eth1\n        - -i=192.188.2.2/24\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_UUID\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.uid\n        volumeMounts:\n        - mountPath: /tmp/\n          name: grpc-sock\n      volumes:\n      - name: grpc-sock\n        hostPath:\n          path: /tmp/vortex/\n      - name: nextepc-conf\n        configMap:\n          name: nextepc-config\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"myapp-container\" is using an invalid container image, \"cewuandy/nextepc-base\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "1306",
    "manifest_path": "data/manifests/the_stack_sample/sample_0196.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nextepc-mme-deployment\nspec:\n  selector:\n    matchLabels:\n      app: nextepc-mme\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: nextepc-mme\n    spec:\n      containers:\n      - name: myapp-container\n        image: cewuandy/nextepc-base\n        imagePullPolicy: Always\n        command:\n        - /bin/sh\n        args:\n        - -c\n        - /root/nextepc/nextepc-mmed\n        volumeMounts:\n        - name: nextepc-conf\n          mountPath: /root/nextepc/install/etc/nextepc/\n      initContainers:\n      - name: init-network-client\n        image: sdnvortex/network-controller:v0.4.9\n        command:\n        - /go/bin/client\n        args:\n        - -s=unix:///tmp/vortex.sock\n        - -b=br0\n        - -n=eth1\n        - -i=192.188.2.2/24\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_UUID\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.uid\n        volumeMounts:\n        - mountPath: /tmp/\n          name: grpc-sock\n      volumes:\n      - name: grpc-sock\n        hostPath:\n          path: /tmp/vortex/\n      - name: nextepc-conf\n        configMap:\n          name: nextepc-config\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"init-network-client\" does not have a read-only root file system"
  },
  {
    "id": "1307",
    "manifest_path": "data/manifests/the_stack_sample/sample_0196.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nextepc-mme-deployment\nspec:\n  selector:\n    matchLabels:\n      app: nextepc-mme\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: nextepc-mme\n    spec:\n      containers:\n      - name: myapp-container\n        image: cewuandy/nextepc-base\n        imagePullPolicy: Always\n        command:\n        - /bin/sh\n        args:\n        - -c\n        - /root/nextepc/nextepc-mmed\n        volumeMounts:\n        - name: nextepc-conf\n          mountPath: /root/nextepc/install/etc/nextepc/\n      initContainers:\n      - name: init-network-client\n        image: sdnvortex/network-controller:v0.4.9\n        command:\n        - /go/bin/client\n        args:\n        - -s=unix:///tmp/vortex.sock\n        - -b=br0\n        - -n=eth1\n        - -i=192.188.2.2/24\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_UUID\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.uid\n        volumeMounts:\n        - mountPath: /tmp/\n          name: grpc-sock\n      volumes:\n      - name: grpc-sock\n        hostPath:\n          path: /tmp/vortex/\n      - name: nextepc-conf\n        configMap:\n          name: nextepc-config\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"myapp-container\" does not have a read-only root file system"
  },
  {
    "id": "1308",
    "manifest_path": "data/manifests/the_stack_sample/sample_0196.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nextepc-mme-deployment\nspec:\n  selector:\n    matchLabels:\n      app: nextepc-mme\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: nextepc-mme\n    spec:\n      containers:\n      - name: myapp-container\n        image: cewuandy/nextepc-base\n        imagePullPolicy: Always\n        command:\n        - /bin/sh\n        args:\n        - -c\n        - /root/nextepc/nextepc-mmed\n        volumeMounts:\n        - name: nextepc-conf\n          mountPath: /root/nextepc/install/etc/nextepc/\n      initContainers:\n      - name: init-network-client\n        image: sdnvortex/network-controller:v0.4.9\n        command:\n        - /go/bin/client\n        args:\n        - -s=unix:///tmp/vortex.sock\n        - -b=br0\n        - -n=eth1\n        - -i=192.188.2.2/24\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_UUID\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.uid\n        volumeMounts:\n        - mountPath: /tmp/\n          name: grpc-sock\n      volumes:\n      - name: grpc-sock\n        hostPath:\n          path: /tmp/vortex/\n      - name: nextepc-conf\n        configMap:\n          name: nextepc-config\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"init-network-client\" is not set to runAsNonRoot"
  },
  {
    "id": "1309",
    "manifest_path": "data/manifests/the_stack_sample/sample_0196.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nextepc-mme-deployment\nspec:\n  selector:\n    matchLabels:\n      app: nextepc-mme\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: nextepc-mme\n    spec:\n      containers:\n      - name: myapp-container\n        image: cewuandy/nextepc-base\n        imagePullPolicy: Always\n        command:\n        - /bin/sh\n        args:\n        - -c\n        - /root/nextepc/nextepc-mmed\n        volumeMounts:\n        - name: nextepc-conf\n          mountPath: /root/nextepc/install/etc/nextepc/\n      initContainers:\n      - name: init-network-client\n        image: sdnvortex/network-controller:v0.4.9\n        command:\n        - /go/bin/client\n        args:\n        - -s=unix:///tmp/vortex.sock\n        - -b=br0\n        - -n=eth1\n        - -i=192.188.2.2/24\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_UUID\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.uid\n        volumeMounts:\n        - mountPath: /tmp/\n          name: grpc-sock\n      volumes:\n      - name: grpc-sock\n        hostPath:\n          path: /tmp/vortex/\n      - name: nextepc-conf\n        configMap:\n          name: nextepc-config\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"myapp-container\" is not set to runAsNonRoot"
  },
  {
    "id": "1310",
    "manifest_path": "data/manifests/the_stack_sample/sample_0196.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nextepc-mme-deployment\nspec:\n  selector:\n    matchLabels:\n      app: nextepc-mme\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: nextepc-mme\n    spec:\n      containers:\n      - name: myapp-container\n        image: cewuandy/nextepc-base\n        imagePullPolicy: Always\n        command:\n        - /bin/sh\n        args:\n        - -c\n        - /root/nextepc/nextepc-mmed\n        volumeMounts:\n        - name: nextepc-conf\n          mountPath: /root/nextepc/install/etc/nextepc/\n      initContainers:\n      - name: init-network-client\n        image: sdnvortex/network-controller:v0.4.9\n        command:\n        - /go/bin/client\n        args:\n        - -s=unix:///tmp/vortex.sock\n        - -b=br0\n        - -n=eth1\n        - -i=192.188.2.2/24\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_UUID\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.uid\n        volumeMounts:\n        - mountPath: /tmp/\n          name: grpc-sock\n      volumes:\n      - name: grpc-sock\n        hostPath:\n          path: /tmp/vortex/\n      - name: nextepc-conf\n        configMap:\n          name: nextepc-config\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"init-network-client\" has cpu request 0"
  },
  {
    "id": "1311",
    "manifest_path": "data/manifests/the_stack_sample/sample_0196.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nextepc-mme-deployment\nspec:\n  selector:\n    matchLabels:\n      app: nextepc-mme\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: nextepc-mme\n    spec:\n      containers:\n      - name: myapp-container\n        image: cewuandy/nextepc-base\n        imagePullPolicy: Always\n        command:\n        - /bin/sh\n        args:\n        - -c\n        - /root/nextepc/nextepc-mmed\n        volumeMounts:\n        - name: nextepc-conf\n          mountPath: /root/nextepc/install/etc/nextepc/\n      initContainers:\n      - name: init-network-client\n        image: sdnvortex/network-controller:v0.4.9\n        command:\n        - /go/bin/client\n        args:\n        - -s=unix:///tmp/vortex.sock\n        - -b=br0\n        - -n=eth1\n        - -i=192.188.2.2/24\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_UUID\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.uid\n        volumeMounts:\n        - mountPath: /tmp/\n          name: grpc-sock\n      volumes:\n      - name: grpc-sock\n        hostPath:\n          path: /tmp/vortex/\n      - name: nextepc-conf\n        configMap:\n          name: nextepc-config\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"myapp-container\" has cpu request 0"
  },
  {
    "id": "1312",
    "manifest_path": "data/manifests/the_stack_sample/sample_0196.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nextepc-mme-deployment\nspec:\n  selector:\n    matchLabels:\n      app: nextepc-mme\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: nextepc-mme\n    spec:\n      containers:\n      - name: myapp-container\n        image: cewuandy/nextepc-base\n        imagePullPolicy: Always\n        command:\n        - /bin/sh\n        args:\n        - -c\n        - /root/nextepc/nextepc-mmed\n        volumeMounts:\n        - name: nextepc-conf\n          mountPath: /root/nextepc/install/etc/nextepc/\n      initContainers:\n      - name: init-network-client\n        image: sdnvortex/network-controller:v0.4.9\n        command:\n        - /go/bin/client\n        args:\n        - -s=unix:///tmp/vortex.sock\n        - -b=br0\n        - -n=eth1\n        - -i=192.188.2.2/24\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_UUID\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.uid\n        volumeMounts:\n        - mountPath: /tmp/\n          name: grpc-sock\n      volumes:\n      - name: grpc-sock\n        hostPath:\n          path: /tmp/vortex/\n      - name: nextepc-conf\n        configMap:\n          name: nextepc-config\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"init-network-client\" has memory limit 0"
  },
  {
    "id": "1313",
    "manifest_path": "data/manifests/the_stack_sample/sample_0196.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nextepc-mme-deployment\nspec:\n  selector:\n    matchLabels:\n      app: nextepc-mme\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: nextepc-mme\n    spec:\n      containers:\n      - name: myapp-container\n        image: cewuandy/nextepc-base\n        imagePullPolicy: Always\n        command:\n        - /bin/sh\n        args:\n        - -c\n        - /root/nextepc/nextepc-mmed\n        volumeMounts:\n        - name: nextepc-conf\n          mountPath: /root/nextepc/install/etc/nextepc/\n      initContainers:\n      - name: init-network-client\n        image: sdnvortex/network-controller:v0.4.9\n        command:\n        - /go/bin/client\n        args:\n        - -s=unix:///tmp/vortex.sock\n        - -b=br0\n        - -n=eth1\n        - -i=192.188.2.2/24\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_UUID\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.uid\n        volumeMounts:\n        - mountPath: /tmp/\n          name: grpc-sock\n      volumes:\n      - name: grpc-sock\n        hostPath:\n          path: /tmp/vortex/\n      - name: nextepc-conf\n        configMap:\n          name: nextepc-config\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"myapp-container\" has memory limit 0"
  }
]