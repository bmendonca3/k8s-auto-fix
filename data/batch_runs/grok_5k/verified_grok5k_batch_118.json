[
  {
    "id": "04721",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  labels:\n    aci-containers-config-version: dummy\n    network-plugin: aci-containers\n  name: aci-containers-host\n  namespace: aci-containers-system\nspec:\n  selector:\n    matchLabels:\n      name: aci-containers-host\n      network-plugin: aci-containers\n  template:\n    metadata:\n      annotations:\n        prometheus.io/port: '9612'\n        prometheus.io/scrape: 'true'\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n      labels:\n        name: aci-containers-host\n        network-plugin: aci-containers\n    spec:\n      containers:\n      - env:\n        - name: KUBERNETES_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: TENANT\n          value: csrtest\n        - name: NODE_EPG\n          value: aci-containers-nodes\n        - name: OPFLEX_MODE\n          value: overlay\n        - name: DURATION_WAIT_FOR_NETWORK\n          value: '210'\n        image: noirolabs/aci-containers-host:ci_test\n        imagePullPolicy: Always\n        livenessProbe:\n          failureThreshold: 10\n          httpGet:\n            path: /status\n            port: 8090\n            scheme: HTTP\n          initialDelaySeconds: 120\n          periodSeconds: 60\n          successThreshold: 1\n          timeoutSeconds: 30\n        name: aci-containers-host\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n          privileged: false\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /mnt/cni-bin\n          name: cni-bin\n        - mountPath: /mnt/cni-conf\n          name: cni-conf\n        - mountPath: /usr/local/var\n          name: hostvar\n        - mountPath: /run\n          name: hostrun\n        - mountPath: /usr/local/run\n          name: hostrun\n        - mountPath: /usr/local/etc/opflex-agent-ovs/base-conf.d\n          name: opflex-hostconfig-volume\n        - mountPath: /usr/local/etc/aci-containers/\n          name: host-config-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - env:\n        - name: REBOOT_WITH_OVS\n          value: 'true'\n        - name: SSL_MODE\n          value: disabled\n        image: noirolabs/opflex:ci_test\n        imagePullPolicy: Always\n        name: opflex-agent\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n          privileged: false\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /usr/local/var\n          name: hostvar\n        - mountPath: /run\n          name: hostrun\n        - mountPath: /usr/local/run\n          name: hostrun\n        - mountPath: /usr/local/etc/opflex-agent-ovs/base-conf.d\n          name: opflex-hostconfig-volume\n        - mountPath: /usr/local/etc/opflex-agent-ovs/conf.d\n          name: opflex-config-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - args:\n        - /usr/local/bin/launch-opflexserver.sh\n        command:\n        - /bin/sh\n        image: noirolabs/opflex:ci_test\n        imagePullPolicy: Always\n        name: opflex-server\n        ports:\n        - containerPort: 19999\n        - containerPort: 9632\n          name: metrics\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n          privileged: false\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /usr/local/etc/opflex-server\n          name: opflex-server-config-volume\n        - mountPath: /usr/local/var\n          name: hostvar\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      initContainers:\n      - image: noirolabs/cnideploy:6.0.0.0.0ef4718\n        imagePullPolicy: Always\n        name: cnideploy\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n          privileged: false\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /mnt/cni-bin\n          name: cni-bin\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      serviceAccountName: aci-containers-host-agent\n      volumes:\n      - emptyDir: {}\n        name: cni-bin\n      - emptyDir: {}\n        name: cni-conf\n      - emptyDir: {}\n        name: hostvar\n      - emptyDir: {}\n        name: hostrun\n      - configMap:\n          items:\n          - key: host-agent-config\n            path: host-agent.conf\n          name: aci-containers-config\n        name: host-config-volume\n      - emptyDir:\n          medium: Memory\n        name: opflex-hostconfig-volume\n      - configMap:\n          items:\n          - key: opflex-agent-config\n            path: local.conf\n          name: aci-containers-config\n        name: opflex-config-volume\n      - name: opflex-server-config-volume\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "04722",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  labels:\n    aci-containers-config-version: dummy\n    network-plugin: aci-containers\n  name: aci-containers-host\n  namespace: aci-containers-system\nspec:\n  selector:\n    matchLabels:\n      name: aci-containers-host\n      network-plugin: aci-containers\n  template:\n    metadata:\n      annotations:\n        prometheus.io/port: '9612'\n        prometheus.io/scrape: 'true'\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n      labels:\n        name: aci-containers-host\n        network-plugin: aci-containers\n    spec:\n      containers:\n      - env:\n        - name: KUBERNETES_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: TENANT\n          value: csrtest\n        - name: NODE_EPG\n          value: aci-containers-nodes\n        - name: OPFLEX_MODE\n          value: overlay\n        - name: DURATION_WAIT_FOR_NETWORK\n          value: '210'\n        image: noirolabs/aci-containers-host:ci_test\n        imagePullPolicy: Always\n        livenessProbe:\n          failureThreshold: 10\n          httpGet:\n            path: /status\n            port: 8090\n            scheme: HTTP\n          initialDelaySeconds: 120\n          periodSeconds: 60\n          successThreshold: 1\n          timeoutSeconds: 30\n        name: aci-containers-host\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n          privileged: false\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /mnt/cni-bin\n          name: cni-bin\n        - mountPath: /mnt/cni-conf\n          name: cni-conf\n        - mountPath: /usr/local/var\n          name: hostvar\n        - mountPath: /run\n          name: hostrun\n        - mountPath: /usr/local/run\n          name: hostrun\n        - mountPath: /usr/local/etc/opflex-agent-ovs/base-conf.d\n          name: opflex-hostconfig-volume\n        - mountPath: /usr/local/etc/aci-containers/\n          name: host-config-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - env:\n        - name: REBOOT_WITH_OVS\n          value: 'true'\n        - name: SSL_MODE\n          value: disabled\n        image: noirolabs/opflex:ci_test\n        imagePullPolicy: Always\n        name: opflex-agent\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n          privileged: false\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /usr/local/var\n          name: hostvar\n        - mountPath: /run\n          name: hostrun\n        - mountPath: /usr/local/run\n          name: hostrun\n        - mountPath: /usr/local/etc/opflex-agent-ovs/base-conf.d\n          name: opflex-hostconfig-volume\n        - mountPath: /usr/local/etc/opflex-agent-ovs/conf.d\n          name: opflex-config-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - args:\n        - /usr/local/bin/launch-opflexserver.sh\n        command:\n        - /bin/sh\n        image: noirolabs/opflex:ci_test\n        imagePullPolicy: Always\n        name: opflex-server\n        ports:\n        - containerPort: 19999\n        - containerPort: 9632\n          name: metrics\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n          privileged: false\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /usr/local/etc/opflex-server\n          name: opflex-server-config-volume\n        - mountPath: /usr/local/var\n          name: hostvar\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      initContainers:\n      - image: noirolabs/cnideploy:6.0.0.0.0ef4718\n        imagePullPolicy: Always\n        name: cnideploy\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n          privileged: false\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /mnt/cni-bin\n          name: cni-bin\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      serviceAccountName: aci-containers-host-agent\n      volumes:\n      - name: cni-bin\n        emptyDir: {}\n      - name: cni-conf\n        emptyDir: {}\n      - name: hostvar\n        emptyDir: {}\n      - name: hostrun\n        emptyDir: {}\n      - configMap:\n          items:\n          - key: host-agent-config\n            path: host-agent.conf\n          name: aci-containers-config\n        name: host-config-volume\n      - emptyDir:\n          medium: Memory\n        name: opflex-hostconfig-volume\n      - configMap:\n          items:\n          - key: opflex-agent-config\n            path: local.conf\n          name: aci-containers-config\n        name: opflex-config-volume\n      - name: opflex-server-config-volume\n        emptyDir: {}\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "04723",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  labels:\n    aci-containers-config-version: dummy\n    network-plugin: aci-containers\n  name: aci-containers-host\n  namespace: aci-containers-system\nspec:\n  selector:\n    matchLabels:\n      name: aci-containers-host\n      network-plugin: aci-containers\n  template:\n    metadata:\n      annotations:\n        prometheus.io/port: '9612'\n        prometheus.io/scrape: 'true'\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n      labels:\n        name: aci-containers-host\n        network-plugin: aci-containers\n    spec:\n      containers:\n      - env:\n        - name: KUBERNETES_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: TENANT\n          value: csrtest\n        - name: NODE_EPG\n          value: aci-containers-nodes\n        - name: OPFLEX_MODE\n          value: overlay\n        - name: DURATION_WAIT_FOR_NETWORK\n          value: '210'\n        image: noirolabs/aci-containers-host:ci_test\n        imagePullPolicy: Always\n        livenessProbe:\n          failureThreshold: 10\n          httpGet:\n            path: /status\n            port: 8090\n            scheme: HTTP\n          initialDelaySeconds: 120\n          periodSeconds: 60\n          successThreshold: 1\n          timeoutSeconds: 30\n        name: aci-containers-host\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n          privileged: false\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /mnt/cni-bin\n          name: cni-bin\n        - mountPath: /mnt/cni-conf\n          name: cni-conf\n        - mountPath: /usr/local/var\n          name: hostvar\n        - mountPath: /run\n          name: hostrun\n        - mountPath: /usr/local/run\n          name: hostrun\n        - mountPath: /usr/local/etc/opflex-agent-ovs/base-conf.d\n          name: opflex-hostconfig-volume\n        - mountPath: /usr/local/etc/aci-containers/\n          name: host-config-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - env:\n        - name: REBOOT_WITH_OVS\n          value: 'true'\n        - name: SSL_MODE\n          value: disabled\n        image: noirolabs/opflex:ci_test\n        imagePullPolicy: Always\n        name: opflex-agent\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n          privileged: false\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /usr/local/var\n          name: hostvar\n        - mountPath: /run\n          name: hostrun\n        - mountPath: /usr/local/run\n          name: hostrun\n        - mountPath: /usr/local/etc/opflex-agent-ovs/base-conf.d\n          name: opflex-hostconfig-volume\n        - mountPath: /usr/local/etc/opflex-agent-ovs/conf.d\n          name: opflex-config-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - args:\n        - /usr/local/bin/launch-opflexserver.sh\n        command:\n        - /bin/sh\n        image: noirolabs/opflex:ci_test\n        imagePullPolicy: Always\n        name: opflex-server\n        ports:\n        - containerPort: 19999\n        - containerPort: 9632\n          name: metrics\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n          privileged: false\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /usr/local/etc/opflex-server\n          name: opflex-server-config-volume\n        - mountPath: /usr/local/var\n          name: hostvar\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      initContainers:\n      - image: noirolabs/cnideploy:6.0.0.0.0ef4718\n        imagePullPolicy: Always\n        name: cnideploy\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n          privileged: false\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /mnt/cni-bin\n          name: cni-bin\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      serviceAccountName: aci-containers-host-agent\n      volumes:\n      - hostPath:\n          path: /var/lib\n        name: cni-bin\n      - hostPath:\n          path: /etc/kubernetes\n        name: cni-conf\n      - hostPath:\n          path: /var\n        name: hostvar\n      - hostPath:\n          path: /run\n        name: hostrun\n      - configMap:\n          items:\n          - key: host-agent-config\n            path: host-agent.conf\n          name: aci-containers-config\n        name: host-config-volume\n      - emptyDir:\n          medium: Memory\n        name: opflex-hostconfig-volume\n      - configMap:\n          items:\n          - key: opflex-agent-config\n            path: local.conf\n          name: aci-containers-config\n        name: opflex-config-volume\n      - name: opflex-server-config-volume\n",
    "errors": []
  },
  {
    "id": "04724",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  labels:\n    aci-containers-config-version: dummy\n    network-plugin: aci-containers\n  name: aci-containers-host\n  namespace: aci-containers-system\nspec:\n  selector:\n    matchLabels:\n      name: aci-containers-host\n      network-plugin: aci-containers\n  template:\n    metadata:\n      annotations:\n        prometheus.io/port: '9612'\n        prometheus.io/scrape: 'true'\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n      labels:\n        name: aci-containers-host\n        network-plugin: aci-containers\n    spec:\n      containers:\n      - env:\n        - name: KUBERNETES_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: TENANT\n          value: csrtest\n        - name: NODE_EPG\n          value: aci-containers-nodes\n        - name: OPFLEX_MODE\n          value: overlay\n        - name: DURATION_WAIT_FOR_NETWORK\n          value: '210'\n        image: noirolabs/aci-containers-host:ci_test\n        imagePullPolicy: Always\n        livenessProbe:\n          failureThreshold: 10\n          httpGet:\n            path: /status\n            port: 8090\n            scheme: HTTP\n          initialDelaySeconds: 120\n          periodSeconds: 60\n          successThreshold: 1\n          timeoutSeconds: 30\n        name: aci-containers-host\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /mnt/cni-bin\n          name: cni-bin\n        - mountPath: /mnt/cni-conf\n          name: cni-conf\n        - mountPath: /usr/local/var\n          name: hostvar\n        - mountPath: /run\n          name: hostrun\n        - mountPath: /usr/local/run\n          name: hostrun\n        - mountPath: /usr/local/etc/opflex-agent-ovs/base-conf.d\n          name: opflex-hostconfig-volume\n        - mountPath: /usr/local/etc/aci-containers/\n          name: host-config-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - env:\n        - name: REBOOT_WITH_OVS\n          value: 'true'\n        - name: SSL_MODE\n          value: disabled\n        image: noirolabs/opflex:ci_test\n        imagePullPolicy: Always\n        name: opflex-agent\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /usr/local/var\n          name: hostvar\n        - mountPath: /run\n          name: hostrun\n        - mountPath: /usr/local/run\n          name: hostrun\n        - mountPath: /usr/local/etc/opflex-agent-ovs/base-conf.d\n          name: opflex-hostconfig-volume\n        - mountPath: /usr/local/etc/opflex-agent-ovs/conf.d\n          name: opflex-config-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - args:\n        - /usr/local/bin/launch-opflexserver.sh\n        command:\n        - /bin/sh\n        image: noirolabs/opflex:ci_test\n        imagePullPolicy: Always\n        name: opflex-server\n        ports:\n        - containerPort: 19999\n        - containerPort: 9632\n          name: metrics\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /usr/local/etc/opflex-server\n          name: opflex-server-config-volume\n        - mountPath: /usr/local/var\n          name: hostvar\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      initContainers:\n      - image: noirolabs/cnideploy:6.0.0.0.0ef4718\n        imagePullPolicy: Always\n        name: cnideploy\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /mnt/cni-bin\n          name: cni-bin\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      serviceAccountName: aci-containers-host-agent\n      volumes:\n      - name: cni-bin\n        emptyDir: {}\n      - name: cni-conf\n        emptyDir: {}\n      - name: hostvar\n        emptyDir: {}\n      - name: hostrun\n        emptyDir: {}\n      - configMap:\n          items:\n          - key: host-agent-config\n            path: host-agent.conf\n          name: aci-containers-config\n        name: host-config-volume\n      - emptyDir:\n          medium: Memory\n        name: opflex-hostconfig-volume\n      - configMap:\n          items:\n          - key: opflex-agent-config\n            path: local.conf\n          name: aci-containers-config\n        name: opflex-config-volume\n      - name: opflex-server-config-volume\n        emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "04725",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  labels:\n    aci-containers-config-version: dummy\n    network-plugin: aci-containers\n  name: aci-containers-host\n  namespace: aci-containers-system\nspec:\n  selector:\n    matchLabels:\n      name: aci-containers-host\n      network-plugin: aci-containers\n  template:\n    metadata:\n      annotations:\n        prometheus.io/port: '9612'\n        prometheus.io/scrape: 'true'\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n      labels:\n        name: aci-containers-host\n        network-plugin: aci-containers\n    spec:\n      containers:\n      - env:\n        - name: KUBERNETES_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: TENANT\n          value: csrtest\n        - name: NODE_EPG\n          value: aci-containers-nodes\n        - name: OPFLEX_MODE\n          value: overlay\n        - name: DURATION_WAIT_FOR_NETWORK\n          value: '210'\n        image: noirolabs/aci-containers-host:ci_test\n        imagePullPolicy: Always\n        livenessProbe:\n          failureThreshold: 10\n          httpGet:\n            path: /status\n            port: 8090\n            scheme: HTTP\n          initialDelaySeconds: 120\n          periodSeconds: 60\n          successThreshold: 1\n          timeoutSeconds: 30\n        name: aci-containers-host\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /mnt/cni-bin\n          name: cni-bin\n        - mountPath: /mnt/cni-conf\n          name: cni-conf\n        - mountPath: /usr/local/var\n          name: hostvar\n        - mountPath: /run\n          name: hostrun\n        - mountPath: /usr/local/run\n          name: hostrun\n        - mountPath: /usr/local/etc/opflex-agent-ovs/base-conf.d\n          name: opflex-hostconfig-volume\n        - mountPath: /usr/local/etc/aci-containers/\n          name: host-config-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - env:\n        - name: REBOOT_WITH_OVS\n          value: 'true'\n        - name: SSL_MODE\n          value: disabled\n        image: noirolabs/opflex:ci_test\n        imagePullPolicy: Always\n        name: opflex-agent\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /usr/local/var\n          name: hostvar\n        - mountPath: /run\n          name: hostrun\n        - mountPath: /usr/local/run\n          name: hostrun\n        - mountPath: /usr/local/etc/opflex-agent-ovs/base-conf.d\n          name: opflex-hostconfig-volume\n        - mountPath: /usr/local/etc/opflex-agent-ovs/conf.d\n          name: opflex-config-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - args:\n        - /usr/local/bin/launch-opflexserver.sh\n        command:\n        - /bin/sh\n        image: noirolabs/opflex:ci_test\n        imagePullPolicy: Always\n        name: opflex-server\n        ports:\n        - containerPort: 19999\n        - containerPort: 9632\n          name: metrics\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /usr/local/etc/opflex-server\n          name: opflex-server-config-volume\n        - mountPath: /usr/local/var\n          name: hostvar\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      initContainers:\n      - image: noirolabs/cnideploy:6.0.0.0.0ef4718\n        imagePullPolicy: Always\n        name: cnideploy\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /mnt/cni-bin\n          name: cni-bin\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      serviceAccountName: aci-containers-host-agent\n      volumes:\n      - hostPath:\n          path: /var/lib\n        name: cni-bin\n      - hostPath:\n          path: /etc/kubernetes\n        name: cni-conf\n      - hostPath:\n          path: /var\n        name: hostvar\n      - hostPath:\n          path: /run\n        name: hostrun\n      - configMap:\n          items:\n          - key: host-agent-config\n            path: host-agent.conf\n          name: aci-containers-config\n        name: host-config-volume\n      - emptyDir:\n          medium: Memory\n        name: opflex-hostconfig-volume\n      - configMap:\n          items:\n          - key: opflex-agent-config\n            path: local.conf\n          name: aci-containers-config\n        name: opflex-config-volume\n      - name: opflex-server-config-volume\n",
    "errors": []
  },
  {
    "id": "04726",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  labels:\n    aci-containers-config-version: dummy\n    network-plugin: aci-containers\n  name: aci-containers-host\n  namespace: aci-containers-system\nspec:\n  selector:\n    matchLabels:\n      name: aci-containers-host\n      network-plugin: aci-containers\n  template:\n    metadata:\n      annotations:\n        prometheus.io/port: '9612'\n        prometheus.io/scrape: 'true'\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n      labels:\n        name: aci-containers-host\n        network-plugin: aci-containers\n    spec:\n      containers:\n      - env:\n        - name: KUBERNETES_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: TENANT\n          value: csrtest\n        - name: NODE_EPG\n          value: aci-containers-nodes\n        - name: OPFLEX_MODE\n          value: overlay\n        - name: DURATION_WAIT_FOR_NETWORK\n          value: '210'\n        image: noirolabs/aci-containers-host:ci_test\n        imagePullPolicy: Always\n        livenessProbe:\n          failureThreshold: 10\n          httpGet:\n            path: /status\n            port: 8090\n            scheme: HTTP\n          initialDelaySeconds: 120\n          periodSeconds: 60\n          successThreshold: 1\n          timeoutSeconds: 30\n        name: aci-containers-host\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /mnt/cni-bin\n          name: cni-bin\n        - mountPath: /mnt/cni-conf\n          name: cni-conf\n        - mountPath: /usr/local/var\n          name: hostvar\n        - mountPath: /run\n          name: hostrun\n        - mountPath: /usr/local/run\n          name: hostrun\n        - mountPath: /usr/local/etc/opflex-agent-ovs/base-conf.d\n          name: opflex-hostconfig-volume\n        - mountPath: /usr/local/etc/aci-containers/\n          name: host-config-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - env:\n        - name: REBOOT_WITH_OVS\n          value: 'true'\n        - name: SSL_MODE\n          value: disabled\n        image: noirolabs/opflex:ci_test\n        imagePullPolicy: Always\n        name: opflex-agent\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /usr/local/var\n          name: hostvar\n        - mountPath: /run\n          name: hostrun\n        - mountPath: /usr/local/run\n          name: hostrun\n        - mountPath: /usr/local/etc/opflex-agent-ovs/base-conf.d\n          name: opflex-hostconfig-volume\n        - mountPath: /usr/local/etc/opflex-agent-ovs/conf.d\n          name: opflex-config-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - args:\n        - /usr/local/bin/launch-opflexserver.sh\n        command:\n        - /bin/sh\n        image: noirolabs/opflex:ci_test\n        imagePullPolicy: Always\n        name: opflex-server\n        ports:\n        - containerPort: 19999\n        - containerPort: 9632\n          name: metrics\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /usr/local/etc/opflex-server\n          name: opflex-server-config-volume\n        - mountPath: /usr/local/var\n          name: hostvar\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      initContainers:\n      - image: noirolabs/cnideploy:6.0.0.0.0ef4718\n        imagePullPolicy: Always\n        name: cnideploy\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /mnt/cni-bin\n          name: cni-bin\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      serviceAccountName: aci-containers-host-agent\n      volumes:\n      - emptyDir: {}\n        name: cni-bin\n      - emptyDir: {}\n        name: cni-conf\n      - emptyDir: {}\n        name: hostvar\n      - emptyDir: {}\n        name: hostrun\n      - configMap:\n          items:\n          - key: host-agent-config\n            path: host-agent.conf\n          name: aci-containers-config\n        name: host-config-volume\n      - emptyDir:\n          medium: Memory\n        name: opflex-hostconfig-volume\n      - configMap:\n          items:\n          - key: opflex-agent-config\n            path: local.conf\n          name: aci-containers-config\n        name: opflex-config-volume\n      - name: opflex-server-config-volume\n        emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "04727",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  labels:\n    aci-containers-config-version: dummy\n    network-plugin: aci-containers\n  name: aci-containers-host\n  namespace: aci-containers-system\nspec:\n  selector:\n    matchLabels:\n      name: aci-containers-host\n      network-plugin: aci-containers\n  template:\n    metadata:\n      annotations:\n        prometheus.io/port: '9612'\n        prometheus.io/scrape: 'true'\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n      labels:\n        name: aci-containers-host\n        network-plugin: aci-containers\n    spec:\n      containers:\n      - env:\n        - name: KUBERNETES_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: TENANT\n          value: csrtest\n        - name: NODE_EPG\n          value: aci-containers-nodes\n        - name: OPFLEX_MODE\n          value: overlay\n        - name: DURATION_WAIT_FOR_NETWORK\n          value: '210'\n        image: noirolabs/aci-containers-host:ci_test\n        imagePullPolicy: Always\n        livenessProbe:\n          failureThreshold: 10\n          httpGet:\n            path: /status\n            port: 8090\n            scheme: HTTP\n          initialDelaySeconds: 120\n          periodSeconds: 60\n          successThreshold: 1\n          timeoutSeconds: 30\n        name: aci-containers-host\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /mnt/cni-bin\n          name: cni-bin\n        - mountPath: /mnt/cni-conf\n          name: cni-conf\n        - mountPath: /usr/local/var\n          name: hostvar\n        - mountPath: /run\n          name: hostrun\n        - mountPath: /usr/local/run\n          name: hostrun\n        - mountPath: /usr/local/etc/opflex-agent-ovs/base-conf.d\n          name: opflex-hostconfig-volume\n        - mountPath: /usr/local/etc/aci-containers/\n          name: host-config-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - env:\n        - name: REBOOT_WITH_OVS\n          value: 'true'\n        - name: SSL_MODE\n          value: disabled\n        image: noirolabs/opflex:ci_test\n        imagePullPolicy: Always\n        name: opflex-agent\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /usr/local/var\n          name: hostvar\n        - mountPath: /run\n          name: hostrun\n        - mountPath: /usr/local/run\n          name: hostrun\n        - mountPath: /usr/local/etc/opflex-agent-ovs/base-conf.d\n          name: opflex-hostconfig-volume\n        - mountPath: /usr/local/etc/opflex-agent-ovs/conf.d\n          name: opflex-config-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - args:\n        - /usr/local/bin/launch-opflexserver.sh\n        command:\n        - /bin/sh\n        image: noirolabs/opflex:ci_test\n        imagePullPolicy: Always\n        name: opflex-server\n        ports:\n        - containerPort: 19999\n        - containerPort: 9632\n          name: metrics\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /usr/local/etc/opflex-server\n          name: opflex-server-config-volume\n        - mountPath: /usr/local/var\n          name: hostvar\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      initContainers:\n      - image: noirolabs/cnideploy:6.0.0.0.0ef4718\n        imagePullPolicy: Always\n        name: cnideploy\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /mnt/cni-bin\n          name: cni-bin\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      serviceAccountName: aci-containers-host-agent\n      volumes:\n      - name: cni-bin\n        emptyDir: {}\n      - name: cni-conf\n        emptyDir: {}\n      - name: hostvar\n        emptyDir: {}\n      - name: hostrun\n        emptyDir: {}\n      - configMap:\n          items:\n          - key: host-agent-config\n            path: host-agent.conf\n          name: aci-containers-config\n        name: host-config-volume\n      - emptyDir:\n          medium: Memory\n        name: opflex-hostconfig-volume\n      - configMap:\n          items:\n          - key: opflex-agent-config\n            path: local.conf\n          name: aci-containers-config\n        name: opflex-config-volume\n      - name: opflex-server-config-volume\n",
    "errors": []
  },
  {
    "id": "04728",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  labels:\n    aci-containers-config-version: dummy\n    network-plugin: aci-containers\n  name: aci-containers-host\n  namespace: aci-containers-system\nspec:\n  selector:\n    matchLabels:\n      name: aci-containers-host\n      network-plugin: aci-containers\n  template:\n    metadata:\n      annotations:\n        prometheus.io/port: '9612'\n        prometheus.io/scrape: 'true'\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n      labels:\n        name: aci-containers-host\n        network-plugin: aci-containers\n    spec:\n      containers:\n      - env:\n        - name: KUBERNETES_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: TENANT\n          value: csrtest\n        - name: NODE_EPG\n          value: aci-containers-nodes\n        - name: OPFLEX_MODE\n          value: overlay\n        - name: DURATION_WAIT_FOR_NETWORK\n          value: '210'\n        image: noirolabs/aci-containers-host:ci_test\n        imagePullPolicy: Always\n        livenessProbe:\n          failureThreshold: 10\n          httpGet:\n            path: /status\n            port: 8090\n            scheme: HTTP\n          initialDelaySeconds: 120\n          periodSeconds: 60\n          successThreshold: 1\n          timeoutSeconds: 30\n        name: aci-containers-host\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /mnt/cni-bin\n          name: cni-bin\n        - mountPath: /mnt/cni-conf\n          name: cni-conf\n        - mountPath: /usr/local/var\n          name: hostvar\n        - mountPath: /run\n          name: hostrun\n        - mountPath: /usr/local/run\n          name: hostrun\n        - mountPath: /usr/local/etc/opflex-agent-ovs/base-conf.d\n          name: opflex-hostconfig-volume\n        - mountPath: /usr/local/etc/aci-containers/\n          name: host-config-volume\n        resources:\n          limits:\n            cpu: 500m\n            memory: 256Mi\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      - env:\n        - name: REBOOT_WITH_OVS\n          value: 'true'\n        - name: SSL_MODE\n          value: disabled\n        image: noirolabs/opflex:ci_test\n        imagePullPolicy: Always\n        name: opflex-agent\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /usr/local/var\n          name: hostvar\n        - mountPath: /run\n          name: hostrun\n        - mountPath: /usr/local/run\n          name: hostrun\n        - mountPath: /usr/local/etc/opflex-agent-ovs/base-conf.d\n          name: opflex-hostconfig-volume\n        - mountPath: /usr/local/etc/opflex-agent-ovs/conf.d\n          name: opflex-config-volume\n        resources:\n          limits:\n            cpu: 500m\n            memory: 256Mi\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      - args:\n        - /usr/local/bin/launch-opflexserver.sh\n        command:\n        - /bin/sh\n        image: noirolabs/opflex:ci_test\n        imagePullPolicy: Always\n        name: opflex-server\n        ports:\n        - containerPort: 19999\n        - containerPort: 9632\n          name: metrics\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /usr/local/etc/opflex-server\n          name: opflex-server-config-volume\n        - mountPath: /usr/local/var\n          name: hostvar\n        resources:\n          limits:\n            cpu: 500m\n            memory: 256Mi\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      initContainers:\n      - image: noirolabs/cnideploy:6.0.0.0.0ef4718\n        imagePullPolicy: Always\n        name: cnideploy\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /mnt/cni-bin\n          name: cni-bin\n        resources:\n          limits:\n            cpu: 500m\n            memory: 256Mi\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      serviceAccountName: aci-containers-host-agent\n      volumes:\n      - name: cni-bin\n        emptyDir: {}\n      - name: cni-conf\n        emptyDir: {}\n      - name: hostvar\n        emptyDir: {}\n      - name: hostrun\n        emptyDir:\n          medium: Memory\n      - configMap:\n          items:\n          - key: host-agent-config\n            path: host-agent.conf\n          name: aci-containers-config\n        name: host-config-volume\n      - emptyDir:\n          medium: Memory\n        name: opflex-hostconfig-volume\n      - configMap:\n          items:\n          - key: opflex-agent-config\n            path: local.conf\n          name: aci-containers-config\n        name: opflex-config-volume\n      - name: opflex-server-config-volume\n        emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "04729",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  labels:\n    aci-containers-config-version: dummy\n    network-plugin: aci-containers\n  name: aci-containers-host\n  namespace: aci-containers-system\nspec:\n  selector:\n    matchLabels:\n      name: aci-containers-host\n      network-plugin: aci-containers\n  template:\n    metadata:\n      annotations:\n        prometheus.io/port: '9612'\n        prometheus.io/scrape: 'true'\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n      labels:\n        name: aci-containers-host\n        network-plugin: aci-containers\n    spec:\n      containers:\n      - env:\n        - name: KUBERNETES_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: TENANT\n          value: csrtest\n        - name: NODE_EPG\n          value: aci-containers-nodes\n        - name: OPFLEX_MODE\n          value: overlay\n        - name: DURATION_WAIT_FOR_NETWORK\n          value: '210'\n        image: noirolabs/aci-containers-host:ci_test\n        imagePullPolicy: Always\n        livenessProbe:\n          failureThreshold: 10\n          httpGet:\n            path: /status\n            port: 8090\n            scheme: HTTP\n          initialDelaySeconds: 120\n          periodSeconds: 60\n          successThreshold: 1\n          timeoutSeconds: 30\n        name: aci-containers-host\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /mnt/cni-bin\n          name: cni-bin\n        - mountPath: /mnt/cni-conf\n          name: cni-conf\n        - mountPath: /usr/local/var\n          name: hostvar\n        - mountPath: /run\n          name: hostrun\n        - mountPath: /usr/local/run\n          name: hostrun\n        - mountPath: /usr/local/etc/opflex-agent-ovs/base-conf.d\n          name: opflex-hostconfig-volume\n        - mountPath: /usr/local/etc/aci-containers/\n          name: host-config-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - env:\n        - name: REBOOT_WITH_OVS\n          value: 'true'\n        - name: SSL_MODE\n          value: disabled\n        image: noirolabs/opflex:ci_test\n        imagePullPolicy: Always\n        name: opflex-agent\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /usr/local/var\n          name: hostvar\n        - mountPath: /run\n          name: hostrun\n        - mountPath: /usr/local/run\n          name: hostrun\n        - mountPath: /usr/local/etc/opflex-agent-ovs/base-conf.d\n          name: opflex-hostconfig-volume\n        - mountPath: /usr/local/etc/opflex-agent-ovs/conf.d\n          name: opflex-config-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - args:\n        - /usr/local/bin/launch-opflexserver.sh\n        command:\n        - /bin/sh\n        image: noirolabs/opflex:ci_test\n        imagePullPolicy: Always\n        name: opflex-server\n        ports:\n        - containerPort: 19999\n        - containerPort: 9632\n          name: metrics\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /usr/local/etc/opflex-server\n          name: opflex-server-config-volume\n        - mountPath: /usr/local/var\n          name: hostvar\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      initContainers:\n      - image: noirolabs/cnideploy:6.0.0.0.0ef4718\n        imagePullPolicy: Always\n        name: cnideploy\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /mnt/cni-bin\n          name: cni-bin\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      serviceAccountName: aci-containers-host-agent\n      volumes:\n      - name: cni-bin\n        emptyDir: {}\n      - name: cni-conf\n        emptyDir: {}\n      - name: hostvar\n        emptyDir: {}\n      - name: hostrun\n        emptyDir: {}\n      - configMap:\n          items:\n          - key: host-agent-config\n            path: host-agent.conf\n          name: aci-containers-config\n        name: host-config-volume\n      - emptyDir:\n          medium: Memory\n        name: opflex-hostconfig-volume\n      - configMap:\n          items:\n          - key: opflex-agent-config\n            path: local.conf\n          name: aci-containers-config\n        name: opflex-config-volume\n      - name: opflex-server-config-volume\n",
    "errors": []
  },
  {
    "id": "04730",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  labels:\n    aci-containers-config-version: dummy\n    network-plugin: aci-containers\n  name: aci-containers-host\n  namespace: aci-containers-system\nspec:\n  selector:\n    matchLabels:\n      name: aci-containers-host\n      network-plugin: aci-containers\n  template:\n    metadata:\n      annotations:\n        prometheus.io/port: '9612'\n        prometheus.io/scrape: 'true'\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n      labels:\n        name: aci-containers-host\n        network-plugin: aci-containers\n    spec:\n      containers:\n      - env:\n        - name: KUBERNETES_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: TENANT\n          value: csrtest\n        - name: NODE_EPG\n          value: aci-containers-nodes\n        - name: OPFLEX_MODE\n          value: overlay\n        - name: DURATION_WAIT_FOR_NETWORK\n          value: '210'\n        image: noirolabs/aci-containers-host:ci_test\n        imagePullPolicy: Always\n        livenessProbe:\n          failureThreshold: 10\n          httpGet:\n            path: /status\n            port: 8090\n            scheme: HTTP\n          initialDelaySeconds: 120\n          periodSeconds: 60\n          successThreshold: 1\n          timeoutSeconds: 30\n        name: aci-containers-host\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /mnt/cni-bin\n          name: cni-bin\n        - mountPath: /mnt/cni-conf\n          name: cni-conf\n        - mountPath: /usr/local/var\n          name: hostvar\n        - mountPath: /run\n          name: hostrun\n        - mountPath: /usr/local/run\n          name: hostrun\n        - mountPath: /usr/local/etc/opflex-agent-ovs/base-conf.d\n          name: opflex-hostconfig-volume\n        - mountPath: /usr/local/etc/aci-containers/\n          name: host-config-volume\n        resources:\n          limits:\n            cpu: 500m\n            memory: 256Mi\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      - env:\n        - name: REBOOT_WITH_OVS\n          value: 'true'\n        - name: SSL_MODE\n          value: disabled\n        image: noirolabs/opflex:ci_test\n        imagePullPolicy: Always\n        name: opflex-agent\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /usr/local/var\n          name: hostvar\n        - mountPath: /run\n          name: hostrun\n        - mountPath: /usr/local/run\n          name: hostrun\n        - mountPath: /usr/local/etc/opflex-agent-ovs/base-conf.d\n          name: opflex-hostconfig-volume\n        - mountPath: /usr/local/etc/opflex-agent-ovs/conf.d\n          name: opflex-config-volume\n        resources:\n          limits:\n            cpu: 500m\n            memory: 256Mi\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      - args:\n        - /usr/local/bin/launch-opflexserver.sh\n        command:\n        - /bin/sh\n        image: noirolabs/opflex:ci_test\n        imagePullPolicy: Always\n        name: opflex-server\n        ports:\n        - containerPort: 19999\n        - containerPort: 9632\n          name: metrics\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /usr/local/etc/opflex-server\n          name: opflex-server-config-volume\n        - mountPath: /usr/local/var\n          name: hostvar\n        resources:\n          limits:\n            cpu: 500m\n            memory: 256Mi\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      initContainers:\n      - image: noirolabs/cnideploy:6.0.0.0.0ef4718\n        imagePullPolicy: Always\n        name: cnideploy\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /mnt/cni-bin\n          name: cni-bin\n        resources:\n          limits:\n            cpu: 500m\n            memory: 256Mi\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      serviceAccountName: aci-containers-host-agent\n      volumes:\n      - emptyDir: {}\n        name: cni-bin\n      - emptyDir: {}\n        name: cni-conf\n      - emptyDir: {}\n        name: hostvar\n      - emptyDir: {}\n        name: hostrun\n      - configMap:\n          items:\n          - key: host-agent-config\n            path: host-agent.conf\n          name: aci-containers-config\n        name: host-config-volume\n      - emptyDir:\n          medium: Memory\n        name: opflex-hostconfig-volume\n      - configMap:\n          items:\n          - key: opflex-agent-config\n            path: local.conf\n          name: aci-containers-config\n        name: opflex-config-volume\n      - emptyDir: {}\n        name: opflex-server-config-volume\n",
    "errors": []
  },
  {
    "id": "04731",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  labels:\n    aci-containers-config-version: dummy\n    network-plugin: aci-containers\n  name: aci-containers-host\n  namespace: aci-containers-system\nspec:\n  selector:\n    matchLabels:\n      name: aci-containers-host\n      network-plugin: aci-containers\n  template:\n    metadata:\n      annotations:\n        prometheus.io/port: '9612'\n        prometheus.io/scrape: 'true'\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n      labels:\n        name: aci-containers-host\n        network-plugin: aci-containers\n    spec:\n      containers:\n      - env:\n        - name: KUBERNETES_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: TENANT\n          value: csrtest\n        - name: NODE_EPG\n          value: aci-containers-nodes\n        - name: OPFLEX_MODE\n          value: overlay\n        - name: DURATION_WAIT_FOR_NETWORK\n          value: '210'\n        image: noirolabs/aci-containers-host:ci_test\n        imagePullPolicy: Always\n        livenessProbe:\n          failureThreshold: 10\n          httpGet:\n            path: /status\n            port: 8090\n            scheme: HTTP\n          initialDelaySeconds: 120\n          periodSeconds: 60\n          successThreshold: 1\n          timeoutSeconds: 30\n        name: aci-containers-host\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /mnt/cni-bin\n          name: cni-bin\n        - mountPath: /mnt/cni-conf\n          name: cni-conf\n        - mountPath: /usr/local/var\n          name: hostvar\n        - mountPath: /run\n          name: hostrun\n        - mountPath: /usr/local/run\n          name: hostrun\n        - mountPath: /usr/local/etc/opflex-agent-ovs/base-conf.d\n          name: opflex-hostconfig-volume\n        - mountPath: /usr/local/etc/aci-containers/\n          name: host-config-volume\n        resources:\n          limits:\n            cpu: 500m\n            memory: 256Mi\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      - env:\n        - name: REBOOT_WITH_OVS\n          value: 'true'\n        - name: SSL_MODE\n          value: disabled\n        image: noirolabs/opflex:ci_test\n        imagePullPolicy: Always\n        name: opflex-agent\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /usr/local/var\n          name: hostvar\n        - mountPath: /run\n          name: hostrun\n        - mountPath: /usr/local/run\n          name: hostrun\n        - mountPath: /usr/local/etc/opflex-agent-ovs/base-conf.d\n          name: opflex-hostconfig-volume\n        - mountPath: /usr/local/etc/opflex-agent-ovs/conf.d\n          name: opflex-config-volume\n        resources:\n          limits:\n            cpu: 500m\n            memory: 256Mi\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      - args:\n        - /usr/local/bin/launch-opflexserver.sh\n        command:\n        - /bin/sh\n        image: noirolabs/opflex:ci_test\n        imagePullPolicy: Always\n        name: opflex-server\n        ports:\n        - containerPort: 19999\n        - containerPort: 9632\n          name: metrics\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /usr/local/etc/opflex-server\n          name: opflex-server-config-volume\n        - mountPath: /usr/local/var\n          name: hostvar\n        resources:\n          limits:\n            cpu: 500m\n            memory: 256Mi\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      initContainers:\n      - image: noirolabs/cnideploy:6.0.0.0.0ef4718\n        imagePullPolicy: Always\n        name: cnideploy\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /mnt/cni-bin\n          name: cni-bin\n        resources:\n          limits:\n            cpu: 500m\n            memory: 256Mi\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      serviceAccountName: aci-containers-host-agent\n      volumes:\n      - emptyDir: {}\n        name: cni-bin\n      - emptyDir: {}\n        name: cni-conf\n      - emptyDir: {}\n        name: hostvar\n      - emptyDir: {}\n        name: hostrun\n      - configMap:\n          items:\n          - key: host-agent-config\n            path: host-agent.conf\n          name: aci-containers-config\n        name: host-config-volume\n      - emptyDir:\n          medium: Memory\n        name: opflex-hostconfig-volume\n      - configMap:\n          items:\n          - key: opflex-agent-config\n            path: local.conf\n          name: aci-containers-config\n        name: opflex-config-volume\n      - emptyDir: {}\n        name: opflex-server-config-volume\n",
    "errors": []
  },
  {
    "id": "04732",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-5267\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    securityContext:\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      privileged: false\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n      readOnlyRootFilesystem: true\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "04733",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-5267\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    securityContext:\n      readOnlyRootFilesystem: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "04734",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-5267\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    securityContext:\n      runAsNonRoot: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      readOnlyRootFilesystem: true\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "04735",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-5267\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n      readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "04736",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-5267\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n      readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "04737",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: myapp-pod\n  labels:\n    app: myapp\nspec:\n  containers:\n  - name: nginx-container\n    image: nginx:stable\n    resources:\n      limits:\n        memory: 128Mi\n        cpu: 500m\n      requests:\n        cpu: 100m\n        memory: 128Mi\n    securityContext:\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      privileged: false\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n      readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "04738",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: myapp-pod\n  labels:\n    app: myapp\nspec:\n  containers:\n  - name: nginx-container\n    image: nginx:stable\n    resources:\n      limits:\n        memory: 128Mi\n        cpu: 500m\n      requests:\n        cpu: 100m\n        memory: 128Mi\n    securityContext:\n      readOnlyRootFilesystem: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "04739",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: myapp-pod\n  labels:\n    app: myapp\nspec:\n  containers:\n  - name: nginx-container\n    image: nginx:stable\n    resources:\n      limits:\n        memory: 128Mi\n        cpu: 500m\n      requests:\n        cpu: 100m\n        memory: 128Mi\n    securityContext:\n      runAsNonRoot: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "04740",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: myapp-pod\n  labels:\n    app: myapp\nspec:\n  containers:\n  - name: nginx-container\n    image: nginx:stable\n    resources:\n      limits:\n        memory: 256Mi\n        cpu: 500m\n      requests:\n        cpu: 100m\n        memory: 128Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n      readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "04741",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: needs-rebase\n  labels:\n    app: needs-rebase\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: needs-rebase\n  template:\n    metadata:\n      labels:\n        app: needs-rebase\n    spec:\n      containers:\n      - name: needs-rebase\n        image: gcr.io/k8s-prow/needs-rebase:v20210204-de2fa22b93\n        imagePullPolicy: Always\n        args:\n        - --dry-run=false\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        ports:\n        - name: http\n          containerPort: 8888\n        volumeMounts:\n        - name: hmac\n          mountPath: /etc/webhook\n          readOnly: true\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: plugins\n          mountPath: /etc/plugins\n          readOnly: true\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: hmac\n        secret:\n          secretName: hmac-token\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: plugins\n        configMap:\n          name: plugins\n",
    "errors": []
  },
  {
    "id": "04742",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: needs-rebase\n  labels:\n    app: needs-rebase\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: needs-rebase\n  template:\n    metadata:\n      labels:\n        app: needs-rebase\n    spec:\n      containers:\n      - name: needs-rebase\n        image: gcr.io/k8s-prow/needs-rebase:v20210204-de2fa22b93\n        imagePullPolicy: Always\n        args:\n        - --dry-run=false\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        ports:\n        - name: http\n          containerPort: 8888\n        volumeMounts:\n        - name: hmac\n          mountPath: /etc/webhook\n          readOnly: true\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: plugins\n          mountPath: /etc/plugins\n          readOnly: true\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: hmac\n        secret:\n          secretName: hmac-token\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: plugins\n        configMap:\n          name: plugins\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "04743",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: needs-rebase\n  labels:\n    app: needs-rebase\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: needs-rebase\n  template:\n    metadata:\n      labels:\n        app: needs-rebase\n    spec:\n      containers:\n      - name: needs-rebase\n        image: gcr.io/k8s-prow/needs-rebase:v20210204-de2fa22b93\n        imagePullPolicy: Always\n        args:\n        - --dry-run=false\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        ports:\n        - name: http\n          containerPort: 8888\n        volumeMounts:\n        - name: hmac\n          mountPath: /etc/webhook\n          readOnly: true\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: plugins\n          mountPath: /etc/plugins\n          readOnly: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: hmac\n        secret:\n          secretName: hmac-token\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: plugins\n        configMap:\n          name: plugins\n",
    "errors": []
  },
  {
    "id": "04744",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: needs-rebase\n  labels:\n    app: needs-rebase\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: needs-rebase\n  template:\n    metadata:\n      labels:\n        app: needs-rebase\n    spec:\n      containers:\n      - name: needs-rebase\n        image: gcr.io/k8s-prow/needs-rebase:v20210204-de2fa22b93\n        imagePullPolicy: Always\n        args:\n        - --dry-run=false\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        ports:\n        - name: http\n          containerPort: 8888\n        volumeMounts:\n        - name: hmac\n          mountPath: /etc/webhook\n          readOnly: true\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: plugins\n          mountPath: /etc/plugins\n          readOnly: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: hmac\n        secret:\n          secretName: hmac-token\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: plugins\n        configMap:\n          name: plugins\n",
    "errors": []
  },
  {
    "id": "04745",
    "policy_id": "env_var_secret",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: minio\n  labels:\n    app: minio\nspec:\n  selector:\n    matchLabels:\n      app: minio\n  template:\n    metadata:\n      labels:\n        app: minio\n    spec:\n      containers:\n      - name: minio\n        image: gcr.io/ml-pipeline/minio:RELEASE.2019-08-14T20-37-41Z-license-compliance\n        args:\n        - gateway\n        - gcs\n        - $(GCP_PROJECT_ID)\n        env:\n        - name: GCP_PROJECT_ID\n          valueFrom:\n            configMapKeyRef:\n              name: pipeline-install-config\n              key: gcsProjectId\n        - name: MINIO_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: minio-secret\n              key: access-key\n        - name: MINIO_SECRET_KEY\n          valueFrom:\n            secretKeyRef:\n              name: minio-secret-key-secret\n              key: minio_secret_key\n        ports:\n        - containerPort: 9000\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "04746",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: minio\n  labels:\n    app: minio\nspec:\n  selector:\n    matchLabels:\n      app: minio\n  template:\n    metadata:\n      labels:\n        app: minio\n    spec:\n      containers:\n      - name: minio\n        image: gcr.io/ml-pipeline/minio:RELEASE.2019-08-14T20-37-41Z-license-compliance\n        args:\n        - gateway\n        - gcs\n        - $(GCP_PROJECT_ID)\n        env:\n        - name: GCP_PROJECT_ID\n          valueFrom:\n            configMapKeyRef:\n              name: pipeline-install-config\n              key: gcsProjectId\n        - name: MINIO_ACCESS_KEY\n          value: minio\n        - name: MINIO_SECRET_KEY\n          valueFrom:\n            secretKeyRef:\n              name: minio-secret-key-secret\n              key: minio_secret_key\n        ports:\n        - containerPort: 9000\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "04747",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: minio\n  labels:\n    app: minio\nspec:\n  selector:\n    matchLabels:\n      app: minio\n  template:\n    metadata:\n      labels:\n        app: minio\n    spec:\n      containers:\n      - name: minio\n        image: gcr.io/ml-pipeline/minio:RELEASE.2019-08-14T20-37-41Z-license-compliance\n        args:\n        - gateway\n        - gcs\n        - $(GCP_PROJECT_ID)\n        env:\n        - name: GCP_PROJECT_ID\n          valueFrom:\n            configMapKeyRef:\n              name: pipeline-install-config\n              key: gcsProjectId\n        - name: MINIO_ACCESS_KEY\n          value: minio\n        - name: MINIO_SECRET_KEY\n          valueFrom:\n            secretKeyRef:\n              name: minio-secret-key-secret\n              key: minio_secret_key\n        ports:\n        - containerPort: 9000\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "04748",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: minio\n  labels:\n    app: minio\nspec:\n  selector:\n    matchLabels:\n      app: minio\n  template:\n    metadata:\n      labels:\n        app: minio\n    spec:\n      containers:\n      - name: minio\n        image: gcr.io/ml-pipeline/minio:RELEASE.2019-08-14T20-37-41Z-license-compliance\n        args:\n        - gateway\n        - gcs\n        - $(GCP_PROJECT_ID)\n        env:\n        - name: GCP_PROJECT_ID\n          valueFrom:\n            configMapKeyRef:\n              name: pipeline-install-config\n              key: gcsProjectId\n        - name: MINIO_ACCESS_KEY\n          value: minio\n        - name: MINIO_SECRET_KEY\n          valueFrom:\n            secretKeyRef:\n              name: minio-secret-key-secret\n              key: minio_secret_key\n        ports:\n        - containerPort: 9000\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "04749",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: minio\n  labels:\n    app: minio\nspec:\n  selector:\n    matchLabels:\n      app: minio\n  template:\n    metadata:\n      labels:\n        app: minio\n    spec:\n      containers:\n      - name: minio\n        image: gcr.io/ml-pipeline/minio:RELEASE.2019-08-14T20-37-41Z-license-compliance\n        args:\n        - gateway\n        - gcs\n        - $(GCP_PROJECT_ID)\n        env:\n        - name: GCP_PROJECT_ID\n          valueFrom:\n            configMapKeyRef:\n              name: pipeline-install-config\n              key: gcsProjectId\n        - name: MINIO_ACCESS_KEY\n          value: minio\n        - name: MINIO_SECRET_KEY\n          valueFrom:\n            secretKeyRef:\n              name: minio-secret-key-secret\n              key: minio_secret_key\n        ports:\n        - containerPort: 9000\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "04750",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: CronJob\nmetadata:\n  name: prod-cron-cancel-booking\nspec:\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          containers:\n          - name: cron-cancel-booking\n            image: 414928843086.dkr.ecr.ap-southeast-1.amazonaws.com/core-api-v2:<VERSION>\n            imagePullPolicy: Always\n            args:\n            - run\n            - start-cron:cancel-booking:prod\n            env:\n            - name: NODE_ENV\n              value: production\n            - name: PORT\n              value: '3000'\n            - name: HOST\n              value: 0.0.0.0\n            - name: DB_DIALECT\n              valueFrom:\n                secretKeyRef:\n                  key: DB_DIALECT\n                  name: core-api\n            - name: DB_PORT\n              valueFrom:\n                secretKeyRef:\n                  key: DB_PORT\n                  name: core-api\n            - name: DB_HOST\n              valueFrom:\n                secretKeyRef:\n                  key: DB_HOST\n                  name: core-api\n            - name: DB_USERNAME\n              valueFrom:\n                secretKeyRef:\n                  key: DB_USERNAME\n                  name: core-api\n            - name: DB_PASSWORD\n              valueFrom:\n                secretKeyRef:\n                  key: DB_PASSWORD\n                  name: core-api\n            - name: DB_NAME\n              valueFrom:\n                secretKeyRef:\n                  key: DB_NAME\n                  name: core-api\n            - name: JWT_SECRET\n              valueFrom:\n                secretKeyRef:\n                  key: JWT_SECRET\n                  name: core-api\n            - name: JWT_EXPIRATION\n              valueFrom:\n                secretKeyRef:\n                  key: JWT_EXPIRATION\n                  name: core-api\n            - name: DEFAULT_COMMISSION\n              valueFrom:\n                secretKeyRef:\n                  key: DEFAULT_COMMISSION\n                  name: core-api\n            - name: TERMINATION_NOTICE_DAYS\n              valueFrom:\n                secretKeyRef:\n                  key: TERMINATION_NOTICE_DAYS\n                  name: core-api\n            - name: FILTER_BY_STOCK_URL\n              valueFrom:\n                secretKeyRef:\n                  name: core-api\n                  key: FILTER_BY_STOCK_URL\n            - name: TWILIO_ACCOUNT_SID\n              valueFrom:\n                secretKeyRef:\n                  key: TWILIO_ACCOUNT_SID\n                  name: twilio-secret\n            - name: TWILIO_AUTH_TOKEN\n              valueFrom:\n                secretKeyRef:\n                  key: TWILIO_AUTH_TOKEN\n                  name: twilio-secret\n            - name: TWILIO_SENDER_PHONE\n              valueFrom:\n                secretKeyRef:\n                  key: TWILIO_SENDER_PHONE\n                  name: twilio-secret\n            - name: AWS_S3_ACCESS_KEY\n              valueFrom:\n                secretKeyRef:\n                  key: AWS_S3_ACCESS_KEY\n                  name: aws-secret\n            - name: AWS_S3_SECRET_ACCESS_KEY\n              valueFrom:\n                secretKeyRef:\n                  key: AWS_S3_SECRET_ACCESS_KEY\n                  name: aws-secret\n            - name: AWS_S3_REGION\n              valueFrom:\n                secretKeyRef:\n                  key: AWS_S3_REGION\n                  name: aws-secret\n            - name: AWS_S3_BUCKET_NAME\n              valueFrom:\n                secretKeyRef:\n                  key: AWS_S3_BUCKET_NAME\n                  name: aws-secret\n            - name: AWS_S3_BUCKET_URL\n              valueFrom:\n                secretKeyRef:\n                  key: AWS_S3_BUCKET_URL\n                  name: aws-secret\n            - name: DEFAULT_RESIZE_WIDTH\n              valueFrom:\n                secretKeyRef:\n                  key: DEFAULT_RESIZE_WIDTH\n                  name: aws-secret\n            - name: SUPPORT_MIME_TYPE\n              valueFrom:\n                secretKeyRef:\n                  key: SUPPORT_MIME_TYPE\n                  name: aws-secret\n            - name: SENDGRID_API_KEY\n              valueFrom:\n                secretKeyRef:\n                  key: SENDGRID_API_KEY\n                  name: core-api\n            - name: REFRESH_TOKEN_EXPIRATION\n              valueFrom:\n                secretKeyRef:\n                  key: REFRESH_TOKEN_EXPIRATION\n                  name: core-api\n            - name: GOOGLE_CLIENT_ID\n              valueFrom:\n                secretKeyRef:\n                  key: GOOGLE_CLIENT_ID\n                  name: google-secret\n            - name: GOOGLE_CLIENT_SECRET\n              valueFrom:\n                secretKeyRef:\n                  key: GOOGLE_CLIENT_SECRET\n                  name: google-secret\n            - name: GOOGLE_CALLBACK_URL\n              valueFrom:\n                secretKeyRef:\n                  key: GOOGLE_CALLBACK_URL\n                  name: google-secret\n            - name: CLIENT_BASE_URL\n              valueFrom:\n                secretKeyRef:\n                  key: CLIENT_BASE_URL\n                  name: google-secret\n            - name: STRIPE_SECRET_KEY\n              valueFrom:\n                secretKeyRef:\n                  key: STRIPE_SECRET_KEY\n                  name: stripe-secret\n            - name: FACEBOOK_CLIENT_ID\n              valueFrom:\n                secretKeyRef:\n                  key: FACEBOOK_CLIENT_ID\n                  name: facebook-secret\n            - name: FACEBOOK_CLIENT_SECRET\n              valueFrom:\n                secretKeyRef:\n                  key: FACEBOOK_CLIENT_SECRET\n                  name: facebook-secret\n            - name: FACEBOOK_CALLBACK_URL\n              valueFrom:\n                secretKeyRef:\n                  key: FACEBOOK_CALLBACK_URL\n                  name: facebook-secret\n            - name: SITE_LINK_LOGIN_URL\n              valueFrom:\n                secretKeyRef:\n                  key: SITE_LINK_LOGIN_URL\n                  name: sitelink-secret\n            - name: SITE_LINK_UNITS_URL\n              valueFrom:\n                secretKeyRef:\n                  key: SITE_LINK_UNITS_URL\n                  name: sitelink-secret\n            - name: SITE_LINK_USER\n              valueFrom:\n                secretKeyRef:\n                  key: SITE_LINK_USER\n                  name: sitelink-secret\n            - name: SITE_LINK_PASS\n              valueFrom:\n                secretKeyRef:\n                  key: SITE_LINK_PASS\n                  name: sitelink-secret\n            - name: SITE_LINK_CODE\n              valueFrom:\n                secretKeyRef:\n                  key: SITE_LINK_CODE\n                  name: sitelink-secret\n            - name: SITE_LINK_COMMISSION_PERCENT\n              valueFrom:\n                secretKeyRef:\n                  key: SITE_LINK_COMMISSION_PERCENT\n                  name: sitelink-secret\n            - name: SITE_LINK_SITES_URL\n              valueFrom:\n                secretKeyRef:\n                  key: SITE_LINK_SITES_URL\n                  name: sitelink-secret\n            - name: BROWSER_URL\n              valueFrom:\n                secretKeyRef:\n                  key: BROWSERLESS_URL\n                  name: sitelink-secret\n            - name: GOGOX_CLIENT_ID\n              valueFrom:\n                secretKeyRef:\n                  name: gogox-secret\n                  key: GOGOX_CLIENT_ID\n            - name: GOGOX_CLIENT_SECRET\n              valueFrom:\n                secretKeyRef:\n                  name: gogox-secret\n                  key: GOGOX_CLIENT_SECRET\n            - name: GOGOX_API_URL\n              valueFrom:\n                secretKeyRef:\n                  name: gogox-secret\n                  key: GOGOX_API_URL\n            - name: YOTPO_API_KEY\n              valueFrom:\n                secretKeyRef:\n                  name: yotpo-secret\n                  key: YOTPO_API_KEY\n            - name: YOTPO_API_SECRET\n              valueFrom:\n                secretKeyRef:\n                  name: yotpo-secret\n                  key: YOTPO_API_SECRET\n            - name: SITE_LINK_USER_JWD\n              valueFrom:\n                secretKeyRef:\n                  name: sitelink-secret\n                  key: SITE_LINK_USER_JWD\n            - name: SITE_LINK_PASS_JWD\n              valueFrom:\n                secretKeyRef:\n                  name: sitelink-secret\n                  key: SITE_LINK_PASS_JWD\n            - name: SITE_LINK_CODE_JWD\n              valueFrom:\n                secretKeyRef:\n                  name: sitelink-secret\n                  key: SITE_LINK_CODE_JWD\n            - name: SITE_LINK_LOCATION_JWD\n              valueFrom:\n                secretKeyRef:\n                  name: sitelink-secret\n                  key: SITE_LINK_LOCATION_JWD\n            - name: RABBITMQ_URL\n              valueFrom:\n                secretKeyRef:\n                  name: site-stock-service\n                  key: RABBITMQ_URL\n            - name: SND_EXCHANGE\n              valueFrom:\n                secretKeyRef:\n                  name: site-stock-service\n                  key: SND_EXCHANGE\n            - name: SND_UPDATE_ES_KEY\n              valueFrom:\n                secretKeyRef:\n                  name: site-stock-service\n                  key: SND_UPDATE_ES_KEY\n            - name: SND_UPDATE_STOCK_KEY\n              valueFrom:\n                secretKeyRef:\n                  name: site-stock-service\n                  key: SND_UPDATE_STOCK_KEY\n            - name: CLEVERTAP_ACCOUNT_ID\n              valueFrom:\n                secretKeyRef:\n                  name: clevertap-secret\n                  key: CLEVERTAP_ACCOUNT_ID\n            - name: CLEVERTAP_ACCOUNT_PASSCODE\n              valueFrom:\n                secretKeyRef:\n                  name: clevertap-secret\n                  key: CLEVERTAP_ACCOUNT_PASSCODE\n            securityContext:\n              readOnlyRootFilesystem: true\n              privileged: false\n              capabilities:\n                drop:\n                - NET_RAW\n                - NET_ADMIN\n                - SYS_ADMIN\n                - SYS_MODULE\n                - SYS_PTRACE\n                - SYS_CHROOT\n              allowPrivilegeEscalation: false\n              runAsNonRoot: true\n            resources:\n              requests:\n                cpu: 100m\n                memory: 128Mi\n              limits:\n                cpu: 500m\n                memory: 256Mi\n          restartPolicy: OnFailure\n  schedule: 0 0 * * *\n",
    "errors": []
  },
  {
    "id": "04751",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: CronJob\nmetadata:\n  name: prod-cron-cancel-booking\nspec:\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          containers:\n          - name: cron-cancel-booking\n            image: 414928843086.dkr.ecr.ap-southeast-1.amazonaws.com/core-api-v2:<VERSION>\n            imagePullPolicy: Always\n            args:\n            - run\n            - start-cron:cancel-booking:prod\n            env:\n            - name: NODE_ENV\n              value: production\n            - name: PORT\n              value: '3000'\n            - name: HOST\n              value: 0.0.0.0\n            - name: DB_DIALECT\n              valueFrom:\n                secretKeyRef:\n                  key: DB_DIALECT\n                  name: core-api\n            - name: DB_PORT\n              valueFrom:\n                secretKeyRef:\n                  key: DB_PORT\n                  name: core-api\n            - name: DB_HOST\n              valueFrom:\n                secretKeyRef:\n                  key: DB_HOST\n                  name: core-api\n            - name: DB_USERNAME\n              valueFrom:\n                secretKeyRef:\n                  key: DB_USERNAME\n                  name: core-api\n            - name: DB_PASSWORD\n              valueFrom:\n                secretKeyRef:\n                  key: DB_PASSWORD\n                  name: core-api\n            - name: DB_NAME\n              valueFrom:\n                secretKeyRef:\n                  key: DB_NAME\n                  name: core-api\n            - name: JWT_SECRET\n              valueFrom:\n                secretKeyRef:\n                  key: JWT_SECRET\n                  name: core-api\n            - name: JWT_EXPIRATION\n              valueFrom:\n                secretKeyRef:\n                  key: JWT_EXPIRATION\n                  name: core-api\n            - name: DEFAULT_COMMISSION\n              valueFrom:\n                secretKeyRef:\n                  key: DEFAULT_COMMISSION\n                  name: core-api\n            - name: TERMINATION_NOTICE_DAYS\n              valueFrom:\n                secretKeyRef:\n                  key: TERMINATION_NOTICE_DAYS\n                  name: core-api\n            - name: FILTER_BY_STOCK_URL\n              valueFrom:\n                secretKeyRef:\n                  name: core-api\n                  key: FILTER_BY_STOCK_URL\n            - name: TWILIO_ACCOUNT_SID\n              valueFrom:\n                secretKeyRef:\n                  key: TWILIO_ACCOUNT_SID\n                  name: twilio-secret\n            - name: TWILIO_AUTH_TOKEN\n              valueFrom:\n                secretKeyRef:\n                  key: TWILIO_AUTH_TOKEN\n                  name: twilio-secret\n            - name: TWILIO_SENDER_PHONE\n              valueFrom:\n                secretKeyRef:\n                  key: TWILIO_SENDER_PHONE\n                  name: twilio-secret\n            - name: AWS_S3_ACCESS_KEY\n              valueFrom:\n                secretKeyRef:\n                  key: AWS_S3_ACCESS_KEY\n                  name: aws-secret\n            - name: AWS_S3_SECRET_ACCESS_KEY\n              valueFrom:\n                secretKeyRef:\n                  key: AWS_S3_SECRET_ACCESS_KEY\n                  name: aws-secret\n            - name: AWS_S3_REGION\n              valueFrom:\n                secretKeyRef:\n                  key: AWS_S3_REGION\n                  name: aws-secret\n            - name: AWS_S3_BUCKET_NAME\n              valueFrom:\n                secretKeyRef:\n                  key: AWS_S3_BUCKET_NAME\n                  name: aws-secret\n            - name: AWS_S3_BUCKET_URL\n              valueFrom:\n                secretKeyRef:\n                  key: AWS_S3_BUCKET_URL\n                  name: aws-secret\n            - name: DEFAULT_RESIZE_WIDTH\n              valueFrom:\n                secretKeyRef:\n                  key: DEFAULT_RESIZE_WIDTH\n                  name: aws-secret\n            - name: SUPPORT_MIME_TYPE\n              valueFrom:\n                secretKeyRef:\n                  key: SUPPORT_MIME_TYPE\n                  name: aws-secret\n            - name: SENDGRID_API_KEY\n              valueFrom:\n                secretKeyRef:\n                  key: SENDGRID_API_KEY\n                  name: core-api\n            - name: REFRESH_TOKEN_EXPIRATION\n              valueFrom:\n                secretKeyRef:\n                  key: REFRESH_TOKEN_EXPIRATION\n                  name: core-api\n            - name: GOOGLE_CLIENT_ID\n              valueFrom:\n                secretKeyRef:\n                  key: GOOGLE_CLIENT_ID\n                  name: google-secret\n            - name: GOOGLE_CLIENT_SECRET\n              valueFrom:\n                secretKeyRef:\n                  key: GOOGLE_CLIENT_SECRET\n                  name: google-secret\n            - name: GOOGLE_CALLBACK_URL\n              valueFrom:\n                secretKeyRef:\n                  key: GOOGLE_CALLBACK_URL\n                  name: google-secret\n            - name: CLIENT_BASE_URL\n              valueFrom:\n                secretKeyRef:\n                  key: CLIENT_BASE_URL\n                  name: google-secret\n            - name: STRIPE_SECRET_KEY\n              valueFrom:\n                secretKeyRef:\n                  key: STRIPE_SECRET_KEY\n                  name: stripe-secret\n            - name: FACEBOOK_CLIENT_ID\n              valueFrom:\n                secretKeyRef:\n                  key: FACEBOOK_CLIENT_ID\n                  name: facebook-secret\n            - name: FACEBOOK_CLIENT_SECRET\n              valueFrom:\n                secretKeyRef:\n                  key: FACEBOOK_CLIENT_SECRET\n                  name: facebook-secret\n            - name: FACEBOOK_CALLBACK_URL\n              valueFrom:\n                secretKeyRef:\n                  key: FACEBOOK_CALLBACK_URL\n                  name: facebook-secret\n            - name: SITE_LINK_LOGIN_URL\n              valueFrom:\n                secretKeyRef:\n                  key: SITE_LINK_LOGIN_URL\n                  name: sitelink-secret\n            - name: SITE_LINK_UNITS_URL\n              valueFrom:\n                secretKeyRef:\n                  key: SITE_LINK_UNITS_URL\n                  name: sitelink-secret\n            - name: SITE_LINK_USER\n              valueFrom:\n                secretKeyRef:\n                  key: SITE_LINK_USER\n                  name: sitelink-secret\n            - name: SITE_LINK_PASS\n              valueFrom:\n                secretKeyRef:\n                  key: SITE_LINK_PASS\n                  name: sitelink-secret\n            - name: SITE_LINK_CODE\n              valueFrom:\n                secretKeyRef:\n                  key: SITE_LINK_CODE\n                  name: sitelink-secret\n            - name: SITE_LINK_COMMISSION_PERCENT\n              valueFrom:\n                secretKeyRef:\n                  key: SITE_LINK_COMMISSION_PERCENT\n                  name: sitelink-secret\n            - name: SITE_LINK_SITES_URL\n              valueFrom:\n                secretKeyRef:\n                  key: SITE_LINK_SITES_URL\n                  name: sitelink-secret\n            - name: BROWSER_URL\n              valueFrom:\n                secretKeyRef:\n                  key: BROWSERLESS_URL\n                  name: sitelink-secret\n            - name: GOGOX_CLIENT_ID\n              valueFrom:\n                secretKeyRef:\n                  name: gogox-secret\n                  key: GOGOX_CLIENT_ID\n            - name: GOGOX_CLIENT_SECRET\n              valueFrom:\n                secretKeyRef:\n                  name: gogox-secret\n                  key: GOGOX_CLIENT_SECRET\n            - name: GOGOX_API_URL\n              valueFrom:\n                secretKeyRef:\n                  name: gogox-secret\n                  key: GOGOX_API_URL\n            - name: YOTPO_API_KEY\n              valueFrom:\n                secretKeyRef:\n                  name: yotpo-secret\n                  key: YOTPO_API_KEY\n            - name: YOTPO_API_SECRET\n              valueFrom:\n                secretKeyRef:\n                  name: yotpo-secret\n                  key: YOTPO_API_SECRET\n            - name: SITE_LINK_USER_JWD\n              valueFrom:\n                secretKeyRef:\n                  name: sitelink-secret\n                  key: SITE_LINK_USER_JWD\n            - name: SITE_LINK_PASS_JWD\n              valueFrom:\n                secretKeyRef:\n                  name: sitelink-secret\n                  key: SITE_LINK_PASS_JWD\n            - name: SITE_LINK_CODE_JWD\n              valueFrom:\n                secretKeyRef:\n                  name: sitelink-secret\n                  key: SITE_LINK_CODE_JWD\n            - name: SITE_LINK_LOCATION_JWD\n              valueFrom:\n                secretKeyRef:\n                  name: sitelink-secret\n                  key: SITE_LINK_LOCATION_JWD\n            - name: RABBITMQ_URL\n              valueFrom:\n                secretKeyRef:\n                  name: site-stock-service\n                  key: RABBITMQ_URL\n            - name: SND_EXCHANGE\n              valueFrom:\n                secretKeyRef:\n                  name: site-stock-service\n                  key: SND_EXCHANGE\n            - name: SND_UPDATE_ES_KEY\n              valueFrom:\n                secretKeyRef:\n                  name: site-stock-service\n                  key: SND_UPDATE_ES_KEY\n            - name: SND_UPDATE_STOCK_KEY\n              valueFrom:\n                secretKeyRef:\n                  name: site-stock-service\n                  key: SND_UPDATE_STOCK_KEY\n            - name: CLEVERTAP_ACCOUNT_ID\n              valueFrom:\n                secretKeyRef:\n                  name: clevertap-secret\n                  key: CLEVERTAP_ACCOUNT_ID\n            - name: CLEVERTAP_ACCOUNT_PASSCODE\n              valueFrom:\n                secretKeyRef:\n                  name: clevertap-secret\n                  key: CLEVERTAP_ACCOUNT_PASSCODE\n            securityContext:\n              runAsNonRoot: true\n              privileged: false\n              capabilities:\n                drop:\n                - NET_RAW\n                - NET_ADMIN\n                - SYS_ADMIN\n                - SYS_MODULE\n                - SYS_PTRACE\n                - SYS_CHROOT\n              allowPrivilegeEscalation: false\n              readOnlyRootFilesystem: true\n            resources:\n              requests:\n                cpu: 100m\n                memory: 128Mi\n              limits:\n                cpu: 500m\n                memory: 256Mi\n          restartPolicy: OnFailure\n  schedule: 0 0 * * *\n",
    "errors": []
  },
  {
    "id": "04752",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: CronJob\nmetadata:\n  name: prod-cron-cancel-booking\nspec:\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          containers:\n          - name: cron-cancel-booking\n            image: 414928843086.dkr.ecr.ap-southeast-1.amazonaws.com/core-api-v2:<VERSION>\n            imagePullPolicy: Always\n            args:\n            - run\n            - start-cron:cancel-booking:prod\n            env:\n            - name: NODE_ENV\n              value: production\n            - name: PORT\n              value: '3000'\n            - name: HOST\n              value: 0.0.0.0\n            - name: DB_DIALECT\n              valueFrom:\n                secretKeyRef:\n                  key: DB_DIALECT\n                  name: core-api\n            - name: DB_PORT\n              valueFrom:\n                secretKeyRef:\n                  key: DB_PORT\n                  name: core-api\n            - name: DB_HOST\n              valueFrom:\n                secretKeyRef:\n                  key: DB_HOST\n                  name: core-api\n            - name: DB_USERNAME\n              valueFrom:\n                secretKeyRef:\n                  key: DB_USERNAME\n                  name: core-api\n            - name: DB_PASSWORD\n              valueFrom:\n                secretKeyRef:\n                  key: DB_PASSWORD\n                  name: core-api\n            - name: DB_NAME\n              valueFrom:\n                secretKeyRef:\n                  key: DB_NAME\n                  name: core-api\n            - name: JWT_SECRET\n              valueFrom:\n                secretKeyRef:\n                  key: JWT_SECRET\n                  name: core-api\n            - name: JWT_EXPIRATION\n              valueFrom:\n                secretKeyRef:\n                  key: JWT_EXPIRATION\n                  name: core-api\n            - name: DEFAULT_COMMISSION\n              valueFrom:\n                secretKeyRef:\n                  key: DEFAULT_COMMISSION\n                  name: core-api\n            - name: TERMINATION_NOTICE_DAYS\n              valueFrom:\n                secretKeyRef:\n                  key: TERMINATION_NOTICE_DAYS\n                  name: core-api\n            - name: FILTER_BY_STOCK_URL\n              valueFrom:\n                secretKeyRef:\n                  name: core-api\n                  key: FILTER_BY_STOCK_URL\n            - name: TWILIO_ACCOUNT_SID\n              valueFrom:\n                secretKeyRef:\n                  key: TWILIO_ACCOUNT_SID\n                  name: twilio-secret\n            - name: TWILIO_AUTH_TOKEN\n              valueFrom:\n                secretKeyRef:\n                  key: TWILIO_AUTH_TOKEN\n                  name: twilio-secret\n            - name: TWILIO_SENDER_PHONE\n              valueFrom:\n                secretKeyRef:\n                  key: TWILIO_SENDER_PHONE\n                  name: twilio-secret\n            - name: AWS_S3_ACCESS_KEY\n              valueFrom:\n                secretKeyRef:\n                  key: AWS_S3_ACCESS_KEY\n                  name: aws-secret\n            - name: AWS_S3_SECRET_ACCESS_KEY\n              valueFrom:\n                secretKeyRef:\n                  key: AWS_S3_SECRET_ACCESS_KEY\n                  name: aws-secret\n            - name: AWS_S3_REGION\n              valueFrom:\n                secretKeyRef:\n                  key: AWS_S3_REGION\n                  name: aws-secret\n            - name: AWS_S3_BUCKET_NAME\n              valueFrom:\n                secretKeyRef:\n                  key: AWS_S3_BUCKET_NAME\n                  name: aws-secret\n            - name: AWS_S3_BUCKET_URL\n              valueFrom:\n                secretKeyRef:\n                  key: AWS_S3_BUCKET_URL\n                  name: aws-secret\n            - name: DEFAULT_RESIZE_WIDTH\n              valueFrom:\n                secretKeyRef:\n                  key: DEFAULT_RESIZE_WIDTH\n                  name: aws-secret\n            - name: SUPPORT_MIME_TYPE\n              valueFrom:\n                secretKeyRef:\n                  key: SUPPORT_MIME_TYPE\n                  name: aws-secret\n            - name: SENDGRID_API_KEY\n              valueFrom:\n                secretKeyRef:\n                  key: SENDGRID_API_KEY\n                  name: core-api\n            - name: REFRESH_TOKEN_EXPIRATION\n              valueFrom:\n                secretKeyRef:\n                  key: REFRESH_TOKEN_EXPIRATION\n                  name: core-api\n            - name: GOOGLE_CLIENT_ID\n              valueFrom:\n                secretKeyRef:\n                  key: GOOGLE_CLIENT_ID\n                  name: google-secret\n            - name: GOOGLE_CLIENT_SECRET\n              valueFrom:\n                secretKeyRef:\n                  key: GOOGLE_CLIENT_SECRET\n                  name: google-secret\n            - name: GOOGLE_CALLBACK_URL\n              valueFrom:\n                secretKeyRef:\n                  key: GOOGLE_CALLBACK_URL\n                  name: google-secret\n            - name: CLIENT_BASE_URL\n              valueFrom:\n                secretKeyRef:\n                  key: CLIENT_BASE_URL\n                  name: google-secret\n            - name: STRIPE_SECRET_KEY\n              valueFrom:\n                secretKeyRef:\n                  key: STRIPE_SECRET_KEY\n                  name: stripe-secret\n            - name: FACEBOOK_CLIENT_ID\n              valueFrom:\n                secretKeyRef:\n                  key: FACEBOOK_CLIENT_ID\n                  name: facebook-secret\n            - name: FACEBOOK_CLIENT_SECRET\n              valueFrom:\n                secretKeyRef:\n                  key: FACEBOOK_CLIENT_SECRET\n                  name: facebook-secret\n            - name: FACEBOOK_CALLBACK_URL\n              valueFrom:\n                secretKeyRef:\n                  key: FACEBOOK_CALLBACK_URL\n                  name: facebook-secret\n            - name: SITE_LINK_LOGIN_URL\n              valueFrom:\n                secretKeyRef:\n                  key: SITE_LINK_LOGIN_URL\n                  name: sitelink-secret\n            - name: SITE_LINK_UNITS_URL\n              valueFrom:\n                secretKeyRef:\n                  key: SITE_LINK_UNITS_URL\n                  name: sitelink-secret\n            - name: SITE_LINK_USER\n              valueFrom:\n                secretKeyRef:\n                  key: SITE_LINK_USER\n                  name: sitelink-secret\n            - name: SITE_LINK_PASS\n              valueFrom:\n                secretKeyRef:\n                  key: SITE_LINK_PASS\n                  name: sitelink-secret\n            - name: SITE_LINK_CODE\n              valueFrom:\n                secretKeyRef:\n                  key: SITE_LINK_CODE\n                  name: sitelink-secret\n            - name: SITE_LINK_COMMISSION_PERCENT\n              valueFrom:\n                secretKeyRef:\n                  key: SITE_LINK_COMMISSION_PERCENT\n                  name: sitelink-secret\n            - name: SITE_LINK_SITES_URL\n              valueFrom:\n                secretKeyRef:\n                  key: SITE_LINK_SITES_URL\n                  name: sitelink-secret\n            - name: BROWSER_URL\n              valueFrom:\n                secretKeyRef:\n                  key: BROWSERLESS_URL\n                  name: sitelink-secret\n            - name: GOGOX_CLIENT_ID\n              valueFrom:\n                secretKeyRef:\n                  name: gogox-secret\n                  key: GOGOX_CLIENT_ID\n            - name: GOGOX_CLIENT_SECRET\n              valueFrom:\n                secretKeyRef:\n                  name: gogox-secret\n                  key: GOGOX_CLIENT_SECRET\n            - name: GOGOX_API_URL\n              valueFrom:\n                secretKeyRef:\n                  name: gogox-secret\n                  key: GOGOX_API_URL\n            - name: YOTPO_API_KEY\n              valueFrom:\n                secretKeyRef:\n                  name: yotpo-secret\n                  key: YOTPO_API_KEY\n            - name: YOTPO_API_SECRET\n              valueFrom:\n                secretKeyRef:\n                  name: yotpo-secret\n                  key: YOTPO_API_SECRET\n            - name: SITE_LINK_USER_JWD\n              valueFrom:\n                secretKeyRef:\n                  name: sitelink-secret\n                  key: SITE_LINK_USER_JWD\n            - name: SITE_LINK_PASS_JWD\n              valueFrom:\n                secretKeyRef:\n                  name: sitelink-secret\n                  key: SITE_LINK_PASS_JWD\n            - name: SITE_LINK_CODE_JWD\n              valueFrom:\n                secretKeyRef:\n                  name: sitelink-secret\n                  key: SITE_LINK_CODE_JWD\n            - name: SITE_LINK_LOCATION_JWD\n              valueFrom:\n                secretKeyRef:\n                  name: sitelink-secret\n                  key: SITE_LINK_LOCATION_JWD\n            - name: RABBITMQ_URL\n              valueFrom:\n                secretKeyRef:\n                  name: site-stock-service\n                  key: RABBITMQ_URL\n            - name: SND_EXCHANGE\n              valueFrom:\n                secretKeyRef:\n                  name: site-stock-service\n                  key: SND_EXCHANGE\n            - name: SND_UPDATE_ES_KEY\n              valueFrom:\n                secretKeyRef:\n                  name: site-stock-service\n                  key: SND_UPDATE_ES_KEY\n            - name: SND_UPDATE_STOCK_KEY\n              valueFrom:\n                secretKeyRef:\n                  name: site-stock-service\n                  key: SND_UPDATE_STOCK_KEY\n            - name: CLEVERTAP_ACCOUNT_ID\n              valueFrom:\n                secretKeyRef:\n                  name: clevertap-secret\n                  key: CLEVERTAP_ACCOUNT_ID\n            - name: CLEVERTAP_ACCOUNT_PASSCODE\n              valueFrom:\n                secretKeyRef:\n                  name: clevertap-secret\n                  key: CLEVERTAP_ACCOUNT_PASSCODE\n            resources:\n              requests:\n                cpu: 100m\n                memory: 128Mi\n              limits:\n                cpu: 500m\n                memory: 256Mi\n            securityContext:\n              privileged: false\n              capabilities:\n                drop:\n                - NET_RAW\n                - NET_ADMIN\n                - SYS_ADMIN\n                - SYS_MODULE\n                - SYS_PTRACE\n                - SYS_CHROOT\n              allowPrivilegeEscalation: false\n              runAsNonRoot: true\n              readOnlyRootFilesystem: true\n          restartPolicy: OnFailure\n  schedule: 0 0 * * *\n",
    "errors": []
  },
  {
    "id": "04753",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: CronJob\nmetadata:\n  name: prod-cron-cancel-booking\nspec:\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          containers:\n          - name: cron-cancel-booking\n            image: 414928843086.dkr.ecr.ap-southeast-1.amazonaws.com/core-api-v2:<VERSION>\n            imagePullPolicy: Always\n            args:\n            - run\n            - start-cron:cancel-booking:prod\n            env:\n            - name: NODE_ENV\n              value: production\n            - name: PORT\n              value: '3000'\n            - name: HOST\n              value: 0.0.0.0\n            - name: DB_DIALECT\n              valueFrom:\n                secretKeyRef:\n                  key: DB_DIALECT\n                  name: core-api\n            - name: DB_PORT\n              valueFrom:\n                secretKeyRef:\n                  key: DB_PORT\n                  name: core-api\n            - name: DB_HOST\n              valueFrom:\n                secretKeyRef:\n                  key: DB_HOST\n                  name: core-api\n            - name: DB_USERNAME\n              valueFrom:\n                secretKeyRef:\n                  key: DB_USERNAME\n                  name: core-api\n            - name: DB_PASSWORD\n              valueFrom:\n                secretKeyRef:\n                  key: DB_PASSWORD\n                  name: core-api\n            - name: DB_NAME\n              valueFrom:\n                secretKeyRef:\n                  key: DB_NAME\n                  name: core-api\n            - name: JWT_SECRET\n              valueFrom:\n                secretKeyRef:\n                  key: JWT_SECRET\n                  name: core-api\n            - name: JWT_EXPIRATION\n              valueFrom:\n                secretKeyRef:\n                  key: JWT_EXPIRATION\n                  name: core-api\n            - name: DEFAULT_COMMISSION\n              valueFrom:\n                secretKeyRef:\n                  key: DEFAULT_COMMISSION\n                  name: core-api\n            - name: TERMINATION_NOTICE_DAYS\n              valueFrom:\n                secretKeyRef:\n                  key: TERMINATION_NOTICE_DAYS\n                  name: core-api\n            - name: FILTER_BY_STOCK_URL\n              valueFrom:\n                secretKeyRef:\n                  name: core-api\n                  key: FILTER_BY_STOCK_URL\n            - name: TWILIO_ACCOUNT_SID\n              valueFrom:\n                secretKeyRef:\n                  key: TWILIO_ACCOUNT_SID\n                  name: twilio-secret\n            - name: TWILIO_AUTH_TOKEN\n              valueFrom:\n                secretKeyRef:\n                  key: TWILIO_AUTH_TOKEN\n                  name: twilio-secret\n            - name: TWILIO_SENDER_PHONE\n              valueFrom:\n                secretKeyRef:\n                  key: TWILIO_SENDER_PHONE\n                  name: twilio-secret\n            - name: AWS_S3_ACCESS_KEY\n              valueFrom:\n                secretKeyRef:\n                  key: AWS_S3_ACCESS_KEY\n                  name: aws-secret\n            - name: AWS_S3_SECRET_ACCESS_KEY\n              valueFrom:\n                secretKeyRef:\n                  key: AWS_S3_SECRET_ACCESS_KEY\n                  name: aws-secret\n            - name: AWS_S3_REGION\n              valueFrom:\n                secretKeyRef:\n                  key: AWS_S3_REGION\n                  name: aws-secret\n            - name: AWS_S3_BUCKET_NAME\n              valueFrom:\n                secretKeyRef:\n                  key: AWS_S3_BUCKET_NAME\n                  name: aws-secret\n            - name: AWS_S3_BUCKET_URL\n              valueFrom:\n                secretKeyRef:\n                  key: AWS_S3_BUCKET_URL\n                  name: aws-secret\n            - name: DEFAULT_RESIZE_WIDTH\n              valueFrom:\n                secretKeyRef:\n                  key: DEFAULT_RESIZE_WIDTH\n                  name: aws-secret\n            - name: SUPPORT_MIME_TYPE\n              valueFrom:\n                secretKeyRef:\n                  key: SUPPORT_MIME_TYPE\n                  name: aws-secret\n            - name: SENDGRID_API_KEY\n              valueFrom:\n                secretKeyRef:\n                  key: SENDGRID_API_KEY\n                  name: core-api\n            - name: REFRESH_TOKEN_EXPIRATION\n              valueFrom:\n                secretKeyRef:\n                  key: REFRESH_TOKEN_EXPIRATION\n                  name: core-api\n            - name: GOOGLE_CLIENT_ID\n              valueFrom:\n                secretKeyRef:\n                  key: GOOGLE_CLIENT_ID\n                  name: google-secret\n            - name: GOOGLE_CLIENT_SECRET\n              valueFrom:\n                secretKeyRef:\n                  key: GOOGLE_CLIENT_SECRET\n                  name: google-secret\n            - name: GOOGLE_CALLBACK_URL\n              valueFrom:\n                secretKeyRef:\n                  key: GOOGLE_CALLBACK_URL\n                  name: google-secret\n            - name: CLIENT_BASE_URL\n              valueFrom:\n                secretKeyRef:\n                  key: CLIENT_BASE_URL\n                  name: google-secret\n            - name: STRIPE_SECRET_KEY\n              valueFrom:\n                secretKeyRef:\n                  key: STRIPE_SECRET_KEY\n                  name: stripe-secret\n            - name: FACEBOOK_CLIENT_ID\n              valueFrom:\n                secretKeyRef:\n                  key: FACEBOOK_CLIENT_ID\n                  name: facebook-secret\n            - name: FACEBOOK_CLIENT_SECRET\n              valueFrom:\n                secretKeyRef:\n                  key: FACEBOOK_CLIENT_SECRET\n                  name: facebook-secret\n            - name: FACEBOOK_CALLBACK_URL\n              valueFrom:\n                secretKeyRef:\n                  key: FACEBOOK_CALLBACK_URL\n                  name: facebook-secret\n            - name: SITE_LINK_LOGIN_URL\n              valueFrom:\n                secretKeyRef:\n                  key: SITE_LINK_LOGIN_URL\n                  name: sitelink-secret\n            - name: SITE_LINK_UNITS_URL\n              valueFrom:\n                secretKeyRef:\n                  key: SITE_LINK_UNITS_URL\n                  name: sitelink-secret\n            - name: SITE_LINK_USER\n              valueFrom:\n                secretKeyRef:\n                  key: SITE_LINK_USER\n                  name: sitelink-secret\n            - name: SITE_LINK_PASS\n              valueFrom:\n                secretKeyRef:\n                  key: SITE_LINK_PASS\n                  name: sitelink-secret\n            - name: SITE_LINK_CODE\n              valueFrom:\n                secretKeyRef:\n                  key: SITE_LINK_CODE\n                  name: sitelink-secret\n            - name: SITE_LINK_COMMISSION_PERCENT\n              valueFrom:\n                secretKeyRef:\n                  key: SITE_LINK_COMMISSION_PERCENT\n                  name: sitelink-secret\n            - name: SITE_LINK_SITES_URL\n              valueFrom:\n                secretKeyRef:\n                  key: SITE_LINK_SITES_URL\n                  name: sitelink-secret\n            - name: BROWSER_URL\n              valueFrom:\n                secretKeyRef:\n                  key: BROWSERLESS_URL\n                  name: sitelink-secret\n            - name: GOGOX_CLIENT_ID\n              valueFrom:\n                secretKeyRef:\n                  name: gogox-secret\n                  key: GOGOX_CLIENT_ID\n            - name: GOGOX_CLIENT_SECRET\n              valueFrom:\n                secretKeyRef:\n                  name: gogox-secret\n                  key: GOGOX_CLIENT_SECRET\n            - name: GOGOX_API_URL\n              valueFrom:\n                secretKeyRef:\n                  name: gogox-secret\n                  key: GOGOX_API_URL\n            - name: YOTPO_API_KEY\n              valueFrom:\n                secretKeyRef:\n                  name: yotpo-secret\n                  key: YOTPO_API_KEY\n            - name: YOTPO_API_SECRET\n              valueFrom:\n                secretKeyRef:\n                  name: yotpo-secret\n                  key: YOTPO_API_SECRET\n            - name: SITE_LINK_USER_JWD\n              valueFrom:\n                secretKeyRef:\n                  name: sitelink-secret\n                  key: SITE_LINK_USER_JWD\n            - name: SITE_LINK_PASS_JWD\n              valueFrom:\n                secretKeyRef:\n                  name: sitelink-secret\n                  key: SITE_LINK_PASS_JWD\n            - name: SITE_LINK_CODE_JWD\n              valueFrom:\n                secretKeyRef:\n                  name: sitelink-secret\n                  key: SITE_LINK_CODE_JWD\n            - name: SITE_LINK_LOCATION_JWD\n              valueFrom:\n                secretKeyRef:\n                  name: sitelink-secret\n                  key: SITE_LINK_LOCATION_JWD\n            - name: RABBITMQ_URL\n              valueFrom:\n                secretKeyRef:\n                  name: site-stock-service\n                  key: RABBITMQ_URL\n            - name: SND_EXCHANGE\n              valueFrom:\n                secretKeyRef:\n                  name: site-stock-service\n                  key: SND_EXCHANGE\n            - name: SND_UPDATE_ES_KEY\n              valueFrom:\n                secretKeyRef:\n                  name: site-stock-service\n                  key: SND_UPDATE_ES_KEY\n            - name: SND_UPDATE_STOCK_KEY\n              valueFrom:\n                secretKeyRef:\n                  name: site-stock-service\n                  key: SND_UPDATE_STOCK_KEY\n            - name: CLEVERTAP_ACCOUNT_ID\n              valueFrom:\n                secretKeyRef:\n                  name: clevertap-secret\n                  key: CLEVERTAP_ACCOUNT_ID\n            - name: CLEVERTAP_ACCOUNT_PASSCODE\n              valueFrom:\n                secretKeyRef:\n                  name: clevertap-secret\n                  key: CLEVERTAP_ACCOUNT_PASSCODE\n            resources:\n              requests:\n                cpu: 100m\n                memory: 128Mi\n              limits:\n                cpu: 500m\n                memory: 256Mi\n            securityContext:\n              privileged: false\n              capabilities:\n                drop:\n                - NET_RAW\n                - NET_ADMIN\n                - SYS_ADMIN\n                - SYS_MODULE\n                - SYS_PTRACE\n                - SYS_CHROOT\n              allowPrivilegeEscalation: false\n              runAsNonRoot: true\n              readOnlyRootFilesystem: true\n          restartPolicy: OnFailure\n  schedule: 0 0 * * *\n",
    "errors": []
  },
  {
    "id": "04754",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-9520\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      privileged: false\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n      readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "04755",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-9520\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    securityContext:\n      readOnlyRootFilesystem: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "04756",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-9520\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    securityContext:\n      runAsNonRoot: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      readOnlyRootFilesystem: true\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "04757",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-9520\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n      readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "04758",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-9520\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n      readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "04759",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: accountapi-deployment\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: accountapi\n  template:\n    metadata:\n      labels:\n        app: accountapi\n    spec:\n      containers:\n      - name: accountapi-container\n        image: gcr.io/staffjoy-prod/accountapi:VERSION\n        ports:\n        - containerPort: 80\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: 80\n        readinessProbe:\n          httpGet:\n            path: /health\n            port: 80\n        env:\n        - name: DEPLOY\n          value: VERSION\n        - name: ENV\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: SENTRY_DSN\n          valueFrom:\n            secretKeyRef:\n              name: sentry\n              key: dsn\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "04760",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: accountapi-deployment\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: accountapi\n  template:\n    metadata:\n      labels:\n        app: accountapi\n    spec:\n      containers:\n      - name: accountapi-container\n        image: gcr.io/staffjoy-prod/accountapi:VERSION\n        ports:\n        - containerPort: 80\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: 80\n        readinessProbe:\n          httpGet:\n            path: /health\n            port: 80\n        env:\n        - name: DEPLOY\n          value: VERSION\n        - name: ENV\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: SENTRY_DSN\n          valueFrom:\n            secretKeyRef:\n              name: sentry\n              key: dsn\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n",
    "errors": []
  }
]