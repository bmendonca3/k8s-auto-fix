[
  {
    "id": "02961",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-790\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    securityContext:\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      privileged: false\n      allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "02962",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-790\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    securityContext:\n      readOnlyRootFilesystem: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "02963",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-790\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    securityContext:\n      runAsNonRoot: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "02964",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-790\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "02965",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-790\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "02966",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: not-privileged-deploy\n  name: not-privileged-deploy\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: not-privileged-deploy\n  template:\n    metadata:\n      labels:\n        app: not-privileged-deploy\n    spec:\n      containers:\n      - image: alpine:stable\n        name: alpine\n        securityContext:\n          runAsUser: 1000\n          runAsGroup: 1000\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "02967",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: not-privileged-deploy\n  name: not-privileged-deploy\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: not-privileged-deploy\n  template:\n    metadata:\n      labels:\n        app: not-privileged-deploy\n    spec:\n      containers:\n      - image: alpine:stable\n        name: alpine\n        securityContext:\n          runAsUser: 1000\n          runAsGroup: 1000\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "02968",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: not-privileged-deploy\n  name: not-privileged-deploy\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: not-privileged-deploy\n  template:\n    metadata:\n      labels:\n        app: not-privileged-deploy\n    spec:\n      containers:\n      - image: alpine:stable\n        name: alpine\n        securityContext:\n          runAsUser: 1000\n          runAsGroup: 1000\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "02969",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: not-privileged-deploy\n  name: not-privileged-deploy\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: not-privileged-deploy\n  template:\n    metadata:\n      labels:\n        app: not-privileged-deploy\n    spec:\n      containers:\n      - image: alpine:stable\n        name: alpine\n        securityContext:\n          runAsUser: 1000\n          runAsGroup: 1000\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "02970",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: iot-kafka-pipe\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: iot-kafka-pipe\n  template:\n    metadata:\n      labels:\n        app: iot-kafka-pipe\n        tier: backend\n        group: java\n    spec:\n      containers:\n      - name: iot-kafka-pipe\n        image: registry.gitlab.com/mc-b/iot-kafka/iot-kafka-pipe:stable\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "02971",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: iot-kafka-pipe\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: iot-kafka-pipe\n  template:\n    metadata:\n      labels:\n        app: iot-kafka-pipe\n        tier: backend\n        group: java\n    spec:\n      containers:\n      - name: iot-kafka-pipe\n        image: registry.gitlab.com/mc-b/iot-kafka/iot-kafka-pipe:stable\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "02972",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: iot-kafka-pipe\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: iot-kafka-pipe\n  template:\n    metadata:\n      labels:\n        app: iot-kafka-pipe\n        tier: backend\n        group: java\n    spec:\n      containers:\n      - name: iot-kafka-pipe\n        image: registry.gitlab.com/mc-b/iot-kafka/iot-kafka-pipe:stable\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "02973",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: iot-kafka-pipe\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: iot-kafka-pipe\n  template:\n    metadata:\n      labels:\n        app: iot-kafka-pipe\n        tier: backend\n        group: java\n    spec:\n      containers:\n      - name: iot-kafka-pipe\n        image: registry.gitlab.com/mc-b/iot-kafka/iot-kafka-pipe:stable\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "02974",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: iot-kafka-pipe\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: iot-kafka-pipe\n  template:\n    metadata:\n      labels:\n        app: iot-kafka-pipe\n        tier: backend\n        group: java\n    spec:\n      containers:\n      - name: iot-kafka-pipe\n        image: registry.gitlab.com/mc-b/iot-kafka/iot-kafka-pipe:stable\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "02975",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: pdservingclient\n  labels:\n    app: pdservingclient\nspec:\n  containers:\n  - name: pdservingclient\n    image: wangjiawei1993/pdservingclient:v4\n    workingDir: /\n    command:\n    - bash\n    args:\n    - nonstop.sh\n    securityContext:\n      readOnlyRootFilesystem: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "02976",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: pdservingclient\n  labels:\n    app: pdservingclient\nspec:\n  containers:\n  - name: pdservingclient\n    image: wangjiawei1993/pdservingclient:v4\n    workingDir: /\n    command:\n    - bash\n    args:\n    - nonstop.sh\n    securityContext:\n      runAsNonRoot: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "02977",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: pdservingclient\n  labels:\n    app: pdservingclient\nspec:\n  containers:\n  - name: pdservingclient\n    image: wangjiawei1993/pdservingclient:v4\n    workingDir: /\n    command:\n    - bash\n    args:\n    - nonstop.sh\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "02978",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: pdservingclient\n  labels:\n    app: pdservingclient\nspec:\n  containers:\n  - name: pdservingclient\n    image: wangjiawei1993/pdservingclient:v4\n    workingDir: /\n    command:\n    - bash\n    args:\n    - nonstop.sh\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "02979",
    "policy_id": "read_only_root_fs",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "02980",
    "policy_id": "run_as_non_root",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "02981",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "02982",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "02983",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: web\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: web\n  template:\n    metadata:\n      name: web\n      labels:\n        app: web\n    spec:\n      containers:\n      - name: web\n        image: binhex386/kubernetes-intro:stable\n        volumeMounts:\n        - mountPath: /app\n          name: www\n        resources:\n          limits:\n            cpu: 100m\n            memory: 64M\n        readinessProbe:\n          httpGet:\n            path: /index.html\n            port: 8000\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n      initContainers:\n      - name: init-www\n        image: busybox:stable\n        command:\n        - sh\n        - -c\n        - wget -O- https://tinyurl.com/otus-k8s-intro | sh\n        volumeMounts:\n        - mountPath: /app\n          name: www\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: www\n        emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "02984",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: web\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: web\n  template:\n    metadata:\n      name: web\n      labels:\n        app: web\n    spec:\n      containers:\n      - name: web\n        image: binhex386/kubernetes-intro:stable\n        volumeMounts:\n        - mountPath: /app\n          name: www\n        resources:\n          limits:\n            cpu: 100m\n            memory: 64M\n        readinessProbe:\n          httpGet:\n            path: /index.html\n            port: 8000\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n      initContainers:\n      - name: init-www\n        image: busybox:stable\n        command:\n        - sh\n        - -c\n        - wget -O- https://tinyurl.com/otus-k8s-intro | sh\n        volumeMounts:\n        - mountPath: /app\n          name: www\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: www\n        emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "02985",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: web\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: web\n  template:\n    metadata:\n      name: web\n      labels:\n        app: web\n    spec:\n      containers:\n      - name: web\n        image: binhex386/kubernetes-intro:stable\n        volumeMounts:\n        - mountPath: /app\n          name: www\n        resources:\n          limits:\n            cpu: 100m\n            memory: 64M\n        readinessProbe:\n          httpGet:\n            path: /index.html\n            port: 8000\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      initContainers:\n      - name: init-www\n        image: busybox:stable\n        command:\n        - sh\n        - -c\n        - wget -O- https://tinyurl.com/otus-k8s-intro | sh\n        volumeMounts:\n        - mountPath: /app\n          name: www\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: www\n        emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "02986",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: web\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: web\n  template:\n    metadata:\n      name: web\n      labels:\n        app: web\n    spec:\n      containers:\n      - name: web\n        image: binhex386/kubernetes-intro:stable\n        volumeMounts:\n        - mountPath: /app\n          name: www\n        resources:\n          limits:\n            cpu: 100m\n            memory: 64M\n        readinessProbe:\n          httpGet:\n            path: /index.html\n            port: 8000\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      initContainers:\n      - name: init-www\n        image: busybox:stable\n        command:\n        - sh\n        - -c\n        - wget -O- https://tinyurl.com/otus-k8s-intro | sh\n        volumeMounts:\n        - mountPath: /app\n          name: www\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: www\n        emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "02987",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: web\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: web\n  template:\n    metadata:\n      name: web\n      labels:\n        app: web\n    spec:\n      containers:\n      - name: web\n        image: binhex386/kubernetes-intro:stable\n        volumeMounts:\n        - mountPath: /app\n          name: www\n        resources:\n          limits:\n            cpu: 100m\n            memory: 64M\n        readinessProbe:\n          httpGet:\n            path: /index.html\n            port: 8000\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      initContainers:\n      - name: init-www\n        image: busybox:stable\n        command:\n        - sh\n        - -c\n        - wget -O- https://tinyurl.com/otus-k8s-intro | sh\n        volumeMounts:\n        - mountPath: /app\n          name: www\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: www\n        emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "02988",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: web\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: web\n  template:\n    metadata:\n      name: web\n      labels:\n        app: web\n    spec:\n      containers:\n      - name: web\n        image: binhex386/kubernetes-intro:stable\n        volumeMounts:\n        - mountPath: /app\n          name: www\n        resources:\n          limits:\n            cpu: 100m\n            memory: 64M\n        readinessProbe:\n          httpGet:\n            path: /index.html\n            port: 8000\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      initContainers:\n      - name: init-www\n        image: busybox:stable\n        command:\n        - sh\n        - -c\n        - wget -O- https://tinyurl.com/otus-k8s-intro | sh\n        volumeMounts:\n        - mountPath: /app\n          name: www\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: www\n        emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "02989",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "02990",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "02991",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "02992",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: hapi-fhir-mysql-deployment\n  labels:\n    package: core\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      component: hapi-fhir-mysql\n  template:\n    metadata:\n      labels:\n        component: hapi-fhir-mysql\n    spec:\n      containers:\n      - name: hapi-fhir-mysql\n        image: mysql:5.7\n        args:\n        - --ignore-db-dir=lost+found\n        env:\n        - name: MYSQL_DATABASE\n          value: hapi\n        - name: MYSQL_PASSWORD\n          value: instant101\n        - name: MYSQL_ROOT_PASSWORD\n          value: instant101\n        - name: MYSQL_USER\n          value: admin\n        volumeMounts:\n        - name: core-hapi-fhir-mysql-volume\n          mountPath: /var/lib/mysql\n        - name: core-hapi-fhir-mysql-config-map\n          mountPath: /etc/mysql/conf.d\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: core-hapi-fhir-mysql-volume\n        persistentVolumeClaim:\n          claimName: hapi-fhir-mysql-volume-claim\n      - name: core-hapi-fhir-mysql-config-map\n        configMap:\n          name: core-hapi-fhir-mysql-configmap\n",
    "errors": []
  },
  {
    "id": "02993",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: hapi-fhir-mysql-deployment\n  labels:\n    package: core\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      component: hapi-fhir-mysql\n  template:\n    metadata:\n      labels:\n        component: hapi-fhir-mysql\n    spec:\n      containers:\n      - name: hapi-fhir-mysql\n        image: mysql:5.7\n        args:\n        - --ignore-db-dir=lost+found\n        env:\n        - name: MYSQL_DATABASE\n          value: hapi\n        - name: MYSQL_PASSWORD\n          value: instant101\n        - name: MYSQL_ROOT_PASSWORD\n          value: instant101\n        - name: MYSQL_USER\n          value: admin\n        volumeMounts:\n        - name: core-hapi-fhir-mysql-volume\n          mountPath: /var/lib/mysql\n        - name: core-hapi-fhir-mysql-config-map\n          mountPath: /etc/mysql/conf.d\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: core-hapi-fhir-mysql-volume\n        persistentVolumeClaim:\n          claimName: hapi-fhir-mysql-volume-claim\n      - name: core-hapi-fhir-mysql-config-map\n        configMap:\n          name: core-hapi-fhir-mysql-configmap\n",
    "errors": []
  },
  {
    "id": "02994",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: hapi-fhir-mysql-deployment\n  labels:\n    package: core\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      component: hapi-fhir-mysql\n  template:\n    metadata:\n      labels:\n        component: hapi-fhir-mysql\n    spec:\n      containers:\n      - name: hapi-fhir-mysql\n        image: mysql:5.7\n        args:\n        - --ignore-db-dir=lost+found\n        env:\n        - name: MYSQL_DATABASE\n          value: hapi\n        - name: MYSQL_PASSWORD\n          value: instant101\n        - name: MYSQL_ROOT_PASSWORD\n          value: instant101\n        - name: MYSQL_USER\n          value: admin\n        volumeMounts:\n        - name: core-hapi-fhir-mysql-volume\n          mountPath: /var/lib/mysql\n        - name: core-hapi-fhir-mysql-config-map\n          mountPath: /etc/mysql/conf.d\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: core-hapi-fhir-mysql-volume\n        persistentVolumeClaim:\n          claimName: hapi-fhir-mysql-volume-claim\n      - name: core-hapi-fhir-mysql-config-map\n        configMap:\n          name: core-hapi-fhir-mysql-configmap\n",
    "errors": []
  },
  {
    "id": "02995",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: hapi-fhir-mysql-deployment\n  labels:\n    package: core\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      component: hapi-fhir-mysql\n  template:\n    metadata:\n      labels:\n        component: hapi-fhir-mysql\n    spec:\n      containers:\n      - name: hapi-fhir-mysql\n        image: mysql:5.7\n        args:\n        - --ignore-db-dir=lost+found\n        env:\n        - name: MYSQL_DATABASE\n          value: hapi\n        - name: MYSQL_PASSWORD\n          value: instant101\n        - name: MYSQL_ROOT_PASSWORD\n          value: instant101\n        - name: MYSQL_USER\n          value: admin\n        volumeMounts:\n        - name: core-hapi-fhir-mysql-volume\n          mountPath: /var/lib/mysql\n        - name: core-hapi-fhir-mysql-config-map\n          mountPath: /etc/mysql/conf.d\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: core-hapi-fhir-mysql-volume\n        persistentVolumeClaim:\n          claimName: hapi-fhir-mysql-volume-claim\n      - name: core-hapi-fhir-mysql-config-map\n        configMap:\n          name: core-hapi-fhir-mysql-configmap\n",
    "errors": []
  },
  {
    "id": "02996",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: seldon\n    app.kubernetes.io/instance: seldon1\n    app.kubernetes.io/name: seldon\n    app.kubernetes.io/version: v0.5\n    control-plane: seldon-controller-manager\n  name: seldon-controller-manager\n  namespace: default\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: seldon\n      app.kubernetes.io/instance: seldon1\n      app.kubernetes.io/name: seldon\n      app.kubernetes.io/version: v0.5\n      control-plane: seldon-controller-manager\n  template:\n    metadata:\n      annotations:\n        sidecar.istio.io/inject: 'false'\n      labels:\n        app: seldon\n        app.kubernetes.io/instance: seldon1\n        app.kubernetes.io/name: seldon\n        app.kubernetes.io/version: v0.5\n        control-plane: seldon-controller-manager\n    spec:\n      containers:\n      - args:\n        - --enable-leader-election\n        - --webhook-port=8443\n        - --create-resources=$(MANAGER_CREATE_RESOURCES)\n        command:\n        - /manager\n        env:\n        - name: WATCH_NAMESPACE\n          value: ''\n        - name: RELATED_IMAGE_EXECUTOR\n          value: ''\n        - name: RELATED_IMAGE_ENGINE\n          value: ''\n        - name: RELATED_IMAGE_STORAGE_INITIALIZER\n          value: ''\n        - name: RELATED_IMAGE_SKLEARNSERVER_REST\n          value: ''\n        - name: RELATED_IMAGE_SKLEARNSERVER_GRPC\n          value: ''\n        - name: RELATED_IMAGE_XGBOOSTSERVER_REST\n          value: ''\n        - name: RELATED_IMAGE_XGBOOSTSERVER_GRPC\n          value: ''\n        - name: RELATED_IMAGE_MLFLOWSERVER_REST\n          value: ''\n        - name: RELATED_IMAGE_MLFLOWSERVER_GRPC\n          value: ''\n        - name: RELATED_IMAGE_TFPROXY_REST\n          value: ''\n        - name: RELATED_IMAGE_TFPROXY_GRPC\n          value: ''\n        - name: RELATED_IMAGE_TENSORFLOW\n          value: ''\n        - name: RELATED_IMAGE_EXPLAINER\n          value: ''\n        - name: MANAGER_CREATE_RESOURCES\n          value: 'true'\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: CONTROLLER_ID\n          value: ''\n        - name: AMBASSADOR_ENABLED\n          value: 'true'\n        - name: AMBASSADOR_SINGLE_NAMESPACE\n          value: 'false'\n        - name: ENGINE_CONTAINER_IMAGE_AND_VERSION\n          value: docker.io/seldonio/engine:1.2.1-dev\n        - name: ENGINE_CONTAINER_IMAGE_PULL_POLICY\n          value: IfNotPresent\n        - name: ENGINE_CONTAINER_SERVICE_ACCOUNT_NAME\n          value: default\n        - name: ENGINE_CONTAINER_USER\n          value: ''\n        - name: ENGINE_LOG_MESSAGES_EXTERNALLY\n          value: 'false'\n        - name: PREDICTIVE_UNIT_SERVICE_PORT\n          value: '9000'\n        - name: PREDICTIVE_UNIT_DEFAULT_ENV_SECRET_REF_NAME\n          value: ''\n        - name: PREDICTIVE_UNIT_METRICS_PORT_NAME\n          value: metrics\n        - name: ENGINE_SERVER_GRPC_PORT\n          value: '5001'\n        - name: ENGINE_SERVER_PORT\n          value: '8000'\n        - name: ENGINE_PROMETHEUS_PATH\n          value: /prometheus\n        - name: ISTIO_ENABLED\n          value: 'false'\n        - name: ISTIO_GATEWAY\n          value: istio-system/seldon-gateway\n        - name: ISTIO_TLS_MODE\n          value: ''\n        - name: USE_EXECUTOR\n          value: 'true'\n        - name: EXECUTOR_CONTAINER_IMAGE_AND_VERSION\n          value: seldonio/seldon-core-executor:1.2.1-dev\n        - name: EXECUTOR_CONTAINER_IMAGE_PULL_POLICY\n          value: IfNotPresent\n        - name: EXECUTOR_PROMETHEUS_PATH\n          value: /prometheus\n        - name: EXECUTOR_SERVER_PORT\n          value: '8000'\n        - name: EXECUTOR_CONTAINER_USER\n          value: ''\n        - name: EXECUTOR_CONTAINER_SERVICE_ACCOUNT_NAME\n          value: default\n        - name: EXECUTOR_SERVER_METRICS_PORT_NAME\n          value: metrics\n        - name: EXECUTOR_REQUEST_LOGGER_DEFAULT_ENDPOINT\n          value: http://default-broker\n        - name: DEFAULT_USER_ID\n          value: ''\n        image: seldonio/seldon-core-operator:1.2.1-dev\n        name: manager\n        ports:\n        - containerPort: 8443\n          name: webhook-server\n          protocol: TCP\n        resources:\n          limits:\n            cpu: 500m\n            memory: 300Mi\n          requests:\n            cpu: 100m\n            memory: 200Mi\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      serviceAccountName: seldon-manager\n",
    "errors": []
  },
  {
    "id": "02997",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: seldon\n    app.kubernetes.io/instance: seldon1\n    app.kubernetes.io/name: seldon\n    app.kubernetes.io/version: v0.5\n    control-plane: seldon-controller-manager\n  name: seldon-controller-manager\n  namespace: default\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: seldon\n      app.kubernetes.io/instance: seldon1\n      app.kubernetes.io/name: seldon\n      app.kubernetes.io/version: v0.5\n      control-plane: seldon-controller-manager\n  template:\n    metadata:\n      annotations:\n        sidecar.istio.io/inject: 'false'\n      labels:\n        app: seldon\n        app.kubernetes.io/instance: seldon1\n        app.kubernetes.io/name: seldon\n        app.kubernetes.io/version: v0.5\n        control-plane: seldon-controller-manager\n    spec:\n      containers:\n      - args:\n        - --enable-leader-election\n        - --webhook-port=8443\n        - --create-resources=$(MANAGER_CREATE_RESOURCES)\n        command:\n        - /manager\n        env:\n        - name: WATCH_NAMESPACE\n          value: ''\n        - name: RELATED_IMAGE_EXECUTOR\n          value: ''\n        - name: RELATED_IMAGE_ENGINE\n          value: ''\n        - name: RELATED_IMAGE_STORAGE_INITIALIZER\n          value: ''\n        - name: RELATED_IMAGE_SKLEARNSERVER_REST\n          value: ''\n        - name: RELATED_IMAGE_SKLEARNSERVER_GRPC\n          value: ''\n        - name: RELATED_IMAGE_XGBOOSTSERVER_REST\n          value: ''\n        - name: RELATED_IMAGE_XGBOOSTSERVER_GRPC\n          value: ''\n        - name: RELATED_IMAGE_MLFLOWSERVER_REST\n          value: ''\n        - name: RELATED_IMAGE_MLFLOWSERVER_GRPC\n          value: ''\n        - name: RELATED_IMAGE_TFPROXY_REST\n          value: ''\n        - name: RELATED_IMAGE_TFPROXY_GRPC\n          value: ''\n        - name: RELATED_IMAGE_TENSORFLOW\n          value: ''\n        - name: RELATED_IMAGE_EXPLAINER\n          value: ''\n        - name: MANAGER_CREATE_RESOURCES\n          value: 'true'\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: CONTROLLER_ID\n          value: ''\n        - name: AMBASSADOR_ENABLED\n          value: 'true'\n        - name: AMBASSADOR_SINGLE_NAMESPACE\n          value: 'false'\n        - name: ENGINE_CONTAINER_IMAGE_AND_VERSION\n          value: docker.io/seldonio/engine:1.2.1-dev\n        - name: ENGINE_CONTAINER_IMAGE_PULL_POLICY\n          value: IfNotPresent\n        - name: ENGINE_CONTAINER_SERVICE_ACCOUNT_NAME\n          value: default\n        - name: ENGINE_CONTAINER_USER\n          value: ''\n        - name: ENGINE_LOG_MESSAGES_EXTERNALLY\n          value: 'false'\n        - name: PREDICTIVE_UNIT_SERVICE_PORT\n          value: '9000'\n        - name: PREDICTIVE_UNIT_DEFAULT_ENV_SECRET_REF_NAME\n          value: ''\n        - name: PREDICTIVE_UNIT_METRICS_PORT_NAME\n          value: metrics\n        - name: ENGINE_SERVER_GRPC_PORT\n          value: '5001'\n        - name: ENGINE_SERVER_PORT\n          value: '8000'\n        - name: ENGINE_PROMETHEUS_PATH\n          value: /prometheus\n        - name: ISTIO_ENABLED\n          value: 'false'\n        - name: ISTIO_GATEWAY\n          value: istio-system/seldon-gateway\n        - name: ISTIO_TLS_MODE\n          value: ''\n        - name: USE_EXECUTOR\n          value: 'true'\n        - name: EXECUTOR_CONTAINER_IMAGE_AND_VERSION\n          value: seldonio/seldon-core-executor:1.2.1-dev\n        - name: EXECUTOR_CONTAINER_IMAGE_PULL_POLICY\n          value: IfNotPresent\n        - name: EXECUTOR_PROMETHEUS_PATH\n          value: /prometheus\n        - name: EXECUTOR_SERVER_PORT\n          value: '8000'\n        - name: EXECUTOR_CONTAINER_USER\n          value: ''\n        - name: EXECUTOR_CONTAINER_SERVICE_ACCOUNT_NAME\n          value: default\n        - name: EXECUTOR_SERVER_METRICS_PORT_NAME\n          value: metrics\n        - name: EXECUTOR_REQUEST_LOGGER_DEFAULT_ENDPOINT\n          value: http://default-broker\n        - name: DEFAULT_USER_ID\n          value: ''\n        image: seldonio/seldon-core-operator:1.2.1-dev\n        name: manager\n        ports:\n        - containerPort: 8443\n          name: webhook-server\n          protocol: TCP\n        resources:\n          limits:\n            cpu: 500m\n            memory: 300Mi\n          requests:\n            cpu: 100m\n            memory: 200Mi\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      serviceAccountName: seldon-manager\n",
    "errors": []
  },
  {
    "id": "02998",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: micro-network\n  labels:\n    micro: runtime\n    name: micro-network\n  annotations:\n    name: go.micro.network\n    version: latest\n    source: github.com/itzmanish/micro\n    owner: micro\n    group: micro\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: micro-network\n      micro: runtime\n  template:\n    metadata:\n      labels:\n        name: micro-network\n        micro: runtime\n    spec:\n      affinity:\n        podAntiAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - weight: 100\n            podAffinityTerm:\n              labelSelector:\n                matchExpressions:\n                - key: name\n                  operator: In\n                  values:\n                  - micro-network\n              topologyKey: kubernetes.io/hostname\n      volumes:\n      - name: shared-data\n        emptyDir: {}\n      containers:\n      - name: network\n        env:\n        - name: MICRO_NETWORK_TOKEN\n          value: micro.mu\n        - name: MICRO_NETWORK_ADVERTISE_STRATEGY\n          value: best\n        - name: MICRO_LOG_LEVEL\n          value: debug\n        - name: MICRO_BROKER\n          value: nats\n        - name: MICRO_BROKER_ADDRESS\n          value: nats-cluster\n        - name: MICRO_REGISTRY\n          value: etcd\n        - name: MICRO_REGISTRY_ADDRESS\n          value: etcd-cluster-client\n        - name: MICRO_SERVER_ADDRESS\n          value: 0.0.0.0:8080\n        args:\n        - network\n        image: micro/micro:stable\n        imagePullPolicy: Always\n        ports:\n        - containerPort: 8080\n          name: service-port\n        - containerPort: 8085\n          name: network-port\n          protocol: UDP\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "02999",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: micro-network\n  labels:\n    micro: runtime\n    name: micro-network\n  annotations:\n    name: go.micro.network\n    version: latest\n    source: github.com/itzmanish/micro\n    owner: micro\n    group: micro\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: micro-network\n      micro: runtime\n  template:\n    metadata:\n      labels:\n        name: micro-network\n        micro: runtime\n    spec:\n      affinity:\n        podAntiAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - weight: 100\n            podAffinityTerm:\n              labelSelector:\n                matchExpressions:\n                - key: name\n                  operator: In\n                  values:\n                  - micro-network\n              topologyKey: kubernetes.io/hostname\n      volumes:\n      - name: shared-data\n        emptyDir: {}\n      containers:\n      - name: network\n        env:\n        - name: MICRO_NETWORK_TOKEN\n          value: micro.mu\n        - name: MICRO_NETWORK_ADVERTISE_STRATEGY\n          value: best\n        - name: MICRO_LOG_LEVEL\n          value: debug\n        - name: MICRO_BROKER\n          value: nats\n        - name: MICRO_BROKER_ADDRESS\n          value: nats-cluster\n        - name: MICRO_REGISTRY\n          value: etcd\n        - name: MICRO_REGISTRY_ADDRESS\n          value: etcd-cluster-client\n        - name: MICRO_SERVER_ADDRESS\n          value: 0.0.0.0:8080\n        args:\n        - network\n        image: micro/micro:stable\n        imagePullPolicy: Always\n        ports:\n        - containerPort: 8080\n          name: service-port\n        - containerPort: 8085\n          name: network-port\n          protocol: UDP\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "03000",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: micro-network\n  labels:\n    micro: runtime\n    name: micro-network\n  annotations:\n    name: go.micro.network\n    version: latest\n    source: github.com/itzmanish/micro\n    owner: micro\n    group: micro\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: micro-network\n      micro: runtime\n  template:\n    metadata:\n      labels:\n        name: micro-network\n        micro: runtime\n    spec:\n      affinity:\n        podAntiAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - weight: 100\n            podAffinityTerm:\n              labelSelector:\n                matchExpressions:\n                - key: name\n                  operator: In\n                  values:\n                  - micro-network\n              topologyKey: kubernetes.io/hostname\n      volumes:\n      - name: shared-data\n        emptyDir: {}\n      containers:\n      - name: network\n        env:\n        - name: MICRO_NETWORK_TOKEN\n          value: micro.mu\n        - name: MICRO_NETWORK_ADVERTISE_STRATEGY\n          value: best\n        - name: MICRO_LOG_LEVEL\n          value: debug\n        - name: MICRO_BROKER\n          value: nats\n        - name: MICRO_BROKER_ADDRESS\n          value: nats-cluster\n        - name: MICRO_REGISTRY\n          value: etcd\n        - name: MICRO_REGISTRY_ADDRESS\n          value: etcd-cluster-client\n        - name: MICRO_SERVER_ADDRESS\n          value: 0.0.0.0:8080\n        args:\n        - network\n        image: micro/micro:stable\n        imagePullPolicy: Always\n        ports:\n        - containerPort: 8080\n          name: service-port\n        - containerPort: 8085\n          name: network-port\n          protocol: UDP\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n",
    "errors": []
  }
]