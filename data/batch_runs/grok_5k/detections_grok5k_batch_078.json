[
  {
    "id": "03121",
    "manifest_path": "data/manifests/the_stack_sample/sample_1309.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: test-job2\nspec:\n  template:\n    metadata:\n      name: test-job2\n    spec:\n      containers:\n      - name: test-container\n        image: gcr.io/google_containers/busybox\n        command:\n        - /bin/sh\n        - -c\n        - sleep 20; env\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"test-container\" has memory limit 0"
  },
  {
    "id": "03122",
    "manifest_path": "data/manifests/the_stack_sample/sample_1316.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: kubernetes-dashboard-v1.0.1\n  namespace: kube-system\n  labels:\n    k8s-app: kubernetes-dashboard\n    version: v1.0.1\n    kubernetes.io/cluster-service: 'true'\nspec:\n  replicas: 1\n  selector:\n    k8s-app: kubernetes-dashboard\n  template:\n    metadata:\n      labels:\n        k8s-app: kubernetes-dashboard\n        version: v1.0.1\n        kubernetes.io/cluster-service: 'true'\n    spec:\n      containers:\n      - name: kubernetes-dashboard\n        image: gcr.io/google_containers/kubernetes-dashboard-amd64:v1.0.1\n        resources:\n          limits:\n            cpu: 100m\n            memory: 50Mi\n          requests:\n            cpu: 100m\n            memory: 50Mi\n        ports:\n        - containerPort: 9090\n        livenessProbe:\n          httpGet:\n            path: /\n            port: 9090\n          initialDelaySeconds: 30\n          timeoutSeconds: 30\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"kubernetes-dashboard\" does not have a read-only root file system"
  },
  {
    "id": "03123",
    "manifest_path": "data/manifests/the_stack_sample/sample_1316.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: kubernetes-dashboard-v1.0.1\n  namespace: kube-system\n  labels:\n    k8s-app: kubernetes-dashboard\n    version: v1.0.1\n    kubernetes.io/cluster-service: 'true'\nspec:\n  replicas: 1\n  selector:\n    k8s-app: kubernetes-dashboard\n  template:\n    metadata:\n      labels:\n        k8s-app: kubernetes-dashboard\n        version: v1.0.1\n        kubernetes.io/cluster-service: 'true'\n    spec:\n      containers:\n      - name: kubernetes-dashboard\n        image: gcr.io/google_containers/kubernetes-dashboard-amd64:v1.0.1\n        resources:\n          limits:\n            cpu: 100m\n            memory: 50Mi\n          requests:\n            cpu: 100m\n            memory: 50Mi\n        ports:\n        - containerPort: 9090\n        livenessProbe:\n          httpGet:\n            path: /\n            port: 9090\n          initialDelaySeconds: 30\n          timeoutSeconds: 30\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"kubernetes-dashboard\" is not set to runAsNonRoot"
  },
  {
    "id": "03124",
    "manifest_path": "data/manifests/the_stack_sample/sample_1325.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: benchmark-operator\n  namespace: my-ripsaw\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: benchmark-operator\n  template:\n    metadata:\n      labels:\n        name: benchmark-operator\n    spec:\n      affinity:\n        nodeAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - weight: 100\n            preference:\n              matchExpressions:\n              - key: node-role.kubernetes.io/workload\n                operator: In\n                values:\n                - ''\n      serviceAccountName: benchmark-operator\n      containers:\n      - name: ansible\n        command:\n        - /usr/local/bin/ao-logs\n        - /tmp/ansible-operator/runner\n        - stdout\n        image: quay.io/multi-arch/benchmark-operator:latest\n        imagePullPolicy: Always\n        volumeMounts:\n        - mountPath: /tmp/ansible-operator/runner\n          name: runner\n          readOnly: true\n      - name: benchmark-operator\n        image: quay.io/multi-arch/benchmark-operator:latest\n        imagePullPolicy: Always\n        env:\n        - name: WATCH_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: OPERATOR_NAME\n          value: benchmark-operator\n        - name: WORKER_BENCHMARK_RIPSAW_CLOUDBULLDOZER_IO\n          value: '1'\n        - name: ANSIBLE_VERBOSITY\n          value: '4'\n        volumeMounts:\n        - mountPath: /tmp/ansible-operator/runner\n          name: runner\n      - name: redis-master\n        image: k8s.gcr.io/redis:v1\n        env:\n        - name: MASTER\n          value: 'true'\n        ports:\n        - containerPort: 6379\n        resources:\n          limits:\n            cpu: '0.1'\n        volumeMounts:\n        - mountPath: /redis-master-data\n          name: data\n      volumes:\n      - name: data\n        emptyDir: {}\n      - name: runner\n        emptyDir: {}\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"ansible\" is using an invalid container image, \"quay.io/multi-arch/benchmark-operator:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "03125",
    "manifest_path": "data/manifests/the_stack_sample/sample_1325.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: benchmark-operator\n  namespace: my-ripsaw\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: benchmark-operator\n  template:\n    metadata:\n      labels:\n        name: benchmark-operator\n    spec:\n      affinity:\n        nodeAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - weight: 100\n            preference:\n              matchExpressions:\n              - key: node-role.kubernetes.io/workload\n                operator: In\n                values:\n                - ''\n      serviceAccountName: benchmark-operator\n      containers:\n      - name: ansible\n        command:\n        - /usr/local/bin/ao-logs\n        - /tmp/ansible-operator/runner\n        - stdout\n        image: quay.io/multi-arch/benchmark-operator:latest\n        imagePullPolicy: Always\n        volumeMounts:\n        - mountPath: /tmp/ansible-operator/runner\n          name: runner\n          readOnly: true\n      - name: benchmark-operator\n        image: quay.io/multi-arch/benchmark-operator:latest\n        imagePullPolicy: Always\n        env:\n        - name: WATCH_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: OPERATOR_NAME\n          value: benchmark-operator\n        - name: WORKER_BENCHMARK_RIPSAW_CLOUDBULLDOZER_IO\n          value: '1'\n        - name: ANSIBLE_VERBOSITY\n          value: '4'\n        volumeMounts:\n        - mountPath: /tmp/ansible-operator/runner\n          name: runner\n      - name: redis-master\n        image: k8s.gcr.io/redis:v1\n        env:\n        - name: MASTER\n          value: 'true'\n        ports:\n        - containerPort: 6379\n        resources:\n          limits:\n            cpu: '0.1'\n        volumeMounts:\n        - mountPath: /redis-master-data\n          name: data\n      volumes:\n      - name: data\n        emptyDir: {}\n      - name: runner\n        emptyDir: {}\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"benchmark-operator\" is using an invalid container image, \"quay.io/multi-arch/benchmark-operator:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "03126",
    "manifest_path": "data/manifests/the_stack_sample/sample_1325.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: benchmark-operator\n  namespace: my-ripsaw\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: benchmark-operator\n  template:\n    metadata:\n      labels:\n        name: benchmark-operator\n    spec:\n      affinity:\n        nodeAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - weight: 100\n            preference:\n              matchExpressions:\n              - key: node-role.kubernetes.io/workload\n                operator: In\n                values:\n                - ''\n      serviceAccountName: benchmark-operator\n      containers:\n      - name: ansible\n        command:\n        - /usr/local/bin/ao-logs\n        - /tmp/ansible-operator/runner\n        - stdout\n        image: quay.io/multi-arch/benchmark-operator:latest\n        imagePullPolicy: Always\n        volumeMounts:\n        - mountPath: /tmp/ansible-operator/runner\n          name: runner\n          readOnly: true\n      - name: benchmark-operator\n        image: quay.io/multi-arch/benchmark-operator:latest\n        imagePullPolicy: Always\n        env:\n        - name: WATCH_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: OPERATOR_NAME\n          value: benchmark-operator\n        - name: WORKER_BENCHMARK_RIPSAW_CLOUDBULLDOZER_IO\n          value: '1'\n        - name: ANSIBLE_VERBOSITY\n          value: '4'\n        volumeMounts:\n        - mountPath: /tmp/ansible-operator/runner\n          name: runner\n      - name: redis-master\n        image: k8s.gcr.io/redis:v1\n        env:\n        - name: MASTER\n          value: 'true'\n        ports:\n        - containerPort: 6379\n        resources:\n          limits:\n            cpu: '0.1'\n        volumeMounts:\n        - mountPath: /redis-master-data\n          name: data\n      volumes:\n      - name: data\n        emptyDir: {}\n      - name: runner\n        emptyDir: {}\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"ansible\" does not have a read-only root file system"
  },
  {
    "id": "03127",
    "manifest_path": "data/manifests/the_stack_sample/sample_1325.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: benchmark-operator\n  namespace: my-ripsaw\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: benchmark-operator\n  template:\n    metadata:\n      labels:\n        name: benchmark-operator\n    spec:\n      affinity:\n        nodeAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - weight: 100\n            preference:\n              matchExpressions:\n              - key: node-role.kubernetes.io/workload\n                operator: In\n                values:\n                - ''\n      serviceAccountName: benchmark-operator\n      containers:\n      - name: ansible\n        command:\n        - /usr/local/bin/ao-logs\n        - /tmp/ansible-operator/runner\n        - stdout\n        image: quay.io/multi-arch/benchmark-operator:latest\n        imagePullPolicy: Always\n        volumeMounts:\n        - mountPath: /tmp/ansible-operator/runner\n          name: runner\n          readOnly: true\n      - name: benchmark-operator\n        image: quay.io/multi-arch/benchmark-operator:latest\n        imagePullPolicy: Always\n        env:\n        - name: WATCH_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: OPERATOR_NAME\n          value: benchmark-operator\n        - name: WORKER_BENCHMARK_RIPSAW_CLOUDBULLDOZER_IO\n          value: '1'\n        - name: ANSIBLE_VERBOSITY\n          value: '4'\n        volumeMounts:\n        - mountPath: /tmp/ansible-operator/runner\n          name: runner\n      - name: redis-master\n        image: k8s.gcr.io/redis:v1\n        env:\n        - name: MASTER\n          value: 'true'\n        ports:\n        - containerPort: 6379\n        resources:\n          limits:\n            cpu: '0.1'\n        volumeMounts:\n        - mountPath: /redis-master-data\n          name: data\n      volumes:\n      - name: data\n        emptyDir: {}\n      - name: runner\n        emptyDir: {}\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"benchmark-operator\" does not have a read-only root file system"
  },
  {
    "id": "03128",
    "manifest_path": "data/manifests/the_stack_sample/sample_1325.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: benchmark-operator\n  namespace: my-ripsaw\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: benchmark-operator\n  template:\n    metadata:\n      labels:\n        name: benchmark-operator\n    spec:\n      affinity:\n        nodeAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - weight: 100\n            preference:\n              matchExpressions:\n              - key: node-role.kubernetes.io/workload\n                operator: In\n                values:\n                - ''\n      serviceAccountName: benchmark-operator\n      containers:\n      - name: ansible\n        command:\n        - /usr/local/bin/ao-logs\n        - /tmp/ansible-operator/runner\n        - stdout\n        image: quay.io/multi-arch/benchmark-operator:latest\n        imagePullPolicy: Always\n        volumeMounts:\n        - mountPath: /tmp/ansible-operator/runner\n          name: runner\n          readOnly: true\n      - name: benchmark-operator\n        image: quay.io/multi-arch/benchmark-operator:latest\n        imagePullPolicy: Always\n        env:\n        - name: WATCH_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: OPERATOR_NAME\n          value: benchmark-operator\n        - name: WORKER_BENCHMARK_RIPSAW_CLOUDBULLDOZER_IO\n          value: '1'\n        - name: ANSIBLE_VERBOSITY\n          value: '4'\n        volumeMounts:\n        - mountPath: /tmp/ansible-operator/runner\n          name: runner\n      - name: redis-master\n        image: k8s.gcr.io/redis:v1\n        env:\n        - name: MASTER\n          value: 'true'\n        ports:\n        - containerPort: 6379\n        resources:\n          limits:\n            cpu: '0.1'\n        volumeMounts:\n        - mountPath: /redis-master-data\n          name: data\n      volumes:\n      - name: data\n        emptyDir: {}\n      - name: runner\n        emptyDir: {}\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"redis-master\" does not have a read-only root file system"
  },
  {
    "id": "03129",
    "manifest_path": "data/manifests/the_stack_sample/sample_1325.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: benchmark-operator\n  namespace: my-ripsaw\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: benchmark-operator\n  template:\n    metadata:\n      labels:\n        name: benchmark-operator\n    spec:\n      affinity:\n        nodeAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - weight: 100\n            preference:\n              matchExpressions:\n              - key: node-role.kubernetes.io/workload\n                operator: In\n                values:\n                - ''\n      serviceAccountName: benchmark-operator\n      containers:\n      - name: ansible\n        command:\n        - /usr/local/bin/ao-logs\n        - /tmp/ansible-operator/runner\n        - stdout\n        image: quay.io/multi-arch/benchmark-operator:latest\n        imagePullPolicy: Always\n        volumeMounts:\n        - mountPath: /tmp/ansible-operator/runner\n          name: runner\n          readOnly: true\n      - name: benchmark-operator\n        image: quay.io/multi-arch/benchmark-operator:latest\n        imagePullPolicy: Always\n        env:\n        - name: WATCH_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: OPERATOR_NAME\n          value: benchmark-operator\n        - name: WORKER_BENCHMARK_RIPSAW_CLOUDBULLDOZER_IO\n          value: '1'\n        - name: ANSIBLE_VERBOSITY\n          value: '4'\n        volumeMounts:\n        - mountPath: /tmp/ansible-operator/runner\n          name: runner\n      - name: redis-master\n        image: k8s.gcr.io/redis:v1\n        env:\n        - name: MASTER\n          value: 'true'\n        ports:\n        - containerPort: 6379\n        resources:\n          limits:\n            cpu: '0.1'\n        volumeMounts:\n        - mountPath: /redis-master-data\n          name: data\n      volumes:\n      - name: data\n        emptyDir: {}\n      - name: runner\n        emptyDir: {}\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"ansible\" is not set to runAsNonRoot"
  },
  {
    "id": "03130",
    "manifest_path": "data/manifests/the_stack_sample/sample_1325.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: benchmark-operator\n  namespace: my-ripsaw\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: benchmark-operator\n  template:\n    metadata:\n      labels:\n        name: benchmark-operator\n    spec:\n      affinity:\n        nodeAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - weight: 100\n            preference:\n              matchExpressions:\n              - key: node-role.kubernetes.io/workload\n                operator: In\n                values:\n                - ''\n      serviceAccountName: benchmark-operator\n      containers:\n      - name: ansible\n        command:\n        - /usr/local/bin/ao-logs\n        - /tmp/ansible-operator/runner\n        - stdout\n        image: quay.io/multi-arch/benchmark-operator:latest\n        imagePullPolicy: Always\n        volumeMounts:\n        - mountPath: /tmp/ansible-operator/runner\n          name: runner\n          readOnly: true\n      - name: benchmark-operator\n        image: quay.io/multi-arch/benchmark-operator:latest\n        imagePullPolicy: Always\n        env:\n        - name: WATCH_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: OPERATOR_NAME\n          value: benchmark-operator\n        - name: WORKER_BENCHMARK_RIPSAW_CLOUDBULLDOZER_IO\n          value: '1'\n        - name: ANSIBLE_VERBOSITY\n          value: '4'\n        volumeMounts:\n        - mountPath: /tmp/ansible-operator/runner\n          name: runner\n      - name: redis-master\n        image: k8s.gcr.io/redis:v1\n        env:\n        - name: MASTER\n          value: 'true'\n        ports:\n        - containerPort: 6379\n        resources:\n          limits:\n            cpu: '0.1'\n        volumeMounts:\n        - mountPath: /redis-master-data\n          name: data\n      volumes:\n      - name: data\n        emptyDir: {}\n      - name: runner\n        emptyDir: {}\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"benchmark-operator\" is not set to runAsNonRoot"
  },
  {
    "id": "03131",
    "manifest_path": "data/manifests/the_stack_sample/sample_1325.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: benchmark-operator\n  namespace: my-ripsaw\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: benchmark-operator\n  template:\n    metadata:\n      labels:\n        name: benchmark-operator\n    spec:\n      affinity:\n        nodeAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - weight: 100\n            preference:\n              matchExpressions:\n              - key: node-role.kubernetes.io/workload\n                operator: In\n                values:\n                - ''\n      serviceAccountName: benchmark-operator\n      containers:\n      - name: ansible\n        command:\n        - /usr/local/bin/ao-logs\n        - /tmp/ansible-operator/runner\n        - stdout\n        image: quay.io/multi-arch/benchmark-operator:latest\n        imagePullPolicy: Always\n        volumeMounts:\n        - mountPath: /tmp/ansible-operator/runner\n          name: runner\n          readOnly: true\n      - name: benchmark-operator\n        image: quay.io/multi-arch/benchmark-operator:latest\n        imagePullPolicy: Always\n        env:\n        - name: WATCH_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: OPERATOR_NAME\n          value: benchmark-operator\n        - name: WORKER_BENCHMARK_RIPSAW_CLOUDBULLDOZER_IO\n          value: '1'\n        - name: ANSIBLE_VERBOSITY\n          value: '4'\n        volumeMounts:\n        - mountPath: /tmp/ansible-operator/runner\n          name: runner\n      - name: redis-master\n        image: k8s.gcr.io/redis:v1\n        env:\n        - name: MASTER\n          value: 'true'\n        ports:\n        - containerPort: 6379\n        resources:\n          limits:\n            cpu: '0.1'\n        volumeMounts:\n        - mountPath: /redis-master-data\n          name: data\n      volumes:\n      - name: data\n        emptyDir: {}\n      - name: runner\n        emptyDir: {}\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"redis-master\" is not set to runAsNonRoot"
  },
  {
    "id": "03132",
    "manifest_path": "data/manifests/the_stack_sample/sample_1325.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: benchmark-operator\n  namespace: my-ripsaw\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: benchmark-operator\n  template:\n    metadata:\n      labels:\n        name: benchmark-operator\n    spec:\n      affinity:\n        nodeAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - weight: 100\n            preference:\n              matchExpressions:\n              - key: node-role.kubernetes.io/workload\n                operator: In\n                values:\n                - ''\n      serviceAccountName: benchmark-operator\n      containers:\n      - name: ansible\n        command:\n        - /usr/local/bin/ao-logs\n        - /tmp/ansible-operator/runner\n        - stdout\n        image: quay.io/multi-arch/benchmark-operator:latest\n        imagePullPolicy: Always\n        volumeMounts:\n        - mountPath: /tmp/ansible-operator/runner\n          name: runner\n          readOnly: true\n      - name: benchmark-operator\n        image: quay.io/multi-arch/benchmark-operator:latest\n        imagePullPolicy: Always\n        env:\n        - name: WATCH_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: OPERATOR_NAME\n          value: benchmark-operator\n        - name: WORKER_BENCHMARK_RIPSAW_CLOUDBULLDOZER_IO\n          value: '1'\n        - name: ANSIBLE_VERBOSITY\n          value: '4'\n        volumeMounts:\n        - mountPath: /tmp/ansible-operator/runner\n          name: runner\n      - name: redis-master\n        image: k8s.gcr.io/redis:v1\n        env:\n        - name: MASTER\n          value: 'true'\n        ports:\n        - containerPort: 6379\n        resources:\n          limits:\n            cpu: '0.1'\n        volumeMounts:\n        - mountPath: /redis-master-data\n          name: data\n      volumes:\n      - name: data\n        emptyDir: {}\n      - name: runner\n        emptyDir: {}\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"ansible\" has cpu request 0"
  },
  {
    "id": "03133",
    "manifest_path": "data/manifests/the_stack_sample/sample_1325.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: benchmark-operator\n  namespace: my-ripsaw\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: benchmark-operator\n  template:\n    metadata:\n      labels:\n        name: benchmark-operator\n    spec:\n      affinity:\n        nodeAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - weight: 100\n            preference:\n              matchExpressions:\n              - key: node-role.kubernetes.io/workload\n                operator: In\n                values:\n                - ''\n      serviceAccountName: benchmark-operator\n      containers:\n      - name: ansible\n        command:\n        - /usr/local/bin/ao-logs\n        - /tmp/ansible-operator/runner\n        - stdout\n        image: quay.io/multi-arch/benchmark-operator:latest\n        imagePullPolicy: Always\n        volumeMounts:\n        - mountPath: /tmp/ansible-operator/runner\n          name: runner\n          readOnly: true\n      - name: benchmark-operator\n        image: quay.io/multi-arch/benchmark-operator:latest\n        imagePullPolicy: Always\n        env:\n        - name: WATCH_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: OPERATOR_NAME\n          value: benchmark-operator\n        - name: WORKER_BENCHMARK_RIPSAW_CLOUDBULLDOZER_IO\n          value: '1'\n        - name: ANSIBLE_VERBOSITY\n          value: '4'\n        volumeMounts:\n        - mountPath: /tmp/ansible-operator/runner\n          name: runner\n      - name: redis-master\n        image: k8s.gcr.io/redis:v1\n        env:\n        - name: MASTER\n          value: 'true'\n        ports:\n        - containerPort: 6379\n        resources:\n          limits:\n            cpu: '0.1'\n        volumeMounts:\n        - mountPath: /redis-master-data\n          name: data\n      volumes:\n      - name: data\n        emptyDir: {}\n      - name: runner\n        emptyDir: {}\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"benchmark-operator\" has cpu request 0"
  },
  {
    "id": "03134",
    "manifest_path": "data/manifests/the_stack_sample/sample_1325.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: benchmark-operator\n  namespace: my-ripsaw\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: benchmark-operator\n  template:\n    metadata:\n      labels:\n        name: benchmark-operator\n    spec:\n      affinity:\n        nodeAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - weight: 100\n            preference:\n              matchExpressions:\n              - key: node-role.kubernetes.io/workload\n                operator: In\n                values:\n                - ''\n      serviceAccountName: benchmark-operator\n      containers:\n      - name: ansible\n        command:\n        - /usr/local/bin/ao-logs\n        - /tmp/ansible-operator/runner\n        - stdout\n        image: quay.io/multi-arch/benchmark-operator:latest\n        imagePullPolicy: Always\n        volumeMounts:\n        - mountPath: /tmp/ansible-operator/runner\n          name: runner\n          readOnly: true\n      - name: benchmark-operator\n        image: quay.io/multi-arch/benchmark-operator:latest\n        imagePullPolicy: Always\n        env:\n        - name: WATCH_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: OPERATOR_NAME\n          value: benchmark-operator\n        - name: WORKER_BENCHMARK_RIPSAW_CLOUDBULLDOZER_IO\n          value: '1'\n        - name: ANSIBLE_VERBOSITY\n          value: '4'\n        volumeMounts:\n        - mountPath: /tmp/ansible-operator/runner\n          name: runner\n      - name: redis-master\n        image: k8s.gcr.io/redis:v1\n        env:\n        - name: MASTER\n          value: 'true'\n        ports:\n        - containerPort: 6379\n        resources:\n          limits:\n            cpu: '0.1'\n        volumeMounts:\n        - mountPath: /redis-master-data\n          name: data\n      volumes:\n      - name: data\n        emptyDir: {}\n      - name: runner\n        emptyDir: {}\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"redis-master\" has cpu request 0"
  },
  {
    "id": "03135",
    "manifest_path": "data/manifests/the_stack_sample/sample_1325.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: benchmark-operator\n  namespace: my-ripsaw\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: benchmark-operator\n  template:\n    metadata:\n      labels:\n        name: benchmark-operator\n    spec:\n      affinity:\n        nodeAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - weight: 100\n            preference:\n              matchExpressions:\n              - key: node-role.kubernetes.io/workload\n                operator: In\n                values:\n                - ''\n      serviceAccountName: benchmark-operator\n      containers:\n      - name: ansible\n        command:\n        - /usr/local/bin/ao-logs\n        - /tmp/ansible-operator/runner\n        - stdout\n        image: quay.io/multi-arch/benchmark-operator:latest\n        imagePullPolicy: Always\n        volumeMounts:\n        - mountPath: /tmp/ansible-operator/runner\n          name: runner\n          readOnly: true\n      - name: benchmark-operator\n        image: quay.io/multi-arch/benchmark-operator:latest\n        imagePullPolicy: Always\n        env:\n        - name: WATCH_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: OPERATOR_NAME\n          value: benchmark-operator\n        - name: WORKER_BENCHMARK_RIPSAW_CLOUDBULLDOZER_IO\n          value: '1'\n        - name: ANSIBLE_VERBOSITY\n          value: '4'\n        volumeMounts:\n        - mountPath: /tmp/ansible-operator/runner\n          name: runner\n      - name: redis-master\n        image: k8s.gcr.io/redis:v1\n        env:\n        - name: MASTER\n          value: 'true'\n        ports:\n        - containerPort: 6379\n        resources:\n          limits:\n            cpu: '0.1'\n        volumeMounts:\n        - mountPath: /redis-master-data\n          name: data\n      volumes:\n      - name: data\n        emptyDir: {}\n      - name: runner\n        emptyDir: {}\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"ansible\" has memory limit 0"
  },
  {
    "id": "03136",
    "manifest_path": "data/manifests/the_stack_sample/sample_1325.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: benchmark-operator\n  namespace: my-ripsaw\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: benchmark-operator\n  template:\n    metadata:\n      labels:\n        name: benchmark-operator\n    spec:\n      affinity:\n        nodeAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - weight: 100\n            preference:\n              matchExpressions:\n              - key: node-role.kubernetes.io/workload\n                operator: In\n                values:\n                - ''\n      serviceAccountName: benchmark-operator\n      containers:\n      - name: ansible\n        command:\n        - /usr/local/bin/ao-logs\n        - /tmp/ansible-operator/runner\n        - stdout\n        image: quay.io/multi-arch/benchmark-operator:latest\n        imagePullPolicy: Always\n        volumeMounts:\n        - mountPath: /tmp/ansible-operator/runner\n          name: runner\n          readOnly: true\n      - name: benchmark-operator\n        image: quay.io/multi-arch/benchmark-operator:latest\n        imagePullPolicy: Always\n        env:\n        - name: WATCH_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: OPERATOR_NAME\n          value: benchmark-operator\n        - name: WORKER_BENCHMARK_RIPSAW_CLOUDBULLDOZER_IO\n          value: '1'\n        - name: ANSIBLE_VERBOSITY\n          value: '4'\n        volumeMounts:\n        - mountPath: /tmp/ansible-operator/runner\n          name: runner\n      - name: redis-master\n        image: k8s.gcr.io/redis:v1\n        env:\n        - name: MASTER\n          value: 'true'\n        ports:\n        - containerPort: 6379\n        resources:\n          limits:\n            cpu: '0.1'\n        volumeMounts:\n        - mountPath: /redis-master-data\n          name: data\n      volumes:\n      - name: data\n        emptyDir: {}\n      - name: runner\n        emptyDir: {}\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"benchmark-operator\" has memory limit 0"
  },
  {
    "id": "03137",
    "manifest_path": "data/manifests/the_stack_sample/sample_1325.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: benchmark-operator\n  namespace: my-ripsaw\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: benchmark-operator\n  template:\n    metadata:\n      labels:\n        name: benchmark-operator\n    spec:\n      affinity:\n        nodeAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - weight: 100\n            preference:\n              matchExpressions:\n              - key: node-role.kubernetes.io/workload\n                operator: In\n                values:\n                - ''\n      serviceAccountName: benchmark-operator\n      containers:\n      - name: ansible\n        command:\n        - /usr/local/bin/ao-logs\n        - /tmp/ansible-operator/runner\n        - stdout\n        image: quay.io/multi-arch/benchmark-operator:latest\n        imagePullPolicy: Always\n        volumeMounts:\n        - mountPath: /tmp/ansible-operator/runner\n          name: runner\n          readOnly: true\n      - name: benchmark-operator\n        image: quay.io/multi-arch/benchmark-operator:latest\n        imagePullPolicy: Always\n        env:\n        - name: WATCH_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: OPERATOR_NAME\n          value: benchmark-operator\n        - name: WORKER_BENCHMARK_RIPSAW_CLOUDBULLDOZER_IO\n          value: '1'\n        - name: ANSIBLE_VERBOSITY\n          value: '4'\n        volumeMounts:\n        - mountPath: /tmp/ansible-operator/runner\n          name: runner\n      - name: redis-master\n        image: k8s.gcr.io/redis:v1\n        env:\n        - name: MASTER\n          value: 'true'\n        ports:\n        - containerPort: 6379\n        resources:\n          limits:\n            cpu: '0.1'\n        volumeMounts:\n        - mountPath: /redis-master-data\n          name: data\n      volumes:\n      - name: data\n        emptyDir: {}\n      - name: runner\n        emptyDir: {}\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"redis-master\" has memory limit 0"
  },
  {
    "id": "03138",
    "manifest_path": "data/manifests/the_stack_sample/sample_1331.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  namespace: jobs\nspec:\n  template:\n    spec:\n      containers:\n      - name: job-app\n        image: cimox/job-app:0.0.6\n        env:\n        - name: EDGE_API_URL\n          value: http://edge-app-service.edge.svc.cluster.local:5000/job\n        - name: JOB_TYPE\n          value: stateful\n        - name: FIB_N\n          value: '35'\n        volumeMounts:\n        - mountPath: /mnt/storage\n          name: storage\n        resources:\n          requests:\n            memory: 64Mi\n            cpu: 250m\n          limits:\n            memory: 128Mi\n            cpu: 500m\n      volumes:\n      - name: storage\n        hostPath:\n          path: /c/minikube-pv\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"job-app\" does not have a read-only root file system"
  },
  {
    "id": "03139",
    "manifest_path": "data/manifests/the_stack_sample/sample_1331.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  namespace: jobs\nspec:\n  template:\n    spec:\n      containers:\n      - name: job-app\n        image: cimox/job-app:0.0.6\n        env:\n        - name: EDGE_API_URL\n          value: http://edge-app-service.edge.svc.cluster.local:5000/job\n        - name: JOB_TYPE\n          value: stateful\n        - name: FIB_N\n          value: '35'\n        volumeMounts:\n        - mountPath: /mnt/storage\n          name: storage\n        resources:\n          requests:\n            memory: 64Mi\n            cpu: 250m\n          limits:\n            memory: 128Mi\n            cpu: 500m\n      volumes:\n      - name: storage\n        hostPath:\n          path: /c/minikube-pv\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"job-app\" is not set to runAsNonRoot"
  },
  {
    "id": "03140",
    "manifest_path": "data/manifests/the_stack_sample/sample_1333.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: deck\n  labels:\n    app: deck\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: deck\n  template:\n    metadata:\n      labels:\n        app: deck\n    spec:\n      serviceAccountName: deck\n      containers:\n      - name: deck\n        image: gcr.io/k8s-prow/deck:v20220114-6a6ac6b4e0\n        imagePullPolicy: Always\n        ports:\n        - name: http\n          containerPort: 8080\n        - name: metrics\n          containerPort: 9090\n        args:\n        - --tide-url=http://tide/\n        - --hook-url=http://hook:8888/plugin-help\n        - --redirect-http-to=prow.k8s.io\n        - --oauth-url=/github-login\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        - --spyglass=true\n        - --rerun-creates-job\n        - --github-token-path=/etc/github/oauth\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --github-oauth-config-file=/etc/githuboauth/secret\n        - --cookie-secret=/etc/cookie/secret\n        - --plugin-config=/etc/plugins/plugins.yaml\n        env:\n        - name: KUBECONFIG\n          value: /etc/kubeconfig/config:/etc/kubeconfig-build-test-infra-trusted/kubeconfig\n        volumeMounts:\n        - name: oauth-config\n          mountPath: /etc/githuboauth\n          readOnly: true\n        - name: cookie-secret\n          mountPath: /etc/cookie\n          readOnly: true\n        - mountPath: /etc/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        - mountPath: /etc/kubeconfig-build-test-infra-trusted\n          name: kubeconfig-build-test-infra-trusted\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        - name: oauth-token\n          mountPath: /etc/github\n          readOnly: true\n        - name: plugins\n          mountPath: /etc/plugins\n          readOnly: true\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 8081\n          initialDelaySeconds: 3\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /healthz/ready\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 3\n          timeoutSeconds: 600\n      volumes:\n      - name: oauth-config\n        secret:\n          secretName: github-oauth-config\n      - name: oauth-token\n        secret:\n          secretName: oauth-token\n      - name: cookie-secret\n        secret:\n          secretName: cookie\n      - name: kubeconfig\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig\n      - name: kubeconfig-build-test-infra-trusted\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig-build-test-infra-trusted\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n      - name: plugins\n        configMap:\n          name: plugins\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"deck\" does not have a read-only root file system"
  },
  {
    "id": "03141",
    "manifest_path": "data/manifests/the_stack_sample/sample_1333.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: deck\n  labels:\n    app: deck\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: deck\n  template:\n    metadata:\n      labels:\n        app: deck\n    spec:\n      serviceAccountName: deck\n      containers:\n      - name: deck\n        image: gcr.io/k8s-prow/deck:v20220114-6a6ac6b4e0\n        imagePullPolicy: Always\n        ports:\n        - name: http\n          containerPort: 8080\n        - name: metrics\n          containerPort: 9090\n        args:\n        - --tide-url=http://tide/\n        - --hook-url=http://hook:8888/plugin-help\n        - --redirect-http-to=prow.k8s.io\n        - --oauth-url=/github-login\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        - --spyglass=true\n        - --rerun-creates-job\n        - --github-token-path=/etc/github/oauth\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --github-oauth-config-file=/etc/githuboauth/secret\n        - --cookie-secret=/etc/cookie/secret\n        - --plugin-config=/etc/plugins/plugins.yaml\n        env:\n        - name: KUBECONFIG\n          value: /etc/kubeconfig/config:/etc/kubeconfig-build-test-infra-trusted/kubeconfig\n        volumeMounts:\n        - name: oauth-config\n          mountPath: /etc/githuboauth\n          readOnly: true\n        - name: cookie-secret\n          mountPath: /etc/cookie\n          readOnly: true\n        - mountPath: /etc/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        - mountPath: /etc/kubeconfig-build-test-infra-trusted\n          name: kubeconfig-build-test-infra-trusted\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        - name: oauth-token\n          mountPath: /etc/github\n          readOnly: true\n        - name: plugins\n          mountPath: /etc/plugins\n          readOnly: true\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 8081\n          initialDelaySeconds: 3\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /healthz/ready\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 3\n          timeoutSeconds: 600\n      volumes:\n      - name: oauth-config\n        secret:\n          secretName: github-oauth-config\n      - name: oauth-token\n        secret:\n          secretName: oauth-token\n      - name: cookie-secret\n        secret:\n          secretName: cookie\n      - name: kubeconfig\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig\n      - name: kubeconfig-build-test-infra-trusted\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig-build-test-infra-trusted\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n      - name: plugins\n        configMap:\n          name: plugins\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"deck\" is not set to runAsNonRoot"
  },
  {
    "id": "03142",
    "manifest_path": "data/manifests/the_stack_sample/sample_1333.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: deck\n  labels:\n    app: deck\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: deck\n  template:\n    metadata:\n      labels:\n        app: deck\n    spec:\n      serviceAccountName: deck\n      containers:\n      - name: deck\n        image: gcr.io/k8s-prow/deck:v20220114-6a6ac6b4e0\n        imagePullPolicy: Always\n        ports:\n        - name: http\n          containerPort: 8080\n        - name: metrics\n          containerPort: 9090\n        args:\n        - --tide-url=http://tide/\n        - --hook-url=http://hook:8888/plugin-help\n        - --redirect-http-to=prow.k8s.io\n        - --oauth-url=/github-login\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        - --spyglass=true\n        - --rerun-creates-job\n        - --github-token-path=/etc/github/oauth\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --github-oauth-config-file=/etc/githuboauth/secret\n        - --cookie-secret=/etc/cookie/secret\n        - --plugin-config=/etc/plugins/plugins.yaml\n        env:\n        - name: KUBECONFIG\n          value: /etc/kubeconfig/config:/etc/kubeconfig-build-test-infra-trusted/kubeconfig\n        volumeMounts:\n        - name: oauth-config\n          mountPath: /etc/githuboauth\n          readOnly: true\n        - name: cookie-secret\n          mountPath: /etc/cookie\n          readOnly: true\n        - mountPath: /etc/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        - mountPath: /etc/kubeconfig-build-test-infra-trusted\n          name: kubeconfig-build-test-infra-trusted\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        - name: oauth-token\n          mountPath: /etc/github\n          readOnly: true\n        - name: plugins\n          mountPath: /etc/plugins\n          readOnly: true\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 8081\n          initialDelaySeconds: 3\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /healthz/ready\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 3\n          timeoutSeconds: 600\n      volumes:\n      - name: oauth-config\n        secret:\n          secretName: github-oauth-config\n      - name: oauth-token\n        secret:\n          secretName: oauth-token\n      - name: cookie-secret\n        secret:\n          secretName: cookie\n      - name: kubeconfig\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig\n      - name: kubeconfig-build-test-infra-trusted\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig-build-test-infra-trusted\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n      - name: plugins\n        configMap:\n          name: plugins\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"deck\" has cpu request 0"
  },
  {
    "id": "03143",
    "manifest_path": "data/manifests/the_stack_sample/sample_1333.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: deck\n  labels:\n    app: deck\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: deck\n  template:\n    metadata:\n      labels:\n        app: deck\n    spec:\n      serviceAccountName: deck\n      containers:\n      - name: deck\n        image: gcr.io/k8s-prow/deck:v20220114-6a6ac6b4e0\n        imagePullPolicy: Always\n        ports:\n        - name: http\n          containerPort: 8080\n        - name: metrics\n          containerPort: 9090\n        args:\n        - --tide-url=http://tide/\n        - --hook-url=http://hook:8888/plugin-help\n        - --redirect-http-to=prow.k8s.io\n        - --oauth-url=/github-login\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        - --spyglass=true\n        - --rerun-creates-job\n        - --github-token-path=/etc/github/oauth\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --github-oauth-config-file=/etc/githuboauth/secret\n        - --cookie-secret=/etc/cookie/secret\n        - --plugin-config=/etc/plugins/plugins.yaml\n        env:\n        - name: KUBECONFIG\n          value: /etc/kubeconfig/config:/etc/kubeconfig-build-test-infra-trusted/kubeconfig\n        volumeMounts:\n        - name: oauth-config\n          mountPath: /etc/githuboauth\n          readOnly: true\n        - name: cookie-secret\n          mountPath: /etc/cookie\n          readOnly: true\n        - mountPath: /etc/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        - mountPath: /etc/kubeconfig-build-test-infra-trusted\n          name: kubeconfig-build-test-infra-trusted\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        - name: oauth-token\n          mountPath: /etc/github\n          readOnly: true\n        - name: plugins\n          mountPath: /etc/plugins\n          readOnly: true\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 8081\n          initialDelaySeconds: 3\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /healthz/ready\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 3\n          timeoutSeconds: 600\n      volumes:\n      - name: oauth-config\n        secret:\n          secretName: github-oauth-config\n      - name: oauth-token\n        secret:\n          secretName: oauth-token\n      - name: cookie-secret\n        secret:\n          secretName: cookie\n      - name: kubeconfig\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig\n      - name: kubeconfig-build-test-infra-trusted\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig-build-test-infra-trusted\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n      - name: plugins\n        configMap:\n          name: plugins\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"deck\" has memory limit 0"
  },
  {
    "id": "03144",
    "manifest_path": "data/manifests/the_stack_sample/sample_1334.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-4249\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"nginx\" is using an invalid container image, \"nginx\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "03145",
    "manifest_path": "data/manifests/the_stack_sample/sample_1334.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-4249\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"nginx\" does not have a read-only root file system"
  },
  {
    "id": "03146",
    "manifest_path": "data/manifests/the_stack_sample/sample_1334.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-4249\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"nginx\" is not set to runAsNonRoot"
  },
  {
    "id": "03147",
    "manifest_path": "data/manifests/the_stack_sample/sample_1334.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-4249\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"nginx\" has cpu request 0"
  },
  {
    "id": "03148",
    "manifest_path": "data/manifests/the_stack_sample/sample_1334.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-4249\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"nginx\" has memory limit 0"
  },
  {
    "id": "03149",
    "manifest_path": "data/manifests/the_stack_sample/sample_1336.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: example\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: example\n  template:\n    metadata:\n      labels:\n        app: example\n    spec:\n      containers:\n      - name: example\n        image: ealen/echo-server\n        imagePullPolicy: Always\n        ports:\n        - name: http\n          containerPort: 80\n        resources:\n          requests:\n            cpu: 50m\n            memory: 128Mi\n          limits:\n            cpu: 100m\n            memory: 256Mi\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"example\" is using an invalid container image, \"ealen/echo-server\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "03150",
    "manifest_path": "data/manifests/the_stack_sample/sample_1336.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: example\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: example\n  template:\n    metadata:\n      labels:\n        app: example\n    spec:\n      containers:\n      - name: example\n        image: ealen/echo-server\n        imagePullPolicy: Always\n        ports:\n        - name: http\n          containerPort: 80\n        resources:\n          requests:\n            cpu: 50m\n            memory: 128Mi\n          limits:\n            cpu: 100m\n            memory: 256Mi\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"example\" does not have a read-only root file system"
  },
  {
    "id": "03151",
    "manifest_path": "data/manifests/the_stack_sample/sample_1336.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: example\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: example\n  template:\n    metadata:\n      labels:\n        app: example\n    spec:\n      containers:\n      - name: example\n        image: ealen/echo-server\n        imagePullPolicy: Always\n        ports:\n        - name: http\n          containerPort: 80\n        resources:\n          requests:\n            cpu: 50m\n            memory: 128Mi\n          limits:\n            cpu: 100m\n            memory: 256Mi\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"example\" is not set to runAsNonRoot"
  },
  {
    "id": "03152",
    "manifest_path": "data/manifests/the_stack_sample/sample_1337.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: deck\n  labels:\n    app: deck\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: deck\n  template:\n    metadata:\n      labels:\n        app: deck\n    spec:\n      serviceAccountName: deck\n      containers:\n      - name: deck\n        image: gcr.io/k8s-prow/deck:v20210318-ffb8032f91\n        imagePullPolicy: Always\n        ports:\n        - name: http\n          containerPort: 8080\n        args:\n        - --kubeconfig=/etc/kubeconfig/config\n        - --tide-url=http://tide/\n        - --hook-url=http://hook:8888/plugin-help\n        - --redirect-http-to=status-dev.prow.build.kyma-project.io\n        - --oauth-url=/github-login\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        - --spyglass=true\n        - --rerun-creates-job\n        - --github-token-path=/etc/github/oauth\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --github-oauth-config-file=/etc/githuboauth/secret\n        - --cookie-secret=/etc/cookie/secret\n        - --plugin-config=/etc/plugins/plugins.yaml\n        volumeMounts:\n        - name: oauth-config\n          mountPath: /etc/githuboauth\n          readOnly: true\n        - name: cookie-secret\n          mountPath: /etc/cookie\n          readOnly: true\n        - mountPath: /etc/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        - name: oauth-token\n          mountPath: /etc/github\n          readOnly: true\n        - name: plugins\n          mountPath: /etc/plugins\n          readOnly: true\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 8081\n          initialDelaySeconds: 3\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /healthz/ready\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 3\n          timeoutSeconds: 600\n      volumes:\n      - name: oauth-config\n        secret:\n          secretName: github-oauth-config\n      - name: oauth-token\n        secret:\n          secretName: oauth-token\n      - name: cookie-secret\n        secret:\n          secretName: cookie\n      - name: kubeconfig\n        secret:\n          defaultMode: 420\n          secretName: workload-clusters-kubeconfig\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n      - name: plugins\n        configMap:\n          name: plugins\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"deck\" does not have a read-only root file system"
  },
  {
    "id": "03153",
    "manifest_path": "data/manifests/the_stack_sample/sample_1337.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: deck\n  labels:\n    app: deck\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: deck\n  template:\n    metadata:\n      labels:\n        app: deck\n    spec:\n      serviceAccountName: deck\n      containers:\n      - name: deck\n        image: gcr.io/k8s-prow/deck:v20210318-ffb8032f91\n        imagePullPolicy: Always\n        ports:\n        - name: http\n          containerPort: 8080\n        args:\n        - --kubeconfig=/etc/kubeconfig/config\n        - --tide-url=http://tide/\n        - --hook-url=http://hook:8888/plugin-help\n        - --redirect-http-to=status-dev.prow.build.kyma-project.io\n        - --oauth-url=/github-login\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        - --spyglass=true\n        - --rerun-creates-job\n        - --github-token-path=/etc/github/oauth\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --github-oauth-config-file=/etc/githuboauth/secret\n        - --cookie-secret=/etc/cookie/secret\n        - --plugin-config=/etc/plugins/plugins.yaml\n        volumeMounts:\n        - name: oauth-config\n          mountPath: /etc/githuboauth\n          readOnly: true\n        - name: cookie-secret\n          mountPath: /etc/cookie\n          readOnly: true\n        - mountPath: /etc/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        - name: oauth-token\n          mountPath: /etc/github\n          readOnly: true\n        - name: plugins\n          mountPath: /etc/plugins\n          readOnly: true\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 8081\n          initialDelaySeconds: 3\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /healthz/ready\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 3\n          timeoutSeconds: 600\n      volumes:\n      - name: oauth-config\n        secret:\n          secretName: github-oauth-config\n      - name: oauth-token\n        secret:\n          secretName: oauth-token\n      - name: cookie-secret\n        secret:\n          secretName: cookie\n      - name: kubeconfig\n        secret:\n          defaultMode: 420\n          secretName: workload-clusters-kubeconfig\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n      - name: plugins\n        configMap:\n          name: plugins\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"deck\" is not set to runAsNonRoot"
  },
  {
    "id": "03154",
    "manifest_path": "data/manifests/the_stack_sample/sample_1337.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: deck\n  labels:\n    app: deck\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: deck\n  template:\n    metadata:\n      labels:\n        app: deck\n    spec:\n      serviceAccountName: deck\n      containers:\n      - name: deck\n        image: gcr.io/k8s-prow/deck:v20210318-ffb8032f91\n        imagePullPolicy: Always\n        ports:\n        - name: http\n          containerPort: 8080\n        args:\n        - --kubeconfig=/etc/kubeconfig/config\n        - --tide-url=http://tide/\n        - --hook-url=http://hook:8888/plugin-help\n        - --redirect-http-to=status-dev.prow.build.kyma-project.io\n        - --oauth-url=/github-login\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        - --spyglass=true\n        - --rerun-creates-job\n        - --github-token-path=/etc/github/oauth\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --github-oauth-config-file=/etc/githuboauth/secret\n        - --cookie-secret=/etc/cookie/secret\n        - --plugin-config=/etc/plugins/plugins.yaml\n        volumeMounts:\n        - name: oauth-config\n          mountPath: /etc/githuboauth\n          readOnly: true\n        - name: cookie-secret\n          mountPath: /etc/cookie\n          readOnly: true\n        - mountPath: /etc/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        - name: oauth-token\n          mountPath: /etc/github\n          readOnly: true\n        - name: plugins\n          mountPath: /etc/plugins\n          readOnly: true\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 8081\n          initialDelaySeconds: 3\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /healthz/ready\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 3\n          timeoutSeconds: 600\n      volumes:\n      - name: oauth-config\n        secret:\n          secretName: github-oauth-config\n      - name: oauth-token\n        secret:\n          secretName: oauth-token\n      - name: cookie-secret\n        secret:\n          secretName: cookie\n      - name: kubeconfig\n        secret:\n          defaultMode: 420\n          secretName: workload-clusters-kubeconfig\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n      - name: plugins\n        configMap:\n          name: plugins\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"deck\" has cpu request 0"
  },
  {
    "id": "03155",
    "manifest_path": "data/manifests/the_stack_sample/sample_1337.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: deck\n  labels:\n    app: deck\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: deck\n  template:\n    metadata:\n      labels:\n        app: deck\n    spec:\n      serviceAccountName: deck\n      containers:\n      - name: deck\n        image: gcr.io/k8s-prow/deck:v20210318-ffb8032f91\n        imagePullPolicy: Always\n        ports:\n        - name: http\n          containerPort: 8080\n        args:\n        - --kubeconfig=/etc/kubeconfig/config\n        - --tide-url=http://tide/\n        - --hook-url=http://hook:8888/plugin-help\n        - --redirect-http-to=status-dev.prow.build.kyma-project.io\n        - --oauth-url=/github-login\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        - --spyglass=true\n        - --rerun-creates-job\n        - --github-token-path=/etc/github/oauth\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --github-oauth-config-file=/etc/githuboauth/secret\n        - --cookie-secret=/etc/cookie/secret\n        - --plugin-config=/etc/plugins/plugins.yaml\n        volumeMounts:\n        - name: oauth-config\n          mountPath: /etc/githuboauth\n          readOnly: true\n        - name: cookie-secret\n          mountPath: /etc/cookie\n          readOnly: true\n        - mountPath: /etc/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        - name: oauth-token\n          mountPath: /etc/github\n          readOnly: true\n        - name: plugins\n          mountPath: /etc/plugins\n          readOnly: true\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 8081\n          initialDelaySeconds: 3\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /healthz/ready\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 3\n          timeoutSeconds: 600\n      volumes:\n      - name: oauth-config\n        secret:\n          secretName: github-oauth-config\n      - name: oauth-token\n        secret:\n          secretName: oauth-token\n      - name: cookie-secret\n        secret:\n          secretName: cookie\n      - name: kubeconfig\n        secret:\n          defaultMode: 420\n          secretName: workload-clusters-kubeconfig\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n      - name: plugins\n        configMap:\n          name: plugins\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"deck\" has memory limit 0"
  },
  {
    "id": "03156",
    "manifest_path": "data/manifests/the_stack_sample/sample_1338.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: kelvin\nspec:\n  selector:\n    matchLabels:\n      name: kelvin\n  template:\n    metadata:\n      labels:\n        name: kelvin\n        plane: data\n    spec:\n      affinity:\n        nodeAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n            nodeSelectorTerms:\n            - matchExpressions:\n              - key: kubernetes.io/os\n                operator: Exists\n              - key: kubernetes.io/os\n                operator: In\n                values:\n                - linux\n            - matchExpressions:\n              - key: beta.kubernetes.io/os\n                operator: Exists\n              - key: beta.kubernetes.io/os\n                operator: In\n                values:\n                - linux\n      initContainers:\n      - name: qb-wait\n        image: gcr.io/pixie-prod/pixie-prod-artifacts/curl:1.0\n        command:\n        - sh\n        - -c\n        - 'set -x; URL=\"https://${SERVICE_NAME}:${SERVICE_PORT}/healthz\"; until [\n          $(curl -m 0.5 -s -o /dev/null -w \"%{http_code}\" -k ${URL}) -eq 200 ]; do\n          echo \"waiting for ${URL}\" sleep 2; done; '\n        env:\n        - name: SERVICE_NAME\n          value: vizier-query-broker\n        - name: SERVICE_PORT\n          value: '50300'\n      containers:\n      - name: app\n        image: gcr.io/pixie-oss/pixie-dev/vizier/kelvin_image:latest\n        envFrom:\n        - configMapRef:\n            name: pl-tls-config\n        env:\n        - name: PL_HOST_PATH\n          value: /host\n        - name: PL_POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: PL_POD_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: PL_HOST_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.hostIP\n        - name: PL_JWT_SIGNING_KEY\n          valueFrom:\n            secretKeyRef:\n              key: jwt-signing-key\n              name: pl-cluster-secrets\n        - name: PL_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: TCMALLOC_SAMPLE_PARAMETER\n          value: '1048576'\n        ports:\n        - containerPort: 59300\n        volumeMounts:\n        - mountPath: /certs\n          name: certs\n        - name: sys\n          mountPath: /sys\n          readOnly: true\n        resources: {}\n      volumes:\n      - name: certs\n        secret:\n          secretName: service-tls-certs\n      - name: sys\n        hostPath:\n          path: /sys\n          type: Directory\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"app\" is using an invalid container image, \"gcr.io/pixie-oss/pixie-dev/vizier/kelvin_image:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "03157",
    "manifest_path": "data/manifests/the_stack_sample/sample_1338.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: kelvin\nspec:\n  selector:\n    matchLabels:\n      name: kelvin\n  template:\n    metadata:\n      labels:\n        name: kelvin\n        plane: data\n    spec:\n      affinity:\n        nodeAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n            nodeSelectorTerms:\n            - matchExpressions:\n              - key: kubernetes.io/os\n                operator: Exists\n              - key: kubernetes.io/os\n                operator: In\n                values:\n                - linux\n            - matchExpressions:\n              - key: beta.kubernetes.io/os\n                operator: Exists\n              - key: beta.kubernetes.io/os\n                operator: In\n                values:\n                - linux\n      initContainers:\n      - name: qb-wait\n        image: gcr.io/pixie-prod/pixie-prod-artifacts/curl:1.0\n        command:\n        - sh\n        - -c\n        - 'set -x; URL=\"https://${SERVICE_NAME}:${SERVICE_PORT}/healthz\"; until [\n          $(curl -m 0.5 -s -o /dev/null -w \"%{http_code}\" -k ${URL}) -eq 200 ]; do\n          echo \"waiting for ${URL}\" sleep 2; done; '\n        env:\n        - name: SERVICE_NAME\n          value: vizier-query-broker\n        - name: SERVICE_PORT\n          value: '50300'\n      containers:\n      - name: app\n        image: gcr.io/pixie-oss/pixie-dev/vizier/kelvin_image:latest\n        envFrom:\n        - configMapRef:\n            name: pl-tls-config\n        env:\n        - name: PL_HOST_PATH\n          value: /host\n        - name: PL_POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: PL_POD_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: PL_HOST_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.hostIP\n        - name: PL_JWT_SIGNING_KEY\n          valueFrom:\n            secretKeyRef:\n              key: jwt-signing-key\n              name: pl-cluster-secrets\n        - name: PL_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: TCMALLOC_SAMPLE_PARAMETER\n          value: '1048576'\n        ports:\n        - containerPort: 59300\n        volumeMounts:\n        - mountPath: /certs\n          name: certs\n        - name: sys\n          mountPath: /sys\n          readOnly: true\n        resources: {}\n      volumes:\n      - name: certs\n        secret:\n          secretName: service-tls-certs\n      - name: sys\n        hostPath:\n          path: /sys\n          type: Directory\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"app\" does not have a read-only root file system"
  },
  {
    "id": "03158",
    "manifest_path": "data/manifests/the_stack_sample/sample_1338.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: kelvin\nspec:\n  selector:\n    matchLabels:\n      name: kelvin\n  template:\n    metadata:\n      labels:\n        name: kelvin\n        plane: data\n    spec:\n      affinity:\n        nodeAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n            nodeSelectorTerms:\n            - matchExpressions:\n              - key: kubernetes.io/os\n                operator: Exists\n              - key: kubernetes.io/os\n                operator: In\n                values:\n                - linux\n            - matchExpressions:\n              - key: beta.kubernetes.io/os\n                operator: Exists\n              - key: beta.kubernetes.io/os\n                operator: In\n                values:\n                - linux\n      initContainers:\n      - name: qb-wait\n        image: gcr.io/pixie-prod/pixie-prod-artifacts/curl:1.0\n        command:\n        - sh\n        - -c\n        - 'set -x; URL=\"https://${SERVICE_NAME}:${SERVICE_PORT}/healthz\"; until [\n          $(curl -m 0.5 -s -o /dev/null -w \"%{http_code}\" -k ${URL}) -eq 200 ]; do\n          echo \"waiting for ${URL}\" sleep 2; done; '\n        env:\n        - name: SERVICE_NAME\n          value: vizier-query-broker\n        - name: SERVICE_PORT\n          value: '50300'\n      containers:\n      - name: app\n        image: gcr.io/pixie-oss/pixie-dev/vizier/kelvin_image:latest\n        envFrom:\n        - configMapRef:\n            name: pl-tls-config\n        env:\n        - name: PL_HOST_PATH\n          value: /host\n        - name: PL_POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: PL_POD_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: PL_HOST_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.hostIP\n        - name: PL_JWT_SIGNING_KEY\n          valueFrom:\n            secretKeyRef:\n              key: jwt-signing-key\n              name: pl-cluster-secrets\n        - name: PL_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: TCMALLOC_SAMPLE_PARAMETER\n          value: '1048576'\n        ports:\n        - containerPort: 59300\n        volumeMounts:\n        - mountPath: /certs\n          name: certs\n        - name: sys\n          mountPath: /sys\n          readOnly: true\n        resources: {}\n      volumes:\n      - name: certs\n        secret:\n          secretName: service-tls-certs\n      - name: sys\n        hostPath:\n          path: /sys\n          type: Directory\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"qb-wait\" does not have a read-only root file system"
  },
  {
    "id": "03159",
    "manifest_path": "data/manifests/the_stack_sample/sample_1338.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: kelvin\nspec:\n  selector:\n    matchLabels:\n      name: kelvin\n  template:\n    metadata:\n      labels:\n        name: kelvin\n        plane: data\n    spec:\n      affinity:\n        nodeAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n            nodeSelectorTerms:\n            - matchExpressions:\n              - key: kubernetes.io/os\n                operator: Exists\n              - key: kubernetes.io/os\n                operator: In\n                values:\n                - linux\n            - matchExpressions:\n              - key: beta.kubernetes.io/os\n                operator: Exists\n              - key: beta.kubernetes.io/os\n                operator: In\n                values:\n                - linux\n      initContainers:\n      - name: qb-wait\n        image: gcr.io/pixie-prod/pixie-prod-artifacts/curl:1.0\n        command:\n        - sh\n        - -c\n        - 'set -x; URL=\"https://${SERVICE_NAME}:${SERVICE_PORT}/healthz\"; until [\n          $(curl -m 0.5 -s -o /dev/null -w \"%{http_code}\" -k ${URL}) -eq 200 ]; do\n          echo \"waiting for ${URL}\" sleep 2; done; '\n        env:\n        - name: SERVICE_NAME\n          value: vizier-query-broker\n        - name: SERVICE_PORT\n          value: '50300'\n      containers:\n      - name: app\n        image: gcr.io/pixie-oss/pixie-dev/vizier/kelvin_image:latest\n        envFrom:\n        - configMapRef:\n            name: pl-tls-config\n        env:\n        - name: PL_HOST_PATH\n          value: /host\n        - name: PL_POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: PL_POD_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: PL_HOST_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.hostIP\n        - name: PL_JWT_SIGNING_KEY\n          valueFrom:\n            secretKeyRef:\n              key: jwt-signing-key\n              name: pl-cluster-secrets\n        - name: PL_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: TCMALLOC_SAMPLE_PARAMETER\n          value: '1048576'\n        ports:\n        - containerPort: 59300\n        volumeMounts:\n        - mountPath: /certs\n          name: certs\n        - name: sys\n          mountPath: /sys\n          readOnly: true\n        resources: {}\n      volumes:\n      - name: certs\n        secret:\n          secretName: service-tls-certs\n      - name: sys\n        hostPath:\n          path: /sys\n          type: Directory\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"app\" is not set to runAsNonRoot"
  },
  {
    "id": "03160",
    "manifest_path": "data/manifests/the_stack_sample/sample_1338.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: kelvin\nspec:\n  selector:\n    matchLabels:\n      name: kelvin\n  template:\n    metadata:\n      labels:\n        name: kelvin\n        plane: data\n    spec:\n      affinity:\n        nodeAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n            nodeSelectorTerms:\n            - matchExpressions:\n              - key: kubernetes.io/os\n                operator: Exists\n              - key: kubernetes.io/os\n                operator: In\n                values:\n                - linux\n            - matchExpressions:\n              - key: beta.kubernetes.io/os\n                operator: Exists\n              - key: beta.kubernetes.io/os\n                operator: In\n                values:\n                - linux\n      initContainers:\n      - name: qb-wait\n        image: gcr.io/pixie-prod/pixie-prod-artifacts/curl:1.0\n        command:\n        - sh\n        - -c\n        - 'set -x; URL=\"https://${SERVICE_NAME}:${SERVICE_PORT}/healthz\"; until [\n          $(curl -m 0.5 -s -o /dev/null -w \"%{http_code}\" -k ${URL}) -eq 200 ]; do\n          echo \"waiting for ${URL}\" sleep 2; done; '\n        env:\n        - name: SERVICE_NAME\n          value: vizier-query-broker\n        - name: SERVICE_PORT\n          value: '50300'\n      containers:\n      - name: app\n        image: gcr.io/pixie-oss/pixie-dev/vizier/kelvin_image:latest\n        envFrom:\n        - configMapRef:\n            name: pl-tls-config\n        env:\n        - name: PL_HOST_PATH\n          value: /host\n        - name: PL_POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: PL_POD_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: PL_HOST_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.hostIP\n        - name: PL_JWT_SIGNING_KEY\n          valueFrom:\n            secretKeyRef:\n              key: jwt-signing-key\n              name: pl-cluster-secrets\n        - name: PL_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: TCMALLOC_SAMPLE_PARAMETER\n          value: '1048576'\n        ports:\n        - containerPort: 59300\n        volumeMounts:\n        - mountPath: /certs\n          name: certs\n        - name: sys\n          mountPath: /sys\n          readOnly: true\n        resources: {}\n      volumes:\n      - name: certs\n        secret:\n          secretName: service-tls-certs\n      - name: sys\n        hostPath:\n          path: /sys\n          type: Directory\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"qb-wait\" is not set to runAsNonRoot"
  }
]