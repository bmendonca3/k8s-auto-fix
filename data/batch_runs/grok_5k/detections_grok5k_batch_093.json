[
  {
    "id": "03721",
    "manifest_path": "data/manifests/the_stack_sample/sample_1655.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-7369\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"nginx\" has cpu request 0"
  },
  {
    "id": "03722",
    "manifest_path": "data/manifests/the_stack_sample/sample_1655.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-7369\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"nginx\" has memory limit 0"
  },
  {
    "id": "03723",
    "manifest_path": "data/manifests/the_stack_sample/sample_1658.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: label-sync\nspec:\n  jobTemplate:\n    template:\n      spec:\n        containers:\n        - name: label-sync\n          image: gcr.io/k8s-prow/label_sync:v20200628-cc1c099dad\n          args:\n          - --config=/etc/config/labels.yaml\n          - --confirm=true\n          - --orgs=kubernetes,kubernetes-client,kubernetes-csi,kubernetes-incubator,kubernetes-sigs\n          - --token=/etc/github/oauth\n          volumeMounts:\n          - name: oauth\n            mountPath: /etc/github\n            readOnly: true\n          - name: config\n            mountPath: /etc/config\n            readOnly: true\n        volumes:\n        - name: oauth\n          secret:\n            secretName: oauth-token\n        - name: config\n          configMap:\n            name: label-config\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"label-sync\" does not have a read-only root file system"
  },
  {
    "id": "03724",
    "manifest_path": "data/manifests/the_stack_sample/sample_1658.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: label-sync\nspec:\n  jobTemplate:\n    template:\n      spec:\n        containers:\n        - name: label-sync\n          image: gcr.io/k8s-prow/label_sync:v20200628-cc1c099dad\n          args:\n          - --config=/etc/config/labels.yaml\n          - --confirm=true\n          - --orgs=kubernetes,kubernetes-client,kubernetes-csi,kubernetes-incubator,kubernetes-sigs\n          - --token=/etc/github/oauth\n          volumeMounts:\n          - name: oauth\n            mountPath: /etc/github\n            readOnly: true\n          - name: config\n            mountPath: /etc/config\n            readOnly: true\n        volumes:\n        - name: oauth\n          secret:\n            secretName: oauth-token\n        - name: config\n          configMap:\n            name: label-config\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"label-sync\" is not set to runAsNonRoot"
  },
  {
    "id": "03725",
    "manifest_path": "data/manifests/the_stack_sample/sample_1658.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: label-sync\nspec:\n  jobTemplate:\n    template:\n      spec:\n        containers:\n        - name: label-sync\n          image: gcr.io/k8s-prow/label_sync:v20200628-cc1c099dad\n          args:\n          - --config=/etc/config/labels.yaml\n          - --confirm=true\n          - --orgs=kubernetes,kubernetes-client,kubernetes-csi,kubernetes-incubator,kubernetes-sigs\n          - --token=/etc/github/oauth\n          volumeMounts:\n          - name: oauth\n            mountPath: /etc/github\n            readOnly: true\n          - name: config\n            mountPath: /etc/config\n            readOnly: true\n        volumes:\n        - name: oauth\n          secret:\n            secretName: oauth-token\n        - name: config\n          configMap:\n            name: label-config\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"label-sync\" has cpu request 0"
  },
  {
    "id": "03726",
    "manifest_path": "data/manifests/the_stack_sample/sample_1658.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: label-sync\nspec:\n  jobTemplate:\n    template:\n      spec:\n        containers:\n        - name: label-sync\n          image: gcr.io/k8s-prow/label_sync:v20200628-cc1c099dad\n          args:\n          - --config=/etc/config/labels.yaml\n          - --confirm=true\n          - --orgs=kubernetes,kubernetes-client,kubernetes-csi,kubernetes-incubator,kubernetes-sigs\n          - --token=/etc/github/oauth\n          volumeMounts:\n          - name: oauth\n            mountPath: /etc/github\n            readOnly: true\n          - name: config\n            mountPath: /etc/config\n            readOnly: true\n        volumes:\n        - name: oauth\n          secret:\n            secretName: oauth-token\n        - name: config\n          configMap:\n            name: label-config\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"label-sync\" has memory limit 0"
  },
  {
    "id": "03727",
    "manifest_path": "data/manifests/the_stack_sample/sample_1659.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: demo-pod\nspec:\n  containers:\n  - name: container1\n    image: alpine\n    volumeMounts:\n    - name: volume1\n      mountPath: /mnt\n    command:\n    - dd\n    args:\n    - if=/dev/zero\n    - of=/mnt/demofile\n    - bs=1M\n    - count=1000\n  volumes:\n  - name: volume1\n    persistentVolumeClaim:\n      claimName: demo-pvc\n      readOnly: false\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"container1\" is using an invalid container image, \"alpine\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "03728",
    "manifest_path": "data/manifests/the_stack_sample/sample_1659.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: demo-pod\nspec:\n  containers:\n  - name: container1\n    image: alpine\n    volumeMounts:\n    - name: volume1\n      mountPath: /mnt\n    command:\n    - dd\n    args:\n    - if=/dev/zero\n    - of=/mnt/demofile\n    - bs=1M\n    - count=1000\n  volumes:\n  - name: volume1\n    persistentVolumeClaim:\n      claimName: demo-pvc\n      readOnly: false\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"container1\" does not have a read-only root file system"
  },
  {
    "id": "03729",
    "manifest_path": "data/manifests/the_stack_sample/sample_1659.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: demo-pod\nspec:\n  containers:\n  - name: container1\n    image: alpine\n    volumeMounts:\n    - name: volume1\n      mountPath: /mnt\n    command:\n    - dd\n    args:\n    - if=/dev/zero\n    - of=/mnt/demofile\n    - bs=1M\n    - count=1000\n  volumes:\n  - name: volume1\n    persistentVolumeClaim:\n      claimName: demo-pvc\n      readOnly: false\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"container1\" is not set to runAsNonRoot"
  },
  {
    "id": "03730",
    "manifest_path": "data/manifests/the_stack_sample/sample_1659.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: demo-pod\nspec:\n  containers:\n  - name: container1\n    image: alpine\n    volumeMounts:\n    - name: volume1\n      mountPath: /mnt\n    command:\n    - dd\n    args:\n    - if=/dev/zero\n    - of=/mnt/demofile\n    - bs=1M\n    - count=1000\n  volumes:\n  - name: volume1\n    persistentVolumeClaim:\n      claimName: demo-pvc\n      readOnly: false\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"container1\" has cpu request 0"
  },
  {
    "id": "03731",
    "manifest_path": "data/manifests/the_stack_sample/sample_1659.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: demo-pod\nspec:\n  containers:\n  - name: container1\n    image: alpine\n    volumeMounts:\n    - name: volume1\n      mountPath: /mnt\n    command:\n    - dd\n    args:\n    - if=/dev/zero\n    - of=/mnt/demofile\n    - bs=1M\n    - count=1000\n  volumes:\n  - name: volume1\n    persistentVolumeClaim:\n      claimName: demo-pvc\n      readOnly: false\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"container1\" has memory limit 0"
  },
  {
    "id": "03732",
    "manifest_path": "data/manifests/the_stack_sample/sample_1660.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: storagepodlet\nspec:\n  containers:\n  - name: nginx-with-pv\n    image: nginx:latest\n    ports:\n    - name: http\n      containerPort: 80\n      protocol: TCP\n    volumeMounts:\n    - name: nginx-pv-storage\n      mountPath: /data\n  volumes:\n  - name: nginx-pv-storage\n    persistentVolumeClaim:\n      claimName: persistentclaimchallenge\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"nginx-with-pv\" is using an invalid container image, \"nginx:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "03733",
    "manifest_path": "data/manifests/the_stack_sample/sample_1660.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: storagepodlet\nspec:\n  containers:\n  - name: nginx-with-pv\n    image: nginx:latest\n    ports:\n    - name: http\n      containerPort: 80\n      protocol: TCP\n    volumeMounts:\n    - name: nginx-pv-storage\n      mountPath: /data\n  volumes:\n  - name: nginx-pv-storage\n    persistentVolumeClaim:\n      claimName: persistentclaimchallenge\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"nginx-with-pv\" does not have a read-only root file system"
  },
  {
    "id": "03734",
    "manifest_path": "data/manifests/the_stack_sample/sample_1660.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: storagepodlet\nspec:\n  containers:\n  - name: nginx-with-pv\n    image: nginx:latest\n    ports:\n    - name: http\n      containerPort: 80\n      protocol: TCP\n    volumeMounts:\n    - name: nginx-pv-storage\n      mountPath: /data\n  volumes:\n  - name: nginx-pv-storage\n    persistentVolumeClaim:\n      claimName: persistentclaimchallenge\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"nginx-with-pv\" is not set to runAsNonRoot"
  },
  {
    "id": "03735",
    "manifest_path": "data/manifests/the_stack_sample/sample_1660.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: storagepodlet\nspec:\n  containers:\n  - name: nginx-with-pv\n    image: nginx:latest\n    ports:\n    - name: http\n      containerPort: 80\n      protocol: TCP\n    volumeMounts:\n    - name: nginx-pv-storage\n      mountPath: /data\n  volumes:\n  - name: nginx-pv-storage\n    persistentVolumeClaim:\n      claimName: persistentclaimchallenge\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"nginx-with-pv\" has cpu request 0"
  },
  {
    "id": "03736",
    "manifest_path": "data/manifests/the_stack_sample/sample_1660.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: storagepodlet\nspec:\n  containers:\n  - name: nginx-with-pv\n    image: nginx:latest\n    ports:\n    - name: http\n      containerPort: 80\n      protocol: TCP\n    volumeMounts:\n    - name: nginx-pv-storage\n      mountPath: /data\n  volumes:\n  - name: nginx-pv-storage\n    persistentVolumeClaim:\n      claimName: persistentclaimchallenge\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"nginx-with-pv\" has memory limit 0"
  },
  {
    "id": "03737",
    "manifest_path": "data/manifests/the_stack_sample/sample_1663.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: csi-blob-controller\n  namespace: kube-system\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: csi-blob-controller\n  template:\n    metadata:\n      labels:\n        app: csi-blob-controller\n    spec:\n      serviceAccountName: csi-blob-controller-sa\n      containers:\n      - name: csi-provisioner\n        image: mcr.microsoft.com/oss/kubernetes-csi/csi-provisioner:v2.1.0\n        args:\n        - -v=2\n        - --csi-address=$(ADDRESS)\n        - --leader-election\n        - --timeout=60s\n        - --extra-create-metadata=true\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        volumeMounts:\n        - mountPath: /csi\n          name: socket-dir\n        resources:\n          limits:\n            cpu: 100m\n            memory: 300Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n      - name: liveness-probe\n        image: mcr.microsoft.com/oss/kubernetes-csi/livenessprobe:v2.3.0\n        args:\n        - --csi-address=/csi/csi.sock\n        - --probe-timeout=3s\n        - --health-port=29632\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          limits:\n            cpu: 100m\n            memory: 100Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n      - name: blob\n        image: mcr.microsoft.com/k8s/csi/blob-csi:v1.4.0\n        imagePullPolicy: IfNotPresent\n        args:\n        - --v=5\n        - --endpoint=$(CSI_ENDPOINT)\n        - --metrics-address=0.0.0.0:29634\n        ports:\n        - containerPort: 29632\n          name: healthz\n          protocol: TCP\n        - containerPort: 29634\n          name: metrics\n          protocol: TCP\n        livenessProbe:\n          failureThreshold: 5\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 30\n          timeoutSeconds: 10\n          periodSeconds: 30\n        env:\n        - name: AZURE_CREDENTIAL_FILE\n          valueFrom:\n            configMapKeyRef:\n              name: azure-cred-file\n              key: path\n              optional: true\n        - name: CSI_ENDPOINT\n          value: unix:///csi/csi.sock\n        volumeMounts:\n        - mountPath: /csi\n          name: socket-dir\n        - mountPath: /etc/kubernetes/\n          name: azure-cred\n        - mountPath: /var/lib/waagent/ManagedIdentity-Settings\n          readOnly: true\n          name: msi\n        resources:\n          limits:\n            cpu: 200m\n            memory: 200Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n      - name: csi-resizer\n        image: mcr.microsoft.com/oss/kubernetes-csi/csi-resizer:v1.1.0\n        args:\n        - -csi-address=$(ADDRESS)\n        - -v=2\n        - -leader-election\n        - -handle-volume-inuse-error=false\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          limits:\n            cpu: 100m\n            memory: 300Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n      volumes:\n      - name: socket-dir\n        emptyDir: {}\n      - name: azure-cred\n        hostPath:\n          path: /etc/kubernetes/\n          type: Directory\n      - name: msi\n        hostPath:\n          path: /var/lib/waagent/ManagedIdentity-Settings\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"blob\" does not have a read-only root file system"
  },
  {
    "id": "03738",
    "manifest_path": "data/manifests/the_stack_sample/sample_1663.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: csi-blob-controller\n  namespace: kube-system\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: csi-blob-controller\n  template:\n    metadata:\n      labels:\n        app: csi-blob-controller\n    spec:\n      serviceAccountName: csi-blob-controller-sa\n      containers:\n      - name: csi-provisioner\n        image: mcr.microsoft.com/oss/kubernetes-csi/csi-provisioner:v2.1.0\n        args:\n        - -v=2\n        - --csi-address=$(ADDRESS)\n        - --leader-election\n        - --timeout=60s\n        - --extra-create-metadata=true\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        volumeMounts:\n        - mountPath: /csi\n          name: socket-dir\n        resources:\n          limits:\n            cpu: 100m\n            memory: 300Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n      - name: liveness-probe\n        image: mcr.microsoft.com/oss/kubernetes-csi/livenessprobe:v2.3.0\n        args:\n        - --csi-address=/csi/csi.sock\n        - --probe-timeout=3s\n        - --health-port=29632\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          limits:\n            cpu: 100m\n            memory: 100Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n      - name: blob\n        image: mcr.microsoft.com/k8s/csi/blob-csi:v1.4.0\n        imagePullPolicy: IfNotPresent\n        args:\n        - --v=5\n        - --endpoint=$(CSI_ENDPOINT)\n        - --metrics-address=0.0.0.0:29634\n        ports:\n        - containerPort: 29632\n          name: healthz\n          protocol: TCP\n        - containerPort: 29634\n          name: metrics\n          protocol: TCP\n        livenessProbe:\n          failureThreshold: 5\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 30\n          timeoutSeconds: 10\n          periodSeconds: 30\n        env:\n        - name: AZURE_CREDENTIAL_FILE\n          valueFrom:\n            configMapKeyRef:\n              name: azure-cred-file\n              key: path\n              optional: true\n        - name: CSI_ENDPOINT\n          value: unix:///csi/csi.sock\n        volumeMounts:\n        - mountPath: /csi\n          name: socket-dir\n        - mountPath: /etc/kubernetes/\n          name: azure-cred\n        - mountPath: /var/lib/waagent/ManagedIdentity-Settings\n          readOnly: true\n          name: msi\n        resources:\n          limits:\n            cpu: 200m\n            memory: 200Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n      - name: csi-resizer\n        image: mcr.microsoft.com/oss/kubernetes-csi/csi-resizer:v1.1.0\n        args:\n        - -csi-address=$(ADDRESS)\n        - -v=2\n        - -leader-election\n        - -handle-volume-inuse-error=false\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          limits:\n            cpu: 100m\n            memory: 300Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n      volumes:\n      - name: socket-dir\n        emptyDir: {}\n      - name: azure-cred\n        hostPath:\n          path: /etc/kubernetes/\n          type: Directory\n      - name: msi\n        hostPath:\n          path: /var/lib/waagent/ManagedIdentity-Settings\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"csi-provisioner\" does not have a read-only root file system"
  },
  {
    "id": "03739",
    "manifest_path": "data/manifests/the_stack_sample/sample_1663.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: csi-blob-controller\n  namespace: kube-system\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: csi-blob-controller\n  template:\n    metadata:\n      labels:\n        app: csi-blob-controller\n    spec:\n      serviceAccountName: csi-blob-controller-sa\n      containers:\n      - name: csi-provisioner\n        image: mcr.microsoft.com/oss/kubernetes-csi/csi-provisioner:v2.1.0\n        args:\n        - -v=2\n        - --csi-address=$(ADDRESS)\n        - --leader-election\n        - --timeout=60s\n        - --extra-create-metadata=true\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        volumeMounts:\n        - mountPath: /csi\n          name: socket-dir\n        resources:\n          limits:\n            cpu: 100m\n            memory: 300Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n      - name: liveness-probe\n        image: mcr.microsoft.com/oss/kubernetes-csi/livenessprobe:v2.3.0\n        args:\n        - --csi-address=/csi/csi.sock\n        - --probe-timeout=3s\n        - --health-port=29632\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          limits:\n            cpu: 100m\n            memory: 100Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n      - name: blob\n        image: mcr.microsoft.com/k8s/csi/blob-csi:v1.4.0\n        imagePullPolicy: IfNotPresent\n        args:\n        - --v=5\n        - --endpoint=$(CSI_ENDPOINT)\n        - --metrics-address=0.0.0.0:29634\n        ports:\n        - containerPort: 29632\n          name: healthz\n          protocol: TCP\n        - containerPort: 29634\n          name: metrics\n          protocol: TCP\n        livenessProbe:\n          failureThreshold: 5\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 30\n          timeoutSeconds: 10\n          periodSeconds: 30\n        env:\n        - name: AZURE_CREDENTIAL_FILE\n          valueFrom:\n            configMapKeyRef:\n              name: azure-cred-file\n              key: path\n              optional: true\n        - name: CSI_ENDPOINT\n          value: unix:///csi/csi.sock\n        volumeMounts:\n        - mountPath: /csi\n          name: socket-dir\n        - mountPath: /etc/kubernetes/\n          name: azure-cred\n        - mountPath: /var/lib/waagent/ManagedIdentity-Settings\n          readOnly: true\n          name: msi\n        resources:\n          limits:\n            cpu: 200m\n            memory: 200Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n      - name: csi-resizer\n        image: mcr.microsoft.com/oss/kubernetes-csi/csi-resizer:v1.1.0\n        args:\n        - -csi-address=$(ADDRESS)\n        - -v=2\n        - -leader-election\n        - -handle-volume-inuse-error=false\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          limits:\n            cpu: 100m\n            memory: 300Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n      volumes:\n      - name: socket-dir\n        emptyDir: {}\n      - name: azure-cred\n        hostPath:\n          path: /etc/kubernetes/\n          type: Directory\n      - name: msi\n        hostPath:\n          path: /var/lib/waagent/ManagedIdentity-Settings\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"csi-resizer\" does not have a read-only root file system"
  },
  {
    "id": "03740",
    "manifest_path": "data/manifests/the_stack_sample/sample_1663.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: csi-blob-controller\n  namespace: kube-system\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: csi-blob-controller\n  template:\n    metadata:\n      labels:\n        app: csi-blob-controller\n    spec:\n      serviceAccountName: csi-blob-controller-sa\n      containers:\n      - name: csi-provisioner\n        image: mcr.microsoft.com/oss/kubernetes-csi/csi-provisioner:v2.1.0\n        args:\n        - -v=2\n        - --csi-address=$(ADDRESS)\n        - --leader-election\n        - --timeout=60s\n        - --extra-create-metadata=true\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        volumeMounts:\n        - mountPath: /csi\n          name: socket-dir\n        resources:\n          limits:\n            cpu: 100m\n            memory: 300Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n      - name: liveness-probe\n        image: mcr.microsoft.com/oss/kubernetes-csi/livenessprobe:v2.3.0\n        args:\n        - --csi-address=/csi/csi.sock\n        - --probe-timeout=3s\n        - --health-port=29632\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          limits:\n            cpu: 100m\n            memory: 100Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n      - name: blob\n        image: mcr.microsoft.com/k8s/csi/blob-csi:v1.4.0\n        imagePullPolicy: IfNotPresent\n        args:\n        - --v=5\n        - --endpoint=$(CSI_ENDPOINT)\n        - --metrics-address=0.0.0.0:29634\n        ports:\n        - containerPort: 29632\n          name: healthz\n          protocol: TCP\n        - containerPort: 29634\n          name: metrics\n          protocol: TCP\n        livenessProbe:\n          failureThreshold: 5\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 30\n          timeoutSeconds: 10\n          periodSeconds: 30\n        env:\n        - name: AZURE_CREDENTIAL_FILE\n          valueFrom:\n            configMapKeyRef:\n              name: azure-cred-file\n              key: path\n              optional: true\n        - name: CSI_ENDPOINT\n          value: unix:///csi/csi.sock\n        volumeMounts:\n        - mountPath: /csi\n          name: socket-dir\n        - mountPath: /etc/kubernetes/\n          name: azure-cred\n        - mountPath: /var/lib/waagent/ManagedIdentity-Settings\n          readOnly: true\n          name: msi\n        resources:\n          limits:\n            cpu: 200m\n            memory: 200Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n      - name: csi-resizer\n        image: mcr.microsoft.com/oss/kubernetes-csi/csi-resizer:v1.1.0\n        args:\n        - -csi-address=$(ADDRESS)\n        - -v=2\n        - -leader-election\n        - -handle-volume-inuse-error=false\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          limits:\n            cpu: 100m\n            memory: 300Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n      volumes:\n      - name: socket-dir\n        emptyDir: {}\n      - name: azure-cred\n        hostPath:\n          path: /etc/kubernetes/\n          type: Directory\n      - name: msi\n        hostPath:\n          path: /var/lib/waagent/ManagedIdentity-Settings\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"liveness-probe\" does not have a read-only root file system"
  },
  {
    "id": "03741",
    "manifest_path": "data/manifests/the_stack_sample/sample_1663.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: csi-blob-controller\n  namespace: kube-system\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: csi-blob-controller\n  template:\n    metadata:\n      labels:\n        app: csi-blob-controller\n    spec:\n      serviceAccountName: csi-blob-controller-sa\n      containers:\n      - name: csi-provisioner\n        image: mcr.microsoft.com/oss/kubernetes-csi/csi-provisioner:v2.1.0\n        args:\n        - -v=2\n        - --csi-address=$(ADDRESS)\n        - --leader-election\n        - --timeout=60s\n        - --extra-create-metadata=true\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        volumeMounts:\n        - mountPath: /csi\n          name: socket-dir\n        resources:\n          limits:\n            cpu: 100m\n            memory: 300Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n      - name: liveness-probe\n        image: mcr.microsoft.com/oss/kubernetes-csi/livenessprobe:v2.3.0\n        args:\n        - --csi-address=/csi/csi.sock\n        - --probe-timeout=3s\n        - --health-port=29632\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          limits:\n            cpu: 100m\n            memory: 100Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n      - name: blob\n        image: mcr.microsoft.com/k8s/csi/blob-csi:v1.4.0\n        imagePullPolicy: IfNotPresent\n        args:\n        - --v=5\n        - --endpoint=$(CSI_ENDPOINT)\n        - --metrics-address=0.0.0.0:29634\n        ports:\n        - containerPort: 29632\n          name: healthz\n          protocol: TCP\n        - containerPort: 29634\n          name: metrics\n          protocol: TCP\n        livenessProbe:\n          failureThreshold: 5\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 30\n          timeoutSeconds: 10\n          periodSeconds: 30\n        env:\n        - name: AZURE_CREDENTIAL_FILE\n          valueFrom:\n            configMapKeyRef:\n              name: azure-cred-file\n              key: path\n              optional: true\n        - name: CSI_ENDPOINT\n          value: unix:///csi/csi.sock\n        volumeMounts:\n        - mountPath: /csi\n          name: socket-dir\n        - mountPath: /etc/kubernetes/\n          name: azure-cred\n        - mountPath: /var/lib/waagent/ManagedIdentity-Settings\n          readOnly: true\n          name: msi\n        resources:\n          limits:\n            cpu: 200m\n            memory: 200Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n      - name: csi-resizer\n        image: mcr.microsoft.com/oss/kubernetes-csi/csi-resizer:v1.1.0\n        args:\n        - -csi-address=$(ADDRESS)\n        - -v=2\n        - -leader-election\n        - -handle-volume-inuse-error=false\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          limits:\n            cpu: 100m\n            memory: 300Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n      volumes:\n      - name: socket-dir\n        emptyDir: {}\n      - name: azure-cred\n        hostPath:\n          path: /etc/kubernetes/\n          type: Directory\n      - name: msi\n        hostPath:\n          path: /var/lib/waagent/ManagedIdentity-Settings\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"blob\" is not set to runAsNonRoot"
  },
  {
    "id": "03742",
    "manifest_path": "data/manifests/the_stack_sample/sample_1663.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: csi-blob-controller\n  namespace: kube-system\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: csi-blob-controller\n  template:\n    metadata:\n      labels:\n        app: csi-blob-controller\n    spec:\n      serviceAccountName: csi-blob-controller-sa\n      containers:\n      - name: csi-provisioner\n        image: mcr.microsoft.com/oss/kubernetes-csi/csi-provisioner:v2.1.0\n        args:\n        - -v=2\n        - --csi-address=$(ADDRESS)\n        - --leader-election\n        - --timeout=60s\n        - --extra-create-metadata=true\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        volumeMounts:\n        - mountPath: /csi\n          name: socket-dir\n        resources:\n          limits:\n            cpu: 100m\n            memory: 300Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n      - name: liveness-probe\n        image: mcr.microsoft.com/oss/kubernetes-csi/livenessprobe:v2.3.0\n        args:\n        - --csi-address=/csi/csi.sock\n        - --probe-timeout=3s\n        - --health-port=29632\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          limits:\n            cpu: 100m\n            memory: 100Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n      - name: blob\n        image: mcr.microsoft.com/k8s/csi/blob-csi:v1.4.0\n        imagePullPolicy: IfNotPresent\n        args:\n        - --v=5\n        - --endpoint=$(CSI_ENDPOINT)\n        - --metrics-address=0.0.0.0:29634\n        ports:\n        - containerPort: 29632\n          name: healthz\n          protocol: TCP\n        - containerPort: 29634\n          name: metrics\n          protocol: TCP\n        livenessProbe:\n          failureThreshold: 5\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 30\n          timeoutSeconds: 10\n          periodSeconds: 30\n        env:\n        - name: AZURE_CREDENTIAL_FILE\n          valueFrom:\n            configMapKeyRef:\n              name: azure-cred-file\n              key: path\n              optional: true\n        - name: CSI_ENDPOINT\n          value: unix:///csi/csi.sock\n        volumeMounts:\n        - mountPath: /csi\n          name: socket-dir\n        - mountPath: /etc/kubernetes/\n          name: azure-cred\n        - mountPath: /var/lib/waagent/ManagedIdentity-Settings\n          readOnly: true\n          name: msi\n        resources:\n          limits:\n            cpu: 200m\n            memory: 200Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n      - name: csi-resizer\n        image: mcr.microsoft.com/oss/kubernetes-csi/csi-resizer:v1.1.0\n        args:\n        - -csi-address=$(ADDRESS)\n        - -v=2\n        - -leader-election\n        - -handle-volume-inuse-error=false\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          limits:\n            cpu: 100m\n            memory: 300Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n      volumes:\n      - name: socket-dir\n        emptyDir: {}\n      - name: azure-cred\n        hostPath:\n          path: /etc/kubernetes/\n          type: Directory\n      - name: msi\n        hostPath:\n          path: /var/lib/waagent/ManagedIdentity-Settings\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"csi-provisioner\" is not set to runAsNonRoot"
  },
  {
    "id": "03743",
    "manifest_path": "data/manifests/the_stack_sample/sample_1663.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: csi-blob-controller\n  namespace: kube-system\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: csi-blob-controller\n  template:\n    metadata:\n      labels:\n        app: csi-blob-controller\n    spec:\n      serviceAccountName: csi-blob-controller-sa\n      containers:\n      - name: csi-provisioner\n        image: mcr.microsoft.com/oss/kubernetes-csi/csi-provisioner:v2.1.0\n        args:\n        - -v=2\n        - --csi-address=$(ADDRESS)\n        - --leader-election\n        - --timeout=60s\n        - --extra-create-metadata=true\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        volumeMounts:\n        - mountPath: /csi\n          name: socket-dir\n        resources:\n          limits:\n            cpu: 100m\n            memory: 300Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n      - name: liveness-probe\n        image: mcr.microsoft.com/oss/kubernetes-csi/livenessprobe:v2.3.0\n        args:\n        - --csi-address=/csi/csi.sock\n        - --probe-timeout=3s\n        - --health-port=29632\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          limits:\n            cpu: 100m\n            memory: 100Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n      - name: blob\n        image: mcr.microsoft.com/k8s/csi/blob-csi:v1.4.0\n        imagePullPolicy: IfNotPresent\n        args:\n        - --v=5\n        - --endpoint=$(CSI_ENDPOINT)\n        - --metrics-address=0.0.0.0:29634\n        ports:\n        - containerPort: 29632\n          name: healthz\n          protocol: TCP\n        - containerPort: 29634\n          name: metrics\n          protocol: TCP\n        livenessProbe:\n          failureThreshold: 5\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 30\n          timeoutSeconds: 10\n          periodSeconds: 30\n        env:\n        - name: AZURE_CREDENTIAL_FILE\n          valueFrom:\n            configMapKeyRef:\n              name: azure-cred-file\n              key: path\n              optional: true\n        - name: CSI_ENDPOINT\n          value: unix:///csi/csi.sock\n        volumeMounts:\n        - mountPath: /csi\n          name: socket-dir\n        - mountPath: /etc/kubernetes/\n          name: azure-cred\n        - mountPath: /var/lib/waagent/ManagedIdentity-Settings\n          readOnly: true\n          name: msi\n        resources:\n          limits:\n            cpu: 200m\n            memory: 200Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n      - name: csi-resizer\n        image: mcr.microsoft.com/oss/kubernetes-csi/csi-resizer:v1.1.0\n        args:\n        - -csi-address=$(ADDRESS)\n        - -v=2\n        - -leader-election\n        - -handle-volume-inuse-error=false\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          limits:\n            cpu: 100m\n            memory: 300Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n      volumes:\n      - name: socket-dir\n        emptyDir: {}\n      - name: azure-cred\n        hostPath:\n          path: /etc/kubernetes/\n          type: Directory\n      - name: msi\n        hostPath:\n          path: /var/lib/waagent/ManagedIdentity-Settings\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"csi-resizer\" is not set to runAsNonRoot"
  },
  {
    "id": "03744",
    "manifest_path": "data/manifests/the_stack_sample/sample_1663.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: csi-blob-controller\n  namespace: kube-system\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: csi-blob-controller\n  template:\n    metadata:\n      labels:\n        app: csi-blob-controller\n    spec:\n      serviceAccountName: csi-blob-controller-sa\n      containers:\n      - name: csi-provisioner\n        image: mcr.microsoft.com/oss/kubernetes-csi/csi-provisioner:v2.1.0\n        args:\n        - -v=2\n        - --csi-address=$(ADDRESS)\n        - --leader-election\n        - --timeout=60s\n        - --extra-create-metadata=true\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        volumeMounts:\n        - mountPath: /csi\n          name: socket-dir\n        resources:\n          limits:\n            cpu: 100m\n            memory: 300Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n      - name: liveness-probe\n        image: mcr.microsoft.com/oss/kubernetes-csi/livenessprobe:v2.3.0\n        args:\n        - --csi-address=/csi/csi.sock\n        - --probe-timeout=3s\n        - --health-port=29632\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          limits:\n            cpu: 100m\n            memory: 100Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n      - name: blob\n        image: mcr.microsoft.com/k8s/csi/blob-csi:v1.4.0\n        imagePullPolicy: IfNotPresent\n        args:\n        - --v=5\n        - --endpoint=$(CSI_ENDPOINT)\n        - --metrics-address=0.0.0.0:29634\n        ports:\n        - containerPort: 29632\n          name: healthz\n          protocol: TCP\n        - containerPort: 29634\n          name: metrics\n          protocol: TCP\n        livenessProbe:\n          failureThreshold: 5\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 30\n          timeoutSeconds: 10\n          periodSeconds: 30\n        env:\n        - name: AZURE_CREDENTIAL_FILE\n          valueFrom:\n            configMapKeyRef:\n              name: azure-cred-file\n              key: path\n              optional: true\n        - name: CSI_ENDPOINT\n          value: unix:///csi/csi.sock\n        volumeMounts:\n        - mountPath: /csi\n          name: socket-dir\n        - mountPath: /etc/kubernetes/\n          name: azure-cred\n        - mountPath: /var/lib/waagent/ManagedIdentity-Settings\n          readOnly: true\n          name: msi\n        resources:\n          limits:\n            cpu: 200m\n            memory: 200Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n      - name: csi-resizer\n        image: mcr.microsoft.com/oss/kubernetes-csi/csi-resizer:v1.1.0\n        args:\n        - -csi-address=$(ADDRESS)\n        - -v=2\n        - -leader-election\n        - -handle-volume-inuse-error=false\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          limits:\n            cpu: 100m\n            memory: 300Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n      volumes:\n      - name: socket-dir\n        emptyDir: {}\n      - name: azure-cred\n        hostPath:\n          path: /etc/kubernetes/\n          type: Directory\n      - name: msi\n        hostPath:\n          path: /var/lib/waagent/ManagedIdentity-Settings\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"liveness-probe\" is not set to runAsNonRoot"
  },
  {
    "id": "03745",
    "manifest_path": "data/manifests/the_stack_sample/sample_1665.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: pod-readonly-rootfs-false\n  namespace: test\nspec:\n  containers:\n  - name: sleep\n    image: tutum/curl\n    command:\n    - /bin/sleep\n    - infinity\n    resources:\n      requests:\n        cpu: 100m\n        memory: 5M\n      limits:\n        cpu: 200m\n        memory: 30M\n    securityContext:\n      readOnlyRootFilesystem: false\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"sleep\" is using an invalid container image, \"tutum/curl\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "03746",
    "manifest_path": "data/manifests/the_stack_sample/sample_1665.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: pod-readonly-rootfs-false\n  namespace: test\nspec:\n  containers:\n  - name: sleep\n    image: tutum/curl\n    command:\n    - /bin/sleep\n    - infinity\n    resources:\n      requests:\n        cpu: 100m\n        memory: 5M\n      limits:\n        cpu: 200m\n        memory: 30M\n    securityContext:\n      readOnlyRootFilesystem: false\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"sleep\" does not have a read-only root file system"
  },
  {
    "id": "03747",
    "manifest_path": "data/manifests/the_stack_sample/sample_1665.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: pod-readonly-rootfs-false\n  namespace: test\nspec:\n  containers:\n  - name: sleep\n    image: tutum/curl\n    command:\n    - /bin/sleep\n    - infinity\n    resources:\n      requests:\n        cpu: 100m\n        memory: 5M\n      limits:\n        cpu: 200m\n        memory: 30M\n    securityContext:\n      readOnlyRootFilesystem: false\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"sleep\" is not set to runAsNonRoot"
  },
  {
    "id": "03748",
    "manifest_path": "data/manifests/the_stack_sample/sample_1667.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: cuda-vector-add\nspec:\n  containers:\n  - name: cuda-vector-add\n    image: k8s.gcr.io/cuda-vector-add:v0.1\n    resources:\n      limits:\n        nvidia.com/gpu: 1\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"cuda-vector-add\" does not have a read-only root file system"
  },
  {
    "id": "03749",
    "manifest_path": "data/manifests/the_stack_sample/sample_1667.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: cuda-vector-add\nspec:\n  containers:\n  - name: cuda-vector-add\n    image: k8s.gcr.io/cuda-vector-add:v0.1\n    resources:\n      limits:\n        nvidia.com/gpu: 1\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"cuda-vector-add\" is not set to runAsNonRoot"
  },
  {
    "id": "03750",
    "manifest_path": "data/manifests/the_stack_sample/sample_1667.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: cuda-vector-add\nspec:\n  containers:\n  - name: cuda-vector-add\n    image: k8s.gcr.io/cuda-vector-add:v0.1\n    resources:\n      limits:\n        nvidia.com/gpu: 1\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"cuda-vector-add\" has cpu request 0"
  },
  {
    "id": "03751",
    "manifest_path": "data/manifests/the_stack_sample/sample_1667.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: cuda-vector-add\nspec:\n  containers:\n  - name: cuda-vector-add\n    image: k8s.gcr.io/cuda-vector-add:v0.1\n    resources:\n      limits:\n        nvidia.com/gpu: 1\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"cuda-vector-add\" has memory limit 0"
  },
  {
    "id": "03752",
    "manifest_path": "data/manifests/the_stack_sample/sample_1671.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: plank\n  labels:\n    app: plank\nspec:\n  selector:\n    matchLabels:\n      app: plank\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: plank\n    spec:\n      serviceAccountName: plank\n      containers:\n      - name: plank\n        image: gcr.io/k8s-prow/plank:v20200319-1aea24112\n        args:\n        - --dry-run=false\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        - --kubeconfig=/etc/workload-clusters/config\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --github-token-path=/etc/github/oauth\n        volumeMounts:\n        - name: kubeconfig\n          mountPath: /etc/workload-clusters\n          readOnly: true\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        - name: cluster\n          mountPath: /etc/cluster\n          readOnly: true\n      volumes:\n      - name: kubeconfig\n        secret:\n          secretName: workload-clusters-kubeconfig\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n      - name: cluster\n        secret:\n          defaultMode: 420\n          secretName: workload-cluster\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"plank\" does not have a read-only root file system"
  },
  {
    "id": "03753",
    "manifest_path": "data/manifests/the_stack_sample/sample_1671.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: plank\n  labels:\n    app: plank\nspec:\n  selector:\n    matchLabels:\n      app: plank\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: plank\n    spec:\n      serviceAccountName: plank\n      containers:\n      - name: plank\n        image: gcr.io/k8s-prow/plank:v20200319-1aea24112\n        args:\n        - --dry-run=false\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        - --kubeconfig=/etc/workload-clusters/config\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --github-token-path=/etc/github/oauth\n        volumeMounts:\n        - name: kubeconfig\n          mountPath: /etc/workload-clusters\n          readOnly: true\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        - name: cluster\n          mountPath: /etc/cluster\n          readOnly: true\n      volumes:\n      - name: kubeconfig\n        secret:\n          secretName: workload-clusters-kubeconfig\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n      - name: cluster\n        secret:\n          defaultMode: 420\n          secretName: workload-cluster\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"plank\" is not set to runAsNonRoot"
  },
  {
    "id": "03754",
    "manifest_path": "data/manifests/the_stack_sample/sample_1671.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: plank\n  labels:\n    app: plank\nspec:\n  selector:\n    matchLabels:\n      app: plank\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: plank\n    spec:\n      serviceAccountName: plank\n      containers:\n      - name: plank\n        image: gcr.io/k8s-prow/plank:v20200319-1aea24112\n        args:\n        - --dry-run=false\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        - --kubeconfig=/etc/workload-clusters/config\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --github-token-path=/etc/github/oauth\n        volumeMounts:\n        - name: kubeconfig\n          mountPath: /etc/workload-clusters\n          readOnly: true\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        - name: cluster\n          mountPath: /etc/cluster\n          readOnly: true\n      volumes:\n      - name: kubeconfig\n        secret:\n          secretName: workload-clusters-kubeconfig\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n      - name: cluster\n        secret:\n          defaultMode: 420\n          secretName: workload-cluster\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"plank\" has cpu request 0"
  },
  {
    "id": "03755",
    "manifest_path": "data/manifests/the_stack_sample/sample_1671.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: plank\n  labels:\n    app: plank\nspec:\n  selector:\n    matchLabels:\n      app: plank\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: plank\n    spec:\n      serviceAccountName: plank\n      containers:\n      - name: plank\n        image: gcr.io/k8s-prow/plank:v20200319-1aea24112\n        args:\n        - --dry-run=false\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        - --kubeconfig=/etc/workload-clusters/config\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --github-token-path=/etc/github/oauth\n        volumeMounts:\n        - name: kubeconfig\n          mountPath: /etc/workload-clusters\n          readOnly: true\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        - name: cluster\n          mountPath: /etc/cluster\n          readOnly: true\n      volumes:\n      - name: kubeconfig\n        secret:\n          secretName: workload-clusters-kubeconfig\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n      - name: cluster\n        secret:\n          defaultMode: 420\n          secretName: workload-cluster\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"plank\" has memory limit 0"
  },
  {
    "id": "03756",
    "manifest_path": "data/manifests/the_stack_sample/sample_1672.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: zabbix-web\n  labels:\n    app: zabbix\n    tier: zabbix-web\n  namespace: zabbix\nspec:\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        name: zabbix-web\n        app: zabbix\n    spec:\n      containers:\n      - name: zabbix-web\n        image: zabbix/zabbix-web-nginx-mysql:alpine-5.0-latest\n        imagePullPolicy: Always\n        ports:\n        - containerPort: 8080\n          name: web-http\n        - containerPort: 8443\n          name: web-https\n        env:\n        - name: ZBX_SERVER_NAME\n          value: Zabbix kubernetes\n        - name: PHP_TZ\n          value: Europe/Riga\n        - name: MYSQL_USER\n          valueFrom:\n            secretKeyRef:\n              name: db-secret\n              key: db-zbx-user\n        - name: MYSQL_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: db-secret\n              key: db-zbx-pass\n        - name: MYSQL_ROOT_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: db-secret\n              key: db-root-pass\n        - name: MYSQL_DATABASE\n          value: zabbix\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"zabbix-web\" does not have a read-only root file system"
  },
  {
    "id": "03757",
    "manifest_path": "data/manifests/the_stack_sample/sample_1672.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: zabbix-web\n  labels:\n    app: zabbix\n    tier: zabbix-web\n  namespace: zabbix\nspec:\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        name: zabbix-web\n        app: zabbix\n    spec:\n      containers:\n      - name: zabbix-web\n        image: zabbix/zabbix-web-nginx-mysql:alpine-5.0-latest\n        imagePullPolicy: Always\n        ports:\n        - containerPort: 8080\n          name: web-http\n        - containerPort: 8443\n          name: web-https\n        env:\n        - name: ZBX_SERVER_NAME\n          value: Zabbix kubernetes\n        - name: PHP_TZ\n          value: Europe/Riga\n        - name: MYSQL_USER\n          valueFrom:\n            secretKeyRef:\n              name: db-secret\n              key: db-zbx-user\n        - name: MYSQL_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: db-secret\n              key: db-zbx-pass\n        - name: MYSQL_ROOT_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: db-secret\n              key: db-root-pass\n        - name: MYSQL_DATABASE\n          value: zabbix\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"zabbix-web\" is not set to runAsNonRoot"
  },
  {
    "id": "03758",
    "manifest_path": "data/manifests/the_stack_sample/sample_1672.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: zabbix-web\n  labels:\n    app: zabbix\n    tier: zabbix-web\n  namespace: zabbix\nspec:\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        name: zabbix-web\n        app: zabbix\n    spec:\n      containers:\n      - name: zabbix-web\n        image: zabbix/zabbix-web-nginx-mysql:alpine-5.0-latest\n        imagePullPolicy: Always\n        ports:\n        - containerPort: 8080\n          name: web-http\n        - containerPort: 8443\n          name: web-https\n        env:\n        - name: ZBX_SERVER_NAME\n          value: Zabbix kubernetes\n        - name: PHP_TZ\n          value: Europe/Riga\n        - name: MYSQL_USER\n          valueFrom:\n            secretKeyRef:\n              name: db-secret\n              key: db-zbx-user\n        - name: MYSQL_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: db-secret\n              key: db-zbx-pass\n        - name: MYSQL_ROOT_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: db-secret\n              key: db-root-pass\n        - name: MYSQL_DATABASE\n          value: zabbix\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"zabbix-web\" has cpu request 0"
  },
  {
    "id": "03759",
    "manifest_path": "data/manifests/the_stack_sample/sample_1672.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: zabbix-web\n  labels:\n    app: zabbix\n    tier: zabbix-web\n  namespace: zabbix\nspec:\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        name: zabbix-web\n        app: zabbix\n    spec:\n      containers:\n      - name: zabbix-web\n        image: zabbix/zabbix-web-nginx-mysql:alpine-5.0-latest\n        imagePullPolicy: Always\n        ports:\n        - containerPort: 8080\n          name: web-http\n        - containerPort: 8443\n          name: web-https\n        env:\n        - name: ZBX_SERVER_NAME\n          value: Zabbix kubernetes\n        - name: PHP_TZ\n          value: Europe/Riga\n        - name: MYSQL_USER\n          valueFrom:\n            secretKeyRef:\n              name: db-secret\n              key: db-zbx-user\n        - name: MYSQL_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: db-secret\n              key: db-zbx-pass\n        - name: MYSQL_ROOT_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: db-secret\n              key: db-root-pass\n        - name: MYSQL_DATABASE\n          value: zabbix\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"zabbix-web\" has memory limit 0"
  },
  {
    "id": "03760",
    "manifest_path": "data/manifests/the_stack_sample/sample_1673.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-1357\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"nginx\" is using an invalid container image, \"nginx\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  }
]