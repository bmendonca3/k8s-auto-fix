[
  {
    "id": "01881",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: sinker\n  labels:\n    app: sinker\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: sinker\n  template:\n    metadata:\n      labels:\n        app: sinker\n    spec:\n      serviceAccountName: sinker\n      containers:\n      - name: sinker\n        args:\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        - --dry-run=false\n        image: gcr.io/k8s-prow/sinker:v20210615-cf184f2204\n        env:\n        - name: KUBECONFIG\n          value: /etc/kubeconfig/config\n        volumeMounts:\n        - mountPath: /etc/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: kubeconfig\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "01882",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: sinker\n  labels:\n    app: sinker\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: sinker\n  template:\n    metadata:\n      labels:\n        app: sinker\n    spec:\n      serviceAccountName: sinker\n      containers:\n      - name: sinker\n        args:\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        - --dry-run=false\n        image: gcr.io/k8s-prow/sinker:v20210615-cf184f2204\n        env:\n        - name: KUBECONFIG\n          value: /etc/kubeconfig/config\n        volumeMounts:\n        - mountPath: /etc/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: kubeconfig\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n",
    "errors": []
  },
  {
    "id": "01883",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: sinker\n  labels:\n    app: sinker\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: sinker\n  template:\n    metadata:\n      labels:\n        app: sinker\n    spec:\n      serviceAccountName: sinker\n      containers:\n      - name: sinker\n        args:\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        - --dry-run=false\n        image: gcr.io/k8s-prow/sinker:v20210615-cf184f2204\n        env:\n        - name: KUBECONFIG\n          value: /etc/kubeconfig/config\n        volumeMounts:\n        - mountPath: /etc/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: kubeconfig\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n",
    "errors": []
  },
  {
    "id": "01884",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: jx-pipelines-visualizer\n  labels:\n    app.kubernetes.io/name: jx-pipelines-visualizer\n    app.kubernetes.io/instance: jx-pipelines-visualizer\n    helm.sh/chart: jx-pipelines-visualizer-1.7.2\n    app.kubernetes.io/version: 1.7.2\n    app.kubernetes.io/managed-by: Helm\n    gitops.jenkins-x.io/pipeline: namespaces\n  annotations:\n    meta.helm.sh/release-name: jx-pipelines-visualizer\n    wave.pusher.com/update-on-config-change: 'true'\n  namespace: jx\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: jx-pipelines-visualizer\n      app.kubernetes.io/instance: jx-pipelines-visualizer\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/name: jx-pipelines-visualizer\n        app.kubernetes.io/instance: jx-pipelines-visualizer\n        helm.sh/chart: jx-pipelines-visualizer-1.7.2\n        app.kubernetes.io/version: 1.7.2\n        app.kubernetes.io/managed-by: Helm\n    spec:\n      containers:\n      - name: jx-pipelines-visualizer\n        image: ghcr.io/jenkins-x/jx-pipelines-visualizer:1.7.2\n        args:\n        - -namespace\n        - jx\n        - -resync-interval\n        - 60s\n        - -archived-logs-url-template\n        - gs://logs-tf-jx-glowing-seagull-7f4cd57c6d2a/jenkins-x/logs/{{.Owner}}/{{.Repository}}/{{if\n          hasPrefix .Branch \"pr\"}}{{.Branch | upper}}{{else}}{{.Branch}}{{end}}/{{.Build}}.log\n        - -archived-pipelines-url-template\n        - gs://logs-tf-jx-glowing-seagull-7f4cd57c6d2a/jenkins-x/logs/{{.Owner}}/{{.Repository}}/{{if\n          hasPrefix .Branch \"pr\"}}{{.Branch | upper}}{{else}}{{.Branch}}{{end}}/{{.Build}}.yaml\n        - -archived-pipelineruns-url-template\n        - gs://logs-tf-jx-glowing-seagull-7f4cd57c6d2a/jenkins-x/pipelineruns/{{.Namespace}}/{{.Name}}.yaml\n        - -pipeline-trace-url-template\n        - http://grafana-jx-observability.34.72.245.235.nip.io/explore?left=%5B%22now%22,%22now%22,%22Tempo%22,%7B%22query%22:%22{{.TraceID}}%22%7D%5D\n        - -log-level\n        - INFO\n        ports:\n        - name: http\n          containerPort: 8080\n        livenessProbe:\n          tcpSocket:\n            port: http\n        readinessProbe:\n          httpGet:\n            path: /healthz\n            port: http\n        volumeMounts:\n        - mountPath: /secrets/git\n          name: secrets-git\n        resources:\n          limits:\n            cpu: '1'\n            memory: 512M\n          requests:\n            cpu: '0.2'\n            memory: 128M\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n      securityContext:\n        fsGroup: 1000\n      serviceAccountName: jx-pipelines-visualizer\n      volumes:\n      - name: secrets-git\n        secret:\n          defaultMode: 420\n          secretName: tekton-git\n",
    "errors": []
  },
  {
    "id": "01885",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: jx-pipelines-visualizer\n  labels:\n    app.kubernetes.io/name: jx-pipelines-visualizer\n    app.kubernetes.io/instance: jx-pipelines-visualizer\n    helm.sh/chart: jx-pipelines-visualizer-1.7.2\n    app.kubernetes.io/version: 1.7.2\n    app.kubernetes.io/managed-by: Helm\n    gitops.jenkins-x.io/pipeline: namespaces\n  annotations:\n    meta.helm.sh/release-name: jx-pipelines-visualizer\n    wave.pusher.com/update-on-config-change: 'true'\n  namespace: jx\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: jx-pipelines-visualizer\n      app.kubernetes.io/instance: jx-pipelines-visualizer\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/name: jx-pipelines-visualizer\n        app.kubernetes.io/instance: jx-pipelines-visualizer\n        helm.sh/chart: jx-pipelines-visualizer-1.7.2\n        app.kubernetes.io/version: 1.7.2\n        app.kubernetes.io/managed-by: Helm\n    spec:\n      containers:\n      - name: jx-pipelines-visualizer\n        image: ghcr.io/jenkins-x/jx-pipelines-visualizer:1.7.2\n        args:\n        - -namespace\n        - jx\n        - -resync-interval\n        - 60s\n        - -archived-logs-url-template\n        - gs://logs-tf-jx-glowing-seagull-7f4cd57c6d2a/jenkins-x/logs/{{.Owner}}/{{.Repository}}/{{if\n          hasPrefix .Branch \"pr\"}}{{.Branch | upper}}{{else}}{{.Branch}}{{end}}/{{.Build}}.log\n        - -archived-pipelines-url-template\n        - gs://logs-tf-jx-glowing-seagull-7f4cd57c6d2a/jenkins-x/logs/{{.Owner}}/{{.Repository}}/{{if\n          hasPrefix .Branch \"pr\"}}{{.Branch | upper}}{{else}}{{.Branch}}{{end}}/{{.Build}}.yaml\n        - -archived-pipelineruns-url-template\n        - gs://logs-tf-jx-glowing-seagull-7f4cd57c6d2a/jenkins-x/pipelineruns/{{.Namespace}}/{{.Name}}.yaml\n        - -pipeline-trace-url-template\n        - http://grafana-jx-observability.34.72.245.235.nip.io/explore?left=%5B%22now%22,%22now%22,%22Tempo%22,%7B%22query%22:%22{{.TraceID}}%22%7D%5D\n        - -log-level\n        - INFO\n        ports:\n        - name: http\n          containerPort: 8080\n        livenessProbe:\n          tcpSocket:\n            port: http\n        readinessProbe:\n          httpGet:\n            path: /healthz\n            port: http\n        volumeMounts:\n        - mountPath: /secrets/git\n          name: secrets-git\n        resources:\n          limits:\n            cpu: '1'\n            memory: 512M\n          requests:\n            cpu: '0.2'\n            memory: 128M\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n      securityContext:\n        fsGroup: 1000\n      serviceAccountName: jx-pipelines-visualizer\n      volumes:\n      - name: secrets-git\n        secret:\n          defaultMode: 420\n          secretName: tekton-git\n",
    "errors": []
  },
  {
    "id": "01886",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: assisted-service\n  namespace: replace-namespace\nspec:\n  selector:\n    matchLabels:\n      app: assisted-service\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: assisted-service\n    spec:\n      containers:\n      - name: assisted-service\n        resources:\n          limits:\n            cpu: 200m\n            memory: 500Mi\n          requests:\n            cpu: 100m\n            memory: 400Mi\n        image: REPLACE_IMAGE:stable\n        imagePullPolicy: Always\n        ports:\n        - containerPort: 8090\n        envFrom:\n        - configMapRef:\n            name: assisted-service-config\n        env:\n        - name: DB_HOST\n          valueFrom:\n            secretKeyRef:\n              name: assisted-installer-rds\n              key: db.host\n        - name: DB_NAME\n          valueFrom:\n            secretKeyRef:\n              name: assisted-installer-rds\n              key: db.name\n        - name: DB_PASS\n          valueFrom:\n            secretKeyRef:\n              name: assisted-installer-rds\n              key: db.password\n        - name: DB_PORT\n          valueFrom:\n            secretKeyRef:\n              name: assisted-installer-rds\n              key: db.port\n        - name: DB_USER\n          valueFrom:\n            secretKeyRef:\n              name: assisted-installer-rds\n              key: db.user\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              key: aws_secret_access_key\n              name: assisted-installer-s3\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              key: aws_access_key_id\n              name: assisted-installer-s3\n        - name: S3_REGION\n          valueFrom:\n            secretKeyRef:\n              key: aws_region\n              name: assisted-installer-s3\n        - name: S3_BUCKET\n          valueFrom:\n            secretKeyRef:\n              key: bucket\n              name: assisted-installer-s3\n        - name: S3_ENDPOINT_URL\n          valueFrom:\n            secretKeyRef:\n              key: endpoint\n              name: assisted-installer-s3\n        volumeMounts:\n        - name: route53-creds\n          mountPath: /.aws\n          readOnly: true\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: route53-creds\n        secret:\n          secretName: route53-creds\n          optional: true\n",
    "errors": []
  },
  {
    "id": "01887",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: assisted-service\n  namespace: replace-namespace\nspec:\n  selector:\n    matchLabels:\n      app: assisted-service\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: assisted-service\n    spec:\n      containers:\n      - name: assisted-service\n        resources:\n          limits:\n            cpu: 200m\n            memory: 500Mi\n          requests:\n            cpu: 100m\n            memory: 400Mi\n        image: REPLACE_IMAGE:stable\n        imagePullPolicy: Always\n        ports:\n        - containerPort: 8090\n        envFrom:\n        - configMapRef:\n            name: assisted-service-config\n        env:\n        - name: DB_HOST\n          valueFrom:\n            secretKeyRef:\n              name: assisted-installer-rds\n              key: db.host\n        - name: DB_NAME\n          valueFrom:\n            secretKeyRef:\n              name: assisted-installer-rds\n              key: db.name\n        - name: DB_PASS\n          valueFrom:\n            secretKeyRef:\n              name: assisted-installer-rds\n              key: db.password\n        - name: DB_PORT\n          valueFrom:\n            secretKeyRef:\n              name: assisted-installer-rds\n              key: db.port\n        - name: DB_USER\n          valueFrom:\n            secretKeyRef:\n              name: assisted-installer-rds\n              key: db.user\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              key: aws_secret_access_key\n              name: assisted-installer-s3\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              key: aws_access_key_id\n              name: assisted-installer-s3\n        - name: S3_REGION\n          valueFrom:\n            secretKeyRef:\n              key: aws_region\n              name: assisted-installer-s3\n        - name: S3_BUCKET\n          valueFrom:\n            secretKeyRef:\n              key: bucket\n              name: assisted-installer-s3\n        - name: S3_ENDPOINT_URL\n          valueFrom:\n            secretKeyRef:\n              key: endpoint\n              name: assisted-installer-s3\n        volumeMounts:\n        - name: route53-creds\n          mountPath: /.aws\n          readOnly: true\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n      volumes:\n      - name: route53-creds\n        secret:\n          secretName: route53-creds\n          optional: true\n",
    "errors": []
  },
  {
    "id": "01888",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: assisted-service\n  namespace: replace-namespace\nspec:\n  selector:\n    matchLabels:\n      app: assisted-service\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: assisted-service\n    spec:\n      containers:\n      - name: assisted-service\n        resources:\n          limits:\n            cpu: 200m\n            memory: 500Mi\n          requests:\n            cpu: 100m\n            memory: 400Mi\n        image: REPLACE_IMAGE:stable\n        imagePullPolicy: Always\n        ports:\n        - containerPort: 8090\n        envFrom:\n        - configMapRef:\n            name: assisted-service-config\n        env:\n        - name: DB_HOST\n          valueFrom:\n            secretKeyRef:\n              name: assisted-installer-rds\n              key: db.host\n        - name: DB_NAME\n          valueFrom:\n            secretKeyRef:\n              name: assisted-installer-rds\n              key: db.name\n        - name: DB_PASS\n          valueFrom:\n            secretKeyRef:\n              name: assisted-installer-rds\n              key: db.password\n        - name: DB_PORT\n          valueFrom:\n            secretKeyRef:\n              name: assisted-installer-rds\n              key: db.port\n        - name: DB_USER\n          valueFrom:\n            secretKeyRef:\n              name: assisted-installer-rds\n              key: db.user\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              key: aws_secret_access_key\n              name: assisted-installer-s3\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              key: aws_access_key_id\n              name: assisted-installer-s3\n        - name: S3_REGION\n          valueFrom:\n            secretKeyRef:\n              key: aws_region\n              name: assisted-installer-s3\n        - name: S3_BUCKET\n          valueFrom:\n            secretKeyRef:\n              key: bucket\n              name: assisted-installer-s3\n        - name: S3_ENDPOINT_URL\n          valueFrom:\n            secretKeyRef:\n              key: endpoint\n              name: assisted-installer-s3\n        volumeMounts:\n        - name: route53-creds\n          mountPath: /.aws\n          readOnly: true\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: route53-creds\n        secret:\n          secretName: route53-creds\n          optional: true\n",
    "errors": []
  },
  {
    "id": "01889",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: pod3\n  namespace: ns3\n  labels:\n    app: my-label-1\nspec:\n  containers:\n  - name: container1\n    image: sadedil/simpleinfoserver:1.0.0\n    ports:\n    - containerPort: 80\n    securityContext:\n      readOnlyRootFilesystem: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "01890",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: pod3\n  namespace: ns3\n  labels:\n    app: my-label-1\nspec:\n  containers:\n  - name: container1\n    image: sadedil/simpleinfoserver:1.0.0\n    ports:\n    - containerPort: 80\n    securityContext:\n      runAsNonRoot: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      readOnlyRootFilesystem: true\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "01891",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: pod3\n  namespace: ns3\n  labels:\n    app: my-label-1\nspec:\n  containers:\n  - name: container1\n    image: sadedil/simpleinfoserver:1.0.0\n    ports:\n    - containerPort: 80\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n      readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "01892",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: pod3\n  namespace: ns3\n  labels:\n    app: my-label-1\nspec:\n  containers:\n  - name: container1\n    image: sadedil/simpleinfoserver:1.0.0\n    ports:\n    - containerPort: 80\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n      readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "01893",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: pluscode-no-priority\nspec:\n  replicas: 15\n  selector:\n    matchLabels:\n      app: pluscode-no-priority\n  template:\n    metadata:\n      labels:\n        app: pluscode-no-priority\n    spec:\n      containers:\n      - name: pluscode-container\n        image: wdenniss/pluscode-demo:stable\n        resources:\n          requests:\n            cpu: 200m\n            memory: 250Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "01894",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: pluscode-no-priority\nspec:\n  replicas: 15\n  selector:\n    matchLabels:\n      app: pluscode-no-priority\n  template:\n    metadata:\n      labels:\n        app: pluscode-no-priority\n    spec:\n      containers:\n      - name: pluscode-container\n        image: wdenniss/pluscode-demo:stable\n        resources:\n          requests:\n            cpu: 200m\n            memory: 250Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "01895",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: pluscode-no-priority\nspec:\n  replicas: 15\n  selector:\n    matchLabels:\n      app: pluscode-no-priority\n  template:\n    metadata:\n      labels:\n        app: pluscode-no-priority\n    spec:\n      containers:\n      - name: pluscode-container\n        image: wdenniss/pluscode-demo:stable\n        resources:\n          requests:\n            cpu: 200m\n            memory: 250Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "01896",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: pluscode-no-priority\nspec:\n  replicas: 15\n  selector:\n    matchLabels:\n      app: pluscode-no-priority\n  template:\n    metadata:\n      labels:\n        app: pluscode-no-priority\n    spec:\n      containers:\n      - name: pluscode-container\n        image: wdenniss/pluscode-demo:stable\n        resources:\n          requests:\n            cpu: 200m\n            memory: 250Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "01897",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: ansible-tower\n  namespace: tower\nspec:\n  selector:\n    matchLabels:\n      app: ansible-tower\n      version: v1\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: ansible-tower\n        version: v1\n    spec:\n      containers:\n      - name: tower\n        image: dynatraceacm/ansibletower:3.3.1-1-2\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "01898",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: ansible-tower\n  namespace: tower\nspec:\n  selector:\n    matchLabels:\n      app: ansible-tower\n      version: v1\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: ansible-tower\n        version: v1\n    spec:\n      containers:\n      - name: tower\n        image: dynatraceacm/ansibletower:3.3.1-1-2\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "01899",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: ansible-tower\n  namespace: tower\nspec:\n  selector:\n    matchLabels:\n      app: ansible-tower\n      version: v1\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: ansible-tower\n        version: v1\n    spec:\n      containers:\n      - name: tower\n        image: dynatraceacm/ansibletower:3.3.1-1-2\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "01900",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: ansible-tower\n  namespace: tower\nspec:\n  selector:\n    matchLabels:\n      app: ansible-tower\n      version: v1\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: ansible-tower\n        version: v1\n    spec:\n      containers:\n      - name: tower\n        image: dynatraceacm/ansibletower:3.3.1-1-2\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "01901",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: etcd\n  namespace: chaos-testing\n  labels:\n    app: etcd\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: etcd\n  template:\n    metadata:\n      labels:\n        app: etcd\n      annotations:\n        admission-webhook.pingcap.com/request: chaosfs-etcd\n    spec:\n      containers:\n      - name: etcd\n        imagePullPolicy: IfNotPresent\n        image: k8s.gcr.io/etcd:3.4.3-0\n        args:\n        - /usr/local/bin/etcd\n        - -name=etcd\n        - -advertise-client-urls=http://0.0.0.0:2379\n        - -initial-advertise-peer-urls=http://0.0.0.0:2380\n        - -listen-client-urls=http://0.0.0.0:2379\n        - -listen-peer-urls=http://0.0.0.0:2380\n        - -initial-cluster=etcd=http://0.0.0.0:2380\n        - --data-dir=/var/run/etcd/default.etcd\n        - -initial-cluster-state=new\n        - -initial-cluster-token=etcd-cluster\n        volumeMounts:\n        - mountPath: /var/run/etcd\n          name: datadir\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - emptyDir: {}\n        name: datadir\n",
    "errors": []
  },
  {
    "id": "01902",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: etcd\n  namespace: chaos-testing\n  labels:\n    app: etcd\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: etcd\n  template:\n    metadata:\n      labels:\n        app: etcd\n      annotations:\n        admission-webhook.pingcap.com/request: chaosfs-etcd\n    spec:\n      containers:\n      - name: etcd\n        imagePullPolicy: IfNotPresent\n        image: k8s.gcr.io/etcd:3.4.3-0\n        args:\n        - /usr/local/bin/etcd\n        - -name=etcd\n        - -advertise-client-urls=http://0.0.0.0:2379\n        - -initial-advertise-peer-urls=http://0.0.0.0:2380\n        - -listen-client-urls=http://0.0.0.0:2379\n        - -listen-peer-urls=http://0.0.0.0:2380\n        - -initial-cluster=etcd=http://0.0.0.0:2380\n        - --data-dir=/var/run/etcd/default.etcd\n        - -initial-cluster-state=new\n        - -initial-cluster-token=etcd-cluster\n        volumeMounts:\n        - mountPath: /var/run/etcd\n          name: datadir\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - emptyDir: {}\n        name: datadir\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "01903",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: etcd\n  namespace: chaos-testing\n  labels:\n    app: etcd\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: etcd\n  template:\n    metadata:\n      labels:\n        app: etcd\n      annotations:\n        admission-webhook.pingcap.com/request: chaosfs-etcd\n    spec:\n      containers:\n      - name: etcd\n        imagePullPolicy: IfNotPresent\n        image: k8s.gcr.io/etcd:3.4.3-0\n        args:\n        - /usr/local/bin/etcd\n        - -name=etcd\n        - -advertise-client-urls=http://0.0.0.0:2379\n        - -initial-advertise-peer-urls=http://0.0.0.0:2380\n        - -listen-client-urls=http://0.0.0.0:2379\n        - -listen-peer-urls=http://0.0.0.0:2380\n        - -initial-cluster=etcd=http://0.0.0.0:2380\n        - --data-dir=/var/run/etcd/default.etcd\n        - -initial-cluster-state=new\n        - -initial-cluster-token=etcd-cluster\n        volumeMounts:\n        - mountPath: /var/run/etcd\n          name: datadir\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - emptyDir: {}\n        name: datadir\n",
    "errors": []
  },
  {
    "id": "01904",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: etcd\n  namespace: chaos-testing\n  labels:\n    app: etcd\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: etcd\n  template:\n    metadata:\n      labels:\n        app: etcd\n      annotations:\n        admission-webhook.pingcap.com/request: chaosfs-etcd\n    spec:\n      containers:\n      - name: etcd\n        imagePullPolicy: IfNotPresent\n        image: k8s.gcr.io/etcd:3.4.3-0\n        args:\n        - /usr/local/bin/etcd\n        - -name=etcd\n        - -advertise-client-urls=http://0.0.0.0:2379\n        - -initial-advertise-peer-urls=http://0.0.0.0:2380\n        - -listen-client-urls=http://0.0.0.0:2379\n        - -listen-peer-urls=http://0.0.0.0:2380\n        - -initial-cluster=etcd=http://0.0.0.0:2380\n        - --data-dir=/var/run/etcd/default.etcd\n        - -initial-cluster-state=new\n        - -initial-cluster-token=etcd-cluster\n        volumeMounts:\n        - mountPath: /var/run/etcd\n          name: datadir\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - emptyDir: {}\n        name: datadir\n",
    "errors": []
  },
  {
    "id": "01905",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: vdbench-sv4-svc\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: vdbench-sv4-svc\n  template:\n    metadata:\n      labels:\n        app: vdbench-sv4-svc\n    spec:\n      containers:\n      - name: vdbench\n        image: portworx/vdbench:torpedo\n        imagePullPolicy: IfNotPresent\n        resources:\n          limits:\n            cpu: 1000m\n            memory: 500Mi\n          requests:\n            memory: 256Mi\n            cpu: 100m\n        command:\n        - ./bench_runner.sh\n        args:\n        - Basic\n        - '5400'\n        - $(POD_NAME)\n        - output/$(POD_NAME)\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        volumeMounts:\n        - name: vdbench-persistent-storage-enc\n          mountPath: /tmp\n        - name: vdbench-output-persistent-storage\n          mountPath: /output\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n      volumes:\n      - name: vdbench-persistent-storage-enc\n        persistentVolumeClaim:\n          claimName: vdbench-pvc-enc-sv4-svc\n      - name: vdbench-output-persistent-storage\n        persistentVolumeClaim:\n          claimName: vdbench-pvc-output-sv4-svc\n",
    "errors": []
  },
  {
    "id": "01906",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: vdbench-sv4-svc\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: vdbench-sv4-svc\n  template:\n    metadata:\n      labels:\n        app: vdbench-sv4-svc\n    spec:\n      containers:\n      - name: vdbench\n        image: portworx/vdbench:torpedo\n        imagePullPolicy: IfNotPresent\n        resources:\n          limits:\n            cpu: 1000m\n            memory: 500Mi\n          requests:\n            memory: 256Mi\n            cpu: 100m\n        command:\n        - ./bench_runner.sh\n        args:\n        - Basic\n        - '5400'\n        - $(POD_NAME)\n        - output/$(POD_NAME)\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        volumeMounts:\n        - name: vdbench-persistent-storage-enc\n          mountPath: /tmp\n        - name: vdbench-output-persistent-storage\n          mountPath: /output\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: vdbench-persistent-storage-enc\n        persistentVolumeClaim:\n          claimName: vdbench-pvc-enc-sv4-svc\n      - name: vdbench-output-persistent-storage\n        persistentVolumeClaim:\n          claimName: vdbench-pvc-output-sv4-svc\n",
    "errors": []
  },
  {
    "id": "01907",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: mongo-deployment\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: mongo\n  template:\n    metadata:\n      name: mongo-pod\n      labels:\n        app: mongo\n    spec:\n      containers:\n      - image: mongo:stable\n        name: mongo\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "01908",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: mongo-deployment\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: mongo\n  template:\n    metadata:\n      name: mongo-pod\n      labels:\n        app: mongo\n    spec:\n      containers:\n      - image: mongo:stable\n        name: mongo\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "01909",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: mongo-deployment\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: mongo\n  template:\n    metadata:\n      name: mongo-pod\n      labels:\n        app: mongo\n    spec:\n      containers:\n      - image: mongo:stable\n        name: mongo\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "01910",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: mongo-deployment\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: mongo\n  template:\n    metadata:\n      name: mongo-pod\n      labels:\n        app: mongo\n    spec:\n      containers:\n      - image: mongo:stable\n        name: mongo\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "01911",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: mongo-deployment\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: mongo\n  template:\n    metadata:\n      name: mongo-pod\n      labels:\n        app: mongo\n    spec:\n      containers:\n      - image: mongo:stable\n        name: mongo\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "01912",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    foo: bar\n  name: my-nginx\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - image: nginx:1.14.2\n        name: nginx\n        ports:\n        - containerPort: 80\n          protocol: TCP\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "01913",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    foo: bar\n  name: my-nginx\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - image: nginx:1.14.2\n        name: nginx\n        ports:\n        - containerPort: 80\n          protocol: TCP\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "01914",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    foo: bar\n  name: my-nginx\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - image: nginx:1.14.2\n        name: nginx\n        ports:\n        - containerPort: 80\n          protocol: TCP\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "01915",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    foo: bar\n  name: my-nginx\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - image: nginx:1.14.2\n        name: nginx\n        ports:\n        - containerPort: 80\n          protocol: TCP\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "01916",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: nfs-busybox\n  namespace: mybox\nspec:\n  replicas: 2\n  selector:\n    name: nfs-busybox\n  template:\n    metadata:\n      labels:\n        name: nfs-busybox\n    spec:\n      containers:\n      - image: busybox:stable\n        command:\n        - sh\n        - -c\n        - while true; do date > /mnt/index.html; hostname >> /mnt/index.html; sleep\n          $(($RANDOM % 5 + 5)); done\n        imagePullPolicy: IfNotPresent\n        name: busybox\n        volumeMounts:\n        - name: nfs\n          mountPath: /mnt\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: nfs\n        persistentVolumeClaim:\n          claimName: nfs\n",
    "errors": []
  },
  {
    "id": "01917",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: nfs-busybox\n  namespace: mybox\nspec:\n  replicas: 2\n  selector:\n    name: nfs-busybox\n  template:\n    metadata:\n      labels:\n        name: nfs-busybox\n    spec:\n      containers:\n      - image: busybox:stable\n        command:\n        - sh\n        - -c\n        - while true; do date > /mnt/index.html; hostname >> /mnt/index.html; sleep\n          $(($RANDOM % 5 + 5)); done\n        imagePullPolicy: IfNotPresent\n        name: busybox\n        volumeMounts:\n        - name: nfs\n          mountPath: /mnt\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          limits:\n            cpu: 500m\n            memory: 256Mi\n          requests:\n            cpu: 100m\n            memory: 128Mi\n      volumes:\n      - name: nfs\n        persistentVolumeClaim:\n          claimName: nfs\n",
    "errors": []
  },
  {
    "id": "01918",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: nfs-busybox\n  namespace: mybox\nspec:\n  replicas: 2\n  selector:\n    name: nfs-busybox\n  template:\n    metadata:\n      labels:\n        name: nfs-busybox\n    spec:\n      containers:\n      - image: busybox:stable\n        command:\n        - sh\n        - -c\n        - while true; do date > /mnt/index.html; hostname >> /mnt/index.html; sleep\n          $(($RANDOM % 5 + 5)); done\n        imagePullPolicy: IfNotPresent\n        name: busybox\n        volumeMounts:\n        - name: nfs\n          mountPath: /mnt\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: nfs\n        persistentVolumeClaim:\n          claimName: nfs\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "01919",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: nfs-busybox\n  namespace: mybox\nspec:\n  replicas: 2\n  selector:\n    name: nfs-busybox\n  template:\n    metadata:\n      labels:\n        name: nfs-busybox\n    spec:\n      containers:\n      - image: busybox:stable\n        command:\n        - sh\n        - -c\n        - while true; do date > /mnt/index.html; hostname >> /mnt/index.html; sleep\n          $(($RANDOM % 5 + 5)); done\n        imagePullPolicy: IfNotPresent\n        name: busybox\n        volumeMounts:\n        - name: nfs\n          mountPath: /mnt\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: nfs\n        persistentVolumeClaim:\n          claimName: nfs\n",
    "errors": []
  },
  {
    "id": "01920",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: nfs-busybox\n  namespace: mybox\nspec:\n  replicas: 2\n  selector:\n    name: nfs-busybox\n  template:\n    metadata:\n      labels:\n        name: nfs-busybox\n    spec:\n      containers:\n      - image: busybox:stable\n        command:\n        - sh\n        - -c\n        - while true; do date > /mnt/index.html; hostname >> /mnt/index.html; sleep\n          $(($RANDOM % 5 + 5)); done\n        imagePullPolicy: IfNotPresent\n        name: busybox\n        volumeMounts:\n        - name: nfs\n          mountPath: /mnt\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: nfs\n        persistentVolumeClaim:\n          claimName: nfs\n",
    "errors": []
  }
]