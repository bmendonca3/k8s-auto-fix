[
  {
    "id": "03161",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: kelvin\nspec:\n  selector:\n    matchLabels:\n      name: kelvin\n  template:\n    metadata:\n      labels:\n        name: kelvin\n        plane: data\n    spec:\n      affinity:\n        nodeAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n            nodeSelectorTerms:\n            - matchExpressions:\n              - key: kubernetes.io/os\n                operator: Exists\n              - key: kubernetes.io/os\n                operator: In\n                values:\n                - linux\n            - matchExpressions:\n              - key: beta.kubernetes.io/os\n                operator: Exists\n              - key: beta.kubernetes.io/os\n                operator: In\n                values:\n                - linux\n      initContainers:\n      - name: qb-wait\n        image: gcr.io/pixie-prod/pixie-prod-artifacts/curl:1.0\n        command:\n        - sh\n        - -c\n        - 'set -x; URL=\"https://${SERVICE_NAME}:${SERVICE_PORT}/healthz\"; until [\n          $(curl -m 0.5 -s -o /dev/null -w \"%{http_code}\" -k ${URL}) -eq 200 ]; do\n          echo \"waiting for ${URL}\" sleep 2; done; '\n        env:\n        - name: SERVICE_NAME\n          value: vizier-query-broker\n        - name: SERVICE_PORT\n          value: '50300'\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      containers:\n      - name: app\n        image: gcr.io/pixie-oss/pixie-dev/vizier/kelvin_image:stable\n        envFrom:\n        - configMapRef:\n            name: pl-tls-config\n        env:\n        - name: PL_HOST_PATH\n          value: /host\n        - name: PL_POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: PL_POD_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: PL_HOST_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.hostIP\n        - name: PL_JWT_SIGNING_KEY\n          valueFrom:\n            secretKeyRef:\n              key: jwt-signing-key\n              name: pl-cluster-secrets\n        - name: PL_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: TCMALLOC_SAMPLE_PARAMETER\n          value: '1048576'\n        ports:\n        - containerPort: 59300\n        volumeMounts:\n        - mountPath: /certs\n          name: certs\n        - name: sys\n          mountPath: /sys\n          readOnly: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: certs\n        secret:\n          secretName: service-tls-certs\n      - name: sys\n        emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "03162",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: kelvin\nspec:\n  selector:\n    matchLabels:\n      name: kelvin\n  template:\n    metadata:\n      labels:\n        name: kelvin\n        plane: data\n    spec:\n      affinity:\n        nodeAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n            nodeSelectorTerms:\n            - matchExpressions:\n              - key: kubernetes.io/os\n                operator: Exists\n              - key: kubernetes.io/os\n                operator: In\n                values:\n                - linux\n            - matchExpressions:\n              - key: beta.kubernetes.io/os\n                operator: Exists\n              - key: beta.kubernetes.io/os\n                operator: In\n                values:\n                - linux\n      initContainers:\n      - name: qb-wait\n        image: gcr.io/pixie-prod/pixie-prod-artifacts/curl:1.0\n        command:\n        - sh\n        - -c\n        - 'set -x; URL=\"https://${SERVICE_NAME}:${SERVICE_PORT}/healthz\"; until [\n          $(curl -m 0.5 -s -o /dev/null -w \"%{http_code}\" -k ${URL}) -eq 200 ]; do\n          echo \"waiting for ${URL}\" sleep 2; done; '\n        env:\n        - name: SERVICE_NAME\n          value: vizier-query-broker\n        - name: SERVICE_PORT\n          value: '50300'\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      containers:\n      - name: app\n        image: gcr.io/pixie-oss/pixie-dev/vizier/kelvin_image:stable\n        envFrom:\n        - configMapRef:\n            name: pl-tls-config\n        env:\n        - name: PL_HOST_PATH\n          value: /host\n        - name: PL_POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: PL_POD_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: PL_HOST_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.hostIP\n        - name: PL_JWT_SIGNING_KEY\n          valueFrom:\n            secretKeyRef:\n              key: jwt-signing-key\n              name: pl-cluster-secrets\n        - name: PL_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: TCMALLOC_SAMPLE_PARAMETER\n          value: '1048576'\n        ports:\n        - containerPort: 59300\n        volumeMounts:\n        - mountPath: /certs\n          name: certs\n        - name: sys\n          mountPath: /sys\n          readOnly: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: certs\n        secret:\n          secretName: service-tls-certs\n      - name: sys\n        emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "03163",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: kelvin\nspec:\n  selector:\n    matchLabels:\n      name: kelvin\n  template:\n    metadata:\n      labels:\n        name: kelvin\n        plane: data\n    spec:\n      affinity:\n        nodeAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n            nodeSelectorTerms:\n            - matchExpressions:\n              - key: kubernetes.io/os\n                operator: Exists\n              - key: kubernetes.io/os\n                operator: In\n                values:\n                - linux\n            - matchExpressions:\n              - key: beta.kubernetes.io/os\n                operator: Exists\n              - key: beta.kubernetes.io/os\n                operator: In\n                values:\n                - linux\n      initContainers:\n      - name: qb-wait\n        image: gcr.io/pixie-prod/pixie-prod-artifacts/curl:1.0\n        command:\n        - sh\n        - -c\n        - 'set -x; URL=\"https://${SERVICE_NAME}:${SERVICE_PORT}/healthz\"; until [\n          $(curl -m 0.5 -s -o /dev/null -w \"%{http_code}\" -k ${URL}) -eq 200 ]; do\n          echo \"waiting for ${URL}\" sleep 2; done; '\n        env:\n        - name: SERVICE_NAME\n          value: vizier-query-broker\n        - name: SERVICE_PORT\n          value: '50300'\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      containers:\n      - name: app\n        image: gcr.io/pixie-oss/pixie-dev/vizier/kelvin_image:stable\n        envFrom:\n        - configMapRef:\n            name: pl-tls-config\n        env:\n        - name: PL_HOST_PATH\n          value: /host\n        - name: PL_POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: PL_POD_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: PL_HOST_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.hostIP\n        - name: PL_JWT_SIGNING_KEY\n          valueFrom:\n            secretKeyRef:\n              key: jwt-signing-key\n              name: pl-cluster-secrets\n        - name: PL_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: TCMALLOC_SAMPLE_PARAMETER\n          value: '1048576'\n        ports:\n        - containerPort: 59300\n        volumeMounts:\n        - mountPath: /certs\n          name: certs\n        - name: sys\n          mountPath: /sys\n          readOnly: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: certs\n        secret:\n          secretName: service-tls-certs\n      - name: sys\n        emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "03164",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: kelvin\nspec:\n  selector:\n    matchLabels:\n      name: kelvin\n  template:\n    metadata:\n      labels:\n        name: kelvin\n        plane: data\n    spec:\n      affinity:\n        nodeAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n            nodeSelectorTerms:\n            - matchExpressions:\n              - key: kubernetes.io/os\n                operator: Exists\n              - key: kubernetes.io/os\n                operator: In\n                values:\n                - linux\n            - matchExpressions:\n              - key: beta.kubernetes.io/os\n                operator: Exists\n              - key: beta.kubernetes.io/os\n                operator: In\n                values:\n                - linux\n      initContainers:\n      - name: qb-wait\n        image: gcr.io/pixie-prod/pixie-prod-artifacts/curl:1.0\n        command:\n        - sh\n        - -c\n        - 'set -x; URL=\"https://${SERVICE_NAME}:${SERVICE_PORT}/healthz\"; until [\n          $(curl -m 0.5 -s -o /dev/null -w \"%{http_code}\" -k ${URL}) -eq 200 ]; do\n          echo \"waiting for ${URL}\" sleep 2; done; '\n        env:\n        - name: SERVICE_NAME\n          value: vizier-query-broker\n        - name: SERVICE_PORT\n          value: '50300'\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      containers:\n      - name: app\n        image: gcr.io/pixie-oss/pixie-dev/vizier/kelvin_image:stable\n        envFrom:\n        - configMapRef:\n            name: pl-tls-config\n        env:\n        - name: PL_HOST_PATH\n          value: /host\n        - name: PL_POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: PL_POD_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: PL_HOST_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.hostIP\n        - name: PL_JWT_SIGNING_KEY\n          valueFrom:\n            secretKeyRef:\n              key: jwt-signing-key\n              name: pl-cluster-secrets\n        - name: PL_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: TCMALLOC_SAMPLE_PARAMETER\n          value: '1048576'\n        ports:\n        - containerPort: 59300\n        volumeMounts:\n        - mountPath: /certs\n          name: certs\n        - name: sys\n          mountPath: /sys\n          readOnly: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: certs\n        secret:\n          secretName: service-tls-certs\n      - name: sys\n        emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "03165",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    kraken.service: redis\n  name: redis\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      kraken.service: redis\n  template:\n    metadata:\n      labels:\n        kraken.service: redis\n    spec:\n      containers:\n      - name: redis\n        image: redis:6\n        ports:\n        - name: redis\n          containerPort: 6379\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        volumeMounts:\n        - name: redis-data\n          mountPath: /data\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      securityContext:\n        seccompProfile:\n          type: RuntimeDefault\n        fsGroup: 1000\n      volumes:\n      - name: redis-data\n        emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "03166",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    kraken.service: redis\n  name: redis\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      kraken.service: redis\n  template:\n    metadata:\n      labels:\n        kraken.service: redis\n    spec:\n      containers:\n      - name: redis\n        image: redis:6\n        ports:\n        - name: redis\n          containerPort: 6379\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "03167",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    kraken.service: redis\n  name: redis\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      kraken.service: redis\n  template:\n    metadata:\n      labels:\n        kraken.service: redis\n    spec:\n      containers:\n      - name: redis\n        image: redis:6\n        ports:\n        - name: redis\n          containerPort: 6379\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "03168",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    kraken.service: redis\n  name: redis\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      kraken.service: redis\n  template:\n    metadata:\n      labels:\n        kraken.service: redis\n    spec:\n      containers:\n      - name: redis\n        image: redis:6\n        ports:\n        - name: redis\n          containerPort: 6379\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "03169",
    "policy_id": "no_latest_tag",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed: The Deployment \"serviceCenter\" is invalid: \n* metadata.name: Invalid value: \"serviceCenter\": a lowercase RFC 1123 subdomain must consist of lower case alphanumeric characters, '-' or '.', and must start and end with an alphanumeric character (e.g. 'example.com', regex used for validation is '[a-z0-9]([-a-z0-9]*[a-z0-9])?(\\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*')\n* spec.template.spec.containers[0].name: Invalid value: \"serviceCenter\": a lowercase RFC 1123 label must consist of lower case alphanumeric characters or '-', and must start and end with an alphanumeric character (e.g. 'my-name',  or '123-abc', regex used for validation is '[a-z0-9]([-a-z0-9]*[a-z0-9])?')"
    ]
  },
  {
    "id": "03170",
    "policy_id": "read_only_root_fs",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed: The Deployment \"serviceCenter\" is invalid: \n* metadata.name: Invalid value: \"serviceCenter\": a lowercase RFC 1123 subdomain must consist of lower case alphanumeric characters, '-' or '.', and must start and end with an alphanumeric character (e.g. 'example.com', regex used for validation is '[a-z0-9]([-a-z0-9]*[a-z0-9])?(\\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*')\n* spec.template.spec.containers[0].name: Invalid value: \"serviceCenter\": a lowercase RFC 1123 label must consist of lower case alphanumeric characters or '-', and must start and end with an alphanumeric character (e.g. 'my-name',  or '123-abc', regex used for validation is '[a-z0-9]([-a-z0-9]*[a-z0-9])?')"
    ]
  },
  {
    "id": "03171",
    "policy_id": "run_as_non_root",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed: The Deployment \"serviceCenter\" is invalid: \n* metadata.name: Invalid value: \"serviceCenter\": a lowercase RFC 1123 subdomain must consist of lower case alphanumeric characters, '-' or '.', and must start and end with an alphanumeric character (e.g. 'example.com', regex used for validation is '[a-z0-9]([-a-z0-9]*[a-z0-9])?(\\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*')\n* spec.template.spec.containers[0].name: Invalid value: \"serviceCenter\": a lowercase RFC 1123 label must consist of lower case alphanumeric characters or '-', and must start and end with an alphanumeric character (e.g. 'my-name',  or '123-abc', regex used for validation is '[a-z0-9]([-a-z0-9]*[a-z0-9])?')"
    ]
  },
  {
    "id": "03172",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed: The Deployment \"serviceCenter\" is invalid: \n* metadata.name: Invalid value: \"serviceCenter\": a lowercase RFC 1123 subdomain must consist of lower case alphanumeric characters, '-' or '.', and must start and end with an alphanumeric character (e.g. 'example.com', regex used for validation is '[a-z0-9]([-a-z0-9]*[a-z0-9])?(\\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*')\n* spec.template.spec.containers[0].name: Invalid value: \"serviceCenter\": a lowercase RFC 1123 label must consist of lower case alphanumeric characters or '-', and must start and end with an alphanumeric character (e.g. 'my-name',  or '123-abc', regex used for validation is '[a-z0-9]([-a-z0-9]*[a-z0-9])?')"
    ]
  },
  {
    "id": "03173",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed: The Deployment \"serviceCenter\" is invalid: \n* metadata.name: Invalid value: \"serviceCenter\": a lowercase RFC 1123 subdomain must consist of lower case alphanumeric characters, '-' or '.', and must start and end with an alphanumeric character (e.g. 'example.com', regex used for validation is '[a-z0-9]([-a-z0-9]*[a-z0-9])?(\\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*')\n* spec.template.spec.containers[0].name: Invalid value: \"serviceCenter\": a lowercase RFC 1123 label must consist of lower case alphanumeric characters or '-', and must start and end with an alphanumeric character (e.g. 'my-name',  or '123-abc', regex used for validation is '[a-z0-9]([-a-z0-9]*[a-z0-9])?')"
    ]
  },
  {
    "id": "03174",
    "policy_id": "read_only_root_fs",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed: The StatefulSet \"eventstore\" is invalid: spec.template.spec.containers[0].volumeMounts[0].name: Not found: \"eventstore-pv-storage\""
    ]
  },
  {
    "id": "03175",
    "policy_id": "run_as_non_root",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed: The StatefulSet \"eventstore\" is invalid: spec.template.spec.containers[0].volumeMounts[0].name: Not found: \"eventstore-pv-storage\""
    ]
  },
  {
    "id": "03176",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed: The StatefulSet \"eventstore\" is invalid: spec.template.spec.containers[0].volumeMounts[0].name: Not found: \"eventstore-pv-storage\""
    ]
  },
  {
    "id": "03177",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed: The StatefulSet \"eventstore\" is invalid: spec.template.spec.containers[0].volumeMounts[0].name: Not found: \"eventstore-pv-storage\""
    ]
  },
  {
    "id": "03178",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: certbotdns\n  labels:\n    purpose: certbot\nspec:\n  template:\n    spec:\n      serviceAccountName: certbot\n      containers:\n      - name: certbotdns\n        image: mbuckrogers/gcednscertbot:stable\n        args:\n        - --server=$(LE_SERVER)\n        - -n\n        - -v\n        - --dns-google\n        - --dns-google-propagation-seconds=60\n        - --email=$(EMAIL)\n        - --agree-tos\n        - --dns-google-credentials=$(GOOGLE_APPLICATION_CREDENTIALS)\n        - --deploy-hook=deployhook.sh\n        - -d $(DOMAINS)\n        - certonly\n        imagePullPolicy: Always\n        volumeMounts:\n        - name: google-cloud-key\n          mountPath: /var/secrets/google\n        - name: certs-storage\n          mountPath: /etc/letsencrypt/\n        env:\n        - name: GOOGLE_APPLICATION_CREDENTIALS\n          value: /var/secrets/google/key.json\n        envFrom:\n        - configMapRef:\n            name: certbot-config\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: google-cloud-key\n        secret:\n          secretName: dns-key\n      - name: certs-storage\n        gcePersistentDisk:\n          pdName: certbot-disk\n          fsType: ext4\n      restartPolicy: OnFailure\n",
    "errors": []
  },
  {
    "id": "03179",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: certbotdns\n  labels:\n    purpose: certbot\nspec:\n  template:\n    spec:\n      serviceAccountName: certbot\n      containers:\n      - name: certbotdns\n        image: mbuckrogers/gcednscertbot:stable\n        args:\n        - --server=$(LE_SERVER)\n        - -n\n        - -v\n        - --dns-google\n        - --dns-google-propagation-seconds=60\n        - --email=$(EMAIL)\n        - --agree-tos\n        - --dns-google-credentials=$(GOOGLE_APPLICATION_CREDENTIALS)\n        - --deploy-hook=deployhook.sh\n        - -d $(DOMAINS)\n        - certonly\n        imagePullPolicy: Always\n        volumeMounts:\n        - name: google-cloud-key\n          mountPath: /var/secrets/google\n        - name: certs-storage\n          mountPath: /etc/letsencrypt/\n        env:\n        - name: GOOGLE_APPLICATION_CREDENTIALS\n          value: /var/secrets/google/key.json\n        envFrom:\n        - configMapRef:\n            name: certbot-config\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: google-cloud-key\n        secret:\n          secretName: dns-key\n      - name: certs-storage\n        gcePersistentDisk:\n          pdName: certbot-disk\n          fsType: ext4\n      restartPolicy: OnFailure\n",
    "errors": []
  },
  {
    "id": "03180",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: certbotdns\n  labels:\n    purpose: certbot\nspec:\n  template:\n    spec:\n      serviceAccountName: certbot\n      containers:\n      - name: certbotdns\n        image: mbuckrogers/gcednscertbot:stable\n        args:\n        - --server=$(LE_SERVER)\n        - -n\n        - -v\n        - --dns-google\n        - --dns-google-propagation-seconds=60\n        - --email=$(EMAIL)\n        - --agree-tos\n        - --dns-google-credentials=$(GOOGLE_APPLICATION_CREDENTIALS)\n        - --deploy-hook=deployhook.sh\n        - -d $(DOMAINS)\n        - certonly\n        imagePullPolicy: Always\n        volumeMounts:\n        - name: google-cloud-key\n          mountPath: /var/secrets/google\n        - name: certs-storage\n          mountPath: /etc/letsencrypt/\n        env:\n        - name: GOOGLE_APPLICATION_CREDENTIALS\n          value: /var/secrets/google/key.json\n        envFrom:\n        - configMapRef:\n            name: certbot-config\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: google-cloud-key\n        secret:\n          secretName: dns-key\n      - name: certs-storage\n        gcePersistentDisk:\n          pdName: certbot-disk\n          fsType: ext4\n      restartPolicy: OnFailure\n",
    "errors": []
  },
  {
    "id": "03181",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: certbotdns\n  labels:\n    purpose: certbot\nspec:\n  template:\n    spec:\n      serviceAccountName: certbot\n      containers:\n      - name: certbotdns\n        image: mbuckrogers/gcednscertbot:stable\n        args:\n        - --server=$(LE_SERVER)\n        - -n\n        - -v\n        - --dns-google\n        - --dns-google-propagation-seconds=60\n        - --email=$(EMAIL)\n        - --agree-tos\n        - --dns-google-credentials=$(GOOGLE_APPLICATION_CREDENTIALS)\n        - --deploy-hook=deployhook.sh\n        - -d $(DOMAINS)\n        - certonly\n        imagePullPolicy: Always\n        volumeMounts:\n        - name: google-cloud-key\n          mountPath: /var/secrets/google\n        - name: certs-storage\n          mountPath: /etc/letsencrypt/\n        env:\n        - name: GOOGLE_APPLICATION_CREDENTIALS\n          value: /var/secrets/google/key.json\n        envFrom:\n        - configMapRef:\n            name: certbot-config\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: google-cloud-key\n        secret:\n          secretName: dns-key\n      - name: certs-storage\n        gcePersistentDisk:\n          pdName: certbot-disk\n          fsType: ext4\n      restartPolicy: OnFailure\n",
    "errors": []
  },
  {
    "id": "03182",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: certbotdns\n  labels:\n    purpose: certbot\nspec:\n  template:\n    spec:\n      serviceAccountName: certbot\n      containers:\n      - name: certbotdns\n        image: mbuckrogers/gcednscertbot:stable\n        args:\n        - --server=$(LE_SERVER)\n        - -n\n        - -v\n        - --dns-google\n        - --dns-google-propagation-seconds=60\n        - --email=$(EMAIL)\n        - --agree-tos\n        - --dns-google-credentials=$(GOOGLE_APPLICATION_CREDENTIALS)\n        - --deploy-hook=deployhook.sh\n        - -d $(DOMAINS)\n        - certonly\n        imagePullPolicy: Always\n        volumeMounts:\n        - name: google-cloud-key\n          mountPath: /var/secrets/google\n        - name: certs-storage\n          mountPath: /etc/letsencrypt/\n        env:\n        - name: GOOGLE_APPLICATION_CREDENTIALS\n          value: /var/secrets/google/key.json\n        envFrom:\n        - configMapRef:\n            name: certbot-config\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: google-cloud-key\n        secret:\n          secretName: dns-key\n      - name: certs-storage\n        gcePersistentDisk:\n          pdName: certbot-disk\n          fsType: ext4\n      restartPolicy: OnFailure\n",
    "errors": []
  },
  {
    "id": "03183",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: openstack-cinder-csi-driver-node\n  namespace: openshift-cluster-csi-drivers\n  annotations:\n    config.openshift.io/inject-proxy: csi-driver\nspec:\n  selector:\n    matchLabels:\n      app: openstack-cinder-csi-driver-node\n  template:\n    metadata:\n      labels:\n        app: openstack-cinder-csi-driver-node\n    spec:\n      serviceAccount: openstack-cinder-csi-driver-node-sa\n      containers:\n      - name: csi-driver\n        securityContext:\n          privileged: false\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        image: ${DRIVER_IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        args:\n        - /bin/cinder-csi-plugin\n        - --nodeid=$(NODE_ID)\n        - --endpoint=$(CSI_ENDPOINT)\n        - --cloud-config=$(CLOUD_CONFIG)\n        - --v=${LOG_LEVEL}\n        env:\n        - name: NODE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CSI_ENDPOINT\n          value: unix://csi/csi.sock\n        - name: CLOUD_CONFIG\n          value: /etc/kubernetes/config/cloud.conf\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: HostToContainer\n        - name: pods-probe-dir\n          mountPath: /dev\n          mountPropagation: HostToContainer\n        - name: secret-cinderplugin\n          mountPath: /etc/kubernetes/secret\n          readOnly: true\n        - name: config-cinderplugin\n          mountPath: /etc/kubernetes/config\n          readOnly: true\n        - name: cacert\n          mountPath: /etc/kubernetes/static-pod-resources/configmaps/cloud-config\n        ports:\n        - name: healthz\n          containerPort: 10300\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 10\n          timeoutSeconds: 10\n          periodSeconds: 30\n          failureThreshold: 5\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - name: node-driver-registrar\n        image: ${NODE_DRIVER_REGISTRAR_IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        args:\n        - --v=5\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REG_SOCK_PATH)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REG_SOCK_PATH\n          value: /var/lib/kubelet/plugins/cinder.csi.openstack.org/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - name: csi-liveness-probe\n        image: ${LIVENESS_PROBE_IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        args:\n        - --csi-address=/csi/csi.sock\n        - --probe-timeout=10s\n        - --health-port=10300\n        - --v=${LOG_LEVEL}\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: socket-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/cinder.csi.openstack.org\n          type: DirectoryOrCreate\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n      - name: pods-probe-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: secret-cinderplugin\n        secret:\n          secretName: openstack-cloud-credentials\n          items:\n          - key: clouds.yaml\n            path: clouds.yaml\n      - name: config-cinderplugin\n        configMap:\n          name: openstack-cinder-config\n          items:\n          - key: cloud.conf\n            path: cloud.conf\n          - key: multiaz-cloud.conf\n            path: multiaz-cloud.conf\n      - name: cacert\n        configMap:\n          name: cloud-provider-config\n          items:\n          - key: ca-bundle.pem\n            path: ca-bundle.pem\n          optional: true\n",
    "errors": []
  },
  {
    "id": "03184",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: openstack-cinder-csi-driver-node\n  namespace: openshift-cluster-csi-drivers\n  annotations:\n    config.openshift.io/inject-proxy: csi-driver\nspec:\n  selector:\n    matchLabels:\n      app: openstack-cinder-csi-driver-node\n  template:\n    metadata:\n      labels:\n        app: openstack-cinder-csi-driver-node\n    spec:\n      serviceAccount: openstack-cinder-csi-driver-node-sa\n      containers:\n      - name: csi-driver\n        securityContext:\n          privileged: false\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        image: ${DRIVER_IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        args:\n        - /bin/cinder-csi-plugin\n        - --nodeid=$(NODE_ID)\n        - --endpoint=$(CSI_ENDPOINT)\n        - --cloud-config=$(CLOUD_CONFIG)\n        - --v=${LOG_LEVEL}\n        env:\n        - name: NODE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CSI_ENDPOINT\n          value: unix://csi/csi.sock\n        - name: CLOUD_CONFIG\n          value: /etc/kubernetes/config/cloud.conf\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: HostToContainer\n        - name: pods-probe-dir\n          mountPath: /dev\n          mountPropagation: HostToContainer\n        - name: secret-cinderplugin\n          mountPath: /etc/kubernetes/secret\n          readOnly: true\n        - name: config-cinderplugin\n          mountPath: /etc/kubernetes/config\n          readOnly: true\n        - name: cacert\n          mountPath: /etc/kubernetes/static-pod-resources/configmaps/cloud-config\n        ports:\n        - name: healthz\n          containerPort: 10300\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 10\n          timeoutSeconds: 10\n          periodSeconds: 30\n          failureThreshold: 5\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - name: node-driver-registrar\n        image: ${NODE_DRIVER_REGISTRAR_IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        args:\n        - --v=5\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REG_SOCK_PATH)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REG_SOCK_PATH\n          value: /var/lib/kubelet/plugins/cinder.csi.openstack.org/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - name: csi-liveness-probe\n        image: ${LIVENESS_PROBE_IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        args:\n        - --csi-address=/csi/csi.sock\n        - --probe-timeout=10s\n        - --health-port=10300\n        - --v=${LOG_LEVEL}\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: socket-dir\n        emptyDir: {}\n      - name: registration-dir\n        emptyDir: {}\n      - name: kubelet-dir\n        emptyDir: {}\n      - name: pods-probe-dir\n        emptyDir: {}\n      - name: secret-cinderplugin\n        secret:\n          secretName: openstack-cloud-credentials\n          items:\n          - key: clouds.yaml\n            path: clouds.yaml\n      - name: config-cinderplugin\n        configMap:\n          name: openstack-cinder-config\n          items:\n          - key: cloud.conf\n            path: cloud.conf\n          - key: multiaz-cloud.conf\n            path: multiaz-cloud.conf\n      - name: cacert\n        configMap:\n          name: cloud-provider-config\n          items:\n          - key: ca-bundle.pem\n            path: ca-bundle.pem\n          optional: true\n",
    "errors": []
  },
  {
    "id": "03185",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: openstack-cinder-csi-driver-node\n  namespace: openshift-cluster-csi-drivers\n  annotations:\n    config.openshift.io/inject-proxy: csi-driver\nspec:\n  selector:\n    matchLabels:\n      app: openstack-cinder-csi-driver-node\n  template:\n    metadata:\n      labels:\n        app: openstack-cinder-csi-driver-node\n    spec:\n      serviceAccount: openstack-cinder-csi-driver-node-sa\n      containers:\n      - name: csi-driver\n        securityContext:\n          privileged: false\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        image: ${DRIVER_IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        args:\n        - /bin/cinder-csi-plugin\n        - --nodeid=$(NODE_ID)\n        - --endpoint=$(CSI_ENDPOINT)\n        - --cloud-config=$(CLOUD_CONFIG)\n        - --v=${LOG_LEVEL}\n        env:\n        - name: NODE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CSI_ENDPOINT\n          value: unix://csi/csi.sock\n        - name: CLOUD_CONFIG\n          value: /etc/kubernetes/config/cloud.conf\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: HostToContainer\n        - name: pods-probe-dir\n          mountPath: /dev\n          mountPropagation: HostToContainer\n        - name: secret-cinderplugin\n          mountPath: /etc/kubernetes/secret\n          readOnly: true\n        - name: config-cinderplugin\n          mountPath: /etc/kubernetes/config\n          readOnly: true\n        - name: cacert\n          mountPath: /etc/kubernetes/static-pod-resources/configmaps/cloud-config\n        ports:\n        - name: healthz\n          containerPort: 10300\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 10\n          timeoutSeconds: 10\n          periodSeconds: 30\n          failureThreshold: 5\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - name: node-driver-registrar\n        image: ${NODE_DRIVER_REGISTRAR_IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        args:\n        - --v=5\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REG_SOCK_PATH)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REG_SOCK_PATH\n          value: /var/lib/kubelet/plugins/cinder.csi.openstack.org/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - name: csi-liveness-probe\n        image: ${LIVENESS_PROBE_IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        args:\n        - --csi-address=/csi/csi.sock\n        - --probe-timeout=10s\n        - --health-port=10300\n        - --v=${LOG_LEVEL}\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: socket-dir\n        emptyDir: {}\n      - name: registration-dir\n        emptyDir: {}\n      - name: kubelet-dir\n        emptyDir: {}\n      - name: pods-probe-dir\n        emptyDir: {}\n      - name: secret-cinderplugin\n        secret:\n          secretName: openstack-cloud-credentials\n          items:\n          - key: clouds.yaml\n            path: clouds.yaml\n      - name: config-cinderplugin\n        configMap:\n          name: openstack-cinder-config\n          items:\n          - key: cloud.conf\n            path: cloud.conf\n          - key: multiaz-cloud.conf\n            path: multiaz-cloud.conf\n      - name: cacert\n        configMap:\n          name: cloud-provider-config\n          items:\n          - key: ca-bundle.pem\n            path: ca-bundle.pem\n          optional: true\n",
    "errors": []
  },
  {
    "id": "03186",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: openstack-cinder-csi-driver-node\n  namespace: openshift-cluster-csi-drivers\n  annotations:\n    config.openshift.io/inject-proxy: csi-driver\nspec:\n  selector:\n    matchLabels:\n      app: openstack-cinder-csi-driver-node\n  template:\n    metadata:\n      labels:\n        app: openstack-cinder-csi-driver-node\n    spec:\n      serviceAccount: openstack-cinder-csi-driver-node-sa\n      containers:\n      - name: csi-driver\n        securityContext:\n          privileged: false\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          runAsNonRoot: true\n        image: ${DRIVER_IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        args:\n        - /bin/cinder-csi-plugin\n        - --nodeid=$(NODE_ID)\n        - --endpoint=$(CSI_ENDPOINT)\n        - --cloud-config=$(CLOUD_CONFIG)\n        - --v=${LOG_LEVEL}\n        env:\n        - name: NODE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CSI_ENDPOINT\n          value: unix://csi/csi.sock\n        - name: CLOUD_CONFIG\n          value: /etc/kubernetes/config/cloud.conf\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: HostToContainer\n        - name: pods-probe-dir\n          mountPath: /dev\n          mountPropagation: HostToContainer\n        - name: secret-cinderplugin\n          mountPath: /etc/kubernetes/secret\n          readOnly: true\n        - name: config-cinderplugin\n          mountPath: /etc/kubernetes/config\n          readOnly: true\n        - name: cacert\n          mountPath: /etc/kubernetes/static-pod-resources/configmaps/cloud-config\n        ports:\n        - name: healthz\n          containerPort: 10300\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 10\n          timeoutSeconds: 10\n          periodSeconds: 30\n          failureThreshold: 5\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - name: node-driver-registrar\n        image: ${NODE_DRIVER_REGISTRAR_IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        args:\n        - --v=5\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REG_SOCK_PATH)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REG_SOCK_PATH\n          value: /var/lib/kubelet/plugins/cinder.csi.openstack.org/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n      - name: csi-liveness-probe\n        image: ${LIVENESS_PROBE_IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        args:\n        - --csi-address=/csi/csi.sock\n        - --probe-timeout=10s\n        - --health-port=10300\n        - --v=${LOG_LEVEL}\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n      volumes:\n      - name: socket-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/cinder.csi.openstack.org\n          type: DirectoryOrCreate\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n      - name: pods-probe-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: secret-cinderplugin\n        secret:\n          secretName: openstack-cloud-credentials\n          items:\n          - key: clouds.yaml\n            path: clouds.yaml\n      - name: config-cinderplugin\n        configMap:\n          name: openstack-cinder-config\n          items:\n          - key: cloud.conf\n            path: cloud.conf\n          - key: multiaz-cloud.conf\n            path: multiaz-cloud.conf\n      - name: cacert\n        configMap:\n          name: cloud-provider-config\n          items:\n          - key: ca-bundle.pem\n            path: ca-bundle.pem\n          optional: true\n",
    "errors": []
  },
  {
    "id": "03187",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: openstack-cinder-csi-driver-node\n  namespace: openshift-cluster-csi-drivers\n  annotations:\n    config.openshift.io/inject-proxy: csi-driver\nspec:\n  selector:\n    matchLabels:\n      app: openstack-cinder-csi-driver-node\n  template:\n    metadata:\n      labels:\n        app: openstack-cinder-csi-driver-node\n    spec:\n      serviceAccount: openstack-cinder-csi-driver-node-sa\n      containers:\n      - name: csi-driver\n        securityContext:\n          privileged: false\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          seccompProfile:\n            type: RuntimeDefault\n          runAsNonRoot: true\n        image: ${DRIVER_IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        args:\n        - /bin/cinder-csi-plugin\n        - --nodeid=$(NODE_ID)\n        - --endpoint=$(CSI_ENDPOINT)\n        - --cloud-config=$(CLOUD_CONFIG)\n        - --v=${LOG_LEVEL}\n        env:\n        - name: NODE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CSI_ENDPOINT\n          value: unix://csi/csi.sock\n        - name: CLOUD_CONFIG\n          value: /etc/kubernetes/config/cloud.conf\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: HostToContainer\n        - name: pods-probe-dir\n          mountPath: /dev\n          mountPropagation: HostToContainer\n        - name: secret-cinderplugin\n          mountPath: /etc/kubernetes/secret\n          readOnly: true\n        - name: config-cinderplugin\n          mountPath: /etc/kubernetes/config\n          readOnly: true\n        - name: cacert\n          mountPath: /etc/kubernetes/static-pod-resources/configmaps/cloud-config\n        ports:\n        - name: healthz\n          containerPort: 10300\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 10\n          timeoutSeconds: 10\n          periodSeconds: 30\n          failureThreshold: 5\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - name: node-driver-registrar\n        image: ${NODE_DRIVER_REGISTRAR_IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        args:\n        - --v=5\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REG_SOCK_PATH)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REG_SOCK_PATH\n          value: /var/lib/kubelet/plugins/cinder.csi.openstack.org/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n      - name: csi-liveness-probe\n        image: ${LIVENESS_PROBE_IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        args:\n        - --csi-address=/csi/csi.sock\n        - --probe-timeout=10s\n        - --health-port=10300\n        - --v=${LOG_LEVEL}\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n      volumes:\n      - name: socket-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/cinder.csi.openstack.org\n          type: DirectoryOrCreate\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n      - name: pods-probe-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: secret-cinderplugin\n        secret:\n          secretName: openstack-cloud-credentials\n          items:\n          - key: clouds.yaml\n            path: clouds.yaml\n      - name: config-cinderplugin\n        configMap:\n          name: openstack-cinder-config\n          items:\n          - key: cloud.conf\n            path: cloud.conf\n          - key: multiaz-cloud.conf\n            path: multiaz-cloud.conf\n      - name: cacert\n        configMap:\n          name: cloud-provider-config\n          items:\n          - key: ca-bundle.pem\n            path: ca-bundle.pem\n          optional: true\n",
    "errors": []
  },
  {
    "id": "03188",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: openstack-cinder-csi-driver-node\n  namespace: openshift-cluster-csi-drivers\n  annotations:\n    config.openshift.io/inject-proxy: csi-driver\nspec:\n  selector:\n    matchLabels:\n      app: openstack-cinder-csi-driver-node\n  template:\n    metadata:\n      labels:\n        app: openstack-cinder-csi-driver-node\n    spec:\n      serviceAccount: openstack-cinder-csi-driver-node-sa\n      containers:\n      - name: csi-driver\n        securityContext:\n          privileged: false\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          runAsNonRoot: true\n        image: ${DRIVER_IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        args:\n        - /bin/cinder-csi-plugin\n        - --nodeid=$(NODE_ID)\n        - --endpoint=$(CSI_ENDPOINT)\n        - --cloud-config=$(CLOUD_CONFIG)\n        - --v=${LOG_LEVEL}\n        env:\n        - name: NODE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CSI_ENDPOINT\n          value: unix://csi/csi.sock\n        - name: CLOUD_CONFIG\n          value: /etc/kubernetes/config/cloud.conf\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: HostToContainer\n        - name: pods-probe-dir\n          mountPath: /dev\n          mountPropagation: HostToContainer\n        - name: secret-cinderplugin\n          mountPath: /etc/kubernetes/secret\n          readOnly: true\n        - name: config-cinderplugin\n          mountPath: /etc/kubernetes/config\n          readOnly: true\n        - name: cacert\n          mountPath: /etc/kubernetes/static-pod-resources/configmaps/cloud-config\n        ports:\n        - name: healthz\n          containerPort: 10300\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 10\n          timeoutSeconds: 10\n          periodSeconds: 30\n          failureThreshold: 5\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - name: node-driver-registrar\n        image: ${NODE_DRIVER_REGISTRAR_IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        args:\n        - --v=5\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REG_SOCK_PATH)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REG_SOCK_PATH\n          value: /var/lib/kubelet/plugins/cinder.csi.openstack.org/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n      - name: csi-liveness-probe\n        image: ${LIVENESS_PROBE_IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        args:\n        - --csi-address=/csi/csi.sock\n        - --probe-timeout=10s\n        - --health-port=10300\n        - --v=${LOG_LEVEL}\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n      volumes:\n      - name: socket-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/cinder.csi.openstack.org\n          type: DirectoryOrCreate\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n      - name: pods-probe-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: secret-cinderplugin\n        secret:\n          secretName: openstack-cloud-credentials\n          items:\n          - key: clouds.yaml\n            path: clouds.yaml\n      - name: config-cinderplugin\n        configMap:\n          name: openstack-cinder-config\n          items:\n          - key: cloud.conf\n            path: cloud.conf\n          - key: multiaz-cloud.conf\n            path: multiaz-cloud.conf\n      - name: cacert\n        configMap:\n          name: cloud-provider-config\n          items:\n          - key: ca-bundle.pem\n            path: ca-bundle.pem\n          optional: true\n",
    "errors": []
  },
  {
    "id": "03189",
    "policy_id": "drop_capabilities",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: openstack-cinder-csi-driver-node\n  namespace: openshift-cluster-csi-drivers\n  annotations:\n    config.openshift.io/inject-proxy: csi-driver\nspec:\n  selector:\n    matchLabels:\n      app: openstack-cinder-csi-driver-node\n  template:\n    metadata:\n      labels:\n        app: openstack-cinder-csi-driver-node\n    spec:\n      serviceAccount: openstack-cinder-csi-driver-node-sa\n      containers:\n      - name: csi-driver\n        securityContext:\n          privileged: false\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          runAsNonRoot: true\n        image: ${DRIVER_IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        args:\n        - /bin/cinder-csi-plugin\n        - --nodeid=$(NODE_ID)\n        - --endpoint=$(CSI_ENDPOINT)\n        - --cloud-config=$(CLOUD_CONFIG)\n        - --v=${LOG_LEVEL}\n        env:\n        - name: NODE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CSI_ENDPOINT\n          value: unix://csi/csi.sock\n        - name: CLOUD_CONFIG\n          value: /etc/kubernetes/config/cloud.conf\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: HostToContainer\n        - name: pods-probe-dir\n          mountPath: /dev\n          mountPropagation: HostToContainer\n        - name: secret-cinderplugin\n          mountPath: /etc/kubernetes/secret\n          readOnly: true\n        - name: config-cinderplugin\n          mountPath: /etc/kubernetes/config\n          readOnly: true\n        - name: cacert\n          mountPath: /etc/kubernetes/static-pod-resources/configmaps/cloud-config\n        ports:\n        - name: healthz\n          containerPort: 10300\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 10\n          timeoutSeconds: 10\n          periodSeconds: 30\n          failureThreshold: 5\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - name: node-driver-registrar\n        image: ${NODE_DRIVER_REGISTRAR_IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        args:\n        - --v=5\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REG_SOCK_PATH)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REG_SOCK_PATH\n          value: /var/lib/kubelet/plugins/cinder.csi.openstack.org/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - name: csi-liveness-probe\n        image: ${LIVENESS_PROBE_IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        args:\n        - --csi-address=/csi/csi.sock\n        - --probe-timeout=10s\n        - --health-port=10300\n        - --v=${LOG_LEVEL}\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: socket-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/cinder.csi.openstack.org\n          type: DirectoryOrCreate\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n      - name: pods-probe-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: secret-cinderplugin\n        secret:\n          secretName: openstack-cloud-credentials\n          items:\n          - key: clouds.yaml\n            path: clouds.yaml\n      - name: config-cinderplugin\n        configMap:\n          name: openstack-cinder-config\n          items:\n          - key: cloud.conf\n            path: cloud.conf\n          - key: multiaz-cloud.conf\n            path: multiaz-cloud.conf\n      - name: cacert\n        configMap:\n          name: cloud-provider-config\n          items:\n          - key: ca-bundle.pem\n            path: ca-bundle.pem\n          optional: true\n",
    "errors": []
  },
  {
    "id": "03190",
    "policy_id": "no_privileged",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: openstack-cinder-csi-driver-node\n  namespace: openshift-cluster-csi-drivers\n  annotations:\n    config.openshift.io/inject-proxy: csi-driver\nspec:\n  selector:\n    matchLabels:\n      app: openstack-cinder-csi-driver-node\n  template:\n    metadata:\n      labels:\n        app: openstack-cinder-csi-driver-node\n    spec:\n      serviceAccount: openstack-cinder-csi-driver-node-sa\n      containers:\n      - name: csi-driver\n        securityContext:\n          privileged: false\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          runAsNonRoot: true\n        image: ${DRIVER_IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        args:\n        - /bin/cinder-csi-plugin\n        - --nodeid=$(NODE_ID)\n        - --endpoint=$(CSI_ENDPOINT)\n        - --cloud-config=$(CLOUD_CONFIG)\n        - --v=${LOG_LEVEL}\n        env:\n        - name: NODE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CSI_ENDPOINT\n          value: unix://csi/csi.sock\n        - name: CLOUD_CONFIG\n          value: /etc/kubernetes/config/cloud.conf\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: HostToContainer\n        - name: pods-probe-dir\n          mountPath: /dev\n          mountPropagation: HostToContainer\n        - name: secret-cinderplugin\n          mountPath: /etc/kubernetes/secret\n          readOnly: true\n        - name: config-cinderplugin\n          mountPath: /etc/kubernetes/config\n          readOnly: true\n        - name: cacert\n          mountPath: /etc/kubernetes/static-pod-resources/configmaps/cloud-config\n        ports:\n        - name: healthz\n          containerPort: 10300\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 10\n          timeoutSeconds: 10\n          periodSeconds: 30\n          failureThreshold: 5\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - name: node-driver-registrar\n        image: ${NODE_DRIVER_REGISTRAR_IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        args:\n        - --v=5\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REG_SOCK_PATH)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REG_SOCK_PATH\n          value: /var/lib/kubelet/plugins/cinder.csi.openstack.org/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - name: csi-liveness-probe\n        image: ${LIVENESS_PROBE_IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        args:\n        - --csi-address=/csi/csi.sock\n        - --probe-timeout=10s\n        - --health-port=10300\n        - --v=${LOG_LEVEL}\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: socket-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/cinder.csi.openstack.org\n          type: DirectoryOrCreate\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n      - name: pods-probe-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: secret-cinderplugin\n        secret:\n          secretName: openstack-cloud-credentials\n          items:\n          - key: clouds.yaml\n            path: clouds.yaml\n      - name: config-cinderplugin\n        configMap:\n          name: openstack-cinder-config\n          items:\n          - key: cloud.conf\n            path: cloud.conf\n          - key: multiaz-cloud.conf\n            path: multiaz-cloud.conf\n      - name: cacert\n        configMap:\n          name: cloud-provider-config\n          items:\n          - key: ca-bundle.pem\n            path: ca-bundle.pem\n          optional: true\n",
    "errors": []
  },
  {
    "id": "03191",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: openstack-cinder-csi-driver-node\n  namespace: openshift-cluster-csi-drivers\n  annotations:\n    config.openshift.io/inject-proxy: csi-driver\nspec:\n  selector:\n    matchLabels:\n      app: openstack-cinder-csi-driver-node\n  template:\n    metadata:\n      labels:\n        app: openstack-cinder-csi-driver-node\n    spec:\n      serviceAccount: openstack-cinder-csi-driver-node-sa\n      containers:\n      - name: csi-driver\n        securityContext:\n          privileged: false\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        image: ${DRIVER_IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        args:\n        - /bin/cinder-csi-plugin\n        - --nodeid=$(NODE_ID)\n        - --endpoint=$(CSI_ENDPOINT)\n        - --cloud-config=$(CLOUD_CONFIG)\n        - --v=${LOG_LEVEL}\n        env:\n        - name: NODE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CSI_ENDPOINT\n          value: unix://csi/csi.sock\n        - name: CLOUD_CONFIG\n          value: /etc/kubernetes/config/cloud.conf\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: HostToContainer\n        - name: pods-probe-dir\n          mountPath: /dev\n          mountPropagation: HostToContainer\n        - name: secret-cinderplugin\n          mountPath: /etc/kubernetes/secret\n          readOnly: true\n        - name: config-cinderplugin\n          mountPath: /etc/kubernetes/config\n          readOnly: true\n        - name: cacert\n          mountPath: /etc/kubernetes/static-pod-resources/configmaps/cloud-config\n        ports:\n        - name: healthz\n          containerPort: 10300\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 10\n          timeoutSeconds: 10\n          periodSeconds: 30\n          failureThreshold: 5\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - name: node-driver-registrar\n        image: ${NODE_DRIVER_REGISTRAR_IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        args:\n        - --v=5\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REG_SOCK_PATH)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REG_SOCK_PATH\n          value: /var/lib/kubelet/plugins/cinder.csi.openstack.org/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n      - name: csi-liveness-probe\n        image: ${LIVENESS_PROBE_IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        args:\n        - --csi-address=/csi/csi.sock\n        - --probe-timeout=10s\n        - --health-port=10300\n        - --v=${LOG_LEVEL}\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: socket-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/cinder.csi.openstack.org\n          type: DirectoryOrCreate\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n      - name: pods-probe-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: secret-cinderplugin\n        secret:\n          secretName: openstack-cloud-credentials\n          items:\n          - key: clouds.yaml\n            path: clouds.yaml\n      - name: config-cinderplugin\n        configMap:\n          name: openstack-cinder-config\n          items:\n          - key: cloud.conf\n            path: cloud.conf\n          - key: multiaz-cloud.conf\n            path: multiaz-cloud.conf\n      - name: cacert\n        configMap:\n          name: cloud-provider-config\n          items:\n          - key: ca-bundle.pem\n            path: ca-bundle.pem\n          optional: true\n",
    "errors": []
  },
  {
    "id": "03192",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: openstack-cinder-csi-driver-node\n  namespace: openshift-cluster-csi-drivers\n  annotations:\n    config.openshift.io/inject-proxy: csi-driver\nspec:\n  selector:\n    matchLabels:\n      app: openstack-cinder-csi-driver-node\n  template:\n    metadata:\n      labels:\n        app: openstack-cinder-csi-driver-node\n    spec:\n      serviceAccount: openstack-cinder-csi-driver-node-sa\n      containers:\n      - name: csi-driver\n        securityContext:\n          privileged: false\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        image: ${DRIVER_IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        args:\n        - /bin/cinder-csi-plugin\n        - --nodeid=$(NODE_ID)\n        - --endpoint=$(CSI_ENDPOINT)\n        - --cloud-config=$(CLOUD_CONFIG)\n        - --v=${LOG_LEVEL}\n        env:\n        - name: NODE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CSI_ENDPOINT\n          value: unix://csi/csi.sock\n        - name: CLOUD_CONFIG\n          value: /etc/kubernetes/config/cloud.conf\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: HostToContainer\n        - name: pods-probe-dir\n          mountPath: /dev\n          mountPropagation: HostToContainer\n        - name: secret-cinderplugin\n          mountPath: /etc/kubernetes/secret\n          readOnly: true\n        - name: config-cinderplugin\n          mountPath: /etc/kubernetes/config\n          readOnly: true\n        - name: cacert\n          mountPath: /etc/kubernetes/static-pod-resources/configmaps/cloud-config\n        ports:\n        - name: healthz\n          containerPort: 10300\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 10\n          timeoutSeconds: 10\n          periodSeconds: 30\n          failureThreshold: 5\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - name: node-driver-registrar\n        image: ${NODE_DRIVER_REGISTRAR_IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        args:\n        - --v=5\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REG_SOCK_PATH)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REG_SOCK_PATH\n          value: /var/lib/kubelet/plugins/cinder.csi.openstack.org/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n      - name: csi-liveness-probe\n        image: ${LIVENESS_PROBE_IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        args:\n        - --csi-address=/csi/csi.sock\n        - --probe-timeout=10s\n        - --health-port=10300\n        - --v=${LOG_LEVEL}\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: socket-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/cinder.csi.openstack.org\n          type: DirectoryOrCreate\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n      - name: pods-probe-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: secret-cinderplugin\n        secret:\n          secretName: openstack-cloud-credentials\n          items:\n          - key: clouds.yaml\n            path: clouds.yaml\n      - name: config-cinderplugin\n        configMap:\n          name: openstack-cinder-config\n          items:\n          - key: cloud.conf\n            path: cloud.conf\n          - key: multiaz-cloud.conf\n            path: multiaz-cloud.conf\n      - name: cacert\n        configMap:\n          name: cloud-provider-config\n          items:\n          - key: ca-bundle.pem\n            path: ca-bundle.pem\n          optional: true\n",
    "errors": []
  },
  {
    "id": "03193",
    "policy_id": "run_as_non_root",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed: Error from server (BadRequest): error when creating \"STDIN\": DaemonSet in version \"v1\" cannot be handled as a DaemonSet: strict decoding error: unknown field \"spec.template.spec.securityContext.allowPrivilegeEscalation\""
    ]
  },
  {
    "id": "03194",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: openstack-cinder-csi-driver-node\n  namespace: openshift-cluster-csi-drivers\n  annotations:\n    config.openshift.io/inject-proxy: csi-driver\nspec:\n  selector:\n    matchLabels:\n      app: openstack-cinder-csi-driver-node\n  template:\n    metadata:\n      labels:\n        app: openstack-cinder-csi-driver-node\n    spec:\n      serviceAccount: openstack-cinder-csi-driver-node-sa\n      containers:\n      - name: csi-driver\n        securityContext:\n          privileged: false\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        image: ${DRIVER_IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        args:\n        - /bin/cinder-csi-plugin\n        - --nodeid=$(NODE_ID)\n        - --endpoint=$(CSI_ENDPOINT)\n        - --cloud-config=$(CLOUD_CONFIG)\n        - --v=${LOG_LEVEL}\n        env:\n        - name: NODE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CSI_ENDPOINT\n          value: unix://csi/csi.sock\n        - name: CLOUD_CONFIG\n          value: /etc/kubernetes/config/cloud.conf\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: HostToContainer\n        - name: pods-probe-dir\n          mountPath: /dev\n          mountPropagation: HostToContainer\n        - name: secret-cinderplugin\n          mountPath: /etc/kubernetes/secret\n          readOnly: true\n        - name: config-cinderplugin\n          mountPath: /etc/kubernetes/config\n          readOnly: true\n        - name: cacert\n          mountPath: /etc/kubernetes/static-pod-resources/configmaps/cloud-config\n        ports:\n        - name: healthz\n          containerPort: 10300\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 10\n          timeoutSeconds: 10\n          periodSeconds: 30\n          failureThreshold: 5\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - name: node-driver-registrar\n        image: ${NODE_DRIVER_REGISTRAR_IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        args:\n        - --v=5\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REG_SOCK_PATH)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REG_SOCK_PATH\n          value: /var/lib/kubelet/plugins/cinder.csi.openstack.org/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - name: csi-liveness-probe\n        image: ${LIVENESS_PROBE_IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        args:\n        - --csi-address=/csi/csi.sock\n        - --probe-timeout=10s\n        - --health-port=10300\n        - --v=${LOG_LEVEL}\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: socket-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/cinder.csi.openstack.org\n          type: DirectoryOrCreate\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n      - name: pods-probe-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: secret-cinderplugin\n        secret:\n          secretName: openstack-cloud-credentials\n          items:\n          - key: clouds.yaml\n            path: clouds.yaml\n      - name: config-cinderplugin\n        configMap:\n          name: openstack-cinder-config\n          items:\n          - key: cloud.conf\n            path: cloud.conf\n          - key: multiaz-cloud.conf\n            path: multiaz-cloud.conf\n      - name: cacert\n        configMap:\n          name: cloud-provider-config\n          items:\n          - key: ca-bundle.pem\n            path: ca-bundle.pem\n          optional: true\n",
    "errors": []
  },
  {
    "id": "03195",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: openstack-cinder-csi-driver-node\n  namespace: openshift-cluster-csi-drivers\n  annotations:\n    config.openshift.io/inject-proxy: csi-driver\nspec:\n  selector:\n    matchLabels:\n      app: openstack-cinder-csi-driver-node\n  template:\n    metadata:\n      labels:\n        app: openstack-cinder-csi-driver-node\n    spec:\n      serviceAccount: openstack-cinder-csi-driver-node-sa\n      containers:\n      - name: csi-driver\n        securityContext:\n          privileged: false\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        image: ${DRIVER_IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        args:\n        - /bin/cinder-csi-plugin\n        - --nodeid=$(NODE_ID)\n        - --endpoint=$(CSI_ENDPOINT)\n        - --cloud-config=$(CLOUD_CONFIG)\n        - --v=${LOG_LEVEL}\n        env:\n        - name: NODE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CSI_ENDPOINT\n          value: unix://csi/csi.sock\n        - name: CLOUD_CONFIG\n          value: /etc/kubernetes/config/cloud.conf\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: HostToContainer\n        - name: pods-probe-dir\n          mountPath: /dev\n          mountPropagation: HostToContainer\n        - name: secret-cinderplugin\n          mountPath: /etc/kubernetes/secret\n          readOnly: true\n        - name: config-cinderplugin\n          mountPath: /etc/kubernetes/config\n          readOnly: true\n        - name: cacert\n          mountPath: /etc/kubernetes/static-pod-resources/configmaps/cloud-config\n        ports:\n        - name: healthz\n          containerPort: 10300\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 10\n          timeoutSeconds: 10\n          periodSeconds: 30\n          failureThreshold: 5\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - name: node-driver-registrar\n        image: ${NODE_DRIVER_REGISTRAR_IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        args:\n        - --v=5\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REG_SOCK_PATH)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REG_SOCK_PATH\n          value: /var/lib/kubelet/plugins/cinder.csi.openstack.org/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - name: csi-liveness-probe\n        image: ${LIVENESS_PROBE_IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        args:\n        - --csi-address=/csi/csi.sock\n        - --probe-timeout=10s\n        - --health-port=10300\n        - --v=${LOG_LEVEL}\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: socket-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/cinder.csi.openstack.org\n          type: DirectoryOrCreate\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n      - name: pods-probe-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: secret-cinderplugin\n        secret:\n          secretName: openstack-cloud-credentials\n          items:\n          - key: clouds.yaml\n            path: clouds.yaml\n      - name: config-cinderplugin\n        configMap:\n          name: openstack-cinder-config\n          items:\n          - key: cloud.conf\n            path: cloud.conf\n          - key: multiaz-cloud.conf\n            path: multiaz-cloud.conf\n      - name: cacert\n        configMap:\n          name: cloud-provider-config\n          items:\n          - key: ca-bundle.pem\n            path: ca-bundle.pem\n          optional: true\n",
    "errors": []
  },
  {
    "id": "03196",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: openstack-cinder-csi-driver-node\n  namespace: openshift-cluster-csi-drivers\n  annotations:\n    config.openshift.io/inject-proxy: csi-driver\nspec:\n  selector:\n    matchLabels:\n      app: openstack-cinder-csi-driver-node\n  template:\n    metadata:\n      labels:\n        app: openstack-cinder-csi-driver-node\n    spec:\n      serviceAccount: openstack-cinder-csi-driver-node-sa\n      containers:\n      - name: csi-driver\n        securityContext:\n          privileged: false\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        image: ${DRIVER_IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        args:\n        - /bin/cinder-csi-plugin\n        - --nodeid=$(NODE_ID)\n        - --endpoint=$(CSI_ENDPOINT)\n        - --cloud-config=$(CLOUD_CONFIG)\n        - --v=${LOG_LEVEL}\n        env:\n        - name: NODE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CSI_ENDPOINT\n          value: unix://csi/csi.sock\n        - name: CLOUD_CONFIG\n          value: /etc/kubernetes/config/cloud.conf\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: HostToContainer\n        - name: pods-probe-dir\n          mountPath: /dev\n          mountPropagation: HostToContainer\n        - name: secret-cinderplugin\n          mountPath: /etc/kubernetes/secret\n          readOnly: true\n        - name: config-cinderplugin\n          mountPath: /etc/kubernetes/config\n          readOnly: true\n        - name: cacert\n          mountPath: /etc/kubernetes/static-pod-resources/configmaps/cloud-config\n        ports:\n        - name: healthz\n          containerPort: 10300\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 10\n          timeoutSeconds: 10\n          periodSeconds: 30\n          failureThreshold: 5\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - name: node-driver-registrar\n        image: ${NODE_DRIVER_REGISTRAR_IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        args:\n        - --v=5\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REG_SOCK_PATH)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REG_SOCK_PATH\n          value: /var/lib/kubelet/plugins/cinder.csi.openstack.org/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - name: csi-liveness-probe\n        image: ${LIVENESS_PROBE_IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        args:\n        - --csi-address=/csi/csi.sock\n        - --probe-timeout=10s\n        - --health-port=10300\n        - --v=${LOG_LEVEL}\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: socket-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/cinder.csi.openstack.org\n          type: DirectoryOrCreate\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n      - name: pods-probe-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: secret-cinderplugin\n        secret:\n          secretName: openstack-cloud-credentials\n          items:\n          - key: clouds.yaml\n            path: clouds.yaml\n      - name: config-cinderplugin\n        configMap:\n          name: openstack-cinder-config\n          items:\n          - key: cloud.conf\n            path: cloud.conf\n          - key: multiaz-cloud.conf\n            path: multiaz-cloud.conf\n      - name: cacert\n        configMap:\n          name: cloud-provider-config\n          items:\n          - key: ca-bundle.pem\n            path: ca-bundle.pem\n          optional: true\n",
    "errors": []
  },
  {
    "id": "03197",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: hsds-bucket-watch\n  name: hsds-bucket-watch\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: hsds-bucket-watch\n  template:\n    metadata:\n      labels:\n        app: hsds-bucket-watch\n    spec:\n      serviceAccountName: hsds-eks-policy\n      containers:\n      - name: watch\n        image: hdfgroup/bucket_loader:v0.3\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 128M\n            cpu: 100m\n          limits:\n            memory: 256M\n            cpu: 500m\n        volumeMounts:\n        - name: bucket-config\n          mountPath: /config/config.yml\n          subPath: config.yml\n        env:\n        - name: RUN_COMMAND\n          value: watch\n        - name: PASSWORD_FILE\n          valueFrom:\n            secretKeyRef:\n              name: user-password\n              key: password_file\n        - name: HS_USERNAME\n          valueFrom:\n            secretKeyRef:\n              name: hs-loader-keys\n              key: hs_username\n        - name: HS_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: hs-loader-keys\n              key: hs_password\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n      volumes:\n      - name: accounts\n        secret:\n          secretName: user-password\n      - name: bucket-config\n        configMap:\n          name: hsds-bucket-loader-config\n      - name: hsds-config\n        configMap:\n          name: hsds-config\n      - name: hsds-override\n        configMap:\n          name: hsds-override\n",
    "errors": []
  },
  {
    "id": "03198",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: hsds-bucket-watch\n  name: hsds-bucket-watch\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: hsds-bucket-watch\n  template:\n    metadata:\n      labels:\n        app: hsds-bucket-watch\n    spec:\n      serviceAccountName: hsds-eks-policy\n      containers:\n      - name: watch\n        image: hdfgroup/bucket_loader:v0.3\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 128M\n            cpu: 100m\n          limits:\n            memory: 256M\n            cpu: 500m\n        volumeMounts:\n        - name: bucket-config\n          mountPath: /config/config.yml\n          subPath: config.yml\n        env:\n        - name: RUN_COMMAND\n          value: watch\n        - name: PASSWORD_FILE\n          valueFrom:\n            secretKeyRef:\n              name: user-password\n              key: password_file\n        - name: HS_USERNAME\n          valueFrom:\n            secretKeyRef:\n              name: hs-loader-keys\n              key: hs_username\n        - name: HS_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: hs-loader-keys\n              key: hs_password\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: accounts\n        secret:\n          secretName: user-password\n      - name: bucket-config\n        configMap:\n          name: hsds-bucket-loader-config\n      - name: hsds-config\n        configMap:\n          name: hsds-config\n      - name: hsds-override\n        configMap:\n          name: hsds-override\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "03199",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: hsds-bucket-watch\n  name: hsds-bucket-watch\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: hsds-bucket-watch\n  template:\n    metadata:\n      labels:\n        app: hsds-bucket-watch\n    spec:\n      serviceAccountName: hsds-eks-policy\n      containers:\n      - name: watch\n        image: hdfgroup/bucket_loader:v0.3\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 128M\n            cpu: 100m\n          limits:\n            memory: 256M\n            cpu: 500m\n        volumeMounts:\n        - name: bucket-config\n          mountPath: /config/config.yml\n          subPath: config.yml\n        env:\n        - name: RUN_COMMAND\n          value: watch\n        - name: PASSWORD_FILE\n          valueFrom:\n            secretKeyRef:\n              name: user-password\n              key: password_file\n        - name: HS_USERNAME\n          valueFrom:\n            secretKeyRef:\n              name: hs-loader-keys\n              key: hs_username\n        - name: HS_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: hs-loader-keys\n              key: hs_password\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: accounts\n        secret:\n          secretName: user-password\n      - name: bucket-config\n        configMap:\n          name: hsds-bucket-loader-config\n      - name: hsds-config\n        configMap:\n          name: hsds-config\n      - name: hsds-override\n        configMap:\n          name: hsds-override\n",
    "errors": []
  },
  {
    "id": "03200",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: red\n  labels:\n    app: red\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: red\n  template:\n    metadata:\n      labels:\n        app: red\n    spec:\n      containers:\n      - name: red\n        image: nginx:1.19.2\n        volumeMounts:\n        - name: html\n          mountPath: /usr/share/nginx/html\n        resources:\n          requests:\n            cpu: 100m\n            memory: 100Mi\n          limits:\n            cpu: 100m\n            memory: 100Mi\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n      volumes:\n      - name: html\n        configMap:\n          name: red\n          items:\n          - key: body\n            path: index.html\n",
    "errors": []
  }
]