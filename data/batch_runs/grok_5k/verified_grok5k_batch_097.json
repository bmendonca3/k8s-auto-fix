[
  {
    "id": "03881",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: kube-aws-iam-controller\n  namespace: kube-system\n  labels:\n    application: kube-aws-iam-controller\n    version: latest\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      application: kube-aws-iam-controller\n  template:\n    metadata:\n      labels:\n        application: kube-aws-iam-controller\n        version: latest\n    spec:\n      serviceAccountName: kube-aws-iam-controller\n      containers:\n      - name: kube-aws-iam-controller\n        image: registry.opensource.zalan.do/teapot/kube-aws-iam-controller:stable\n        resources:\n          limits:\n            cpu: 25m\n            memory: 100Mi\n          requests:\n            cpu: 25m\n            memory: 100Mi\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "03882",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: kube-aws-iam-controller\n  namespace: kube-system\n  labels:\n    application: kube-aws-iam-controller\n    version: latest\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      application: kube-aws-iam-controller\n  template:\n    metadata:\n      labels:\n        application: kube-aws-iam-controller\n        version: latest\n    spec:\n      serviceAccountName: kube-aws-iam-controller\n      containers:\n      - name: kube-aws-iam-controller\n        image: registry.opensource.zalan.do/teapot/kube-aws-iam-controller:stable\n        resources:\n          limits:\n            cpu: 25m\n            memory: 100Mi\n          requests:\n            cpu: 25m\n            memory: 100Mi\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "03883",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-9766\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    securityContext:\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      privileged: false\n      allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "03884",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-9766\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    securityContext:\n      readOnlyRootFilesystem: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "03885",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-9766\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    securityContext:\n      runAsNonRoot: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "03886",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-9766\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "03887",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-9766\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "03888",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nsc-memif\n  labels:\n    app: nsc-memif\nspec:\n  selector:\n    matchLabels:\n      app: nsc-memif\n  template:\n    metadata:\n      labels:\n        app: nsc-memif\n    spec:\n      containers:\n      - name: nsc\n        image: networkservicemeshci/cmd-nsc-vpp:da4acb28\n        imagePullPolicy: IfNotPresent\n        env:\n        - name: NSM_REQUEST_TIMEOUT\n          value: 1m\n        - name: SPIFFE_ENDPOINT_SOCKET\n          value: unix:///run/spire/sockets/agent.sock\n        - name: NSM_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        volumeMounts:\n        - name: spire-agent-socket\n          mountPath: /run/spire/sockets\n          readOnly: true\n        - name: nsm-socket\n          mountPath: /var/lib/networkservicemesh\n          readOnly: true\n        resources:\n          limits:\n            memory: 400Mi\n            cpu: 500m\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: spire-agent-socket\n        hostPath:\n          path: /run/spire/sockets\n          type: Directory\n      - name: nsm-socket\n        hostPath:\n          path: /var/lib/networkservicemesh\n          type: DirectoryOrCreate\n",
    "errors": []
  },
  {
    "id": "03889",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nsc-memif\n  labels:\n    app: nsc-memif\nspec:\n  selector:\n    matchLabels:\n      app: nsc-memif\n  template:\n    metadata:\n      labels:\n        app: nsc-memif\n    spec:\n      containers:\n      - name: nsc\n        image: networkservicemeshci/cmd-nsc-vpp:da4acb28\n        imagePullPolicy: IfNotPresent\n        env:\n        - name: NSM_REQUEST_TIMEOUT\n          value: 1m\n        - name: SPIFFE_ENDPOINT_SOCKET\n          value: unix:///run/spire/sockets/agent.sock\n        - name: NSM_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        volumeMounts:\n        - name: spire-agent-socket\n          mountPath: /run/spire/sockets\n          readOnly: true\n        - name: nsm-socket\n          mountPath: /var/lib/networkservicemesh\n          readOnly: true\n        resources:\n          limits:\n            memory: 400Mi\n            cpu: 500m\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: spire-agent-socket\n        hostPath:\n          path: /run/spire/sockets\n          type: Directory\n      - name: nsm-socket\n        hostPath:\n          path: /var/lib/networkservicemesh\n          type: DirectoryOrCreate\n",
    "errors": []
  },
  {
    "id": "03890",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nsc-memif\n  labels:\n    app: nsc-memif\nspec:\n  selector:\n    matchLabels:\n      app: nsc-memif\n  template:\n    metadata:\n      labels:\n        app: nsc-memif\n    spec:\n      containers:\n      - name: nsc\n        image: networkservicemeshci/cmd-nsc-vpp:da4acb28\n        imagePullPolicy: IfNotPresent\n        env:\n        - name: NSM_REQUEST_TIMEOUT\n          value: 1m\n        - name: SPIFFE_ENDPOINT_SOCKET\n          value: unix:///run/spire/sockets/agent.sock\n        - name: NSM_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        volumeMounts:\n        - name: spire-agent-socket\n          mountPath: /run/spire/sockets\n          readOnly: true\n        - name: nsm-socket\n          mountPath: /var/lib/networkservicemesh\n          readOnly: true\n        resources:\n          limits:\n            memory: 400Mi\n            cpu: 500m\n          requests:\n            cpu: 100m\n            memory: 128Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: spire-agent-socket\n        hostPath:\n          path: /run/spire/sockets\n          type: Directory\n      - name: nsm-socket\n        hostPath:\n          path: /var/lib/networkservicemesh\n          type: DirectoryOrCreate\n",
    "errors": []
  },
  {
    "id": "03891",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: cadvisor\nspec:\n  replicas: 50\n  selector:\n    app: cadvisor\n  template:\n    metadata:\n      labels:\n        app: cadvisor\n    spec:\n      containers:\n      - name: cadvisor\n        image: google/cadvisor:v0.22.0\n        volumeMounts:\n        - name: rootfs\n          mountPath: /rootfs\n          readOnly: true\n        - name: var-run\n          mountPath: /var/run\n          readOnly: false\n        - name: sys\n          mountPath: /sys\n          readOnly: true\n        - name: docker\n          mountPath: /var/lib/docker\n          readOnly: true\n        ports:\n        - name: http\n          containerPort: 8080\n          protocol: TCP\n        args:\n        - --profiling\n        - --housekeeping_interval=1s\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: rootfs\n        hostPath:\n          path: /\n      - name: var-run\n        hostPath:\n          path: /var/run\n      - name: sys\n        hostPath:\n          path: /sys\n      - name: docker\n        hostPath:\n          path: /var/lib/docker\n",
    "errors": []
  },
  {
    "id": "03892",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: cadvisor\nspec:\n  replicas: 50\n  selector:\n    app: cadvisor\n  template:\n    metadata:\n      labels:\n        app: cadvisor\n    spec:\n      containers:\n      - name: cadvisor\n        image: google/cadvisor:v0.22.0\n        volumeMounts:\n        - name: rootfs\n          mountPath: /rootfs\n          readOnly: true\n        - name: var-run\n          mountPath: /var/run\n          readOnly: false\n        - name: sys\n          mountPath: /sys\n          readOnly: true\n        - name: docker\n          mountPath: /var/lib/docker\n          readOnly: true\n        ports:\n        - name: http\n          containerPort: 8080\n          protocol: TCP\n        args:\n        - --profiling\n        - --housekeeping_interval=1s\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: rootfs\n        hostPath:\n          path: /\n      - name: var-run\n        hostPath:\n          path: /var/run\n      - name: sys\n        hostPath:\n          path: /sys\n      - name: docker\n        hostPath:\n          path: /var/lib/docker\n",
    "errors": []
  },
  {
    "id": "03893",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: cadvisor\nspec:\n  replicas: 50\n  selector:\n    app: cadvisor\n  template:\n    metadata:\n      labels:\n        app: cadvisor\n    spec:\n      containers:\n      - name: cadvisor\n        image: google/cadvisor:v0.22.0\n        volumeMounts:\n        - name: rootfs\n          mountPath: /rootfs\n          readOnly: true\n        - name: var-run\n          mountPath: /var/run\n          readOnly: false\n        - name: sys\n          mountPath: /sys\n          readOnly: true\n        - name: docker\n          mountPath: /var/lib/docker\n          readOnly: true\n        ports:\n        - name: http\n          containerPort: 8080\n          protocol: TCP\n        args:\n        - --profiling\n        - --housekeeping_interval=1s\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: rootfs\n        hostPath:\n          path: /\n      - name: var-run\n        hostPath:\n          path: /var/run\n      - name: sys\n        hostPath:\n          path: /sys\n      - name: docker\n        hostPath:\n          path: /var/lib/docker\n",
    "errors": []
  },
  {
    "id": "03894",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: cadvisor\nspec:\n  replicas: 50\n  selector:\n    app: cadvisor\n  template:\n    metadata:\n      labels:\n        app: cadvisor\n    spec:\n      containers:\n      - name: cadvisor\n        image: google/cadvisor:v0.22.0\n        volumeMounts:\n        - name: rootfs\n          mountPath: /rootfs\n          readOnly: true\n        - name: var-run\n          mountPath: /var/run\n          readOnly: false\n        - name: sys\n          mountPath: /sys\n          readOnly: true\n        - name: docker\n          mountPath: /var/lib/docker\n          readOnly: true\n        ports:\n        - name: http\n          containerPort: 8080\n          protocol: TCP\n        args:\n        - --profiling\n        - --housekeeping_interval=1s\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: rootfs\n        hostPath:\n          path: /\n      - name: var-run\n        hostPath:\n          path: /var/run\n      - name: sys\n        hostPath:\n          path: /sys\n      - name: docker\n        hostPath:\n          path: /var/lib/docker\n",
    "errors": []
  },
  {
    "id": "03895",
    "policy_id": "read_only_root_fs",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "03896",
    "policy_id": "read_only_root_fs",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "03897",
    "policy_id": "no_latest_tag",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": false,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "no containers found in manifest",
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "03898",
    "policy_id": "read_only_root_fs",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": false,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "no containers found in manifest",
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "03899",
    "policy_id": "run_as_non_root",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": false,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "no containers found in manifest",
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "03900",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": false,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "no containers found in manifest",
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "03901",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": false,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "no containers found in manifest",
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "03902",
    "policy_id": "read_only_root_fs",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "03903",
    "policy_id": "run_as_non_root",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "03904",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "03905",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "03906",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: nginx-users-allowed\n  labels:\n    app: nginx-users\nspec:\n  securityContext:\n    supplementalGroups:\n    - 199\n    fsGroup: 199\n  containers:\n  - name: nginx\n    image: nginx:stable\n    securityContext:\n      runAsUser: 199\n      runAsGroup: 199\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      privileged: false\n      allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "03907",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: nginx-users-allowed\n  labels:\n    app: nginx-users\nspec:\n  securityContext:\n    supplementalGroups:\n    - 199\n    fsGroup: 199\n  containers:\n  - name: nginx\n    image: nginx:stable\n    securityContext:\n      runAsUser: 199\n      runAsGroup: 199\n      readOnlyRootFilesystem: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "03908",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: nginx-users-allowed\n  labels:\n    app: nginx-users\nspec:\n  securityContext:\n    supplementalGroups:\n    - 199\n    fsGroup: 199\n  containers:\n  - name: nginx\n    image: nginx:stable\n    securityContext:\n      runAsUser: 199\n      runAsGroup: 199\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "03909",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: nginx-users-allowed\n  labels:\n    app: nginx-users\nspec:\n  securityContext:\n    supplementalGroups:\n    - 199\n    fsGroup: 199\n  containers:\n  - name: nginx\n    image: nginx:stable\n    securityContext:\n      runAsUser: 199\n      runAsGroup: 199\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "03910",
    "policy_id": "read_only_root_fs",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "03911",
    "policy_id": "run_as_non_root",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "03912",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "03913",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "03914",
    "policy_id": "env_var_secret",
    "accepted": false,
    "ok_schema": true,
    "ok_policy": false,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "environment variable SECRETS_secret_key must use secretKeyRef"
    ]
  },
  {
    "id": "03915",
    "policy_id": "env_var_secret",
    "accepted": false,
    "ok_schema": true,
    "ok_policy": false,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "environment variable SECRETS_secret_key must use secretKeyRef"
    ]
  },
  {
    "id": "03916",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: zulip-1\n  labels:\n    version: 1.8.0-2\n    app: zulip\nspec:\n  replicas: 1\n  selector:\n    version: 1.8.0-2\n    app: zulip\n  template:\n    metadata:\n      labels:\n        version: 1.8.0-2\n        app: zulip\n    spec:\n      containers:\n      - name: redis\n        image: quay.io/sameersbn/redis:stable\n        resources:\n          limits:\n            cpu: 50m\n        volumeMounts:\n        - name: redis-persistent-storage\n          mountPath: /var/lib/redis\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n      - name: memcached\n        image: quay.io/sameersbn/memcached:stable\n        resources:\n          limits:\n            cpu: 75m\n            memory: 768Mi\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n      - name: rabbitmq\n        image: rabbitmq:3.5.5\n        resources:\n          limits:\n            cpu: 75m\n            memory: 768Mi\n        env:\n        - name: RABBITMQ_DEFAULT_USER\n          value: zulip\n        - name: RABBITMQ_DEFAULT_PASS\n          value: zulip\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n      - name: postgresql\n        image: quay.io/galexrt/zulip-postgresql-tsearchextras:stable\n        resources:\n          limits:\n            cpu: 80m\n            memory: 768Mi\n        env:\n        - name: DB_NAME\n          value: zulip\n        - name: DB_USER\n          value: zulip\n        - name: DB_PASS\n          value: zulip\n        volumeMounts:\n        - name: postgresql-persistent-storage\n          mountPath: /var/lib/postgresql\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n      - name: zulip\n        image: quay.io/galexrt/zulip:1.8.0-2\n        resources:\n          limits:\n            cpu: 100m\n            memory: 3584Mi\n        env:\n        - name: DB_HOST\n          value: database\n        - name: MEMCACHED_HOST\n          value: memcached\n        - name: REDIS_HOST\n          value: redis\n        - name: RABBITMQ_HOST\n          value: rabbitmq\n        - name: ZULIP_AUTH_BACKENDS\n          value: EmailAuthBackend\n        - name: SECRETS_email_password\n          value: '123456789'\n        - name: SETTING_EXTERNAL_HOST\n          value: localhost\n        - name: SETTING_ZULIP_ADMINISTRATOR\n          value: admin@example.com\n        - name: SETTING_ADMIN_DOMAIN\n          value: zerbytes.net\n        - name: SETTING_NOREPLY_EMAIL_ADDRESS\n          value: noreply@example.com\n        - name: SETTING_DEFAULT_FROM_EMAIL\n          value: Zulip <noreply@example.com>\n        - name: SETTING_EMAIL_HOST\n          value: smtp.example.com\n        - name: SETTING_EMAIL_HOST_USER\n          value: noreply@example.com\n        - name: ZULIP_USER_EMAIL\n          value: example@example.com\n        - name: ZULIP_USER_DOMAIN\n          value: example.com\n        - name: ZULIP_USER_PASS\n          value: '123456789'\n        - name: SECRETS_secret_key\n          value: REPLCAE_WITH_SECURE_SECRET_KEY\n        ports:\n        - containerPort: 80\n          name: http\n          protocol: TCP\n        - containerPort: 443\n          name: https\n          protocol: TCP\n        volumeMounts:\n        - name: zulip-persistent-storage\n          mountPath: /data\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: redis-persistent-storage\n        hostPath:\n          path: /opt/docker/zulip/redis\n      - name: postgresql-persistent-storage\n        hostPath:\n          path: /opt/docker/zulip/postgresql\n      - name: zulip-persistent-storage\n        hostPath:\n          path: /opt/docker/zulip/zulip\n",
    "errors": []
  },
  {
    "id": "03917",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: zulip-1\n  labels:\n    version: 1.8.0-2\n    app: zulip\nspec:\n  replicas: 1\n  selector:\n    version: 1.8.0-2\n    app: zulip\n  template:\n    metadata:\n      labels:\n        version: 1.8.0-2\n        app: zulip\n    spec:\n      containers:\n      - name: redis\n        image: quay.io/sameersbn/redis:stable\n        resources:\n          limits:\n            cpu: 50m\n        volumeMounts:\n        - name: redis-persistent-storage\n          mountPath: /var/lib/redis\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n      - name: memcached\n        image: quay.io/sameersbn/memcached:stable\n        resources:\n          limits:\n            cpu: 75m\n            memory: 768Mi\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n      - name: rabbitmq\n        image: rabbitmq:3.5.5\n        resources:\n          limits:\n            cpu: 75m\n            memory: 768Mi\n        env:\n        - name: RABBITMQ_DEFAULT_USER\n          value: zulip\n        - name: RABBITMQ_DEFAULT_PASS\n          value: zulip\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n      - name: postgresql\n        image: quay.io/galexrt/zulip-postgresql-tsearchextras:stable\n        resources:\n          limits:\n            cpu: 80m\n            memory: 768Mi\n        env:\n        - name: DB_NAME\n          value: zulip\n        - name: DB_USER\n          value: zulip\n        - name: DB_PASS\n          value: zulip\n        volumeMounts:\n        - name: postgresql-persistent-storage\n          mountPath: /var/lib/postgresql\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n      - name: zulip\n        image: quay.io/galexrt/zulip:1.8.0-2\n        resources:\n          limits:\n            cpu: 100m\n            memory: 3584Mi\n        env:\n        - name: DB_HOST\n          value: database\n        - name: MEMCACHED_HOST\n          value: memcached\n        - name: REDIS_HOST\n          value: redis\n        - name: RABBITMQ_HOST\n          value: rabbitmq\n        - name: ZULIP_AUTH_BACKENDS\n          value: EmailAuthBackend\n        - name: SECRETS_email_password\n          value: '123456789'\n        - name: SETTING_EXTERNAL_HOST\n          value: localhost\n        - name: SETTING_ZULIP_ADMINISTRATOR\n          value: admin@example.com\n        - name: SETTING_ADMIN_DOMAIN\n          value: zerbytes.net\n        - name: SETTING_NOREPLY_EMAIL_ADDRESS\n          value: noreply@example.com\n        - name: SETTING_DEFAULT_FROM_EMAIL\n          value: Zulip <noreply@example.com>\n        - name: SETTING_EMAIL_HOST\n          value: smtp.example.com\n        - name: SETTING_EMAIL_HOST_USER\n          value: noreply@example.com\n        - name: ZULIP_USER_EMAIL\n          value: example@example.com\n        - name: ZULIP_USER_DOMAIN\n          value: example.com\n        - name: ZULIP_USER_PASS\n          value: '123456789'\n        - name: SECRETS_secret_key\n          value: REPLCAE_WITH_SECURE_SECRET_KEY\n        ports:\n        - containerPort: 80\n          name: http\n          protocol: TCP\n        - containerPort: 443\n          name: https\n          protocol: TCP\n        volumeMounts:\n        - name: zulip-persistent-storage\n          mountPath: /data\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: redis-persistent-storage\n        hostPath:\n          path: /opt/docker/zulip/redis\n      - name: postgresql-persistent-storage\n        hostPath:\n          path: /opt/docker/zulip/postgresql\n      - name: zulip-persistent-storage\n        hostPath:\n          path: /opt/docker/zulip/zulip\n",
    "errors": []
  },
  {
    "id": "03918",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: zulip-1\n  labels:\n    version: 1.8.0-2\n    app: zulip\nspec:\n  replicas: 1\n  selector:\n    version: 1.8.0-2\n    app: zulip\n  template:\n    metadata:\n      labels:\n        version: 1.8.0-2\n        app: zulip\n    spec:\n      containers:\n      - name: redis\n        image: quay.io/sameersbn/redis:stable\n        resources:\n          limits:\n            cpu: 50m\n        volumeMounts:\n        - name: redis-persistent-storage\n          mountPath: /var/lib/redis\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n      - name: memcached\n        image: quay.io/sameersbn/memcached:stable\n        resources:\n          limits:\n            cpu: 75m\n            memory: 768Mi\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n      - name: rabbitmq\n        image: rabbitmq:3.5.5\n        resources:\n          limits:\n            cpu: 75m\n            memory: 768Mi\n        env:\n        - name: RABBITMQ_DEFAULT_USER\n          value: zulip\n        - name: RABBITMQ_DEFAULT_PASS\n          value: zulip\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n      - name: postgresql\n        image: quay.io/galexrt/zulip-postgresql-tsearchextras:stable\n        resources:\n          limits:\n            cpu: 80m\n            memory: 768Mi\n        env:\n        - name: DB_NAME\n          value: zulip\n        - name: DB_USER\n          value: zulip\n        - name: DB_PASS\n          value: zulip\n        volumeMounts:\n        - name: postgresql-persistent-storage\n          mountPath: /var/lib/postgresql\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n      - name: zulip\n        image: quay.io/galexrt/zulip:1.8.0-2\n        resources:\n          limits:\n            cpu: 100m\n            memory: 3584Mi\n        env:\n        - name: DB_HOST\n          value: database\n        - name: MEMCACHED_HOST\n          value: memcached\n        - name: REDIS_HOST\n          value: redis\n        - name: RABBITMQ_HOST\n          value: rabbitmq\n        - name: ZULIP_AUTH_BACKENDS\n          value: EmailAuthBackend\n        - name: SECRETS_email_password\n          value: '123456789'\n        - name: SETTING_EXTERNAL_HOST\n          value: localhost\n        - name: SETTING_ZULIP_ADMINISTRATOR\n          value: admin@example.com\n        - name: SETTING_ADMIN_DOMAIN\n          value: zerbytes.net\n        - name: SETTING_NOREPLY_EMAIL_ADDRESS\n          value: noreply@example.com\n        - name: SETTING_DEFAULT_FROM_EMAIL\n          value: Zulip <noreply@example.com>\n        - name: SETTING_EMAIL_HOST\n          value: smtp.example.com\n        - name: SETTING_EMAIL_HOST_USER\n          value: noreply@example.com\n        - name: ZULIP_USER_EMAIL\n          value: example@example.com\n        - name: ZULIP_USER_DOMAIN\n          value: example.com\n        - name: ZULIP_USER_PASS\n          value: '123456789'\n        - name: SECRETS_secret_key\n          value: REPLCAE_WITH_SECURE_SECRET_KEY\n        ports:\n        - containerPort: 80\n          name: http\n          protocol: TCP\n        - containerPort: 443\n          name: https\n          protocol: TCP\n        volumeMounts:\n        - name: zulip-persistent-storage\n          mountPath: /data\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: redis-persistent-storage\n        hostPath:\n          path: /opt/docker/zulip/redis\n      - name: postgresql-persistent-storage\n        hostPath:\n          path: /opt/docker/zulip/postgresql\n      - name: zulip-persistent-storage\n        hostPath:\n          path: /opt/docker/zulip/zulip\n",
    "errors": []
  },
  {
    "id": "03919",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: zulip-1\n  labels:\n    version: 1.8.0-2\n    app: zulip\nspec:\n  replicas: 1\n  selector:\n    version: 1.8.0-2\n    app: zulip\n  template:\n    metadata:\n      labels:\n        version: 1.8.0-2\n        app: zulip\n    spec:\n      containers:\n      - name: redis\n        image: quay.io/sameersbn/redis:stable\n        resources:\n          limits:\n            cpu: 50m\n        volumeMounts:\n        - name: redis-persistent-storage\n          mountPath: /var/lib/redis\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: memcached\n        image: quay.io/sameersbn/memcached:stable\n        resources:\n          limits:\n            cpu: 75m\n            memory: 768Mi\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: rabbitmq\n        image: rabbitmq:3.5.5\n        resources:\n          limits:\n            cpu: 75m\n            memory: 768Mi\n        env:\n        - name: RABBITMQ_DEFAULT_USER\n          value: zulip\n        - name: RABBITMQ_DEFAULT_PASS\n          value: zulip\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: postgresql\n        image: quay.io/galexrt/zulip-postgresql-tsearchextras:stable\n        resources:\n          limits:\n            cpu: 80m\n            memory: 768Mi\n        env:\n        - name: DB_NAME\n          value: zulip\n        - name: DB_USER\n          value: zulip\n        - name: DB_PASS\n          value: zulip\n        volumeMounts:\n        - name: postgresql-persistent-storage\n          mountPath: /var/lib/postgresql\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: zulip\n        image: quay.io/galexrt/zulip:1.8.0-2\n        resources:\n          limits:\n            cpu: 100m\n            memory: 3584Mi\n        env:\n        - name: DB_HOST\n          value: database\n        - name: MEMCACHED_HOST\n          value: memcached\n        - name: REDIS_HOST\n          value: redis\n        - name: RABBITMQ_HOST\n          value: rabbitmq\n        - name: ZULIP_AUTH_BACKENDS\n          value: EmailAuthBackend\n        - name: SECRETS_email_password\n          value: '123456789'\n        - name: SETTING_EXTERNAL_HOST\n          value: localhost\n        - name: SETTING_ZULIP_ADMINISTRATOR\n          value: admin@example.com\n        - name: SETTING_ADMIN_DOMAIN\n          value: zerbytes.net\n        - name: SETTING_NOREPLY_EMAIL_ADDRESS\n          value: noreply@example.com\n        - name: SETTING_DEFAULT_FROM_EMAIL\n          value: Zulip <noreply@example.com>\n        - name: SETTING_EMAIL_HOST\n          value: smtp.example.com\n        - name: SETTING_EMAIL_HOST_USER\n          value: noreply@example.com\n        - name: ZULIP_USER_EMAIL\n          value: example@example.com\n        - name: ZULIP_USER_DOMAIN\n          value: example.com\n        - name: ZULIP_USER_PASS\n          value: '123456789'\n        - name: SECRETS_secret_key\n          value: REPLCAE_WITH_SECURE_SECRET_KEY\n        ports:\n        - containerPort: 80\n          name: http\n          protocol: TCP\n        - containerPort: 443\n          name: https\n          protocol: TCP\n        volumeMounts:\n        - name: zulip-persistent-storage\n          mountPath: /data\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: redis-persistent-storage\n        hostPath:\n          path: /opt/docker/zulip/redis\n      - name: postgresql-persistent-storage\n        hostPath:\n          path: /opt/docker/zulip/postgresql\n      - name: zulip-persistent-storage\n        hostPath:\n          path: /opt/docker/zulip/zulip\n",
    "errors": []
  },
  {
    "id": "03920",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: zulip-1\n  labels:\n    version: 1.8.0-2\n    app: zulip\nspec:\n  replicas: 1\n  selector:\n    version: 1.8.0-2\n    app: zulip\n  template:\n    metadata:\n      labels:\n        version: 1.8.0-2\n        app: zulip\n    spec:\n      containers:\n      - name: redis\n        image: quay.io/sameersbn/redis:stable\n        resources:\n          limits:\n            cpu: 50m\n        volumeMounts:\n        - name: redis-persistent-storage\n          mountPath: /var/lib/redis\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: memcached\n        image: quay.io/sameersbn/memcached:stable\n        resources:\n          limits:\n            cpu: 75m\n            memory: 768Mi\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: rabbitmq\n        image: rabbitmq:3.5.5\n        resources:\n          limits:\n            cpu: 75m\n            memory: 768Mi\n        env:\n        - name: RABBITMQ_DEFAULT_USER\n          value: zulip\n        - name: RABBITMQ_DEFAULT_PASS\n          value: zulip\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: postgresql\n        image: quay.io/galexrt/zulip-postgresql-tsearchextras:stable\n        resources:\n          limits:\n            cpu: 80m\n            memory: 768Mi\n        env:\n        - name: DB_NAME\n          value: zulip\n        - name: DB_USER\n          value: zulip\n        - name: DB_PASS\n          value: zulip\n        volumeMounts:\n        - name: postgresql-persistent-storage\n          mountPath: /var/lib/postgresql\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: zulip\n        image: quay.io/galexrt/zulip:1.8.0-2\n        resources:\n          limits:\n            cpu: 100m\n            memory: 3584Mi\n        env:\n        - name: DB_HOST\n          value: database\n        - name: MEMCACHED_HOST\n          value: memcached\n        - name: REDIS_HOST\n          value: redis\n        - name: RABBITMQ_HOST\n          value: rabbitmq\n        - name: ZULIP_AUTH_BACKENDS\n          value: EmailAuthBackend\n        - name: SECRETS_email_password\n          value: '123456789'\n        - name: SETTING_EXTERNAL_HOST\n          value: localhost\n        - name: SETTING_ZULIP_ADMINISTRATOR\n          value: admin@example.com\n        - name: SETTING_ADMIN_DOMAIN\n          value: zerbytes.net\n        - name: SETTING_NOREPLY_EMAIL_ADDRESS\n          value: noreply@example.com\n        - name: SETTING_DEFAULT_FROM_EMAIL\n          value: Zulip <noreply@example.com>\n        - name: SETTING_EMAIL_HOST\n          value: smtp.example.com\n        - name: SETTING_EMAIL_HOST_USER\n          value: noreply@example.com\n        - name: ZULIP_USER_EMAIL\n          value: example@example.com\n        - name: ZULIP_USER_DOMAIN\n          value: example.com\n        - name: ZULIP_USER_PASS\n          value: '123456789'\n        - name: SECRETS_secret_key\n          value: REPLCAE_WITH_SECURE_SECRET_KEY\n        ports:\n        - containerPort: 80\n          name: http\n          protocol: TCP\n        - containerPort: 443\n          name: https\n          protocol: TCP\n        volumeMounts:\n        - name: zulip-persistent-storage\n          mountPath: /data\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: redis-persistent-storage\n        hostPath:\n          path: /opt/docker/zulip/redis\n      - name: postgresql-persistent-storage\n        hostPath:\n          path: /opt/docker/zulip/postgresql\n      - name: zulip-persistent-storage\n        hostPath:\n          path: /opt/docker/zulip/zulip\n",
    "errors": []
  }
]