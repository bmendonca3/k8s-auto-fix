[
  {
    "id": "02681",
    "manifest_path": "data/manifests/the_stack_sample/sample_1092.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: tool-wrk\n  labels:\n    app: tool-wrk\n    rel: dev\nspec:\n  containers:\n  - name: wrk\n    image: williamyeh/wrk\n    command:\n    - /bin/sh\n    - -c\n    - --\n    args:\n    - while :; do sleep 365d; done\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"wrk\" is using an invalid container image, \"williamyeh/wrk\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02682",
    "manifest_path": "data/manifests/the_stack_sample/sample_1092.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: tool-wrk\n  labels:\n    app: tool-wrk\n    rel: dev\nspec:\n  containers:\n  - name: wrk\n    image: williamyeh/wrk\n    command:\n    - /bin/sh\n    - -c\n    - --\n    args:\n    - while :; do sleep 365d; done\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"wrk\" does not have a read-only root file system"
  },
  {
    "id": "02683",
    "manifest_path": "data/manifests/the_stack_sample/sample_1092.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: tool-wrk\n  labels:\n    app: tool-wrk\n    rel: dev\nspec:\n  containers:\n  - name: wrk\n    image: williamyeh/wrk\n    command:\n    - /bin/sh\n    - -c\n    - --\n    args:\n    - while :; do sleep 365d; done\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"wrk\" is not set to runAsNonRoot"
  },
  {
    "id": "02684",
    "manifest_path": "data/manifests/the_stack_sample/sample_1092.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: tool-wrk\n  labels:\n    app: tool-wrk\n    rel: dev\nspec:\n  containers:\n  - name: wrk\n    image: williamyeh/wrk\n    command:\n    - /bin/sh\n    - -c\n    - --\n    args:\n    - while :; do sleep 365d; done\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"wrk\" has cpu request 0"
  },
  {
    "id": "02685",
    "manifest_path": "data/manifests/the_stack_sample/sample_1092.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: tool-wrk\n  labels:\n    app: tool-wrk\n    rel: dev\nspec:\n  containers:\n  - name: wrk\n    image: williamyeh/wrk\n    command:\n    - /bin/sh\n    - -c\n    - --\n    args:\n    - while :; do sleep 365d; done\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"wrk\" has memory limit 0"
  },
  {
    "id": "02686",
    "manifest_path": "data/manifests/the_stack_sample/sample_1095.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: jenkins\n  labels:\n    app: jenkins\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: jenkins\n  template:\n    metadata:\n      labels:\n        app: jenkins\n    spec:\n      volumes:\n      - name: dind-storage\n        emptyDir: {}\n      containers:\n      - name: jenkins\n        image: andreamendoza/modified-jenkins:latest\n        ports:\n        - containerPort: 8080\n        - containerPort: 50000\n        env:\n        - name: DOCKER_HOST\n          value: tcp://localhost:2375\n      - name: dind\n        image: docker:18.05-dind\n        securityContext:\n          privileged: true\n        volumeMounts:\n        - name: dind-storage\n          mountPath: /var/lib/docker\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"jenkins\" is using an invalid container image, \"andreamendoza/modified-jenkins:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02687",
    "manifest_path": "data/manifests/the_stack_sample/sample_1095.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: jenkins\n  labels:\n    app: jenkins\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: jenkins\n  template:\n    metadata:\n      labels:\n        app: jenkins\n    spec:\n      volumes:\n      - name: dind-storage\n        emptyDir: {}\n      containers:\n      - name: jenkins\n        image: andreamendoza/modified-jenkins:latest\n        ports:\n        - containerPort: 8080\n        - containerPort: 50000\n        env:\n        - name: DOCKER_HOST\n          value: tcp://localhost:2375\n      - name: dind\n        image: docker:18.05-dind\n        securityContext:\n          privileged: true\n        volumeMounts:\n        - name: dind-storage\n          mountPath: /var/lib/docker\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"dind\" does not have a read-only root file system"
  },
  {
    "id": "02688",
    "manifest_path": "data/manifests/the_stack_sample/sample_1095.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: jenkins\n  labels:\n    app: jenkins\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: jenkins\n  template:\n    metadata:\n      labels:\n        app: jenkins\n    spec:\n      volumes:\n      - name: dind-storage\n        emptyDir: {}\n      containers:\n      - name: jenkins\n        image: andreamendoza/modified-jenkins:latest\n        ports:\n        - containerPort: 8080\n        - containerPort: 50000\n        env:\n        - name: DOCKER_HOST\n          value: tcp://localhost:2375\n      - name: dind\n        image: docker:18.05-dind\n        securityContext:\n          privileged: true\n        volumeMounts:\n        - name: dind-storage\n          mountPath: /var/lib/docker\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"jenkins\" does not have a read-only root file system"
  },
  {
    "id": "02689",
    "manifest_path": "data/manifests/the_stack_sample/sample_1095.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: jenkins\n  labels:\n    app: jenkins\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: jenkins\n  template:\n    metadata:\n      labels:\n        app: jenkins\n    spec:\n      volumes:\n      - name: dind-storage\n        emptyDir: {}\n      containers:\n      - name: jenkins\n        image: andreamendoza/modified-jenkins:latest\n        ports:\n        - containerPort: 8080\n        - containerPort: 50000\n        env:\n        - name: DOCKER_HOST\n          value: tcp://localhost:2375\n      - name: dind\n        image: docker:18.05-dind\n        securityContext:\n          privileged: true\n        volumeMounts:\n        - name: dind-storage\n          mountPath: /var/lib/docker\n",
    "policy_id": "privilege-escalation-container",
    "violation_text": "container \"dind\" is Privileged hence allows privilege escalation."
  },
  {
    "id": "02690",
    "manifest_path": "data/manifests/the_stack_sample/sample_1095.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: jenkins\n  labels:\n    app: jenkins\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: jenkins\n  template:\n    metadata:\n      labels:\n        app: jenkins\n    spec:\n      volumes:\n      - name: dind-storage\n        emptyDir: {}\n      containers:\n      - name: jenkins\n        image: andreamendoza/modified-jenkins:latest\n        ports:\n        - containerPort: 8080\n        - containerPort: 50000\n        env:\n        - name: DOCKER_HOST\n          value: tcp://localhost:2375\n      - name: dind\n        image: docker:18.05-dind\n        securityContext:\n          privileged: true\n        volumeMounts:\n        - name: dind-storage\n          mountPath: /var/lib/docker\n",
    "policy_id": "privileged-container",
    "violation_text": "container \"dind\" is privileged"
  },
  {
    "id": "02691",
    "manifest_path": "data/manifests/the_stack_sample/sample_1095.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: jenkins\n  labels:\n    app: jenkins\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: jenkins\n  template:\n    metadata:\n      labels:\n        app: jenkins\n    spec:\n      volumes:\n      - name: dind-storage\n        emptyDir: {}\n      containers:\n      - name: jenkins\n        image: andreamendoza/modified-jenkins:latest\n        ports:\n        - containerPort: 8080\n        - containerPort: 50000\n        env:\n        - name: DOCKER_HOST\n          value: tcp://localhost:2375\n      - name: dind\n        image: docker:18.05-dind\n        securityContext:\n          privileged: true\n        volumeMounts:\n        - name: dind-storage\n          mountPath: /var/lib/docker\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"dind\" is not set to runAsNonRoot"
  },
  {
    "id": "02692",
    "manifest_path": "data/manifests/the_stack_sample/sample_1095.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: jenkins\n  labels:\n    app: jenkins\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: jenkins\n  template:\n    metadata:\n      labels:\n        app: jenkins\n    spec:\n      volumes:\n      - name: dind-storage\n        emptyDir: {}\n      containers:\n      - name: jenkins\n        image: andreamendoza/modified-jenkins:latest\n        ports:\n        - containerPort: 8080\n        - containerPort: 50000\n        env:\n        - name: DOCKER_HOST\n          value: tcp://localhost:2375\n      - name: dind\n        image: docker:18.05-dind\n        securityContext:\n          privileged: true\n        volumeMounts:\n        - name: dind-storage\n          mountPath: /var/lib/docker\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"jenkins\" is not set to runAsNonRoot"
  },
  {
    "id": "02693",
    "manifest_path": "data/manifests/the_stack_sample/sample_1095.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: jenkins\n  labels:\n    app: jenkins\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: jenkins\n  template:\n    metadata:\n      labels:\n        app: jenkins\n    spec:\n      volumes:\n      - name: dind-storage\n        emptyDir: {}\n      containers:\n      - name: jenkins\n        image: andreamendoza/modified-jenkins:latest\n        ports:\n        - containerPort: 8080\n        - containerPort: 50000\n        env:\n        - name: DOCKER_HOST\n          value: tcp://localhost:2375\n      - name: dind\n        image: docker:18.05-dind\n        securityContext:\n          privileged: true\n        volumeMounts:\n        - name: dind-storage\n          mountPath: /var/lib/docker\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"dind\" has cpu request 0"
  },
  {
    "id": "02694",
    "manifest_path": "data/manifests/the_stack_sample/sample_1095.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: jenkins\n  labels:\n    app: jenkins\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: jenkins\n  template:\n    metadata:\n      labels:\n        app: jenkins\n    spec:\n      volumes:\n      - name: dind-storage\n        emptyDir: {}\n      containers:\n      - name: jenkins\n        image: andreamendoza/modified-jenkins:latest\n        ports:\n        - containerPort: 8080\n        - containerPort: 50000\n        env:\n        - name: DOCKER_HOST\n          value: tcp://localhost:2375\n      - name: dind\n        image: docker:18.05-dind\n        securityContext:\n          privileged: true\n        volumeMounts:\n        - name: dind-storage\n          mountPath: /var/lib/docker\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"jenkins\" has cpu request 0"
  },
  {
    "id": "02695",
    "manifest_path": "data/manifests/the_stack_sample/sample_1095.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: jenkins\n  labels:\n    app: jenkins\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: jenkins\n  template:\n    metadata:\n      labels:\n        app: jenkins\n    spec:\n      volumes:\n      - name: dind-storage\n        emptyDir: {}\n      containers:\n      - name: jenkins\n        image: andreamendoza/modified-jenkins:latest\n        ports:\n        - containerPort: 8080\n        - containerPort: 50000\n        env:\n        - name: DOCKER_HOST\n          value: tcp://localhost:2375\n      - name: dind\n        image: docker:18.05-dind\n        securityContext:\n          privileged: true\n        volumeMounts:\n        - name: dind-storage\n          mountPath: /var/lib/docker\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"dind\" has memory limit 0"
  },
  {
    "id": "02696",
    "manifest_path": "data/manifests/the_stack_sample/sample_1095.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: jenkins\n  labels:\n    app: jenkins\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: jenkins\n  template:\n    metadata:\n      labels:\n        app: jenkins\n    spec:\n      volumes:\n      - name: dind-storage\n        emptyDir: {}\n      containers:\n      - name: jenkins\n        image: andreamendoza/modified-jenkins:latest\n        ports:\n        - containerPort: 8080\n        - containerPort: 50000\n        env:\n        - name: DOCKER_HOST\n          value: tcp://localhost:2375\n      - name: dind\n        image: docker:18.05-dind\n        securityContext:\n          privileged: true\n        volumeMounts:\n        - name: dind-storage\n          mountPath: /var/lib/docker\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"jenkins\" has memory limit 0"
  },
  {
    "id": "02697",
    "manifest_path": "data/manifests/the_stack_sample/sample_1097.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: canary-demo\n  labels:\n    app: canary-demo\nspec:\n  selector:\n    matchLabels:\n      app: canary-demo\n  template:\n    metadata:\n      labels:\n        app: canary-demo\n    spec:\n      containers:\n      - name: container\n        image: canary-demo:1\n        imagePullPolicy: Never\n        ports:\n        - containerPort: 8080\n        resources:\n          limits:\n            memory: 128M\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"container\" does not have a read-only root file system"
  },
  {
    "id": "02698",
    "manifest_path": "data/manifests/the_stack_sample/sample_1097.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: canary-demo\n  labels:\n    app: canary-demo\nspec:\n  selector:\n    matchLabels:\n      app: canary-demo\n  template:\n    metadata:\n      labels:\n        app: canary-demo\n    spec:\n      containers:\n      - name: container\n        image: canary-demo:1\n        imagePullPolicy: Never\n        ports:\n        - containerPort: 8080\n        resources:\n          limits:\n            memory: 128M\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"container\" is not set to runAsNonRoot"
  },
  {
    "id": "02699",
    "manifest_path": "data/manifests/the_stack_sample/sample_1097.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: canary-demo\n  labels:\n    app: canary-demo\nspec:\n  selector:\n    matchLabels:\n      app: canary-demo\n  template:\n    metadata:\n      labels:\n        app: canary-demo\n    spec:\n      containers:\n      - name: container\n        image: canary-demo:1\n        imagePullPolicy: Never\n        ports:\n        - containerPort: 8080\n        resources:\n          limits:\n            memory: 128M\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"container\" has cpu request 0"
  },
  {
    "id": "02700",
    "manifest_path": "data/manifests/the_stack_sample/sample_1098.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: cronjob\nspec:\n  template:\n    spec:\n      serviceAccount: k8sland\n      containers:\n      - name: lab\n        image: k8sland/verifier:v1.2.1\n        imagePullPolicy: IfNotPresent\n        command:\n        - /bin/verifier\n        - --u=fernand\n        - --l=cronjob\n        - --s\n        volumeMounts:\n        - mountPath: /assets\n          name: assets\n      volumes:\n      - name: assets\n        secret:\n          secretName: cronjob\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"lab\" does not have a read-only root file system"
  },
  {
    "id": "02701",
    "manifest_path": "data/manifests/the_stack_sample/sample_1098.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: cronjob\nspec:\n  template:\n    spec:\n      serviceAccount: k8sland\n      containers:\n      - name: lab\n        image: k8sland/verifier:v1.2.1\n        imagePullPolicy: IfNotPresent\n        command:\n        - /bin/verifier\n        - --u=fernand\n        - --l=cronjob\n        - --s\n        volumeMounts:\n        - mountPath: /assets\n          name: assets\n      volumes:\n      - name: assets\n        secret:\n          secretName: cronjob\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"lab\" is not set to runAsNonRoot"
  },
  {
    "id": "02702",
    "manifest_path": "data/manifests/the_stack_sample/sample_1098.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: cronjob\nspec:\n  template:\n    spec:\n      serviceAccount: k8sland\n      containers:\n      - name: lab\n        image: k8sland/verifier:v1.2.1\n        imagePullPolicy: IfNotPresent\n        command:\n        - /bin/verifier\n        - --u=fernand\n        - --l=cronjob\n        - --s\n        volumeMounts:\n        - mountPath: /assets\n          name: assets\n      volumes:\n      - name: assets\n        secret:\n          secretName: cronjob\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"lab\" has cpu request 0"
  },
  {
    "id": "02703",
    "manifest_path": "data/manifests/the_stack_sample/sample_1098.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: cronjob\nspec:\n  template:\n    spec:\n      serviceAccount: k8sland\n      containers:\n      - name: lab\n        image: k8sland/verifier:v1.2.1\n        imagePullPolicy: IfNotPresent\n        command:\n        - /bin/verifier\n        - --u=fernand\n        - --l=cronjob\n        - --s\n        volumeMounts:\n        - mountPath: /assets\n          name: assets\n      volumes:\n      - name: assets\n        secret:\n          secretName: cronjob\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"lab\" has memory limit 0"
  },
  {
    "id": "02704",
    "manifest_path": "data/manifests/the_stack_sample/sample_1100.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: swe-app-api\n  namespace: swe\nspec:\n  selector:\n    matchLabels:\n      app: swe-app-api\n  replicas: 2\n  template:\n    metadata:\n      labels:\n        app: swe-app-api\n    spec:\n      containers:\n      - image: datadaddy/swe-api-k8s:0.1\n        imagePullPolicy: Always\n        name: swe-app-api\n        env:\n        - name: POSTGRES_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: postgres-db-password\n              key: password\n        - name: POSTGRES_DB_URL\n          value: jdbc:postgresql://postgres.swe.svc.cluster.local:5432/postgres\n        resources:\n          requests:\n            memory: 64Mi\n            cpu: 250m\n          limits:\n            memory: 750Mi\n            cpu: 500m\n        ports:\n        - containerPort: 3000\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"swe-app-api\" does not have a read-only root file system"
  },
  {
    "id": "02705",
    "manifest_path": "data/manifests/the_stack_sample/sample_1100.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: swe-app-api\n  namespace: swe\nspec:\n  selector:\n    matchLabels:\n      app: swe-app-api\n  replicas: 2\n  template:\n    metadata:\n      labels:\n        app: swe-app-api\n    spec:\n      containers:\n      - image: datadaddy/swe-api-k8s:0.1\n        imagePullPolicy: Always\n        name: swe-app-api\n        env:\n        - name: POSTGRES_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: postgres-db-password\n              key: password\n        - name: POSTGRES_DB_URL\n          value: jdbc:postgresql://postgres.swe.svc.cluster.local:5432/postgres\n        resources:\n          requests:\n            memory: 64Mi\n            cpu: 250m\n          limits:\n            memory: 750Mi\n            cpu: 500m\n        ports:\n        - containerPort: 3000\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"swe-app-api\" is not set to runAsNonRoot"
  },
  {
    "id": "02706",
    "manifest_path": "data/manifests/the_stack_sample/sample_1102.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: redis\nspec:\n  containers:\n  - name: redis\n    image: kubernetes/redis:v1\n    env:\n    - name: MASTER\n      value: 'true'\n    ports:\n    - containerPort: 6379\n    resources:\n      limits:\n        cpu: '0.1'\n    volumeMounts:\n    - mountPath: /redis-master-data\n      name: data\n    - mountPath: /redis-master\n      name: config\n  volumes:\n  - name: data\n    emptyDir: {}\n  - name: config\n    configMap:\n      name: example-redis-config\n      items:\n      - key: redis-config\n        path: redis.conf\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"redis\" does not have a read-only root file system"
  },
  {
    "id": "02707",
    "manifest_path": "data/manifests/the_stack_sample/sample_1102.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: redis\nspec:\n  containers:\n  - name: redis\n    image: kubernetes/redis:v1\n    env:\n    - name: MASTER\n      value: 'true'\n    ports:\n    - containerPort: 6379\n    resources:\n      limits:\n        cpu: '0.1'\n    volumeMounts:\n    - mountPath: /redis-master-data\n      name: data\n    - mountPath: /redis-master\n      name: config\n  volumes:\n  - name: data\n    emptyDir: {}\n  - name: config\n    configMap:\n      name: example-redis-config\n      items:\n      - key: redis-config\n        path: redis.conf\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"redis\" is not set to runAsNonRoot"
  },
  {
    "id": "02708",
    "manifest_path": "data/manifests/the_stack_sample/sample_1102.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: redis\nspec:\n  containers:\n  - name: redis\n    image: kubernetes/redis:v1\n    env:\n    - name: MASTER\n      value: 'true'\n    ports:\n    - containerPort: 6379\n    resources:\n      limits:\n        cpu: '0.1'\n    volumeMounts:\n    - mountPath: /redis-master-data\n      name: data\n    - mountPath: /redis-master\n      name: config\n  volumes:\n  - name: data\n    emptyDir: {}\n  - name: config\n    configMap:\n      name: example-redis-config\n      items:\n      - key: redis-config\n        path: redis.conf\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"redis\" has cpu request 0"
  },
  {
    "id": "02709",
    "manifest_path": "data/manifests/the_stack_sample/sample_1102.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: redis\nspec:\n  containers:\n  - name: redis\n    image: kubernetes/redis:v1\n    env:\n    - name: MASTER\n      value: 'true'\n    ports:\n    - containerPort: 6379\n    resources:\n      limits:\n        cpu: '0.1'\n    volumeMounts:\n    - mountPath: /redis-master-data\n      name: data\n    - mountPath: /redis-master\n      name: config\n  volumes:\n  - name: data\n    emptyDir: {}\n  - name: config\n    configMap:\n      name: example-redis-config\n      items:\n      - key: redis-config\n        path: redis.conf\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"redis\" has memory limit 0"
  },
  {
    "id": "02710",
    "manifest_path": "data/manifests/the_stack_sample/sample_1104.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: jysinakscluster-dfd5\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: jysinakscluster-dfd5\n  template:\n    metadata:\n      labels:\n        app: jysinakscluster-dfd5\n    spec:\n      containers:\n      - name: jysinakscluster-dfd5\n        image: jysintestrigistry.azurecr.io/jysinakscluster\n        ports:\n        - containerPort: 80\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"jysinakscluster-dfd5\" is using an invalid container image, \"jysintestrigistry.azurecr.io/jysinakscluster\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02711",
    "manifest_path": "data/manifests/the_stack_sample/sample_1104.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: jysinakscluster-dfd5\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: jysinakscluster-dfd5\n  template:\n    metadata:\n      labels:\n        app: jysinakscluster-dfd5\n    spec:\n      containers:\n      - name: jysinakscluster-dfd5\n        image: jysintestrigistry.azurecr.io/jysinakscluster\n        ports:\n        - containerPort: 80\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"jysinakscluster-dfd5\" does not have a read-only root file system"
  },
  {
    "id": "02712",
    "manifest_path": "data/manifests/the_stack_sample/sample_1104.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: jysinakscluster-dfd5\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: jysinakscluster-dfd5\n  template:\n    metadata:\n      labels:\n        app: jysinakscluster-dfd5\n    spec:\n      containers:\n      - name: jysinakscluster-dfd5\n        image: jysintestrigistry.azurecr.io/jysinakscluster\n        ports:\n        - containerPort: 80\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"jysinakscluster-dfd5\" is not set to runAsNonRoot"
  },
  {
    "id": "02713",
    "manifest_path": "data/manifests/the_stack_sample/sample_1104.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: jysinakscluster-dfd5\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: jysinakscluster-dfd5\n  template:\n    metadata:\n      labels:\n        app: jysinakscluster-dfd5\n    spec:\n      containers:\n      - name: jysinakscluster-dfd5\n        image: jysintestrigistry.azurecr.io/jysinakscluster\n        ports:\n        - containerPort: 80\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"jysinakscluster-dfd5\" has cpu request 0"
  },
  {
    "id": "02714",
    "manifest_path": "data/manifests/the_stack_sample/sample_1104.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: jysinakscluster-dfd5\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: jysinakscluster-dfd5\n  template:\n    metadata:\n      labels:\n        app: jysinakscluster-dfd5\n    spec:\n      containers:\n      - name: jysinakscluster-dfd5\n        image: jysintestrigistry.azurecr.io/jysinakscluster\n        ports:\n        - containerPort: 80\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"jysinakscluster-dfd5\" has memory limit 0"
  },
  {
    "id": "02715",
    "manifest_path": "data/manifests/the_stack_sample/sample_1107.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: ibmliberty-deployment\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: ibmliberty\n  template:\n    metadata:\n      labels:\n        app: ibmliberty\n    spec:\n      containers:\n      - name: ibmliberty\n        image: icr.io/ibmliberty\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"ibmliberty\" is using an invalid container image, \"icr.io/ibmliberty\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02716",
    "manifest_path": "data/manifests/the_stack_sample/sample_1107.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: ibmliberty-deployment\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: ibmliberty\n  template:\n    metadata:\n      labels:\n        app: ibmliberty\n    spec:\n      containers:\n      - name: ibmliberty\n        image: icr.io/ibmliberty\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"ibmliberty\" does not have a read-only root file system"
  },
  {
    "id": "02717",
    "manifest_path": "data/manifests/the_stack_sample/sample_1107.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: ibmliberty-deployment\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: ibmliberty\n  template:\n    metadata:\n      labels:\n        app: ibmliberty\n    spec:\n      containers:\n      - name: ibmliberty\n        image: icr.io/ibmliberty\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"ibmliberty\" is not set to runAsNonRoot"
  },
  {
    "id": "02718",
    "manifest_path": "data/manifests/the_stack_sample/sample_1107.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: ibmliberty-deployment\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: ibmliberty\n  template:\n    metadata:\n      labels:\n        app: ibmliberty\n    spec:\n      containers:\n      - name: ibmliberty\n        image: icr.io/ibmliberty\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"ibmliberty\" has cpu request 0"
  },
  {
    "id": "02719",
    "manifest_path": "data/manifests/the_stack_sample/sample_1107.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: ibmliberty-deployment\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: ibmliberty\n  template:\n    metadata:\n      labels:\n        app: ibmliberty\n    spec:\n      containers:\n      - name: ibmliberty\n        image: icr.io/ibmliberty\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"ibmliberty\" has memory limit 0"
  },
  {
    "id": "02720",
    "manifest_path": "data/manifests/the_stack_sample/sample_1111.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  labels:\n    build-pipeline-name: mobilecoin-build\nspec:\n  affinity:\n    podAntiAffinity:\n      preferredDuringSchedulingIgnoredDuringExecution:\n      - weight: 100\n        podAffinityTerm:\n          labelSelector:\n            matchExpressions:\n            - key: build-pipeline-name\n              operator: In\n              values:\n              - mobilecoin-build\n          topologyKey: kubernetes.io/hostname\n  containers:\n  - name: kaniko\n    image: gcr.io/kaniko-project/executor:v1.6.0-debug\n    imagePullPolicy: Always\n    command:\n    - /busybox/cat\n    volumeMounts:\n    - name: jenkins-docker-cfg\n      mountPath: /kaniko/.docker\n  volumes:\n  - name: jenkins-docker-cfg\n    secret:\n      secretName: docker-credentials\n      items:\n      - key: .dockerconfigjson\n        path: config.json\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"kaniko\" does not have a read-only root file system"
  }
]