[
  {
    "id": "02601",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-1497\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "02602",
    "policy_id": "read_only_root_fs",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "02603",
    "policy_id": "read_only_root_fs",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "02604",
    "policy_id": "run_as_non_root",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "02605",
    "policy_id": "run_as_non_root",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "02606",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "02607",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "02608",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "02609",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "02610",
    "policy_id": "no_latest_tag",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "02611",
    "policy_id": "no_latest_tag",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "02612",
    "policy_id": "no_latest_tag",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "02613",
    "policy_id": "read_only_root_fs",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "02614",
    "policy_id": "read_only_root_fs",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "02615",
    "policy_id": "drop_capabilities",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "02616",
    "policy_id": "drop_capabilities",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "02617",
    "policy_id": "no_privileged",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "02618",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "02619",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "02620",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "02621",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "02622",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "02623",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "02624",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: meu-deployment\n  labels:\n    deployment: bolado_deployment\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      example: olx-bolada\n  template:\n    metadata:\n      labels:\n        example: olx-bolada\n    spec:\n      containers:\n      - name: meu-container\n        image: ralphavalon/kube_features:v2\n        ports:\n        - containerPort: 8081\n        env:\n        - name: API_HOST\n          value: 192.168.99.100:30934\n        resources:\n          requests:\n            memory: 64Mi\n            cpu: 100m\n          limits:\n            memory: 128Mi\n            cpu: 250m\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: 8081\n        readinessProbe:\n          httpGet:\n            path: /health\n            port: 8081\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "02625",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: meu-deployment\n  labels:\n    deployment: bolado_deployment\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      example: olx-bolada\n  template:\n    metadata:\n      labels:\n        example: olx-bolada\n    spec:\n      containers:\n      - name: meu-container\n        image: ralphavalon/kube_features:v2\n        ports:\n        - containerPort: 8081\n        env:\n        - name: API_HOST\n          value: 192.168.99.100:30934\n        resources:\n          requests:\n            memory: 64Mi\n            cpu: 100m\n          limits:\n            memory: 128Mi\n            cpu: 250m\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: 8081\n        readinessProbe:\n          httpGet:\n            path: /health\n            port: 8081\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "02626",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-4863\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    securityContext:\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      privileged: false\n      allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "02627",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-4863\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    securityContext:\n      readOnlyRootFilesystem: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "02628",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-4863\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    securityContext:\n      runAsNonRoot: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "02629",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-4863\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "02630",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-4863\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "02631",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: deis-minio\n  labels:\n    heritage: deis\n    release: v2-alpha\nspec:\n  replicas: 1\n  selector:\n    app: deis-minio\n  template:\n    metadata:\n      labels:\n        app: deis-minio\n    spec:\n      containers:\n      - imagePullPolicy: Always\n        name: deis-minio\n        image: quay.io/deisci/minio:v2-alpha\n        ports:\n        - containerPort: 9000\n        command:\n        - boot\n        args:\n        - server\n        - /home/minio/\n        volumeMounts:\n        - name: minio-admin\n          mountPath: /var/run/secrets/deis/minio/admin\n          readOnly: true\n        - name: minio-user\n          mountPath: /var/run/secrets/deis/minio/user\n          readOnly: true\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: minio-admin\n        secret:\n          secretName: minio-admin\n      - name: minio-user\n        secret:\n          secretName: minio-user\n",
    "errors": []
  },
  {
    "id": "02632",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: deis-minio\n  labels:\n    heritage: deis\n    release: v2-alpha\nspec:\n  replicas: 1\n  selector:\n    app: deis-minio\n  template:\n    metadata:\n      labels:\n        app: deis-minio\n    spec:\n      containers:\n      - imagePullPolicy: Always\n        name: deis-minio\n        image: quay.io/deisci/minio:v2-alpha\n        ports:\n        - containerPort: 9000\n        command:\n        - boot\n        args:\n        - server\n        - /home/minio/\n        volumeMounts:\n        - name: minio-admin\n          mountPath: /var/run/secrets/deis/minio/admin\n          readOnly: true\n        - name: minio-user\n          mountPath: /var/run/secrets/deis/minio/user\n          readOnly: true\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: minio-admin\n        secret:\n          secretName: minio-admin\n      - name: minio-user\n        secret:\n          secretName: minio-user\n",
    "errors": []
  },
  {
    "id": "02633",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: deis-minio\n  labels:\n    heritage: deis\n    release: v2-alpha\nspec:\n  replicas: 1\n  selector:\n    app: deis-minio\n  template:\n    metadata:\n      labels:\n        app: deis-minio\n    spec:\n      containers:\n      - imagePullPolicy: Always\n        name: deis-minio\n        image: quay.io/deisci/minio:v2-alpha\n        ports:\n        - containerPort: 9000\n        command:\n        - boot\n        args:\n        - server\n        - /home/minio/\n        volumeMounts:\n        - name: minio-admin\n          mountPath: /var/run/secrets/deis/minio/admin\n          readOnly: true\n        - name: minio-user\n          mountPath: /var/run/secrets/deis/minio/user\n          readOnly: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: minio-admin\n        secret:\n          secretName: minio-admin\n      - name: minio-user\n        secret:\n          secretName: minio-user\n",
    "errors": []
  },
  {
    "id": "02634",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: deis-minio\n  labels:\n    heritage: deis\n    release: v2-alpha\nspec:\n  replicas: 1\n  selector:\n    app: deis-minio\n  template:\n    metadata:\n      labels:\n        app: deis-minio\n    spec:\n      containers:\n      - imagePullPolicy: Always\n        name: deis-minio\n        image: quay.io/deisci/minio:v2-alpha\n        ports:\n        - containerPort: 9000\n        command:\n        - boot\n        args:\n        - server\n        - /home/minio/\n        volumeMounts:\n        - name: minio-admin\n          mountPath: /var/run/secrets/deis/minio/admin\n          readOnly: true\n        - name: minio-user\n          mountPath: /var/run/secrets/deis/minio/user\n          readOnly: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: minio-admin\n        secret:\n          secretName: minio-admin\n      - name: minio-user\n        secret:\n          secretName: minio-user\n",
    "errors": []
  },
  {
    "id": "02635",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: pmu-dummy\n  labels:\n    app: pmu-dummy\nspec:\n  selector:\n    matchLabels:\n      app: pmu-dummy\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: pmu-dummy\n    spec:\n      containers:\n      - name: pmu-dummy\n        image: registry.example.com/pmu-kafka-timescale-demo/kafka-connect-cluster/pmu-dummy:stable\n        volumeMounts:\n        - name: pmu-dummy-template-config\n          mountPath: /usr/src/app/device_template.json\n          subPath: device_template.json\n        env:\n        - name: JSON_TEMPLATE\n          value: /usr/src/app/device_template.json\n        - name: PRODUCER_TYPE\n          value: kafka\n        - name: BROKER_URL\n          value: strimzi-cluster-kafka-bootstrap.demo\n        - name: BROKER_PORT\n          value: '9092'\n        - name: TOPIC_NAME\n          value: pmu-dummy-in\n        - name: MQTT_USER\n          value: admin\n        - name: MQTT_PWD\n          value: admin\n        - name: MQTT_SSL\n          value: 'false'\n        - name: MQTT_CAFILE\n          value: /etc/ssl/certs/DST_Root_CA_X3.pem\n        - name: MQTT_DEVICE_NAME\n          value: device1-dummy\n        ports:\n        - containerPort: 3000\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: pmu-dummy-template-config\n        configMap:\n          name: pmu-dummy-template-config\n          items:\n          - key: device_template.json\n            path: device_template.json\n",
    "errors": []
  },
  {
    "id": "02636",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: pmu-dummy\n  labels:\n    app: pmu-dummy\nspec:\n  selector:\n    matchLabels:\n      app: pmu-dummy\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: pmu-dummy\n    spec:\n      containers:\n      - name: pmu-dummy\n        image: registry.example.com/pmu-kafka-timescale-demo/kafka-connect-cluster/pmu-dummy:stable\n        volumeMounts:\n        - name: pmu-dummy-template-config\n          mountPath: /usr/src/app/device_template.json\n          subPath: device_template.json\n        env:\n        - name: JSON_TEMPLATE\n          value: /usr/src/app/device_template.json\n        - name: PRODUCER_TYPE\n          value: kafka\n        - name: BROKER_URL\n          value: strimzi-cluster-kafka-bootstrap.demo\n        - name: BROKER_PORT\n          value: '9092'\n        - name: TOPIC_NAME\n          value: pmu-dummy-in\n        - name: MQTT_USER\n          value: admin\n        - name: MQTT_PWD\n          value: admin\n        - name: MQTT_SSL\n          value: 'false'\n        - name: MQTT_CAFILE\n          value: /etc/ssl/certs/DST_Root_CA_X3.pem\n        - name: MQTT_DEVICE_NAME\n          value: device1-dummy\n        ports:\n        - containerPort: 3000\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: pmu-dummy-template-config\n        configMap:\n          name: pmu-dummy-template-config\n          items:\n          - key: device_template.json\n            path: device_template.json\n",
    "errors": []
  },
  {
    "id": "02637",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: pmu-dummy\n  labels:\n    app: pmu-dummy\nspec:\n  selector:\n    matchLabels:\n      app: pmu-dummy\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: pmu-dummy\n    spec:\n      containers:\n      - name: pmu-dummy\n        image: registry.example.com/pmu-kafka-timescale-demo/kafka-connect-cluster/pmu-dummy:stable\n        volumeMounts:\n        - name: pmu-dummy-template-config\n          mountPath: /usr/src/app/device_template.json\n          subPath: device_template.json\n        env:\n        - name: JSON_TEMPLATE\n          value: /usr/src/app/device_template.json\n        - name: PRODUCER_TYPE\n          value: kafka\n        - name: BROKER_URL\n          value: strimzi-cluster-kafka-bootstrap.demo\n        - name: BROKER_PORT\n          value: '9092'\n        - name: TOPIC_NAME\n          value: pmu-dummy-in\n        - name: MQTT_USER\n          value: admin\n        - name: MQTT_PWD\n          value: admin\n        - name: MQTT_SSL\n          value: 'false'\n        - name: MQTT_CAFILE\n          value: /etc/ssl/certs/DST_Root_CA_X3.pem\n        - name: MQTT_DEVICE_NAME\n          value: device1-dummy\n        ports:\n        - containerPort: 3000\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: pmu-dummy-template-config\n        configMap:\n          name: pmu-dummy-template-config\n          items:\n          - key: device_template.json\n            path: device_template.json\n",
    "errors": []
  },
  {
    "id": "02638",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: pmu-dummy\n  labels:\n    app: pmu-dummy\nspec:\n  selector:\n    matchLabels:\n      app: pmu-dummy\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: pmu-dummy\n    spec:\n      containers:\n      - name: pmu-dummy\n        image: registry.example.com/pmu-kafka-timescale-demo/kafka-connect-cluster/pmu-dummy:stable\n        volumeMounts:\n        - name: pmu-dummy-template-config\n          mountPath: /usr/src/app/device_template.json\n          subPath: device_template.json\n        env:\n        - name: JSON_TEMPLATE\n          value: /usr/src/app/device_template.json\n        - name: PRODUCER_TYPE\n          value: kafka\n        - name: BROKER_URL\n          value: strimzi-cluster-kafka-bootstrap.demo\n        - name: BROKER_PORT\n          value: '9092'\n        - name: TOPIC_NAME\n          value: pmu-dummy-in\n        - name: MQTT_USER\n          value: admin\n        - name: MQTT_PWD\n          value: admin\n        - name: MQTT_SSL\n          value: 'false'\n        - name: MQTT_CAFILE\n          value: /etc/ssl/certs/DST_Root_CA_X3.pem\n        - name: MQTT_DEVICE_NAME\n          value: device1-dummy\n        ports:\n        - containerPort: 3000\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: pmu-dummy-template-config\n        configMap:\n          name: pmu-dummy-template-config\n          items:\n          - key: device_template.json\n            path: device_template.json\n",
    "errors": []
  },
  {
    "id": "02639",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: pmu-dummy\n  labels:\n    app: pmu-dummy\nspec:\n  selector:\n    matchLabels:\n      app: pmu-dummy\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: pmu-dummy\n    spec:\n      containers:\n      - name: pmu-dummy\n        image: registry.example.com/pmu-kafka-timescale-demo/kafka-connect-cluster/pmu-dummy:stable\n        volumeMounts:\n        - name: pmu-dummy-template-config\n          mountPath: /usr/src/app/device_template.json\n          subPath: device_template.json\n        env:\n        - name: JSON_TEMPLATE\n          value: /usr/src/app/device_template.json\n        - name: PRODUCER_TYPE\n          value: kafka\n        - name: BROKER_URL\n          value: strimzi-cluster-kafka-bootstrap.demo\n        - name: BROKER_PORT\n          value: '9092'\n        - name: TOPIC_NAME\n          value: pmu-dummy-in\n        - name: MQTT_USER\n          value: admin\n        - name: MQTT_PWD\n          value: admin\n        - name: MQTT_SSL\n          value: 'false'\n        - name: MQTT_CAFILE\n          value: /etc/ssl/certs/DST_Root_CA_X3.pem\n        - name: MQTT_DEVICE_NAME\n          value: device1-dummy\n        ports:\n        - containerPort: 3000\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: pmu-dummy-template-config\n        configMap:\n          name: pmu-dummy-template-config\n          items:\n          - key: device_template.json\n            path: device_template.json\n",
    "errors": []
  },
  {
    "id": "02640",
    "policy_id": "read_only_root_fs",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  }
]