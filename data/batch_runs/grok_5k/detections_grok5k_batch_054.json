[
  {
    "id": "02161",
    "manifest_path": "data/manifests/the_stack_sample/sample_0805.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-1708\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"nginx\" does not have a read-only root file system"
  },
  {
    "id": "02162",
    "manifest_path": "data/manifests/the_stack_sample/sample_0805.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-1708\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"nginx\" is not set to runAsNonRoot"
  },
  {
    "id": "02163",
    "manifest_path": "data/manifests/the_stack_sample/sample_0805.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-1708\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"nginx\" has cpu request 0"
  },
  {
    "id": "02164",
    "manifest_path": "data/manifests/the_stack_sample/sample_0805.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-1708\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"nginx\" has memory limit 0"
  },
  {
    "id": "02165",
    "manifest_path": "data/manifests/the_stack_sample/sample_0806.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: horologium\n  labels:\n    app: horologium\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: horologium\n  template:\n    metadata:\n      labels:\n        app: horologium\n    spec:\n      serviceAccountName: horologium\n      containers:\n      - name: horologium\n        image: gcr.io/k8s-prow/horologium:v20220323-9b8611d021\n        args:\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        - --dry-run=false\n        volumeMounts:\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n      volumes:\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"horologium\" does not have a read-only root file system"
  },
  {
    "id": "02166",
    "manifest_path": "data/manifests/the_stack_sample/sample_0806.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: horologium\n  labels:\n    app: horologium\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: horologium\n  template:\n    metadata:\n      labels:\n        app: horologium\n    spec:\n      serviceAccountName: horologium\n      containers:\n      - name: horologium\n        image: gcr.io/k8s-prow/horologium:v20220323-9b8611d021\n        args:\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        - --dry-run=false\n        volumeMounts:\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n      volumes:\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"horologium\" is not set to runAsNonRoot"
  },
  {
    "id": "02167",
    "manifest_path": "data/manifests/the_stack_sample/sample_0806.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: horologium\n  labels:\n    app: horologium\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: horologium\n  template:\n    metadata:\n      labels:\n        app: horologium\n    spec:\n      serviceAccountName: horologium\n      containers:\n      - name: horologium\n        image: gcr.io/k8s-prow/horologium:v20220323-9b8611d021\n        args:\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        - --dry-run=false\n        volumeMounts:\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n      volumes:\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"horologium\" has cpu request 0"
  },
  {
    "id": "02168",
    "manifest_path": "data/manifests/the_stack_sample/sample_0806.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: horologium\n  labels:\n    app: horologium\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: horologium\n  template:\n    metadata:\n      labels:\n        app: horologium\n    spec:\n      serviceAccountName: horologium\n      containers:\n      - name: horologium\n        image: gcr.io/k8s-prow/horologium:v20220323-9b8611d021\n        args:\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        - --dry-run=false\n        volumeMounts:\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n      volumes:\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"horologium\" has memory limit 0"
  },
  {
    "id": "02169",
    "manifest_path": "data/manifests/the_stack_sample/sample_0807.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: app\n  labels:\n    app: python\nspec:\n  selector:\n    matchLabels:\n      app: python\n      tier: app\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: python\n        tier: app\n    spec:\n      containers:\n      - name: python\n        image: registry.cn-hangzhou.aliyuncs.com/dal/python:v1.0\n        resources:\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        env:\n        - name: GET_HOSTS_FROM\n          value: dns\n        - name: MYSQL_ROOT_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: mysecret\n              key: key\n        ports:\n        - containerPort: 80\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"python\" does not have a read-only root file system"
  },
  {
    "id": "02170",
    "manifest_path": "data/manifests/the_stack_sample/sample_0807.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: app\n  labels:\n    app: python\nspec:\n  selector:\n    matchLabels:\n      app: python\n      tier: app\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: python\n        tier: app\n    spec:\n      containers:\n      - name: python\n        image: registry.cn-hangzhou.aliyuncs.com/dal/python:v1.0\n        resources:\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        env:\n        - name: GET_HOSTS_FROM\n          value: dns\n        - name: MYSQL_ROOT_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: mysecret\n              key: key\n        ports:\n        - containerPort: 80\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"python\" is not set to runAsNonRoot"
  },
  {
    "id": "02171",
    "manifest_path": "data/manifests/the_stack_sample/sample_0807.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: app\n  labels:\n    app: python\nspec:\n  selector:\n    matchLabels:\n      app: python\n      tier: app\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: python\n        tier: app\n    spec:\n      containers:\n      - name: python\n        image: registry.cn-hangzhou.aliyuncs.com/dal/python:v1.0\n        resources:\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        env:\n        - name: GET_HOSTS_FROM\n          value: dns\n        - name: MYSQL_ROOT_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: mysecret\n              key: key\n        ports:\n        - containerPort: 80\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"python\" has memory limit 0"
  },
  {
    "id": "02172",
    "manifest_path": "data/manifests/the_stack_sample/sample_0809.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: deployment\nspec:\n  replicas: 0\n  selector:\n    matchLabels:\n      service: service\n  template:\n    metadata:\n      labels:\n        service: service\n    spec:\n      serviceAccountName: service-sa\n      containers:\n      - name: container\n        image: image\n        env:\n        - name: SOME_VAR1\n          value: SOME_VAL1\n        readinessProbe:\n          failureThreshold: 5\n          httpGet:\n            path: /health/ready\n            port: 8080\n            scheme: HTTP\n          initialDelaySeconds: 5\n          periodSeconds: 5\n          successThreshold: 1\n          timeoutSeconds: 1\n        livenessProbe:\n          failureThreshold: 3\n          httpGet:\n            path: /health/live\n            port: 8080\n            scheme: HTTP\n          initialDelaySeconds: 10\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        ports:\n        - containerPort: 8080\n          protocol: TCP\n        resources:\n          requests:\n            memory: 256Mi\n            cpu: 250m\n          limits:\n            memory: 512Mi\n            cpu: 500m\n        imagePullPolicy: Always\n      securityContext: {}\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"container\" is using an invalid container image, \"image\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02173",
    "manifest_path": "data/manifests/the_stack_sample/sample_0809.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: deployment\nspec:\n  replicas: 0\n  selector:\n    matchLabels:\n      service: service\n  template:\n    metadata:\n      labels:\n        service: service\n    spec:\n      serviceAccountName: service-sa\n      containers:\n      - name: container\n        image: image\n        env:\n        - name: SOME_VAR1\n          value: SOME_VAL1\n        readinessProbe:\n          failureThreshold: 5\n          httpGet:\n            path: /health/ready\n            port: 8080\n            scheme: HTTP\n          initialDelaySeconds: 5\n          periodSeconds: 5\n          successThreshold: 1\n          timeoutSeconds: 1\n        livenessProbe:\n          failureThreshold: 3\n          httpGet:\n            path: /health/live\n            port: 8080\n            scheme: HTTP\n          initialDelaySeconds: 10\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        ports:\n        - containerPort: 8080\n          protocol: TCP\n        resources:\n          requests:\n            memory: 256Mi\n            cpu: 250m\n          limits:\n            memory: 512Mi\n            cpu: 500m\n        imagePullPolicy: Always\n      securityContext: {}\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"container\" does not have a read-only root file system"
  },
  {
    "id": "02174",
    "manifest_path": "data/manifests/the_stack_sample/sample_0809.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: deployment\nspec:\n  replicas: 0\n  selector:\n    matchLabels:\n      service: service\n  template:\n    metadata:\n      labels:\n        service: service\n    spec:\n      serviceAccountName: service-sa\n      containers:\n      - name: container\n        image: image\n        env:\n        - name: SOME_VAR1\n          value: SOME_VAL1\n        readinessProbe:\n          failureThreshold: 5\n          httpGet:\n            path: /health/ready\n            port: 8080\n            scheme: HTTP\n          initialDelaySeconds: 5\n          periodSeconds: 5\n          successThreshold: 1\n          timeoutSeconds: 1\n        livenessProbe:\n          failureThreshold: 3\n          httpGet:\n            path: /health/live\n            port: 8080\n            scheme: HTTP\n          initialDelaySeconds: 10\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        ports:\n        - containerPort: 8080\n          protocol: TCP\n        resources:\n          requests:\n            memory: 256Mi\n            cpu: 250m\n          limits:\n            memory: 512Mi\n            cpu: 500m\n        imagePullPolicy: Always\n      securityContext: {}\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"container\" is not set to runAsNonRoot"
  },
  {
    "id": "02175",
    "manifest_path": "data/manifests/the_stack_sample/sample_0810.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: redis\nspec:\n  selector:\n    matchLabels:\n      app: redis\n      role: master\n      tier: backend\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: redis\n        role: master\n        tier: backend\n    spec:\n      containers:\n      - name: master\n        image: docker.io/mreider/eatk8s-redis:latest\n        resources:\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        ports:\n        - containerPort: 6379\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"master\" is using an invalid container image, \"docker.io/mreider/eatk8s-redis:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02176",
    "manifest_path": "data/manifests/the_stack_sample/sample_0810.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: redis\nspec:\n  selector:\n    matchLabels:\n      app: redis\n      role: master\n      tier: backend\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: redis\n        role: master\n        tier: backend\n    spec:\n      containers:\n      - name: master\n        image: docker.io/mreider/eatk8s-redis:latest\n        resources:\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        ports:\n        - containerPort: 6379\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"master\" does not have a read-only root file system"
  },
  {
    "id": "02177",
    "manifest_path": "data/manifests/the_stack_sample/sample_0810.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: redis\nspec:\n  selector:\n    matchLabels:\n      app: redis\n      role: master\n      tier: backend\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: redis\n        role: master\n        tier: backend\n    spec:\n      containers:\n      - name: master\n        image: docker.io/mreider/eatk8s-redis:latest\n        resources:\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        ports:\n        - containerPort: 6379\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"master\" is not set to runAsNonRoot"
  },
  {
    "id": "02178",
    "manifest_path": "data/manifests/the_stack_sample/sample_0810.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: redis\nspec:\n  selector:\n    matchLabels:\n      app: redis\n      role: master\n      tier: backend\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: redis\n        role: master\n        tier: backend\n    spec:\n      containers:\n      - name: master\n        image: docker.io/mreider/eatk8s-redis:latest\n        resources:\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        ports:\n        - containerPort: 6379\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"master\" has memory limit 0"
  },
  {
    "id": "02179",
    "manifest_path": "data/manifests/the_stack_sample/sample_0815.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: cyclonus\nspec:\n  template:\n    spec:\n      containers:\n      - command:\n        - ./cyclonus\n        - generate\n        - --server-protocol=tcp,udp\n        name: cyclonus\n        imagePullPolicy: IfNotPresent\n        image: mfenwick100/cyclonus:latest\n      serviceAccount: cyclonus\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"cyclonus\" is using an invalid container image, \"mfenwick100/cyclonus:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02180",
    "manifest_path": "data/manifests/the_stack_sample/sample_0815.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: cyclonus\nspec:\n  template:\n    spec:\n      containers:\n      - command:\n        - ./cyclonus\n        - generate\n        - --server-protocol=tcp,udp\n        name: cyclonus\n        imagePullPolicy: IfNotPresent\n        image: mfenwick100/cyclonus:latest\n      serviceAccount: cyclonus\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"cyclonus\" does not have a read-only root file system"
  },
  {
    "id": "02181",
    "manifest_path": "data/manifests/the_stack_sample/sample_0815.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: cyclonus\nspec:\n  template:\n    spec:\n      containers:\n      - command:\n        - ./cyclonus\n        - generate\n        - --server-protocol=tcp,udp\n        name: cyclonus\n        imagePullPolicy: IfNotPresent\n        image: mfenwick100/cyclonus:latest\n      serviceAccount: cyclonus\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"cyclonus\" is not set to runAsNonRoot"
  },
  {
    "id": "02182",
    "manifest_path": "data/manifests/the_stack_sample/sample_0815.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: cyclonus\nspec:\n  template:\n    spec:\n      containers:\n      - command:\n        - ./cyclonus\n        - generate\n        - --server-protocol=tcp,udp\n        name: cyclonus\n        imagePullPolicy: IfNotPresent\n        image: mfenwick100/cyclonus:latest\n      serviceAccount: cyclonus\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"cyclonus\" has cpu request 0"
  },
  {
    "id": "02183",
    "manifest_path": "data/manifests/the_stack_sample/sample_0815.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: cyclonus\nspec:\n  template:\n    spec:\n      containers:\n      - command:\n        - ./cyclonus\n        - generate\n        - --server-protocol=tcp,udp\n        name: cyclonus\n        imagePullPolicy: IfNotPresent\n        image: mfenwick100/cyclonus:latest\n      serviceAccount: cyclonus\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"cyclonus\" has memory limit 0"
  },
  {
    "id": "02184",
    "manifest_path": "data/manifests/the_stack_sample/sample_0816.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: lighthouse-webhooks\n  labels:\n    chart: lighthouse-1.3.0\n    app: lighthouse-webhooks\n    git.jenkins-x.io/sha: annotate\n    gitops.jenkins-x.io/pipeline: namespaces\n  annotations:\n    checksum/config: 1cfb0afb7b5cb9aa219544875fa8c047c7257c0524a31d34dd48874589d98792\n    meta.helm.sh/release-name: lighthouse\n    wave.pusher.com/update-on-config-change: 'true'\n  namespace: jx\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: lighthouse-webhooks\n  template:\n    metadata:\n      labels:\n        app: lighthouse-webhooks\n      annotations:\n        prometheus.io/port: '2112'\n        prometheus.io/scrape: 'true'\n        jenkins-x.io/hash: beaad4cded88f5572b6a079082f39d0b00e7b0fc527a18ceb52857330f6d746a\n    spec:\n      serviceAccountName: lighthouse-webhooks\n      containers:\n      - name: lighthouse-webhooks\n        image: ghcr.io/jenkins-x/lighthouse-webhooks:1.3.0\n        imagePullPolicy: IfNotPresent\n        args:\n        - --namespace=jx\n        env:\n        - name: GIT_KIND\n          value: github\n        - name: LH_CUSTOM_TRIGGER_COMMAND\n          value: jx\n        - name: GIT_SERVER\n          value: https://github.com\n        - name: GIT_USER\n          value: bussrrajeshnayak\n        - name: GIT_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: lighthouse-oauth-token\n              key: oauth\n        - name: HMAC_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: lighthouse-hmac-token\n              key: hmac\n              optional: false\n        - name: JX_LOG_FORMAT\n          value: stackdriver\n        - name: LOGRUS_FORMAT\n          value: stackdriver\n        - name: LOGRUS_SERVICE\n          value: lighthouse\n        - name: LOGRUS_SERVICE_VERSION\n          value: 1.3.0\n        - name: LOGRUS_STACK_SKIP\n          value: ''\n        - name: DEFAULT_PIPELINE_RUN_SERVICE_ACCOUNT\n          value: tekton-bot\n        - name: DEFAULT_PIPELINE_RUN_TIMEOUT\n          value: 2h0m0s\n        - name: FILE_BROWSER\n          value: git\n        - name: JX_DEFAULT_IMAGE\n          value: ghcr.io/jenkins-x/builder-maven:2.1.149-768\n        - name: LIGHTHOUSE_DASHBOARD_TEMPLATE\n          value: namespaces/{{ .Namespace }}/pipelineruns/{{ .PipelineRun }}\n        - name: LIGHTHOUSE_VERSIONSTREAM_JENKINS_X_JX3_PIPELINE_CATALOG\n          value: 60d2f020b3003672ecbc8c9abd2f3cf20344fee2\n        envFrom:\n        - secretRef:\n            name: jx-boot-job-env-vars\n            optional: true\n        ports:\n        - containerPort: 8080\n        livenessProbe:\n          httpGet:\n            path: /\n            port: 8080\n          initialDelaySeconds: 60\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        readinessProbe:\n          httpGet:\n            path: /\n            port: 8080\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        resources:\n          limits:\n            cpu: 100m\n            memory: 512Mi\n          requests:\n            cpu: 80m\n            memory: 128Mi\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"lighthouse-webhooks\" does not have a read-only root file system"
  },
  {
    "id": "02185",
    "manifest_path": "data/manifests/the_stack_sample/sample_0816.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: lighthouse-webhooks\n  labels:\n    chart: lighthouse-1.3.0\n    app: lighthouse-webhooks\n    git.jenkins-x.io/sha: annotate\n    gitops.jenkins-x.io/pipeline: namespaces\n  annotations:\n    checksum/config: 1cfb0afb7b5cb9aa219544875fa8c047c7257c0524a31d34dd48874589d98792\n    meta.helm.sh/release-name: lighthouse\n    wave.pusher.com/update-on-config-change: 'true'\n  namespace: jx\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: lighthouse-webhooks\n  template:\n    metadata:\n      labels:\n        app: lighthouse-webhooks\n      annotations:\n        prometheus.io/port: '2112'\n        prometheus.io/scrape: 'true'\n        jenkins-x.io/hash: beaad4cded88f5572b6a079082f39d0b00e7b0fc527a18ceb52857330f6d746a\n    spec:\n      serviceAccountName: lighthouse-webhooks\n      containers:\n      - name: lighthouse-webhooks\n        image: ghcr.io/jenkins-x/lighthouse-webhooks:1.3.0\n        imagePullPolicy: IfNotPresent\n        args:\n        - --namespace=jx\n        env:\n        - name: GIT_KIND\n          value: github\n        - name: LH_CUSTOM_TRIGGER_COMMAND\n          value: jx\n        - name: GIT_SERVER\n          value: https://github.com\n        - name: GIT_USER\n          value: bussrrajeshnayak\n        - name: GIT_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: lighthouse-oauth-token\n              key: oauth\n        - name: HMAC_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: lighthouse-hmac-token\n              key: hmac\n              optional: false\n        - name: JX_LOG_FORMAT\n          value: stackdriver\n        - name: LOGRUS_FORMAT\n          value: stackdriver\n        - name: LOGRUS_SERVICE\n          value: lighthouse\n        - name: LOGRUS_SERVICE_VERSION\n          value: 1.3.0\n        - name: LOGRUS_STACK_SKIP\n          value: ''\n        - name: DEFAULT_PIPELINE_RUN_SERVICE_ACCOUNT\n          value: tekton-bot\n        - name: DEFAULT_PIPELINE_RUN_TIMEOUT\n          value: 2h0m0s\n        - name: FILE_BROWSER\n          value: git\n        - name: JX_DEFAULT_IMAGE\n          value: ghcr.io/jenkins-x/builder-maven:2.1.149-768\n        - name: LIGHTHOUSE_DASHBOARD_TEMPLATE\n          value: namespaces/{{ .Namespace }}/pipelineruns/{{ .PipelineRun }}\n        - name: LIGHTHOUSE_VERSIONSTREAM_JENKINS_X_JX3_PIPELINE_CATALOG\n          value: 60d2f020b3003672ecbc8c9abd2f3cf20344fee2\n        envFrom:\n        - secretRef:\n            name: jx-boot-job-env-vars\n            optional: true\n        ports:\n        - containerPort: 8080\n        livenessProbe:\n          httpGet:\n            path: /\n            port: 8080\n          initialDelaySeconds: 60\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        readinessProbe:\n          httpGet:\n            path: /\n            port: 8080\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        resources:\n          limits:\n            cpu: 100m\n            memory: 512Mi\n          requests:\n            cpu: 80m\n            memory: 128Mi\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"lighthouse-webhooks\" is not set to runAsNonRoot"
  },
  {
    "id": "02186",
    "manifest_path": "data/manifests/the_stack_sample/sample_0817.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: default-mem-demo-3\n  namespace: default-mem-example\nspec:\n  containers:\n  - name: default-mem-demo-3-ctr\n    image: nginx\n    resources:\n      requests:\n        memory: 128Mi\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"default-mem-demo-3-ctr\" is using an invalid container image, \"nginx\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02187",
    "manifest_path": "data/manifests/the_stack_sample/sample_0817.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: default-mem-demo-3\n  namespace: default-mem-example\nspec:\n  containers:\n  - name: default-mem-demo-3-ctr\n    image: nginx\n    resources:\n      requests:\n        memory: 128Mi\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"default-mem-demo-3-ctr\" does not have a read-only root file system"
  },
  {
    "id": "02188",
    "manifest_path": "data/manifests/the_stack_sample/sample_0817.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: default-mem-demo-3\n  namespace: default-mem-example\nspec:\n  containers:\n  - name: default-mem-demo-3-ctr\n    image: nginx\n    resources:\n      requests:\n        memory: 128Mi\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"default-mem-demo-3-ctr\" is not set to runAsNonRoot"
  },
  {
    "id": "02189",
    "manifest_path": "data/manifests/the_stack_sample/sample_0817.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: default-mem-demo-3\n  namespace: default-mem-example\nspec:\n  containers:\n  - name: default-mem-demo-3-ctr\n    image: nginx\n    resources:\n      requests:\n        memory: 128Mi\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"default-mem-demo-3-ctr\" has cpu request 0"
  },
  {
    "id": "02190",
    "manifest_path": "data/manifests/the_stack_sample/sample_0817.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: default-mem-demo-3\n  namespace: default-mem-example\nspec:\n  containers:\n  - name: default-mem-demo-3-ctr\n    image: nginx\n    resources:\n      requests:\n        memory: 128Mi\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"default-mem-demo-3-ctr\" has memory limit 0"
  },
  {
    "id": "02191",
    "manifest_path": "data/manifests/the_stack_sample/sample_0827.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: cronjob\n  namespace: kubernetes-starterkit\nspec:\n  jobTemplate:\n    template:\n      metadata:\n        labels:\n          app: cronjob\n      spec:\n        containers:\n        - name: cronjob\n          image: spotify/alpine:latest\n          imagePullPolicy: Always\n          command:\n          - curl\n          args:\n          - http://bootstorage-svc:5000/api/bootstorage/deletelru\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"cronjob\" is using an invalid container image, \"spotify/alpine:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02192",
    "manifest_path": "data/manifests/the_stack_sample/sample_0827.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: cronjob\n  namespace: kubernetes-starterkit\nspec:\n  jobTemplate:\n    template:\n      metadata:\n        labels:\n          app: cronjob\n      spec:\n        containers:\n        - name: cronjob\n          image: spotify/alpine:latest\n          imagePullPolicy: Always\n          command:\n          - curl\n          args:\n          - http://bootstorage-svc:5000/api/bootstorage/deletelru\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"cronjob\" does not have a read-only root file system"
  },
  {
    "id": "02193",
    "manifest_path": "data/manifests/the_stack_sample/sample_0827.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: cronjob\n  namespace: kubernetes-starterkit\nspec:\n  jobTemplate:\n    template:\n      metadata:\n        labels:\n          app: cronjob\n      spec:\n        containers:\n        - name: cronjob\n          image: spotify/alpine:latest\n          imagePullPolicy: Always\n          command:\n          - curl\n          args:\n          - http://bootstorage-svc:5000/api/bootstorage/deletelru\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"cronjob\" is not set to runAsNonRoot"
  },
  {
    "id": "02194",
    "manifest_path": "data/manifests/the_stack_sample/sample_0827.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: cronjob\n  namespace: kubernetes-starterkit\nspec:\n  jobTemplate:\n    template:\n      metadata:\n        labels:\n          app: cronjob\n      spec:\n        containers:\n        - name: cronjob\n          image: spotify/alpine:latest\n          imagePullPolicy: Always\n          command:\n          - curl\n          args:\n          - http://bootstorage-svc:5000/api/bootstorage/deletelru\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"cronjob\" has cpu request 0"
  },
  {
    "id": "02195",
    "manifest_path": "data/manifests/the_stack_sample/sample_0827.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: cronjob\n  namespace: kubernetes-starterkit\nspec:\n  jobTemplate:\n    template:\n      metadata:\n        labels:\n          app: cronjob\n      spec:\n        containers:\n        - name: cronjob\n          image: spotify/alpine:latest\n          imagePullPolicy: Always\n          command:\n          - curl\n          args:\n          - http://bootstorage-svc:5000/api/bootstorage/deletelru\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"cronjob\" has memory limit 0"
  },
  {
    "id": "02196",
    "manifest_path": "data/manifests/the_stack_sample/sample_0828.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: jxboot-helmfile-resources-controllerrole\n  labels:\n    app: controllerrole\n    chart: controllerrole-2.0.1143\n    release: jxboot-helmfile-resources\n    heritage: Helm\nspec:\n  selector:\n    matchLabels:\n      app: controllerrole\n      release: jxboot-helmfile-resources\n  template:\n    metadata:\n      labels:\n        app: controllerrole\n        release: jxboot-helmfile-resources\n    spec:\n      serviceAccountName: jxboot-helmfile-resources-controllerrole\n      containers:\n      - name: controllerrole\n        command:\n        - jx\n        args:\n        - controller\n        - role\n        imagePullPolicy: IfNotPresent\n        image: gcr.io/jenkinsxio-labs-private/jxl:0.0.208\n        ports:\n        - name: http\n          containerPort: 80\n          protocol: TCP\n        env:\n        - name: JX_LOG_FORMAT\n          value: json\n        - name: JX_LOG_LEVEL\n          value: info\n        - name: PIPELINE_KIND\n          value: dummy\n        resources: {}\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"controllerrole\" does not have a read-only root file system"
  },
  {
    "id": "02197",
    "manifest_path": "data/manifests/the_stack_sample/sample_0828.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: jxboot-helmfile-resources-controllerrole\n  labels:\n    app: controllerrole\n    chart: controllerrole-2.0.1143\n    release: jxboot-helmfile-resources\n    heritage: Helm\nspec:\n  selector:\n    matchLabels:\n      app: controllerrole\n      release: jxboot-helmfile-resources\n  template:\n    metadata:\n      labels:\n        app: controllerrole\n        release: jxboot-helmfile-resources\n    spec:\n      serviceAccountName: jxboot-helmfile-resources-controllerrole\n      containers:\n      - name: controllerrole\n        command:\n        - jx\n        args:\n        - controller\n        - role\n        imagePullPolicy: IfNotPresent\n        image: gcr.io/jenkinsxio-labs-private/jxl:0.0.208\n        ports:\n        - name: http\n          containerPort: 80\n          protocol: TCP\n        env:\n        - name: JX_LOG_FORMAT\n          value: json\n        - name: JX_LOG_LEVEL\n          value: info\n        - name: PIPELINE_KIND\n          value: dummy\n        resources: {}\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"controllerrole\" is not set to runAsNonRoot"
  },
  {
    "id": "02198",
    "manifest_path": "data/manifests/the_stack_sample/sample_0828.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: jxboot-helmfile-resources-controllerrole\n  labels:\n    app: controllerrole\n    chart: controllerrole-2.0.1143\n    release: jxboot-helmfile-resources\n    heritage: Helm\nspec:\n  selector:\n    matchLabels:\n      app: controllerrole\n      release: jxboot-helmfile-resources\n  template:\n    metadata:\n      labels:\n        app: controllerrole\n        release: jxboot-helmfile-resources\n    spec:\n      serviceAccountName: jxboot-helmfile-resources-controllerrole\n      containers:\n      - name: controllerrole\n        command:\n        - jx\n        args:\n        - controller\n        - role\n        imagePullPolicy: IfNotPresent\n        image: gcr.io/jenkinsxio-labs-private/jxl:0.0.208\n        ports:\n        - name: http\n          containerPort: 80\n          protocol: TCP\n        env:\n        - name: JX_LOG_FORMAT\n          value: json\n        - name: JX_LOG_LEVEL\n          value: info\n        - name: PIPELINE_KIND\n          value: dummy\n        resources: {}\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"controllerrole\" has cpu request 0"
  },
  {
    "id": "02199",
    "manifest_path": "data/manifests/the_stack_sample/sample_0828.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: jxboot-helmfile-resources-controllerrole\n  labels:\n    app: controllerrole\n    chart: controllerrole-2.0.1143\n    release: jxboot-helmfile-resources\n    heritage: Helm\nspec:\n  selector:\n    matchLabels:\n      app: controllerrole\n      release: jxboot-helmfile-resources\n  template:\n    metadata:\n      labels:\n        app: controllerrole\n        release: jxboot-helmfile-resources\n    spec:\n      serviceAccountName: jxboot-helmfile-resources-controllerrole\n      containers:\n      - name: controllerrole\n        command:\n        - jx\n        args:\n        - controller\n        - role\n        imagePullPolicy: IfNotPresent\n        image: gcr.io/jenkinsxio-labs-private/jxl:0.0.208\n        ports:\n        - name: http\n          containerPort: 80\n          protocol: TCP\n        env:\n        - name: JX_LOG_FORMAT\n          value: json\n        - name: JX_LOG_LEVEL\n          value: info\n        - name: PIPELINE_KIND\n          value: dummy\n        resources: {}\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"controllerrole\" has memory limit 0"
  },
  {
    "id": "02200",
    "manifest_path": "data/manifests/the_stack_sample/sample_0829.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: cm-volume\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n    volumeMounts:\n    - name: config\n      mountPath: /mnt/config\n  volumes:\n  - name: config\n    configMap:\n      name: app-properties\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"nginx\" is using an invalid container image, \"nginx\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  }
]