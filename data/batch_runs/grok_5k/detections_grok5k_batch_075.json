[
  {
    "id": "03001",
    "manifest_path": "data/manifests/the_stack_sample/sample_1226.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: micro-network\n  labels:\n    micro: runtime\n    name: micro-network\n  annotations:\n    name: go.micro.network\n    version: latest\n    source: github.com/itzmanish/micro\n    owner: micro\n    group: micro\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: micro-network\n      micro: runtime\n  template:\n    metadata:\n      labels:\n        name: micro-network\n        micro: runtime\n    spec:\n      affinity:\n        podAntiAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - weight: 100\n            podAffinityTerm:\n              labelSelector:\n                matchExpressions:\n                - key: name\n                  operator: In\n                  values:\n                  - micro-network\n              topologyKey: kubernetes.io/hostname\n      volumes:\n      - name: shared-data\n        emptyDir: {}\n      containers:\n      - name: network\n        env:\n        - name: MICRO_NETWORK_TOKEN\n          value: micro.mu\n        - name: MICRO_NETWORK_ADVERTISE_STRATEGY\n          value: best\n        - name: MICRO_LOG_LEVEL\n          value: debug\n        - name: MICRO_BROKER\n          value: nats\n        - name: MICRO_BROKER_ADDRESS\n          value: nats-cluster\n        - name: MICRO_REGISTRY\n          value: etcd\n        - name: MICRO_REGISTRY_ADDRESS\n          value: etcd-cluster-client\n        - name: MICRO_SERVER_ADDRESS\n          value: 0.0.0.0:8080\n        args:\n        - network\n        image: micro/micro\n        imagePullPolicy: Always\n        ports:\n        - containerPort: 8080\n          name: service-port\n        - containerPort: 8085\n          name: network-port\n          protocol: UDP\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"network\" has cpu request 0"
  },
  {
    "id": "03002",
    "manifest_path": "data/manifests/the_stack_sample/sample_1226.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: micro-network\n  labels:\n    micro: runtime\n    name: micro-network\n  annotations:\n    name: go.micro.network\n    version: latest\n    source: github.com/itzmanish/micro\n    owner: micro\n    group: micro\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: micro-network\n      micro: runtime\n  template:\n    metadata:\n      labels:\n        name: micro-network\n        micro: runtime\n    spec:\n      affinity:\n        podAntiAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - weight: 100\n            podAffinityTerm:\n              labelSelector:\n                matchExpressions:\n                - key: name\n                  operator: In\n                  values:\n                  - micro-network\n              topologyKey: kubernetes.io/hostname\n      volumes:\n      - name: shared-data\n        emptyDir: {}\n      containers:\n      - name: network\n        env:\n        - name: MICRO_NETWORK_TOKEN\n          value: micro.mu\n        - name: MICRO_NETWORK_ADVERTISE_STRATEGY\n          value: best\n        - name: MICRO_LOG_LEVEL\n          value: debug\n        - name: MICRO_BROKER\n          value: nats\n        - name: MICRO_BROKER_ADDRESS\n          value: nats-cluster\n        - name: MICRO_REGISTRY\n          value: etcd\n        - name: MICRO_REGISTRY_ADDRESS\n          value: etcd-cluster-client\n        - name: MICRO_SERVER_ADDRESS\n          value: 0.0.0.0:8080\n        args:\n        - network\n        image: micro/micro\n        imagePullPolicy: Always\n        ports:\n        - containerPort: 8080\n          name: service-port\n        - containerPort: 8085\n          name: network-port\n          protocol: UDP\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"network\" has memory limit 0"
  },
  {
    "id": "03003",
    "manifest_path": "data/manifests/the_stack_sample/sample_1227.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: nvidia-driver-installer\n  namespace: kube-system\n  labels:\n    k8s-app: nvidia-driver-installer\nspec:\n  selector:\n    matchLabels:\n      k8s-app: nvidia-driver-installer\n  template:\n    metadata:\n      labels:\n        name: nvidia-driver-installer\n        k8s-app: nvidia-driver-installer\n    spec:\n      affinity:\n        nodeAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n            nodeSelectorTerms:\n            - matchExpressions:\n              - key: cloud.google.com/gke-accelerator\n                operator: Exists\n      volumes:\n      - name: dev\n        hostPath:\n          path: /dev\n      - name: vulkan-icd-mount\n        hostPath:\n          path: /home/kubernetes/bin/nvidia/vulkan/icd.d\n      - name: nvidia-install-dir-host\n        hostPath:\n          path: /home/kubernetes/bin/nvidia\n      - name: root-mount\n        hostPath:\n          path: /\n      initContainers:\n      - image: gcr.io/cos-cloud/cos-gpu-installer@sha256:8d86a652759f80595cafed7d3dcde3dc53f57f9bc1e33b27bc3cfa7afea8d483\n        name: nvidia-driver-installer\n        resources:\n          requests:\n            cpu: '0.15'\n        securityContext:\n          privileged: true\n        env:\n        - name: NVIDIA_INSTALL_DIR_HOST\n          value: /home/kubernetes/bin/nvidia\n        - name: NVIDIA_INSTALL_DIR_CONTAINER\n          value: /usr/local/nvidia\n        - name: VULKAN_ICD_DIR_HOST\n          value: /home/kubernetes/bin/nvidia/vulkan/icd.d\n        - name: VULKAN_ICD_DIR_CONTAINER\n          value: /etc/vulkan/icd.d\n        - name: ROOT_MOUNT_DIR\n          value: /root\n        - name: NVIDIA_DRIVER_VERSION\n          value: 450.51.06\n        volumeMounts:\n        - name: nvidia-install-dir-host\n          mountPath: /usr/local/nvidia\n        - name: vulkan-icd-mount\n          mountPath: /etc/vulkan/icd.d\n        - name: dev\n          mountPath: /dev\n        - name: root-mount\n          mountPath: /root\n      containers:\n      - image: gcr.io/google-containers/pause:2.0\n        name: pause\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"nvidia-driver-installer\" does not have a read-only root file system"
  },
  {
    "id": "03004",
    "manifest_path": "data/manifests/the_stack_sample/sample_1227.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: nvidia-driver-installer\n  namespace: kube-system\n  labels:\n    k8s-app: nvidia-driver-installer\nspec:\n  selector:\n    matchLabels:\n      k8s-app: nvidia-driver-installer\n  template:\n    metadata:\n      labels:\n        name: nvidia-driver-installer\n        k8s-app: nvidia-driver-installer\n    spec:\n      affinity:\n        nodeAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n            nodeSelectorTerms:\n            - matchExpressions:\n              - key: cloud.google.com/gke-accelerator\n                operator: Exists\n      volumes:\n      - name: dev\n        hostPath:\n          path: /dev\n      - name: vulkan-icd-mount\n        hostPath:\n          path: /home/kubernetes/bin/nvidia/vulkan/icd.d\n      - name: nvidia-install-dir-host\n        hostPath:\n          path: /home/kubernetes/bin/nvidia\n      - name: root-mount\n        hostPath:\n          path: /\n      initContainers:\n      - image: gcr.io/cos-cloud/cos-gpu-installer@sha256:8d86a652759f80595cafed7d3dcde3dc53f57f9bc1e33b27bc3cfa7afea8d483\n        name: nvidia-driver-installer\n        resources:\n          requests:\n            cpu: '0.15'\n        securityContext:\n          privileged: true\n        env:\n        - name: NVIDIA_INSTALL_DIR_HOST\n          value: /home/kubernetes/bin/nvidia\n        - name: NVIDIA_INSTALL_DIR_CONTAINER\n          value: /usr/local/nvidia\n        - name: VULKAN_ICD_DIR_HOST\n          value: /home/kubernetes/bin/nvidia/vulkan/icd.d\n        - name: VULKAN_ICD_DIR_CONTAINER\n          value: /etc/vulkan/icd.d\n        - name: ROOT_MOUNT_DIR\n          value: /root\n        - name: NVIDIA_DRIVER_VERSION\n          value: 450.51.06\n        volumeMounts:\n        - name: nvidia-install-dir-host\n          mountPath: /usr/local/nvidia\n        - name: vulkan-icd-mount\n          mountPath: /etc/vulkan/icd.d\n        - name: dev\n          mountPath: /dev\n        - name: root-mount\n          mountPath: /root\n      containers:\n      - image: gcr.io/google-containers/pause:2.0\n        name: pause\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"pause\" does not have a read-only root file system"
  },
  {
    "id": "03005",
    "manifest_path": "data/manifests/the_stack_sample/sample_1227.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: nvidia-driver-installer\n  namespace: kube-system\n  labels:\n    k8s-app: nvidia-driver-installer\nspec:\n  selector:\n    matchLabels:\n      k8s-app: nvidia-driver-installer\n  template:\n    metadata:\n      labels:\n        name: nvidia-driver-installer\n        k8s-app: nvidia-driver-installer\n    spec:\n      affinity:\n        nodeAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n            nodeSelectorTerms:\n            - matchExpressions:\n              - key: cloud.google.com/gke-accelerator\n                operator: Exists\n      volumes:\n      - name: dev\n        hostPath:\n          path: /dev\n      - name: vulkan-icd-mount\n        hostPath:\n          path: /home/kubernetes/bin/nvidia/vulkan/icd.d\n      - name: nvidia-install-dir-host\n        hostPath:\n          path: /home/kubernetes/bin/nvidia\n      - name: root-mount\n        hostPath:\n          path: /\n      initContainers:\n      - image: gcr.io/cos-cloud/cos-gpu-installer@sha256:8d86a652759f80595cafed7d3dcde3dc53f57f9bc1e33b27bc3cfa7afea8d483\n        name: nvidia-driver-installer\n        resources:\n          requests:\n            cpu: '0.15'\n        securityContext:\n          privileged: true\n        env:\n        - name: NVIDIA_INSTALL_DIR_HOST\n          value: /home/kubernetes/bin/nvidia\n        - name: NVIDIA_INSTALL_DIR_CONTAINER\n          value: /usr/local/nvidia\n        - name: VULKAN_ICD_DIR_HOST\n          value: /home/kubernetes/bin/nvidia/vulkan/icd.d\n        - name: VULKAN_ICD_DIR_CONTAINER\n          value: /etc/vulkan/icd.d\n        - name: ROOT_MOUNT_DIR\n          value: /root\n        - name: NVIDIA_DRIVER_VERSION\n          value: 450.51.06\n        volumeMounts:\n        - name: nvidia-install-dir-host\n          mountPath: /usr/local/nvidia\n        - name: vulkan-icd-mount\n          mountPath: /etc/vulkan/icd.d\n        - name: dev\n          mountPath: /dev\n        - name: root-mount\n          mountPath: /root\n      containers:\n      - image: gcr.io/google-containers/pause:2.0\n        name: pause\n",
    "policy_id": "privilege-escalation-container",
    "violation_text": "container \"nvidia-driver-installer\" is Privileged hence allows privilege escalation."
  },
  {
    "id": "03006",
    "manifest_path": "data/manifests/the_stack_sample/sample_1227.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: nvidia-driver-installer\n  namespace: kube-system\n  labels:\n    k8s-app: nvidia-driver-installer\nspec:\n  selector:\n    matchLabels:\n      k8s-app: nvidia-driver-installer\n  template:\n    metadata:\n      labels:\n        name: nvidia-driver-installer\n        k8s-app: nvidia-driver-installer\n    spec:\n      affinity:\n        nodeAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n            nodeSelectorTerms:\n            - matchExpressions:\n              - key: cloud.google.com/gke-accelerator\n                operator: Exists\n      volumes:\n      - name: dev\n        hostPath:\n          path: /dev\n      - name: vulkan-icd-mount\n        hostPath:\n          path: /home/kubernetes/bin/nvidia/vulkan/icd.d\n      - name: nvidia-install-dir-host\n        hostPath:\n          path: /home/kubernetes/bin/nvidia\n      - name: root-mount\n        hostPath:\n          path: /\n      initContainers:\n      - image: gcr.io/cos-cloud/cos-gpu-installer@sha256:8d86a652759f80595cafed7d3dcde3dc53f57f9bc1e33b27bc3cfa7afea8d483\n        name: nvidia-driver-installer\n        resources:\n          requests:\n            cpu: '0.15'\n        securityContext:\n          privileged: true\n        env:\n        - name: NVIDIA_INSTALL_DIR_HOST\n          value: /home/kubernetes/bin/nvidia\n        - name: NVIDIA_INSTALL_DIR_CONTAINER\n          value: /usr/local/nvidia\n        - name: VULKAN_ICD_DIR_HOST\n          value: /home/kubernetes/bin/nvidia/vulkan/icd.d\n        - name: VULKAN_ICD_DIR_CONTAINER\n          value: /etc/vulkan/icd.d\n        - name: ROOT_MOUNT_DIR\n          value: /root\n        - name: NVIDIA_DRIVER_VERSION\n          value: 450.51.06\n        volumeMounts:\n        - name: nvidia-install-dir-host\n          mountPath: /usr/local/nvidia\n        - name: vulkan-icd-mount\n          mountPath: /etc/vulkan/icd.d\n        - name: dev\n          mountPath: /dev\n        - name: root-mount\n          mountPath: /root\n      containers:\n      - image: gcr.io/google-containers/pause:2.0\n        name: pause\n",
    "policy_id": "privileged-container",
    "violation_text": "container \"nvidia-driver-installer\" is privileged"
  },
  {
    "id": "03007",
    "manifest_path": "data/manifests/the_stack_sample/sample_1227.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: nvidia-driver-installer\n  namespace: kube-system\n  labels:\n    k8s-app: nvidia-driver-installer\nspec:\n  selector:\n    matchLabels:\n      k8s-app: nvidia-driver-installer\n  template:\n    metadata:\n      labels:\n        name: nvidia-driver-installer\n        k8s-app: nvidia-driver-installer\n    spec:\n      affinity:\n        nodeAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n            nodeSelectorTerms:\n            - matchExpressions:\n              - key: cloud.google.com/gke-accelerator\n                operator: Exists\n      volumes:\n      - name: dev\n        hostPath:\n          path: /dev\n      - name: vulkan-icd-mount\n        hostPath:\n          path: /home/kubernetes/bin/nvidia/vulkan/icd.d\n      - name: nvidia-install-dir-host\n        hostPath:\n          path: /home/kubernetes/bin/nvidia\n      - name: root-mount\n        hostPath:\n          path: /\n      initContainers:\n      - image: gcr.io/cos-cloud/cos-gpu-installer@sha256:8d86a652759f80595cafed7d3dcde3dc53f57f9bc1e33b27bc3cfa7afea8d483\n        name: nvidia-driver-installer\n        resources:\n          requests:\n            cpu: '0.15'\n        securityContext:\n          privileged: true\n        env:\n        - name: NVIDIA_INSTALL_DIR_HOST\n          value: /home/kubernetes/bin/nvidia\n        - name: NVIDIA_INSTALL_DIR_CONTAINER\n          value: /usr/local/nvidia\n        - name: VULKAN_ICD_DIR_HOST\n          value: /home/kubernetes/bin/nvidia/vulkan/icd.d\n        - name: VULKAN_ICD_DIR_CONTAINER\n          value: /etc/vulkan/icd.d\n        - name: ROOT_MOUNT_DIR\n          value: /root\n        - name: NVIDIA_DRIVER_VERSION\n          value: 450.51.06\n        volumeMounts:\n        - name: nvidia-install-dir-host\n          mountPath: /usr/local/nvidia\n        - name: vulkan-icd-mount\n          mountPath: /etc/vulkan/icd.d\n        - name: dev\n          mountPath: /dev\n        - name: root-mount\n          mountPath: /root\n      containers:\n      - image: gcr.io/google-containers/pause:2.0\n        name: pause\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"nvidia-driver-installer\" is not set to runAsNonRoot"
  },
  {
    "id": "03008",
    "manifest_path": "data/manifests/the_stack_sample/sample_1227.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: nvidia-driver-installer\n  namespace: kube-system\n  labels:\n    k8s-app: nvidia-driver-installer\nspec:\n  selector:\n    matchLabels:\n      k8s-app: nvidia-driver-installer\n  template:\n    metadata:\n      labels:\n        name: nvidia-driver-installer\n        k8s-app: nvidia-driver-installer\n    spec:\n      affinity:\n        nodeAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n            nodeSelectorTerms:\n            - matchExpressions:\n              - key: cloud.google.com/gke-accelerator\n                operator: Exists\n      volumes:\n      - name: dev\n        hostPath:\n          path: /dev\n      - name: vulkan-icd-mount\n        hostPath:\n          path: /home/kubernetes/bin/nvidia/vulkan/icd.d\n      - name: nvidia-install-dir-host\n        hostPath:\n          path: /home/kubernetes/bin/nvidia\n      - name: root-mount\n        hostPath:\n          path: /\n      initContainers:\n      - image: gcr.io/cos-cloud/cos-gpu-installer@sha256:8d86a652759f80595cafed7d3dcde3dc53f57f9bc1e33b27bc3cfa7afea8d483\n        name: nvidia-driver-installer\n        resources:\n          requests:\n            cpu: '0.15'\n        securityContext:\n          privileged: true\n        env:\n        - name: NVIDIA_INSTALL_DIR_HOST\n          value: /home/kubernetes/bin/nvidia\n        - name: NVIDIA_INSTALL_DIR_CONTAINER\n          value: /usr/local/nvidia\n        - name: VULKAN_ICD_DIR_HOST\n          value: /home/kubernetes/bin/nvidia/vulkan/icd.d\n        - name: VULKAN_ICD_DIR_CONTAINER\n          value: /etc/vulkan/icd.d\n        - name: ROOT_MOUNT_DIR\n          value: /root\n        - name: NVIDIA_DRIVER_VERSION\n          value: 450.51.06\n        volumeMounts:\n        - name: nvidia-install-dir-host\n          mountPath: /usr/local/nvidia\n        - name: vulkan-icd-mount\n          mountPath: /etc/vulkan/icd.d\n        - name: dev\n          mountPath: /dev\n        - name: root-mount\n          mountPath: /root\n      containers:\n      - image: gcr.io/google-containers/pause:2.0\n        name: pause\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"pause\" is not set to runAsNonRoot"
  },
  {
    "id": "03009",
    "manifest_path": "data/manifests/the_stack_sample/sample_1227.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: nvidia-driver-installer\n  namespace: kube-system\n  labels:\n    k8s-app: nvidia-driver-installer\nspec:\n  selector:\n    matchLabels:\n      k8s-app: nvidia-driver-installer\n  template:\n    metadata:\n      labels:\n        name: nvidia-driver-installer\n        k8s-app: nvidia-driver-installer\n    spec:\n      affinity:\n        nodeAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n            nodeSelectorTerms:\n            - matchExpressions:\n              - key: cloud.google.com/gke-accelerator\n                operator: Exists\n      volumes:\n      - name: dev\n        hostPath:\n          path: /dev\n      - name: vulkan-icd-mount\n        hostPath:\n          path: /home/kubernetes/bin/nvidia/vulkan/icd.d\n      - name: nvidia-install-dir-host\n        hostPath:\n          path: /home/kubernetes/bin/nvidia\n      - name: root-mount\n        hostPath:\n          path: /\n      initContainers:\n      - image: gcr.io/cos-cloud/cos-gpu-installer@sha256:8d86a652759f80595cafed7d3dcde3dc53f57f9bc1e33b27bc3cfa7afea8d483\n        name: nvidia-driver-installer\n        resources:\n          requests:\n            cpu: '0.15'\n        securityContext:\n          privileged: true\n        env:\n        - name: NVIDIA_INSTALL_DIR_HOST\n          value: /home/kubernetes/bin/nvidia\n        - name: NVIDIA_INSTALL_DIR_CONTAINER\n          value: /usr/local/nvidia\n        - name: VULKAN_ICD_DIR_HOST\n          value: /home/kubernetes/bin/nvidia/vulkan/icd.d\n        - name: VULKAN_ICD_DIR_CONTAINER\n          value: /etc/vulkan/icd.d\n        - name: ROOT_MOUNT_DIR\n          value: /root\n        - name: NVIDIA_DRIVER_VERSION\n          value: 450.51.06\n        volumeMounts:\n        - name: nvidia-install-dir-host\n          mountPath: /usr/local/nvidia\n        - name: vulkan-icd-mount\n          mountPath: /etc/vulkan/icd.d\n        - name: dev\n          mountPath: /dev\n        - name: root-mount\n          mountPath: /root\n      containers:\n      - image: gcr.io/google-containers/pause:2.0\n        name: pause\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"pause\" has cpu request 0"
  },
  {
    "id": "03010",
    "manifest_path": "data/manifests/the_stack_sample/sample_1227.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: nvidia-driver-installer\n  namespace: kube-system\n  labels:\n    k8s-app: nvidia-driver-installer\nspec:\n  selector:\n    matchLabels:\n      k8s-app: nvidia-driver-installer\n  template:\n    metadata:\n      labels:\n        name: nvidia-driver-installer\n        k8s-app: nvidia-driver-installer\n    spec:\n      affinity:\n        nodeAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n            nodeSelectorTerms:\n            - matchExpressions:\n              - key: cloud.google.com/gke-accelerator\n                operator: Exists\n      volumes:\n      - name: dev\n        hostPath:\n          path: /dev\n      - name: vulkan-icd-mount\n        hostPath:\n          path: /home/kubernetes/bin/nvidia/vulkan/icd.d\n      - name: nvidia-install-dir-host\n        hostPath:\n          path: /home/kubernetes/bin/nvidia\n      - name: root-mount\n        hostPath:\n          path: /\n      initContainers:\n      - image: gcr.io/cos-cloud/cos-gpu-installer@sha256:8d86a652759f80595cafed7d3dcde3dc53f57f9bc1e33b27bc3cfa7afea8d483\n        name: nvidia-driver-installer\n        resources:\n          requests:\n            cpu: '0.15'\n        securityContext:\n          privileged: true\n        env:\n        - name: NVIDIA_INSTALL_DIR_HOST\n          value: /home/kubernetes/bin/nvidia\n        - name: NVIDIA_INSTALL_DIR_CONTAINER\n          value: /usr/local/nvidia\n        - name: VULKAN_ICD_DIR_HOST\n          value: /home/kubernetes/bin/nvidia/vulkan/icd.d\n        - name: VULKAN_ICD_DIR_CONTAINER\n          value: /etc/vulkan/icd.d\n        - name: ROOT_MOUNT_DIR\n          value: /root\n        - name: NVIDIA_DRIVER_VERSION\n          value: 450.51.06\n        volumeMounts:\n        - name: nvidia-install-dir-host\n          mountPath: /usr/local/nvidia\n        - name: vulkan-icd-mount\n          mountPath: /etc/vulkan/icd.d\n        - name: dev\n          mountPath: /dev\n        - name: root-mount\n          mountPath: /root\n      containers:\n      - image: gcr.io/google-containers/pause:2.0\n        name: pause\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"nvidia-driver-installer\" has memory limit 0"
  },
  {
    "id": "03011",
    "manifest_path": "data/manifests/the_stack_sample/sample_1227.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: nvidia-driver-installer\n  namespace: kube-system\n  labels:\n    k8s-app: nvidia-driver-installer\nspec:\n  selector:\n    matchLabels:\n      k8s-app: nvidia-driver-installer\n  template:\n    metadata:\n      labels:\n        name: nvidia-driver-installer\n        k8s-app: nvidia-driver-installer\n    spec:\n      affinity:\n        nodeAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n            nodeSelectorTerms:\n            - matchExpressions:\n              - key: cloud.google.com/gke-accelerator\n                operator: Exists\n      volumes:\n      - name: dev\n        hostPath:\n          path: /dev\n      - name: vulkan-icd-mount\n        hostPath:\n          path: /home/kubernetes/bin/nvidia/vulkan/icd.d\n      - name: nvidia-install-dir-host\n        hostPath:\n          path: /home/kubernetes/bin/nvidia\n      - name: root-mount\n        hostPath:\n          path: /\n      initContainers:\n      - image: gcr.io/cos-cloud/cos-gpu-installer@sha256:8d86a652759f80595cafed7d3dcde3dc53f57f9bc1e33b27bc3cfa7afea8d483\n        name: nvidia-driver-installer\n        resources:\n          requests:\n            cpu: '0.15'\n        securityContext:\n          privileged: true\n        env:\n        - name: NVIDIA_INSTALL_DIR_HOST\n          value: /home/kubernetes/bin/nvidia\n        - name: NVIDIA_INSTALL_DIR_CONTAINER\n          value: /usr/local/nvidia\n        - name: VULKAN_ICD_DIR_HOST\n          value: /home/kubernetes/bin/nvidia/vulkan/icd.d\n        - name: VULKAN_ICD_DIR_CONTAINER\n          value: /etc/vulkan/icd.d\n        - name: ROOT_MOUNT_DIR\n          value: /root\n        - name: NVIDIA_DRIVER_VERSION\n          value: 450.51.06\n        volumeMounts:\n        - name: nvidia-install-dir-host\n          mountPath: /usr/local/nvidia\n        - name: vulkan-icd-mount\n          mountPath: /etc/vulkan/icd.d\n        - name: dev\n          mountPath: /dev\n        - name: root-mount\n          mountPath: /root\n      containers:\n      - image: gcr.io/google-containers/pause:2.0\n        name: pause\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"pause\" has memory limit 0"
  },
  {
    "id": "03012",
    "manifest_path": "data/manifests/the_stack_sample/sample_1228.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-7863\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"nginx\" is using an invalid container image, \"nginx\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "03013",
    "manifest_path": "data/manifests/the_stack_sample/sample_1228.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-7863\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"nginx\" does not have a read-only root file system"
  },
  {
    "id": "03014",
    "manifest_path": "data/manifests/the_stack_sample/sample_1228.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-7863\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"nginx\" is not set to runAsNonRoot"
  },
  {
    "id": "03015",
    "manifest_path": "data/manifests/the_stack_sample/sample_1228.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-7863\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"nginx\" has cpu request 0"
  },
  {
    "id": "03016",
    "manifest_path": "data/manifests/the_stack_sample/sample_1228.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-7863\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"nginx\" has memory limit 0"
  },
  {
    "id": "03017",
    "manifest_path": "data/manifests/the_stack_sample/sample_1230.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: cherrypicker\n  labels:\n    app: cherrypicker\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: cherrypicker\n  template:\n    metadata:\n      labels:\n        app: cherrypicker\n    spec:\n      serviceAccountName: ''\n      serviceAccount: ''\n      containers:\n      - name: cherrypicker\n        image: gcr.io/k8s-prow/cherrypicker:v20220104-d6f21887c1\n        imagePullPolicy: Always\n        args:\n        - --github-token-path=/etc/github/token\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --dry-run=false\n        ports:\n        - name: http\n          containerPort: 8888\n        volumeMounts:\n        - name: hmac\n          mountPath: /etc/webhook\n          readOnly: true\n        - name: github-token\n          mountPath: /etc/github\n          readOnly: true\n        - name: tmp\n          mountPath: /tmp\n      volumes:\n      - name: tmp\n        emptyDir: {}\n      - name: hmac\n        secret:\n          secretName: hmac-token\n      - name: github-token\n        secret:\n          secretName: k8s-infra-cherrypick-robot-github-token\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"cherrypicker\" does not have a read-only root file system"
  },
  {
    "id": "03018",
    "manifest_path": "data/manifests/the_stack_sample/sample_1230.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: cherrypicker\n  labels:\n    app: cherrypicker\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: cherrypicker\n  template:\n    metadata:\n      labels:\n        app: cherrypicker\n    spec:\n      serviceAccountName: ''\n      serviceAccount: ''\n      containers:\n      - name: cherrypicker\n        image: gcr.io/k8s-prow/cherrypicker:v20220104-d6f21887c1\n        imagePullPolicy: Always\n        args:\n        - --github-token-path=/etc/github/token\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --dry-run=false\n        ports:\n        - name: http\n          containerPort: 8888\n        volumeMounts:\n        - name: hmac\n          mountPath: /etc/webhook\n          readOnly: true\n        - name: github-token\n          mountPath: /etc/github\n          readOnly: true\n        - name: tmp\n          mountPath: /tmp\n      volumes:\n      - name: tmp\n        emptyDir: {}\n      - name: hmac\n        secret:\n          secretName: hmac-token\n      - name: github-token\n        secret:\n          secretName: k8s-infra-cherrypick-robot-github-token\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"cherrypicker\" is not set to runAsNonRoot"
  },
  {
    "id": "03019",
    "manifest_path": "data/manifests/the_stack_sample/sample_1230.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: cherrypicker\n  labels:\n    app: cherrypicker\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: cherrypicker\n  template:\n    metadata:\n      labels:\n        app: cherrypicker\n    spec:\n      serviceAccountName: ''\n      serviceAccount: ''\n      containers:\n      - name: cherrypicker\n        image: gcr.io/k8s-prow/cherrypicker:v20220104-d6f21887c1\n        imagePullPolicy: Always\n        args:\n        - --github-token-path=/etc/github/token\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --dry-run=false\n        ports:\n        - name: http\n          containerPort: 8888\n        volumeMounts:\n        - name: hmac\n          mountPath: /etc/webhook\n          readOnly: true\n        - name: github-token\n          mountPath: /etc/github\n          readOnly: true\n        - name: tmp\n          mountPath: /tmp\n      volumes:\n      - name: tmp\n        emptyDir: {}\n      - name: hmac\n        secret:\n          secretName: hmac-token\n      - name: github-token\n        secret:\n          secretName: k8s-infra-cherrypick-robot-github-token\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"cherrypicker\" has cpu request 0"
  },
  {
    "id": "03020",
    "manifest_path": "data/manifests/the_stack_sample/sample_1230.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: cherrypicker\n  labels:\n    app: cherrypicker\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: cherrypicker\n  template:\n    metadata:\n      labels:\n        app: cherrypicker\n    spec:\n      serviceAccountName: ''\n      serviceAccount: ''\n      containers:\n      - name: cherrypicker\n        image: gcr.io/k8s-prow/cherrypicker:v20220104-d6f21887c1\n        imagePullPolicy: Always\n        args:\n        - --github-token-path=/etc/github/token\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --dry-run=false\n        ports:\n        - name: http\n          containerPort: 8888\n        volumeMounts:\n        - name: hmac\n          mountPath: /etc/webhook\n          readOnly: true\n        - name: github-token\n          mountPath: /etc/github\n          readOnly: true\n        - name: tmp\n          mountPath: /tmp\n      volumes:\n      - name: tmp\n        emptyDir: {}\n      - name: hmac\n        secret:\n          secretName: hmac-token\n      - name: github-token\n        secret:\n          secretName: k8s-infra-cherrypick-robot-github-token\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"cherrypicker\" has memory limit 0"
  },
  {
    "id": "03021",
    "manifest_path": "data/manifests/the_stack_sample/sample_1244.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: ingress-bootstrap\nspec:\n  template:\n    spec:\n      containers:\n      - command:\n        - /var/ingress-config/ingress_bootstrap.sh\n        env:\n        - name: NAMESPACE\n          value: kubeflow\n        - name: TLS_SECRET_NAME\n          value: envoy-ingress-tls\n        - name: TLS_HOST_NAME\n          value: kubeflow.endpoints.constant-cubist-173123.cloud.goog\n        - name: INGRESS_NAME\n          value: envoy-ingress\n        image: gcr.io/kubeflow-images-public/ingress-setup:latest\n        name: bootstrap\n        volumeMounts:\n        - mountPath: /var/ingress-config/\n          name: ingress-config\n      serviceAccountName: envoy\n      volumes:\n      - configMap:\n          defaultMode: 493\n          name: ingress-bootstrap-config\n        name: ingress-config\n",
    "policy_id": "env-var-secret",
    "violation_text": "environment variable TLS_SECRET_NAME in container \"bootstrap\" found"
  },
  {
    "id": "03022",
    "manifest_path": "data/manifests/the_stack_sample/sample_1244.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: ingress-bootstrap\nspec:\n  template:\n    spec:\n      containers:\n      - command:\n        - /var/ingress-config/ingress_bootstrap.sh\n        env:\n        - name: NAMESPACE\n          value: kubeflow\n        - name: TLS_SECRET_NAME\n          value: envoy-ingress-tls\n        - name: TLS_HOST_NAME\n          value: kubeflow.endpoints.constant-cubist-173123.cloud.goog\n        - name: INGRESS_NAME\n          value: envoy-ingress\n        image: gcr.io/kubeflow-images-public/ingress-setup:latest\n        name: bootstrap\n        volumeMounts:\n        - mountPath: /var/ingress-config/\n          name: ingress-config\n      serviceAccountName: envoy\n      volumes:\n      - configMap:\n          defaultMode: 493\n          name: ingress-bootstrap-config\n        name: ingress-config\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"bootstrap\" is using an invalid container image, \"gcr.io/kubeflow-images-public/ingress-setup:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "03023",
    "manifest_path": "data/manifests/the_stack_sample/sample_1244.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: ingress-bootstrap\nspec:\n  template:\n    spec:\n      containers:\n      - command:\n        - /var/ingress-config/ingress_bootstrap.sh\n        env:\n        - name: NAMESPACE\n          value: kubeflow\n        - name: TLS_SECRET_NAME\n          value: envoy-ingress-tls\n        - name: TLS_HOST_NAME\n          value: kubeflow.endpoints.constant-cubist-173123.cloud.goog\n        - name: INGRESS_NAME\n          value: envoy-ingress\n        image: gcr.io/kubeflow-images-public/ingress-setup:latest\n        name: bootstrap\n        volumeMounts:\n        - mountPath: /var/ingress-config/\n          name: ingress-config\n      serviceAccountName: envoy\n      volumes:\n      - configMap:\n          defaultMode: 493\n          name: ingress-bootstrap-config\n        name: ingress-config\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"bootstrap\" does not have a read-only root file system"
  },
  {
    "id": "03024",
    "manifest_path": "data/manifests/the_stack_sample/sample_1244.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: ingress-bootstrap\nspec:\n  template:\n    spec:\n      containers:\n      - command:\n        - /var/ingress-config/ingress_bootstrap.sh\n        env:\n        - name: NAMESPACE\n          value: kubeflow\n        - name: TLS_SECRET_NAME\n          value: envoy-ingress-tls\n        - name: TLS_HOST_NAME\n          value: kubeflow.endpoints.constant-cubist-173123.cloud.goog\n        - name: INGRESS_NAME\n          value: envoy-ingress\n        image: gcr.io/kubeflow-images-public/ingress-setup:latest\n        name: bootstrap\n        volumeMounts:\n        - mountPath: /var/ingress-config/\n          name: ingress-config\n      serviceAccountName: envoy\n      volumes:\n      - configMap:\n          defaultMode: 493\n          name: ingress-bootstrap-config\n        name: ingress-config\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"bootstrap\" is not set to runAsNonRoot"
  },
  {
    "id": "03025",
    "manifest_path": "data/manifests/the_stack_sample/sample_1244.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: ingress-bootstrap\nspec:\n  template:\n    spec:\n      containers:\n      - command:\n        - /var/ingress-config/ingress_bootstrap.sh\n        env:\n        - name: NAMESPACE\n          value: kubeflow\n        - name: TLS_SECRET_NAME\n          value: envoy-ingress-tls\n        - name: TLS_HOST_NAME\n          value: kubeflow.endpoints.constant-cubist-173123.cloud.goog\n        - name: INGRESS_NAME\n          value: envoy-ingress\n        image: gcr.io/kubeflow-images-public/ingress-setup:latest\n        name: bootstrap\n        volumeMounts:\n        - mountPath: /var/ingress-config/\n          name: ingress-config\n      serviceAccountName: envoy\n      volumes:\n      - configMap:\n          defaultMode: 493\n          name: ingress-bootstrap-config\n        name: ingress-config\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"bootstrap\" has cpu request 0"
  },
  {
    "id": "03026",
    "manifest_path": "data/manifests/the_stack_sample/sample_1244.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: ingress-bootstrap\nspec:\n  template:\n    spec:\n      containers:\n      - command:\n        - /var/ingress-config/ingress_bootstrap.sh\n        env:\n        - name: NAMESPACE\n          value: kubeflow\n        - name: TLS_SECRET_NAME\n          value: envoy-ingress-tls\n        - name: TLS_HOST_NAME\n          value: kubeflow.endpoints.constant-cubist-173123.cloud.goog\n        - name: INGRESS_NAME\n          value: envoy-ingress\n        image: gcr.io/kubeflow-images-public/ingress-setup:latest\n        name: bootstrap\n        volumeMounts:\n        - mountPath: /var/ingress-config/\n          name: ingress-config\n      serviceAccountName: envoy\n      volumes:\n      - configMap:\n          defaultMode: 493\n          name: ingress-bootstrap-config\n        name: ingress-config\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"bootstrap\" has memory limit 0"
  },
  {
    "id": "03027",
    "manifest_path": "data/manifests/the_stack_sample/sample_1247.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: strimzi-cluster-operator\n  labels:\n    app: strimzi\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: strimzi-cluster-operator\n      strimzi.io/kind: cluster-operator\n  template:\n    metadata:\n      labels:\n        name: strimzi-cluster-operator\n        strimzi.io/kind: cluster-operator\n    spec:\n      serviceAccountName: strimzi-cluster-operator\n      volumes:\n      - name: strimzi-tmp\n        emptyDir:\n          medium: Memory\n          sizeLimit: 1Mi\n      - name: co-config-volume\n        configMap:\n          name: strimzi-cluster-operator\n      containers:\n      - name: strimzi-cluster-operator\n        image: quay.io/strimzi/operator:latest\n        ports:\n        - containerPort: 8080\n          name: http\n        args:\n        - /opt/strimzi/bin/cluster_operator_run.sh\n        volumeMounts:\n        - name: strimzi-tmp\n          mountPath: /tmp\n        - name: co-config-volume\n          mountPath: /opt/strimzi/custom-config/\n        env:\n        - name: STRIMZI_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: STRIMZI_FULL_RECONCILIATION_INTERVAL_MS\n          value: '120000'\n        - name: STRIMZI_OPERATION_TIMEOUT_MS\n          value: '300000'\n        - name: STRIMZI_DEFAULT_TLS_SIDECAR_ENTITY_OPERATOR_IMAGE\n          value: quay.io/strimzi/kafka:latest-kafka-3.0.0\n        - name: STRIMZI_DEFAULT_KAFKA_EXPORTER_IMAGE\n          value: quay.io/strimzi/kafka:latest-kafka-3.0.0\n        - name: STRIMZI_DEFAULT_CRUISE_CONTROL_IMAGE\n          value: quay.io/strimzi/kafka:latest-kafka-3.0.0\n        - name: STRIMZI_DEFAULT_TLS_SIDECAR_CRUISE_CONTROL_IMAGE\n          value: quay.io/strimzi/kafka:latest-kafka-3.0.0\n        - name: STRIMZI_KAFKA_IMAGES\n          value: '2.8.0=quay.io/strimzi/kafka:latest-kafka-2.8.0\n\n            2.8.1=quay.io/strimzi/kafka:latest-kafka-2.8.1\n\n            3.0.0=quay.io/strimzi/kafka:latest-kafka-3.0.0\n\n            '\n        - name: STRIMZI_KAFKA_CONNECT_IMAGES\n          value: '2.8.0=quay.io/strimzi/kafka:latest-kafka-2.8.0\n\n            2.8.1=quay.io/strimzi/kafka:latest-kafka-2.8.1\n\n            3.0.0=quay.io/strimzi/kafka:latest-kafka-3.0.0\n\n            '\n        - name: STRIMZI_KAFKA_MIRROR_MAKER_IMAGES\n          value: '2.8.0=quay.io/strimzi/kafka:latest-kafka-2.8.0\n\n            2.8.1=quay.io/strimzi/kafka:latest-kafka-2.8.1\n\n            3.0.0=quay.io/strimzi/kafka:latest-kafka-3.0.0\n\n            '\n        - name: STRIMZI_KAFKA_MIRROR_MAKER_2_IMAGES\n          value: '2.8.0=quay.io/strimzi/kafka:latest-kafka-2.8.0\n\n            2.8.1=quay.io/strimzi/kafka:latest-kafka-2.8.1\n\n            3.0.0=quay.io/strimzi/kafka:latest-kafka-3.0.0\n\n            '\n        - name: STRIMZI_DEFAULT_TOPIC_OPERATOR_IMAGE\n          value: quay.io/strimzi/operator:latest\n        - name: STRIMZI_DEFAULT_USER_OPERATOR_IMAGE\n          value: quay.io/strimzi/operator:latest\n        - name: STRIMZI_DEFAULT_KAFKA_INIT_IMAGE\n          value: quay.io/strimzi/operator:latest\n        - name: STRIMZI_DEFAULT_KAFKA_BRIDGE_IMAGE\n          value: quay.io/strimzi/kafka-bridge:0.20.2\n        - name: STRIMZI_DEFAULT_JMXTRANS_IMAGE\n          value: quay.io/strimzi/jmxtrans:latest\n        - name: STRIMZI_DEFAULT_KANIKO_EXECUTOR_IMAGE\n          value: quay.io/strimzi/kaniko-executor:latest\n        - name: STRIMZI_DEFAULT_MAVEN_BUILDER\n          value: quay.io/strimzi/maven-builder:latest\n        - name: STRIMZI_OPERATOR_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: STRIMZI_FEATURE_GATES\n          value: ''\n        livenessProbe:\n          httpGet:\n            path: /healthy\n            port: http\n          initialDelaySeconds: 10\n          periodSeconds: 30\n        readinessProbe:\n          httpGet:\n            path: /ready\n            port: http\n          initialDelaySeconds: 10\n          periodSeconds: 30\n        resources:\n          limits:\n            cpu: 1000m\n            memory: 384Mi\n          requests:\n            cpu: 200m\n            memory: 384Mi\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"strimzi-cluster-operator\" is using an invalid container image, \"quay.io/strimzi/operator:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "03028",
    "manifest_path": "data/manifests/the_stack_sample/sample_1247.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: strimzi-cluster-operator\n  labels:\n    app: strimzi\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: strimzi-cluster-operator\n      strimzi.io/kind: cluster-operator\n  template:\n    metadata:\n      labels:\n        name: strimzi-cluster-operator\n        strimzi.io/kind: cluster-operator\n    spec:\n      serviceAccountName: strimzi-cluster-operator\n      volumes:\n      - name: strimzi-tmp\n        emptyDir:\n          medium: Memory\n          sizeLimit: 1Mi\n      - name: co-config-volume\n        configMap:\n          name: strimzi-cluster-operator\n      containers:\n      - name: strimzi-cluster-operator\n        image: quay.io/strimzi/operator:latest\n        ports:\n        - containerPort: 8080\n          name: http\n        args:\n        - /opt/strimzi/bin/cluster_operator_run.sh\n        volumeMounts:\n        - name: strimzi-tmp\n          mountPath: /tmp\n        - name: co-config-volume\n          mountPath: /opt/strimzi/custom-config/\n        env:\n        - name: STRIMZI_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: STRIMZI_FULL_RECONCILIATION_INTERVAL_MS\n          value: '120000'\n        - name: STRIMZI_OPERATION_TIMEOUT_MS\n          value: '300000'\n        - name: STRIMZI_DEFAULT_TLS_SIDECAR_ENTITY_OPERATOR_IMAGE\n          value: quay.io/strimzi/kafka:latest-kafka-3.0.0\n        - name: STRIMZI_DEFAULT_KAFKA_EXPORTER_IMAGE\n          value: quay.io/strimzi/kafka:latest-kafka-3.0.0\n        - name: STRIMZI_DEFAULT_CRUISE_CONTROL_IMAGE\n          value: quay.io/strimzi/kafka:latest-kafka-3.0.0\n        - name: STRIMZI_DEFAULT_TLS_SIDECAR_CRUISE_CONTROL_IMAGE\n          value: quay.io/strimzi/kafka:latest-kafka-3.0.0\n        - name: STRIMZI_KAFKA_IMAGES\n          value: '2.8.0=quay.io/strimzi/kafka:latest-kafka-2.8.0\n\n            2.8.1=quay.io/strimzi/kafka:latest-kafka-2.8.1\n\n            3.0.0=quay.io/strimzi/kafka:latest-kafka-3.0.0\n\n            '\n        - name: STRIMZI_KAFKA_CONNECT_IMAGES\n          value: '2.8.0=quay.io/strimzi/kafka:latest-kafka-2.8.0\n\n            2.8.1=quay.io/strimzi/kafka:latest-kafka-2.8.1\n\n            3.0.0=quay.io/strimzi/kafka:latest-kafka-3.0.0\n\n            '\n        - name: STRIMZI_KAFKA_MIRROR_MAKER_IMAGES\n          value: '2.8.0=quay.io/strimzi/kafka:latest-kafka-2.8.0\n\n            2.8.1=quay.io/strimzi/kafka:latest-kafka-2.8.1\n\n            3.0.0=quay.io/strimzi/kafka:latest-kafka-3.0.0\n\n            '\n        - name: STRIMZI_KAFKA_MIRROR_MAKER_2_IMAGES\n          value: '2.8.0=quay.io/strimzi/kafka:latest-kafka-2.8.0\n\n            2.8.1=quay.io/strimzi/kafka:latest-kafka-2.8.1\n\n            3.0.0=quay.io/strimzi/kafka:latest-kafka-3.0.0\n\n            '\n        - name: STRIMZI_DEFAULT_TOPIC_OPERATOR_IMAGE\n          value: quay.io/strimzi/operator:latest\n        - name: STRIMZI_DEFAULT_USER_OPERATOR_IMAGE\n          value: quay.io/strimzi/operator:latest\n        - name: STRIMZI_DEFAULT_KAFKA_INIT_IMAGE\n          value: quay.io/strimzi/operator:latest\n        - name: STRIMZI_DEFAULT_KAFKA_BRIDGE_IMAGE\n          value: quay.io/strimzi/kafka-bridge:0.20.2\n        - name: STRIMZI_DEFAULT_JMXTRANS_IMAGE\n          value: quay.io/strimzi/jmxtrans:latest\n        - name: STRIMZI_DEFAULT_KANIKO_EXECUTOR_IMAGE\n          value: quay.io/strimzi/kaniko-executor:latest\n        - name: STRIMZI_DEFAULT_MAVEN_BUILDER\n          value: quay.io/strimzi/maven-builder:latest\n        - name: STRIMZI_OPERATOR_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: STRIMZI_FEATURE_GATES\n          value: ''\n        livenessProbe:\n          httpGet:\n            path: /healthy\n            port: http\n          initialDelaySeconds: 10\n          periodSeconds: 30\n        readinessProbe:\n          httpGet:\n            path: /ready\n            port: http\n          initialDelaySeconds: 10\n          periodSeconds: 30\n        resources:\n          limits:\n            cpu: 1000m\n            memory: 384Mi\n          requests:\n            cpu: 200m\n            memory: 384Mi\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"strimzi-cluster-operator\" does not have a read-only root file system"
  },
  {
    "id": "03029",
    "manifest_path": "data/manifests/the_stack_sample/sample_1247.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: strimzi-cluster-operator\n  labels:\n    app: strimzi\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: strimzi-cluster-operator\n      strimzi.io/kind: cluster-operator\n  template:\n    metadata:\n      labels:\n        name: strimzi-cluster-operator\n        strimzi.io/kind: cluster-operator\n    spec:\n      serviceAccountName: strimzi-cluster-operator\n      volumes:\n      - name: strimzi-tmp\n        emptyDir:\n          medium: Memory\n          sizeLimit: 1Mi\n      - name: co-config-volume\n        configMap:\n          name: strimzi-cluster-operator\n      containers:\n      - name: strimzi-cluster-operator\n        image: quay.io/strimzi/operator:latest\n        ports:\n        - containerPort: 8080\n          name: http\n        args:\n        - /opt/strimzi/bin/cluster_operator_run.sh\n        volumeMounts:\n        - name: strimzi-tmp\n          mountPath: /tmp\n        - name: co-config-volume\n          mountPath: /opt/strimzi/custom-config/\n        env:\n        - name: STRIMZI_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: STRIMZI_FULL_RECONCILIATION_INTERVAL_MS\n          value: '120000'\n        - name: STRIMZI_OPERATION_TIMEOUT_MS\n          value: '300000'\n        - name: STRIMZI_DEFAULT_TLS_SIDECAR_ENTITY_OPERATOR_IMAGE\n          value: quay.io/strimzi/kafka:latest-kafka-3.0.0\n        - name: STRIMZI_DEFAULT_KAFKA_EXPORTER_IMAGE\n          value: quay.io/strimzi/kafka:latest-kafka-3.0.0\n        - name: STRIMZI_DEFAULT_CRUISE_CONTROL_IMAGE\n          value: quay.io/strimzi/kafka:latest-kafka-3.0.0\n        - name: STRIMZI_DEFAULT_TLS_SIDECAR_CRUISE_CONTROL_IMAGE\n          value: quay.io/strimzi/kafka:latest-kafka-3.0.0\n        - name: STRIMZI_KAFKA_IMAGES\n          value: '2.8.0=quay.io/strimzi/kafka:latest-kafka-2.8.0\n\n            2.8.1=quay.io/strimzi/kafka:latest-kafka-2.8.1\n\n            3.0.0=quay.io/strimzi/kafka:latest-kafka-3.0.0\n\n            '\n        - name: STRIMZI_KAFKA_CONNECT_IMAGES\n          value: '2.8.0=quay.io/strimzi/kafka:latest-kafka-2.8.0\n\n            2.8.1=quay.io/strimzi/kafka:latest-kafka-2.8.1\n\n            3.0.0=quay.io/strimzi/kafka:latest-kafka-3.0.0\n\n            '\n        - name: STRIMZI_KAFKA_MIRROR_MAKER_IMAGES\n          value: '2.8.0=quay.io/strimzi/kafka:latest-kafka-2.8.0\n\n            2.8.1=quay.io/strimzi/kafka:latest-kafka-2.8.1\n\n            3.0.0=quay.io/strimzi/kafka:latest-kafka-3.0.0\n\n            '\n        - name: STRIMZI_KAFKA_MIRROR_MAKER_2_IMAGES\n          value: '2.8.0=quay.io/strimzi/kafka:latest-kafka-2.8.0\n\n            2.8.1=quay.io/strimzi/kafka:latest-kafka-2.8.1\n\n            3.0.0=quay.io/strimzi/kafka:latest-kafka-3.0.0\n\n            '\n        - name: STRIMZI_DEFAULT_TOPIC_OPERATOR_IMAGE\n          value: quay.io/strimzi/operator:latest\n        - name: STRIMZI_DEFAULT_USER_OPERATOR_IMAGE\n          value: quay.io/strimzi/operator:latest\n        - name: STRIMZI_DEFAULT_KAFKA_INIT_IMAGE\n          value: quay.io/strimzi/operator:latest\n        - name: STRIMZI_DEFAULT_KAFKA_BRIDGE_IMAGE\n          value: quay.io/strimzi/kafka-bridge:0.20.2\n        - name: STRIMZI_DEFAULT_JMXTRANS_IMAGE\n          value: quay.io/strimzi/jmxtrans:latest\n        - name: STRIMZI_DEFAULT_KANIKO_EXECUTOR_IMAGE\n          value: quay.io/strimzi/kaniko-executor:latest\n        - name: STRIMZI_DEFAULT_MAVEN_BUILDER\n          value: quay.io/strimzi/maven-builder:latest\n        - name: STRIMZI_OPERATOR_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: STRIMZI_FEATURE_GATES\n          value: ''\n        livenessProbe:\n          httpGet:\n            path: /healthy\n            port: http\n          initialDelaySeconds: 10\n          periodSeconds: 30\n        readinessProbe:\n          httpGet:\n            path: /ready\n            port: http\n          initialDelaySeconds: 10\n          periodSeconds: 30\n        resources:\n          limits:\n            cpu: 1000m\n            memory: 384Mi\n          requests:\n            cpu: 200m\n            memory: 384Mi\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"strimzi-cluster-operator\" is not set to runAsNonRoot"
  },
  {
    "id": "03030",
    "manifest_path": "data/manifests/the_stack_sample/sample_1249.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    name: hello-node\n  name: hello-node\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: hello-node\n  template:\n    metadata:\n      labels:\n        name: hello-node\n    spec:\n      containers:\n      - image: asia.gcr.io/<project id>/hello-node:v1\n        name: hello-node\n        ports:\n        - containerPort: 8080\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"hello-node\" does not have a read-only root file system"
  },
  {
    "id": "03031",
    "manifest_path": "data/manifests/the_stack_sample/sample_1249.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    name: hello-node\n  name: hello-node\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: hello-node\n  template:\n    metadata:\n      labels:\n        name: hello-node\n    spec:\n      containers:\n      - image: asia.gcr.io/<project id>/hello-node:v1\n        name: hello-node\n        ports:\n        - containerPort: 8080\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"hello-node\" is not set to runAsNonRoot"
  },
  {
    "id": "03032",
    "manifest_path": "data/manifests/the_stack_sample/sample_1249.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    name: hello-node\n  name: hello-node\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: hello-node\n  template:\n    metadata:\n      labels:\n        name: hello-node\n    spec:\n      containers:\n      - image: asia.gcr.io/<project id>/hello-node:v1\n        name: hello-node\n        ports:\n        - containerPort: 8080\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"hello-node\" has cpu request 0"
  },
  {
    "id": "03033",
    "manifest_path": "data/manifests/the_stack_sample/sample_1249.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    name: hello-node\n  name: hello-node\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: hello-node\n  template:\n    metadata:\n      labels:\n        name: hello-node\n    spec:\n      containers:\n      - image: asia.gcr.io/<project id>/hello-node:v1\n        name: hello-node\n        ports:\n        - containerPort: 8080\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"hello-node\" has memory limit 0"
  },
  {
    "id": "03034",
    "manifest_path": "data/manifests/the_stack_sample/sample_1261.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: mock-ai\n  labels:\n    app: mock-ai\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: mock-ai\n  template:\n    metadata:\n      name: mock-ai\n      labels:\n        app: mock-ai\n    spec:\n      containers:\n      - name: mock-ai\n        image: europe-west2-docker.pkg.dev/ons-ci-int/int-docker-snapshot/mock-ai:Fix_file_listing_in_help_endpoint\n        imagePullPolicy: Always\n        resources:\n          requests:\n            cpu: '0.1'\n            memory: 512Mi\n          limits:\n            cpu: 0.5M\n            memory: 1024Mi\n        readinessProbe:\n          httpGet:\n            path: /info\n            port: 8162\n          initialDelaySeconds: 20\n          periodSeconds: 10\n          failureThreshold: 3\n          successThreshold: 1\n        livenessProbe:\n          httpGet:\n            path: /info\n            port: 8162\n          initialDelaySeconds: 30\n          periodSeconds: 10\n          failureThreshold: 3\n          successThreshold: 1\n        ports:\n        - name: http-server\n          containerPort: 8162\n        env:\n        - name: JAVA_TOOL_OPTIONS\n          value: -Dspring.profiles.active=dev -Dlogging.level.uk.gov.ons.ctp=DEBUG\n            -Dlogging.level.org.springframework=WARN -Dendpoints.autoconfig.enabled=false\n            -Dendpoints.beans.enabled=false -Dendpoints.configprops.enabled=false\n            -Dendpoints.dump.enabled=false -Dendpoints.env.enabled=false -Dendpoints.metrics.enabled=false\n            -Dendpoints.mapping.enabled=false -Dendpoints.shutdown.enabled=false -Dendpoints.trace.enabled=false\n            -Dmanagement.health.rabbit.enabled=false\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"mock-ai\" does not have a read-only root file system"
  },
  {
    "id": "03035",
    "manifest_path": "data/manifests/the_stack_sample/sample_1261.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: mock-ai\n  labels:\n    app: mock-ai\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: mock-ai\n  template:\n    metadata:\n      name: mock-ai\n      labels:\n        app: mock-ai\n    spec:\n      containers:\n      - name: mock-ai\n        image: europe-west2-docker.pkg.dev/ons-ci-int/int-docker-snapshot/mock-ai:Fix_file_listing_in_help_endpoint\n        imagePullPolicy: Always\n        resources:\n          requests:\n            cpu: '0.1'\n            memory: 512Mi\n          limits:\n            cpu: 0.5M\n            memory: 1024Mi\n        readinessProbe:\n          httpGet:\n            path: /info\n            port: 8162\n          initialDelaySeconds: 20\n          periodSeconds: 10\n          failureThreshold: 3\n          successThreshold: 1\n        livenessProbe:\n          httpGet:\n            path: /info\n            port: 8162\n          initialDelaySeconds: 30\n          periodSeconds: 10\n          failureThreshold: 3\n          successThreshold: 1\n        ports:\n        - name: http-server\n          containerPort: 8162\n        env:\n        - name: JAVA_TOOL_OPTIONS\n          value: -Dspring.profiles.active=dev -Dlogging.level.uk.gov.ons.ctp=DEBUG\n            -Dlogging.level.org.springframework=WARN -Dendpoints.autoconfig.enabled=false\n            -Dendpoints.beans.enabled=false -Dendpoints.configprops.enabled=false\n            -Dendpoints.dump.enabled=false -Dendpoints.env.enabled=false -Dendpoints.metrics.enabled=false\n            -Dendpoints.mapping.enabled=false -Dendpoints.shutdown.enabled=false -Dendpoints.trace.enabled=false\n            -Dmanagement.health.rabbit.enabled=false\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"mock-ai\" is not set to runAsNonRoot"
  },
  {
    "id": "03036",
    "manifest_path": "data/manifests/the_stack_sample/sample_1263.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: selinuxoptions0\nspec:\n  containers:\n  - image: k8s.gcr.io/pause\n    name: container1\n    securityContext:\n      seLinuxOptions: {}\n  initContainers:\n  - image: k8s.gcr.io/pause\n    name: initcontainer1\n    securityContext:\n      seLinuxOptions: {}\n  securityContext:\n    runAsNonRoot: true\n    seLinuxOptions:\n      type: somevalue\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"container1\" is using an invalid container image, \"k8s.gcr.io/pause\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "03037",
    "manifest_path": "data/manifests/the_stack_sample/sample_1263.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: selinuxoptions0\nspec:\n  containers:\n  - image: k8s.gcr.io/pause\n    name: container1\n    securityContext:\n      seLinuxOptions: {}\n  initContainers:\n  - image: k8s.gcr.io/pause\n    name: initcontainer1\n    securityContext:\n      seLinuxOptions: {}\n  securityContext:\n    runAsNonRoot: true\n    seLinuxOptions:\n      type: somevalue\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"initcontainer1\" is using an invalid container image, \"k8s.gcr.io/pause\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "03038",
    "manifest_path": "data/manifests/the_stack_sample/sample_1263.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: selinuxoptions0\nspec:\n  containers:\n  - image: k8s.gcr.io/pause\n    name: container1\n    securityContext:\n      seLinuxOptions: {}\n  initContainers:\n  - image: k8s.gcr.io/pause\n    name: initcontainer1\n    securityContext:\n      seLinuxOptions: {}\n  securityContext:\n    runAsNonRoot: true\n    seLinuxOptions:\n      type: somevalue\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"container1\" does not have a read-only root file system"
  },
  {
    "id": "03039",
    "manifest_path": "data/manifests/the_stack_sample/sample_1263.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: selinuxoptions0\nspec:\n  containers:\n  - image: k8s.gcr.io/pause\n    name: container1\n    securityContext:\n      seLinuxOptions: {}\n  initContainers:\n  - image: k8s.gcr.io/pause\n    name: initcontainer1\n    securityContext:\n      seLinuxOptions: {}\n  securityContext:\n    runAsNonRoot: true\n    seLinuxOptions:\n      type: somevalue\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"initcontainer1\" does not have a read-only root file system"
  },
  {
    "id": "03040",
    "manifest_path": "data/manifests/the_stack_sample/sample_1263.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: selinuxoptions0\nspec:\n  containers:\n  - image: k8s.gcr.io/pause\n    name: container1\n    securityContext:\n      seLinuxOptions: {}\n  initContainers:\n  - image: k8s.gcr.io/pause\n    name: initcontainer1\n    securityContext:\n      seLinuxOptions: {}\n  securityContext:\n    runAsNonRoot: true\n    seLinuxOptions:\n      type: somevalue\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"container1\" has cpu request 0"
  }
]