[
  {
    "id": "02961",
    "manifest_path": "data/manifests/the_stack_sample/sample_1209.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-790\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"nginx\" is using an invalid container image, \"nginx\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02962",
    "manifest_path": "data/manifests/the_stack_sample/sample_1209.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-790\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"nginx\" does not have a read-only root file system"
  },
  {
    "id": "02963",
    "manifest_path": "data/manifests/the_stack_sample/sample_1209.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-790\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"nginx\" is not set to runAsNonRoot"
  },
  {
    "id": "02964",
    "manifest_path": "data/manifests/the_stack_sample/sample_1209.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-790\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"nginx\" has cpu request 0"
  },
  {
    "id": "02965",
    "manifest_path": "data/manifests/the_stack_sample/sample_1209.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-790\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"nginx\" has memory limit 0"
  },
  {
    "id": "02966",
    "manifest_path": "data/manifests/the_stack_sample/sample_1211.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: not-privileged-deploy\n  name: not-privileged-deploy\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: not-privileged-deploy\n  template:\n    metadata:\n      labels:\n        app: not-privileged-deploy\n    spec:\n      containers:\n      - image: alpine\n        name: alpine\n        securityContext:\n          runAsUser: 1000\n          runAsGroup: 1000\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"alpine\" is using an invalid container image, \"alpine\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02967",
    "manifest_path": "data/manifests/the_stack_sample/sample_1211.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: not-privileged-deploy\n  name: not-privileged-deploy\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: not-privileged-deploy\n  template:\n    metadata:\n      labels:\n        app: not-privileged-deploy\n    spec:\n      containers:\n      - image: alpine\n        name: alpine\n        securityContext:\n          runAsUser: 1000\n          runAsGroup: 1000\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"alpine\" does not have a read-only root file system"
  },
  {
    "id": "02968",
    "manifest_path": "data/manifests/the_stack_sample/sample_1211.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: not-privileged-deploy\n  name: not-privileged-deploy\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: not-privileged-deploy\n  template:\n    metadata:\n      labels:\n        app: not-privileged-deploy\n    spec:\n      containers:\n      - image: alpine\n        name: alpine\n        securityContext:\n          runAsUser: 1000\n          runAsGroup: 1000\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"alpine\" has cpu request 0"
  },
  {
    "id": "02969",
    "manifest_path": "data/manifests/the_stack_sample/sample_1211.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: not-privileged-deploy\n  name: not-privileged-deploy\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: not-privileged-deploy\n  template:\n    metadata:\n      labels:\n        app: not-privileged-deploy\n    spec:\n      containers:\n      - image: alpine\n        name: alpine\n        securityContext:\n          runAsUser: 1000\n          runAsGroup: 1000\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"alpine\" has memory limit 0"
  },
  {
    "id": "02970",
    "manifest_path": "data/manifests/the_stack_sample/sample_1217.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: iot-kafka-pipe\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: iot-kafka-pipe\n  template:\n    metadata:\n      labels:\n        app: iot-kafka-pipe\n        tier: backend\n        group: java\n    spec:\n      containers:\n      - name: iot-kafka-pipe\n        image: registry.gitlab.com/mc-b/iot-kafka/iot-kafka-pipe\n        imagePullPolicy: IfNotPresent\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"iot-kafka-pipe\" is using an invalid container image, \"registry.gitlab.com/mc-b/iot-kafka/iot-kafka-pipe\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02971",
    "manifest_path": "data/manifests/the_stack_sample/sample_1217.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: iot-kafka-pipe\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: iot-kafka-pipe\n  template:\n    metadata:\n      labels:\n        app: iot-kafka-pipe\n        tier: backend\n        group: java\n    spec:\n      containers:\n      - name: iot-kafka-pipe\n        image: registry.gitlab.com/mc-b/iot-kafka/iot-kafka-pipe\n        imagePullPolicy: IfNotPresent\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"iot-kafka-pipe\" does not have a read-only root file system"
  },
  {
    "id": "02972",
    "manifest_path": "data/manifests/the_stack_sample/sample_1217.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: iot-kafka-pipe\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: iot-kafka-pipe\n  template:\n    metadata:\n      labels:\n        app: iot-kafka-pipe\n        tier: backend\n        group: java\n    spec:\n      containers:\n      - name: iot-kafka-pipe\n        image: registry.gitlab.com/mc-b/iot-kafka/iot-kafka-pipe\n        imagePullPolicy: IfNotPresent\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"iot-kafka-pipe\" is not set to runAsNonRoot"
  },
  {
    "id": "02973",
    "manifest_path": "data/manifests/the_stack_sample/sample_1217.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: iot-kafka-pipe\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: iot-kafka-pipe\n  template:\n    metadata:\n      labels:\n        app: iot-kafka-pipe\n        tier: backend\n        group: java\n    spec:\n      containers:\n      - name: iot-kafka-pipe\n        image: registry.gitlab.com/mc-b/iot-kafka/iot-kafka-pipe\n        imagePullPolicy: IfNotPresent\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"iot-kafka-pipe\" has cpu request 0"
  },
  {
    "id": "02974",
    "manifest_path": "data/manifests/the_stack_sample/sample_1217.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: iot-kafka-pipe\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: iot-kafka-pipe\n  template:\n    metadata:\n      labels:\n        app: iot-kafka-pipe\n        tier: backend\n        group: java\n    spec:\n      containers:\n      - name: iot-kafka-pipe\n        image: registry.gitlab.com/mc-b/iot-kafka/iot-kafka-pipe\n        imagePullPolicy: IfNotPresent\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"iot-kafka-pipe\" has memory limit 0"
  },
  {
    "id": "02975",
    "manifest_path": "data/manifests/the_stack_sample/sample_1220.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: pdservingclient\n  labels:\n    app: pdservingclient\nspec:\n  containers:\n  - name: pdservingclient\n    image: wangjiawei1993/pdservingclient:v4\n    workingDir: /\n    command:\n    - bash\n    args:\n    - nonstop.sh\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"pdservingclient\" does not have a read-only root file system"
  },
  {
    "id": "02976",
    "manifest_path": "data/manifests/the_stack_sample/sample_1220.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: pdservingclient\n  labels:\n    app: pdservingclient\nspec:\n  containers:\n  - name: pdservingclient\n    image: wangjiawei1993/pdservingclient:v4\n    workingDir: /\n    command:\n    - bash\n    args:\n    - nonstop.sh\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"pdservingclient\" is not set to runAsNonRoot"
  },
  {
    "id": "02977",
    "manifest_path": "data/manifests/the_stack_sample/sample_1220.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: pdservingclient\n  labels:\n    app: pdservingclient\nspec:\n  containers:\n  - name: pdservingclient\n    image: wangjiawei1993/pdservingclient:v4\n    workingDir: /\n    command:\n    - bash\n    args:\n    - nonstop.sh\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"pdservingclient\" has cpu request 0"
  },
  {
    "id": "02978",
    "manifest_path": "data/manifests/the_stack_sample/sample_1220.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: pdservingclient\n  labels:\n    app: pdservingclient\nspec:\n  containers:\n  - name: pdservingclient\n    image: wangjiawei1993/pdservingclient:v4\n    workingDir: /\n    command:\n    - bash\n    args:\n    - nonstop.sh\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"pdservingclient\" has memory limit 0"
  },
  {
    "id": "02979",
    "manifest_path": "data/manifests/the_stack_sample/sample_1221.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: prow\n  name: tide\n  labels:\n    app: tide\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: tide\n  template:\n    metadata:\n      labels:\n        app: tide\n    spec:\n      serviceAccountName: tide\n      containers:\n      - name: tide\n        image: gcr.io/k8s-prow/tide:v20201204-d90be1ef6b\n        args:\n        - --dry-run=false\n        - --config-path=/etc/config/config.yaml\n        - --github-token-path=/etc/github/token\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --github-graphql-endpoint=http://ghproxy/graphql\n        - --gcs-credentials-file=/etc/gcs-credentials/service-account.json\n        - --status-path=gs://prow-dev-tidb-logs/tide-status\n        - --history-uri=gs://prow-dev-tidb-logs/tide-history.json\n        ports:\n        - name: http\n          containerPort: 8888\n        volumeMounts:\n        - name: github-token\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: gcs-credentials\n          mountPath: /etc/gcs-credentials\n          readOnly: true\n      volumes:\n      - name: github-token\n        secret:\n          secretName: github-token\n      - name: config\n        configMap:\n          name: config\n      - name: gcs-credentials\n        secret:\n          secretName: gcs-credentials\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"tide\" does not have a read-only root file system"
  },
  {
    "id": "02980",
    "manifest_path": "data/manifests/the_stack_sample/sample_1221.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: prow\n  name: tide\n  labels:\n    app: tide\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: tide\n  template:\n    metadata:\n      labels:\n        app: tide\n    spec:\n      serviceAccountName: tide\n      containers:\n      - name: tide\n        image: gcr.io/k8s-prow/tide:v20201204-d90be1ef6b\n        args:\n        - --dry-run=false\n        - --config-path=/etc/config/config.yaml\n        - --github-token-path=/etc/github/token\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --github-graphql-endpoint=http://ghproxy/graphql\n        - --gcs-credentials-file=/etc/gcs-credentials/service-account.json\n        - --status-path=gs://prow-dev-tidb-logs/tide-status\n        - --history-uri=gs://prow-dev-tidb-logs/tide-history.json\n        ports:\n        - name: http\n          containerPort: 8888\n        volumeMounts:\n        - name: github-token\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: gcs-credentials\n          mountPath: /etc/gcs-credentials\n          readOnly: true\n      volumes:\n      - name: github-token\n        secret:\n          secretName: github-token\n      - name: config\n        configMap:\n          name: config\n      - name: gcs-credentials\n        secret:\n          secretName: gcs-credentials\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"tide\" is not set to runAsNonRoot"
  },
  {
    "id": "02981",
    "manifest_path": "data/manifests/the_stack_sample/sample_1221.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: prow\n  name: tide\n  labels:\n    app: tide\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: tide\n  template:\n    metadata:\n      labels:\n        app: tide\n    spec:\n      serviceAccountName: tide\n      containers:\n      - name: tide\n        image: gcr.io/k8s-prow/tide:v20201204-d90be1ef6b\n        args:\n        - --dry-run=false\n        - --config-path=/etc/config/config.yaml\n        - --github-token-path=/etc/github/token\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --github-graphql-endpoint=http://ghproxy/graphql\n        - --gcs-credentials-file=/etc/gcs-credentials/service-account.json\n        - --status-path=gs://prow-dev-tidb-logs/tide-status\n        - --history-uri=gs://prow-dev-tidb-logs/tide-history.json\n        ports:\n        - name: http\n          containerPort: 8888\n        volumeMounts:\n        - name: github-token\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: gcs-credentials\n          mountPath: /etc/gcs-credentials\n          readOnly: true\n      volumes:\n      - name: github-token\n        secret:\n          secretName: github-token\n      - name: config\n        configMap:\n          name: config\n      - name: gcs-credentials\n        secret:\n          secretName: gcs-credentials\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"tide\" has cpu request 0"
  },
  {
    "id": "02982",
    "manifest_path": "data/manifests/the_stack_sample/sample_1221.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: prow\n  name: tide\n  labels:\n    app: tide\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: tide\n  template:\n    metadata:\n      labels:\n        app: tide\n    spec:\n      serviceAccountName: tide\n      containers:\n      - name: tide\n        image: gcr.io/k8s-prow/tide:v20201204-d90be1ef6b\n        args:\n        - --dry-run=false\n        - --config-path=/etc/config/config.yaml\n        - --github-token-path=/etc/github/token\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --github-graphql-endpoint=http://ghproxy/graphql\n        - --gcs-credentials-file=/etc/gcs-credentials/service-account.json\n        - --status-path=gs://prow-dev-tidb-logs/tide-status\n        - --history-uri=gs://prow-dev-tidb-logs/tide-history.json\n        ports:\n        - name: http\n          containerPort: 8888\n        volumeMounts:\n        - name: github-token\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: gcs-credentials\n          mountPath: /etc/gcs-credentials\n          readOnly: true\n      volumes:\n      - name: github-token\n        secret:\n          secretName: github-token\n      - name: config\n        configMap:\n          name: config\n      - name: gcs-credentials\n        secret:\n          secretName: gcs-credentials\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"tide\" has memory limit 0"
  },
  {
    "id": "02983",
    "manifest_path": "data/manifests/the_stack_sample/sample_1223.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: web\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: web\n  template:\n    metadata:\n      name: web\n      labels:\n        app: web\n    spec:\n      containers:\n      - name: web\n        image: binhex386/kubernetes-intro\n        volumeMounts:\n        - mountPath: /app\n          name: www\n        resources:\n          limits:\n            cpu: 100m\n            memory: 64M\n        readinessProbe:\n          httpGet:\n            path: /index.html\n            port: 8000\n      initContainers:\n      - name: init-www\n        image: busybox\n        command:\n        - sh\n        - -c\n        - wget -O- https://tinyurl.com/otus-k8s-intro | sh\n        volumeMounts:\n        - mountPath: /app\n          name: www\n      volumes:\n      - name: www\n        emptyDir: {}\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"init-www\" is using an invalid container image, \"busybox\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02984",
    "manifest_path": "data/manifests/the_stack_sample/sample_1223.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: web\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: web\n  template:\n    metadata:\n      name: web\n      labels:\n        app: web\n    spec:\n      containers:\n      - name: web\n        image: binhex386/kubernetes-intro\n        volumeMounts:\n        - mountPath: /app\n          name: www\n        resources:\n          limits:\n            cpu: 100m\n            memory: 64M\n        readinessProbe:\n          httpGet:\n            path: /index.html\n            port: 8000\n      initContainers:\n      - name: init-www\n        image: busybox\n        command:\n        - sh\n        - -c\n        - wget -O- https://tinyurl.com/otus-k8s-intro | sh\n        volumeMounts:\n        - mountPath: /app\n          name: www\n      volumes:\n      - name: www\n        emptyDir: {}\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"web\" is using an invalid container image, \"binhex386/kubernetes-intro\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02985",
    "manifest_path": "data/manifests/the_stack_sample/sample_1223.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: web\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: web\n  template:\n    metadata:\n      name: web\n      labels:\n        app: web\n    spec:\n      containers:\n      - name: web\n        image: binhex386/kubernetes-intro\n        volumeMounts:\n        - mountPath: /app\n          name: www\n        resources:\n          limits:\n            cpu: 100m\n            memory: 64M\n        readinessProbe:\n          httpGet:\n            path: /index.html\n            port: 8000\n      initContainers:\n      - name: init-www\n        image: busybox\n        command:\n        - sh\n        - -c\n        - wget -O- https://tinyurl.com/otus-k8s-intro | sh\n        volumeMounts:\n        - mountPath: /app\n          name: www\n      volumes:\n      - name: www\n        emptyDir: {}\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"init-www\" does not have a read-only root file system"
  },
  {
    "id": "02986",
    "manifest_path": "data/manifests/the_stack_sample/sample_1223.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: web\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: web\n  template:\n    metadata:\n      name: web\n      labels:\n        app: web\n    spec:\n      containers:\n      - name: web\n        image: binhex386/kubernetes-intro\n        volumeMounts:\n        - mountPath: /app\n          name: www\n        resources:\n          limits:\n            cpu: 100m\n            memory: 64M\n        readinessProbe:\n          httpGet:\n            path: /index.html\n            port: 8000\n      initContainers:\n      - name: init-www\n        image: busybox\n        command:\n        - sh\n        - -c\n        - wget -O- https://tinyurl.com/otus-k8s-intro | sh\n        volumeMounts:\n        - mountPath: /app\n          name: www\n      volumes:\n      - name: www\n        emptyDir: {}\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"web\" does not have a read-only root file system"
  },
  {
    "id": "02987",
    "manifest_path": "data/manifests/the_stack_sample/sample_1223.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: web\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: web\n  template:\n    metadata:\n      name: web\n      labels:\n        app: web\n    spec:\n      containers:\n      - name: web\n        image: binhex386/kubernetes-intro\n        volumeMounts:\n        - mountPath: /app\n          name: www\n        resources:\n          limits:\n            cpu: 100m\n            memory: 64M\n        readinessProbe:\n          httpGet:\n            path: /index.html\n            port: 8000\n      initContainers:\n      - name: init-www\n        image: busybox\n        command:\n        - sh\n        - -c\n        - wget -O- https://tinyurl.com/otus-k8s-intro | sh\n        volumeMounts:\n        - mountPath: /app\n          name: www\n      volumes:\n      - name: www\n        emptyDir: {}\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"init-www\" is not set to runAsNonRoot"
  },
  {
    "id": "02988",
    "manifest_path": "data/manifests/the_stack_sample/sample_1223.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: web\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: web\n  template:\n    metadata:\n      name: web\n      labels:\n        app: web\n    spec:\n      containers:\n      - name: web\n        image: binhex386/kubernetes-intro\n        volumeMounts:\n        - mountPath: /app\n          name: www\n        resources:\n          limits:\n            cpu: 100m\n            memory: 64M\n        readinessProbe:\n          httpGet:\n            path: /index.html\n            port: 8000\n      initContainers:\n      - name: init-www\n        image: busybox\n        command:\n        - sh\n        - -c\n        - wget -O- https://tinyurl.com/otus-k8s-intro | sh\n        volumeMounts:\n        - mountPath: /app\n          name: www\n      volumes:\n      - name: www\n        emptyDir: {}\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"web\" is not set to runAsNonRoot"
  },
  {
    "id": "02989",
    "manifest_path": "data/manifests/the_stack_sample/sample_1223.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: web\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: web\n  template:\n    metadata:\n      name: web\n      labels:\n        app: web\n    spec:\n      containers:\n      - name: web\n        image: binhex386/kubernetes-intro\n        volumeMounts:\n        - mountPath: /app\n          name: www\n        resources:\n          limits:\n            cpu: 100m\n            memory: 64M\n        readinessProbe:\n          httpGet:\n            path: /index.html\n            port: 8000\n      initContainers:\n      - name: init-www\n        image: busybox\n        command:\n        - sh\n        - -c\n        - wget -O- https://tinyurl.com/otus-k8s-intro | sh\n        volumeMounts:\n        - mountPath: /app\n          name: www\n      volumes:\n      - name: www\n        emptyDir: {}\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"init-www\" has cpu request 0"
  },
  {
    "id": "02990",
    "manifest_path": "data/manifests/the_stack_sample/sample_1223.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: web\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: web\n  template:\n    metadata:\n      name: web\n      labels:\n        app: web\n    spec:\n      containers:\n      - name: web\n        image: binhex386/kubernetes-intro\n        volumeMounts:\n        - mountPath: /app\n          name: www\n        resources:\n          limits:\n            cpu: 100m\n            memory: 64M\n        readinessProbe:\n          httpGet:\n            path: /index.html\n            port: 8000\n      initContainers:\n      - name: init-www\n        image: busybox\n        command:\n        - sh\n        - -c\n        - wget -O- https://tinyurl.com/otus-k8s-intro | sh\n        volumeMounts:\n        - mountPath: /app\n          name: www\n      volumes:\n      - name: www\n        emptyDir: {}\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"web\" has cpu request 0"
  },
  {
    "id": "02991",
    "manifest_path": "data/manifests/the_stack_sample/sample_1223.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: web\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: web\n  template:\n    metadata:\n      name: web\n      labels:\n        app: web\n    spec:\n      containers:\n      - name: web\n        image: binhex386/kubernetes-intro\n        volumeMounts:\n        - mountPath: /app\n          name: www\n        resources:\n          limits:\n            cpu: 100m\n            memory: 64M\n        readinessProbe:\n          httpGet:\n            path: /index.html\n            port: 8000\n      initContainers:\n      - name: init-www\n        image: busybox\n        command:\n        - sh\n        - -c\n        - wget -O- https://tinyurl.com/otus-k8s-intro | sh\n        volumeMounts:\n        - mountPath: /app\n          name: www\n      volumes:\n      - name: www\n        emptyDir: {}\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"init-www\" has memory limit 0"
  },
  {
    "id": "02992",
    "manifest_path": "data/manifests/the_stack_sample/sample_1224.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: hapi-fhir-mysql-deployment\n  labels:\n    package: core\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      component: hapi-fhir-mysql\n  template:\n    metadata:\n      labels:\n        component: hapi-fhir-mysql\n    spec:\n      containers:\n      - name: hapi-fhir-mysql\n        image: mysql:5.7\n        args:\n        - --ignore-db-dir=lost+found\n        env:\n        - name: MYSQL_DATABASE\n          value: hapi\n        - name: MYSQL_PASSWORD\n          value: instant101\n        - name: MYSQL_ROOT_PASSWORD\n          value: instant101\n        - name: MYSQL_USER\n          value: admin\n        volumeMounts:\n        - name: core-hapi-fhir-mysql-volume\n          mountPath: /var/lib/mysql\n        - name: core-hapi-fhir-mysql-config-map\n          mountPath: /etc/mysql/conf.d\n      volumes:\n      - name: core-hapi-fhir-mysql-volume\n        persistentVolumeClaim:\n          claimName: hapi-fhir-mysql-volume-claim\n      - name: core-hapi-fhir-mysql-config-map\n        configMap:\n          name: core-hapi-fhir-mysql-configmap\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"hapi-fhir-mysql\" does not have a read-only root file system"
  },
  {
    "id": "02993",
    "manifest_path": "data/manifests/the_stack_sample/sample_1224.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: hapi-fhir-mysql-deployment\n  labels:\n    package: core\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      component: hapi-fhir-mysql\n  template:\n    metadata:\n      labels:\n        component: hapi-fhir-mysql\n    spec:\n      containers:\n      - name: hapi-fhir-mysql\n        image: mysql:5.7\n        args:\n        - --ignore-db-dir=lost+found\n        env:\n        - name: MYSQL_DATABASE\n          value: hapi\n        - name: MYSQL_PASSWORD\n          value: instant101\n        - name: MYSQL_ROOT_PASSWORD\n          value: instant101\n        - name: MYSQL_USER\n          value: admin\n        volumeMounts:\n        - name: core-hapi-fhir-mysql-volume\n          mountPath: /var/lib/mysql\n        - name: core-hapi-fhir-mysql-config-map\n          mountPath: /etc/mysql/conf.d\n      volumes:\n      - name: core-hapi-fhir-mysql-volume\n        persistentVolumeClaim:\n          claimName: hapi-fhir-mysql-volume-claim\n      - name: core-hapi-fhir-mysql-config-map\n        configMap:\n          name: core-hapi-fhir-mysql-configmap\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"hapi-fhir-mysql\" is not set to runAsNonRoot"
  },
  {
    "id": "02994",
    "manifest_path": "data/manifests/the_stack_sample/sample_1224.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: hapi-fhir-mysql-deployment\n  labels:\n    package: core\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      component: hapi-fhir-mysql\n  template:\n    metadata:\n      labels:\n        component: hapi-fhir-mysql\n    spec:\n      containers:\n      - name: hapi-fhir-mysql\n        image: mysql:5.7\n        args:\n        - --ignore-db-dir=lost+found\n        env:\n        - name: MYSQL_DATABASE\n          value: hapi\n        - name: MYSQL_PASSWORD\n          value: instant101\n        - name: MYSQL_ROOT_PASSWORD\n          value: instant101\n        - name: MYSQL_USER\n          value: admin\n        volumeMounts:\n        - name: core-hapi-fhir-mysql-volume\n          mountPath: /var/lib/mysql\n        - name: core-hapi-fhir-mysql-config-map\n          mountPath: /etc/mysql/conf.d\n      volumes:\n      - name: core-hapi-fhir-mysql-volume\n        persistentVolumeClaim:\n          claimName: hapi-fhir-mysql-volume-claim\n      - name: core-hapi-fhir-mysql-config-map\n        configMap:\n          name: core-hapi-fhir-mysql-configmap\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"hapi-fhir-mysql\" has cpu request 0"
  },
  {
    "id": "02995",
    "manifest_path": "data/manifests/the_stack_sample/sample_1224.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: hapi-fhir-mysql-deployment\n  labels:\n    package: core\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      component: hapi-fhir-mysql\n  template:\n    metadata:\n      labels:\n        component: hapi-fhir-mysql\n    spec:\n      containers:\n      - name: hapi-fhir-mysql\n        image: mysql:5.7\n        args:\n        - --ignore-db-dir=lost+found\n        env:\n        - name: MYSQL_DATABASE\n          value: hapi\n        - name: MYSQL_PASSWORD\n          value: instant101\n        - name: MYSQL_ROOT_PASSWORD\n          value: instant101\n        - name: MYSQL_USER\n          value: admin\n        volumeMounts:\n        - name: core-hapi-fhir-mysql-volume\n          mountPath: /var/lib/mysql\n        - name: core-hapi-fhir-mysql-config-map\n          mountPath: /etc/mysql/conf.d\n      volumes:\n      - name: core-hapi-fhir-mysql-volume\n        persistentVolumeClaim:\n          claimName: hapi-fhir-mysql-volume-claim\n      - name: core-hapi-fhir-mysql-config-map\n        configMap:\n          name: core-hapi-fhir-mysql-configmap\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"hapi-fhir-mysql\" has memory limit 0"
  },
  {
    "id": "02996",
    "manifest_path": "data/manifests/the_stack_sample/sample_1225.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: seldon\n    app.kubernetes.io/instance: seldon1\n    app.kubernetes.io/name: seldon\n    app.kubernetes.io/version: v0.5\n    control-plane: seldon-controller-manager\n  name: seldon-controller-manager\n  namespace: default\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: seldon\n      app.kubernetes.io/instance: seldon1\n      app.kubernetes.io/name: seldon\n      app.kubernetes.io/version: v0.5\n      control-plane: seldon-controller-manager\n  template:\n    metadata:\n      annotations:\n        sidecar.istio.io/inject: 'false'\n      labels:\n        app: seldon\n        app.kubernetes.io/instance: seldon1\n        app.kubernetes.io/name: seldon\n        app.kubernetes.io/version: v0.5\n        control-plane: seldon-controller-manager\n    spec:\n      containers:\n      - args:\n        - --enable-leader-election\n        - --webhook-port=8443\n        - --create-resources=$(MANAGER_CREATE_RESOURCES)\n        command:\n        - /manager\n        env:\n        - name: WATCH_NAMESPACE\n          value: ''\n        - name: RELATED_IMAGE_EXECUTOR\n          value: ''\n        - name: RELATED_IMAGE_ENGINE\n          value: ''\n        - name: RELATED_IMAGE_STORAGE_INITIALIZER\n          value: ''\n        - name: RELATED_IMAGE_SKLEARNSERVER_REST\n          value: ''\n        - name: RELATED_IMAGE_SKLEARNSERVER_GRPC\n          value: ''\n        - name: RELATED_IMAGE_XGBOOSTSERVER_REST\n          value: ''\n        - name: RELATED_IMAGE_XGBOOSTSERVER_GRPC\n          value: ''\n        - name: RELATED_IMAGE_MLFLOWSERVER_REST\n          value: ''\n        - name: RELATED_IMAGE_MLFLOWSERVER_GRPC\n          value: ''\n        - name: RELATED_IMAGE_TFPROXY_REST\n          value: ''\n        - name: RELATED_IMAGE_TFPROXY_GRPC\n          value: ''\n        - name: RELATED_IMAGE_TENSORFLOW\n          value: ''\n        - name: RELATED_IMAGE_EXPLAINER\n          value: ''\n        - name: MANAGER_CREATE_RESOURCES\n          value: 'true'\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: CONTROLLER_ID\n          value: ''\n        - name: AMBASSADOR_ENABLED\n          value: 'true'\n        - name: AMBASSADOR_SINGLE_NAMESPACE\n          value: 'false'\n        - name: ENGINE_CONTAINER_IMAGE_AND_VERSION\n          value: docker.io/seldonio/engine:1.2.1-dev\n        - name: ENGINE_CONTAINER_IMAGE_PULL_POLICY\n          value: IfNotPresent\n        - name: ENGINE_CONTAINER_SERVICE_ACCOUNT_NAME\n          value: default\n        - name: ENGINE_CONTAINER_USER\n          value: ''\n        - name: ENGINE_LOG_MESSAGES_EXTERNALLY\n          value: 'false'\n        - name: PREDICTIVE_UNIT_SERVICE_PORT\n          value: '9000'\n        - name: PREDICTIVE_UNIT_DEFAULT_ENV_SECRET_REF_NAME\n          value: ''\n        - name: PREDICTIVE_UNIT_METRICS_PORT_NAME\n          value: metrics\n        - name: ENGINE_SERVER_GRPC_PORT\n          value: '5001'\n        - name: ENGINE_SERVER_PORT\n          value: '8000'\n        - name: ENGINE_PROMETHEUS_PATH\n          value: /prometheus\n        - name: ISTIO_ENABLED\n          value: 'false'\n        - name: ISTIO_GATEWAY\n          value: istio-system/seldon-gateway\n        - name: ISTIO_TLS_MODE\n          value: ''\n        - name: USE_EXECUTOR\n          value: 'true'\n        - name: EXECUTOR_CONTAINER_IMAGE_AND_VERSION\n          value: seldonio/seldon-core-executor:1.2.1-dev\n        - name: EXECUTOR_CONTAINER_IMAGE_PULL_POLICY\n          value: IfNotPresent\n        - name: EXECUTOR_PROMETHEUS_PATH\n          value: /prometheus\n        - name: EXECUTOR_SERVER_PORT\n          value: '8000'\n        - name: EXECUTOR_CONTAINER_USER\n          value: ''\n        - name: EXECUTOR_CONTAINER_SERVICE_ACCOUNT_NAME\n          value: default\n        - name: EXECUTOR_SERVER_METRICS_PORT_NAME\n          value: metrics\n        - name: EXECUTOR_REQUEST_LOGGER_DEFAULT_ENDPOINT\n          value: http://default-broker\n        - name: DEFAULT_USER_ID\n          value: ''\n        image: seldonio/seldon-core-operator:1.2.1-dev\n        name: manager\n        ports:\n        - containerPort: 8443\n          name: webhook-server\n          protocol: TCP\n        resources:\n          limits:\n            cpu: 500m\n            memory: 300Mi\n          requests:\n            cpu: 100m\n            memory: 200Mi\n      serviceAccountName: seldon-manager\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"manager\" does not have a read-only root file system"
  },
  {
    "id": "02997",
    "manifest_path": "data/manifests/the_stack_sample/sample_1225.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: seldon\n    app.kubernetes.io/instance: seldon1\n    app.kubernetes.io/name: seldon\n    app.kubernetes.io/version: v0.5\n    control-plane: seldon-controller-manager\n  name: seldon-controller-manager\n  namespace: default\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: seldon\n      app.kubernetes.io/instance: seldon1\n      app.kubernetes.io/name: seldon\n      app.kubernetes.io/version: v0.5\n      control-plane: seldon-controller-manager\n  template:\n    metadata:\n      annotations:\n        sidecar.istio.io/inject: 'false'\n      labels:\n        app: seldon\n        app.kubernetes.io/instance: seldon1\n        app.kubernetes.io/name: seldon\n        app.kubernetes.io/version: v0.5\n        control-plane: seldon-controller-manager\n    spec:\n      containers:\n      - args:\n        - --enable-leader-election\n        - --webhook-port=8443\n        - --create-resources=$(MANAGER_CREATE_RESOURCES)\n        command:\n        - /manager\n        env:\n        - name: WATCH_NAMESPACE\n          value: ''\n        - name: RELATED_IMAGE_EXECUTOR\n          value: ''\n        - name: RELATED_IMAGE_ENGINE\n          value: ''\n        - name: RELATED_IMAGE_STORAGE_INITIALIZER\n          value: ''\n        - name: RELATED_IMAGE_SKLEARNSERVER_REST\n          value: ''\n        - name: RELATED_IMAGE_SKLEARNSERVER_GRPC\n          value: ''\n        - name: RELATED_IMAGE_XGBOOSTSERVER_REST\n          value: ''\n        - name: RELATED_IMAGE_XGBOOSTSERVER_GRPC\n          value: ''\n        - name: RELATED_IMAGE_MLFLOWSERVER_REST\n          value: ''\n        - name: RELATED_IMAGE_MLFLOWSERVER_GRPC\n          value: ''\n        - name: RELATED_IMAGE_TFPROXY_REST\n          value: ''\n        - name: RELATED_IMAGE_TFPROXY_GRPC\n          value: ''\n        - name: RELATED_IMAGE_TENSORFLOW\n          value: ''\n        - name: RELATED_IMAGE_EXPLAINER\n          value: ''\n        - name: MANAGER_CREATE_RESOURCES\n          value: 'true'\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: CONTROLLER_ID\n          value: ''\n        - name: AMBASSADOR_ENABLED\n          value: 'true'\n        - name: AMBASSADOR_SINGLE_NAMESPACE\n          value: 'false'\n        - name: ENGINE_CONTAINER_IMAGE_AND_VERSION\n          value: docker.io/seldonio/engine:1.2.1-dev\n        - name: ENGINE_CONTAINER_IMAGE_PULL_POLICY\n          value: IfNotPresent\n        - name: ENGINE_CONTAINER_SERVICE_ACCOUNT_NAME\n          value: default\n        - name: ENGINE_CONTAINER_USER\n          value: ''\n        - name: ENGINE_LOG_MESSAGES_EXTERNALLY\n          value: 'false'\n        - name: PREDICTIVE_UNIT_SERVICE_PORT\n          value: '9000'\n        - name: PREDICTIVE_UNIT_DEFAULT_ENV_SECRET_REF_NAME\n          value: ''\n        - name: PREDICTIVE_UNIT_METRICS_PORT_NAME\n          value: metrics\n        - name: ENGINE_SERVER_GRPC_PORT\n          value: '5001'\n        - name: ENGINE_SERVER_PORT\n          value: '8000'\n        - name: ENGINE_PROMETHEUS_PATH\n          value: /prometheus\n        - name: ISTIO_ENABLED\n          value: 'false'\n        - name: ISTIO_GATEWAY\n          value: istio-system/seldon-gateway\n        - name: ISTIO_TLS_MODE\n          value: ''\n        - name: USE_EXECUTOR\n          value: 'true'\n        - name: EXECUTOR_CONTAINER_IMAGE_AND_VERSION\n          value: seldonio/seldon-core-executor:1.2.1-dev\n        - name: EXECUTOR_CONTAINER_IMAGE_PULL_POLICY\n          value: IfNotPresent\n        - name: EXECUTOR_PROMETHEUS_PATH\n          value: /prometheus\n        - name: EXECUTOR_SERVER_PORT\n          value: '8000'\n        - name: EXECUTOR_CONTAINER_USER\n          value: ''\n        - name: EXECUTOR_CONTAINER_SERVICE_ACCOUNT_NAME\n          value: default\n        - name: EXECUTOR_SERVER_METRICS_PORT_NAME\n          value: metrics\n        - name: EXECUTOR_REQUEST_LOGGER_DEFAULT_ENDPOINT\n          value: http://default-broker\n        - name: DEFAULT_USER_ID\n          value: ''\n        image: seldonio/seldon-core-operator:1.2.1-dev\n        name: manager\n        ports:\n        - containerPort: 8443\n          name: webhook-server\n          protocol: TCP\n        resources:\n          limits:\n            cpu: 500m\n            memory: 300Mi\n          requests:\n            cpu: 100m\n            memory: 200Mi\n      serviceAccountName: seldon-manager\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"manager\" is not set to runAsNonRoot"
  },
  {
    "id": "02998",
    "manifest_path": "data/manifests/the_stack_sample/sample_1226.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: micro-network\n  labels:\n    micro: runtime\n    name: micro-network\n  annotations:\n    name: go.micro.network\n    version: latest\n    source: github.com/itzmanish/micro\n    owner: micro\n    group: micro\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: micro-network\n      micro: runtime\n  template:\n    metadata:\n      labels:\n        name: micro-network\n        micro: runtime\n    spec:\n      affinity:\n        podAntiAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - weight: 100\n            podAffinityTerm:\n              labelSelector:\n                matchExpressions:\n                - key: name\n                  operator: In\n                  values:\n                  - micro-network\n              topologyKey: kubernetes.io/hostname\n      volumes:\n      - name: shared-data\n        emptyDir: {}\n      containers:\n      - name: network\n        env:\n        - name: MICRO_NETWORK_TOKEN\n          value: micro.mu\n        - name: MICRO_NETWORK_ADVERTISE_STRATEGY\n          value: best\n        - name: MICRO_LOG_LEVEL\n          value: debug\n        - name: MICRO_BROKER\n          value: nats\n        - name: MICRO_BROKER_ADDRESS\n          value: nats-cluster\n        - name: MICRO_REGISTRY\n          value: etcd\n        - name: MICRO_REGISTRY_ADDRESS\n          value: etcd-cluster-client\n        - name: MICRO_SERVER_ADDRESS\n          value: 0.0.0.0:8080\n        args:\n        - network\n        image: micro/micro\n        imagePullPolicy: Always\n        ports:\n        - containerPort: 8080\n          name: service-port\n        - containerPort: 8085\n          name: network-port\n          protocol: UDP\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"network\" is using an invalid container image, \"micro/micro\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02999",
    "manifest_path": "data/manifests/the_stack_sample/sample_1226.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: micro-network\n  labels:\n    micro: runtime\n    name: micro-network\n  annotations:\n    name: go.micro.network\n    version: latest\n    source: github.com/itzmanish/micro\n    owner: micro\n    group: micro\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: micro-network\n      micro: runtime\n  template:\n    metadata:\n      labels:\n        name: micro-network\n        micro: runtime\n    spec:\n      affinity:\n        podAntiAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - weight: 100\n            podAffinityTerm:\n              labelSelector:\n                matchExpressions:\n                - key: name\n                  operator: In\n                  values:\n                  - micro-network\n              topologyKey: kubernetes.io/hostname\n      volumes:\n      - name: shared-data\n        emptyDir: {}\n      containers:\n      - name: network\n        env:\n        - name: MICRO_NETWORK_TOKEN\n          value: micro.mu\n        - name: MICRO_NETWORK_ADVERTISE_STRATEGY\n          value: best\n        - name: MICRO_LOG_LEVEL\n          value: debug\n        - name: MICRO_BROKER\n          value: nats\n        - name: MICRO_BROKER_ADDRESS\n          value: nats-cluster\n        - name: MICRO_REGISTRY\n          value: etcd\n        - name: MICRO_REGISTRY_ADDRESS\n          value: etcd-cluster-client\n        - name: MICRO_SERVER_ADDRESS\n          value: 0.0.0.0:8080\n        args:\n        - network\n        image: micro/micro\n        imagePullPolicy: Always\n        ports:\n        - containerPort: 8080\n          name: service-port\n        - containerPort: 8085\n          name: network-port\n          protocol: UDP\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"network\" does not have a read-only root file system"
  },
  {
    "id": "03000",
    "manifest_path": "data/manifests/the_stack_sample/sample_1226.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: micro-network\n  labels:\n    micro: runtime\n    name: micro-network\n  annotations:\n    name: go.micro.network\n    version: latest\n    source: github.com/itzmanish/micro\n    owner: micro\n    group: micro\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: micro-network\n      micro: runtime\n  template:\n    metadata:\n      labels:\n        name: micro-network\n        micro: runtime\n    spec:\n      affinity:\n        podAntiAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - weight: 100\n            podAffinityTerm:\n              labelSelector:\n                matchExpressions:\n                - key: name\n                  operator: In\n                  values:\n                  - micro-network\n              topologyKey: kubernetes.io/hostname\n      volumes:\n      - name: shared-data\n        emptyDir: {}\n      containers:\n      - name: network\n        env:\n        - name: MICRO_NETWORK_TOKEN\n          value: micro.mu\n        - name: MICRO_NETWORK_ADVERTISE_STRATEGY\n          value: best\n        - name: MICRO_LOG_LEVEL\n          value: debug\n        - name: MICRO_BROKER\n          value: nats\n        - name: MICRO_BROKER_ADDRESS\n          value: nats-cluster\n        - name: MICRO_REGISTRY\n          value: etcd\n        - name: MICRO_REGISTRY_ADDRESS\n          value: etcd-cluster-client\n        - name: MICRO_SERVER_ADDRESS\n          value: 0.0.0.0:8080\n        args:\n        - network\n        image: micro/micro\n        imagePullPolicy: Always\n        ports:\n        - containerPort: 8080\n          name: service-port\n        - containerPort: 8085\n          name: network-port\n          protocol: UDP\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"network\" is not set to runAsNonRoot"
  }
]