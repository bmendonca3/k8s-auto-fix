[
  {
    "id": "04441",
    "manifest_path": "data/manifests/the_stack_sample/sample_2039.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-5490\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"nginx\" has memory limit 0"
  },
  {
    "id": "04442",
    "manifest_path": "data/manifests/the_stack_sample/sample_2042.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: image-reflector-controller\n  labels:\n    control-plane: controller-manager\nspec:\n  selector:\n    matchLabels:\n      app: image-reflector-controller\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: image-reflector-controller\n    spec:\n      containers:\n      - command:\n        - /manager\n        args:\n        - --enable-leader-election\n        image: squaremo/image-reflector-controller\n        name: manager\n        resources:\n          limits:\n            cpu: 100m\n            memory: 30Mi\n          requests:\n            cpu: 100m\n            memory: 20Mi\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"manager\" is using an invalid container image, \"squaremo/image-reflector-controller\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "04443",
    "manifest_path": "data/manifests/the_stack_sample/sample_2042.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: image-reflector-controller\n  labels:\n    control-plane: controller-manager\nspec:\n  selector:\n    matchLabels:\n      app: image-reflector-controller\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: image-reflector-controller\n    spec:\n      containers:\n      - command:\n        - /manager\n        args:\n        - --enable-leader-election\n        image: squaremo/image-reflector-controller\n        name: manager\n        resources:\n          limits:\n            cpu: 100m\n            memory: 30Mi\n          requests:\n            cpu: 100m\n            memory: 20Mi\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"manager\" does not have a read-only root file system"
  },
  {
    "id": "04444",
    "manifest_path": "data/manifests/the_stack_sample/sample_2042.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: image-reflector-controller\n  labels:\n    control-plane: controller-manager\nspec:\n  selector:\n    matchLabels:\n      app: image-reflector-controller\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: image-reflector-controller\n    spec:\n      containers:\n      - command:\n        - /manager\n        args:\n        - --enable-leader-election\n        image: squaremo/image-reflector-controller\n        name: manager\n        resources:\n          limits:\n            cpu: 100m\n            memory: 30Mi\n          requests:\n            cpu: 100m\n            memory: 20Mi\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"manager\" is not set to runAsNonRoot"
  },
  {
    "id": "04445",
    "manifest_path": "data/manifests/the_stack_sample/sample_2043.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: lighthouse-keeper\n  labels:\n    chart: lighthouse-1.1.51\n    app: lighthouse-keeper\n    gitops.jenkins-x.io/pipeline: namespaces\n  annotations:\n    meta.helm.sh/release-name: lighthouse\n    wave.pusher.com/update-on-config-change: 'true'\n  namespace: jx\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: lighthouse-keeper\n  template:\n    metadata:\n      annotations:\n        ad.datadoghq.com/keeper.logs: '[{\"source\":\"lighthouse\",\"service\":\"keeper\"}]'\n        prometheus.io/port: '9090'\n        prometheus.io/scrape: 'true'\n        jenkins-x.io/hash: a042ef704bc21bfd8abcd79f32e9788ecad0bdb70e7653aff9458eda85bafe3b\n      labels:\n        app: lighthouse-keeper\n    spec:\n      serviceAccountName: lighthouse-keeper\n      containers:\n      - name: lighthouse-keeper\n        image: ghcr.io/jenkins-x/lighthouse-keeper:1.1.51\n        imagePullPolicy: IfNotPresent\n        args:\n        - --namespace=jx\n        ports:\n        - name: http\n          containerPort: 8888\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /\n            port: http\n          initialDelaySeconds: 120\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        readinessProbe:\n          httpGet:\n            path: /\n            port: http\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        env:\n        - name: GIT_KIND\n          value: github\n        - name: GIT_SERVER\n          value: https://github.com\n        - name: GIT_USER\n          value: skreet2k\n        - name: GIT_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: lighthouse-oauth-token\n              key: oauth\n        - name: JX_LOG_FORMAT\n          value: json\n        - name: LOGRUS_FORMAT\n          value: json\n        - name: LOGRUS_SERVICE\n          value: lighthouse\n        - name: LOGRUS_SERVICE_VERSION\n          value: 1.1.51\n        - name: LOGRUS_STACK_SKIP\n          value: ''\n        - name: LIGHTHOUSE_KEEPER_STATUS_CONTEXT_LABEL\n          value: Lighthouse Merge Status\n        - name: LIGHTHOUSE_TRIGGER_ON_MISSING\n          value: enable\n        envFrom:\n        - secretRef:\n            name: jx-boot-job-env-vars\n            optional: true\n        resources:\n          limits:\n            cpu: 400m\n            memory: 512Mi\n          requests:\n            cpu: 100m\n            memory: 128Mi\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"lighthouse-keeper\" does not have a read-only root file system"
  },
  {
    "id": "04446",
    "manifest_path": "data/manifests/the_stack_sample/sample_2043.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: lighthouse-keeper\n  labels:\n    chart: lighthouse-1.1.51\n    app: lighthouse-keeper\n    gitops.jenkins-x.io/pipeline: namespaces\n  annotations:\n    meta.helm.sh/release-name: lighthouse\n    wave.pusher.com/update-on-config-change: 'true'\n  namespace: jx\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: lighthouse-keeper\n  template:\n    metadata:\n      annotations:\n        ad.datadoghq.com/keeper.logs: '[{\"source\":\"lighthouse\",\"service\":\"keeper\"}]'\n        prometheus.io/port: '9090'\n        prometheus.io/scrape: 'true'\n        jenkins-x.io/hash: a042ef704bc21bfd8abcd79f32e9788ecad0bdb70e7653aff9458eda85bafe3b\n      labels:\n        app: lighthouse-keeper\n    spec:\n      serviceAccountName: lighthouse-keeper\n      containers:\n      - name: lighthouse-keeper\n        image: ghcr.io/jenkins-x/lighthouse-keeper:1.1.51\n        imagePullPolicy: IfNotPresent\n        args:\n        - --namespace=jx\n        ports:\n        - name: http\n          containerPort: 8888\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /\n            port: http\n          initialDelaySeconds: 120\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        readinessProbe:\n          httpGet:\n            path: /\n            port: http\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        env:\n        - name: GIT_KIND\n          value: github\n        - name: GIT_SERVER\n          value: https://github.com\n        - name: GIT_USER\n          value: skreet2k\n        - name: GIT_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: lighthouse-oauth-token\n              key: oauth\n        - name: JX_LOG_FORMAT\n          value: json\n        - name: LOGRUS_FORMAT\n          value: json\n        - name: LOGRUS_SERVICE\n          value: lighthouse\n        - name: LOGRUS_SERVICE_VERSION\n          value: 1.1.51\n        - name: LOGRUS_STACK_SKIP\n          value: ''\n        - name: LIGHTHOUSE_KEEPER_STATUS_CONTEXT_LABEL\n          value: Lighthouse Merge Status\n        - name: LIGHTHOUSE_TRIGGER_ON_MISSING\n          value: enable\n        envFrom:\n        - secretRef:\n            name: jx-boot-job-env-vars\n            optional: true\n        resources:\n          limits:\n            cpu: 400m\n            memory: 512Mi\n          requests:\n            cpu: 100m\n            memory: 128Mi\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"lighthouse-keeper\" is not set to runAsNonRoot"
  },
  {
    "id": "04447",
    "manifest_path": "data/manifests/the_stack_sample/sample_2047.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: privileged\nspec:\n  securityContext:\n    runAsNonRoot: true\n  containers:\n  - name: privileged\n    image: busybox\n    command:\n    - sleep\n    - '9999'\n    securityContext:\n      allowPrivilegeEscalation: true\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"privileged\" is using an invalid container image, \"busybox\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "04448",
    "manifest_path": "data/manifests/the_stack_sample/sample_2047.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: privileged\nspec:\n  securityContext:\n    runAsNonRoot: true\n  containers:\n  - name: privileged\n    image: busybox\n    command:\n    - sleep\n    - '9999'\n    securityContext:\n      allowPrivilegeEscalation: true\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"privileged\" does not have a read-only root file system"
  },
  {
    "id": "04449",
    "manifest_path": "data/manifests/the_stack_sample/sample_2047.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: privileged\nspec:\n  securityContext:\n    runAsNonRoot: true\n  containers:\n  - name: privileged\n    image: busybox\n    command:\n    - sleep\n    - '9999'\n    securityContext:\n      allowPrivilegeEscalation: true\n",
    "policy_id": "privilege-escalation-container",
    "violation_text": "container \"privileged\" has AllowPrivilegeEscalation set to true."
  },
  {
    "id": "04450",
    "manifest_path": "data/manifests/the_stack_sample/sample_2047.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: privileged\nspec:\n  securityContext:\n    runAsNonRoot: true\n  containers:\n  - name: privileged\n    image: busybox\n    command:\n    - sleep\n    - '9999'\n    securityContext:\n      allowPrivilegeEscalation: true\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"privileged\" has cpu request 0"
  },
  {
    "id": "04451",
    "manifest_path": "data/manifests/the_stack_sample/sample_2047.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: privileged\nspec:\n  securityContext:\n    runAsNonRoot: true\n  containers:\n  - name: privileged\n    image: busybox\n    command:\n    - sleep\n    - '9999'\n    securityContext:\n      allowPrivilegeEscalation: true\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"privileged\" has memory limit 0"
  },
  {
    "id": "04452",
    "manifest_path": "data/manifests/the_stack_sample/sample_2050.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: azure-cloud-controller-manager\n  namespace: kube-system\nspec:\n  containers:\n  - name: cloud-controller-manager\n    image: mcr.microsoft.com/oss/kubernetes/azure-cloud-controller-manager:v1.0.0\n    imagePullPolicy: IfNotPresent\n    command:\n    - cloud-controller-manager\n    args:\n    - --cloud-provider=azure\n    - --controllers=cloud-node\n    - --kubeconfig=/etc/kubernetes/secrets/kubeconfig\n    - --cloud-config=/etc/kubernetes/configs/cloud.conf\n    - --leader-elect=false\n    - --port=10267\n    - -v=2\n    livenessProbe:\n      httpGet:\n        path: /healthz\n        port: 10267\n      initialDelaySeconds: 20\n      periodSeconds: 10\n      timeoutSeconds: 5\n    volumeMounts:\n    - name: secrets\n      mountPath: /etc/kubernetes/secrets\n    - name: configs\n      mountPath: /etc/kubernetes/configs\n  volumes:\n  - name: secrets\n    hostPath:\n      path: /etc/kubernetes/bootstrap-secrets\n  - name: configs\n    hostPath:\n      path: /etc/kubernetes/bootstrap-configs\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"cloud-controller-manager\" does not have a read-only root file system"
  },
  {
    "id": "04453",
    "manifest_path": "data/manifests/the_stack_sample/sample_2050.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: azure-cloud-controller-manager\n  namespace: kube-system\nspec:\n  containers:\n  - name: cloud-controller-manager\n    image: mcr.microsoft.com/oss/kubernetes/azure-cloud-controller-manager:v1.0.0\n    imagePullPolicy: IfNotPresent\n    command:\n    - cloud-controller-manager\n    args:\n    - --cloud-provider=azure\n    - --controllers=cloud-node\n    - --kubeconfig=/etc/kubernetes/secrets/kubeconfig\n    - --cloud-config=/etc/kubernetes/configs/cloud.conf\n    - --leader-elect=false\n    - --port=10267\n    - -v=2\n    livenessProbe:\n      httpGet:\n        path: /healthz\n        port: 10267\n      initialDelaySeconds: 20\n      periodSeconds: 10\n      timeoutSeconds: 5\n    volumeMounts:\n    - name: secrets\n      mountPath: /etc/kubernetes/secrets\n    - name: configs\n      mountPath: /etc/kubernetes/configs\n  volumes:\n  - name: secrets\n    hostPath:\n      path: /etc/kubernetes/bootstrap-secrets\n  - name: configs\n    hostPath:\n      path: /etc/kubernetes/bootstrap-configs\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"cloud-controller-manager\" is not set to runAsNonRoot"
  },
  {
    "id": "04454",
    "manifest_path": "data/manifests/the_stack_sample/sample_2050.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: azure-cloud-controller-manager\n  namespace: kube-system\nspec:\n  containers:\n  - name: cloud-controller-manager\n    image: mcr.microsoft.com/oss/kubernetes/azure-cloud-controller-manager:v1.0.0\n    imagePullPolicy: IfNotPresent\n    command:\n    - cloud-controller-manager\n    args:\n    - --cloud-provider=azure\n    - --controllers=cloud-node\n    - --kubeconfig=/etc/kubernetes/secrets/kubeconfig\n    - --cloud-config=/etc/kubernetes/configs/cloud.conf\n    - --leader-elect=false\n    - --port=10267\n    - -v=2\n    livenessProbe:\n      httpGet:\n        path: /healthz\n        port: 10267\n      initialDelaySeconds: 20\n      periodSeconds: 10\n      timeoutSeconds: 5\n    volumeMounts:\n    - name: secrets\n      mountPath: /etc/kubernetes/secrets\n    - name: configs\n      mountPath: /etc/kubernetes/configs\n  volumes:\n  - name: secrets\n    hostPath:\n      path: /etc/kubernetes/bootstrap-secrets\n  - name: configs\n    hostPath:\n      path: /etc/kubernetes/bootstrap-configs\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"cloud-controller-manager\" has cpu request 0"
  },
  {
    "id": "04455",
    "manifest_path": "data/manifests/the_stack_sample/sample_2050.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: azure-cloud-controller-manager\n  namespace: kube-system\nspec:\n  containers:\n  - name: cloud-controller-manager\n    image: mcr.microsoft.com/oss/kubernetes/azure-cloud-controller-manager:v1.0.0\n    imagePullPolicy: IfNotPresent\n    command:\n    - cloud-controller-manager\n    args:\n    - --cloud-provider=azure\n    - --controllers=cloud-node\n    - --kubeconfig=/etc/kubernetes/secrets/kubeconfig\n    - --cloud-config=/etc/kubernetes/configs/cloud.conf\n    - --leader-elect=false\n    - --port=10267\n    - -v=2\n    livenessProbe:\n      httpGet:\n        path: /healthz\n        port: 10267\n      initialDelaySeconds: 20\n      periodSeconds: 10\n      timeoutSeconds: 5\n    volumeMounts:\n    - name: secrets\n      mountPath: /etc/kubernetes/secrets\n    - name: configs\n      mountPath: /etc/kubernetes/configs\n  volumes:\n  - name: secrets\n    hostPath:\n      path: /etc/kubernetes/bootstrap-secrets\n  - name: configs\n    hostPath:\n      path: /etc/kubernetes/bootstrap-configs\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"cloud-controller-manager\" has memory limit 0"
  },
  {
    "id": "04456",
    "manifest_path": "data/manifests/the_stack_sample/sample_2052.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: ci\n  name: statusreconciler\n  labels:\n    app: prow\n    component: statusreconciler\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: prow\n      component: statusreconciler\n  template:\n    metadata:\n      labels:\n        app: prow\n        component: statusreconciler\n    spec:\n      serviceAccountName: statusreconciler\n      containers:\n      - name: statusreconciler\n        image: gcr.io/k8s-prow/status-reconciler:v20220115-3e20513bd7\n        imagePullPolicy: IfNotPresent\n        args:\n        - --dry-run=false\n        - --continue-on-error=true\n        - --plugin-config=/etc/plugins/plugins.yaml\n        - --supplemental-plugin-config-dir=/etc/plugins\n        - --config-path=/etc/config/config.yaml\n        - --supplemental-prow-config-dir=/etc/config\n        - --github-app-id=$(GITHUB_APP_ID)\n        - --github-app-private-key-path=/etc/github/cert\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --github-graphql-endpoint=http://ghproxy/graphql\n        - --job-config-path=/etc/job-config\n        - --projected-token-file=/var/sa-token/token\n        env:\n        - name: GITHUB_APP_ID\n          valueFrom:\n            secretKeyRef:\n              name: openshift-prow-github-app\n              key: appid\n        ports:\n        - name: http\n          containerPort: 8888\n        volumeMounts:\n        - name: service-account-token\n          mountPath: /var/sa-token\n        - name: github-app-credentials\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        - name: plugins\n          mountPath: /etc/plugins\n          readOnly: true\n        resources:\n          requests:\n            memory: 200Mi\n            cpu: 20m\n      volumes:\n      - name: service-account-token\n        projected:\n          sources:\n          - serviceAccountToken:\n              path: token\n      - name: github-app-credentials\n        secret:\n          secretName: openshift-prow-github-app\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        projected:\n          sources:\n          - configMap:\n              name: job-config-misc\n          - configMap:\n              name: job-config-master-periodics\n          - configMap:\n              name: job-config-master-postsubmits\n          - configMap:\n              name: job-config-master-presubmits\n          - configMap:\n              name: job-config-3.x\n          - configMap:\n              name: job-config-4.1\n          - configMap:\n              name: job-config-4.2\n          - configMap:\n              name: job-config-4.3\n          - configMap:\n              name: job-config-4.4\n          - configMap:\n              name: job-config-4.5\n          - configMap:\n              name: job-config-4.6\n          - configMap:\n              name: job-config-4.7\n          - configMap:\n              name: job-config-4.8\n          - configMap:\n              name: job-config-4.9\n          - configMap:\n              name: job-config-4.10\n          - configMap:\n              name: job-config-4.11\n      - name: plugins\n        configMap:\n          name: plugins\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"statusreconciler\" does not have a read-only root file system"
  },
  {
    "id": "04457",
    "manifest_path": "data/manifests/the_stack_sample/sample_2052.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: ci\n  name: statusreconciler\n  labels:\n    app: prow\n    component: statusreconciler\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: prow\n      component: statusreconciler\n  template:\n    metadata:\n      labels:\n        app: prow\n        component: statusreconciler\n    spec:\n      serviceAccountName: statusreconciler\n      containers:\n      - name: statusreconciler\n        image: gcr.io/k8s-prow/status-reconciler:v20220115-3e20513bd7\n        imagePullPolicy: IfNotPresent\n        args:\n        - --dry-run=false\n        - --continue-on-error=true\n        - --plugin-config=/etc/plugins/plugins.yaml\n        - --supplemental-plugin-config-dir=/etc/plugins\n        - --config-path=/etc/config/config.yaml\n        - --supplemental-prow-config-dir=/etc/config\n        - --github-app-id=$(GITHUB_APP_ID)\n        - --github-app-private-key-path=/etc/github/cert\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --github-graphql-endpoint=http://ghproxy/graphql\n        - --job-config-path=/etc/job-config\n        - --projected-token-file=/var/sa-token/token\n        env:\n        - name: GITHUB_APP_ID\n          valueFrom:\n            secretKeyRef:\n              name: openshift-prow-github-app\n              key: appid\n        ports:\n        - name: http\n          containerPort: 8888\n        volumeMounts:\n        - name: service-account-token\n          mountPath: /var/sa-token\n        - name: github-app-credentials\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        - name: plugins\n          mountPath: /etc/plugins\n          readOnly: true\n        resources:\n          requests:\n            memory: 200Mi\n            cpu: 20m\n      volumes:\n      - name: service-account-token\n        projected:\n          sources:\n          - serviceAccountToken:\n              path: token\n      - name: github-app-credentials\n        secret:\n          secretName: openshift-prow-github-app\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        projected:\n          sources:\n          - configMap:\n              name: job-config-misc\n          - configMap:\n              name: job-config-master-periodics\n          - configMap:\n              name: job-config-master-postsubmits\n          - configMap:\n              name: job-config-master-presubmits\n          - configMap:\n              name: job-config-3.x\n          - configMap:\n              name: job-config-4.1\n          - configMap:\n              name: job-config-4.2\n          - configMap:\n              name: job-config-4.3\n          - configMap:\n              name: job-config-4.4\n          - configMap:\n              name: job-config-4.5\n          - configMap:\n              name: job-config-4.6\n          - configMap:\n              name: job-config-4.7\n          - configMap:\n              name: job-config-4.8\n          - configMap:\n              name: job-config-4.9\n          - configMap:\n              name: job-config-4.10\n          - configMap:\n              name: job-config-4.11\n      - name: plugins\n        configMap:\n          name: plugins\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"statusreconciler\" is not set to runAsNonRoot"
  },
  {
    "id": "04458",
    "manifest_path": "data/manifests/the_stack_sample/sample_2052.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: ci\n  name: statusreconciler\n  labels:\n    app: prow\n    component: statusreconciler\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: prow\n      component: statusreconciler\n  template:\n    metadata:\n      labels:\n        app: prow\n        component: statusreconciler\n    spec:\n      serviceAccountName: statusreconciler\n      containers:\n      - name: statusreconciler\n        image: gcr.io/k8s-prow/status-reconciler:v20220115-3e20513bd7\n        imagePullPolicy: IfNotPresent\n        args:\n        - --dry-run=false\n        - --continue-on-error=true\n        - --plugin-config=/etc/plugins/plugins.yaml\n        - --supplemental-plugin-config-dir=/etc/plugins\n        - --config-path=/etc/config/config.yaml\n        - --supplemental-prow-config-dir=/etc/config\n        - --github-app-id=$(GITHUB_APP_ID)\n        - --github-app-private-key-path=/etc/github/cert\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --github-graphql-endpoint=http://ghproxy/graphql\n        - --job-config-path=/etc/job-config\n        - --projected-token-file=/var/sa-token/token\n        env:\n        - name: GITHUB_APP_ID\n          valueFrom:\n            secretKeyRef:\n              name: openshift-prow-github-app\n              key: appid\n        ports:\n        - name: http\n          containerPort: 8888\n        volumeMounts:\n        - name: service-account-token\n          mountPath: /var/sa-token\n        - name: github-app-credentials\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        - name: plugins\n          mountPath: /etc/plugins\n          readOnly: true\n        resources:\n          requests:\n            memory: 200Mi\n            cpu: 20m\n      volumes:\n      - name: service-account-token\n        projected:\n          sources:\n          - serviceAccountToken:\n              path: token\n      - name: github-app-credentials\n        secret:\n          secretName: openshift-prow-github-app\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        projected:\n          sources:\n          - configMap:\n              name: job-config-misc\n          - configMap:\n              name: job-config-master-periodics\n          - configMap:\n              name: job-config-master-postsubmits\n          - configMap:\n              name: job-config-master-presubmits\n          - configMap:\n              name: job-config-3.x\n          - configMap:\n              name: job-config-4.1\n          - configMap:\n              name: job-config-4.2\n          - configMap:\n              name: job-config-4.3\n          - configMap:\n              name: job-config-4.4\n          - configMap:\n              name: job-config-4.5\n          - configMap:\n              name: job-config-4.6\n          - configMap:\n              name: job-config-4.7\n          - configMap:\n              name: job-config-4.8\n          - configMap:\n              name: job-config-4.9\n          - configMap:\n              name: job-config-4.10\n          - configMap:\n              name: job-config-4.11\n      - name: plugins\n        configMap:\n          name: plugins\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"statusreconciler\" has memory limit 0"
  },
  {
    "id": "04459",
    "manifest_path": "data/manifests/the_stack_sample/sample_2054.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: rook-ceph-tools\n  namespace: rook-ceph\n  labels:\n    app: rook-ceph-tools\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: rook-ceph-tools\n  template:\n    metadata:\n      labels:\n        app: rook-ceph-tools\n    spec:\n      containers:\n      - name: rook-ceph-tools\n        image: rook/ceph:v1.2.2\n        command:\n        - /tini\n        args:\n        - -g\n        - --\n        - /usr/local/bin/toolbox.sh\n        imagePullPolicy: IfNotPresent\n        env:\n        - name: ROOK_ADMIN_SECRET\n          valueFrom:\n            secretKeyRef:\n              name: rook-ceph-mon\n              key: admin-secret\n        volumeMounts:\n        - mountPath: /etc/ceph\n          name: ceph-config\n        - name: mon-endpoint-volume\n          mountPath: /etc/rook\n      volumes:\n      - name: mon-endpoint-volume\n        configMap:\n          name: rook-ceph-mon-endpoints\n          items:\n          - key: data\n            path: mon-endpoints\n      - name: ceph-config\n        emptyDir: {}\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"rook-ceph-tools\" does not have a read-only root file system"
  },
  {
    "id": "04460",
    "manifest_path": "data/manifests/the_stack_sample/sample_2054.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: rook-ceph-tools\n  namespace: rook-ceph\n  labels:\n    app: rook-ceph-tools\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: rook-ceph-tools\n  template:\n    metadata:\n      labels:\n        app: rook-ceph-tools\n    spec:\n      containers:\n      - name: rook-ceph-tools\n        image: rook/ceph:v1.2.2\n        command:\n        - /tini\n        args:\n        - -g\n        - --\n        - /usr/local/bin/toolbox.sh\n        imagePullPolicy: IfNotPresent\n        env:\n        - name: ROOK_ADMIN_SECRET\n          valueFrom:\n            secretKeyRef:\n              name: rook-ceph-mon\n              key: admin-secret\n        volumeMounts:\n        - mountPath: /etc/ceph\n          name: ceph-config\n        - name: mon-endpoint-volume\n          mountPath: /etc/rook\n      volumes:\n      - name: mon-endpoint-volume\n        configMap:\n          name: rook-ceph-mon-endpoints\n          items:\n          - key: data\n            path: mon-endpoints\n      - name: ceph-config\n        emptyDir: {}\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"rook-ceph-tools\" is not set to runAsNonRoot"
  },
  {
    "id": "04461",
    "manifest_path": "data/manifests/the_stack_sample/sample_2054.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: rook-ceph-tools\n  namespace: rook-ceph\n  labels:\n    app: rook-ceph-tools\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: rook-ceph-tools\n  template:\n    metadata:\n      labels:\n        app: rook-ceph-tools\n    spec:\n      containers:\n      - name: rook-ceph-tools\n        image: rook/ceph:v1.2.2\n        command:\n        - /tini\n        args:\n        - -g\n        - --\n        - /usr/local/bin/toolbox.sh\n        imagePullPolicy: IfNotPresent\n        env:\n        - name: ROOK_ADMIN_SECRET\n          valueFrom:\n            secretKeyRef:\n              name: rook-ceph-mon\n              key: admin-secret\n        volumeMounts:\n        - mountPath: /etc/ceph\n          name: ceph-config\n        - name: mon-endpoint-volume\n          mountPath: /etc/rook\n      volumes:\n      - name: mon-endpoint-volume\n        configMap:\n          name: rook-ceph-mon-endpoints\n          items:\n          - key: data\n            path: mon-endpoints\n      - name: ceph-config\n        emptyDir: {}\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"rook-ceph-tools\" has cpu request 0"
  },
  {
    "id": "04462",
    "manifest_path": "data/manifests/the_stack_sample/sample_2054.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: rook-ceph-tools\n  namespace: rook-ceph\n  labels:\n    app: rook-ceph-tools\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: rook-ceph-tools\n  template:\n    metadata:\n      labels:\n        app: rook-ceph-tools\n    spec:\n      containers:\n      - name: rook-ceph-tools\n        image: rook/ceph:v1.2.2\n        command:\n        - /tini\n        args:\n        - -g\n        - --\n        - /usr/local/bin/toolbox.sh\n        imagePullPolicy: IfNotPresent\n        env:\n        - name: ROOK_ADMIN_SECRET\n          valueFrom:\n            secretKeyRef:\n              name: rook-ceph-mon\n              key: admin-secret\n        volumeMounts:\n        - mountPath: /etc/ceph\n          name: ceph-config\n        - name: mon-endpoint-volume\n          mountPath: /etc/rook\n      volumes:\n      - name: mon-endpoint-volume\n        configMap:\n          name: rook-ceph-mon-endpoints\n          items:\n          - key: data\n            path: mon-endpoints\n      - name: ceph-config\n        emptyDir: {}\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"rook-ceph-tools\" has memory limit 0"
  },
  {
    "id": "04463",
    "manifest_path": "data/manifests/the_stack_sample/sample_2056.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: litmus-experiment\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: litmus-experiment\n  template:\n    metadata:\n      labels:\n        app: litmus-experiment\n    spec:\n      serviceAccountName: pod-io-error-retval-sa\n      containers:\n      - name: gotest\n        image: busybox\n        command:\n        - sleep\n        - '3600'\n        env:\n        - name: APP_NAMESPACE\n          value: default\n        - name: APP_LABEL\n          value: run=nginx\n        - name: APP_KIND\n          value: deployment\n        - name: TOTAL_CHAOS_DURATION\n          value: '60'\n        - name: CHAOS_INTERVAL\n          value: '10'\n        - name: MEMORY_CONSUMPTION\n          value: '500'\n        - name: PODS_AFFECTED_PERC\n          value: '100'\n        - name: LIB\n          value: litmus\n        - name: TARGET_POD\n          value: ''\n        - name: TARGET_CONTAINER\n          value: ''\n        - name: SEQUENCE\n          value: parallel\n        - name: CHAOS_NAMESPACE\n          value: default\n        - name: RAMP_TIME\n          value: ''\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"gotest\" is using an invalid container image, \"busybox\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "04464",
    "manifest_path": "data/manifests/the_stack_sample/sample_2056.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: litmus-experiment\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: litmus-experiment\n  template:\n    metadata:\n      labels:\n        app: litmus-experiment\n    spec:\n      serviceAccountName: pod-io-error-retval-sa\n      containers:\n      - name: gotest\n        image: busybox\n        command:\n        - sleep\n        - '3600'\n        env:\n        - name: APP_NAMESPACE\n          value: default\n        - name: APP_LABEL\n          value: run=nginx\n        - name: APP_KIND\n          value: deployment\n        - name: TOTAL_CHAOS_DURATION\n          value: '60'\n        - name: CHAOS_INTERVAL\n          value: '10'\n        - name: MEMORY_CONSUMPTION\n          value: '500'\n        - name: PODS_AFFECTED_PERC\n          value: '100'\n        - name: LIB\n          value: litmus\n        - name: TARGET_POD\n          value: ''\n        - name: TARGET_CONTAINER\n          value: ''\n        - name: SEQUENCE\n          value: parallel\n        - name: CHAOS_NAMESPACE\n          value: default\n        - name: RAMP_TIME\n          value: ''\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"gotest\" does not have a read-only root file system"
  },
  {
    "id": "04465",
    "manifest_path": "data/manifests/the_stack_sample/sample_2056.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: litmus-experiment\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: litmus-experiment\n  template:\n    metadata:\n      labels:\n        app: litmus-experiment\n    spec:\n      serviceAccountName: pod-io-error-retval-sa\n      containers:\n      - name: gotest\n        image: busybox\n        command:\n        - sleep\n        - '3600'\n        env:\n        - name: APP_NAMESPACE\n          value: default\n        - name: APP_LABEL\n          value: run=nginx\n        - name: APP_KIND\n          value: deployment\n        - name: TOTAL_CHAOS_DURATION\n          value: '60'\n        - name: CHAOS_INTERVAL\n          value: '10'\n        - name: MEMORY_CONSUMPTION\n          value: '500'\n        - name: PODS_AFFECTED_PERC\n          value: '100'\n        - name: LIB\n          value: litmus\n        - name: TARGET_POD\n          value: ''\n        - name: TARGET_CONTAINER\n          value: ''\n        - name: SEQUENCE\n          value: parallel\n        - name: CHAOS_NAMESPACE\n          value: default\n        - name: RAMP_TIME\n          value: ''\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"gotest\" is not set to runAsNonRoot"
  },
  {
    "id": "04466",
    "manifest_path": "data/manifests/the_stack_sample/sample_2056.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: litmus-experiment\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: litmus-experiment\n  template:\n    metadata:\n      labels:\n        app: litmus-experiment\n    spec:\n      serviceAccountName: pod-io-error-retval-sa\n      containers:\n      - name: gotest\n        image: busybox\n        command:\n        - sleep\n        - '3600'\n        env:\n        - name: APP_NAMESPACE\n          value: default\n        - name: APP_LABEL\n          value: run=nginx\n        - name: APP_KIND\n          value: deployment\n        - name: TOTAL_CHAOS_DURATION\n          value: '60'\n        - name: CHAOS_INTERVAL\n          value: '10'\n        - name: MEMORY_CONSUMPTION\n          value: '500'\n        - name: PODS_AFFECTED_PERC\n          value: '100'\n        - name: LIB\n          value: litmus\n        - name: TARGET_POD\n          value: ''\n        - name: TARGET_CONTAINER\n          value: ''\n        - name: SEQUENCE\n          value: parallel\n        - name: CHAOS_NAMESPACE\n          value: default\n        - name: RAMP_TIME\n          value: ''\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"gotest\" has cpu request 0"
  },
  {
    "id": "04467",
    "manifest_path": "data/manifests/the_stack_sample/sample_2056.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: litmus-experiment\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: litmus-experiment\n  template:\n    metadata:\n      labels:\n        app: litmus-experiment\n    spec:\n      serviceAccountName: pod-io-error-retval-sa\n      containers:\n      - name: gotest\n        image: busybox\n        command:\n        - sleep\n        - '3600'\n        env:\n        - name: APP_NAMESPACE\n          value: default\n        - name: APP_LABEL\n          value: run=nginx\n        - name: APP_KIND\n          value: deployment\n        - name: TOTAL_CHAOS_DURATION\n          value: '60'\n        - name: CHAOS_INTERVAL\n          value: '10'\n        - name: MEMORY_CONSUMPTION\n          value: '500'\n        - name: PODS_AFFECTED_PERC\n          value: '100'\n        - name: LIB\n          value: litmus\n        - name: TARGET_POD\n          value: ''\n        - name: TARGET_CONTAINER\n          value: ''\n        - name: SEQUENCE\n          value: parallel\n        - name: CHAOS_NAMESPACE\n          value: default\n        - name: RAMP_TIME\n          value: ''\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"gotest\" has memory limit 0"
  },
  {
    "id": "04468",
    "manifest_path": "data/manifests/the_stack_sample/sample_2057.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: frontend\nspec:\n  replicas: 3\n  template:\n    metadata:\n      labels:\n        app: guestbook\n        tier: frontend\n    spec:\n      containers:\n      - name: php-redis\n        image: gcr.io/google_samples/gb-frontend:v3\n        resources:\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        env:\n        - name: GET_HOSTS_FROM\n          value: dns\n        ports:\n        - containerPort: 80\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"php-redis\" does not have a read-only root file system"
  },
  {
    "id": "04469",
    "manifest_path": "data/manifests/the_stack_sample/sample_2057.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: frontend\nspec:\n  replicas: 3\n  template:\n    metadata:\n      labels:\n        app: guestbook\n        tier: frontend\n    spec:\n      containers:\n      - name: php-redis\n        image: gcr.io/google_samples/gb-frontend:v3\n        resources:\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        env:\n        - name: GET_HOSTS_FROM\n          value: dns\n        ports:\n        - containerPort: 80\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"php-redis\" is not set to runAsNonRoot"
  },
  {
    "id": "04470",
    "manifest_path": "data/manifests/the_stack_sample/sample_2057.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: frontend\nspec:\n  replicas: 3\n  template:\n    metadata:\n      labels:\n        app: guestbook\n        tier: frontend\n    spec:\n      containers:\n      - name: php-redis\n        image: gcr.io/google_samples/gb-frontend:v3\n        resources:\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        env:\n        - name: GET_HOSTS_FROM\n          value: dns\n        ports:\n        - containerPort: 80\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"php-redis\" has memory limit 0"
  },
  {
    "id": "04471",
    "manifest_path": "data/manifests/the_stack_sample/sample_2060.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  namespace: litmus\nspec:\n  template:\n    metadata:\n      labels:\n        name: nuodb-app-chaos\n    spec:\n      serviceAccountName: litmus\n      containers:\n      - name: ansibletest\n        image: openebs/ansible-runner:ci\n        env:\n        - name: ANSIBLE_STDOUT_CALLBACK\n          value: default\n        - name: APP_NAMESPACE\n          value: nuodbns\n        - name: APP_LABEL\n          value: nodetype=sm\n        - name: DEPLOY_TYPE\n          value: statefulset\n        command:\n        - /bin/bash\n        args:\n        - -c\n        - ansible-playbook ./apps/nuodb/chaos/app_pod_failure/test.yml -i /etc/ansible/hosts\n          -vv; exit 0\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"ansibletest\" does not have a read-only root file system"
  },
  {
    "id": "04472",
    "manifest_path": "data/manifests/the_stack_sample/sample_2060.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  namespace: litmus\nspec:\n  template:\n    metadata:\n      labels:\n        name: nuodb-app-chaos\n    spec:\n      serviceAccountName: litmus\n      containers:\n      - name: ansibletest\n        image: openebs/ansible-runner:ci\n        env:\n        - name: ANSIBLE_STDOUT_CALLBACK\n          value: default\n        - name: APP_NAMESPACE\n          value: nuodbns\n        - name: APP_LABEL\n          value: nodetype=sm\n        - name: DEPLOY_TYPE\n          value: statefulset\n        command:\n        - /bin/bash\n        args:\n        - -c\n        - ansible-playbook ./apps/nuodb/chaos/app_pod_failure/test.yml -i /etc/ansible/hosts\n          -vv; exit 0\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"ansibletest\" is not set to runAsNonRoot"
  },
  {
    "id": "04473",
    "manifest_path": "data/manifests/the_stack_sample/sample_2060.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  namespace: litmus\nspec:\n  template:\n    metadata:\n      labels:\n        name: nuodb-app-chaos\n    spec:\n      serviceAccountName: litmus\n      containers:\n      - name: ansibletest\n        image: openebs/ansible-runner:ci\n        env:\n        - name: ANSIBLE_STDOUT_CALLBACK\n          value: default\n        - name: APP_NAMESPACE\n          value: nuodbns\n        - name: APP_LABEL\n          value: nodetype=sm\n        - name: DEPLOY_TYPE\n          value: statefulset\n        command:\n        - /bin/bash\n        args:\n        - -c\n        - ansible-playbook ./apps/nuodb/chaos/app_pod_failure/test.yml -i /etc/ansible/hosts\n          -vv; exit 0\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"ansibletest\" has cpu request 0"
  },
  {
    "id": "04474",
    "manifest_path": "data/manifests/the_stack_sample/sample_2060.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  namespace: litmus\nspec:\n  template:\n    metadata:\n      labels:\n        name: nuodb-app-chaos\n    spec:\n      serviceAccountName: litmus\n      containers:\n      - name: ansibletest\n        image: openebs/ansible-runner:ci\n        env:\n        - name: ANSIBLE_STDOUT_CALLBACK\n          value: default\n        - name: APP_NAMESPACE\n          value: nuodbns\n        - name: APP_LABEL\n          value: nodetype=sm\n        - name: DEPLOY_TYPE\n          value: statefulset\n        command:\n        - /bin/bash\n        args:\n        - -c\n        - ansible-playbook ./apps/nuodb/chaos/app_pod_failure/test.yml -i /etc/ansible/hosts\n          -vv; exit 0\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"ansibletest\" has memory limit 0"
  },
  {
    "id": "04475",
    "manifest_path": "data/manifests/the_stack_sample/sample_2062.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  labels:\n    run: demo\n  name: demo\nspec:\n  containers:\n  - image: in-cluster\n    name: demo\n    imagePullPolicy: Never\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"demo\" is using an invalid container image, \"in-cluster\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "04476",
    "manifest_path": "data/manifests/the_stack_sample/sample_2062.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  labels:\n    run: demo\n  name: demo\nspec:\n  containers:\n  - image: in-cluster\n    name: demo\n    imagePullPolicy: Never\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"demo\" does not have a read-only root file system"
  },
  {
    "id": "04477",
    "manifest_path": "data/manifests/the_stack_sample/sample_2062.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  labels:\n    run: demo\n  name: demo\nspec:\n  containers:\n  - image: in-cluster\n    name: demo\n    imagePullPolicy: Never\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"demo\" is not set to runAsNonRoot"
  },
  {
    "id": "04478",
    "manifest_path": "data/manifests/the_stack_sample/sample_2062.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  labels:\n    run: demo\n  name: demo\nspec:\n  containers:\n  - image: in-cluster\n    name: demo\n    imagePullPolicy: Never\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"demo\" has cpu request 0"
  },
  {
    "id": "04479",
    "manifest_path": "data/manifests/the_stack_sample/sample_2062.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  labels:\n    run: demo\n  name: demo\nspec:\n  containers:\n  - image: in-cluster\n    name: demo\n    imagePullPolicy: Never\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"demo\" has memory limit 0"
  },
  {
    "id": "04480",
    "manifest_path": "data/manifests/the_stack_sample/sample_2064.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: kafka-background-producer-deployment\nspec:\n  selector:\n    matchLabels:\n      app: kafka-background-producer\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: kafka-background-producer\n    spec:\n      containers:\n      - name: kafka-background-producer\n        image: ${BACKENDV2_IMAGE}\n        command:\n        - npm\n        - run\n        - background-producer\n        imagePullPolicy: Always\n        resources:\n          requests:\n            memory: 300Mi\n            cpu: 100m\n          limits:\n            memory: 500Mi\n            cpu: 500m\n        env:\n        - name: NODE_ENV\n          value: production\n        - name: REDIS_HOST\n          value: quizzes-backend-redis-master.default.svc.cluster.local\n        - name: REDIS_PORT\n          value: '6379'\n        - name: REDIS_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: quizzes-backend-redis\n              key: redis-password\n        - name: DB_NAME\n          valueFrom:\n            secretKeyRef:\n              name: backend-database-secret\n              key: POSTGRES_DATABASE\n        - name: DB_HOST\n          valueFrom:\n            secretKeyRef:\n              name: backend-database-secret\n              key: POSTGRES_HOST\n        - name: DB_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: backend-database-secret\n              key: POSTGRES_PASSWORD\n        - name: DB_USER\n          valueFrom:\n            secretKeyRef:\n              name: backend-database-secret\n              key: POSTGRES_USERNAME\n        - name: KAFKA_HOST\n          valueFrom:\n            secretKeyRef:\n              name: backend-database-secret\n              key: KAFKA_HOST\n        - name: MESSAGE_FORMAT_VERSION\n          valueFrom:\n            secretKeyRef:\n              name: backend-database-secret\n              key: MESSAGE_FORMAT_VERSION\n        - name: NEW_RELIC_LICENSE_KEY\n          valueFrom:\n            secretKeyRef:\n              name: backend-database-secret\n              key: NEW_RELIC_LICENSE_KEY\n        - name: NEW_RELIC_APP_NAME\n          valueFrom:\n            secretKeyRef:\n              name: backend-database-secret\n              key: NEW_RELIC_APP_NAME\n        - name: NEW_RELIC_NO_CONFIG_FILE\n          value: 'true'\n        - name: SERVICE_ID\n          valueFrom:\n            secretKeyRef:\n              name: backend-database-secret\n              key: SERVICE_ID\n        - name: SENTRY_DSN\n          valueFrom:\n            secretKeyRef:\n              name: backend-database-secret\n              key: SENTRY_DSN\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"kafka-background-producer\" is using an invalid container image, \"${BACKENDV2_IMAGE}\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  }
]