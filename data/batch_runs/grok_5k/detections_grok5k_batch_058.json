[
  {
    "id": "02321",
    "manifest_path": "data/manifests/the_stack_sample/sample_0894.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: axonserver\n  labels:\n    app: axonserver\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: axonserver\n  template:\n    metadata:\n      labels:\n        app: axonserver\n    spec:\n      containers:\n      - name: axonserver\n        image: axoniq/axonserver\n        imagePullPolicy: Always\n        ports:\n        - name: grpc\n          containerPort: 8124\n          protocol: TCP\n        - name: http\n          containerPort: 8024\n          protocol: TCP\n        readinessProbe:\n          httpGet:\n            port: http\n            path: /actuator/info\n          initialDelaySeconds: 30\n          periodSeconds: 5\n          timeoutSeconds: 1\n        livenessProbe:\n          httpGet:\n            port: gui\n            path: /actuator/info\n          initialDelaySeconds: 30\n          periodSeconds: 5\n          timeoutSeconds: 1\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"axonserver\" has cpu request 0"
  },
  {
    "id": "02322",
    "manifest_path": "data/manifests/the_stack_sample/sample_0894.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: axonserver\n  labels:\n    app: axonserver\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: axonserver\n  template:\n    metadata:\n      labels:\n        app: axonserver\n    spec:\n      containers:\n      - name: axonserver\n        image: axoniq/axonserver\n        imagePullPolicy: Always\n        ports:\n        - name: grpc\n          containerPort: 8124\n          protocol: TCP\n        - name: http\n          containerPort: 8024\n          protocol: TCP\n        readinessProbe:\n          httpGet:\n            port: http\n            path: /actuator/info\n          initialDelaySeconds: 30\n          periodSeconds: 5\n          timeoutSeconds: 1\n        livenessProbe:\n          httpGet:\n            port: gui\n            path: /actuator/info\n          initialDelaySeconds: 30\n          periodSeconds: 5\n          timeoutSeconds: 1\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"axonserver\" has memory limit 0"
  },
  {
    "id": "02323",
    "manifest_path": "data/manifests/the_stack_sample/sample_0895.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: pod-httpd\n  annotations:\n    annotation1: hello\n  labels:\n    app: httpd\nspec:\n  containers:\n  - name: cntr-httpd\n    image: httpd:latest\n    ports:\n    - containerPort: 80\n    env:\n    - name: pod_name\n      valueFrom:\n        fieldRef:\n          fieldPath: metadata.name\n    - name: pod_namespace\n      valueFrom:\n        fieldRef:\n          fieldPath: metadata.namespace\n    - name: pod_nodeName\n      valueFrom:\n        fieldRef:\n          fieldPath: spec.nodeName\n    - name: pod_serviceAccountName\n      valueFrom:\n        fieldRef:\n          fieldPath: spec.serviceAccountName\n    - name: pod_hostIP\n      valueFrom:\n        fieldRef:\n          fieldPath: status.hostIP\n    - name: pod_podIP\n      valueFrom:\n        fieldRef:\n          fieldPath: status.podIP\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"cntr-httpd\" is using an invalid container image, \"httpd:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02324",
    "manifest_path": "data/manifests/the_stack_sample/sample_0895.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: pod-httpd\n  annotations:\n    annotation1: hello\n  labels:\n    app: httpd\nspec:\n  containers:\n  - name: cntr-httpd\n    image: httpd:latest\n    ports:\n    - containerPort: 80\n    env:\n    - name: pod_name\n      valueFrom:\n        fieldRef:\n          fieldPath: metadata.name\n    - name: pod_namespace\n      valueFrom:\n        fieldRef:\n          fieldPath: metadata.namespace\n    - name: pod_nodeName\n      valueFrom:\n        fieldRef:\n          fieldPath: spec.nodeName\n    - name: pod_serviceAccountName\n      valueFrom:\n        fieldRef:\n          fieldPath: spec.serviceAccountName\n    - name: pod_hostIP\n      valueFrom:\n        fieldRef:\n          fieldPath: status.hostIP\n    - name: pod_podIP\n      valueFrom:\n        fieldRef:\n          fieldPath: status.podIP\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"cntr-httpd\" does not have a read-only root file system"
  },
  {
    "id": "02325",
    "manifest_path": "data/manifests/the_stack_sample/sample_0895.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: pod-httpd\n  annotations:\n    annotation1: hello\n  labels:\n    app: httpd\nspec:\n  containers:\n  - name: cntr-httpd\n    image: httpd:latest\n    ports:\n    - containerPort: 80\n    env:\n    - name: pod_name\n      valueFrom:\n        fieldRef:\n          fieldPath: metadata.name\n    - name: pod_namespace\n      valueFrom:\n        fieldRef:\n          fieldPath: metadata.namespace\n    - name: pod_nodeName\n      valueFrom:\n        fieldRef:\n          fieldPath: spec.nodeName\n    - name: pod_serviceAccountName\n      valueFrom:\n        fieldRef:\n          fieldPath: spec.serviceAccountName\n    - name: pod_hostIP\n      valueFrom:\n        fieldRef:\n          fieldPath: status.hostIP\n    - name: pod_podIP\n      valueFrom:\n        fieldRef:\n          fieldPath: status.podIP\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"cntr-httpd\" is not set to runAsNonRoot"
  },
  {
    "id": "02326",
    "manifest_path": "data/manifests/the_stack_sample/sample_0895.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: pod-httpd\n  annotations:\n    annotation1: hello\n  labels:\n    app: httpd\nspec:\n  containers:\n  - name: cntr-httpd\n    image: httpd:latest\n    ports:\n    - containerPort: 80\n    env:\n    - name: pod_name\n      valueFrom:\n        fieldRef:\n          fieldPath: metadata.name\n    - name: pod_namespace\n      valueFrom:\n        fieldRef:\n          fieldPath: metadata.namespace\n    - name: pod_nodeName\n      valueFrom:\n        fieldRef:\n          fieldPath: spec.nodeName\n    - name: pod_serviceAccountName\n      valueFrom:\n        fieldRef:\n          fieldPath: spec.serviceAccountName\n    - name: pod_hostIP\n      valueFrom:\n        fieldRef:\n          fieldPath: status.hostIP\n    - name: pod_podIP\n      valueFrom:\n        fieldRef:\n          fieldPath: status.podIP\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"cntr-httpd\" has cpu request 0"
  },
  {
    "id": "02327",
    "manifest_path": "data/manifests/the_stack_sample/sample_0895.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: pod-httpd\n  annotations:\n    annotation1: hello\n  labels:\n    app: httpd\nspec:\n  containers:\n  - name: cntr-httpd\n    image: httpd:latest\n    ports:\n    - containerPort: 80\n    env:\n    - name: pod_name\n      valueFrom:\n        fieldRef:\n          fieldPath: metadata.name\n    - name: pod_namespace\n      valueFrom:\n        fieldRef:\n          fieldPath: metadata.namespace\n    - name: pod_nodeName\n      valueFrom:\n        fieldRef:\n          fieldPath: spec.nodeName\n    - name: pod_serviceAccountName\n      valueFrom:\n        fieldRef:\n          fieldPath: spec.serviceAccountName\n    - name: pod_hostIP\n      valueFrom:\n        fieldRef:\n          fieldPath: status.hostIP\n    - name: pod_podIP\n      valueFrom:\n        fieldRef:\n          fieldPath: status.podIP\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"cntr-httpd\" has memory limit 0"
  },
  {
    "id": "02328",
    "manifest_path": "data/manifests/the_stack_sample/sample_0907.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: id\nspec:\n  selector:\n    matchLabels:\n      app: id\n  template:\n    metadata:\n      labels:\n        app: id\n    spec:\n      containers:\n      - name: sitecore-xm1-id\n        env:\n        - name: Sitecore_Sitecore__IdentityServer__Clients__DefaultClient__AllowedCorsOrigins__AllowedCorsOriginsGroup2\n          value: https://hrz.globalhost\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"sitecore-xm1-id\" is using an invalid container image, \"\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02329",
    "manifest_path": "data/manifests/the_stack_sample/sample_0907.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: id\nspec:\n  selector:\n    matchLabels:\n      app: id\n  template:\n    metadata:\n      labels:\n        app: id\n    spec:\n      containers:\n      - name: sitecore-xm1-id\n        env:\n        - name: Sitecore_Sitecore__IdentityServer__Clients__DefaultClient__AllowedCorsOrigins__AllowedCorsOriginsGroup2\n          value: https://hrz.globalhost\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"sitecore-xm1-id\" does not have a read-only root file system"
  },
  {
    "id": "02330",
    "manifest_path": "data/manifests/the_stack_sample/sample_0907.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: id\nspec:\n  selector:\n    matchLabels:\n      app: id\n  template:\n    metadata:\n      labels:\n        app: id\n    spec:\n      containers:\n      - name: sitecore-xm1-id\n        env:\n        - name: Sitecore_Sitecore__IdentityServer__Clients__DefaultClient__AllowedCorsOrigins__AllowedCorsOriginsGroup2\n          value: https://hrz.globalhost\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"sitecore-xm1-id\" is not set to runAsNonRoot"
  },
  {
    "id": "02331",
    "manifest_path": "data/manifests/the_stack_sample/sample_0907.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: id\nspec:\n  selector:\n    matchLabels:\n      app: id\n  template:\n    metadata:\n      labels:\n        app: id\n    spec:\n      containers:\n      - name: sitecore-xm1-id\n        env:\n        - name: Sitecore_Sitecore__IdentityServer__Clients__DefaultClient__AllowedCorsOrigins__AllowedCorsOriginsGroup2\n          value: https://hrz.globalhost\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"sitecore-xm1-id\" has cpu request 0"
  },
  {
    "id": "02332",
    "manifest_path": "data/manifests/the_stack_sample/sample_0907.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: id\nspec:\n  selector:\n    matchLabels:\n      app: id\n  template:\n    metadata:\n      labels:\n        app: id\n    spec:\n      containers:\n      - name: sitecore-xm1-id\n        env:\n        - name: Sitecore_Sitecore__IdentityServer__Clients__DefaultClient__AllowedCorsOrigins__AllowedCorsOriginsGroup2\n          value: https://hrz.globalhost\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"sitecore-xm1-id\" has memory limit 0"
  },
  {
    "id": "02333",
    "manifest_path": "data/manifests/the_stack_sample/sample_0911.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-7699\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"nginx\" is using an invalid container image, \"nginx\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02334",
    "manifest_path": "data/manifests/the_stack_sample/sample_0911.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-7699\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"nginx\" does not have a read-only root file system"
  },
  {
    "id": "02335",
    "manifest_path": "data/manifests/the_stack_sample/sample_0911.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-7699\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"nginx\" is not set to runAsNonRoot"
  },
  {
    "id": "02336",
    "manifest_path": "data/manifests/the_stack_sample/sample_0911.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-7699\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"nginx\" has cpu request 0"
  },
  {
    "id": "02337",
    "manifest_path": "data/manifests/the_stack_sample/sample_0911.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-7699\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"nginx\" has memory limit 0"
  },
  {
    "id": "02338",
    "manifest_path": "data/manifests/the_stack_sample/sample_0914.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  namespace: litmus\nspec:\n  template:\n    metadata:\n      name: litmus\n      labels:\n        app: k8s-snapshot-litmus\n    spec:\n      serviceAccountName: litmus\n      containers:\n      - name: ansibletest\n        image: openebs/ansible-runner:ci\n        imagePullPolicy: IfNotPresent\n        env:\n        - name: ANSIBLE_STDOUT_CALLBACK\n          value: default\n        - name: APP_LABEL\n          value: name=percona\n        - name: APP_PVC\n          value: percona-mysql-claim\n        - name: APP_NAMESPACE\n          value: app-percona-ns\n        - name: PROVIDER_STORAGE_CLASS\n          value: openebs-snapshot-promoter\n        - name: DB_USER_NAME\n          value: root\n        - name: DB_PASSWORD\n          value: k8sDem0\n        - name: CLONE_VOL_CLAIM\n          value: snap-mysql-claim\n        - name: CLONE_APP_NAME\n          value: percona-new\n        - name: SNAPSHOT_NAME\n          value: snapshot-percona\n        - name: CAPACITY\n          value: 5Gi\n        command:\n        - /bin/bash\n        args:\n        - -c\n        - ansible-playbook ./apps/percona/functional/k8s_snapshot/test.yml -i /etc/ansible/hosts\n          -vv; exit 0\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"ansibletest\" does not have a read-only root file system"
  },
  {
    "id": "02339",
    "manifest_path": "data/manifests/the_stack_sample/sample_0914.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  namespace: litmus\nspec:\n  template:\n    metadata:\n      name: litmus\n      labels:\n        app: k8s-snapshot-litmus\n    spec:\n      serviceAccountName: litmus\n      containers:\n      - name: ansibletest\n        image: openebs/ansible-runner:ci\n        imagePullPolicy: IfNotPresent\n        env:\n        - name: ANSIBLE_STDOUT_CALLBACK\n          value: default\n        - name: APP_LABEL\n          value: name=percona\n        - name: APP_PVC\n          value: percona-mysql-claim\n        - name: APP_NAMESPACE\n          value: app-percona-ns\n        - name: PROVIDER_STORAGE_CLASS\n          value: openebs-snapshot-promoter\n        - name: DB_USER_NAME\n          value: root\n        - name: DB_PASSWORD\n          value: k8sDem0\n        - name: CLONE_VOL_CLAIM\n          value: snap-mysql-claim\n        - name: CLONE_APP_NAME\n          value: percona-new\n        - name: SNAPSHOT_NAME\n          value: snapshot-percona\n        - name: CAPACITY\n          value: 5Gi\n        command:\n        - /bin/bash\n        args:\n        - -c\n        - ansible-playbook ./apps/percona/functional/k8s_snapshot/test.yml -i /etc/ansible/hosts\n          -vv; exit 0\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"ansibletest\" is not set to runAsNonRoot"
  },
  {
    "id": "02340",
    "manifest_path": "data/manifests/the_stack_sample/sample_0914.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  namespace: litmus\nspec:\n  template:\n    metadata:\n      name: litmus\n      labels:\n        app: k8s-snapshot-litmus\n    spec:\n      serviceAccountName: litmus\n      containers:\n      - name: ansibletest\n        image: openebs/ansible-runner:ci\n        imagePullPolicy: IfNotPresent\n        env:\n        - name: ANSIBLE_STDOUT_CALLBACK\n          value: default\n        - name: APP_LABEL\n          value: name=percona\n        - name: APP_PVC\n          value: percona-mysql-claim\n        - name: APP_NAMESPACE\n          value: app-percona-ns\n        - name: PROVIDER_STORAGE_CLASS\n          value: openebs-snapshot-promoter\n        - name: DB_USER_NAME\n          value: root\n        - name: DB_PASSWORD\n          value: k8sDem0\n        - name: CLONE_VOL_CLAIM\n          value: snap-mysql-claim\n        - name: CLONE_APP_NAME\n          value: percona-new\n        - name: SNAPSHOT_NAME\n          value: snapshot-percona\n        - name: CAPACITY\n          value: 5Gi\n        command:\n        - /bin/bash\n        args:\n        - -c\n        - ansible-playbook ./apps/percona/functional/k8s_snapshot/test.yml -i /etc/ansible/hosts\n          -vv; exit 0\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"ansibletest\" has cpu request 0"
  },
  {
    "id": "02341",
    "manifest_path": "data/manifests/the_stack_sample/sample_0914.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  namespace: litmus\nspec:\n  template:\n    metadata:\n      name: litmus\n      labels:\n        app: k8s-snapshot-litmus\n    spec:\n      serviceAccountName: litmus\n      containers:\n      - name: ansibletest\n        image: openebs/ansible-runner:ci\n        imagePullPolicy: IfNotPresent\n        env:\n        - name: ANSIBLE_STDOUT_CALLBACK\n          value: default\n        - name: APP_LABEL\n          value: name=percona\n        - name: APP_PVC\n          value: percona-mysql-claim\n        - name: APP_NAMESPACE\n          value: app-percona-ns\n        - name: PROVIDER_STORAGE_CLASS\n          value: openebs-snapshot-promoter\n        - name: DB_USER_NAME\n          value: root\n        - name: DB_PASSWORD\n          value: k8sDem0\n        - name: CLONE_VOL_CLAIM\n          value: snap-mysql-claim\n        - name: CLONE_APP_NAME\n          value: percona-new\n        - name: SNAPSHOT_NAME\n          value: snapshot-percona\n        - name: CAPACITY\n          value: 5Gi\n        command:\n        - /bin/bash\n        args:\n        - -c\n        - ansible-playbook ./apps/percona/functional/k8s_snapshot/test.yml -i /etc/ansible/hosts\n          -vv; exit 0\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"ansibletest\" has memory limit 0"
  },
  {
    "id": "02342",
    "manifest_path": "data/manifests/the_stack_sample/sample_0917.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: prow-controller-manager\n  labels:\n    app: prow-controller-manager\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: prow-controller-manager\n  template:\n    metadata:\n      labels:\n        app: prow-controller-manager\n    spec:\n      serviceAccountName: prow-controller-manager\n      containers:\n      - name: prow-controller-manager\n        image: gcr.io/k8s-prow/prow-controller-manager:v20220513-69ff551a87\n        args:\n        - --config-path=/etc/config/config.yaml\n        - --dry-run=false\n        - --enable-controller=plank\n        - --job-config-path=/etc/job-config\n        env:\n        - name: KUBECONFIG\n          value: /etc/kubeconfig/config:/etc/kubeconfig-build-test-infra-trusted/kubeconfig\n        ports:\n        - name: metrics\n          containerPort: 9090\n        volumeMounts:\n        - mountPath: /etc/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        - mountPath: /etc/kubeconfig-build-test-infra-trusted\n          name: kubeconfig-build-test-infra-trusted\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 5\n        readinessProbe:\n          httpGet:\n            path: /healthz/ready\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 3\n      volumes:\n      - name: kubeconfig\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig\n      - name: kubeconfig-build-test-infra-trusted\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig-build-test-infra-trusted\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"prow-controller-manager\" does not have a read-only root file system"
  },
  {
    "id": "02343",
    "manifest_path": "data/manifests/the_stack_sample/sample_0917.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: prow-controller-manager\n  labels:\n    app: prow-controller-manager\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: prow-controller-manager\n  template:\n    metadata:\n      labels:\n        app: prow-controller-manager\n    spec:\n      serviceAccountName: prow-controller-manager\n      containers:\n      - name: prow-controller-manager\n        image: gcr.io/k8s-prow/prow-controller-manager:v20220513-69ff551a87\n        args:\n        - --config-path=/etc/config/config.yaml\n        - --dry-run=false\n        - --enable-controller=plank\n        - --job-config-path=/etc/job-config\n        env:\n        - name: KUBECONFIG\n          value: /etc/kubeconfig/config:/etc/kubeconfig-build-test-infra-trusted/kubeconfig\n        ports:\n        - name: metrics\n          containerPort: 9090\n        volumeMounts:\n        - mountPath: /etc/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        - mountPath: /etc/kubeconfig-build-test-infra-trusted\n          name: kubeconfig-build-test-infra-trusted\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 5\n        readinessProbe:\n          httpGet:\n            path: /healthz/ready\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 3\n      volumes:\n      - name: kubeconfig\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig\n      - name: kubeconfig-build-test-infra-trusted\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig-build-test-infra-trusted\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"prow-controller-manager\" is not set to runAsNonRoot"
  },
  {
    "id": "02344",
    "manifest_path": "data/manifests/the_stack_sample/sample_0917.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: prow-controller-manager\n  labels:\n    app: prow-controller-manager\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: prow-controller-manager\n  template:\n    metadata:\n      labels:\n        app: prow-controller-manager\n    spec:\n      serviceAccountName: prow-controller-manager\n      containers:\n      - name: prow-controller-manager\n        image: gcr.io/k8s-prow/prow-controller-manager:v20220513-69ff551a87\n        args:\n        - --config-path=/etc/config/config.yaml\n        - --dry-run=false\n        - --enable-controller=plank\n        - --job-config-path=/etc/job-config\n        env:\n        - name: KUBECONFIG\n          value: /etc/kubeconfig/config:/etc/kubeconfig-build-test-infra-trusted/kubeconfig\n        ports:\n        - name: metrics\n          containerPort: 9090\n        volumeMounts:\n        - mountPath: /etc/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        - mountPath: /etc/kubeconfig-build-test-infra-trusted\n          name: kubeconfig-build-test-infra-trusted\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 5\n        readinessProbe:\n          httpGet:\n            path: /healthz/ready\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 3\n      volumes:\n      - name: kubeconfig\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig\n      - name: kubeconfig-build-test-infra-trusted\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig-build-test-infra-trusted\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"prow-controller-manager\" has cpu request 0"
  },
  {
    "id": "02345",
    "manifest_path": "data/manifests/the_stack_sample/sample_0917.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: prow-controller-manager\n  labels:\n    app: prow-controller-manager\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: prow-controller-manager\n  template:\n    metadata:\n      labels:\n        app: prow-controller-manager\n    spec:\n      serviceAccountName: prow-controller-manager\n      containers:\n      - name: prow-controller-manager\n        image: gcr.io/k8s-prow/prow-controller-manager:v20220513-69ff551a87\n        args:\n        - --config-path=/etc/config/config.yaml\n        - --dry-run=false\n        - --enable-controller=plank\n        - --job-config-path=/etc/job-config\n        env:\n        - name: KUBECONFIG\n          value: /etc/kubeconfig/config:/etc/kubeconfig-build-test-infra-trusted/kubeconfig\n        ports:\n        - name: metrics\n          containerPort: 9090\n        volumeMounts:\n        - mountPath: /etc/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        - mountPath: /etc/kubeconfig-build-test-infra-trusted\n          name: kubeconfig-build-test-infra-trusted\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 5\n        readinessProbe:\n          httpGet:\n            path: /healthz/ready\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 3\n      volumes:\n      - name: kubeconfig\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig\n      - name: kubeconfig-build-test-infra-trusted\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig-build-test-infra-trusted\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"prow-controller-manager\" has memory limit 0"
  },
  {
    "id": "02346",
    "manifest_path": "data/manifests/the_stack_sample/sample_0919.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  namespace: mayastor\n  name: mayastor-csi\n  labels:\n    openebs/engine: mayastor\nspec:\n  selector:\n    matchLabels:\n      app: mayastor-csi\n  template:\n    metadata:\n      labels:\n        app: mayastor-csi\n    spec:\n      containers:\n      - name: mayastor-csi\n        image: mayadata/mayastor-csi:latest\n        imagePullPolicy: Always\n        securityContext:\n          privileged: true\n        env:\n        - name: MY_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: MY_POD_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: RUST_BACKTRACE\n          value: '1'\n        args:\n        - --csi-socket=/csi/csi.sock\n        - --node-name=$(MY_NODE_NAME)\n        - --grpc-endpoint=$(MY_POD_IP):10199\n        - -v\n        volumeMounts:\n        - name: device\n          mountPath: /dev\n        - name: sys\n          mountPath: /sys\n        - name: run-udev\n          mountPath: /run/udev\n        - name: host-root\n          mountPath: /host\n        - name: plugin-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: Bidirectional\n        resources:\n          limits:\n            cpu: 100m\n            memory: 50Mi\n          requests:\n            cpu: 100m\n            memory: 50Mi\n      - name: csi-driver-registrar\n        image: quay.io/k8scsi/csi-node-driver-registrar:v1.3.0\n        args:\n        - --csi-address=/csi/csi.sock\n        - --kubelet-registration-path=/var/lib/kubelet/plugins/mayastor.openebs.io/csi.sock\n        volumeMounts:\n        - name: plugin-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n        resources:\n          limits:\n            cpu: 100m\n            memory: 50Mi\n          requests:\n            cpu: 100m\n            memory: 50Mi\n        ports:\n        - containerPort: 10199\n          protocol: TCP\n          name: mayastor-node\n      volumes:\n      - name: device\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: sys\n        hostPath:\n          path: /sys\n          type: Directory\n      - name: run-udev\n        hostPath:\n          path: /run/udev\n          type: Directory\n      - name: host-root\n        hostPath:\n          path: /\n          type: Directory\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: plugin-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/mayastor.openebs.io/\n          type: DirectoryOrCreate\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"mayastor-csi\" is using an invalid container image, \"mayadata/mayastor-csi:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02347",
    "manifest_path": "data/manifests/the_stack_sample/sample_0919.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  namespace: mayastor\n  name: mayastor-csi\n  labels:\n    openebs/engine: mayastor\nspec:\n  selector:\n    matchLabels:\n      app: mayastor-csi\n  template:\n    metadata:\n      labels:\n        app: mayastor-csi\n    spec:\n      containers:\n      - name: mayastor-csi\n        image: mayadata/mayastor-csi:latest\n        imagePullPolicy: Always\n        securityContext:\n          privileged: true\n        env:\n        - name: MY_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: MY_POD_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: RUST_BACKTRACE\n          value: '1'\n        args:\n        - --csi-socket=/csi/csi.sock\n        - --node-name=$(MY_NODE_NAME)\n        - --grpc-endpoint=$(MY_POD_IP):10199\n        - -v\n        volumeMounts:\n        - name: device\n          mountPath: /dev\n        - name: sys\n          mountPath: /sys\n        - name: run-udev\n          mountPath: /run/udev\n        - name: host-root\n          mountPath: /host\n        - name: plugin-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: Bidirectional\n        resources:\n          limits:\n            cpu: 100m\n            memory: 50Mi\n          requests:\n            cpu: 100m\n            memory: 50Mi\n      - name: csi-driver-registrar\n        image: quay.io/k8scsi/csi-node-driver-registrar:v1.3.0\n        args:\n        - --csi-address=/csi/csi.sock\n        - --kubelet-registration-path=/var/lib/kubelet/plugins/mayastor.openebs.io/csi.sock\n        volumeMounts:\n        - name: plugin-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n        resources:\n          limits:\n            cpu: 100m\n            memory: 50Mi\n          requests:\n            cpu: 100m\n            memory: 50Mi\n        ports:\n        - containerPort: 10199\n          protocol: TCP\n          name: mayastor-node\n      volumes:\n      - name: device\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: sys\n        hostPath:\n          path: /sys\n          type: Directory\n      - name: run-udev\n        hostPath:\n          path: /run/udev\n          type: Directory\n      - name: host-root\n        hostPath:\n          path: /\n          type: Directory\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: plugin-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/mayastor.openebs.io/\n          type: DirectoryOrCreate\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"csi-driver-registrar\" does not have a read-only root file system"
  },
  {
    "id": "02348",
    "manifest_path": "data/manifests/the_stack_sample/sample_0919.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  namespace: mayastor\n  name: mayastor-csi\n  labels:\n    openebs/engine: mayastor\nspec:\n  selector:\n    matchLabels:\n      app: mayastor-csi\n  template:\n    metadata:\n      labels:\n        app: mayastor-csi\n    spec:\n      containers:\n      - name: mayastor-csi\n        image: mayadata/mayastor-csi:latest\n        imagePullPolicy: Always\n        securityContext:\n          privileged: true\n        env:\n        - name: MY_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: MY_POD_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: RUST_BACKTRACE\n          value: '1'\n        args:\n        - --csi-socket=/csi/csi.sock\n        - --node-name=$(MY_NODE_NAME)\n        - --grpc-endpoint=$(MY_POD_IP):10199\n        - -v\n        volumeMounts:\n        - name: device\n          mountPath: /dev\n        - name: sys\n          mountPath: /sys\n        - name: run-udev\n          mountPath: /run/udev\n        - name: host-root\n          mountPath: /host\n        - name: plugin-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: Bidirectional\n        resources:\n          limits:\n            cpu: 100m\n            memory: 50Mi\n          requests:\n            cpu: 100m\n            memory: 50Mi\n      - name: csi-driver-registrar\n        image: quay.io/k8scsi/csi-node-driver-registrar:v1.3.0\n        args:\n        - --csi-address=/csi/csi.sock\n        - --kubelet-registration-path=/var/lib/kubelet/plugins/mayastor.openebs.io/csi.sock\n        volumeMounts:\n        - name: plugin-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n        resources:\n          limits:\n            cpu: 100m\n            memory: 50Mi\n          requests:\n            cpu: 100m\n            memory: 50Mi\n        ports:\n        - containerPort: 10199\n          protocol: TCP\n          name: mayastor-node\n      volumes:\n      - name: device\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: sys\n        hostPath:\n          path: /sys\n          type: Directory\n      - name: run-udev\n        hostPath:\n          path: /run/udev\n          type: Directory\n      - name: host-root\n        hostPath:\n          path: /\n          type: Directory\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: plugin-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/mayastor.openebs.io/\n          type: DirectoryOrCreate\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"mayastor-csi\" does not have a read-only root file system"
  },
  {
    "id": "02349",
    "manifest_path": "data/manifests/the_stack_sample/sample_0919.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  namespace: mayastor\n  name: mayastor-csi\n  labels:\n    openebs/engine: mayastor\nspec:\n  selector:\n    matchLabels:\n      app: mayastor-csi\n  template:\n    metadata:\n      labels:\n        app: mayastor-csi\n    spec:\n      containers:\n      - name: mayastor-csi\n        image: mayadata/mayastor-csi:latest\n        imagePullPolicy: Always\n        securityContext:\n          privileged: true\n        env:\n        - name: MY_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: MY_POD_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: RUST_BACKTRACE\n          value: '1'\n        args:\n        - --csi-socket=/csi/csi.sock\n        - --node-name=$(MY_NODE_NAME)\n        - --grpc-endpoint=$(MY_POD_IP):10199\n        - -v\n        volumeMounts:\n        - name: device\n          mountPath: /dev\n        - name: sys\n          mountPath: /sys\n        - name: run-udev\n          mountPath: /run/udev\n        - name: host-root\n          mountPath: /host\n        - name: plugin-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: Bidirectional\n        resources:\n          limits:\n            cpu: 100m\n            memory: 50Mi\n          requests:\n            cpu: 100m\n            memory: 50Mi\n      - name: csi-driver-registrar\n        image: quay.io/k8scsi/csi-node-driver-registrar:v1.3.0\n        args:\n        - --csi-address=/csi/csi.sock\n        - --kubelet-registration-path=/var/lib/kubelet/plugins/mayastor.openebs.io/csi.sock\n        volumeMounts:\n        - name: plugin-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n        resources:\n          limits:\n            cpu: 100m\n            memory: 50Mi\n          requests:\n            cpu: 100m\n            memory: 50Mi\n        ports:\n        - containerPort: 10199\n          protocol: TCP\n          name: mayastor-node\n      volumes:\n      - name: device\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: sys\n        hostPath:\n          path: /sys\n          type: Directory\n      - name: run-udev\n        hostPath:\n          path: /run/udev\n          type: Directory\n      - name: host-root\n        hostPath:\n          path: /\n          type: Directory\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: plugin-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/mayastor.openebs.io/\n          type: DirectoryOrCreate\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n",
    "policy_id": "privilege-escalation-container",
    "violation_text": "container \"mayastor-csi\" is Privileged hence allows privilege escalation."
  },
  {
    "id": "02350",
    "manifest_path": "data/manifests/the_stack_sample/sample_0919.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  namespace: mayastor\n  name: mayastor-csi\n  labels:\n    openebs/engine: mayastor\nspec:\n  selector:\n    matchLabels:\n      app: mayastor-csi\n  template:\n    metadata:\n      labels:\n        app: mayastor-csi\n    spec:\n      containers:\n      - name: mayastor-csi\n        image: mayadata/mayastor-csi:latest\n        imagePullPolicy: Always\n        securityContext:\n          privileged: true\n        env:\n        - name: MY_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: MY_POD_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: RUST_BACKTRACE\n          value: '1'\n        args:\n        - --csi-socket=/csi/csi.sock\n        - --node-name=$(MY_NODE_NAME)\n        - --grpc-endpoint=$(MY_POD_IP):10199\n        - -v\n        volumeMounts:\n        - name: device\n          mountPath: /dev\n        - name: sys\n          mountPath: /sys\n        - name: run-udev\n          mountPath: /run/udev\n        - name: host-root\n          mountPath: /host\n        - name: plugin-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: Bidirectional\n        resources:\n          limits:\n            cpu: 100m\n            memory: 50Mi\n          requests:\n            cpu: 100m\n            memory: 50Mi\n      - name: csi-driver-registrar\n        image: quay.io/k8scsi/csi-node-driver-registrar:v1.3.0\n        args:\n        - --csi-address=/csi/csi.sock\n        - --kubelet-registration-path=/var/lib/kubelet/plugins/mayastor.openebs.io/csi.sock\n        volumeMounts:\n        - name: plugin-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n        resources:\n          limits:\n            cpu: 100m\n            memory: 50Mi\n          requests:\n            cpu: 100m\n            memory: 50Mi\n        ports:\n        - containerPort: 10199\n          protocol: TCP\n          name: mayastor-node\n      volumes:\n      - name: device\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: sys\n        hostPath:\n          path: /sys\n          type: Directory\n      - name: run-udev\n        hostPath:\n          path: /run/udev\n          type: Directory\n      - name: host-root\n        hostPath:\n          path: /\n          type: Directory\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: plugin-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/mayastor.openebs.io/\n          type: DirectoryOrCreate\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n",
    "policy_id": "privileged-container",
    "violation_text": "container \"mayastor-csi\" is privileged"
  },
  {
    "id": "02351",
    "manifest_path": "data/manifests/the_stack_sample/sample_0919.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  namespace: mayastor\n  name: mayastor-csi\n  labels:\n    openebs/engine: mayastor\nspec:\n  selector:\n    matchLabels:\n      app: mayastor-csi\n  template:\n    metadata:\n      labels:\n        app: mayastor-csi\n    spec:\n      containers:\n      - name: mayastor-csi\n        image: mayadata/mayastor-csi:latest\n        imagePullPolicy: Always\n        securityContext:\n          privileged: true\n        env:\n        - name: MY_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: MY_POD_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: RUST_BACKTRACE\n          value: '1'\n        args:\n        - --csi-socket=/csi/csi.sock\n        - --node-name=$(MY_NODE_NAME)\n        - --grpc-endpoint=$(MY_POD_IP):10199\n        - -v\n        volumeMounts:\n        - name: device\n          mountPath: /dev\n        - name: sys\n          mountPath: /sys\n        - name: run-udev\n          mountPath: /run/udev\n        - name: host-root\n          mountPath: /host\n        - name: plugin-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: Bidirectional\n        resources:\n          limits:\n            cpu: 100m\n            memory: 50Mi\n          requests:\n            cpu: 100m\n            memory: 50Mi\n      - name: csi-driver-registrar\n        image: quay.io/k8scsi/csi-node-driver-registrar:v1.3.0\n        args:\n        - --csi-address=/csi/csi.sock\n        - --kubelet-registration-path=/var/lib/kubelet/plugins/mayastor.openebs.io/csi.sock\n        volumeMounts:\n        - name: plugin-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n        resources:\n          limits:\n            cpu: 100m\n            memory: 50Mi\n          requests:\n            cpu: 100m\n            memory: 50Mi\n        ports:\n        - containerPort: 10199\n          protocol: TCP\n          name: mayastor-node\n      volumes:\n      - name: device\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: sys\n        hostPath:\n          path: /sys\n          type: Directory\n      - name: run-udev\n        hostPath:\n          path: /run/udev\n          type: Directory\n      - name: host-root\n        hostPath:\n          path: /\n          type: Directory\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: plugin-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/mayastor.openebs.io/\n          type: DirectoryOrCreate\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"csi-driver-registrar\" is not set to runAsNonRoot"
  },
  {
    "id": "02352",
    "manifest_path": "data/manifests/the_stack_sample/sample_0919.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  namespace: mayastor\n  name: mayastor-csi\n  labels:\n    openebs/engine: mayastor\nspec:\n  selector:\n    matchLabels:\n      app: mayastor-csi\n  template:\n    metadata:\n      labels:\n        app: mayastor-csi\n    spec:\n      containers:\n      - name: mayastor-csi\n        image: mayadata/mayastor-csi:latest\n        imagePullPolicy: Always\n        securityContext:\n          privileged: true\n        env:\n        - name: MY_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: MY_POD_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: RUST_BACKTRACE\n          value: '1'\n        args:\n        - --csi-socket=/csi/csi.sock\n        - --node-name=$(MY_NODE_NAME)\n        - --grpc-endpoint=$(MY_POD_IP):10199\n        - -v\n        volumeMounts:\n        - name: device\n          mountPath: /dev\n        - name: sys\n          mountPath: /sys\n        - name: run-udev\n          mountPath: /run/udev\n        - name: host-root\n          mountPath: /host\n        - name: plugin-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: Bidirectional\n        resources:\n          limits:\n            cpu: 100m\n            memory: 50Mi\n          requests:\n            cpu: 100m\n            memory: 50Mi\n      - name: csi-driver-registrar\n        image: quay.io/k8scsi/csi-node-driver-registrar:v1.3.0\n        args:\n        - --csi-address=/csi/csi.sock\n        - --kubelet-registration-path=/var/lib/kubelet/plugins/mayastor.openebs.io/csi.sock\n        volumeMounts:\n        - name: plugin-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n        resources:\n          limits:\n            cpu: 100m\n            memory: 50Mi\n          requests:\n            cpu: 100m\n            memory: 50Mi\n        ports:\n        - containerPort: 10199\n          protocol: TCP\n          name: mayastor-node\n      volumes:\n      - name: device\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: sys\n        hostPath:\n          path: /sys\n          type: Directory\n      - name: run-udev\n        hostPath:\n          path: /run/udev\n          type: Directory\n      - name: host-root\n        hostPath:\n          path: /\n          type: Directory\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: plugin-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/mayastor.openebs.io/\n          type: DirectoryOrCreate\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"mayastor-csi\" is not set to runAsNonRoot"
  },
  {
    "id": "02353",
    "manifest_path": "data/manifests/the_stack_sample/sample_0920.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: nginx-plus-ingress-rc\n  labels:\n    app: nginx-plus-ingress\nspec:\n  replicas: 1\n  selector:\n    app: nginx-plus-ingress\n  template:\n    metadata:\n      labels:\n        app: nginx-plus-ingress\n    spec:\n      serviceAccountName: nginx-ingress\n      containers:\n      - image: nginx-plus-ingress:1.0.0\n        name: nginx-plus-ingress\n        ports:\n        - containerPort: 80\n          hostPort: 80\n        - containerPort: 443\n          hostPort: 443\n        - containerPort: 8080\n          hostPort: 8080\n        env:\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        args:\n        - -nginx-plus\n        - -default-server-tls-secret=$(POD_NAMESPACE)/default-server-secret\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"nginx-plus-ingress\" does not have a read-only root file system"
  },
  {
    "id": "02354",
    "manifest_path": "data/manifests/the_stack_sample/sample_0920.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: nginx-plus-ingress-rc\n  labels:\n    app: nginx-plus-ingress\nspec:\n  replicas: 1\n  selector:\n    app: nginx-plus-ingress\n  template:\n    metadata:\n      labels:\n        app: nginx-plus-ingress\n    spec:\n      serviceAccountName: nginx-ingress\n      containers:\n      - image: nginx-plus-ingress:1.0.0\n        name: nginx-plus-ingress\n        ports:\n        - containerPort: 80\n          hostPort: 80\n        - containerPort: 443\n          hostPort: 443\n        - containerPort: 8080\n          hostPort: 8080\n        env:\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        args:\n        - -nginx-plus\n        - -default-server-tls-secret=$(POD_NAMESPACE)/default-server-secret\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"nginx-plus-ingress\" is not set to runAsNonRoot"
  },
  {
    "id": "02355",
    "manifest_path": "data/manifests/the_stack_sample/sample_0920.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: nginx-plus-ingress-rc\n  labels:\n    app: nginx-plus-ingress\nspec:\n  replicas: 1\n  selector:\n    app: nginx-plus-ingress\n  template:\n    metadata:\n      labels:\n        app: nginx-plus-ingress\n    spec:\n      serviceAccountName: nginx-ingress\n      containers:\n      - image: nginx-plus-ingress:1.0.0\n        name: nginx-plus-ingress\n        ports:\n        - containerPort: 80\n          hostPort: 80\n        - containerPort: 443\n          hostPort: 443\n        - containerPort: 8080\n          hostPort: 8080\n        env:\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        args:\n        - -nginx-plus\n        - -default-server-tls-secret=$(POD_NAMESPACE)/default-server-secret\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"nginx-plus-ingress\" has cpu request 0"
  },
  {
    "id": "02356",
    "manifest_path": "data/manifests/the_stack_sample/sample_0920.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: nginx-plus-ingress-rc\n  labels:\n    app: nginx-plus-ingress\nspec:\n  replicas: 1\n  selector:\n    app: nginx-plus-ingress\n  template:\n    metadata:\n      labels:\n        app: nginx-plus-ingress\n    spec:\n      serviceAccountName: nginx-ingress\n      containers:\n      - image: nginx-plus-ingress:1.0.0\n        name: nginx-plus-ingress\n        ports:\n        - containerPort: 80\n          hostPort: 80\n        - containerPort: 443\n          hostPort: 443\n        - containerPort: 8080\n          hostPort: 8080\n        env:\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        args:\n        - -nginx-plus\n        - -default-server-tls-secret=$(POD_NAMESPACE)/default-server-secret\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"nginx-plus-ingress\" has memory limit 0"
  },
  {
    "id": "02357",
    "manifest_path": "data/manifests/the_stack_sample/sample_0923.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-874\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"nginx\" is using an invalid container image, \"nginx\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02358",
    "manifest_path": "data/manifests/the_stack_sample/sample_0923.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-874\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"nginx\" does not have a read-only root file system"
  },
  {
    "id": "02359",
    "manifest_path": "data/manifests/the_stack_sample/sample_0923.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-874\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"nginx\" is not set to runAsNonRoot"
  },
  {
    "id": "02360",
    "manifest_path": "data/manifests/the_stack_sample/sample_0923.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-874\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"nginx\" has cpu request 0"
  }
]