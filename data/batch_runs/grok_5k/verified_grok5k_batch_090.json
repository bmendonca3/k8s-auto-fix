[
  {
    "id": "03601",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  namespace: default\n  name: contacts1-migration\nspec:\n  initContainers:\n  - name: tmp-container\n    image: contacts1-server:stable\n    imagePullPolicy: Always\n    volumeMounts:\n    - mountPath: /atlas-migrations\n      name: migrations\n    command:\n    - cp\n    - -r\n    - /db/migrations\n    - /atlas-migrations\n    securityContext:\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      privileged: false\n      allowPrivilegeEscalation: false\n  containers:\n  - name: migration\n    env:\n    - name: CONFIG_FILE\n      value: defaults\n    image: infoblox/migrate:stable\n    imagePullPolicy: Always\n    volumeMounts:\n    - mountPath: /atlas-migrations\n      name: migrations\n    command:\n    - /migrate\n    args:\n    - --verbose\n    - --source\n    - file://atlas-migrations/migrations\n    - --database.address\n    - postgres.default:5432\n    - --database.name\n    - contacts1\n    - --database.user\n    - postgres\n    - --database.password\n    - postgres\n    - up\n    securityContext:\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      privileged: false\n      allowPrivilegeEscalation: false\n  volumes:\n  - name: migrations\n    emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "03602",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  namespace: default\n  name: contacts1-migration\nspec:\n  initContainers:\n  - name: tmp-container\n    image: contacts1-server:stable\n    imagePullPolicy: Always\n    volumeMounts:\n    - mountPath: /atlas-migrations\n      name: migrations\n    command:\n    - cp\n    - -r\n    - /db/migrations\n    - /atlas-migrations\n    securityContext:\n      readOnlyRootFilesystem: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n  containers:\n  - name: migration\n    env:\n    - name: CONFIG_FILE\n      value: defaults\n    image: infoblox/migrate:stable\n    imagePullPolicy: Always\n    volumeMounts:\n    - mountPath: /atlas-migrations\n      name: migrations\n    command:\n    - /migrate\n    args:\n    - --verbose\n    - --source\n    - file://atlas-migrations/migrations\n    - --database.address\n    - postgres.default:5432\n    - --database.name\n    - contacts1\n    - --database.user\n    - postgres\n    - --database.password\n    - postgres\n    - up\n    securityContext:\n      readOnlyRootFilesystem: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n  volumes:\n  - name: migrations\n    emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "03603",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  namespace: default\n  name: contacts1-migration\nspec:\n  initContainers:\n  - name: tmp-container\n    image: contacts1-server:stable\n    imagePullPolicy: Always\n    volumeMounts:\n    - mountPath: /atlas-migrations\n      name: migrations\n    command:\n    - cp\n    - -r\n    - /db/migrations\n    - /atlas-migrations\n    securityContext:\n      readOnlyRootFilesystem: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n  containers:\n  - name: migration\n    env:\n    - name: CONFIG_FILE\n      value: defaults\n    image: infoblox/migrate:stable\n    imagePullPolicy: Always\n    volumeMounts:\n    - mountPath: /atlas-migrations\n      name: migrations\n    command:\n    - /migrate\n    args:\n    - --verbose\n    - --source\n    - file://atlas-migrations/migrations\n    - --database.address\n    - postgres.default:5432\n    - --database.name\n    - contacts1\n    - --database.user\n    - postgres\n    - --database.password\n    - postgres\n    - up\n    securityContext:\n      readOnlyRootFilesystem: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n  volumes:\n  - name: migrations\n    emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "03604",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  namespace: default\n  name: contacts1-migration\nspec:\n  initContainers:\n  - name: tmp-container\n    image: contacts1-server:stable\n    imagePullPolicy: Always\n    volumeMounts:\n    - mountPath: /atlas-migrations\n      name: migrations\n    command:\n    - cp\n    - -r\n    - /db/migrations\n    - /atlas-migrations\n    securityContext:\n      runAsNonRoot: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n  containers:\n  - name: migration\n    env:\n    - name: CONFIG_FILE\n      value: defaults\n    image: infoblox/migrate:stable\n    imagePullPolicy: Always\n    volumeMounts:\n    - mountPath: /atlas-migrations\n      name: migrations\n    command:\n    - /migrate\n    args:\n    - --verbose\n    - --source\n    - file://atlas-migrations/migrations\n    - --database.address\n    - postgres.default:5432\n    - --database.name\n    - contacts1\n    - --database.user\n    - postgres\n    - --database.password\n    - postgres\n    - up\n    securityContext:\n      runAsNonRoot: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n  volumes:\n  - name: migrations\n    emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "03605",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  namespace: default\n  name: contacts1-migration\nspec:\n  initContainers:\n  - name: tmp-container\n    image: contacts1-server:stable\n    imagePullPolicy: Always\n    volumeMounts:\n    - mountPath: /atlas-migrations\n      name: migrations\n    command:\n    - cp\n    - -r\n    - /db/migrations\n    - /atlas-migrations\n    securityContext:\n      runAsNonRoot: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n  containers:\n  - name: migration\n    env:\n    - name: CONFIG_FILE\n      value: defaults\n    image: infoblox/migrate:stable\n    imagePullPolicy: Always\n    volumeMounts:\n    - mountPath: /atlas-migrations\n      name: migrations\n    command:\n    - /migrate\n    args:\n    - --verbose\n    - --source\n    - file://atlas-migrations/migrations\n    - --database.address\n    - postgres.default:5432\n    - --database.name\n    - contacts1\n    - --database.user\n    - postgres\n    - --database.password\n    - postgres\n    - up\n    securityContext:\n      runAsNonRoot: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n  volumes:\n  - name: migrations\n    emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "03606",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  namespace: default\n  name: contacts1-migration\nspec:\n  initContainers:\n  - name: tmp-container\n    image: contacts1-server:stable\n    imagePullPolicy: Always\n    volumeMounts:\n    - mountPath: /atlas-migrations\n      name: migrations\n    command:\n    - cp\n    - -r\n    - /db/migrations\n    - /atlas-migrations\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n  containers:\n  - name: migration\n    env:\n    - name: CONFIG_FILE\n      value: defaults\n    image: infoblox/migrate:stable\n    imagePullPolicy: Always\n    volumeMounts:\n    - mountPath: /atlas-migrations\n      name: migrations\n    command:\n    - /migrate\n    args:\n    - --verbose\n    - --source\n    - file://atlas-migrations/migrations\n    - --database.address\n    - postgres.default:5432\n    - --database.name\n    - contacts1\n    - --database.user\n    - postgres\n    - --database.password\n    - postgres\n    - up\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n  volumes:\n  - name: migrations\n    emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "03607",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  namespace: default\n  name: contacts1-migration\nspec:\n  initContainers:\n  - name: tmp-container\n    image: contacts1-server:stable\n    imagePullPolicy: Always\n    volumeMounts:\n    - mountPath: /atlas-migrations\n      name: migrations\n    command:\n    - cp\n    - -r\n    - /db/migrations\n    - /atlas-migrations\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n  containers:\n  - name: migration\n    env:\n    - name: CONFIG_FILE\n      value: defaults\n    image: infoblox/migrate:stable\n    imagePullPolicy: Always\n    volumeMounts:\n    - mountPath: /atlas-migrations\n      name: migrations\n    command:\n    - /migrate\n    args:\n    - --verbose\n    - --source\n    - file://atlas-migrations/migrations\n    - --database.address\n    - postgres.default:5432\n    - --database.name\n    - contacts1\n    - --database.user\n    - postgres\n    - --database.password\n    - postgres\n    - up\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n  volumes:\n  - name: migrations\n    emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "03608",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  namespace: default\n  name: contacts1-migration\nspec:\n  initContainers:\n  - name: tmp-container\n    image: contacts1-server:stable\n    imagePullPolicy: Always\n    volumeMounts:\n    - mountPath: /atlas-migrations\n      name: migrations\n    command:\n    - cp\n    - -r\n    - /db/migrations\n    - /atlas-migrations\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n  containers:\n  - name: migration\n    env:\n    - name: CONFIG_FILE\n      value: defaults\n    image: infoblox/migrate:stable\n    imagePullPolicy: Always\n    volumeMounts:\n    - mountPath: /atlas-migrations\n      name: migrations\n    command:\n    - /migrate\n    args:\n    - --verbose\n    - --source\n    - file://atlas-migrations/migrations\n    - --database.address\n    - postgres.default:5432\n    - --database.name\n    - contacts1\n    - --database.user\n    - postgres\n    - --database.password\n    - postgres\n    - up\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n  volumes:\n  - name: migrations\n    emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "03609",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  namespace: default\n  name: contacts1-migration\nspec:\n  initContainers:\n  - name: tmp-container\n    image: contacts1-server:stable\n    imagePullPolicy: Always\n    volumeMounts:\n    - mountPath: /atlas-migrations\n      name: migrations\n    command:\n    - cp\n    - -r\n    - /db/migrations\n    - /atlas-migrations\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n  containers:\n  - name: migration\n    env:\n    - name: CONFIG_FILE\n      value: defaults\n    image: infoblox/migrate:stable\n    imagePullPolicy: Always\n    volumeMounts:\n    - mountPath: /atlas-migrations\n      name: migrations\n    command:\n    - /migrate\n    args:\n    - --verbose\n    - --source\n    - file://atlas-migrations/migrations\n    - --database.address\n    - postgres.default:5432\n    - --database.name\n    - contacts1\n    - --database.user\n    - postgres\n    - --database.password\n    - postgres\n    - up\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n  volumes:\n  - name: migrations\n    emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "03610",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-2360\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    securityContext:\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      privileged: false\n      allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "03611",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-2360\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    securityContext:\n      readOnlyRootFilesystem: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "03612",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-2360\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    securityContext:\n      runAsNonRoot: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "03613",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-2360\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "03614",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-2360\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "03615",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: ReplicaSet\nmetadata:\n  name: priv-exec-replicaset\n  labels:\n    app: pentest\n    type: replicaset\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      type: replicaset\n  template:\n    metadata:\n      labels:\n        app: pentest\n        type: replicaset\n    spec:\n      containers:\n      - name: priv-exec-replicaset\n        image: ubuntu:stable\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        command:\n        - /bin/sh\n        - -c\n        - --\n        args:\n        - while true; do sleep 30; done;\n",
    "errors": []
  },
  {
    "id": "03616",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: ReplicaSet\nmetadata:\n  name: priv-exec-replicaset\n  labels:\n    app: pentest\n    type: replicaset\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      type: replicaset\n  template:\n    metadata:\n      labels:\n        app: pentest\n        type: replicaset\n    spec:\n      containers:\n      - name: priv-exec-replicaset\n        image: ubuntu:stable\n        securityContext:\n          privileged: false\n          readOnlyRootFilesystem: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        command:\n        - /bin/sh\n        - -c\n        - --\n        args:\n        - while true; do sleep 30; done;\n",
    "errors": []
  },
  {
    "id": "03617",
    "policy_id": "drop_capabilities",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: ReplicaSet\nmetadata:\n  name: priv-exec-replicaset\n  labels:\n    app: pentest\n    type: replicaset\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      type: replicaset\n  template:\n    metadata:\n      labels:\n        app: pentest\n        type: replicaset\n    spec:\n      containers:\n      - name: priv-exec-replicaset\n        image: ubuntu:stable\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        command:\n        - /bin/sh\n        - -c\n        - --\n        args:\n        - while true; do sleep 30; done;\n",
    "errors": []
  },
  {
    "id": "03618",
    "policy_id": "no_privileged",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: ReplicaSet\nmetadata:\n  name: priv-exec-replicaset\n  labels:\n    app: pentest\n    type: replicaset\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      type: replicaset\n  template:\n    metadata:\n      labels:\n        app: pentest\n        type: replicaset\n    spec:\n      containers:\n      - name: priv-exec-replicaset\n        image: ubuntu:stable\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        command:\n        - /bin/sh\n        - -c\n        - --\n        args:\n        - while true; do sleep 30; done;\n",
    "errors": []
  },
  {
    "id": "03619",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: ReplicaSet\nmetadata:\n  name: priv-exec-replicaset\n  labels:\n    app: pentest\n    type: replicaset\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      type: replicaset\n  template:\n    metadata:\n      labels:\n        app: pentest\n        type: replicaset\n    spec:\n      containers:\n      - name: priv-exec-replicaset\n        image: ubuntu:stable\n        securityContext:\n          privileged: false\n          runAsNonRoot: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        command:\n        - /bin/sh\n        - -c\n        - --\n        args:\n        - while true; do sleep 30; done;\n",
    "errors": []
  },
  {
    "id": "03620",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: ReplicaSet\nmetadata:\n  name: priv-exec-replicaset\n  labels:\n    app: pentest\n    type: replicaset\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      type: replicaset\n  template:\n    metadata:\n      labels:\n        app: pentest\n        type: replicaset\n    spec:\n      containers:\n      - name: priv-exec-replicaset\n        image: ubuntu:stable\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        command:\n        - /bin/sh\n        - -c\n        - --\n        args:\n        - while true; do sleep 30; done;\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "03621",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: ReplicaSet\nmetadata:\n  name: priv-exec-replicaset\n  labels:\n    app: pentest\n    type: replicaset\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      type: replicaset\n  template:\n    metadata:\n      labels:\n        app: pentest\n        type: replicaset\n    spec:\n      containers:\n      - name: priv-exec-replicaset\n        image: ubuntu:stable\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        command:\n        - /bin/sh\n        - -c\n        - --\n        args:\n        - while true; do sleep 30; done;\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "03622",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: prow-controller-manager\n  labels:\n    app: prow-controller-manager\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: prow-controller-manager\n  template:\n    metadata:\n      labels:\n        app: prow-controller-manager\n    spec:\n      serviceAccountName: prow-controller-manager\n      containers:\n      - name: prow-controller-manager\n        image: gcr.io/k8s-prow/prow-controller-manager:v20220203-c2195422bf\n        args:\n        - --config-path=/etc/config/config.yaml\n        - --dry-run=false\n        - --enable-controller=plank\n        - --job-config-path=/etc/job-config\n        env:\n        - name: KUBECONFIG\n          value: /etc/kubeconfig/config:/etc/kubeconfig-build-test-infra-trusted/kubeconfig\n        ports:\n        - name: metrics\n          containerPort: 9090\n        volumeMounts:\n        - mountPath: /etc/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        - mountPath: /etc/kubeconfig-build-test-infra-trusted\n          name: kubeconfig-build-test-infra-trusted\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 5\n        readinessProbe:\n          httpGet:\n            path: /healthz/ready\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 3\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: kubeconfig\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig\n      - name: kubeconfig-build-test-infra-trusted\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig-build-test-infra-trusted\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n",
    "errors": []
  },
  {
    "id": "03623",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: prow-controller-manager\n  labels:\n    app: prow-controller-manager\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: prow-controller-manager\n  template:\n    metadata:\n      labels:\n        app: prow-controller-manager\n    spec:\n      serviceAccountName: prow-controller-manager\n      containers:\n      - name: prow-controller-manager\n        image: gcr.io/k8s-prow/prow-controller-manager:v20220203-c2195422bf\n        args:\n        - --config-path=/etc/config/config.yaml\n        - --dry-run=false\n        - --enable-controller=plank\n        - --job-config-path=/etc/job-config\n        env:\n        - name: KUBECONFIG\n          value: /etc/kubeconfig/config:/etc/kubeconfig-build-test-infra-trusted/kubeconfig\n        ports:\n        - name: metrics\n          containerPort: 9090\n        volumeMounts:\n        - mountPath: /etc/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        - mountPath: /etc/kubeconfig-build-test-infra-trusted\n          name: kubeconfig-build-test-infra-trusted\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 5\n        readinessProbe:\n          httpGet:\n            path: /healthz/ready\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 3\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: kubeconfig\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig\n      - name: kubeconfig-build-test-infra-trusted\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig-build-test-infra-trusted\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n",
    "errors": []
  },
  {
    "id": "03624",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: prow-controller-manager\n  labels:\n    app: prow-controller-manager\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: prow-controller-manager\n  template:\n    metadata:\n      labels:\n        app: prow-controller-manager\n    spec:\n      serviceAccountName: prow-controller-manager\n      containers:\n      - name: prow-controller-manager\n        image: gcr.io/k8s-prow/prow-controller-manager:v20220203-c2195422bf\n        args:\n        - --config-path=/etc/config/config.yaml\n        - --dry-run=false\n        - --enable-controller=plank\n        - --job-config-path=/etc/job-config\n        env:\n        - name: KUBECONFIG\n          value: /etc/kubeconfig/config:/etc/kubeconfig-build-test-infra-trusted/kubeconfig\n        ports:\n        - name: metrics\n          containerPort: 9090\n        volumeMounts:\n        - mountPath: /etc/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        - mountPath: /etc/kubeconfig-build-test-infra-trusted\n          name: kubeconfig-build-test-infra-trusted\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 5\n        readinessProbe:\n          httpGet:\n            path: /healthz/ready\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 3\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: kubeconfig\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig\n      - name: kubeconfig-build-test-infra-trusted\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig-build-test-infra-trusted\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n",
    "errors": []
  },
  {
    "id": "03625",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: prow-controller-manager\n  labels:\n    app: prow-controller-manager\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: prow-controller-manager\n  template:\n    metadata:\n      labels:\n        app: prow-controller-manager\n    spec:\n      serviceAccountName: prow-controller-manager\n      containers:\n      - name: prow-controller-manager\n        image: gcr.io/k8s-prow/prow-controller-manager:v20220203-c2195422bf\n        args:\n        - --config-path=/etc/config/config.yaml\n        - --dry-run=false\n        - --enable-controller=plank\n        - --job-config-path=/etc/job-config\n        env:\n        - name: KUBECONFIG\n          value: /etc/kubeconfig/config:/etc/kubeconfig-build-test-infra-trusted/kubeconfig\n        ports:\n        - name: metrics\n          containerPort: 9090\n        volumeMounts:\n        - mountPath: /etc/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        - mountPath: /etc/kubeconfig-build-test-infra-trusted\n          name: kubeconfig-build-test-infra-trusted\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 5\n        readinessProbe:\n          httpGet:\n            path: /healthz/ready\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 3\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: kubeconfig\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig\n      - name: kubeconfig-build-test-infra-trusted\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig-build-test-infra-trusted\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n",
    "errors": []
  },
  {
    "id": "03626",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: pihole\n  name: pihole\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: pihole\n  template:\n    metadata:\n      labels:\n        app: pihole\n    spec:\n      containers:\n      - env:\n        - name: ServerIP\n          value: 192.168.1.100\n        - name: WEBPASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: pihole\n              key: ADMIN_PASSWORD\n        image: pihole/pihole:stable\n        imagePullPolicy: IfNotPresent\n        name: pihole\n        ports:\n        - containerPort: 80\n          name: pihole\n          protocol: TCP\n        - containerPort: 53\n          name: dns\n          protocol: TCP\n        - containerPort: 53\n          name: dns-udp\n          protocol: UDP\n        - containerPort: 443\n          name: pihole-ssl\n          protocol: TCP\n        - containerPort: 67\n          name: client-udp\n          protocol: UDP\n        volumeMounts:\n        - mountPath: /etc/pihole\n          name: config\n        - mountPath: /etc/dnsmasq.d/02-custom.conf\n          name: custom-dnsmasq\n          subPath: 02-custom.conf\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: config\n        persistentVolumeClaim:\n          claimName: pihole-pvc\n      - configMap:\n          defaultMode: 420\n          name: pihole-custom-dnsmasq\n        name: custom-dnsmasq\n",
    "errors": []
  },
  {
    "id": "03627",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: pihole\n  name: pihole\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: pihole\n  template:\n    metadata:\n      labels:\n        app: pihole\n    spec:\n      containers:\n      - env:\n        - name: ServerIP\n          value: 192.168.1.100\n        - name: WEBPASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: pihole\n              key: ADMIN_PASSWORD\n        image: pihole/pihole:stable\n        imagePullPolicy: IfNotPresent\n        name: pihole\n        ports:\n        - containerPort: 80\n          name: pihole\n          protocol: TCP\n        - containerPort: 53\n          name: dns\n          protocol: TCP\n        - containerPort: 53\n          name: dns-udp\n          protocol: UDP\n        - containerPort: 443\n          name: pihole-ssl\n          protocol: TCP\n        - containerPort: 67\n          name: client-udp\n          protocol: UDP\n        volumeMounts:\n        - mountPath: /etc/pihole\n          name: config\n        - mountPath: /etc/dnsmasq.d/02-custom.conf\n          name: custom-dnsmasq\n          subPath: 02-custom.conf\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: config\n        persistentVolumeClaim:\n          claimName: pihole-pvc\n      - configMap:\n          defaultMode: 420\n          name: pihole-custom-dnsmasq\n        name: custom-dnsmasq\n",
    "errors": []
  },
  {
    "id": "03628",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: pihole\n  name: pihole\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: pihole\n  template:\n    metadata:\n      labels:\n        app: pihole\n    spec:\n      containers:\n      - env:\n        - name: ServerIP\n          value: 192.168.1.100\n        - name: WEBPASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: pihole\n              key: ADMIN_PASSWORD\n        image: pihole/pihole:stable\n        imagePullPolicy: IfNotPresent\n        name: pihole\n        ports:\n        - containerPort: 80\n          name: pihole\n          protocol: TCP\n        - containerPort: 53\n          name: dns\n          protocol: TCP\n        - containerPort: 53\n          name: dns-udp\n          protocol: UDP\n        - containerPort: 443\n          name: pihole-ssl\n          protocol: TCP\n        - containerPort: 67\n          name: client-udp\n          protocol: UDP\n        volumeMounts:\n        - mountPath: /etc/pihole\n          name: config\n        - mountPath: /etc/dnsmasq.d/02-custom.conf\n          name: custom-dnsmasq\n          subPath: 02-custom.conf\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: config\n        persistentVolumeClaim:\n          claimName: pihole-pvc\n      - configMap:\n          defaultMode: 420\n          name: pihole-custom-dnsmasq\n        name: custom-dnsmasq\n",
    "errors": []
  },
  {
    "id": "03629",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: pihole\n  name: pihole\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: pihole\n  template:\n    metadata:\n      labels:\n        app: pihole\n    spec:\n      containers:\n      - env:\n        - name: ServerIP\n          value: 192.168.1.100\n        - name: WEBPASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: pihole\n              key: ADMIN_PASSWORD\n        image: pihole/pihole:stable\n        imagePullPolicy: IfNotPresent\n        name: pihole\n        ports:\n        - containerPort: 80\n          name: pihole\n          protocol: TCP\n        - containerPort: 53\n          name: dns\n          protocol: TCP\n        - containerPort: 53\n          name: dns-udp\n          protocol: UDP\n        - containerPort: 443\n          name: pihole-ssl\n          protocol: TCP\n        - containerPort: 67\n          name: client-udp\n          protocol: UDP\n        volumeMounts:\n        - mountPath: /etc/pihole\n          name: config\n        - mountPath: /etc/dnsmasq.d/02-custom.conf\n          name: custom-dnsmasq\n          subPath: 02-custom.conf\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: config\n        persistentVolumeClaim:\n          claimName: pihole-pvc\n      - configMap:\n          defaultMode: 420\n          name: pihole-custom-dnsmasq\n        name: custom-dnsmasq\n",
    "errors": []
  },
  {
    "id": "03630",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: pihole\n  name: pihole\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: pihole\n  template:\n    metadata:\n      labels:\n        app: pihole\n    spec:\n      containers:\n      - env:\n        - name: ServerIP\n          value: 192.168.1.100\n        - name: WEBPASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: pihole\n              key: ADMIN_PASSWORD\n        image: pihole/pihole:stable\n        imagePullPolicy: IfNotPresent\n        name: pihole\n        ports:\n        - containerPort: 80\n          name: pihole\n          protocol: TCP\n        - containerPort: 53\n          name: dns\n          protocol: TCP\n        - containerPort: 53\n          name: dns-udp\n          protocol: UDP\n        - containerPort: 443\n          name: pihole-ssl\n          protocol: TCP\n        - containerPort: 67\n          name: client-udp\n          protocol: UDP\n        volumeMounts:\n        - mountPath: /etc/pihole\n          name: config\n        - mountPath: /etc/dnsmasq.d/02-custom.conf\n          name: custom-dnsmasq\n          subPath: 02-custom.conf\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: config\n        persistentVolumeClaim:\n          claimName: pihole-pvc\n      - configMap:\n          defaultMode: 420\n          name: pihole-custom-dnsmasq\n        name: custom-dnsmasq\n",
    "errors": []
  },
  {
    "id": "03631",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: proxy-deployment-canary\n  labels:\n    app: proxy-canary\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: proxy-canary\n  template:\n    metadata:\n      labels:\n        app: proxy-canary\n    spec:\n      containers:\n      - name: proxy-canary\n        image: gcr.io/GCP_PROJECT/IMAGE_NAME:bazel\n        ports:\n        - containerPort: 30000\n          name: health-check\n        - containerPort: 30001\n          name: whois\n        - containerPort: 30002\n          name: epp\n        - containerPort: 30010\n          name: http-whois\n        - containerPort: 30011\n          name: https-whois\n        readinessProbe:\n          tcpSocket:\n            port: health-check\n          initialDelaySeconds: 5\n          periodSeconds: 10\n        livenessProbe:\n          tcpSocket:\n            port: health-check\n          initialDelaySeconds: 15\n          periodSeconds: 20\n        imagePullPolicy: Always\n        args:\n        - --env\n        - sandbox_canary\n        - --log\n        env:\n        - name: POD_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: NAMESPACE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: CONTAINER_NAME\n          value: proxy-canary\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "03632",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: proxy-deployment-canary\n  labels:\n    app: proxy-canary\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: proxy-canary\n  template:\n    metadata:\n      labels:\n        app: proxy-canary\n    spec:\n      containers:\n      - name: proxy-canary\n        image: gcr.io/GCP_PROJECT/IMAGE_NAME:bazel\n        ports:\n        - containerPort: 30000\n          name: health-check\n        - containerPort: 30001\n          name: whois\n        - containerPort: 30002\n          name: epp\n        - containerPort: 30010\n          name: http-whois\n        - containerPort: 30011\n          name: https-whois\n        readinessProbe:\n          tcpSocket:\n            port: health-check\n          initialDelaySeconds: 5\n          periodSeconds: 10\n        livenessProbe:\n          tcpSocket:\n            port: health-check\n          initialDelaySeconds: 15\n          periodSeconds: 20\n        imagePullPolicy: Always\n        args:\n        - --env\n        - sandbox_canary\n        - --log\n        env:\n        - name: POD_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: NAMESPACE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: CONTAINER_NAME\n          value: proxy-canary\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "03633",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: proxy-deployment-canary\n  labels:\n    app: proxy-canary\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: proxy-canary\n  template:\n    metadata:\n      labels:\n        app: proxy-canary\n    spec:\n      containers:\n      - name: proxy-canary\n        image: gcr.io/GCP_PROJECT/IMAGE_NAME:bazel\n        ports:\n        - containerPort: 30000\n          name: health-check\n        - containerPort: 30001\n          name: whois\n        - containerPort: 30002\n          name: epp\n        - containerPort: 30010\n          name: http-whois\n        - containerPort: 30011\n          name: https-whois\n        readinessProbe:\n          tcpSocket:\n            port: health-check\n          initialDelaySeconds: 5\n          periodSeconds: 10\n        livenessProbe:\n          tcpSocket:\n            port: health-check\n          initialDelaySeconds: 15\n          periodSeconds: 20\n        imagePullPolicy: Always\n        args:\n        - --env\n        - sandbox_canary\n        - --log\n        env:\n        - name: POD_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: NAMESPACE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: CONTAINER_NAME\n          value: proxy-canary\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "03634",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: proxy-deployment-canary\n  labels:\n    app: proxy-canary\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: proxy-canary\n  template:\n    metadata:\n      labels:\n        app: proxy-canary\n    spec:\n      containers:\n      - name: proxy-canary\n        image: gcr.io/GCP_PROJECT/IMAGE_NAME:bazel\n        ports:\n        - containerPort: 30000\n          name: health-check\n        - containerPort: 30001\n          name: whois\n        - containerPort: 30002\n          name: epp\n        - containerPort: 30010\n          name: http-whois\n        - containerPort: 30011\n          name: https-whois\n        readinessProbe:\n          tcpSocket:\n            port: health-check\n          initialDelaySeconds: 5\n          periodSeconds: 10\n        livenessProbe:\n          tcpSocket:\n            port: health-check\n          initialDelaySeconds: 15\n          periodSeconds: 20\n        imagePullPolicy: Always\n        args:\n        - --env\n        - sandbox_canary\n        - --log\n        env:\n        - name: POD_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: NAMESPACE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: CONTAINER_NAME\n          value: proxy-canary\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "03635",
    "policy_id": "read_only_root_fs",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "03636",
    "policy_id": "run_as_non_root",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "03637",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: kube-apiserver\n  namespace: kube-system\nspec:\n  containers:\n  - name: kube-apiserver\n    image: quay.io/coreos/hyperkube:v${k8s_ver}_coreos.0\n    command:\n    - /hyperkube\n    - apiserver\n    - --apiserver-count=${api_server_count}\n    - --etcd-servers=${etcd_endpoints}\n    - --allow-privileged=true\n    - --service-cluster-ip-range=10.21.0.0/16\n    - --secure-port=443\n    - --insecure-port=8080\n    - --insecure-bind-address=0.0.0.0\n    - --audit-log-maxage=30\n    - --audit-log-maxsize=100\n    - --audit-log-path=/var/log/apiserver/audit.log\n    - --feature-gates=AdvancedAuditing=false\n    - --admission-control=NamespaceLifecycle,LimitRanger,ServiceAccount,DefaultStorageClass,ResourceQuota,Initializers\n    - --tls-cert-file=/etc/kubernetes/ssl/apiserver.pem\n    - --tls-private-key-file=/etc/kubernetes/ssl/apiserver-key.pem\n    - --client-ca-file=/etc/kubernetes/ssl/ca.pem\n    - --service-account-key-file=/etc/kubernetes/ssl/apiserver-key.pem\n    - --runtime-config=batch/v2alpha1,extensions/v1beta1=true,extensions/v1beta1/networkpolicies=true,admissionregistration.k8s.io/v1alpha1=true\n    - --anonymous-auth=false\n    - --authorization-mode=RBAC\n    - --etcd-quorum-read=true\n    - --kubelet-client-certificate=/etc/kubernetes/ssl/apiserver.pem\n    - --kubelet-client-key=/etc/kubernetes/ssl/apiserver-key.pem\n    - --token-auth-file=/etc/kubernetes/ssl/token_auth.csv\n    ports:\n    - containerPort: 443\n      hostPort: 443\n      name: https\n    - containerPort: 8080\n      hostPort: 8080\n      name: local\n    volumeMounts:\n    - mountPath: /etc/kubernetes/auth\n      name: auth-kubernetes\n      readOnly: true\n    - mountPath: /etc/kubernetes/ssl\n      name: ssl-certs-kubernetes\n      readOnly: true\n    - mountPath: /etc/ssl/certs\n      name: ssl-certs-host\n      readOnly: true\n    - mountPath: /var/log/apiserver\n      name: apiserver-logs\n      readOnly: false\n    securityContext:\n      readOnlyRootFilesystem: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n  volumes:\n  - hostPath:\n      path: /etc/kubernetes/auth\n    name: auth-kubernetes\n  - hostPath:\n      path: /etc/kubernetes/ssl\n    name: ssl-certs-kubernetes\n  - hostPath:\n      path: /etc/ssl/certs\n    name: ssl-certs-host\n  - hostPath:\n      path: /var/log/apiserver\n    name: apiserver-logs\n",
    "errors": []
  },
  {
    "id": "03638",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: kube-apiserver\n  namespace: kube-system\nspec:\n  containers:\n  - name: kube-apiserver\n    image: quay.io/coreos/hyperkube:v${k8s_ver}_coreos.0\n    command:\n    - /hyperkube\n    - apiserver\n    - --apiserver-count=${api_server_count}\n    - --etcd-servers=${etcd_endpoints}\n    - --allow-privileged=true\n    - --service-cluster-ip-range=10.21.0.0/16\n    - --secure-port=443\n    - --insecure-port=8080\n    - --insecure-bind-address=0.0.0.0\n    - --audit-log-maxage=30\n    - --audit-log-maxsize=100\n    - --audit-log-path=/var/log/apiserver/audit.log\n    - --feature-gates=AdvancedAuditing=false\n    - --admission-control=NamespaceLifecycle,LimitRanger,ServiceAccount,DefaultStorageClass,ResourceQuota,Initializers\n    - --tls-cert-file=/etc/kubernetes/ssl/apiserver.pem\n    - --tls-private-key-file=/etc/kubernetes/ssl/apiserver-key.pem\n    - --client-ca-file=/etc/kubernetes/ssl/ca.pem\n    - --service-account-key-file=/etc/kubernetes/ssl/apiserver-key.pem\n    - --runtime-config=batch/v2alpha1,extensions/v1beta1=true,extensions/v1beta1/networkpolicies=true,admissionregistration.k8s.io/v1alpha1=true\n    - --anonymous-auth=false\n    - --authorization-mode=RBAC\n    - --etcd-quorum-read=true\n    - --kubelet-client-certificate=/etc/kubernetes/ssl/apiserver.pem\n    - --kubelet-client-key=/etc/kubernetes/ssl/apiserver-key.pem\n    - --token-auth-file=/etc/kubernetes/ssl/token_auth.csv\n    ports:\n    - containerPort: 443\n      hostPort: 443\n      name: https\n    - containerPort: 8080\n      hostPort: 8080\n      name: local\n    volumeMounts:\n    - mountPath: /etc/kubernetes/auth\n      name: auth-kubernetes\n      readOnly: true\n    - mountPath: /etc/kubernetes/ssl\n      name: ssl-certs-kubernetes\n      readOnly: true\n    - mountPath: /etc/ssl/certs\n      name: ssl-certs-host\n      readOnly: true\n    - mountPath: /var/log/apiserver\n      name: apiserver-logs\n      readOnly: false\n    securityContext:\n      runAsNonRoot: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n  volumes:\n  - hostPath:\n      path: /etc/kubernetes/auth\n    name: auth-kubernetes\n  - hostPath:\n      path: /etc/kubernetes/ssl\n    name: ssl-certs-kubernetes\n  - hostPath:\n      path: /etc/ssl/certs\n    name: ssl-certs-host\n  - hostPath:\n      path: /var/log/apiserver\n    name: apiserver-logs\n",
    "errors": []
  },
  {
    "id": "03639",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: kube-apiserver\n  namespace: kube-system\nspec:\n  containers:\n  - name: kube-apiserver\n    image: quay.io/coreos/hyperkube:v${k8s_ver}_coreos.0\n    command:\n    - /hyperkube\n    - apiserver\n    - --apiserver-count=${api_server_count}\n    - --etcd-servers=${etcd_endpoints}\n    - --allow-privileged=true\n    - --service-cluster-ip-range=10.21.0.0/16\n    - --secure-port=443\n    - --insecure-port=8080\n    - --insecure-bind-address=0.0.0.0\n    - --audit-log-maxage=30\n    - --audit-log-maxsize=100\n    - --audit-log-path=/var/log/apiserver/audit.log\n    - --feature-gates=AdvancedAuditing=false\n    - --admission-control=NamespaceLifecycle,LimitRanger,ServiceAccount,DefaultStorageClass,ResourceQuota,Initializers\n    - --tls-cert-file=/etc/kubernetes/ssl/apiserver.pem\n    - --tls-private-key-file=/etc/kubernetes/ssl/apiserver-key.pem\n    - --client-ca-file=/etc/kubernetes/ssl/ca.pem\n    - --service-account-key-file=/etc/kubernetes/ssl/apiserver-key.pem\n    - --runtime-config=batch/v2alpha1,extensions/v1beta1=true,extensions/v1beta1/networkpolicies=true,admissionregistration.k8s.io/v1alpha1=true\n    - --anonymous-auth=false\n    - --authorization-mode=RBAC\n    - --etcd-quorum-read=true\n    - --kubelet-client-certificate=/etc/kubernetes/ssl/apiserver.pem\n    - --kubelet-client-key=/etc/kubernetes/ssl/apiserver-key.pem\n    - --token-auth-file=/etc/kubernetes/ssl/token_auth.csv\n    ports:\n    - containerPort: 443\n      hostPort: 443\n      name: https\n    - containerPort: 8080\n      hostPort: 8080\n      name: local\n    volumeMounts:\n    - mountPath: /etc/kubernetes/auth\n      name: auth-kubernetes\n      readOnly: true\n    - mountPath: /etc/kubernetes/ssl\n      name: ssl-certs-kubernetes\n      readOnly: true\n    - mountPath: /etc/ssl/certs\n      name: ssl-certs-host\n      readOnly: true\n    - mountPath: /var/log/apiserver\n      name: apiserver-logs\n      readOnly: false\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n  volumes:\n  - hostPath:\n      path: /etc/kubernetes/auth\n    name: auth-kubernetes\n  - hostPath:\n      path: /etc/kubernetes/ssl\n    name: ssl-certs-kubernetes\n  - hostPath:\n      path: /etc/ssl/certs\n    name: ssl-certs-host\n  - hostPath:\n      path: /var/log/apiserver\n    name: apiserver-logs\n",
    "errors": []
  },
  {
    "id": "03640",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: kube-apiserver\n  namespace: kube-system\nspec:\n  containers:\n  - name: kube-apiserver\n    image: quay.io/coreos/hyperkube:v${k8s_ver}_coreos.0\n    command:\n    - /hyperkube\n    - apiserver\n    - --apiserver-count=${api_server_count}\n    - --etcd-servers=${etcd_endpoints}\n    - --allow-privileged=true\n    - --service-cluster-ip-range=10.21.0.0/16\n    - --secure-port=443\n    - --insecure-port=8080\n    - --insecure-bind-address=0.0.0.0\n    - --audit-log-maxage=30\n    - --audit-log-maxsize=100\n    - --audit-log-path=/var/log/apiserver/audit.log\n    - --feature-gates=AdvancedAuditing=false\n    - --admission-control=NamespaceLifecycle,LimitRanger,ServiceAccount,DefaultStorageClass,ResourceQuota,Initializers\n    - --tls-cert-file=/etc/kubernetes/ssl/apiserver.pem\n    - --tls-private-key-file=/etc/kubernetes/ssl/apiserver-key.pem\n    - --client-ca-file=/etc/kubernetes/ssl/ca.pem\n    - --service-account-key-file=/etc/kubernetes/ssl/apiserver-key.pem\n    - --runtime-config=batch/v2alpha1,extensions/v1beta1=true,extensions/v1beta1/networkpolicies=true,admissionregistration.k8s.io/v1alpha1=true\n    - --anonymous-auth=false\n    - --authorization-mode=RBAC\n    - --etcd-quorum-read=true\n    - --kubelet-client-certificate=/etc/kubernetes/ssl/apiserver.pem\n    - --kubelet-client-key=/etc/kubernetes/ssl/apiserver-key.pem\n    - --token-auth-file=/etc/kubernetes/ssl/token_auth.csv\n    ports:\n    - containerPort: 443\n      hostPort: 443\n      name: https\n    - containerPort: 8080\n      hostPort: 8080\n      name: local\n    volumeMounts:\n    - mountPath: /etc/kubernetes/auth\n      name: auth-kubernetes\n      readOnly: true\n    - mountPath: /etc/kubernetes/ssl\n      name: ssl-certs-kubernetes\n      readOnly: true\n    - mountPath: /etc/ssl/certs\n      name: ssl-certs-host\n      readOnly: true\n    - mountPath: /var/log/apiserver\n      name: apiserver-logs\n      readOnly: false\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n  volumes:\n  - hostPath:\n      path: /etc/kubernetes/auth\n    name: auth-kubernetes\n  - hostPath:\n      path: /etc/kubernetes/ssl\n    name: ssl-certs-kubernetes\n  - hostPath:\n      path: /etc/ssl/certs\n    name: ssl-certs-host\n  - hostPath:\n      path: /var/log/apiserver\n    name: apiserver-logs\n",
    "errors": []
  }
]