[
  {
    "id": "02841",
    "manifest_path": "data/manifests/the_stack_sample/sample_1155.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: readiness-pod\n  labels:\n    test: readiness\n  namespace: default\nspec:\n  containers:\n  - name: readiness\n    env:\n    - name: APP_START_DELAY\n      value: '60'\n    image: kodekloud/webapp-delayed-start\n    resources: {}\n    imagePullPolicy: Always\n    ports:\n    - containerPort: 8080\n      protocol: TCP\n    readinessProbe:\n      httpGet:\n        path: /ready\n        port: 8080\n      initialDelaySeconds: 30\n      periodSeconds: 5\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"readiness\" has cpu request 0"
  },
  {
    "id": "02842",
    "manifest_path": "data/manifests/the_stack_sample/sample_1155.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: readiness-pod\n  labels:\n    test: readiness\n  namespace: default\nspec:\n  containers:\n  - name: readiness\n    env:\n    - name: APP_START_DELAY\n      value: '60'\n    image: kodekloud/webapp-delayed-start\n    resources: {}\n    imagePullPolicy: Always\n    ports:\n    - containerPort: 8080\n      protocol: TCP\n    readinessProbe:\n      httpGet:\n        path: /ready\n        port: 8080\n      initialDelaySeconds: 30\n      periodSeconds: 5\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"readiness\" has memory limit 0"
  },
  {
    "id": "02843",
    "manifest_path": "data/manifests/the_stack_sample/sample_1156.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: go-guestbook-backend\n  labels:\n    app: guestbook\n    tier: backend\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: guestbook\n      tier: backend\n  template:\n    metadata:\n      labels:\n        app: guestbook\n        tier: backend\n    spec:\n      initContainers:\n      - name: init-db-ready\n        image: mongo:4\n        command:\n        - /bin/sh\n        - -c\n        args:\n        - echo \"Waiting for mongodb at go-guestbook-mongodb:27017 to go live before\n          the BE...\";\n        - until (mongo --host go-guestbook-mongodb:27017 >/dev/null) do echo \"Waiting\n          for connection for 2 sec.\"; sleep 2; done\n      containers:\n      - name: backend\n        image: guestbook-backend\n        ports:\n        - name: http-server\n          containerPort: 8080\n        - name: debug\n          containerPort: 3000\n        readinessProbe:\n          tcpSocket:\n            port: 8080\n          initialDelaySeconds: 5\n          periodSeconds: 10\n        env:\n        - name: PORT\n          value: '8080'\n        - name: GUESTBOOK_DB_ADDR\n          value: go-guestbook-mongodb:27017\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"backend\" is using an invalid container image, \"guestbook-backend\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02844",
    "manifest_path": "data/manifests/the_stack_sample/sample_1156.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: go-guestbook-backend\n  labels:\n    app: guestbook\n    tier: backend\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: guestbook\n      tier: backend\n  template:\n    metadata:\n      labels:\n        app: guestbook\n        tier: backend\n    spec:\n      initContainers:\n      - name: init-db-ready\n        image: mongo:4\n        command:\n        - /bin/sh\n        - -c\n        args:\n        - echo \"Waiting for mongodb at go-guestbook-mongodb:27017 to go live before\n          the BE...\";\n        - until (mongo --host go-guestbook-mongodb:27017 >/dev/null) do echo \"Waiting\n          for connection for 2 sec.\"; sleep 2; done\n      containers:\n      - name: backend\n        image: guestbook-backend\n        ports:\n        - name: http-server\n          containerPort: 8080\n        - name: debug\n          containerPort: 3000\n        readinessProbe:\n          tcpSocket:\n            port: 8080\n          initialDelaySeconds: 5\n          periodSeconds: 10\n        env:\n        - name: PORT\n          value: '8080'\n        - name: GUESTBOOK_DB_ADDR\n          value: go-guestbook-mongodb:27017\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"backend\" does not have a read-only root file system"
  },
  {
    "id": "02845",
    "manifest_path": "data/manifests/the_stack_sample/sample_1156.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: go-guestbook-backend\n  labels:\n    app: guestbook\n    tier: backend\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: guestbook\n      tier: backend\n  template:\n    metadata:\n      labels:\n        app: guestbook\n        tier: backend\n    spec:\n      initContainers:\n      - name: init-db-ready\n        image: mongo:4\n        command:\n        - /bin/sh\n        - -c\n        args:\n        - echo \"Waiting for mongodb at go-guestbook-mongodb:27017 to go live before\n          the BE...\";\n        - until (mongo --host go-guestbook-mongodb:27017 >/dev/null) do echo \"Waiting\n          for connection for 2 sec.\"; sleep 2; done\n      containers:\n      - name: backend\n        image: guestbook-backend\n        ports:\n        - name: http-server\n          containerPort: 8080\n        - name: debug\n          containerPort: 3000\n        readinessProbe:\n          tcpSocket:\n            port: 8080\n          initialDelaySeconds: 5\n          periodSeconds: 10\n        env:\n        - name: PORT\n          value: '8080'\n        - name: GUESTBOOK_DB_ADDR\n          value: go-guestbook-mongodb:27017\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"init-db-ready\" does not have a read-only root file system"
  },
  {
    "id": "02846",
    "manifest_path": "data/manifests/the_stack_sample/sample_1156.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: go-guestbook-backend\n  labels:\n    app: guestbook\n    tier: backend\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: guestbook\n      tier: backend\n  template:\n    metadata:\n      labels:\n        app: guestbook\n        tier: backend\n    spec:\n      initContainers:\n      - name: init-db-ready\n        image: mongo:4\n        command:\n        - /bin/sh\n        - -c\n        args:\n        - echo \"Waiting for mongodb at go-guestbook-mongodb:27017 to go live before\n          the BE...\";\n        - until (mongo --host go-guestbook-mongodb:27017 >/dev/null) do echo \"Waiting\n          for connection for 2 sec.\"; sleep 2; done\n      containers:\n      - name: backend\n        image: guestbook-backend\n        ports:\n        - name: http-server\n          containerPort: 8080\n        - name: debug\n          containerPort: 3000\n        readinessProbe:\n          tcpSocket:\n            port: 8080\n          initialDelaySeconds: 5\n          periodSeconds: 10\n        env:\n        - name: PORT\n          value: '8080'\n        - name: GUESTBOOK_DB_ADDR\n          value: go-guestbook-mongodb:27017\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"backend\" is not set to runAsNonRoot"
  },
  {
    "id": "02847",
    "manifest_path": "data/manifests/the_stack_sample/sample_1156.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: go-guestbook-backend\n  labels:\n    app: guestbook\n    tier: backend\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: guestbook\n      tier: backend\n  template:\n    metadata:\n      labels:\n        app: guestbook\n        tier: backend\n    spec:\n      initContainers:\n      - name: init-db-ready\n        image: mongo:4\n        command:\n        - /bin/sh\n        - -c\n        args:\n        - echo \"Waiting for mongodb at go-guestbook-mongodb:27017 to go live before\n          the BE...\";\n        - until (mongo --host go-guestbook-mongodb:27017 >/dev/null) do echo \"Waiting\n          for connection for 2 sec.\"; sleep 2; done\n      containers:\n      - name: backend\n        image: guestbook-backend\n        ports:\n        - name: http-server\n          containerPort: 8080\n        - name: debug\n          containerPort: 3000\n        readinessProbe:\n          tcpSocket:\n            port: 8080\n          initialDelaySeconds: 5\n          periodSeconds: 10\n        env:\n        - name: PORT\n          value: '8080'\n        - name: GUESTBOOK_DB_ADDR\n          value: go-guestbook-mongodb:27017\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"init-db-ready\" is not set to runAsNonRoot"
  },
  {
    "id": "02848",
    "manifest_path": "data/manifests/the_stack_sample/sample_1156.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: go-guestbook-backend\n  labels:\n    app: guestbook\n    tier: backend\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: guestbook\n      tier: backend\n  template:\n    metadata:\n      labels:\n        app: guestbook\n        tier: backend\n    spec:\n      initContainers:\n      - name: init-db-ready\n        image: mongo:4\n        command:\n        - /bin/sh\n        - -c\n        args:\n        - echo \"Waiting for mongodb at go-guestbook-mongodb:27017 to go live before\n          the BE...\";\n        - until (mongo --host go-guestbook-mongodb:27017 >/dev/null) do echo \"Waiting\n          for connection for 2 sec.\"; sleep 2; done\n      containers:\n      - name: backend\n        image: guestbook-backend\n        ports:\n        - name: http-server\n          containerPort: 8080\n        - name: debug\n          containerPort: 3000\n        readinessProbe:\n          tcpSocket:\n            port: 8080\n          initialDelaySeconds: 5\n          periodSeconds: 10\n        env:\n        - name: PORT\n          value: '8080'\n        - name: GUESTBOOK_DB_ADDR\n          value: go-guestbook-mongodb:27017\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"backend\" has cpu request 0"
  },
  {
    "id": "02849",
    "manifest_path": "data/manifests/the_stack_sample/sample_1156.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: go-guestbook-backend\n  labels:\n    app: guestbook\n    tier: backend\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: guestbook\n      tier: backend\n  template:\n    metadata:\n      labels:\n        app: guestbook\n        tier: backend\n    spec:\n      initContainers:\n      - name: init-db-ready\n        image: mongo:4\n        command:\n        - /bin/sh\n        - -c\n        args:\n        - echo \"Waiting for mongodb at go-guestbook-mongodb:27017 to go live before\n          the BE...\";\n        - until (mongo --host go-guestbook-mongodb:27017 >/dev/null) do echo \"Waiting\n          for connection for 2 sec.\"; sleep 2; done\n      containers:\n      - name: backend\n        image: guestbook-backend\n        ports:\n        - name: http-server\n          containerPort: 8080\n        - name: debug\n          containerPort: 3000\n        readinessProbe:\n          tcpSocket:\n            port: 8080\n          initialDelaySeconds: 5\n          periodSeconds: 10\n        env:\n        - name: PORT\n          value: '8080'\n        - name: GUESTBOOK_DB_ADDR\n          value: go-guestbook-mongodb:27017\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"init-db-ready\" has cpu request 0"
  },
  {
    "id": "02850",
    "manifest_path": "data/manifests/the_stack_sample/sample_1156.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: go-guestbook-backend\n  labels:\n    app: guestbook\n    tier: backend\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: guestbook\n      tier: backend\n  template:\n    metadata:\n      labels:\n        app: guestbook\n        tier: backend\n    spec:\n      initContainers:\n      - name: init-db-ready\n        image: mongo:4\n        command:\n        - /bin/sh\n        - -c\n        args:\n        - echo \"Waiting for mongodb at go-guestbook-mongodb:27017 to go live before\n          the BE...\";\n        - until (mongo --host go-guestbook-mongodb:27017 >/dev/null) do echo \"Waiting\n          for connection for 2 sec.\"; sleep 2; done\n      containers:\n      - name: backend\n        image: guestbook-backend\n        ports:\n        - name: http-server\n          containerPort: 8080\n        - name: debug\n          containerPort: 3000\n        readinessProbe:\n          tcpSocket:\n            port: 8080\n          initialDelaySeconds: 5\n          periodSeconds: 10\n        env:\n        - name: PORT\n          value: '8080'\n        - name: GUESTBOOK_DB_ADDR\n          value: go-guestbook-mongodb:27017\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"backend\" has memory limit 0"
  },
  {
    "id": "02851",
    "manifest_path": "data/manifests/the_stack_sample/sample_1156.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: go-guestbook-backend\n  labels:\n    app: guestbook\n    tier: backend\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: guestbook\n      tier: backend\n  template:\n    metadata:\n      labels:\n        app: guestbook\n        tier: backend\n    spec:\n      initContainers:\n      - name: init-db-ready\n        image: mongo:4\n        command:\n        - /bin/sh\n        - -c\n        args:\n        - echo \"Waiting for mongodb at go-guestbook-mongodb:27017 to go live before\n          the BE...\";\n        - until (mongo --host go-guestbook-mongodb:27017 >/dev/null) do echo \"Waiting\n          for connection for 2 sec.\"; sleep 2; done\n      containers:\n      - name: backend\n        image: guestbook-backend\n        ports:\n        - name: http-server\n          containerPort: 8080\n        - name: debug\n          containerPort: 3000\n        readinessProbe:\n          tcpSocket:\n            port: 8080\n          initialDelaySeconds: 5\n          periodSeconds: 10\n        env:\n        - name: PORT\n          value: '8080'\n        - name: GUESTBOOK_DB_ADDR\n          value: go-guestbook-mongodb:27017\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"init-db-ready\" has memory limit 0"
  },
  {
    "id": "02852",
    "manifest_path": "data/manifests/the_stack_sample/sample_1157.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: hook\n  labels:\n    app: hook\nspec:\n  replicas: 4\n  selector:\n    matchLabels:\n      app: hook\n  template:\n    metadata:\n      labels:\n        app: hook\n    spec:\n      serviceAccountName: hook\n      containers:\n      - name: hook\n        image: gcr.io/k8s-prow/hook:v20220211-e4574accfe\n        imagePullPolicy: Always\n        args:\n        - --dry-run=false\n        - --slack-token-file=/etc/slack/token\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --github-token-path=/etc/github/oauth\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        env:\n        - name: KUBECONFIG\n          value: /etc/kubeconfig/config:/etc/kubeconfig-build-test-infra-trusted/kubeconfig\n        ports:\n        - name: http\n          containerPort: 8888\n        - name: metrics\n          containerPort: 9090\n        volumeMounts:\n        - name: slack\n          mountPath: /etc/slack\n        - name: hmac\n          mountPath: /etc/webhook\n          readOnly: true\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        - name: plugins\n          mountPath: /etc/plugins\n          readOnly: true\n        - name: cat-api\n          mountPath: /etc/cat-api\n          readOnly: true\n        - name: unsplash-api\n          mountPath: /etc/unsplash-api\n          readOnly: true\n        - name: kubeconfig\n          mountPath: /etc/kubeconfig\n          readOnly: true\n        - mountPath: /etc/kubeconfig-build-test-infra-trusted\n          name: kubeconfig-build-test-infra-trusted\n          readOnly: true\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 8081\n          initialDelaySeconds: 3\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /healthz/ready\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 3\n          timeoutSeconds: 600\n      volumes:\n      - name: slack\n        secret:\n          secretName: slack-token\n      - name: hmac\n        secret:\n          secretName: hmac-token\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n      - name: plugins\n        configMap:\n          name: plugins\n      - name: cat-api\n        configMap:\n          name: cat-api-key\n      - name: unsplash-api\n        secret:\n          secretName: unsplash-api-key\n      - name: kubeconfig\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig\n      - name: kubeconfig-build-test-infra-trusted\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig-build-test-infra-trusted\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"hook\" does not have a read-only root file system"
  },
  {
    "id": "02853",
    "manifest_path": "data/manifests/the_stack_sample/sample_1157.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: hook\n  labels:\n    app: hook\nspec:\n  replicas: 4\n  selector:\n    matchLabels:\n      app: hook\n  template:\n    metadata:\n      labels:\n        app: hook\n    spec:\n      serviceAccountName: hook\n      containers:\n      - name: hook\n        image: gcr.io/k8s-prow/hook:v20220211-e4574accfe\n        imagePullPolicy: Always\n        args:\n        - --dry-run=false\n        - --slack-token-file=/etc/slack/token\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --github-token-path=/etc/github/oauth\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        env:\n        - name: KUBECONFIG\n          value: /etc/kubeconfig/config:/etc/kubeconfig-build-test-infra-trusted/kubeconfig\n        ports:\n        - name: http\n          containerPort: 8888\n        - name: metrics\n          containerPort: 9090\n        volumeMounts:\n        - name: slack\n          mountPath: /etc/slack\n        - name: hmac\n          mountPath: /etc/webhook\n          readOnly: true\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        - name: plugins\n          mountPath: /etc/plugins\n          readOnly: true\n        - name: cat-api\n          mountPath: /etc/cat-api\n          readOnly: true\n        - name: unsplash-api\n          mountPath: /etc/unsplash-api\n          readOnly: true\n        - name: kubeconfig\n          mountPath: /etc/kubeconfig\n          readOnly: true\n        - mountPath: /etc/kubeconfig-build-test-infra-trusted\n          name: kubeconfig-build-test-infra-trusted\n          readOnly: true\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 8081\n          initialDelaySeconds: 3\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /healthz/ready\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 3\n          timeoutSeconds: 600\n      volumes:\n      - name: slack\n        secret:\n          secretName: slack-token\n      - name: hmac\n        secret:\n          secretName: hmac-token\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n      - name: plugins\n        configMap:\n          name: plugins\n      - name: cat-api\n        configMap:\n          name: cat-api-key\n      - name: unsplash-api\n        secret:\n          secretName: unsplash-api-key\n      - name: kubeconfig\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig\n      - name: kubeconfig-build-test-infra-trusted\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig-build-test-infra-trusted\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"hook\" is not set to runAsNonRoot"
  },
  {
    "id": "02854",
    "manifest_path": "data/manifests/the_stack_sample/sample_1157.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: hook\n  labels:\n    app: hook\nspec:\n  replicas: 4\n  selector:\n    matchLabels:\n      app: hook\n  template:\n    metadata:\n      labels:\n        app: hook\n    spec:\n      serviceAccountName: hook\n      containers:\n      - name: hook\n        image: gcr.io/k8s-prow/hook:v20220211-e4574accfe\n        imagePullPolicy: Always\n        args:\n        - --dry-run=false\n        - --slack-token-file=/etc/slack/token\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --github-token-path=/etc/github/oauth\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        env:\n        - name: KUBECONFIG\n          value: /etc/kubeconfig/config:/etc/kubeconfig-build-test-infra-trusted/kubeconfig\n        ports:\n        - name: http\n          containerPort: 8888\n        - name: metrics\n          containerPort: 9090\n        volumeMounts:\n        - name: slack\n          mountPath: /etc/slack\n        - name: hmac\n          mountPath: /etc/webhook\n          readOnly: true\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        - name: plugins\n          mountPath: /etc/plugins\n          readOnly: true\n        - name: cat-api\n          mountPath: /etc/cat-api\n          readOnly: true\n        - name: unsplash-api\n          mountPath: /etc/unsplash-api\n          readOnly: true\n        - name: kubeconfig\n          mountPath: /etc/kubeconfig\n          readOnly: true\n        - mountPath: /etc/kubeconfig-build-test-infra-trusted\n          name: kubeconfig-build-test-infra-trusted\n          readOnly: true\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 8081\n          initialDelaySeconds: 3\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /healthz/ready\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 3\n          timeoutSeconds: 600\n      volumes:\n      - name: slack\n        secret:\n          secretName: slack-token\n      - name: hmac\n        secret:\n          secretName: hmac-token\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n      - name: plugins\n        configMap:\n          name: plugins\n      - name: cat-api\n        configMap:\n          name: cat-api-key\n      - name: unsplash-api\n        secret:\n          secretName: unsplash-api-key\n      - name: kubeconfig\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig\n      - name: kubeconfig-build-test-infra-trusted\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig-build-test-infra-trusted\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"hook\" has cpu request 0"
  },
  {
    "id": "02855",
    "manifest_path": "data/manifests/the_stack_sample/sample_1157.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: hook\n  labels:\n    app: hook\nspec:\n  replicas: 4\n  selector:\n    matchLabels:\n      app: hook\n  template:\n    metadata:\n      labels:\n        app: hook\n    spec:\n      serviceAccountName: hook\n      containers:\n      - name: hook\n        image: gcr.io/k8s-prow/hook:v20220211-e4574accfe\n        imagePullPolicy: Always\n        args:\n        - --dry-run=false\n        - --slack-token-file=/etc/slack/token\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --github-token-path=/etc/github/oauth\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        env:\n        - name: KUBECONFIG\n          value: /etc/kubeconfig/config:/etc/kubeconfig-build-test-infra-trusted/kubeconfig\n        ports:\n        - name: http\n          containerPort: 8888\n        - name: metrics\n          containerPort: 9090\n        volumeMounts:\n        - name: slack\n          mountPath: /etc/slack\n        - name: hmac\n          mountPath: /etc/webhook\n          readOnly: true\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        - name: plugins\n          mountPath: /etc/plugins\n          readOnly: true\n        - name: cat-api\n          mountPath: /etc/cat-api\n          readOnly: true\n        - name: unsplash-api\n          mountPath: /etc/unsplash-api\n          readOnly: true\n        - name: kubeconfig\n          mountPath: /etc/kubeconfig\n          readOnly: true\n        - mountPath: /etc/kubeconfig-build-test-infra-trusted\n          name: kubeconfig-build-test-infra-trusted\n          readOnly: true\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 8081\n          initialDelaySeconds: 3\n          periodSeconds: 3\n        readinessProbe:\n          httpGet:\n            path: /healthz/ready\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 3\n          timeoutSeconds: 600\n      volumes:\n      - name: slack\n        secret:\n          secretName: slack-token\n      - name: hmac\n        secret:\n          secretName: hmac-token\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n      - name: plugins\n        configMap:\n          name: plugins\n      - name: cat-api\n        configMap:\n          name: cat-api-key\n      - name: unsplash-api\n        secret:\n          secretName: unsplash-api-key\n      - name: kubeconfig\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig\n      - name: kubeconfig-build-test-infra-trusted\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig-build-test-infra-trusted\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"hook\" has memory limit 0"
  },
  {
    "id": "02856",
    "manifest_path": "data/manifests/the_stack_sample/sample_1162.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: hostports0\nspec:\n  containers:\n  - image: k8s.gcr.io/pause\n    name: container1\n    ports:\n    - containerPort: 12345\n    securityContext:\n      allowPrivilegeEscalation: false\n  initContainers:\n  - image: k8s.gcr.io/pause\n    name: initcontainer1\n    ports:\n    - containerPort: 12346\n    securityContext:\n      allowPrivilegeEscalation: false\n  securityContext:\n    runAsNonRoot: true\n    seccompProfile:\n      type: RuntimeDefault\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"container1\" is using an invalid container image, \"k8s.gcr.io/pause\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02857",
    "manifest_path": "data/manifests/the_stack_sample/sample_1162.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: hostports0\nspec:\n  containers:\n  - image: k8s.gcr.io/pause\n    name: container1\n    ports:\n    - containerPort: 12345\n    securityContext:\n      allowPrivilegeEscalation: false\n  initContainers:\n  - image: k8s.gcr.io/pause\n    name: initcontainer1\n    ports:\n    - containerPort: 12346\n    securityContext:\n      allowPrivilegeEscalation: false\n  securityContext:\n    runAsNonRoot: true\n    seccompProfile:\n      type: RuntimeDefault\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"initcontainer1\" is using an invalid container image, \"k8s.gcr.io/pause\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02858",
    "manifest_path": "data/manifests/the_stack_sample/sample_1162.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: hostports0\nspec:\n  containers:\n  - image: k8s.gcr.io/pause\n    name: container1\n    ports:\n    - containerPort: 12345\n    securityContext:\n      allowPrivilegeEscalation: false\n  initContainers:\n  - image: k8s.gcr.io/pause\n    name: initcontainer1\n    ports:\n    - containerPort: 12346\n    securityContext:\n      allowPrivilegeEscalation: false\n  securityContext:\n    runAsNonRoot: true\n    seccompProfile:\n      type: RuntimeDefault\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"container1\" does not have a read-only root file system"
  },
  {
    "id": "02859",
    "manifest_path": "data/manifests/the_stack_sample/sample_1162.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: hostports0\nspec:\n  containers:\n  - image: k8s.gcr.io/pause\n    name: container1\n    ports:\n    - containerPort: 12345\n    securityContext:\n      allowPrivilegeEscalation: false\n  initContainers:\n  - image: k8s.gcr.io/pause\n    name: initcontainer1\n    ports:\n    - containerPort: 12346\n    securityContext:\n      allowPrivilegeEscalation: false\n  securityContext:\n    runAsNonRoot: true\n    seccompProfile:\n      type: RuntimeDefault\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"initcontainer1\" does not have a read-only root file system"
  },
  {
    "id": "02860",
    "manifest_path": "data/manifests/the_stack_sample/sample_1162.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: hostports0\nspec:\n  containers:\n  - image: k8s.gcr.io/pause\n    name: container1\n    ports:\n    - containerPort: 12345\n    securityContext:\n      allowPrivilegeEscalation: false\n  initContainers:\n  - image: k8s.gcr.io/pause\n    name: initcontainer1\n    ports:\n    - containerPort: 12346\n    securityContext:\n      allowPrivilegeEscalation: false\n  securityContext:\n    runAsNonRoot: true\n    seccompProfile:\n      type: RuntimeDefault\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"container1\" has cpu request 0"
  },
  {
    "id": "02861",
    "manifest_path": "data/manifests/the_stack_sample/sample_1162.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: hostports0\nspec:\n  containers:\n  - image: k8s.gcr.io/pause\n    name: container1\n    ports:\n    - containerPort: 12345\n    securityContext:\n      allowPrivilegeEscalation: false\n  initContainers:\n  - image: k8s.gcr.io/pause\n    name: initcontainer1\n    ports:\n    - containerPort: 12346\n    securityContext:\n      allowPrivilegeEscalation: false\n  securityContext:\n    runAsNonRoot: true\n    seccompProfile:\n      type: RuntimeDefault\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"initcontainer1\" has cpu request 0"
  },
  {
    "id": "02862",
    "manifest_path": "data/manifests/the_stack_sample/sample_1162.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: hostports0\nspec:\n  containers:\n  - image: k8s.gcr.io/pause\n    name: container1\n    ports:\n    - containerPort: 12345\n    securityContext:\n      allowPrivilegeEscalation: false\n  initContainers:\n  - image: k8s.gcr.io/pause\n    name: initcontainer1\n    ports:\n    - containerPort: 12346\n    securityContext:\n      allowPrivilegeEscalation: false\n  securityContext:\n    runAsNonRoot: true\n    seccompProfile:\n      type: RuntimeDefault\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"container1\" has memory limit 0"
  },
  {
    "id": "02863",
    "manifest_path": "data/manifests/the_stack_sample/sample_1162.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: hostports0\nspec:\n  containers:\n  - image: k8s.gcr.io/pause\n    name: container1\n    ports:\n    - containerPort: 12345\n    securityContext:\n      allowPrivilegeEscalation: false\n  initContainers:\n  - image: k8s.gcr.io/pause\n    name: initcontainer1\n    ports:\n    - containerPort: 12346\n    securityContext:\n      allowPrivilegeEscalation: false\n  securityContext:\n    runAsNonRoot: true\n    seccompProfile:\n      type: RuntimeDefault\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"initcontainer1\" has memory limit 0"
  },
  {
    "id": "02864",
    "manifest_path": "data/manifests/the_stack_sample/sample_1163.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: pgbench\n  name: pgbench\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: pgbench\n  template:\n    metadata:\n      labels:\n        app: pgbench\n    spec:\n      containers:\n      - name: pgbench\n        envFrom:\n        - secretRef:\n            name: db-creds\n        env:\n        - name: DURATION\n          value: '100000'\n        - name: CLIENTS\n          value: '5'\n        - name: DBHOST\n          value: aa501bb12bde3437a87c195a9ed5edd7-8393eef865b22115.elb.us-west-2.amazonaws.com\n        image: 448389607377.dkr.ecr.us-west-2.amazonaws.com/simu-app-load:0.3\n        imagePullPolicy: Always\n        command:\n        - /start-pgbench.sh\n        resources:\n          requests:\n            cpu: 512m\n            memory: 512Mi\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"pgbench\" does not have a read-only root file system"
  },
  {
    "id": "02865",
    "manifest_path": "data/manifests/the_stack_sample/sample_1163.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: pgbench\n  name: pgbench\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: pgbench\n  template:\n    metadata:\n      labels:\n        app: pgbench\n    spec:\n      containers:\n      - name: pgbench\n        envFrom:\n        - secretRef:\n            name: db-creds\n        env:\n        - name: DURATION\n          value: '100000'\n        - name: CLIENTS\n          value: '5'\n        - name: DBHOST\n          value: aa501bb12bde3437a87c195a9ed5edd7-8393eef865b22115.elb.us-west-2.amazonaws.com\n        image: 448389607377.dkr.ecr.us-west-2.amazonaws.com/simu-app-load:0.3\n        imagePullPolicy: Always\n        command:\n        - /start-pgbench.sh\n        resources:\n          requests:\n            cpu: 512m\n            memory: 512Mi\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"pgbench\" is not set to runAsNonRoot"
  },
  {
    "id": "02866",
    "manifest_path": "data/manifests/the_stack_sample/sample_1163.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: pgbench\n  name: pgbench\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: pgbench\n  template:\n    metadata:\n      labels:\n        app: pgbench\n    spec:\n      containers:\n      - name: pgbench\n        envFrom:\n        - secretRef:\n            name: db-creds\n        env:\n        - name: DURATION\n          value: '100000'\n        - name: CLIENTS\n          value: '5'\n        - name: DBHOST\n          value: aa501bb12bde3437a87c195a9ed5edd7-8393eef865b22115.elb.us-west-2.amazonaws.com\n        image: 448389607377.dkr.ecr.us-west-2.amazonaws.com/simu-app-load:0.3\n        imagePullPolicy: Always\n        command:\n        - /start-pgbench.sh\n        resources:\n          requests:\n            cpu: 512m\n            memory: 512Mi\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"pgbench\" has memory limit 0"
  },
  {
    "id": "02867",
    "manifest_path": "data/manifests/the_stack_sample/sample_1164.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: ueransim-gnb-deployment\n  labels:\n    app: ueransim-gnb\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: ueransim-gnb\n  template:\n    metadata:\n      labels:\n        app: ueransim-gnb\n    spec:\n      containers:\n      - name: ueransim-gnb\n        imagePullPolicy: IfNotPresent\n        image: free5gmano/ueransim:v3.1.0\n        securityContext:\n          privileged: true\n        command:\n        - /bin/bash\n        - -c\n        args:\n        - ./build/nr-gnb -c ./config/free5gc-gnb.yaml\n        volumeMounts:\n        - name: gnb-conf\n          mountPath: /UERANSIM/config/free5gc-gnb.yaml\n          subPath: free5gc-gnb.yaml\n      initContainers:\n      - name: init-network-client\n        image: sdnvortex/network-controller:v0.4.9\n        command:\n        - /go/bin/client\n        args:\n        - -s=unix:///tmp/vortex.sock\n        - -b=br0\n        - -n=eth1\n        - -i=192.168.2.171/23\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_UUID\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.uid\n        volumeMounts:\n        - mountPath: /tmp/\n          name: grpc-sock\n      volumes:\n      - name: gnb-conf\n        configMap:\n          name: ueransim-configmap\n          items:\n          - key: free5gc-gnb.yaml\n            path: free5gc-gnb.yaml\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"init-network-client\" does not have a read-only root file system"
  },
  {
    "id": "02868",
    "manifest_path": "data/manifests/the_stack_sample/sample_1164.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: ueransim-gnb-deployment\n  labels:\n    app: ueransim-gnb\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: ueransim-gnb\n  template:\n    metadata:\n      labels:\n        app: ueransim-gnb\n    spec:\n      containers:\n      - name: ueransim-gnb\n        imagePullPolicy: IfNotPresent\n        image: free5gmano/ueransim:v3.1.0\n        securityContext:\n          privileged: true\n        command:\n        - /bin/bash\n        - -c\n        args:\n        - ./build/nr-gnb -c ./config/free5gc-gnb.yaml\n        volumeMounts:\n        - name: gnb-conf\n          mountPath: /UERANSIM/config/free5gc-gnb.yaml\n          subPath: free5gc-gnb.yaml\n      initContainers:\n      - name: init-network-client\n        image: sdnvortex/network-controller:v0.4.9\n        command:\n        - /go/bin/client\n        args:\n        - -s=unix:///tmp/vortex.sock\n        - -b=br0\n        - -n=eth1\n        - -i=192.168.2.171/23\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_UUID\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.uid\n        volumeMounts:\n        - mountPath: /tmp/\n          name: grpc-sock\n      volumes:\n      - name: gnb-conf\n        configMap:\n          name: ueransim-configmap\n          items:\n          - key: free5gc-gnb.yaml\n            path: free5gc-gnb.yaml\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"ueransim-gnb\" does not have a read-only root file system"
  },
  {
    "id": "02869",
    "manifest_path": "data/manifests/the_stack_sample/sample_1164.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: ueransim-gnb-deployment\n  labels:\n    app: ueransim-gnb\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: ueransim-gnb\n  template:\n    metadata:\n      labels:\n        app: ueransim-gnb\n    spec:\n      containers:\n      - name: ueransim-gnb\n        imagePullPolicy: IfNotPresent\n        image: free5gmano/ueransim:v3.1.0\n        securityContext:\n          privileged: true\n        command:\n        - /bin/bash\n        - -c\n        args:\n        - ./build/nr-gnb -c ./config/free5gc-gnb.yaml\n        volumeMounts:\n        - name: gnb-conf\n          mountPath: /UERANSIM/config/free5gc-gnb.yaml\n          subPath: free5gc-gnb.yaml\n      initContainers:\n      - name: init-network-client\n        image: sdnvortex/network-controller:v0.4.9\n        command:\n        - /go/bin/client\n        args:\n        - -s=unix:///tmp/vortex.sock\n        - -b=br0\n        - -n=eth1\n        - -i=192.168.2.171/23\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_UUID\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.uid\n        volumeMounts:\n        - mountPath: /tmp/\n          name: grpc-sock\n      volumes:\n      - name: gnb-conf\n        configMap:\n          name: ueransim-configmap\n          items:\n          - key: free5gc-gnb.yaml\n            path: free5gc-gnb.yaml\n",
    "policy_id": "privilege-escalation-container",
    "violation_text": "container \"ueransim-gnb\" is Privileged hence allows privilege escalation."
  },
  {
    "id": "02870",
    "manifest_path": "data/manifests/the_stack_sample/sample_1164.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: ueransim-gnb-deployment\n  labels:\n    app: ueransim-gnb\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: ueransim-gnb\n  template:\n    metadata:\n      labels:\n        app: ueransim-gnb\n    spec:\n      containers:\n      - name: ueransim-gnb\n        imagePullPolicy: IfNotPresent\n        image: free5gmano/ueransim:v3.1.0\n        securityContext:\n          privileged: true\n        command:\n        - /bin/bash\n        - -c\n        args:\n        - ./build/nr-gnb -c ./config/free5gc-gnb.yaml\n        volumeMounts:\n        - name: gnb-conf\n          mountPath: /UERANSIM/config/free5gc-gnb.yaml\n          subPath: free5gc-gnb.yaml\n      initContainers:\n      - name: init-network-client\n        image: sdnvortex/network-controller:v0.4.9\n        command:\n        - /go/bin/client\n        args:\n        - -s=unix:///tmp/vortex.sock\n        - -b=br0\n        - -n=eth1\n        - -i=192.168.2.171/23\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_UUID\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.uid\n        volumeMounts:\n        - mountPath: /tmp/\n          name: grpc-sock\n      volumes:\n      - name: gnb-conf\n        configMap:\n          name: ueransim-configmap\n          items:\n          - key: free5gc-gnb.yaml\n            path: free5gc-gnb.yaml\n",
    "policy_id": "privileged-container",
    "violation_text": "container \"ueransim-gnb\" is privileged"
  },
  {
    "id": "02871",
    "manifest_path": "data/manifests/the_stack_sample/sample_1164.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: ueransim-gnb-deployment\n  labels:\n    app: ueransim-gnb\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: ueransim-gnb\n  template:\n    metadata:\n      labels:\n        app: ueransim-gnb\n    spec:\n      containers:\n      - name: ueransim-gnb\n        imagePullPolicy: IfNotPresent\n        image: free5gmano/ueransim:v3.1.0\n        securityContext:\n          privileged: true\n        command:\n        - /bin/bash\n        - -c\n        args:\n        - ./build/nr-gnb -c ./config/free5gc-gnb.yaml\n        volumeMounts:\n        - name: gnb-conf\n          mountPath: /UERANSIM/config/free5gc-gnb.yaml\n          subPath: free5gc-gnb.yaml\n      initContainers:\n      - name: init-network-client\n        image: sdnvortex/network-controller:v0.4.9\n        command:\n        - /go/bin/client\n        args:\n        - -s=unix:///tmp/vortex.sock\n        - -b=br0\n        - -n=eth1\n        - -i=192.168.2.171/23\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_UUID\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.uid\n        volumeMounts:\n        - mountPath: /tmp/\n          name: grpc-sock\n      volumes:\n      - name: gnb-conf\n        configMap:\n          name: ueransim-configmap\n          items:\n          - key: free5gc-gnb.yaml\n            path: free5gc-gnb.yaml\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"init-network-client\" is not set to runAsNonRoot"
  },
  {
    "id": "02872",
    "manifest_path": "data/manifests/the_stack_sample/sample_1164.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: ueransim-gnb-deployment\n  labels:\n    app: ueransim-gnb\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: ueransim-gnb\n  template:\n    metadata:\n      labels:\n        app: ueransim-gnb\n    spec:\n      containers:\n      - name: ueransim-gnb\n        imagePullPolicy: IfNotPresent\n        image: free5gmano/ueransim:v3.1.0\n        securityContext:\n          privileged: true\n        command:\n        - /bin/bash\n        - -c\n        args:\n        - ./build/nr-gnb -c ./config/free5gc-gnb.yaml\n        volumeMounts:\n        - name: gnb-conf\n          mountPath: /UERANSIM/config/free5gc-gnb.yaml\n          subPath: free5gc-gnb.yaml\n      initContainers:\n      - name: init-network-client\n        image: sdnvortex/network-controller:v0.4.9\n        command:\n        - /go/bin/client\n        args:\n        - -s=unix:///tmp/vortex.sock\n        - -b=br0\n        - -n=eth1\n        - -i=192.168.2.171/23\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_UUID\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.uid\n        volumeMounts:\n        - mountPath: /tmp/\n          name: grpc-sock\n      volumes:\n      - name: gnb-conf\n        configMap:\n          name: ueransim-configmap\n          items:\n          - key: free5gc-gnb.yaml\n            path: free5gc-gnb.yaml\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"ueransim-gnb\" is not set to runAsNonRoot"
  },
  {
    "id": "02873",
    "manifest_path": "data/manifests/the_stack_sample/sample_1164.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: ueransim-gnb-deployment\n  labels:\n    app: ueransim-gnb\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: ueransim-gnb\n  template:\n    metadata:\n      labels:\n        app: ueransim-gnb\n    spec:\n      containers:\n      - name: ueransim-gnb\n        imagePullPolicy: IfNotPresent\n        image: free5gmano/ueransim:v3.1.0\n        securityContext:\n          privileged: true\n        command:\n        - /bin/bash\n        - -c\n        args:\n        - ./build/nr-gnb -c ./config/free5gc-gnb.yaml\n        volumeMounts:\n        - name: gnb-conf\n          mountPath: /UERANSIM/config/free5gc-gnb.yaml\n          subPath: free5gc-gnb.yaml\n      initContainers:\n      - name: init-network-client\n        image: sdnvortex/network-controller:v0.4.9\n        command:\n        - /go/bin/client\n        args:\n        - -s=unix:///tmp/vortex.sock\n        - -b=br0\n        - -n=eth1\n        - -i=192.168.2.171/23\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_UUID\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.uid\n        volumeMounts:\n        - mountPath: /tmp/\n          name: grpc-sock\n      volumes:\n      - name: gnb-conf\n        configMap:\n          name: ueransim-configmap\n          items:\n          - key: free5gc-gnb.yaml\n            path: free5gc-gnb.yaml\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"init-network-client\" has cpu request 0"
  },
  {
    "id": "02874",
    "manifest_path": "data/manifests/the_stack_sample/sample_1164.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: ueransim-gnb-deployment\n  labels:\n    app: ueransim-gnb\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: ueransim-gnb\n  template:\n    metadata:\n      labels:\n        app: ueransim-gnb\n    spec:\n      containers:\n      - name: ueransim-gnb\n        imagePullPolicy: IfNotPresent\n        image: free5gmano/ueransim:v3.1.0\n        securityContext:\n          privileged: true\n        command:\n        - /bin/bash\n        - -c\n        args:\n        - ./build/nr-gnb -c ./config/free5gc-gnb.yaml\n        volumeMounts:\n        - name: gnb-conf\n          mountPath: /UERANSIM/config/free5gc-gnb.yaml\n          subPath: free5gc-gnb.yaml\n      initContainers:\n      - name: init-network-client\n        image: sdnvortex/network-controller:v0.4.9\n        command:\n        - /go/bin/client\n        args:\n        - -s=unix:///tmp/vortex.sock\n        - -b=br0\n        - -n=eth1\n        - -i=192.168.2.171/23\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_UUID\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.uid\n        volumeMounts:\n        - mountPath: /tmp/\n          name: grpc-sock\n      volumes:\n      - name: gnb-conf\n        configMap:\n          name: ueransim-configmap\n          items:\n          - key: free5gc-gnb.yaml\n            path: free5gc-gnb.yaml\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"ueransim-gnb\" has cpu request 0"
  },
  {
    "id": "02875",
    "manifest_path": "data/manifests/the_stack_sample/sample_1164.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: ueransim-gnb-deployment\n  labels:\n    app: ueransim-gnb\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: ueransim-gnb\n  template:\n    metadata:\n      labels:\n        app: ueransim-gnb\n    spec:\n      containers:\n      - name: ueransim-gnb\n        imagePullPolicy: IfNotPresent\n        image: free5gmano/ueransim:v3.1.0\n        securityContext:\n          privileged: true\n        command:\n        - /bin/bash\n        - -c\n        args:\n        - ./build/nr-gnb -c ./config/free5gc-gnb.yaml\n        volumeMounts:\n        - name: gnb-conf\n          mountPath: /UERANSIM/config/free5gc-gnb.yaml\n          subPath: free5gc-gnb.yaml\n      initContainers:\n      - name: init-network-client\n        image: sdnvortex/network-controller:v0.4.9\n        command:\n        - /go/bin/client\n        args:\n        - -s=unix:///tmp/vortex.sock\n        - -b=br0\n        - -n=eth1\n        - -i=192.168.2.171/23\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_UUID\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.uid\n        volumeMounts:\n        - mountPath: /tmp/\n          name: grpc-sock\n      volumes:\n      - name: gnb-conf\n        configMap:\n          name: ueransim-configmap\n          items:\n          - key: free5gc-gnb.yaml\n            path: free5gc-gnb.yaml\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"init-network-client\" has memory limit 0"
  },
  {
    "id": "02876",
    "manifest_path": "data/manifests/the_stack_sample/sample_1164.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: ueransim-gnb-deployment\n  labels:\n    app: ueransim-gnb\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: ueransim-gnb\n  template:\n    metadata:\n      labels:\n        app: ueransim-gnb\n    spec:\n      containers:\n      - name: ueransim-gnb\n        imagePullPolicy: IfNotPresent\n        image: free5gmano/ueransim:v3.1.0\n        securityContext:\n          privileged: true\n        command:\n        - /bin/bash\n        - -c\n        args:\n        - ./build/nr-gnb -c ./config/free5gc-gnb.yaml\n        volumeMounts:\n        - name: gnb-conf\n          mountPath: /UERANSIM/config/free5gc-gnb.yaml\n          subPath: free5gc-gnb.yaml\n      initContainers:\n      - name: init-network-client\n        image: sdnvortex/network-controller:v0.4.9\n        command:\n        - /go/bin/client\n        args:\n        - -s=unix:///tmp/vortex.sock\n        - -b=br0\n        - -n=eth1\n        - -i=192.168.2.171/23\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_UUID\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.uid\n        volumeMounts:\n        - mountPath: /tmp/\n          name: grpc-sock\n      volumes:\n      - name: gnb-conf\n        configMap:\n          name: ueransim-configmap\n          items:\n          - key: free5gc-gnb.yaml\n            path: free5gc-gnb.yaml\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"ueransim-gnb\" has memory limit 0"
  },
  {
    "id": "02877",
    "manifest_path": "data/manifests/the_stack_sample/sample_1165.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: manager\n  labels:\n    app: cockroach-operator\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: cockroach-operator\n  template:\n    metadata:\n      labels:\n        app: cockroach-operator\n    spec:\n      serviceAccountName: cockroach-operator-sa\n      containers:\n      - name: cockroach-operator\n        image: cockroachdb/cockroach-operator:latest\n        imagePullPolicy: IfNotPresent\n        args:\n        - -zap-log-level\n        - info\n        env:\n        - name: OPERATOR_NAME\n          value: cockroachdb\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        resources:\n          requests:\n            cpu: 10m\n            memory: 32Mi\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"cockroach-operator\" is using an invalid container image, \"cockroachdb/cockroach-operator:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02878",
    "manifest_path": "data/manifests/the_stack_sample/sample_1165.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: manager\n  labels:\n    app: cockroach-operator\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: cockroach-operator\n  template:\n    metadata:\n      labels:\n        app: cockroach-operator\n    spec:\n      serviceAccountName: cockroach-operator-sa\n      containers:\n      - name: cockroach-operator\n        image: cockroachdb/cockroach-operator:latest\n        imagePullPolicy: IfNotPresent\n        args:\n        - -zap-log-level\n        - info\n        env:\n        - name: OPERATOR_NAME\n          value: cockroachdb\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        resources:\n          requests:\n            cpu: 10m\n            memory: 32Mi\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"cockroach-operator\" does not have a read-only root file system"
  },
  {
    "id": "02879",
    "manifest_path": "data/manifests/the_stack_sample/sample_1165.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: manager\n  labels:\n    app: cockroach-operator\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: cockroach-operator\n  template:\n    metadata:\n      labels:\n        app: cockroach-operator\n    spec:\n      serviceAccountName: cockroach-operator-sa\n      containers:\n      - name: cockroach-operator\n        image: cockroachdb/cockroach-operator:latest\n        imagePullPolicy: IfNotPresent\n        args:\n        - -zap-log-level\n        - info\n        env:\n        - name: OPERATOR_NAME\n          value: cockroachdb\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        resources:\n          requests:\n            cpu: 10m\n            memory: 32Mi\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"cockroach-operator\" is not set to runAsNonRoot"
  },
  {
    "id": "02880",
    "manifest_path": "data/manifests/the_stack_sample/sample_1165.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: manager\n  labels:\n    app: cockroach-operator\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: cockroach-operator\n  template:\n    metadata:\n      labels:\n        app: cockroach-operator\n    spec:\n      serviceAccountName: cockroach-operator-sa\n      containers:\n      - name: cockroach-operator\n        image: cockroachdb/cockroach-operator:latest\n        imagePullPolicy: IfNotPresent\n        args:\n        - -zap-log-level\n        - info\n        env:\n        - name: OPERATOR_NAME\n          value: cockroachdb\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        resources:\n          requests:\n            cpu: 10m\n            memory: 32Mi\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"cockroach-operator\" has memory limit 0"
  }
]