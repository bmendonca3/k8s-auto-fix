[
  {
    "id": "01161",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed: The CronJob \"tf-nightly-retinanet-func-v3-8\" is invalid: spec.jobTemplate.spec.template.spec.containers[1].resources.requests: Invalid value: \"20G\": must be less than or equal to memory limit of 256Mi"
    ]
  },
  {
    "id": "01162",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed: The CronJob \"tf-nightly-retinanet-func-v3-8\" is invalid: spec.jobTemplate.spec.template.spec.containers[1].resources.requests: Invalid value: \"20G\": must be less than or equal to memory limit of 256Mi"
    ]
  },
  {
    "id": "01163",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed: The CronJob \"tf-nightly-retinanet-func-v3-8\" is invalid: spec.jobTemplate.spec.template.spec.containers[1].resources.requests: Invalid value: \"20G\": must be less than or equal to memory limit of 256Mi"
    ]
  },
  {
    "id": "01164",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed: The CronJob \"tf-nightly-retinanet-func-v3-8\" is invalid: spec.jobTemplate.spec.template.spec.containers[1].resources.requests: Invalid value: \"20G\": must be less than or equal to memory limit of 256Mi"
    ]
  },
  {
    "id": "01165",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed: The CronJob \"tf-nightly-retinanet-func-v3-8\" is invalid: spec.jobTemplate.spec.template.spec.containers[1].resources.requests: Invalid value: \"20G\": must be less than or equal to memory limit of 256Mi"
    ]
  },
  {
    "id": "01166",
    "policy_id": "env_var_secret",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: api-server\nspec:\n  selector:\n    matchLabels:\n      name: api-server\n  template:\n    metadata:\n      labels:\n        name: api-server\n    spec:\n      containers:\n      - name: api-server\n        image: gcr.io/pl-dev-infra/cloud/api_server_image:stable\n        ports:\n        - containerPort: 51200\n        readinessProbe:\n          httpGet:\n            scheme: HTTPS\n            path: /healthz\n            port: 51200\n        livenessProbe:\n          httpGet:\n            scheme: HTTPS\n            path: /healthz\n            port: 51200\n        envFrom:\n        - configMapRef:\n            name: pl-tls-config\n        - configMapRef:\n            name: pl-domain-config\n        env:\n        - name: PL_JWT_SIGNING_KEY\n          valueFrom:\n            secretKeyRef:\n              name: cloud-auth-secrets\n              key: jwt-signing-key\n        - name: PL_SESSION_KEY\n          valueFrom:\n            secretKeyRef:\n              name: cloud-session-secrets\n              key: session-key\n        - name: PL_VZMGR_SERVICE\n          valueFrom:\n            configMapKeyRef:\n              name: pl-service-config\n              key: PL_VZMGR_SERVICE\n        - name: PL_AUTH_SERVICE\n          valueFrom:\n            configMapKeyRef:\n              name: pl-service-config\n              key: PL_AUTH_SERVICE\n        - name: PL_PROJECT_MANAGER_SERVICE\n          valueFrom:\n            configMapKeyRef:\n              name: pl-service-config\n              key: PL_PROJECT_MANAGER_SERVICE\n        - name: PL_PROFILE_SERVICE\n          valueFrom:\n            configMapKeyRef:\n              name: pl-service-config\n              key: PL_PROFILE_SERVICE\n        - name: PL_ARTIFACT_TRACKER_SERVICE\n          valueFrom:\n            configMapKeyRef:\n              name: pl-service-config\n              key: PL_ARTIFACT_TRACKER_SERVICE\n        - name: PL_ELASTIC_SERVICE\n          valueFrom:\n            configMapKeyRef:\n              name: pl-service-config\n              key: PL_ELASTIC_SERVICE\n        - name: PL_SEGMENT_WRITE_KEY\n          valueFrom:\n            configMapKeyRef:\n              name: segment-config\n              key: write-key\n        - name: PL_VIZIER_IMAGE_SECRET_PATH\n          valueFrom:\n            secretKeyRef:\n              name: vizier-image-secret\n              key: pl_vizier_image_secret_path\n        - name: PL_VIZIER_IMAGE_SECRET_FILE\n          valueFrom:\n            secretKeyRef:\n              name: vizier-image-secret\n              key: filename\n        - name: PL_ELASTIC_USERNAME\n          value: elastic\n        - name: PL_ELASTIC_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: pl-elastic-es-elastic-user\n              key: elastic\n        - name: PL_ELASTIC_CA_CERT\n          value: /elastic-certs-pub/tls.crt\n        - name: PL_WORK_DOMAIN\n          value: work.$(PL_DOMAIN_NAME)\n        - name: PL_KRATOS_BROWSER_URL\n          value: https://$(PL_WORK_DOMAIN)/oauth/kratos\n        volumeMounts:\n        - name: certs\n          mountPath: /certs\n        - name: vizier-image-secret\n          mountPath: /vizier-image-secret\n        - name: elastic-certs-pub\n          mountPath: /elastic-certs-pub\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: certs\n        secret:\n          secretName: service-tls-certs\n      - name: vizier-image-secret\n        secret:\n          secretName: vizier-image-secret\n          optional: true\n      - name: envoy-yaml\n        configMap:\n          name: proxy-envoy-config\n      - name: elastic-certs-pub\n        secret:\n          secretName: pl-elastic-es-http-certs-public\n",
    "errors": []
  },
  {
    "id": "01167",
    "policy_id": "env_var_secret",
    "accepted": false,
    "ok_schema": true,
    "ok_policy": false,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "environment variable PL_VIZIER_IMAGE_SECRET_FILE must use secretKeyRef"
    ]
  },
  {
    "id": "01168",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: api-server\nspec:\n  selector:\n    matchLabels:\n      name: api-server\n  template:\n    metadata:\n      labels:\n        name: api-server\n    spec:\n      containers:\n      - name: api-server\n        image: gcr.io/pl-dev-infra/cloud/api_server_image:stable\n        ports:\n        - containerPort: 51200\n        readinessProbe:\n          httpGet:\n            scheme: HTTPS\n            path: /healthz\n            port: 51200\n        livenessProbe:\n          httpGet:\n            scheme: HTTPS\n            path: /healthz\n            port: 51200\n        envFrom:\n        - configMapRef:\n            name: pl-tls-config\n        - configMapRef:\n            name: pl-domain-config\n        env:\n        - name: PL_JWT_SIGNING_KEY\n          valueFrom:\n            secretKeyRef:\n              name: cloud-auth-secrets\n              key: jwt-signing-key\n        - name: PL_SESSION_KEY\n          valueFrom:\n            secretKeyRef:\n              name: cloud-session-secrets\n              key: session-key\n        - name: PL_VZMGR_SERVICE\n          valueFrom:\n            configMapKeyRef:\n              name: pl-service-config\n              key: PL_VZMGR_SERVICE\n        - name: PL_AUTH_SERVICE\n          valueFrom:\n            configMapKeyRef:\n              name: pl-service-config\n              key: PL_AUTH_SERVICE\n        - name: PL_PROJECT_MANAGER_SERVICE\n          valueFrom:\n            configMapKeyRef:\n              name: pl-service-config\n              key: PL_PROJECT_MANAGER_SERVICE\n        - name: PL_PROFILE_SERVICE\n          valueFrom:\n            configMapKeyRef:\n              name: pl-service-config\n              key: PL_PROFILE_SERVICE\n        - name: PL_ARTIFACT_TRACKER_SERVICE\n          valueFrom:\n            configMapKeyRef:\n              name: pl-service-config\n              key: PL_ARTIFACT_TRACKER_SERVICE\n        - name: PL_ELASTIC_SERVICE\n          valueFrom:\n            configMapKeyRef:\n              name: pl-service-config\n              key: PL_ELASTIC_SERVICE\n        - name: PL_SEGMENT_WRITE_KEY\n          valueFrom:\n            configMapKeyRef:\n              name: segment-config\n              key: write-key\n        - name: PL_VIZIER_IMAGE_SECRET_PATH\n          valueFrom:\n            secretKeyRef:\n              name: vizier-image-secret\n              key: pl_vizier_image_secret_path\n        - name: PL_VIZIER_IMAGE_SECRET_FILE\n          value: vizier_image_secret.json\n        - name: PL_ELASTIC_USERNAME\n          value: elastic\n        - name: PL_ELASTIC_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: pl-elastic-es-elastic-user\n              key: elastic\n        - name: PL_ELASTIC_CA_CERT\n          value: /elastic-certs-pub/tls.crt\n        - name: PL_WORK_DOMAIN\n          value: work.$(PL_DOMAIN_NAME)\n        - name: PL_KRATOS_BROWSER_URL\n          value: https://$(PL_WORK_DOMAIN)/oauth/kratos\n        volumeMounts:\n        - name: certs\n          mountPath: /certs\n        - name: vizier-image-secret\n          mountPath: /vizier-image-secret\n        - name: elastic-certs-pub\n          mountPath: /elastic-certs-pub\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: certs\n        secret:\n          secretName: service-tls-certs\n      - name: vizier-image-secret\n        secret:\n          secretName: vizier-image-secret\n          optional: true\n      - name: envoy-yaml\n        configMap:\n          name: proxy-envoy-config\n      - name: elastic-certs-pub\n        secret:\n          secretName: pl-elastic-es-http-certs-public\n",
    "errors": []
  },
  {
    "id": "01169",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: api-server\nspec:\n  selector:\n    matchLabels:\n      name: api-server\n  template:\n    metadata:\n      labels:\n        name: api-server\n    spec:\n      containers:\n      - name: api-server\n        image: gcr.io/pl-dev-infra/cloud/api_server_image:stable\n        ports:\n        - containerPort: 51200\n        readinessProbe:\n          httpGet:\n            scheme: HTTPS\n            path: /healthz\n            port: 51200\n        livenessProbe:\n          httpGet:\n            scheme: HTTPS\n            path: /healthz\n            port: 51200\n        envFrom:\n        - configMapRef:\n            name: pl-tls-config\n        - configMapRef:\n            name: pl-domain-config\n        env:\n        - name: PL_JWT_SIGNING_KEY\n          valueFrom:\n            secretKeyRef:\n              name: cloud-auth-secrets\n              key: jwt-signing-key\n        - name: PL_SESSION_KEY\n          valueFrom:\n            secretKeyRef:\n              name: cloud-session-secrets\n              key: session-key\n        - name: PL_VZMGR_SERVICE\n          valueFrom:\n            configMapKeyRef:\n              name: pl-service-config\n              key: PL_VZMGR_SERVICE\n        - name: PL_AUTH_SERVICE\n          valueFrom:\n            configMapKeyRef:\n              name: pl-service-config\n              key: PL_AUTH_SERVICE\n        - name: PL_PROJECT_MANAGER_SERVICE\n          valueFrom:\n            configMapKeyRef:\n              name: pl-service-config\n              key: PL_PROJECT_MANAGER_SERVICE\n        - name: PL_PROFILE_SERVICE\n          valueFrom:\n            configMapKeyRef:\n              name: pl-service-config\n              key: PL_PROFILE_SERVICE\n        - name: PL_ARTIFACT_TRACKER_SERVICE\n          valueFrom:\n            configMapKeyRef:\n              name: pl-service-config\n              key: PL_ARTIFACT_TRACKER_SERVICE\n        - name: PL_ELASTIC_SERVICE\n          valueFrom:\n            configMapKeyRef:\n              name: pl-service-config\n              key: PL_ELASTIC_SERVICE\n        - name: PL_SEGMENT_WRITE_KEY\n          valueFrom:\n            configMapKeyRef:\n              name: segment-config\n              key: write-key\n        - name: PL_VIZIER_IMAGE_SECRET_PATH\n          valueFrom:\n            secretKeyRef:\n              name: vizier-image-secret\n              key: pl_vizier_image_secret_path\n        - name: PL_VIZIER_IMAGE_SECRET_FILE\n          value: vizier_image_secret.json\n        - name: PL_ELASTIC_USERNAME\n          value: elastic\n        - name: PL_ELASTIC_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: pl-elastic-es-elastic-user\n              key: elastic\n        - name: PL_ELASTIC_CA_CERT\n          value: /elastic-certs-pub/tls.crt\n        - name: PL_WORK_DOMAIN\n          value: work.$(PL_DOMAIN_NAME)\n        - name: PL_KRATOS_BROWSER_URL\n          value: https://$(PL_WORK_DOMAIN)/oauth/kratos\n        volumeMounts:\n        - name: certs\n          mountPath: /certs\n        - name: vizier-image-secret\n          mountPath: /vizier-image-secret\n        - name: elastic-certs-pub\n          mountPath: /elastic-certs-pub\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: certs\n        secret:\n          secretName: service-tls-certs\n      - name: vizier-image-secret\n        secret:\n          secretName: vizier-image-secret\n          optional: true\n      - name: envoy-yaml\n        configMap:\n          name: proxy-envoy-config\n      - name: elastic-certs-pub\n        secret:\n          secretName: pl-elastic-es-http-certs-public\n",
    "errors": []
  },
  {
    "id": "01170",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: api-server\nspec:\n  selector:\n    matchLabels:\n      name: api-server\n  template:\n    metadata:\n      labels:\n        name: api-server\n    spec:\n      containers:\n      - name: api-server\n        image: gcr.io/pl-dev-infra/cloud/api_server_image:stable\n        ports:\n        - containerPort: 51200\n        readinessProbe:\n          httpGet:\n            scheme: HTTPS\n            path: /healthz\n            port: 51200\n        livenessProbe:\n          httpGet:\n            scheme: HTTPS\n            path: /healthz\n            port: 51200\n        envFrom:\n        - configMapRef:\n            name: pl-tls-config\n        - configMapRef:\n            name: pl-domain-config\n        env:\n        - name: PL_JWT_SIGNING_KEY\n          valueFrom:\n            secretKeyRef:\n              name: cloud-auth-secrets\n              key: jwt-signing-key\n        - name: PL_SESSION_KEY\n          valueFrom:\n            secretKeyRef:\n              name: cloud-session-secrets\n              key: session-key\n        - name: PL_VZMGR_SERVICE\n          valueFrom:\n            configMapKeyRef:\n              name: pl-service-config\n              key: PL_VZMGR_SERVICE\n        - name: PL_AUTH_SERVICE\n          valueFrom:\n            configMapKeyRef:\n              name: pl-service-config\n              key: PL_AUTH_SERVICE\n        - name: PL_PROJECT_MANAGER_SERVICE\n          valueFrom:\n            configMapKeyRef:\n              name: pl-service-config\n              key: PL_PROJECT_MANAGER_SERVICE\n        - name: PL_PROFILE_SERVICE\n          valueFrom:\n            configMapKeyRef:\n              name: pl-service-config\n              key: PL_PROFILE_SERVICE\n        - name: PL_ARTIFACT_TRACKER_SERVICE\n          valueFrom:\n            configMapKeyRef:\n              name: pl-service-config\n              key: PL_ARTIFACT_TRACKER_SERVICE\n        - name: PL_ELASTIC_SERVICE\n          valueFrom:\n            configMapKeyRef:\n              name: pl-service-config\n              key: PL_ELASTIC_SERVICE\n        - name: PL_SEGMENT_WRITE_KEY\n          valueFrom:\n            configMapKeyRef:\n              name: segment-config\n              key: write-key\n        - name: PL_VIZIER_IMAGE_SECRET_PATH\n          valueFrom:\n            secretKeyRef:\n              name: vizier-image-secret\n              key: pl_vizier_image_secret_path\n        - name: PL_VIZIER_IMAGE_SECRET_FILE\n          value: vizier_image_secret.json\n        - name: PL_ELASTIC_USERNAME\n          value: elastic\n        - name: PL_ELASTIC_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: pl-elastic-es-elastic-user\n              key: elastic\n        - name: PL_ELASTIC_CA_CERT\n          value: /elastic-certs-pub/tls.crt\n        - name: PL_WORK_DOMAIN\n          value: work.$(PL_DOMAIN_NAME)\n        - name: PL_KRATOS_BROWSER_URL\n          value: https://$(PL_WORK_DOMAIN)/oauth/kratos\n        volumeMounts:\n        - name: certs\n          mountPath: /certs\n        - name: vizier-image-secret\n          mountPath: /vizier-image-secret\n        - name: elastic-certs-pub\n          mountPath: /elastic-certs-pub\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: certs\n        secret:\n          secretName: service-tls-certs\n      - name: vizier-image-secret\n        secret:\n          secretName: vizier-image-secret\n          optional: true\n      - name: envoy-yaml\n        configMap:\n          name: proxy-envoy-config\n      - name: elastic-certs-pub\n        secret:\n          secretName: pl-elastic-es-http-certs-public\n",
    "errors": []
  },
  {
    "id": "01171",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: api-server\nspec:\n  selector:\n    matchLabels:\n      name: api-server\n  template:\n    metadata:\n      labels:\n        name: api-server\n    spec:\n      containers:\n      - name: api-server\n        image: gcr.io/pl-dev-infra/cloud/api_server_image:stable\n        ports:\n        - containerPort: 51200\n        readinessProbe:\n          httpGet:\n            scheme: HTTPS\n            path: /healthz\n            port: 51200\n        livenessProbe:\n          httpGet:\n            scheme: HTTPS\n            path: /healthz\n            port: 51200\n        envFrom:\n        - configMapRef:\n            name: pl-tls-config\n        - configMapRef:\n            name: pl-domain-config\n        env:\n        - name: PL_JWT_SIGNING_KEY\n          valueFrom:\n            secretKeyRef:\n              name: cloud-auth-secrets\n              key: jwt-signing-key\n        - name: PL_SESSION_KEY\n          valueFrom:\n            secretKeyRef:\n              name: cloud-session-secrets\n              key: session-key\n        - name: PL_VZMGR_SERVICE\n          valueFrom:\n            configMapKeyRef:\n              name: pl-service-config\n              key: PL_VZMGR_SERVICE\n        - name: PL_AUTH_SERVICE\n          valueFrom:\n            configMapKeyRef:\n              name: pl-service-config\n              key: PL_AUTH_SERVICE\n        - name: PL_PROJECT_MANAGER_SERVICE\n          valueFrom:\n            configMapKeyRef:\n              name: pl-service-config\n              key: PL_PROJECT_MANAGER_SERVICE\n        - name: PL_PROFILE_SERVICE\n          valueFrom:\n            configMapKeyRef:\n              name: pl-service-config\n              key: PL_PROFILE_SERVICE\n        - name: PL_ARTIFACT_TRACKER_SERVICE\n          valueFrom:\n            configMapKeyRef:\n              name: pl-service-config\n              key: PL_ARTIFACT_TRACKER_SERVICE\n        - name: PL_ELASTIC_SERVICE\n          valueFrom:\n            configMapKeyRef:\n              name: pl-service-config\n              key: PL_ELASTIC_SERVICE\n        - name: PL_SEGMENT_WRITE_KEY\n          valueFrom:\n            configMapKeyRef:\n              name: segment-config\n              key: write-key\n        - name: PL_VIZIER_IMAGE_SECRET_PATH\n          valueFrom:\n            secretKeyRef:\n              name: vizier-image-secret\n              key: pl_vizier_image_secret_path\n        - name: PL_VIZIER_IMAGE_SECRET_FILE\n          value: vizier_image_secret.json\n        - name: PL_ELASTIC_USERNAME\n          value: elastic\n        - name: PL_ELASTIC_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: pl-elastic-es-elastic-user\n              key: elastic\n        - name: PL_ELASTIC_CA_CERT\n          value: /elastic-certs-pub/tls.crt\n        - name: PL_WORK_DOMAIN\n          value: work.$(PL_DOMAIN_NAME)\n        - name: PL_KRATOS_BROWSER_URL\n          value: https://$(PL_WORK_DOMAIN)/oauth/kratos\n        volumeMounts:\n        - name: certs\n          mountPath: /certs\n        - name: vizier-image-secret\n          mountPath: /vizier-image-secret\n        - name: elastic-certs-pub\n          mountPath: /elastic-certs-pub\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: certs\n        secret:\n          secretName: service-tls-certs\n      - name: vizier-image-secret\n        secret:\n          secretName: vizier-image-secret\n          optional: true\n      - name: envoy-yaml\n        configMap:\n          name: proxy-envoy-config\n      - name: elastic-certs-pub\n        secret:\n          secretName: pl-elastic-es-http-certs-public\n",
    "errors": []
  },
  {
    "id": "01172",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: api-server\nspec:\n  selector:\n    matchLabels:\n      name: api-server\n  template:\n    metadata:\n      labels:\n        name: api-server\n    spec:\n      containers:\n      - name: api-server\n        image: gcr.io/pl-dev-infra/cloud/api_server_image:stable\n        ports:\n        - containerPort: 51200\n        readinessProbe:\n          httpGet:\n            scheme: HTTPS\n            path: /healthz\n            port: 51200\n        livenessProbe:\n          httpGet:\n            scheme: HTTPS\n            path: /healthz\n            port: 51200\n        envFrom:\n        - configMapRef:\n            name: pl-tls-config\n        - configMapRef:\n            name: pl-domain-config\n        env:\n        - name: PL_JWT_SIGNING_KEY\n          valueFrom:\n            secretKeyRef:\n              name: cloud-auth-secrets\n              key: jwt-signing-key\n        - name: PL_SESSION_KEY\n          valueFrom:\n            secretKeyRef:\n              name: cloud-session-secrets\n              key: session-key\n        - name: PL_VZMGR_SERVICE\n          valueFrom:\n            configMapKeyRef:\n              name: pl-service-config\n              key: PL_VZMGR_SERVICE\n        - name: PL_AUTH_SERVICE\n          valueFrom:\n            configMapKeyRef:\n              name: pl-service-config\n              key: PL_AUTH_SERVICE\n        - name: PL_PROJECT_MANAGER_SERVICE\n          valueFrom:\n            configMapKeyRef:\n              name: pl-service-config\n              key: PL_PROJECT_MANAGER_SERVICE\n        - name: PL_PROFILE_SERVICE\n          valueFrom:\n            configMapKeyRef:\n              name: pl-service-config\n              key: PL_PROFILE_SERVICE\n        - name: PL_ARTIFACT_TRACKER_SERVICE\n          valueFrom:\n            configMapKeyRef:\n              name: pl-service-config\n              key: PL_ARTIFACT_TRACKER_SERVICE\n        - name: PL_ELASTIC_SERVICE\n          valueFrom:\n            configMapKeyRef:\n              name: pl-service-config\n              key: PL_ELASTIC_SERVICE\n        - name: PL_SEGMENT_WRITE_KEY\n          valueFrom:\n            configMapKeyRef:\n              name: segment-config\n              key: write-key\n        - name: PL_VIZIER_IMAGE_SECRET_PATH\n          valueFrom:\n            secretKeyRef:\n              name: vizier-image-secret\n              key: pl_vizier_image_secret_path\n        - name: PL_VIZIER_IMAGE_SECRET_FILE\n          value: vizier_image_secret.json\n        - name: PL_ELASTIC_USERNAME\n          value: elastic\n        - name: PL_ELASTIC_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: pl-elastic-es-elastic-user\n              key: elastic\n        - name: PL_ELASTIC_CA_CERT\n          value: /elastic-certs-pub/tls.crt\n        - name: PL_WORK_DOMAIN\n          value: work.$(PL_DOMAIN_NAME)\n        - name: PL_KRATOS_BROWSER_URL\n          value: https://$(PL_WORK_DOMAIN)/oauth/kratos\n        volumeMounts:\n        - name: certs\n          mountPath: /certs\n        - name: vizier-image-secret\n          mountPath: /vizier-image-secret\n        - name: elastic-certs-pub\n          mountPath: /elastic-certs-pub\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: certs\n        secret:\n          secretName: service-tls-certs\n      - name: vizier-image-secret\n        secret:\n          secretName: vizier-image-secret\n          optional: true\n      - name: envoy-yaml\n        configMap:\n          name: proxy-envoy-config\n      - name: elastic-certs-pub\n        secret:\n          secretName: pl-elastic-es-http-certs-public\n",
    "errors": []
  },
  {
    "id": "01173",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: mull-frontend\n  namespace: mull\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: mull-frontend\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/name: mull-frontend\n    spec:\n      containers:\n      - name: mull-frontend\n        image: ritchellegmp/mull-frontend:stable\n        imagePullPolicy: Always\n        ports:\n        - name: frontend\n          containerPort: 4200\n          protocol: TCP\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "01174",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: mull-frontend\n  namespace: mull\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: mull-frontend\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/name: mull-frontend\n    spec:\n      containers:\n      - name: mull-frontend\n        image: ritchellegmp/mull-frontend:stable\n        imagePullPolicy: Always\n        ports:\n        - name: frontend\n          containerPort: 4200\n          protocol: TCP\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      securityContext:\n        seccompProfile:\n          type: RuntimeDefault\n",
    "errors": []
  },
  {
    "id": "01175",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: mull-frontend\n  namespace: mull\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: mull-frontend\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/name: mull-frontend\n    spec:\n      containers:\n      - name: mull-frontend\n        image: ritchellegmp/mull-frontend:stable\n        imagePullPolicy: Always\n        ports:\n        - name: frontend\n          containerPort: 4200\n          protocol: TCP\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "01176",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: mull-frontend\n  namespace: mull\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: mull-frontend\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/name: mull-frontend\n    spec:\n      containers:\n      - name: mull-frontend\n        image: ritchellegmp/mull-frontend:stable\n        imagePullPolicy: Always\n        ports:\n        - name: frontend\n          containerPort: 4200\n          protocol: TCP\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "01177",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: mull-frontend\n  namespace: mull\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: mull-frontend\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/name: mull-frontend\n    spec:\n      containers:\n      - name: mull-frontend\n        image: ritchellegmp/mull-frontend:stable\n        imagePullPolicy: Always\n        ports:\n        - name: frontend\n          containerPort: 4200\n          protocol: TCP\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "01178",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  labels:\n    app: replay\n  name: replay\nspec:\n  replicas: 1\n  selector:\n    app: replay\n  template:\n    metadata:\n      labels:\n        app: replay\n    spec:\n      containers:\n      - command:\n        - bash\n        - -c\n        - source /etc/kube-replay/config && node main.js\n        image: paralin/dota-replay:stable\n        imagePullPolicy: Always\n        name: replay\n        ports:\n        - containerPort: 80\n          name: web\n        - containerPort: 10304\n          name: desktop\n        volumeMounts:\n        - mountPath: /etc/kube-replay\n          name: replay-config\n          readOnly: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: replay-config\n        secret:\n          secretName: replay-config\n",
    "errors": []
  },
  {
    "id": "01179",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  labels:\n    app: replay\n  name: replay\nspec:\n  replicas: 1\n  selector:\n    app: replay\n  template:\n    metadata:\n      labels:\n        app: replay\n    spec:\n      containers:\n      - command:\n        - bash\n        - -c\n        - source /etc/kube-replay/config && node main.js\n        image: paralin/dota-replay:stable\n        imagePullPolicy: Always\n        name: replay\n        ports:\n        - containerPort: 80\n          name: web\n        - containerPort: 10304\n          name: desktop\n        volumeMounts:\n        - mountPath: /etc/kube-replay\n          name: replay-config\n          readOnly: true\n        - mountPath: /tmp\n          name: tmp\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: replay-config\n        secret:\n          secretName: replay-config\n      - name: tmp\n        emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "01180",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  labels:\n    app: replay\n  name: replay\nspec:\n  replicas: 1\n  selector:\n    app: replay\n  template:\n    metadata:\n      labels:\n        app: replay\n    spec:\n      containers:\n      - command:\n        - bash\n        - -c\n        - source /etc/kube-replay/config && node main.js\n        image: paralin/dota-replay:stable\n        imagePullPolicy: Always\n        name: replay\n        ports:\n        - containerPort: 80\n          name: web\n        - containerPort: 10304\n          name: desktop\n        volumeMounts:\n        - mountPath: /etc/kube-replay\n          name: replay-config\n          readOnly: true\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: replay-config\n        secret:\n          secretName: replay-config\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "01181",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  labels:\n    app: replay\n  name: replay\nspec:\n  replicas: 1\n  selector:\n    app: replay\n  template:\n    metadata:\n      labels:\n        app: replay\n    spec:\n      containers:\n      - command:\n        - bash\n        - -c\n        - source /etc/kube-replay/config && node main.js\n        image: paralin/dota-replay:stable\n        imagePullPolicy: Always\n        name: replay\n        ports:\n        - containerPort: 80\n          name: web\n        - containerPort: 10304\n          name: desktop\n        volumeMounts:\n        - mountPath: /etc/kube-replay\n          name: replay-config\n          readOnly: true\n        resources:\n          limits:\n            cpu: 500m\n            memory: 256Mi\n          requests:\n            cpu: 100m\n            memory: 128Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: replay-config\n        secret:\n          secretName: replay-config\n",
    "errors": []
  },
  {
    "id": "01182",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  labels:\n    app: replay\n  name: replay\nspec:\n  replicas: 1\n  selector:\n    app: replay\n  template:\n    metadata:\n      labels:\n        app: replay\n    spec:\n      containers:\n      - command:\n        - bash\n        - -c\n        - source /etc/kube-replay/config && node main.js\n        image: paralin/dota-replay:stable\n        imagePullPolicy: Always\n        name: replay\n        ports:\n        - containerPort: 80\n          name: web\n        - containerPort: 10304\n          name: desktop\n        volumeMounts:\n        - mountPath: /etc/kube-replay\n          name: replay-config\n          readOnly: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: replay-config\n        secret:\n          secretName: replay-config\n",
    "errors": []
  },
  {
    "id": "01183",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: pdns\n  namespace: default\n  labels:\n    app: pdns\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: pdns\n  template:\n    metadata:\n      labels:\n        app: pdns\n    spec:\n      volumes:\n      - name: service-account\n        secret:\n          secretName: dns-account\n          defaultMode: 256\n      serviceAccountName: pdns\n      containers:\n      - name: service\n        image: tanelmae/private-dns:stable\n        imagePullPolicy: Always\n        args:\n        - -gcp-zone=k8s-dns\n        - -gcp-reverse-zone=k8s-reverse-dns\n        - -gcp-cred=/account/dns.json\n        - -v=4\n        volumeMounts:\n        - name: service-account\n          mountPath: /account\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "01184",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: pdns\n  namespace: default\n  labels:\n    app: pdns\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: pdns\n  template:\n    metadata:\n      labels:\n        app: pdns\n    spec:\n      volumes:\n      - name: service-account\n        secret:\n          secretName: dns-account\n          defaultMode: 256\n      serviceAccountName: pdns\n      containers:\n      - name: service\n        image: tanelmae/private-dns:stable\n        imagePullPolicy: Always\n        args:\n        - -gcp-zone=k8s-dns\n        - -gcp-reverse-zone=k8s-reverse-dns\n        - -gcp-cred=/account/dns.json\n        - -v=4\n        volumeMounts:\n        - name: service-account\n          mountPath: /account\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "01185",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: pdns\n  namespace: default\n  labels:\n    app: pdns\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: pdns\n  template:\n    metadata:\n      labels:\n        app: pdns\n    spec:\n      volumes:\n      - name: service-account\n        secret:\n          secretName: dns-account\n          defaultMode: 256\n      serviceAccountName: pdns\n      containers:\n      - name: service\n        image: tanelmae/private-dns:stable\n        imagePullPolicy: Always\n        args:\n        - -gcp-zone=k8s-dns\n        - -gcp-reverse-zone=k8s-reverse-dns\n        - -gcp-cred=/account/dns.json\n        - -v=4\n        volumeMounts:\n        - name: service-account\n          mountPath: /account\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "01186",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: pdns\n  namespace: default\n  labels:\n    app: pdns\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: pdns\n  template:\n    metadata:\n      labels:\n        app: pdns\n    spec:\n      volumes:\n      - name: service-account\n        secret:\n          secretName: dns-account\n          defaultMode: 256\n      serviceAccountName: pdns\n      containers:\n      - name: service\n        image: tanelmae/private-dns:stable\n        imagePullPolicy: Always\n        args:\n        - -gcp-zone=k8s-dns\n        - -gcp-reverse-zone=k8s-reverse-dns\n        - -gcp-cred=/account/dns.json\n        - -v=4\n        volumeMounts:\n        - name: service-account\n          mountPath: /account\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "01187",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: pdns\n  namespace: default\n  labels:\n    app: pdns\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: pdns\n  template:\n    metadata:\n      labels:\n        app: pdns\n    spec:\n      volumes:\n      - name: service-account\n        secret:\n          secretName: dns-account\n          defaultMode: 256\n      serviceAccountName: pdns\n      containers:\n      - name: service\n        image: tanelmae/private-dns:stable\n        imagePullPolicy: Always\n        args:\n        - -gcp-zone=k8s-dns\n        - -gcp-reverse-zone=k8s-reverse-dns\n        - -gcp-cred=/account/dns.json\n        - -v=4\n        volumeMounts:\n        - name: service-account\n          mountPath: /account\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "01188",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: needs-rebase\n  labels:\n    app: needs-rebase\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: needs-rebase\n  template:\n    metadata:\n      labels:\n        app: needs-rebase\n    spec:\n      containers:\n      - name: needs-rebase\n        image: gcr.io/k8s-prow/needs-rebase:v20220120-e267164240\n        imagePullPolicy: Always\n        args:\n        - --dry-run=false\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --github-token-path=/etc/github/oauth\n        - --update-period=6h\n        ports:\n        - name: http\n          containerPort: 8888\n        volumeMounts:\n        - name: hmac\n          mountPath: /etc/webhook\n          readOnly: true\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: plugins\n          mountPath: /etc/plugins\n          readOnly: true\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: hmac\n        secret:\n          secretName: hmac-token\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: plugins\n        configMap:\n          name: plugins\n",
    "errors": []
  },
  {
    "id": "01189",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: needs-rebase\n  labels:\n    app: needs-rebase\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: needs-rebase\n  template:\n    metadata:\n      labels:\n        app: needs-rebase\n    spec:\n      containers:\n      - name: needs-rebase\n        image: gcr.io/k8s-prow/needs-rebase:v20220120-e267164240\n        imagePullPolicy: Always\n        args:\n        - --dry-run=false\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --github-token-path=/etc/github/oauth\n        - --update-period=6h\n        ports:\n        - name: http\n          containerPort: 8888\n        volumeMounts:\n        - name: hmac\n          mountPath: /etc/webhook\n          readOnly: true\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: plugins\n          mountPath: /etc/plugins\n          readOnly: true\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: hmac\n        secret:\n          secretName: hmac-token\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: plugins\n        configMap:\n          name: plugins\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "01190",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: needs-rebase\n  labels:\n    app: needs-rebase\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: needs-rebase\n  template:\n    metadata:\n      labels:\n        app: needs-rebase\n    spec:\n      containers:\n      - name: needs-rebase\n        image: gcr.io/k8s-prow/needs-rebase:v20220120-e267164240\n        imagePullPolicy: Always\n        args:\n        - --dry-run=false\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --github-token-path=/etc/github/oauth\n        - --update-period=6h\n        ports:\n        - name: http\n          containerPort: 8888\n        volumeMounts:\n        - name: hmac\n          mountPath: /etc/webhook\n          readOnly: true\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: plugins\n          mountPath: /etc/plugins\n          readOnly: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: hmac\n        secret:\n          secretName: hmac-token\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: plugins\n        configMap:\n          name: plugins\n",
    "errors": []
  },
  {
    "id": "01191",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: needs-rebase\n  labels:\n    app: needs-rebase\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: needs-rebase\n  template:\n    metadata:\n      labels:\n        app: needs-rebase\n    spec:\n      containers:\n      - name: needs-rebase\n        image: gcr.io/k8s-prow/needs-rebase:v20220120-e267164240\n        imagePullPolicy: Always\n        args:\n        - --dry-run=false\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --github-token-path=/etc/github/oauth\n        - --update-period=6h\n        ports:\n        - name: http\n          containerPort: 8888\n        volumeMounts:\n        - name: hmac\n          mountPath: /etc/webhook\n          readOnly: true\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: plugins\n          mountPath: /etc/plugins\n          readOnly: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: hmac\n        secret:\n          secretName: hmac-token\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: plugins\n        configMap:\n          name: plugins\n",
    "errors": []
  },
  {
    "id": "01192",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: web\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: web\n  template:\n    metadata:\n      labels:\n        app: web\n    spec:\n      containers:\n      - name: web\n        image: 3davinci/tinyweb:0.1\n        imagePullPolicy: Always\n        livenessProbe:\n          tcpSocket:\n            port: 8000\n        readinessProbe:\n          httpGet:\n            path: /index.html\n            port: 8000\n        volumeMounts:\n        - name: app\n          mountPath: /var/www/localhost/app\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      initContainers:\n      - name: init\n        image: busybox:1.31.0\n        command:\n        - sh\n        - -c\n        - wget -O- https://tinyurl.com/otus-k8s-intro | sh\n        volumeMounts:\n        - name: app\n          mountPath: /app\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: app\n        emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "01193",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: web\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: web\n  template:\n    metadata:\n      labels:\n        app: web\n    spec:\n      containers:\n      - name: web\n        image: 3davinci/tinyweb:0.1\n        imagePullPolicy: Always\n        livenessProbe:\n          tcpSocket:\n            port: 8000\n        readinessProbe:\n          httpGet:\n            path: /index.html\n            port: 8000\n        volumeMounts:\n        - name: app\n          mountPath: /var/www/localhost/app\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      initContainers:\n      - name: init\n        image: busybox:1.31.0\n        command:\n        - sh\n        - -c\n        - wget -O- https://tinyurl.com/otus-k8s-intro | sh\n        volumeMounts:\n        - name: app\n          mountPath: /app\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: app\n        emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "01194",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: web\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: web\n  template:\n    metadata:\n      labels:\n        app: web\n    spec:\n      containers:\n      - name: web\n        image: 3davinci/tinyweb:0.1\n        imagePullPolicy: Always\n        livenessProbe:\n          tcpSocket:\n            port: 8000\n        readinessProbe:\n          httpGet:\n            path: /index.html\n            port: 8000\n        volumeMounts:\n        - name: app\n          mountPath: /var/www/localhost/app\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      initContainers:\n      - name: init\n        image: busybox:1.31.0\n        command:\n        - sh\n        - -c\n        - wget -O- https://tinyurl.com/otus-k8s-intro | sh\n        volumeMounts:\n        - name: app\n          mountPath: /app\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: app\n        emptyDir: {}\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "01195",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: web\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: web\n  template:\n    metadata:\n      labels:\n        app: web\n    spec:\n      containers:\n      - name: web\n        image: 3davinci/tinyweb:0.1\n        imagePullPolicy: Always\n        livenessProbe:\n          tcpSocket:\n            port: 8000\n        readinessProbe:\n          httpGet:\n            path: /index.html\n            port: 8000\n        volumeMounts:\n        - name: app\n          mountPath: /var/www/localhost/app\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      initContainers:\n      - name: init\n        image: busybox:1.31.0\n        command:\n        - sh\n        - -c\n        - wget -O- https://tinyurl.com/otus-k8s-intro | sh\n        volumeMounts:\n        - name: app\n          mountPath: /app\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: app\n        emptyDir: {}\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "01196",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: web\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: web\n  template:\n    metadata:\n      labels:\n        app: web\n    spec:\n      containers:\n      - name: web\n        image: 3davinci/tinyweb:0.1\n        imagePullPolicy: Always\n        livenessProbe:\n          tcpSocket:\n            port: 8000\n        readinessProbe:\n          httpGet:\n            path: /index.html\n            port: 8000\n        volumeMounts:\n        - name: app\n          mountPath: /var/www/localhost/app\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      initContainers:\n      - name: init\n        image: busybox:1.31.0\n        command:\n        - sh\n        - -c\n        - wget -O- https://tinyurl.com/otus-k8s-intro | sh\n        volumeMounts:\n        - name: app\n          mountPath: /app\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: app\n        emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "01197",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: web\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: web\n  template:\n    metadata:\n      labels:\n        app: web\n    spec:\n      containers:\n      - name: web\n        image: 3davinci/tinyweb:0.1\n        imagePullPolicy: Always\n        livenessProbe:\n          tcpSocket:\n            port: 8000\n        readinessProbe:\n          httpGet:\n            path: /index.html\n            port: 8000\n        volumeMounts:\n        - name: app\n          mountPath: /var/www/localhost/app\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      initContainers:\n      - name: init\n        image: busybox:1.31.0\n        command:\n        - sh\n        - -c\n        - wget -O- https://tinyurl.com/otus-k8s-intro | sh\n        volumeMounts:\n        - name: app\n          mountPath: /app\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: app\n        emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "01198",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: web\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: web\n  template:\n    metadata:\n      labels:\n        app: web\n    spec:\n      containers:\n      - name: web\n        image: 3davinci/tinyweb:0.1\n        imagePullPolicy: Always\n        livenessProbe:\n          tcpSocket:\n            port: 8000\n        readinessProbe:\n          httpGet:\n            path: /index.html\n            port: 8000\n        volumeMounts:\n        - name: app\n          mountPath: /var/www/localhost/app\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      initContainers:\n      - name: init\n        image: busybox:1.31.0\n        command:\n        - sh\n        - -c\n        - wget -O- https://tinyurl.com/otus-k8s-intro | sh\n        volumeMounts:\n        - name: app\n          mountPath: /app\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: app\n        emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "01199",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: web\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: web\n  template:\n    metadata:\n      labels:\n        app: web\n    spec:\n      containers:\n      - name: web\n        image: 3davinci/tinyweb:0.1\n        imagePullPolicy: Always\n        livenessProbe:\n          tcpSocket:\n            port: 8000\n        readinessProbe:\n          httpGet:\n            path: /index.html\n            port: 8000\n        volumeMounts:\n        - name: app\n          mountPath: /var/www/localhost/app\n        resources:\n          limits:\n            cpu: 500m\n            memory: 256Mi\n          requests:\n            cpu: 100m\n            memory: 128Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      initContainers:\n      - name: init\n        image: busybox:1.31.0\n        command:\n        - sh\n        - -c\n        - wget -O- https://tinyurl.com/otus-k8s-intro | sh\n        volumeMounts:\n        - name: app\n          mountPath: /app\n        resources:\n          limits:\n            cpu: 500m\n            memory: 256Mi\n          requests:\n            cpu: 100m\n            memory: 128Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: app\n        emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "01200",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: postgres\n  labels:\n    app: postgres\n    group: db\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: postgres\n  template:\n    metadata:\n      labels:\n        app: postgres\n        type: db\n    spec:\n      volumes:\n      - name: postgres-storage\n        persistentVolumeClaim:\n          claimName: postgres-pvc\n      containers:\n      - name: postgres\n        image: postgres:9.6-alpine\n        ports:\n        - containerPort: 5432\n        envFrom:\n        - configMapRef:\n            name: postgres-config\n        volumeMounts:\n        - name: postgres-storage\n          mountPath: /var/lib/postgresql/data\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n",
    "errors": []
  }
]