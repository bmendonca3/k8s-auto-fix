[
  {
    "id": "01921",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: cloudflow-patch-spark-mutatingwebhookconfig\nspec:\n  template:\n    spec:\n      serviceAccountName: cloudflow-operator\n      containers:\n      - name: main\n        image: alpine:3.12\n        command:\n        - /bin/ash\n        - -c\n        - \"apk update && apk add wget\\nwget -q -O /bin/kubectl https://storage.googleapis.com/kubernetes-release/release/v1.16.12/bin/linux/amd64/kubectl\\\n          \\ && chmod 755 /bin/kubectl\\nNAME=\\\"spark-operator-sparkoperator\\\"\\nAPI_VERSION=$(kubectl\\\n          \\ get deployment -n cloudflow $NAME -o jsonpath='{.apiVersion}')\\nUUID=$(kubectl\\\n          \\ get deployment -n cloudflow $NAME -o jsonpath='{.metadata.uid}')\\nKIND=$(kubectl\\\n          \\ get deployment -n cloudflow $NAME -o jsonpath='{.kind}')\\nHOOK_NAME=\\\"\\\n          spark-operator-sparkoperator-webhook-config\\\"\\nJSON=$(cat <<EOF\\n{\\n  \\\"\\\n          metadata\\\": {\\n    \\\"ownerReferences\\\": [\\n      {\\n        \\\"apiVersion\\\"\\\n          : \\\"$API_VERSION\\\",\\n        \\\"blockOwnerDeletion\\\": true,\\n        \\\"controller\\\"\\\n          : true,\\n        \\\"kind\\\": \\\"$KIND\\\",\\n        \\\"name\\\": \\\"$NAME\\\",\\n  \\\n          \\      \\\"uid\\\": \\\"$UUID\\\"\\n      }\\n    ]\\n  }\\n}\\nEOF\\n)\\necho $JSON\\n\\\n          kubectl patch MutatingWebhookConfiguration $HOOK_NAME -n cloudflow -p \\\"\\\n          $JSON\\\"\"\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      restartPolicy: OnFailure\n",
    "errors": []
  },
  {
    "id": "01922",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: cloudflow-patch-spark-mutatingwebhookconfig\nspec:\n  template:\n    spec:\n      serviceAccountName: cloudflow-operator\n      containers:\n      - name: main\n        image: alpine:3.12\n        command:\n        - /bin/ash\n        - -c\n        - \"apk update && apk add wget\\nwget -q -O /bin/kubectl https://storage.googleapis.com/kubernetes-release/release/v1.16.12/bin/linux/amd64/kubectl\\\n          \\ && chmod 755 /bin/kubectl\\nNAME=\\\"spark-operator-sparkoperator\\\"\\nAPI_VERSION=$(kubectl\\\n          \\ get deployment -n cloudflow $NAME -o jsonpath='{.apiVersion}')\\nUUID=$(kubectl\\\n          \\ get deployment -n cloudflow $NAME -o jsonpath='{.metadata.uid}')\\nKIND=$(kubectl\\\n          \\ get deployment -n cloudflow $NAME -o jsonpath='{.kind}')\\nHOOK_NAME=\\\"\\\n          spark-operator-sparkoperator-webhook-config\\\"\\nJSON=$(cat <<EOF\\n{\\n  \\\"\\\n          metadata\\\": {\\n    \\\"ownerReferences\\\": [\\n      {\\n        \\\"apiVersion\\\"\\\n          : \\\"$API_VERSION\\\",\\n        \\\"blockOwnerDeletion\\\": true,\\n        \\\"controller\\\"\\\n          : true,\\n        \\\"kind\\\": \\\"$KIND\\\",\\n        \\\"name\\\": \\\"$NAME\\\",\\n  \\\n          \\      \\\"uid\\\": \\\"$UUID\\\"\\n      }\\n    ]\\n  }\\n}\\nEOF\\n)\\necho $JSON\\n\\\n          kubectl patch MutatingWebhookConfiguration $HOOK_NAME -n cloudflow -p \\\"\\\n          $JSON\\\"\"\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      securityContext:\n        runAsNonRoot: true\n      restartPolicy: OnFailure\n",
    "errors": []
  },
  {
    "id": "01923",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: cloudflow-patch-spark-mutatingwebhookconfig\nspec:\n  template:\n    spec:\n      serviceAccountName: cloudflow-operator\n      containers:\n      - name: main\n        image: alpine:3.12\n        command:\n        - /bin/ash\n        - -c\n        - \"apk update && apk add wget\\nwget -q -O /bin/kubectl https://storage.googleapis.com/kubernetes-release/release/v1.16.12/bin/linux/amd64/kubectl\\\n          \\ && chmod 755 /bin/kubectl\\nNAME=\\\"spark-operator-sparkoperator\\\"\\nAPI_VERSION=$(kubectl\\\n          \\ get deployment -n cloudflow $NAME -o jsonpath='{.apiVersion}')\\nUUID=$(kubectl\\\n          \\ get deployment -n cloudflow $NAME -o jsonpath='{.metadata.uid}')\\nKIND=$(kubectl\\\n          \\ get deployment -n cloudflow $NAME -o jsonpath='{.kind}')\\nHOOK_NAME=\\\"\\\n          spark-operator-sparkoperator-webhook-config\\\"\\nJSON=$(cat <<EOF\\n{\\n  \\\"\\\n          metadata\\\": {\\n    \\\"ownerReferences\\\": [\\n      {\\n        \\\"apiVersion\\\"\\\n          : \\\"$API_VERSION\\\",\\n        \\\"blockOwnerDeletion\\\": true,\\n        \\\"controller\\\"\\\n          : true,\\n        \\\"kind\\\": \\\"$KIND\\\",\\n        \\\"name\\\": \\\"$NAME\\\",\\n  \\\n          \\      \\\"uid\\\": \\\"$UUID\\\"\\n      }\\n    ]\\n  }\\n}\\nEOF\\n)\\necho $JSON\\n\\\n          kubectl patch MutatingWebhookConfiguration $HOOK_NAME -n cloudflow -p \\\"\\\n          $JSON\\\"\"\n        resources:\n          limits:\n            cpu: 500m\n            memory: 256Mi\n          requests:\n            cpu: 100m\n            memory: 128Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      restartPolicy: OnFailure\n",
    "errors": []
  },
  {
    "id": "01924",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: cloudflow-patch-spark-mutatingwebhookconfig\nspec:\n  template:\n    spec:\n      serviceAccountName: cloudflow-operator\n      containers:\n      - name: main\n        image: alpine:3.12\n        command:\n        - /bin/ash\n        - -c\n        - \"apk update && apk add wget\\nwget -q -O /bin/kubectl https://storage.googleapis.com/kubernetes-release/release/v1.16.12/bin/linux/amd64/kubectl\\\n          \\ && chmod 755 /bin/kubectl\\nNAME=\\\"spark-operator-sparkoperator\\\"\\nAPI_VERSION=$(kubectl\\\n          \\ get deployment -n cloudflow $NAME -o jsonpath='{.apiVersion}')\\nUUID=$(kubectl\\\n          \\ get deployment -n cloudflow $NAME -o jsonpath='{.metadata.uid}')\\nKIND=$(kubectl\\\n          \\ get deployment -n cloudflow $NAME -o jsonpath='{.kind}')\\nHOOK_NAME=\\\"\\\n          spark-operator-sparkoperator-webhook-config\\\"\\nJSON=$(cat <<EOF\\n{\\n  \\\"\\\n          metadata\\\": {\\n    \\\"ownerReferences\\\": [\\n      {\\n        \\\"apiVersion\\\"\\\n          : \\\"$API_VERSION\\\",\\n        \\\"blockOwnerDeletion\\\": true,\\n        \\\"controller\\\"\\\n          : true,\\n        \\\"kind\\\": \\\"$KIND\\\",\\n        \\\"name\\\": \\\"$NAME\\\",\\n  \\\n          \\      \\\"uid\\\": \\\"$UUID\\\"\\n      }\\n    ]\\n  }\\n}\\nEOF\\n)\\necho $JSON\\n\\\n          kubectl patch MutatingWebhookConfiguration $HOOK_NAME -n cloudflow -p \\\"\\\n          $JSON\\\"\"\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      restartPolicy: OnFailure\n",
    "errors": []
  },
  {
    "id": "01925",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: utils\nspec:\n  template:\n    metadata:\n      name: utils\n    spec:\n      volumes:\n      - name: sharedvolume\n        persistentVolumeClaim:\n          claimName: shared-pvc\n      containers:\n      - name: cryptogen\n        image: hyperledger/fabric-tools:1.3.0\n        imagePullPolicy: Always\n        command:\n        - sh\n        - -c\n        - echo 'Cryptogen Starts'; ls -l /shared/artifacts; while [ ! -d /shared/artifacts\n          ]; do echo Waiting for configFiles; sleep 1; done; cryptogen generate --config\n          /shared/artifacts/crypto-config.yaml && cp -r crypto-config /shared/ &&\n          for file in $(find /shared/ -iname *_sk); do echo $file; dir=$(dirname $file);\n          echo ${dir}; mv ${dir}/*_sk ${dir}/key.pem; done && find /shared -type d\n          | xargs chmod a+rx && find /shared -type f | xargs chmod a+r && touch /shared/status_cryptogen_complete;\n        volumeMounts:\n        - mountPath: /shared\n          name: sharedvolume\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - name: configtxgen\n        image: hyperledger/fabric-tools:1.3.0\n        imagePullPolicy: Always\n        command:\n        - sh\n        - -c\n        - echo 'Configtxgen Starts'; ls -l /shared; sleep 1 && while [ ! -f /shared/status_cryptogen_complete\n          ]; do echo Waiting for cryptogen; sleep 1; done; cp /shared/artifacts/configtx.yaml\n          /shared/; cd /shared/; export FABRIC_CFG_PATH=$PWD; configtxgen -profile\n          TwoOrgsOrdererGenesis -outputBlock genesis.block && find /shared -type d\n          | xargs chmod a+rx && find /shared -type f | xargs chmod a+r && touch /shared/status_configtxgen_complete\n          && rm /shared/status_cryptogen_complete;\n        volumeMounts:\n        - mountPath: /shared\n          name: sharedvolume\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      restartPolicy: OnFailure\n",
    "errors": []
  },
  {
    "id": "01926",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: utils\nspec:\n  template:\n    metadata:\n      name: utils\n    spec:\n      volumes:\n      - name: sharedvolume\n        persistentVolumeClaim:\n          claimName: shared-pvc\n      containers:\n      - name: cryptogen\n        image: hyperledger/fabric-tools:1.3.0\n        imagePullPolicy: Always\n        command:\n        - sh\n        - -c\n        - echo 'Cryptogen Starts'; ls -l /shared/artifacts; while [ ! -d /shared/artifacts\n          ]; do echo Waiting for configFiles; sleep 1; done; cd /shared && cryptogen\n          generate --config /shared/artifacts/crypto-config.yaml && for file in $(find\n          /shared/ -iname *_sk); do echo $file; dir=$(dirname $file); echo ${dir};\n          mv ${dir}/*_sk ${dir}/key.pem; done && find /shared -type d | xargs chmod\n          a+rx && find /shared -type f | xargs chmod a+r && touch /shared/status_cryptogen_complete;\n        volumeMounts:\n        - mountPath: /shared\n          name: sharedvolume\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - name: configtxgen\n        image: hyperledger/fabric-tools:1.3.0\n        imagePullPolicy: Always\n        command:\n        - sh\n        - -c\n        - echo 'Configtxgen Starts'; ls -l /shared; sleep 1 && while [ ! -f /shared/status_cryptogen_complete\n          ]; do echo Waiting for cryptogen; sleep 1; done; cp /shared/artifacts/configtx.yaml\n          /shared/; cd /shared/; export FABRIC_CFG_PATH=$PWD; configtxgen -profile\n          TwoOrgsOrdererGenesis -outputBlock genesis.block && find /shared -type d\n          | xargs chmod a+rx && find /shared -type f | xargs chmod a+r && touch /shared/status_configtxgen_complete\n          && rm /shared/status_cryptogen_complete;\n        volumeMounts:\n        - mountPath: /shared\n          name: sharedvolume\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      restartPolicy: OnFailure\n",
    "errors": []
  },
  {
    "id": "01927",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: utils\nspec:\n  template:\n    metadata:\n      name: utils\n    spec:\n      volumes:\n      - name: sharedvolume\n        persistentVolumeClaim:\n          claimName: shared-pvc\n      - name: dockersocket\n        emptyDir: {}\n      containers:\n      - name: cryptogen\n        image: hyperledger/fabric-tools:1.3.0\n        imagePullPolicy: Always\n        command:\n        - sh\n        - -c\n        - echo 'Cryptogen Starts'; ls -l /shared/artifacts; while [ ! -d /shared/artifacts\n          ]; do echo Waiting for configFiles; sleep 1; done; cryptogen generate --config\n          /shared/artifacts/crypto-config.yaml && cp -r crypto-config /shared/ &&\n          for file in $(find /shared/ -iname *_sk); do echo $file; dir=$(dirname $file);\n          echo ${dir}; mv ${dir}/*_sk ${dir}/key.pem; done && find /shared -type d\n          | xargs chmod a+rx && find /shared -type f | xargs chmod a+r && touch /shared/status_cryptogen_complete;\n        volumeMounts:\n        - mountPath: /shared\n          name: sharedvolume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n      - name: configtxgen\n        image: hyperledger/fabric-tools:1.3.0\n        imagePullPolicy: Always\n        command:\n        - sh\n        - -c\n        - echo 'Configtxgen Starts'; ls -l /shared; sleep 1 && while [ ! -f /shared/status_cryptogen_complete\n          ]; do echo Waiting for cryptogen; sleep 1; done; cp /shared/artifacts/configtx.yaml\n          /shared/; cd /shared/; export FABRIC_CFG_PATH=$PWD; configtxgen -profile\n          TwoOrgsOrdererGenesis -outputBlock genesis.block && find /shared -type d\n          | xargs chmod a+rx && find /shared -type f | xargs chmod a+r && touch /shared/status_configtxgen_complete\n          && rm /shared/status_cryptogen_complete;\n        volumeMounts:\n        - mountPath: /shared\n          name: sharedvolume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n      securityContext:\n        runAsNonRoot: true\n      restartPolicy: OnFailure\n",
    "errors": []
  },
  {
    "id": "01928",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: utils\nspec:\n  template:\n    metadata:\n      name: utils\n    spec:\n      volumes:\n      - name: sharedvolume\n        persistentVolumeClaim:\n          claimName: shared-pvc\n      containers:\n      - name: cryptogen\n        image: hyperledger/fabric-tools:1.3.0\n        imagePullPolicy: Always\n        command:\n        - sh\n        - -c\n        - echo 'Cryptogen Starts'; ls -l /shared/artifacts; while [ ! -d /shared/artifacts\n          ]; do echo Waiting for configFiles; sleep 1; done; cryptogen generate --config\n          /shared/artifacts/crypto-config.yaml && cp -r crypto-config /shared/ &&\n          for file in $(find /shared/ -iname *_sk); do echo $file; dir=$(dirname $file);\n          echo ${dir}; mv ${dir}/*_sk ${dir}/key.pem; done && find /shared -type d\n          | xargs chmod a+rx && find /shared -type f | xargs chmod a+r && touch /shared/status_cryptogen_complete;\n        volumeMounts:\n        - mountPath: /shared\n          name: sharedvolume\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - name: configtxgen\n        image: hyperledger/fabric-tools:1.3.0\n        imagePullPolicy: Always\n        command:\n        - sh\n        - -c\n        - echo 'Configtxgen Starts'; ls -l /shared; sleep 1 && while [ ! -f /shared/status_cryptogen_complete\n          ]; do echo Waiting for cryptogen; sleep 1; done; cp /shared/artifacts/configtx.yaml\n          /shared/; cd /shared/; export FABRIC_CFG_PATH=$PWD; configtxgen -profile\n          TwoOrgsOrdererGenesis -outputBlock genesis.block && find /shared -type d\n          | xargs chmod a+rx && find /shared -type f | xargs chmod a+r && touch /shared/status_configtxgen_complete\n          && rm /shared/status_cryptogen_complete;\n        volumeMounts:\n        - mountPath: /shared\n          name: sharedvolume\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      securityContext:\n        runAsNonRoot: true\n      restartPolicy: OnFailure\n",
    "errors": []
  },
  {
    "id": "01929",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: utils\nspec:\n  template:\n    metadata:\n      name: utils\n    spec:\n      volumes:\n      - name: sharedvolume\n        persistentVolumeClaim:\n          claimName: shared-pvc\n      - name: dockersocket\n        emptyDir: {}\n      containers:\n      - name: cryptogen\n        image: hyperledger/fabric-tools:1.3.0\n        imagePullPolicy: Always\n        command:\n        - sh\n        - -c\n        - echo 'Cryptogen Starts'; ls -l /shared/artifacts; while [ ! -d /shared/artifacts\n          ]; do echo Waiting for configFiles; sleep 1; done; cryptogen generate --config\n          /shared/artifacts/crypto-config.yaml && cp -r crypto-config /shared/ &&\n          for file in $(find /shared/ -iname *_sk); do echo $file; dir=$(dirname $file);\n          echo ${dir}; mv ${dir}/*_sk ${dir}/key.pem; done && find /shared -type d\n          | xargs chmod a+rx && find /shared -type f | xargs chmod a+r && touch /shared/status_cryptogen_complete;\n        volumeMounts:\n        - mountPath: /shared\n          name: sharedvolume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - name: configtxgen\n        image: hyperledger/fabric-tools:1.3.0\n        imagePullPolicy: Always\n        command:\n        - sh\n        - -c\n        - echo 'Configtxgen Starts'; ls -l /shared; sleep 1 && while [ ! -f /shared/status_cryptogen_complete\n          ]; do echo Waiting for cryptogen; sleep 1; done; cp /shared/artifacts/configtx.yaml\n          /shared/; cd /shared/; export FABRIC_CFG_PATH=$PWD; configtxgen -profile\n          TwoOrgsOrdererGenesis -outputBlock genesis.block && find /shared -type d\n          | xargs chmod a+rx && find /shared -type f | xargs chmod a+r && touch /shared/status_configtxgen_complete\n          && rm /shared/status_cryptogen_complete;\n        volumeMounts:\n        - mountPath: /shared\n          name: sharedvolume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      restartPolicy: OnFailure\n",
    "errors": []
  },
  {
    "id": "01930",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: utils\nspec:\n  template:\n    metadata:\n      name: utils\n    spec:\n      volumes:\n      - name: sharedvolume\n        persistentVolumeClaim:\n          claimName: shared-pvc\n      containers:\n      - name: cryptogen\n        image: hyperledger/fabric-tools:1.3.0\n        imagePullPolicy: Always\n        command:\n        - sh\n        - -c\n        - echo 'Cryptogen Starts'; ls -l /shared/artifacts; while [ ! -d /shared/artifacts\n          ]; do echo Waiting for configFiles; sleep 1; done; cryptogen generate --config\n          /shared/artifacts/crypto-config.yaml && cp -r crypto-config /shared/ &&\n          for file in $(find /shared/ -iname *_sk); do echo $file; dir=$(dirname $file);\n          echo ${dir}; mv ${dir}/*_sk ${dir}/key.pem; done && find /shared -type d\n          | xargs chmod a+rx && find /shared -type f | xargs chmod a+r && touch /shared/status_cryptogen_complete;\n        volumeMounts:\n        - mountPath: /shared\n          name: sharedvolume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - name: configtxgen\n        image: hyperledger/fabric-tools:1.3.0\n        imagePullPolicy: Always\n        command:\n        - sh\n        - -c\n        - echo 'Configtxgen Starts'; ls -l /shared; sleep 1 && while [ ! -f /shared/status_cryptogen_complete\n          ]; do echo Waiting for cryptogen; sleep 1; done; cp /shared/artifacts/configtx.yaml\n          /shared/; cd /shared/; export FABRIC_CFG_PATH=$PWD; configtxgen -profile\n          TwoOrgsOrdererGenesis -outputBlock genesis.block && find /shared -type d\n          | xargs chmod a+rx && find /shared -type f | xargs chmod a+r && touch /shared/status_configtxgen_complete\n          && rm /shared/status_cryptogen_complete;\n        volumeMounts:\n        - mountPath: /shared\n          name: sharedvolume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      restartPolicy: OnFailure\n",
    "errors": []
  },
  {
    "id": "01931",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: utils\nspec:\n  template:\n    metadata:\n      name: utils\n    spec:\n      volumes:\n      - name: sharedvolume\n        persistentVolumeClaim:\n          claimName: shared-pvc\n      - name: dockersocket\n        emptyDir: {}\n      containers:\n      - name: cryptogen\n        image: hyperledger/fabric-tools:1.3.0\n        imagePullPolicy: Always\n        command:\n        - sh\n        - -c\n        - echo 'Cryptogen Starts'; ls -l /shared/artifacts; while [ ! -d /shared/artifacts\n          ]; do echo Waiting for configFiles; sleep 1; done; cryptogen generate --config\n          /shared/artifacts/crypto-config.yaml && cp -r crypto-config /shared/ &&\n          for file in $(find /shared/ -iname *_sk); do echo $file; dir=$(dirname $file);\n          echo ${dir}; mv ${dir}/*_sk ${dir}/key.pem; done && find /shared -type d\n          | xargs chmod a+rx && find /shared -type f | xargs chmod a+r && touch /shared/status_cryptogen_complete;\n        volumeMounts:\n        - mountPath: /shared\n          name: sharedvolume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - name: configtxgen\n        image: hyperledger/fabric-tools:1.3.0\n        imagePullPolicy: Always\n        command:\n        - sh\n        - -c\n        - echo 'Configtxgen Starts'; ls -l /shared; sleep 1 && while [ ! -f /shared/status_cryptogen_complete\n          ]; do echo Waiting for cryptogen; sleep 1; done; cp /shared/artifacts/configtx.yaml\n          /shared/; cd /shared/; export FABRIC_CFG_PATH=$PWD; configtxgen -profile\n          TwoOrgsOrdererGenesis -outputBlock genesis.block && find /shared -type d\n          | xargs chmod a+rx && find /shared -type f | xargs chmod a+r && touch /shared/status_configtxgen_complete\n          && rm /shared/status_cryptogen_complete;\n        volumeMounts:\n        - mountPath: /shared\n          name: sharedvolume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      restartPolicy: OnFailure\n",
    "errors": []
  },
  {
    "id": "01932",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: utils\nspec:\n  template:\n    metadata:\n      name: utils\n    spec:\n      volumes:\n      - name: sharedvolume\n        persistentVolumeClaim:\n          claimName: shared-pvc\n      containers:\n      - name: cryptogen\n        image: hyperledger/fabric-tools:1.3.0\n        imagePullPolicy: Always\n        command:\n        - sh\n        - -c\n        - echo 'Cryptogen Starts'; ls -l /shared/artifacts; while [ ! -d /shared/artifacts\n          ]; do echo Waiting for configFiles; sleep 1; done; cryptogen generate --config\n          /shared/artifacts/crypto-config.yaml && cp -r crypto-config /shared/ &&\n          for file in $(find /shared/ -iname *_sk); do echo $file; dir=$(dirname $file);\n          echo ${dir}; mv ${dir}/*_sk ${dir}/key.pem; done && find /shared -type d\n          | xargs chmod a+rx && find /shared -type f | xargs chmod a+r && touch /shared/status_cryptogen_complete;\n        volumeMounts:\n        - mountPath: /shared\n          name: sharedvolume\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - name: configtxgen\n        image: hyperledger/fabric-tools:1.3.0\n        imagePullPolicy: Always\n        command:\n        - sh\n        - -c\n        - echo 'Configtxgen Starts'; ls -l /shared; sleep 1 && while [ ! -f /shared/status_cryptogen_complete\n          ]; do echo Waiting for cryptogen; sleep 1; done; cp /shared/artifacts/configtx.yaml\n          /shared/; cd /shared/; export FABRIC_CFG_PATH=$PWD; configtxgen -profile\n          TwoOrgsOrdererGenesis -outputBlock genesis.block && find /shared -type d\n          | xargs chmod a+rx && find /shared -type f | xargs chmod a+r && touch /shared/status_configtxgen_complete\n          && rm /shared/status_cryptogen_complete;\n        volumeMounts:\n        - mountPath: /shared\n          name: sharedvolume\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      restartPolicy: OnFailure\n",
    "errors": []
  },
  {
    "id": "01933",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: jaeger-operator\n  labels:\n    app: jaeger-operator-app\n  namespace: k8s-tracing-namespace\n  annotations:\n    developer/name: \"Mislav Jak\\u0161i\\u0107\"\n    developer/email: jaksicmislav@gmail.com\n    developer/url: https://github.com/MislavJaksic\n    developer/role: technical lead\n    developer/timezone: Europe/Zagreb\n    developer/picUrl: https://images.app.goo.gl/PCHZgd8oattge1i96\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: jaeger-operator\n  template:\n    metadata:\n      labels:\n        name: jaeger-operator\n    spec:\n      serviceAccountName: jaeger-operator\n      containers:\n      - name: jaeger-operator\n        image: jaegertracing/jaeger-operator:1.16.0\n        ports:\n        - containerPort: 8383\n          name: metrics\n        args:\n        - start\n        imagePullPolicy: Always\n        env:\n        - name: WATCH_NAMESPACE\n          value: ''\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: OPERATOR_NAME\n          value: jaeger-operator\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "01934",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: jaeger-operator\n  labels:\n    app: jaeger-operator-app\n  namespace: k8s-tracing-namespace\n  annotations:\n    developer/name: \"Mislav Jak\\u0161i\\u0107\"\n    developer/email: jaksicmislav@gmail.com\n    developer/url: https://github.com/MislavJaksic\n    developer/role: technical lead\n    developer/timezone: Europe/Zagreb\n    developer/picUrl: https://images.app.goo.gl/PCHZgd8oattge1i96\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: jaeger-operator\n  template:\n    metadata:\n      labels:\n        name: jaeger-operator\n    spec:\n      serviceAccountName: jaeger-operator\n      containers:\n      - name: jaeger-operator\n        image: jaegertracing/jaeger-operator:1.16.0\n        ports:\n        - containerPort: 8383\n          name: metrics\n        args:\n        - start\n        imagePullPolicy: Always\n        env:\n        - name: WATCH_NAMESPACE\n          value: ''\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: OPERATOR_NAME\n          value: jaeger-operator\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "01935",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: jaeger-operator\n  labels:\n    app: jaeger-operator-app\n  namespace: k8s-tracing-namespace\n  annotations:\n    developer/name: \"Mislav Jak\\u0161i\\u0107\"\n    developer/email: jaksicmislav@gmail.com\n    developer/url: https://github.com/MislavJaksic\n    developer/role: technical lead\n    developer/timezone: Europe/Zagreb\n    developer/picUrl: https://images.app.goo.gl/PCHZgd8oattge1i96\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: jaeger-operator\n  template:\n    metadata:\n      labels:\n        name: jaeger-operator\n    spec:\n      serviceAccountName: jaeger-operator\n      containers:\n      - name: jaeger-operator\n        image: jaegertracing/jaeger-operator:1.16.0\n        ports:\n        - containerPort: 8383\n          name: metrics\n        args:\n        - start\n        imagePullPolicy: Always\n        env:\n        - name: WATCH_NAMESPACE\n          value: ''\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: OPERATOR_NAME\n          value: jaeger-operator\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "01936",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: jaeger-operator\n  labels:\n    app: jaeger-operator-app\n  namespace: k8s-tracing-namespace\n  annotations:\n    developer/name: \"Mislav Jak\\u0161i\\u0107\"\n    developer/email: jaksicmislav@gmail.com\n    developer/url: https://github.com/MislavJaksic\n    developer/role: technical lead\n    developer/timezone: Europe/Zagreb\n    developer/picUrl: https://images.app.goo.gl/PCHZgd8oattge1i96\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: jaeger-operator\n  template:\n    metadata:\n      labels:\n        name: jaeger-operator\n    spec:\n      serviceAccountName: jaeger-operator\n      containers:\n      - name: jaeger-operator\n        image: jaegertracing/jaeger-operator:1.16.0\n        ports:\n        - containerPort: 8383\n          name: metrics\n        args:\n        - start\n        imagePullPolicy: Always\n        env:\n        - name: WATCH_NAMESPACE\n          value: ''\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: OPERATOR_NAME\n          value: jaeger-operator\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "01937",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: pod-evictor\n  namespace: bad-tenant\nspec:\n  containers:\n  - name: high-priority\n    image: nginxdemos/hello:stable\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 128Mi\n    securityContext:\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      privileged: false\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n      readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "01938",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: pod-evictor\n  namespace: bad-tenant\nspec:\n  containers:\n  - name: high-priority\n    image: nginxdemos/hello:stable\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 128Mi\n    securityContext:\n      readOnlyRootFilesystem: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "01939",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: pod-evictor\n  namespace: bad-tenant\nspec:\n  containers:\n  - name: high-priority\n    image: nginxdemos/hello:stable\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 128Mi\n    securityContext:\n      runAsNonRoot: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "01940",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: etherpad-lite\n  labels:\n    service: etherpad-lite\nspec:\n  selector:\n    matchLabels:\n      service: etherpad-lite\n  template:\n    metadata:\n      labels:\n        service: etherpad-lite\n    spec:\n      containers:\n      - name: etherpad-lite\n        image: etherpad/etherpad:1.8.6\n        imagePullPolicy: IfNotPresent\n        env:\n        - name: SKIN_NAME\n          valueFrom:\n            configMapKeyRef:\n              name: ether-config\n              key: skin\n        - name: NODE_ENV\n          valueFrom:\n            configMapKeyRef:\n              name: ether-config\n              key: env\n        - name: DB_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: ether-config\n              key: db_type\n        - name: DB_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: ether-config\n              key: db_host\n        - name: DB_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: ether-config\n              key: db_port\n        - name: DB_NAME\n          valueFrom:\n            configMapKeyRef:\n              name: ether-config\n              key: db_name\n        - name: DB_USER\n          valueFrom:\n            configMapKeyRef:\n              name: ether-config\n              key: db_user\n        - name: DB_CHARSET\n          valueFrom:\n            configMapKeyRef:\n              name: ether-config\n              key: db_charset\n        - name: PORT\n          valueFrom:\n            configMapKeyRef:\n              name: ether-config\n              key: port\n        - name: DB_PASS\n          valueFrom:\n            secretKeyRef:\n              name: ether-secret\n              key: db_password\n        - name: ADMIN_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: ether-secret\n              key: admin_password\n        ports:\n        - containerPort: 9001\n          name: https\n          protocol: TCP\n        volumeMounts:\n        - mountPath: /opt/etherpad-lite/var\n          name: data-volume\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: data-volume\n        persistentVolumeClaim:\n          claimName: ether-data-vol\n",
    "errors": []
  },
  {
    "id": "01941",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: etherpad-lite\n  labels:\n    service: etherpad-lite\nspec:\n  selector:\n    matchLabels:\n      service: etherpad-lite\n  template:\n    metadata:\n      labels:\n        service: etherpad-lite\n    spec:\n      containers:\n      - name: etherpad-lite\n        image: etherpad/etherpad:1.8.6\n        imagePullPolicy: IfNotPresent\n        env:\n        - name: SKIN_NAME\n          valueFrom:\n            configMapKeyRef:\n              name: ether-config\n              key: skin\n        - name: NODE_ENV\n          valueFrom:\n            configMapKeyRef:\n              name: ether-config\n              key: env\n        - name: DB_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: ether-config\n              key: db_type\n        - name: DB_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: ether-config\n              key: db_host\n        - name: DB_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: ether-config\n              key: db_port\n        - name: DB_NAME\n          valueFrom:\n            configMapKeyRef:\n              name: ether-config\n              key: db_name\n        - name: DB_USER\n          valueFrom:\n            configMapKeyRef:\n              name: ether-config\n              key: db_user\n        - name: DB_CHARSET\n          valueFrom:\n            configMapKeyRef:\n              name: ether-config\n              key: db_charset\n        - name: PORT\n          valueFrom:\n            configMapKeyRef:\n              name: ether-config\n              key: port\n        - name: DB_PASS\n          valueFrom:\n            secretKeyRef:\n              name: ether-secret\n              key: db_password\n        - name: ADMIN_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: ether-secret\n              key: admin_password\n        ports:\n        - containerPort: 9001\n          name: https\n          protocol: TCP\n        volumeMounts:\n        - mountPath: /opt/etherpad-lite/var\n          name: data-volume\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: data-volume\n        persistentVolumeClaim:\n          claimName: ether-data-vol\n",
    "errors": []
  },
  {
    "id": "01942",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: etherpad-lite\n  labels:\n    service: etherpad-lite\nspec:\n  selector:\n    matchLabels:\n      service: etherpad-lite\n  template:\n    metadata:\n      labels:\n        service: etherpad-lite\n    spec:\n      containers:\n      - name: etherpad-lite\n        image: etherpad/etherpad:1.8.6\n        imagePullPolicy: IfNotPresent\n        env:\n        - name: SKIN_NAME\n          valueFrom:\n            configMapKeyRef:\n              name: ether-config\n              key: skin\n        - name: NODE_ENV\n          valueFrom:\n            configMapKeyRef:\n              name: ether-config\n              key: env\n        - name: DB_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: ether-config\n              key: db_type\n        - name: DB_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: ether-config\n              key: db_host\n        - name: DB_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: ether-config\n              key: db_port\n        - name: DB_NAME\n          valueFrom:\n            configMapKeyRef:\n              name: ether-config\n              key: db_name\n        - name: DB_USER\n          valueFrom:\n            configMapKeyRef:\n              name: ether-config\n              key: db_user\n        - name: DB_CHARSET\n          valueFrom:\n            configMapKeyRef:\n              name: ether-config\n              key: db_charset\n        - name: PORT\n          valueFrom:\n            configMapKeyRef:\n              name: ether-config\n              key: port\n        - name: DB_PASS\n          valueFrom:\n            secretKeyRef:\n              name: ether-secret\n              key: db_password\n        - name: ADMIN_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: ether-secret\n              key: admin_password\n        ports:\n        - containerPort: 9001\n          name: https\n          protocol: TCP\n        volumeMounts:\n        - mountPath: /opt/etherpad-lite/var\n          name: data-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: data-volume\n        persistentVolumeClaim:\n          claimName: ether-data-vol\n",
    "errors": []
  },
  {
    "id": "01943",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: etherpad-lite\n  labels:\n    service: etherpad-lite\nspec:\n  selector:\n    matchLabels:\n      service: etherpad-lite\n  template:\n    metadata:\n      labels:\n        service: etherpad-lite\n    spec:\n      containers:\n      - name: etherpad-lite\n        image: etherpad/etherpad:1.8.6\n        imagePullPolicy: IfNotPresent\n        env:\n        - name: SKIN_NAME\n          valueFrom:\n            configMapKeyRef:\n              name: ether-config\n              key: skin\n        - name: NODE_ENV\n          valueFrom:\n            configMapKeyRef:\n              name: ether-config\n              key: env\n        - name: DB_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: ether-config\n              key: db_type\n        - name: DB_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: ether-config\n              key: db_host\n        - name: DB_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: ether-config\n              key: db_port\n        - name: DB_NAME\n          valueFrom:\n            configMapKeyRef:\n              name: ether-config\n              key: db_name\n        - name: DB_USER\n          valueFrom:\n            configMapKeyRef:\n              name: ether-config\n              key: db_user\n        - name: DB_CHARSET\n          valueFrom:\n            configMapKeyRef:\n              name: ether-config\n              key: db_charset\n        - name: PORT\n          valueFrom:\n            configMapKeyRef:\n              name: ether-config\n              key: port\n        - name: DB_PASS\n          valueFrom:\n            secretKeyRef:\n              name: ether-secret\n              key: db_password\n        - name: ADMIN_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: ether-secret\n              key: admin_password\n        ports:\n        - containerPort: 9001\n          name: https\n          protocol: TCP\n        volumeMounts:\n        - mountPath: /opt/etherpad-lite/var\n          name: data-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: data-volume\n        persistentVolumeClaim:\n          claimName: ether-data-vol\n",
    "errors": []
  },
  {
    "id": "01944",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: secret-test-pod\nspec:\n  containers:\n  - name: test-container\n    image: gcr.io/google_containers/mounttest:0.8\n    command:\n    - /mt\n    - --file_content=/etc/secret-volume/data-1\n    volumeMounts:\n    - name: secret-volume\n      mountPath: /etc/secret-volume\n    securityContext:\n      readOnlyRootFilesystem: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n  volumes:\n  - name: secret-volume\n    secret:\n      secretName: test-secret\n",
    "errors": []
  },
  {
    "id": "01945",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: secret-test-pod\nspec:\n  containers:\n  - name: test-container\n    image: gcr.io/google_containers/mounttest:0.8\n    command:\n    - /mt\n    - --file_content=/etc/secret-volume/data-1\n    volumeMounts:\n    - name: secret-volume\n      mountPath: /etc/secret-volume\n    securityContext:\n      runAsNonRoot: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      readOnlyRootFilesystem: true\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n  volumes:\n  - name: secret-volume\n    secret:\n      secretName: test-secret\n",
    "errors": []
  },
  {
    "id": "01946",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: secret-test-pod\nspec:\n  containers:\n  - name: test-container\n    image: gcr.io/google_containers/mounttest:0.8\n    command:\n    - /mt\n    - --file_content=/etc/secret-volume/data-1\n    volumeMounts:\n    - name: secret-volume\n      mountPath: /etc/secret-volume\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n      readOnlyRootFilesystem: true\n  volumes:\n  - name: secret-volume\n    secret:\n      secretName: test-secret\n",
    "errors": []
  },
  {
    "id": "01947",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: secret-test-pod\nspec:\n  containers:\n  - name: test-container\n    image: gcr.io/google_containers/mounttest:0.8\n    command:\n    - /mt\n    - --file_content=/etc/secret-volume/data-1\n    volumeMounts:\n    - name: secret-volume\n      mountPath: /etc/secret-volume\n    resources:\n      limits:\n        cpu: 500m\n        memory: 256Mi\n      requests:\n        cpu: 100m\n        memory: 128Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n      readOnlyRootFilesystem: true\n  volumes:\n  - name: secret-volume\n    secret:\n      secretName: test-secret\n",
    "errors": []
  },
  {
    "id": "01948",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: grafana\n  namespace: monitoring\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: grafana\n  template:\n    metadata:\n      name: grafana\n      labels:\n        app: grafana\n    spec:\n      containers:\n      - name: grafana\n        image: grafana/grafana:stable\n        ports:\n        - name: grafana\n          containerPort: 3000\n        volumeMounts:\n        - mountPath: /var/lib/grafana\n          name: grafana-storage\n        - mountPath: /etc/grafana/provisioning/datasources\n          name: grafana-datasources\n          readOnly: false\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: grafana-storage\n        persistentVolumeClaim:\n          claimName: pvc-nfs-storage\n      - name: grafana-datasources\n        configMap:\n          defaultMode: 420\n          name: grafana-datasources\n",
    "errors": []
  },
  {
    "id": "01949",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: grafana\n  namespace: monitoring\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: grafana\n  template:\n    metadata:\n      name: grafana\n      labels:\n        app: grafana\n    spec:\n      containers:\n      - name: grafana\n        image: grafana/grafana:stable\n        ports:\n        - name: grafana\n          containerPort: 3000\n        volumeMounts:\n        - mountPath: /var/lib/grafana\n          name: grafana-storage\n        - mountPath: /etc/grafana/provisioning/datasources\n          name: grafana-datasources\n          readOnly: false\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: grafana-storage\n        persistentVolumeClaim:\n          claimName: pvc-nfs-storage\n      - name: grafana-datasources\n        configMap:\n          defaultMode: 420\n          name: grafana-datasources\n",
    "errors": []
  },
  {
    "id": "01950",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: grafana\n  namespace: monitoring\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: grafana\n  template:\n    metadata:\n      name: grafana\n      labels:\n        app: grafana\n    spec:\n      containers:\n      - name: grafana\n        image: grafana/grafana:stable\n        ports:\n        - name: grafana\n          containerPort: 3000\n        volumeMounts:\n        - mountPath: /var/lib/grafana\n          name: grafana-storage\n        - mountPath: /etc/grafana/provisioning/datasources\n          name: grafana-datasources\n          readOnly: false\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: grafana-storage\n        persistentVolumeClaim:\n          claimName: pvc-nfs-storage\n      - name: grafana-datasources\n        configMap:\n          defaultMode: 420\n          name: grafana-datasources\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "01951",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: grafana\n  namespace: monitoring\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: grafana\n  template:\n    metadata:\n      name: grafana\n      labels:\n        app: grafana\n    spec:\n      containers:\n      - name: grafana\n        image: grafana/grafana:stable\n        ports:\n        - name: grafana\n          containerPort: 3000\n        volumeMounts:\n        - mountPath: /var/lib/grafana\n          name: grafana-storage\n        - mountPath: /etc/grafana/provisioning/datasources\n          name: grafana-datasources\n          readOnly: false\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: grafana-storage\n        persistentVolumeClaim:\n          claimName: pvc-nfs-storage\n      - name: grafana-datasources\n        configMap:\n          defaultMode: 420\n          name: grafana-datasources\n",
    "errors": []
  },
  {
    "id": "01952",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: grafana\n  namespace: monitoring\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: grafana\n  template:\n    metadata:\n      name: grafana\n      labels:\n        app: grafana\n    spec:\n      containers:\n      - name: grafana\n        image: grafana/grafana:stable\n        ports:\n        - name: grafana\n          containerPort: 3000\n        volumeMounts:\n        - mountPath: /var/lib/grafana\n          name: grafana-storage\n        - mountPath: /etc/grafana/provisioning/datasources\n          name: grafana-datasources\n          readOnly: false\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: grafana-storage\n        persistentVolumeClaim:\n          claimName: pvc-nfs-storage\n      - name: grafana-datasources\n        configMap:\n          defaultMode: 420\n          name: grafana-datasources\n",
    "errors": []
  },
  {
    "id": "01953",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-1210\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    securityContext:\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      privileged: false\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n      readOnlyRootFilesystem: true\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "01954",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-1210\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    securityContext:\n      readOnlyRootFilesystem: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "01955",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-1210\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      runAsNonRoot: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "01956",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-1210\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n      readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "01957",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-1210\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n      readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "01958",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deployment\nspec:\n  selector:\n    matchLabels:\n      app: nginx\n  replicas: 2\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - name: nginx\n        image: nginx:1.14.2\n        ports:\n        - containerPort: 80\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "01959",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deployment\nspec:\n  selector:\n    matchLabels:\n      app: nginx\n  replicas: 2\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - name: nginx\n        image: nginx:1.14.2\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "01960",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deployment\nspec:\n  selector:\n    matchLabels:\n      app: nginx\n  replicas: 2\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - name: nginx\n        image: nginx:1.14.2\n        ports:\n        - containerPort: 80\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  }
]