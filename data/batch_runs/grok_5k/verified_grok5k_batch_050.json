[
  {
    "id": "02001",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app.kubernetes.io/name: sample-app\n  name: sample-app\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: sample-app\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/name: sample-app\n    spec:\n      containers:\n      - image: quay.io/mpeters/sample-app:stable\n        imagePullPolicy: Always\n        name: sample-app\n        ports:\n        - containerPort: 8080\n        env:\n        - name: NODE_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.hostIP\n        - name: POD_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "02002",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app.kubernetes.io/name: sample-app\n  name: sample-app\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: sample-app\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/name: sample-app\n    spec:\n      containers:\n      - image: quay.io/mpeters/sample-app:stable\n        imagePullPolicy: Always\n        name: sample-app\n        ports:\n        - containerPort: 8080\n        env:\n        - name: NODE_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.hostIP\n        - name: POD_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "02003",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app.kubernetes.io/name: sample-app\n  name: sample-app\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: sample-app\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/name: sample-app\n    spec:\n      containers:\n      - image: quay.io/mpeters/sample-app:stable\n        imagePullPolicy: Always\n        name: sample-app\n        ports:\n        - containerPort: 8080\n        env:\n        - name: NODE_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.hostIP\n        - name: POD_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "02004",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  labels:\n    app.kubernetes.io/component: adaptor\n  name: adaptor\n  namespace: system\nspec:\n  selector:\n    matchLabels:\n      app.kubernetes.io/component: adaptor\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/component: adaptor\n    spec:\n      containers:\n      - name: octopus\n        image: cnrancher/octopus-adaptor-modbus:master\n        volumeMounts:\n        - mountPath: /var/lib/octopus/adaptors/\n          name: sockets\n        - mountPath: /dev\n          name: dev\n        securityContext:\n          privileged: false\n          readOnlyRootFilesystem: true\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: sockets\n        emptyDir: {}\n      - name: dev\n        emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "02005",
    "policy_id": "drop_capabilities",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  labels:\n    app.kubernetes.io/component: adaptor\n  name: adaptor\n  namespace: system\nspec:\n  selector:\n    matchLabels:\n      app.kubernetes.io/component: adaptor\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/component: adaptor\n    spec:\n      containers:\n      - name: octopus\n        image: cnrancher/octopus-adaptor-modbus:master\n        volumeMounts:\n        - mountPath: /var/lib/octopus/adaptors/\n          name: sockets\n        - mountPath: /dev\n          name: dev\n        securityContext:\n          privileged: false\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: sockets\n        emptyDir: {}\n      - name: dev\n        emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "02006",
    "policy_id": "no_privileged",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  labels:\n    app.kubernetes.io/component: adaptor\n  name: adaptor\n  namespace: system\nspec:\n  selector:\n    matchLabels:\n      app.kubernetes.io/component: adaptor\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/component: adaptor\n    spec:\n      containers:\n      - name: octopus\n        image: cnrancher/octopus-adaptor-modbus:master\n        volumeMounts:\n        - mountPath: /var/lib/octopus/adaptors/\n          name: sockets\n        - mountPath: /dev\n          name: dev\n        securityContext:\n          privileged: false\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: sockets\n        emptyDir: {}\n      - name: dev\n        emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "02007",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  labels:\n    app.kubernetes.io/component: adaptor\n  name: adaptor\n  namespace: system\nspec:\n  selector:\n    matchLabels:\n      app.kubernetes.io/component: adaptor\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/component: adaptor\n    spec:\n      containers:\n      - name: octopus\n        image: cnrancher/octopus-adaptor-modbus:master\n        volumeMounts:\n        - mountPath: /var/lib/octopus/adaptors/\n          name: sockets\n        - mountPath: /dev\n          name: dev\n        securityContext:\n          privileged: false\n          runAsNonRoot: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: sockets\n        emptyDir: {}\n      - name: dev\n        emptyDir: {}\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "02008",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  labels:\n    app.kubernetes.io/component: adaptor\n  name: adaptor\n  namespace: system\nspec:\n  selector:\n    matchLabels:\n      app.kubernetes.io/component: adaptor\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/component: adaptor\n    spec:\n      containers:\n      - name: octopus\n        image: cnrancher/octopus-adaptor-modbus:master\n        volumeMounts:\n        - mountPath: /var/lib/octopus/adaptors/\n          name: sockets\n        - mountPath: /dev\n          name: dev\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: sockets\n        emptyDir: {}\n      - name: dev\n        emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "02009",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  labels:\n    app.kubernetes.io/component: adaptor\n  name: adaptor\n  namespace: system\nspec:\n  selector:\n    matchLabels:\n      app.kubernetes.io/component: adaptor\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/component: adaptor\n    spec:\n      containers:\n      - name: octopus\n        image: cnrancher/octopus-adaptor-modbus:master\n        volumeMounts:\n        - mountPath: /var/lib/octopus/adaptors/\n          name: sockets\n        - mountPath: /dev\n          name: dev\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: sockets\n        emptyDir: {}\n      - name: dev\n        emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "02010",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: CronJob\nmetadata:\n  name: cron-composites-lib-unb-ca\n  namespace: dev\n  labels:\n    app: drupal\n    tier: cron\nspec:\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          containers:\n          - name: cron-composites-lib-unb-ca\n            command:\n            - /scripts/drupalCronEntry.sh\n            env:\n            - name: DEPLOY_ENV\n              value: dev\n            - name: MYSQL_HOSTNAME\n              value: drupal-mysql-lib-unb-ca\n            - name: MYSQL_PORT\n              value: '3306'\n            image: '||DEPLOYMENTIMAGE||:stable'\n            imagePullPolicy: Always\n            volumeMounts:\n            - mountPath: /app/html/sites/default\n              name: drupal-persistent-storage\n            securityContext:\n              capabilities:\n                drop:\n                - NET_RAW\n                - NET_ADMIN\n                - SYS_ADMIN\n                - SYS_MODULE\n                - SYS_PTRACE\n                - SYS_CHROOT\n              privileged: false\n              allowPrivilegeEscalation: false\n              runAsNonRoot: true\n              readOnlyRootFilesystem: true\n            resources:\n              requests:\n                cpu: 100m\n                memory: 128Mi\n              limits:\n                cpu: 500m\n                memory: 256Mi\n          volumes:\n          - name: drupal-persistent-storage\n            persistentVolumeClaim:\n              claimName: composites-lib-unb-ca\n          restartPolicy: OnFailure\n  schedule: 0 0 * * *\n",
    "errors": []
  },
  {
    "id": "02011",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: CronJob\nmetadata:\n  name: cron-composites-lib-unb-ca\n  namespace: dev\n  labels:\n    app: drupal\n    tier: cron\nspec:\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          containers:\n          - name: cron-composites-lib-unb-ca\n            command:\n            - /scripts/drupalCronEntry.sh\n            env:\n            - name: DEPLOY_ENV\n              value: dev\n            - name: MYSQL_HOSTNAME\n              value: drupal-mysql-lib-unb-ca\n            - name: MYSQL_PORT\n              value: '3306'\n            image: '||DEPLOYMENTIMAGE||:stable'\n            imagePullPolicy: Always\n            volumeMounts:\n            - mountPath: /app/html/sites/default\n              name: drupal-persistent-storage\n            securityContext:\n              readOnlyRootFilesystem: true\n              privileged: false\n              capabilities:\n                drop:\n                - NET_RAW\n                - NET_ADMIN\n                - SYS_ADMIN\n                - SYS_MODULE\n                - SYS_PTRACE\n                - SYS_CHROOT\n              allowPrivilegeEscalation: false\n              runAsNonRoot: true\n            resources:\n              requests:\n                cpu: 100m\n                memory: 128Mi\n              limits:\n                cpu: 500m\n                memory: 256Mi\n          volumes:\n          - name: drupal-persistent-storage\n            persistentVolumeClaim:\n              claimName: composites-lib-unb-ca\n          restartPolicy: OnFailure\n  schedule: 0 0 * * *\n",
    "errors": []
  },
  {
    "id": "02012",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: CronJob\nmetadata:\n  name: cron-composites-lib-unb-ca\n  namespace: dev\n  labels:\n    app: drupal\n    tier: cron\nspec:\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          containers:\n          - name: cron-composites-lib-unb-ca\n            command:\n            - /scripts/drupalCronEntry.sh\n            env:\n            - name: DEPLOY_ENV\n              value: dev\n            - name: MYSQL_HOSTNAME\n              value: drupal-mysql-lib-unb-ca\n            - name: MYSQL_PORT\n              value: '3306'\n            image: '||DEPLOYMENTIMAGE||:stable'\n            imagePullPolicy: Always\n            volumeMounts:\n            - mountPath: /app/html/sites/default\n              name: drupal-persistent-storage\n            securityContext:\n              runAsNonRoot: true\n              privileged: false\n              capabilities:\n                drop:\n                - NET_RAW\n                - NET_ADMIN\n                - SYS_ADMIN\n                - SYS_MODULE\n                - SYS_PTRACE\n                - SYS_CHROOT\n              allowPrivilegeEscalation: false\n              readOnlyRootFilesystem: true\n            resources:\n              requests:\n                cpu: 100m\n                memory: 128Mi\n              limits:\n                cpu: 500m\n                memory: 256Mi\n          volumes:\n          - name: drupal-persistent-storage\n            persistentVolumeClaim:\n              claimName: composites-lib-unb-ca\n          restartPolicy: OnFailure\n  schedule: 0 0 * * *\n",
    "errors": []
  },
  {
    "id": "02013",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: CronJob\nmetadata:\n  name: cron-composites-lib-unb-ca\n  namespace: dev\n  labels:\n    app: drupal\n    tier: cron\nspec:\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          containers:\n          - name: cron-composites-lib-unb-ca\n            command:\n            - /scripts/drupalCronEntry.sh\n            env:\n            - name: DEPLOY_ENV\n              value: dev\n            - name: MYSQL_HOSTNAME\n              value: drupal-mysql-lib-unb-ca\n            - name: MYSQL_PORT\n              value: '3306'\n            image: '||DEPLOYMENTIMAGE||:stable'\n            imagePullPolicy: Always\n            volumeMounts:\n            - mountPath: /app/html/sites/default\n              name: drupal-persistent-storage\n            resources:\n              requests:\n                cpu: 100m\n                memory: 128Mi\n              limits:\n                cpu: 500m\n                memory: 256Mi\n            securityContext:\n              privileged: false\n              capabilities:\n                drop:\n                - NET_RAW\n                - NET_ADMIN\n                - SYS_ADMIN\n                - SYS_MODULE\n                - SYS_PTRACE\n                - SYS_CHROOT\n              allowPrivilegeEscalation: false\n              runAsNonRoot: true\n              readOnlyRootFilesystem: true\n          volumes:\n          - name: drupal-persistent-storage\n            persistentVolumeClaim:\n              claimName: composites-lib-unb-ca\n          restartPolicy: OnFailure\n  schedule: 0 0 * * *\n",
    "errors": []
  },
  {
    "id": "02014",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: CronJob\nmetadata:\n  name: cron-composites-lib-unb-ca\n  namespace: dev\n  labels:\n    app: drupal\n    tier: cron\nspec:\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          containers:\n          - name: cron-composites-lib-unb-ca\n            command:\n            - /scripts/drupalCronEntry.sh\n            env:\n            - name: DEPLOY_ENV\n              value: dev\n            - name: MYSQL_HOSTNAME\n              value: drupal-mysql-lib-unb-ca\n            - name: MYSQL_PORT\n              value: '3306'\n            image: '||DEPLOYMENTIMAGE||:stable'\n            imagePullPolicy: Always\n            volumeMounts:\n            - mountPath: /app/html/sites/default\n              name: drupal-persistent-storage\n            resources:\n              requests:\n                cpu: 100m\n                memory: 128Mi\n              limits:\n                cpu: 500m\n                memory: 256Mi\n            securityContext:\n              privileged: false\n              capabilities:\n                drop:\n                - NET_RAW\n                - NET_ADMIN\n                - SYS_ADMIN\n                - SYS_MODULE\n                - SYS_PTRACE\n                - SYS_CHROOT\n              allowPrivilegeEscalation: false\n              runAsNonRoot: true\n              readOnlyRootFilesystem: true\n          volumes:\n          - name: drupal-persistent-storage\n            persistentVolumeClaim:\n              claimName: composites-lib-unb-ca\n          restartPolicy: OnFailure\n  schedule: 0 0 * * *\n",
    "errors": []
  },
  {
    "id": "02015",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: graphql-server-deployment\n  namespace: hm\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      component: graphql-server\n  template:\n    metadata:\n      labels:\n        component: graphql-server\n    spec:\n      containers:\n      - name: graphql-server\n        image: hongbomiao/hm-graphql-server:stable\n        env:\n        - name: APP_ENV\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: app_env\n        - name: PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: port\n        - name: GRPC_SERVER_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: grpc_server_host\n        - name: GRPC_SERVER_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: grpc_server_port\n        - name: OPA_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opa_host\n        - name: OPA_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opa_port\n        - name: DGRAPH_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: dgraph_host\n        - name: DGRAPH_GRPC_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: dgraph_grpc_port\n        - name: REDIS_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_host\n        - name: REDIS_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_port\n        - name: REDIS_DB\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_db\n        - name: MINIO_ENDPOINT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_endpoint\n        - name: MINIO_ACCESS_KEY_ID\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_access_key_id\n        - name: MINIO_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: minio-secret-access-key-secret\n              key: minio_secret_access_key\n        - name: TORCH_SERVE_GRPC_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: torch_serve_grpc_host\n        - name: TORCH_SERVE_GRPC_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: torch_serve_grpc_port\n        - name: OPEN_CENSUS_AGENT_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: open_census_agent_host\n        - name: OPEN_CENSUS_AGENT_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: open_census_agent_port\n        - name: JAEGER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: jaeger_url\n        - name: JWT_SECRET\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: jwt_secret\n        - name: ELASTIC_APM_SERVICE_NAME\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: elastic_apm_service_name\n        - name: ELASTIC_APM_SERVER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_server_url\n        - name: ELASTIC_APM_ENVIRONMENT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_environment\n        - name: ELASTIC_APM_SECRET_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: hm-elastic-apm\n              key: token\n        - name: ELASTIC_APM_VERIFY_SERVER_CERT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_verify_server_cert\n        - name: ELASTIC_APM_SERVER_CERT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_server_cert\n        - name: ELASTIC_APM_LOG_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_log_level\n        - name: ELASTIC_APM_LOG_FILE\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_log_file\n        ports:\n        - name: graphql-server\n          protocol: TCP\n          containerPort: 31800\n        volumeMounts:\n        - mountPath: /data/elastic-apm\n          name: elastic-apm-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - name: opal-client\n        image: hongbomiao/hm-opal-client:stable\n        env:\n        - name: OPAL_CLIENT_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: hm-opal-client-secret\n              key: opal_client_token\n        - name: OPAL_SERVER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_server_url\n        - name: OPAL_FETCH_PROVIDER_MODULES\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_fetch_provider_modules\n        - name: OPAL_INLINE_OPA_CONFIG\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_inline_opa_config\n        - name: OPAL_INLINE_OPA_LOG_FORMAT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_inline_opa_log_format\n        - name: OPAL_LOG_MODULE_EXCLUDE_LIST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_log_module_exclude_list\n        - name: OPAL_LOG_COLORIZE\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_log_colorize\n        ports:\n        - name: opal-client\n          protocol: TCP\n          containerPort: 7000\n        - name: opa\n          protocol: TCP\n          containerPort: 8181\n        volumeMounts:\n        - mountPath: /data/opa\n          name: opa-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: elastic-apm-volume\n        persistentVolumeClaim:\n          claimName: elastic-apm-pvc\n      - name: opa-volume\n        persistentVolumeClaim:\n          claimName: opa-pvc\n",
    "errors": []
  },
  {
    "id": "02016",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: graphql-server-deployment\n  namespace: hm\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      component: graphql-server\n  template:\n    metadata:\n      labels:\n        component: graphql-server\n    spec:\n      containers:\n      - name: graphql-server\n        image: hongbomiao/hm-graphql-server:stable\n        env:\n        - name: APP_ENV\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: app_env\n        - name: PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: port\n        - name: GRPC_SERVER_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: grpc_server_host\n        - name: GRPC_SERVER_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: grpc_server_port\n        - name: OPA_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opa_host\n        - name: OPA_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opa_port\n        - name: DGRAPH_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: dgraph_host\n        - name: DGRAPH_GRPC_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: dgraph_grpc_port\n        - name: REDIS_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_host\n        - name: REDIS_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_port\n        - name: REDIS_DB\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_db\n        - name: MINIO_ENDPOINT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_endpoint\n        - name: MINIO_ACCESS_KEY_ID\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_access_key_id\n        - name: MINIO_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: minio-secret-access-key-secret\n              key: minio_secret_access_key\n        - name: TORCH_SERVE_GRPC_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: torch_serve_grpc_host\n        - name: TORCH_SERVE_GRPC_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: torch_serve_grpc_port\n        - name: OPEN_CENSUS_AGENT_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: open_census_agent_host\n        - name: OPEN_CENSUS_AGENT_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: open_census_agent_port\n        - name: JAEGER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: jaeger_url\n        - name: JWT_SECRET\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: jwt_secret\n        - name: ELASTIC_APM_SERVICE_NAME\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: elastic_apm_service_name\n        - name: ELASTIC_APM_SERVER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_server_url\n        - name: ELASTIC_APM_ENVIRONMENT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_environment\n        - name: ELASTIC_APM_SECRET_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: hm-elastic-apm\n              key: token\n        - name: ELASTIC_APM_VERIFY_SERVER_CERT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_verify_server_cert\n        - name: ELASTIC_APM_SERVER_CERT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_server_cert\n        - name: ELASTIC_APM_LOG_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_log_level\n        - name: ELASTIC_APM_LOG_FILE\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_log_file\n        ports:\n        - name: graphql-server\n          protocol: TCP\n          containerPort: 31800\n        volumeMounts:\n        - mountPath: /data/elastic-apm\n          name: elastic-apm-volume\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - name: opal-client\n        image: hongbomiao/hm-opal-client:stable\n        env:\n        - name: OPAL_CLIENT_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: hm-opal-client-secret\n              key: opal_client_token\n        - name: OPAL_SERVER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_server_url\n        - name: OPAL_FETCH_PROVIDER_MODULES\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_fetch_provider_modules\n        - name: OPAL_INLINE_OPA_CONFIG\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_inline_opa_config\n        - name: OPAL_INLINE_OPA_LOG_FORMAT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_inline_opa_log_format\n        - name: OPAL_LOG_MODULE_EXCLUDE_LIST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_log_module_exclude_list\n        - name: OPAL_LOG_COLORIZE\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_log_colorize\n        ports:\n        - name: opal-client\n          protocol: TCP\n          containerPort: 7000\n        - name: opa\n          protocol: TCP\n          containerPort: 8181\n        volumeMounts:\n        - mountPath: /data/opa\n          name: opa-volume\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: elastic-apm-volume\n        persistentVolumeClaim:\n          claimName: elastic-apm-pvc\n      - name: opa-volume\n        persistentVolumeClaim:\n          claimName: opa-pvc\n",
    "errors": []
  },
  {
    "id": "02017",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: graphql-server-deployment\n  namespace: hm\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      component: graphql-server\n  template:\n    metadata:\n      labels:\n        component: graphql-server\n    spec:\n      containers:\n      - name: graphql-server\n        image: hongbomiao/hm-graphql-server:stable\n        env:\n        - name: APP_ENV\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: app_env\n        - name: PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: port\n        - name: GRPC_SERVER_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: grpc_server_host\n        - name: GRPC_SERVER_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: grpc_server_port\n        - name: OPA_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opa_host\n        - name: OPA_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opa_port\n        - name: DGRAPH_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: dgraph_host\n        - name: DGRAPH_GRPC_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: dgraph_grpc_port\n        - name: REDIS_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_host\n        - name: REDIS_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_port\n        - name: REDIS_DB\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_db\n        - name: MINIO_ENDPOINT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_endpoint\n        - name: MINIO_ACCESS_KEY_ID\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_access_key_id\n        - name: MINIO_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: minio-secret-access-key-secret\n              key: minio_secret_access_key\n        - name: TORCH_SERVE_GRPC_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: torch_serve_grpc_host\n        - name: TORCH_SERVE_GRPC_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: torch_serve_grpc_port\n        - name: OPEN_CENSUS_AGENT_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: open_census_agent_host\n        - name: OPEN_CENSUS_AGENT_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: open_census_agent_port\n        - name: JAEGER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: jaeger_url\n        - name: JWT_SECRET\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: jwt_secret\n        - name: ELASTIC_APM_SERVICE_NAME\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: elastic_apm_service_name\n        - name: ELASTIC_APM_SERVER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_server_url\n        - name: ELASTIC_APM_ENVIRONMENT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_environment\n        - name: ELASTIC_APM_SECRET_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: hm-elastic-apm\n              key: token\n        - name: ELASTIC_APM_VERIFY_SERVER_CERT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_verify_server_cert\n        - name: ELASTIC_APM_SERVER_CERT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_server_cert\n        - name: ELASTIC_APM_LOG_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_log_level\n        - name: ELASTIC_APM_LOG_FILE\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_log_file\n        ports:\n        - name: graphql-server\n          protocol: TCP\n          containerPort: 31800\n        volumeMounts:\n        - mountPath: /data/elastic-apm\n          name: elastic-apm-volume\n        securityContext:\n          privileged: false\n          readOnlyRootFilesystem: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - name: opal-client\n        image: hongbomiao/hm-opal-client:stable\n        env:\n        - name: OPAL_CLIENT_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: hm-opal-client-secret\n              key: opal_client_token\n        - name: OPAL_SERVER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_server_url\n        - name: OPAL_FETCH_PROVIDER_MODULES\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_fetch_provider_modules\n        - name: OPAL_INLINE_OPA_CONFIG\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_inline_opa_config\n        - name: OPAL_INLINE_OPA_LOG_FORMAT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_inline_opa_log_format\n        - name: OPAL_LOG_MODULE_EXCLUDE_LIST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_log_module_exclude_list\n        - name: OPAL_LOG_COLORIZE\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_log_colorize\n        ports:\n        - name: opal-client\n          protocol: TCP\n          containerPort: 7000\n        - name: opa\n          protocol: TCP\n          containerPort: 8181\n        volumeMounts:\n        - mountPath: /data/opa\n          name: opa-volume\n        securityContext:\n          privileged: false\n          readOnlyRootFilesystem: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: elastic-apm-volume\n        persistentVolumeClaim:\n          claimName: elastic-apm-pvc\n      - name: opa-volume\n        persistentVolumeClaim:\n          claimName: opa-pvc\n",
    "errors": []
  },
  {
    "id": "02018",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: graphql-server-deployment\n  namespace: hm\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      component: graphql-server\n  template:\n    metadata:\n      labels:\n        component: graphql-server\n    spec:\n      containers:\n      - name: graphql-server\n        image: hongbomiao/hm-graphql-server:stable\n        env:\n        - name: APP_ENV\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: app_env\n        - name: PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: port\n        - name: GRPC_SERVER_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: grpc_server_host\n        - name: GRPC_SERVER_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: grpc_server_port\n        - name: OPA_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opa_host\n        - name: OPA_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opa_port\n        - name: DGRAPH_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: dgraph_host\n        - name: DGRAPH_GRPC_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: dgraph_grpc_port\n        - name: REDIS_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_host\n        - name: REDIS_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_port\n        - name: REDIS_DB\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_db\n        - name: MINIO_ENDPOINT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_endpoint\n        - name: MINIO_ACCESS_KEY_ID\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_access_key_id\n        - name: MINIO_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: minio-secret-access-key-secret\n              key: minio_secret_access_key\n        - name: TORCH_SERVE_GRPC_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: torch_serve_grpc_host\n        - name: TORCH_SERVE_GRPC_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: torch_serve_grpc_port\n        - name: OPEN_CENSUS_AGENT_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: open_census_agent_host\n        - name: OPEN_CENSUS_AGENT_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: open_census_agent_port\n        - name: JAEGER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: jaeger_url\n        - name: JWT_SECRET\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: jwt_secret\n        - name: ELASTIC_APM_SERVICE_NAME\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: elastic_apm_service_name\n        - name: ELASTIC_APM_SERVER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_server_url\n        - name: ELASTIC_APM_ENVIRONMENT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_environment\n        - name: ELASTIC_APM_SECRET_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: hm-elastic-apm\n              key: token\n        - name: ELASTIC_APM_VERIFY_SERVER_CERT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_verify_server_cert\n        - name: ELASTIC_APM_SERVER_CERT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_server_cert\n        - name: ELASTIC_APM_LOG_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_log_level\n        - name: ELASTIC_APM_LOG_FILE\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_log_file\n        ports:\n        - name: graphql-server\n          protocol: TCP\n          containerPort: 31800\n        volumeMounts:\n        - mountPath: /data/elastic-apm\n          name: elastic-apm-volume\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - name: opal-client\n        image: hongbomiao/hm-opal-client:stable\n        env:\n        - name: OPAL_CLIENT_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: hm-opal-client-secret\n              key: opal_client_token\n        - name: OPAL_SERVER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_server_url\n        - name: OPAL_FETCH_PROVIDER_MODULES\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_fetch_provider_modules\n        - name: OPAL_INLINE_OPA_CONFIG\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_inline_opa_config\n        - name: OPAL_INLINE_OPA_LOG_FORMAT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_inline_opa_log_format\n        - name: OPAL_LOG_MODULE_EXCLUDE_LIST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_log_module_exclude_list\n        - name: OPAL_LOG_COLORIZE\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_log_colorize\n        ports:\n        - name: opal-client\n          protocol: TCP\n          containerPort: 7000\n        - name: opa\n          protocol: TCP\n          containerPort: 8181\n        volumeMounts:\n        - mountPath: /data/opa\n          name: opa-volume\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: elastic-apm-volume\n        persistentVolumeClaim:\n          claimName: elastic-apm-pvc\n      - name: opa-volume\n        persistentVolumeClaim:\n          claimName: opa-pvc\n",
    "errors": []
  },
  {
    "id": "02019",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: graphql-server-deployment\n  namespace: hm\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      component: graphql-server\n  template:\n    metadata:\n      labels:\n        component: graphql-server\n    spec:\n      containers:\n      - name: graphql-server\n        image: hongbomiao/hm-graphql-server:stable\n        env:\n        - name: APP_ENV\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: app_env\n        - name: PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: port\n        - name: GRPC_SERVER_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: grpc_server_host\n        - name: GRPC_SERVER_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: grpc_server_port\n        - name: OPA_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opa_host\n        - name: OPA_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opa_port\n        - name: DGRAPH_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: dgraph_host\n        - name: DGRAPH_GRPC_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: dgraph_grpc_port\n        - name: REDIS_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_host\n        - name: REDIS_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_port\n        - name: REDIS_DB\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_db\n        - name: MINIO_ENDPOINT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_endpoint\n        - name: MINIO_ACCESS_KEY_ID\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_access_key_id\n        - name: MINIO_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: minio-secret-access-key-secret\n              key: minio_secret_access_key\n        - name: TORCH_SERVE_GRPC_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: torch_serve_grpc_host\n        - name: TORCH_SERVE_GRPC_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: torch_serve_grpc_port\n        - name: OPEN_CENSUS_AGENT_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: open_census_agent_host\n        - name: OPEN_CENSUS_AGENT_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: open_census_agent_port\n        - name: JAEGER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: jaeger_url\n        - name: JWT_SECRET\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: jwt_secret\n        - name: ELASTIC_APM_SERVICE_NAME\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: elastic_apm_service_name\n        - name: ELASTIC_APM_SERVER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_server_url\n        - name: ELASTIC_APM_ENVIRONMENT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_environment\n        - name: ELASTIC_APM_SECRET_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: hm-elastic-apm\n              key: token\n        - name: ELASTIC_APM_VERIFY_SERVER_CERT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_verify_server_cert\n        - name: ELASTIC_APM_SERVER_CERT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_server_cert\n        - name: ELASTIC_APM_LOG_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_log_level\n        - name: ELASTIC_APM_LOG_FILE\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_log_file\n        ports:\n        - name: graphql-server\n          protocol: TCP\n          containerPort: 31800\n        volumeMounts:\n        - mountPath: /data/elastic-apm\n          name: elastic-apm-volume\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - name: opal-client\n        image: hongbomiao/hm-opal-client:stable\n        env:\n        - name: OPAL_CLIENT_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: hm-opal-client-secret\n              key: opal_client_token\n        - name: OPAL_SERVER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_server_url\n        - name: OPAL_FETCH_PROVIDER_MODULES\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_fetch_provider_modules\n        - name: OPAL_INLINE_OPA_CONFIG\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_inline_opa_config\n        - name: OPAL_INLINE_OPA_LOG_FORMAT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_inline_opa_log_format\n        - name: OPAL_LOG_MODULE_EXCLUDE_LIST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_log_module_exclude_list\n        - name: OPAL_LOG_COLORIZE\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_log_colorize\n        ports:\n        - name: opal-client\n          protocol: TCP\n          containerPort: 7000\n        - name: opa\n          protocol: TCP\n          containerPort: 8181\n        volumeMounts:\n        - mountPath: /data/opa\n          name: opa-volume\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: elastic-apm-volume\n        persistentVolumeClaim:\n          claimName: elastic-apm-pvc\n      - name: opa-volume\n        persistentVolumeClaim:\n          claimName: opa-pvc\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "02020",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: graphql-server-deployment\n  namespace: hm\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      component: graphql-server\n  template:\n    metadata:\n      labels:\n        component: graphql-server\n    spec:\n      containers:\n      - name: graphql-server\n        image: hongbomiao/hm-graphql-server:stable\n        env:\n        - name: APP_ENV\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: app_env\n        - name: PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: port\n        - name: GRPC_SERVER_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: grpc_server_host\n        - name: GRPC_SERVER_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: grpc_server_port\n        - name: OPA_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opa_host\n        - name: OPA_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opa_port\n        - name: DGRAPH_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: dgraph_host\n        - name: DGRAPH_GRPC_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: dgraph_grpc_port\n        - name: REDIS_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_host\n        - name: REDIS_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_port\n        - name: REDIS_DB\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_db\n        - name: MINIO_ENDPOINT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_endpoint\n        - name: MINIO_ACCESS_KEY_ID\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_access_key_id\n        - name: MINIO_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: minio-secret-access-key-secret\n              key: minio_secret_access_key\n        - name: TORCH_SERVE_GRPC_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: torch_serve_grpc_host\n        - name: TORCH_SERVE_GRPC_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: torch_serve_grpc_port\n        - name: OPEN_CENSUS_AGENT_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: open_census_agent_host\n        - name: OPEN_CENSUS_AGENT_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: open_census_agent_port\n        - name: JAEGER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: jaeger_url\n        - name: JWT_SECRET\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: jwt_secret\n        - name: ELASTIC_APM_SERVICE_NAME\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: elastic_apm_service_name\n        - name: ELASTIC_APM_SERVER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_server_url\n        - name: ELASTIC_APM_ENVIRONMENT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_environment\n        - name: ELASTIC_APM_SECRET_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: hm-elastic-apm\n              key: token\n        - name: ELASTIC_APM_VERIFY_SERVER_CERT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_verify_server_cert\n        - name: ELASTIC_APM_SERVER_CERT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_server_cert\n        - name: ELASTIC_APM_LOG_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_log_level\n        - name: ELASTIC_APM_LOG_FILE\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_log_file\n        ports:\n        - name: graphql-server\n          protocol: TCP\n          containerPort: 31800\n        volumeMounts:\n        - mountPath: /data/elastic-apm\n          name: elastic-apm-volume\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - name: opal-client\n        image: hongbomiao/hm-opal-client:stable\n        env:\n        - name: OPAL_CLIENT_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: hm-opal-client-secret\n              key: opal_client_token\n        - name: OPAL_SERVER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_server_url\n        - name: OPAL_FETCH_PROVIDER_MODULES\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_fetch_provider_modules\n        - name: OPAL_INLINE_OPA_CONFIG\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_inline_opa_config\n        - name: OPAL_INLINE_OPA_LOG_FORMAT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_inline_opa_log_format\n        - name: OPAL_LOG_MODULE_EXCLUDE_LIST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_log_module_exclude_list\n        - name: OPAL_LOG_COLORIZE\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_log_colorize\n        ports:\n        - name: opal-client\n          protocol: TCP\n          containerPort: 7000\n        - name: opa\n          protocol: TCP\n          containerPort: 8181\n        volumeMounts:\n        - mountPath: /data/opa\n          name: opa-volume\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: elastic-apm-volume\n        persistentVolumeClaim:\n          claimName: elastic-apm-pvc\n      - name: opa-volume\n        persistentVolumeClaim:\n          claimName: opa-pvc\n",
    "errors": []
  },
  {
    "id": "02021",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: graphql-server-deployment\n  namespace: hm\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      component: graphql-server\n  template:\n    metadata:\n      labels:\n        component: graphql-server\n    spec:\n      containers:\n      - name: graphql-server\n        image: hongbomiao/hm-graphql-server:stable\n        env:\n        - name: APP_ENV\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: app_env\n        - name: PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: port\n        - name: GRPC_SERVER_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: grpc_server_host\n        - name: GRPC_SERVER_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: grpc_server_port\n        - name: OPA_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opa_host\n        - name: OPA_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opa_port\n        - name: DGRAPH_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: dgraph_host\n        - name: DGRAPH_GRPC_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: dgraph_grpc_port\n        - name: REDIS_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_host\n        - name: REDIS_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_port\n        - name: REDIS_DB\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_db\n        - name: MINIO_ENDPOINT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_endpoint\n        - name: MINIO_ACCESS_KEY_ID\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_access_key_id\n        - name: MINIO_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: minio-secret-access-key-secret\n              key: minio_secret_access_key\n        - name: TORCH_SERVE_GRPC_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: torch_serve_grpc_host\n        - name: TORCH_SERVE_GRPC_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: torch_serve_grpc_port\n        - name: OPEN_CENSUS_AGENT_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: open_census_agent_host\n        - name: OPEN_CENSUS_AGENT_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: open_census_agent_port\n        - name: JAEGER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: jaeger_url\n        - name: JWT_SECRET\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: jwt_secret\n        - name: ELASTIC_APM_SERVICE_NAME\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: elastic_apm_service_name\n        - name: ELASTIC_APM_SERVER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_server_url\n        - name: ELASTIC_APM_ENVIRONMENT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_environment\n        - name: ELASTIC_APM_SECRET_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: hm-elastic-apm\n              key: token\n        - name: ELASTIC_APM_VERIFY_SERVER_CERT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_verify_server_cert\n        - name: ELASTIC_APM_SERVER_CERT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_server_cert\n        - name: ELASTIC_APM_LOG_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_log_level\n        - name: ELASTIC_APM_LOG_FILE\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_log_file\n        ports:\n        - name: graphql-server\n          protocol: TCP\n          containerPort: 31800\n        volumeMounts:\n        - mountPath: /data/elastic-apm\n          name: elastic-apm-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - name: opal-client\n        image: hongbomiao/hm-opal-client:stable\n        env:\n        - name: OPAL_CLIENT_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: hm-opal-client-secret\n              key: opal_client_token\n        - name: OPAL_SERVER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_server_url\n        - name: OPAL_FETCH_PROVIDER_MODULES\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_fetch_provider_modules\n        - name: OPAL_INLINE_OPA_CONFIG\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_inline_opa_config\n        - name: OPAL_INLINE_OPA_LOG_FORMAT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_inline_opa_log_format\n        - name: OPAL_LOG_MODULE_EXCLUDE_LIST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_log_module_exclude_list\n        - name: OPAL_LOG_COLORIZE\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_log_colorize\n        ports:\n        - name: opal-client\n          protocol: TCP\n          containerPort: 7000\n        - name: opa\n          protocol: TCP\n          containerPort: 8181\n        volumeMounts:\n        - mountPath: /data/opa\n          name: opa-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: elastic-apm-volume\n        persistentVolumeClaim:\n          claimName: elastic-apm-pvc\n      - name: opa-volume\n        persistentVolumeClaim:\n          claimName: opa-pvc\n",
    "errors": []
  },
  {
    "id": "02022",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: graphql-server-deployment\n  namespace: hm\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      component: graphql-server\n  template:\n    metadata:\n      labels:\n        component: graphql-server\n    spec:\n      containers:\n      - name: graphql-server\n        image: hongbomiao/hm-graphql-server:stable\n        env:\n        - name: APP_ENV\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: app_env\n        - name: PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: port\n        - name: GRPC_SERVER_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: grpc_server_host\n        - name: GRPC_SERVER_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: grpc_server_port\n        - name: OPA_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opa_host\n        - name: OPA_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opa_port\n        - name: DGRAPH_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: dgraph_host\n        - name: DGRAPH_GRPC_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: dgraph_grpc_port\n        - name: REDIS_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_host\n        - name: REDIS_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_port\n        - name: REDIS_DB\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_db\n        - name: MINIO_ENDPOINT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_endpoint\n        - name: MINIO_ACCESS_KEY_ID\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_access_key_id\n        - name: MINIO_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: minio-secret-access-key-secret\n              key: minio_secret_access_key\n        - name: TORCH_SERVE_GRPC_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: torch_serve_grpc_host\n        - name: TORCH_SERVE_GRPC_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: torch_serve_grpc_port\n        - name: OPEN_CENSUS_AGENT_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: open_census_agent_host\n        - name: OPEN_CENSUS_AGENT_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: open_census_agent_port\n        - name: JAEGER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: jaeger_url\n        - name: JWT_SECRET\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: jwt_secret\n        - name: ELASTIC_APM_SERVICE_NAME\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: elastic_apm_service_name\n        - name: ELASTIC_APM_SERVER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_server_url\n        - name: ELASTIC_APM_ENVIRONMENT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_environment\n        - name: ELASTIC_APM_SECRET_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: hm-elastic-apm\n              key: token\n        - name: ELASTIC_APM_VERIFY_SERVER_CERT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_verify_server_cert\n        - name: ELASTIC_APM_SERVER_CERT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_server_cert\n        - name: ELASTIC_APM_LOG_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_log_level\n        - name: ELASTIC_APM_LOG_FILE\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_log_file\n        ports:\n        - name: graphql-server\n          protocol: TCP\n          containerPort: 31800\n        volumeMounts:\n        - mountPath: /data/elastic-apm\n          name: elastic-apm-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - name: opal-client\n        image: hongbomiao/hm-opal-client:stable\n        env:\n        - name: OPAL_CLIENT_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: hm-opal-client-secret\n              key: opal_client_token\n        - name: OPAL_SERVER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_server_url\n        - name: OPAL_FETCH_PROVIDER_MODULES\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_fetch_provider_modules\n        - name: OPAL_INLINE_OPA_CONFIG\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_inline_opa_config\n        - name: OPAL_INLINE_OPA_LOG_FORMAT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_inline_opa_log_format\n        - name: OPAL_LOG_MODULE_EXCLUDE_LIST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_log_module_exclude_list\n        - name: OPAL_LOG_COLORIZE\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_log_colorize\n        ports:\n        - name: opal-client\n          protocol: TCP\n          containerPort: 7000\n        - name: opa\n          protocol: TCP\n          containerPort: 8181\n        volumeMounts:\n        - mountPath: /data/opa\n          name: opa-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: elastic-apm-volume\n        persistentVolumeClaim:\n          claimName: elastic-apm-pvc\n      - name: opa-volume\n        persistentVolumeClaim:\n          claimName: opa-pvc\n",
    "errors": []
  },
  {
    "id": "02023",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: graphql-server-deployment\n  namespace: hm\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      component: graphql-server\n  template:\n    metadata:\n      labels:\n        component: graphql-server\n    spec:\n      containers:\n      - name: graphql-server\n        image: hongbomiao/hm-graphql-server:stable\n        env:\n        - name: APP_ENV\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: app_env\n        - name: PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: port\n        - name: GRPC_SERVER_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: grpc_server_host\n        - name: GRPC_SERVER_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: grpc_server_port\n        - name: OPA_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opa_host\n        - name: OPA_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opa_port\n        - name: DGRAPH_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: dgraph_host\n        - name: DGRAPH_GRPC_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: dgraph_grpc_port\n        - name: REDIS_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_host\n        - name: REDIS_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_port\n        - name: REDIS_DB\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_db\n        - name: MINIO_ENDPOINT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_endpoint\n        - name: MINIO_ACCESS_KEY_ID\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_access_key_id\n        - name: MINIO_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: minio-secret-access-key-secret\n              key: minio_secret_access_key\n        - name: TORCH_SERVE_GRPC_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: torch_serve_grpc_host\n        - name: TORCH_SERVE_GRPC_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: torch_serve_grpc_port\n        - name: OPEN_CENSUS_AGENT_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: open_census_agent_host\n        - name: OPEN_CENSUS_AGENT_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: open_census_agent_port\n        - name: JAEGER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: jaeger_url\n        - name: JWT_SECRET\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: jwt_secret\n        - name: ELASTIC_APM_SERVICE_NAME\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: elastic_apm_service_name\n        - name: ELASTIC_APM_SERVER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_server_url\n        - name: ELASTIC_APM_ENVIRONMENT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_environment\n        - name: ELASTIC_APM_SECRET_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: hm-elastic-apm\n              key: token\n        - name: ELASTIC_APM_VERIFY_SERVER_CERT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_verify_server_cert\n        - name: ELASTIC_APM_SERVER_CERT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_server_cert\n        - name: ELASTIC_APM_LOG_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_log_level\n        - name: ELASTIC_APM_LOG_FILE\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_log_file\n        ports:\n        - name: graphql-server\n          protocol: TCP\n          containerPort: 31800\n        volumeMounts:\n        - mountPath: /data/elastic-apm\n          name: elastic-apm-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - name: opal-client\n        image: hongbomiao/hm-opal-client:stable\n        env:\n        - name: OPAL_CLIENT_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: hm-opal-client-secret\n              key: opal_client_token\n        - name: OPAL_SERVER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_server_url\n        - name: OPAL_FETCH_PROVIDER_MODULES\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_fetch_provider_modules\n        - name: OPAL_INLINE_OPA_CONFIG\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_inline_opa_config\n        - name: OPAL_INLINE_OPA_LOG_FORMAT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_inline_opa_log_format\n        - name: OPAL_LOG_MODULE_EXCLUDE_LIST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_log_module_exclude_list\n        - name: OPAL_LOG_COLORIZE\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_log_colorize\n        ports:\n        - name: opal-client\n          protocol: TCP\n          containerPort: 7000\n        - name: opa\n          protocol: TCP\n          containerPort: 8181\n        volumeMounts:\n        - mountPath: /data/opa\n          name: opa-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: elastic-apm-volume\n        persistentVolumeClaim:\n          claimName: elastic-apm-pvc\n      - name: opa-volume\n        persistentVolumeClaim:\n          claimName: opa-pvc\n",
    "errors": []
  },
  {
    "id": "02024",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: graphql-server-deployment\n  namespace: hm\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      component: graphql-server\n  template:\n    metadata:\n      labels:\n        component: graphql-server\n    spec:\n      containers:\n      - name: graphql-server\n        image: hongbomiao/hm-graphql-server:stable\n        env:\n        - name: APP_ENV\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: app_env\n        - name: PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: port\n        - name: GRPC_SERVER_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: grpc_server_host\n        - name: GRPC_SERVER_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: grpc_server_port\n        - name: OPA_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opa_host\n        - name: OPA_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opa_port\n        - name: DGRAPH_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: dgraph_host\n        - name: DGRAPH_GRPC_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: dgraph_grpc_port\n        - name: REDIS_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_host\n        - name: REDIS_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_port\n        - name: REDIS_DB\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_db\n        - name: MINIO_ENDPOINT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_endpoint\n        - name: MINIO_ACCESS_KEY_ID\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_access_key_id\n        - name: MINIO_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: minio-secret-access-key-secret\n              key: minio_secret_access_key\n        - name: TORCH_SERVE_GRPC_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: torch_serve_grpc_host\n        - name: TORCH_SERVE_GRPC_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: torch_serve_grpc_port\n        - name: OPEN_CENSUS_AGENT_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: open_census_agent_host\n        - name: OPEN_CENSUS_AGENT_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: open_census_agent_port\n        - name: JAEGER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: jaeger_url\n        - name: JWT_SECRET\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: jwt_secret\n        - name: ELASTIC_APM_SERVICE_NAME\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: elastic_apm_service_name\n        - name: ELASTIC_APM_SERVER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_server_url\n        - name: ELASTIC_APM_ENVIRONMENT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_environment\n        - name: ELASTIC_APM_SECRET_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: hm-elastic-apm\n              key: token\n        - name: ELASTIC_APM_VERIFY_SERVER_CERT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_verify_server_cert\n        - name: ELASTIC_APM_SERVER_CERT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_server_cert\n        - name: ELASTIC_APM_LOG_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_log_level\n        - name: ELASTIC_APM_LOG_FILE\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_log_file\n        ports:\n        - name: graphql-server\n          protocol: TCP\n          containerPort: 31800\n        volumeMounts:\n        - mountPath: /data/elastic-apm\n          name: elastic-apm-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - name: opal-client\n        image: hongbomiao/hm-opal-client:stable\n        env:\n        - name: OPAL_CLIENT_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: hm-opal-client-secret\n              key: opal_client_token\n        - name: OPAL_SERVER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_server_url\n        - name: OPAL_FETCH_PROVIDER_MODULES\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_fetch_provider_modules\n        - name: OPAL_INLINE_OPA_CONFIG\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_inline_opa_config\n        - name: OPAL_INLINE_OPA_LOG_FORMAT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_inline_opa_log_format\n        - name: OPAL_LOG_MODULE_EXCLUDE_LIST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_log_module_exclude_list\n        - name: OPAL_LOG_COLORIZE\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_log_colorize\n        ports:\n        - name: opal-client\n          protocol: TCP\n          containerPort: 7000\n        - name: opa\n          protocol: TCP\n          containerPort: 8181\n        volumeMounts:\n        - mountPath: /data/opa\n          name: opa-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: elastic-apm-volume\n        persistentVolumeClaim:\n          claimName: elastic-apm-pvc\n      - name: opa-volume\n        persistentVolumeClaim:\n          claimName: opa-pvc\n",
    "errors": []
  },
  {
    "id": "02025",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: catalogue-db\n  labels:\n    name: catalogue-db\nspec:\n  containers:\n  - name: catalogue-db\n    image: weaveworksdemos/catalogue-db:0.2.0\n    env:\n    - name: MYSQL_ROOT_PASSWORD\n      valueFrom:\n        secretKeyRef:\n          name: mysql-root-password-secret\n          key: mysql_root_password\n    - name: MYSQL_DATABASE\n      value: socksdb\n    ports:\n    - name: mysql\n      containerPort: 3306\n    volumeMounts:\n    - name: mysql-data\n      mountPath: /var/lib/mysql\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      readOnlyRootFilesystem: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n  volumes:\n  - name: mysql-data\n    emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "02026",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: catalogue-db\n  labels:\n    name: catalogue-db\nspec:\n  containers:\n  - name: catalogue-db\n    image: weaveworksdemos/catalogue-db:0.2.0\n    env:\n    - name: MYSQL_ROOT_PASSWORD\n      valueFrom:\n        secretKeyRef:\n          name: mysql-root-password-secret\n          key: mysql_root_password\n    - name: MYSQL_DATABASE\n      value: socksdb\n    ports:\n    - name: mysql\n      containerPort: 3306\n    securityContext:\n      runAsNonRoot: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      readOnlyRootFilesystem: true\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "02027",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: catalogue-db\n  labels:\n    name: catalogue-db\nspec:\n  containers:\n  - name: catalogue-db\n    image: weaveworksdemos/catalogue-db:0.2.0\n    env:\n    - name: MYSQL_ROOT_PASSWORD\n      valueFrom:\n        secretKeyRef:\n          name: mysql-root-password-secret\n          key: mysql_root_password\n    - name: MYSQL_DATABASE\n      value: socksdb\n    ports:\n    - name: mysql\n      containerPort: 3306\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n      readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "02028",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: catalogue-db\n  labels:\n    name: catalogue-db\nspec:\n  containers:\n  - name: catalogue-db\n    image: weaveworksdemos/catalogue-db:0.2.0\n    env:\n    - name: MYSQL_ROOT_PASSWORD\n      valueFrom:\n        secretKeyRef:\n          name: mysql-root-password-secret\n          key: mysql_root_password\n    - name: MYSQL_DATABASE\n      value: socksdb\n    ports:\n    - name: mysql\n      containerPort: 3306\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n      readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "02029",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: quotesweb\n  labels:\n    app: quotesweb\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: quotesweb\n  template:\n    metadata:\n      labels:\n        app: quotesweb\n    spec:\n      containers:\n      - name: quotes\n        image: quay.io/donschenck/quotesweb:v1\n        imagePullPolicy: Always\n        ports:\n        - containerPort: 3000\n          protocol: TCP\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "02030",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: quotesweb\n  labels:\n    app: quotesweb\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: quotesweb\n  template:\n    metadata:\n      labels:\n        app: quotesweb\n    spec:\n      containers:\n      - name: quotes\n        image: quay.io/donschenck/quotesweb:v1\n        imagePullPolicy: Always\n        ports:\n        - containerPort: 3000\n          protocol: TCP\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "02031",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: quotesweb\n  labels:\n    app: quotesweb\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: quotesweb\n  template:\n    metadata:\n      labels:\n        app: quotesweb\n    spec:\n      containers:\n      - name: quotes\n        image: quay.io/donschenck/quotesweb:v1\n        imagePullPolicy: Always\n        ports:\n        - containerPort: 3000\n          protocol: TCP\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "02032",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: quotesweb\n  labels:\n    app: quotesweb\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: quotesweb\n  template:\n    metadata:\n      labels:\n        app: quotesweb\n    spec:\n      containers:\n      - name: quotes\n        image: quay.io/donschenck/quotesweb:v1\n        imagePullPolicy: Always\n        ports:\n        - containerPort: 3000\n          protocol: TCP\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "02033",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: demo-php\n  labels:\n    app: demo\nspec:\n  selector:\n    matchLabels:\n      app: demo\n  replicas: 3\n  template:\n    metadata:\n      labels:\n        app: demo\n    spec:\n      containers:\n      - name: demo-php\n        image: demo-php:stable\n        imagePullPolicy: Never\n        resources:\n          requests:\n            cpu: 100m\n            memory: 100Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        ports:\n        - containerPort: 9000\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - name: demo-nginx\n        image: demo-nginx:stable\n        imagePullPolicy: Never\n        ports:\n        - containerPort: 80\n        resources:\n          limits:\n            cpu: 150m\n            memory: 256Mi\n          requests:\n            cpu: 50m\n            memory: 128Mi\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "02034",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: demo-php\n  labels:\n    app: demo\nspec:\n  selector:\n    matchLabels:\n      app: demo\n  replicas: 3\n  template:\n    metadata:\n      labels:\n        app: demo\n    spec:\n      containers:\n      - name: demo-php\n        image: demo-php:stable\n        imagePullPolicy: Never\n        resources:\n          requests:\n            cpu: 100m\n            memory: 100Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        ports:\n        - containerPort: 9000\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - name: demo-nginx\n        image: demo-nginx:stable\n        imagePullPolicy: Never\n        ports:\n        - containerPort: 80\n        resources:\n          limits:\n            cpu: 150m\n            memory: 256Mi\n          requests:\n            cpu: 50m\n            memory: 128Mi\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "02035",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: demo-php\n  labels:\n    app: demo\nspec:\n  selector:\n    matchLabels:\n      app: demo\n  replicas: 3\n  template:\n    metadata:\n      labels:\n        app: demo\n    spec:\n      containers:\n      - name: demo-php\n        image: demo-php:stable\n        imagePullPolicy: Never\n        resources:\n          requests:\n            cpu: 100m\n            memory: 100Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        ports:\n        - containerPort: 9000\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n      - name: demo-nginx\n        image: demo-nginx:stable\n        imagePullPolicy: Never\n        ports:\n        - containerPort: 80\n        resources:\n          limits:\n            cpu: 150m\n            memory: 256Mi\n          requests:\n            cpu: 50m\n            memory: 128Mi\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "02036",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: demo-php\n  labels:\n    app: demo\nspec:\n  selector:\n    matchLabels:\n      app: demo\n  replicas: 3\n  template:\n    metadata:\n      labels:\n        app: demo\n    spec:\n      containers:\n      - name: demo-php\n        image: demo-php:stable\n        imagePullPolicy: Never\n        resources:\n          requests:\n            cpu: 100m\n            memory: 100Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        ports:\n        - containerPort: 9000\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n      - name: demo-nginx\n        image: demo-nginx:stable\n        imagePullPolicy: Never\n        ports:\n        - containerPort: 80\n        resources:\n          limits:\n            cpu: 150m\n            memory: 256Mi\n          requests:\n            cpu: 50m\n            memory: 128Mi\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "02037",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: demo-php\n  labels:\n    app: demo\nspec:\n  selector:\n    matchLabels:\n      app: demo\n  replicas: 3\n  template:\n    metadata:\n      labels:\n        app: demo\n    spec:\n      containers:\n      - name: demo-php\n        image: demo-php:stable\n        imagePullPolicy: Never\n        resources:\n          requests:\n            cpu: 100m\n            memory: 100Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        ports:\n        - containerPort: 9000\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n      - name: demo-nginx\n        image: demo-nginx:stable\n        imagePullPolicy: Never\n        ports:\n        - containerPort: 80\n        resources:\n          limits:\n            cpu: 150m\n            memory: 256Mi\n          requests:\n            cpu: 50m\n            memory: 128Mi\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "02038",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: demo-php\n  labels:\n    app: demo\nspec:\n  selector:\n    matchLabels:\n      app: demo\n  replicas: 3\n  template:\n    metadata:\n      labels:\n        app: demo\n    spec:\n      containers:\n      - name: demo-php\n        image: demo-php:stable\n        imagePullPolicy: Never\n        resources:\n          requests:\n            cpu: 100m\n            memory: 100Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        ports:\n        - containerPort: 9000\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n      - name: demo-nginx\n        image: demo-nginx:stable\n        imagePullPolicy: Never\n        ports:\n        - containerPort: 80\n        resources:\n          limits:\n            cpu: 150m\n            memory: 256Mi\n          requests:\n            cpu: 50m\n            memory: 128Mi\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "02039",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: demo-php\n  labels:\n    app: demo\nspec:\n  selector:\n    matchLabels:\n      app: demo\n  replicas: 3\n  template:\n    metadata:\n      labels:\n        app: demo\n    spec:\n      containers:\n      - name: demo-php\n        image: demo-php:stable\n        imagePullPolicy: Never\n        resources:\n          requests:\n            cpu: 100m\n            memory: 100Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        ports:\n        - containerPort: 9000\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - name: demo-nginx\n        image: demo-nginx:stable\n        imagePullPolicy: Never\n        ports:\n        - containerPort: 80\n        resources:\n          limits:\n            cpu: 150m\n            memory: 256Mi\n          requests:\n            cpu: 50m\n            memory: 128Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "02040",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: demo-php\n  labels:\n    app: demo\nspec:\n  selector:\n    matchLabels:\n      app: demo\n  replicas: 3\n  template:\n    metadata:\n      labels:\n        app: demo\n    spec:\n      containers:\n      - name: demo-php\n        image: demo-php:stable\n        imagePullPolicy: Never\n        resources:\n          requests:\n            cpu: 100m\n            memory: 100Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        ports:\n        - containerPort: 9000\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - name: demo-nginx\n        image: demo-nginx:stable\n        imagePullPolicy: Never\n        ports:\n        - containerPort: 80\n        resources:\n          limits:\n            cpu: 150m\n            memory: 256Mi\n          requests:\n            cpu: 50m\n            memory: 128Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  }
]