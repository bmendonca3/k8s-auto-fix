[
  {
    "id": "04601",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-4805\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    securityContext:\n      readOnlyRootFilesystem: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "04602",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-4805\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    securityContext:\n      runAsNonRoot: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      readOnlyRootFilesystem: true\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "04603",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-4805\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n      readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "04604",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-4805\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n      readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "04605",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: example\n  name: nginx-deployment\n  labels:\n    app: nginx\nspec:\n  replicas: 5\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - name: nginx\n        image: nginx:1.14.2\n        ports:\n        - containerPort: 80\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "04606",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: example\n  name: nginx-deployment\n  labels:\n    app: nginx\nspec:\n  replicas: 5\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - name: nginx\n        image: nginx:1.14.2\n        ports:\n        - containerPort: 80\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "04607",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: example\n  name: nginx-deployment\n  labels:\n    app: nginx\nspec:\n  replicas: 5\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - name: nginx\n        image: nginx:1.14.2\n        ports:\n        - containerPort: 80\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "04608",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: example\n  name: nginx-deployment\n  labels:\n    app: nginx\nspec:\n  replicas: 5\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - name: nginx\n        image: nginx:1.14.2\n        ports:\n        - containerPort: 80\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "04609",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: transmission\n  labels:\n    app.kubernetes.io/name: transmission\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: transmission\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/name: transmission\n    spec:\n      containers:\n      - name: transmission\n        image: ghcr.io/k8s-at-home/transmission:v3.00\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            cpu: 50m\n            memory: 50Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        ports:\n        - name: gui-port\n          protocol: TCP\n          containerPort: 9091\n        - name: tcp-port\n          protocol: TCP\n          containerPort: 51413\n        - name: udp-port\n          protocol: UDP\n          containerPort: 51413\n        volumeMounts:\n        - name: transmission-configs\n          mountPath: /config/settings.json\n          subPath: settings.json\n        - name: transmission-config\n          mountPath: /config\n        - name: transmission-downloads\n          mountPath: /downloads\n        livenessProbe:\n          tcpSocket:\n            port: tcp-port\n          initialDelaySeconds: 30\n          timeoutSeconds: 5\n          periodSeconds: 5\n          successThreshold: 1\n          failureThreshold: 5\n        readinessProbe:\n          tcpSocket:\n            port: tcp-port\n          initialDelaySeconds: 30\n          timeoutSeconds: 5\n          periodSeconds: 5\n          successThreshold: 1\n          failureThreshold: 5\n        env:\n        - name: TZ\n          value: ${CONFIG_TIMEZONE}\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n      securityContext:\n        runAsUser: 1000\n        runAsGroup: 1000\n        fsGroup: 1000\n        fsGroupChangePolicy: OnRootMismatch\n      volumes:\n      - name: transmission-configs\n        configMap:\n          name: transmission-configs\n      - name: transmission-config\n        persistentVolumeClaim:\n          claimName: transmission-config\n      - name: transmission-downloads\n        persistentVolumeClaim:\n          claimName: shared-downloads\n",
    "errors": []
  },
  {
    "id": "04610",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: transmission\n  labels:\n    app.kubernetes.io/name: transmission\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: transmission\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/name: transmission\n    spec:\n      containers:\n      - name: transmission\n        image: ghcr.io/k8s-at-home/transmission:v3.00\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            cpu: 50m\n            memory: 50Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        ports:\n        - name: gui-port\n          protocol: TCP\n          containerPort: 9091\n        - name: tcp-port\n          protocol: TCP\n          containerPort: 51413\n        - name: udp-port\n          protocol: UDP\n          containerPort: 51413\n        volumeMounts:\n        - name: transmission-configs\n          mountPath: /config/settings.json\n          subPath: settings.json\n        - name: transmission-config\n          mountPath: /config\n        - name: transmission-downloads\n          mountPath: /downloads\n        livenessProbe:\n          tcpSocket:\n            port: tcp-port\n          initialDelaySeconds: 30\n          timeoutSeconds: 5\n          periodSeconds: 5\n          successThreshold: 1\n          failureThreshold: 5\n        readinessProbe:\n          tcpSocket:\n            port: tcp-port\n          initialDelaySeconds: 30\n          timeoutSeconds: 5\n          periodSeconds: 5\n          successThreshold: 1\n          failureThreshold: 5\n        env:\n        - name: TZ\n          value: ${CONFIG_TIMEZONE}\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      securityContext:\n        runAsUser: 1000\n        runAsGroup: 1000\n        fsGroup: 1000\n        fsGroupChangePolicy: OnRootMismatch\n      volumes:\n      - name: transmission-configs\n        configMap:\n          name: transmission-configs\n      - name: transmission-config\n        persistentVolumeClaim:\n          claimName: transmission-config\n      - name: transmission-downloads\n        persistentVolumeClaim:\n          claimName: shared-downloads\n",
    "errors": []
  },
  {
    "id": "04611",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: kube-dns-metrics-bash\n  namespace: kube-system\n  labels:\n    application: kube-dns-metrics-bash\n    version: v0.0.4\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      application: kube-dns-metrics-bash\n  template:\n    metadata:\n      labels:\n        application: kube-dns-metrics-bash\n        version: v0.0.4\n    spec:\n      containers:\n      - image: pierone.stups.zalan.do/teapot/kube-dns-metrics-bash:v0.0.5\n        name: kube-dns-metrics-bash\n        resources:\n          limits:\n            memory: 100Mi\n            cpu: 500m\n          requests:\n            cpu: 25m\n            memory: 100Mi\n        readinessProbe:\n          httpGet:\n            path: /healthz\n            port: 8080\n            scheme: HTTP\n          initialDelaySeconds: 10\n          timeoutSeconds: 3\n        ports:\n        - containerPort: 8080\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "04612",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: kube-dns-metrics-bash\n  namespace: kube-system\n  labels:\n    application: kube-dns-metrics-bash\n    version: v0.0.4\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      application: kube-dns-metrics-bash\n  template:\n    metadata:\n      labels:\n        application: kube-dns-metrics-bash\n        version: v0.0.4\n    spec:\n      containers:\n      - image: pierone.stups.zalan.do/teapot/kube-dns-metrics-bash:v0.0.5\n        name: kube-dns-metrics-bash\n        resources:\n          limits:\n            memory: 100Mi\n            cpu: 500m\n          requests:\n            cpu: 25m\n            memory: 100Mi\n        readinessProbe:\n          httpGet:\n            path: /healthz\n            port: 8080\n            scheme: HTTP\n          initialDelaySeconds: 10\n          timeoutSeconds: 3\n        ports:\n        - containerPort: 8080\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "04613",
    "policy_id": "no_latest_tag",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed: The StatefulSet \"redis-master\" is invalid: spec.template.spec.containers[0].volumeMounts[0].name: Not found: \"redis-master-volume\""
    ]
  },
  {
    "id": "04614",
    "policy_id": "read_only_root_fs",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed: The StatefulSet \"redis-master\" is invalid: spec.template.spec.containers[0].volumeMounts[0].name: Not found: \"redis-master-volume\""
    ]
  },
  {
    "id": "04615",
    "policy_id": "run_as_non_root",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed: The StatefulSet \"redis-master\" is invalid: spec.template.spec.containers[0].volumeMounts[0].name: Not found: \"redis-master-volume\""
    ]
  },
  {
    "id": "04616",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    run: kuard\n  name: kuard\nspec:\n  replicas: 10\n  selector:\n    matchLabels:\n      run: kuard\n  template:\n    metadata:\n      labels:\n        run: kuard\n    spec:\n      containers:\n      - image: gcr.io/kuar-demo/kuard-amd64:blue\n        name: kuard\n        resources:\n          limits:\n            cpu: 50m\n            memory: 0.1G\n          requests:\n            cpu: 50m\n            memory: 0.1G\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "04617",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    run: kuard\n  name: kuard\nspec:\n  replicas: 10\n  selector:\n    matchLabels:\n      run: kuard\n  template:\n    metadata:\n      labels:\n        run: kuard\n    spec:\n      containers:\n      - image: gcr.io/kuar-demo/kuard-amd64:blue\n        name: kuard\n        resources:\n          limits:\n            cpu: 50m\n            memory: 0.1G\n          requests:\n            cpu: 50m\n            memory: 0.1G\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "04618",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    kustomize.component: iap-ingress\n  name: iap-enabler\n  namespace: kubeflow\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      kustomize.component: iap-ingress\n  template:\n    metadata:\n      labels:\n        kustomize.component: iap-ingress\n        service: iap-enabler\n    spec:\n      containers:\n      - command:\n        - bash\n        - /var/envoy-config/setup_backend.sh\n        env:\n        - name: GOOGLE_APPLICATION_CREDENTIALS\n          value: /var/run/secrets/sa/admin-gcp-sa.json\n        - name: NAMESPACE\n          value: istio-system\n        - name: SERVICE\n          value: istio-ingressgateway\n        - name: INGRESS_NAME\n          value: envoy-ingress\n        - name: ENVOY_ADMIN\n          value: http://localhost:8001\n        - name: USE_ISTIO\n          value: 'true'\n        image: gcr.io/kubeflow-images-public/ingress-setup:stable\n        name: iap\n        volumeMounts:\n        - mountPath: /var/run/secrets/sa\n          name: sa-key\n          readOnly: true\n        - mountPath: /var/envoy-config/\n          name: config-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      serviceAccountName: kf-admin\n      volumes:\n      - name: sa-key\n        secret:\n          secretName: admin-gcp-sa\n      - configMap:\n          name: envoy-config\n        name: config-volume\n",
    "errors": []
  },
  {
    "id": "04619",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    kustomize.component: iap-ingress\n  name: iap-enabler\n  namespace: kubeflow\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      kustomize.component: iap-ingress\n  template:\n    metadata:\n      labels:\n        kustomize.component: iap-ingress\n        service: iap-enabler\n    spec:\n      containers:\n      - command:\n        - bash\n        - /var/envoy-config/setup_backend.sh\n        env:\n        - name: GOOGLE_APPLICATION_CREDENTIALS\n          value: /var/run/secrets/sa/admin-gcp-sa.json\n        - name: NAMESPACE\n          value: istio-system\n        - name: SERVICE\n          value: istio-ingressgateway\n        - name: INGRESS_NAME\n          value: envoy-ingress\n        - name: ENVOY_ADMIN\n          value: http://localhost:8001\n        - name: USE_ISTIO\n          value: 'true'\n        image: gcr.io/kubeflow-images-public/ingress-setup:stable\n        name: iap\n        volumeMounts:\n        - mountPath: /var/run/secrets/sa\n          name: sa-key\n          readOnly: true\n        - mountPath: /var/envoy-config/\n          name: config-volume\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      serviceAccountName: kf-admin\n      volumes:\n      - name: sa-key\n        secret:\n          secretName: admin-gcp-sa\n      - configMap:\n          name: envoy-config\n        name: config-volume\n",
    "errors": []
  },
  {
    "id": "04620",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    kustomize.component: iap-ingress\n  name: iap-enabler\n  namespace: kubeflow\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      kustomize.component: iap-ingress\n  template:\n    metadata:\n      labels:\n        kustomize.component: iap-ingress\n        service: iap-enabler\n    spec:\n      containers:\n      - command:\n        - bash\n        - /var/envoy-config/setup_backend.sh\n        env:\n        - name: GOOGLE_APPLICATION_CREDENTIALS\n          value: /var/run/secrets/sa/admin-gcp-sa.json\n        - name: NAMESPACE\n          value: istio-system\n        - name: SERVICE\n          value: istio-ingressgateway\n        - name: INGRESS_NAME\n          value: envoy-ingress\n        - name: ENVOY_ADMIN\n          value: http://localhost:8001\n        - name: USE_ISTIO\n          value: 'true'\n        image: gcr.io/kubeflow-images-public/ingress-setup:stable\n        name: iap\n        volumeMounts:\n        - mountPath: /var/run/secrets/sa\n          name: sa-key\n          readOnly: true\n        - mountPath: /var/envoy-config/\n          name: config-volume\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      serviceAccountName: kf-admin\n      volumes:\n      - name: sa-key\n        secret:\n          secretName: admin-gcp-sa\n      - configMap:\n          name: envoy-config\n        name: config-volume\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "04621",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    kustomize.component: iap-ingress\n  name: iap-enabler\n  namespace: kubeflow\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      kustomize.component: iap-ingress\n  template:\n    metadata:\n      labels:\n        kustomize.component: iap-ingress\n        service: iap-enabler\n    spec:\n      containers:\n      - command:\n        - bash\n        - /var/envoy-config/setup_backend.sh\n        env:\n        - name: GOOGLE_APPLICATION_CREDENTIALS\n          value: /var/run/secrets/sa/admin-gcp-sa.json\n        - name: NAMESPACE\n          value: istio-system\n        - name: SERVICE\n          value: istio-ingressgateway\n        - name: INGRESS_NAME\n          value: envoy-ingress\n        - name: ENVOY_ADMIN\n          value: http://localhost:8001\n        - name: USE_ISTIO\n          value: 'true'\n        image: gcr.io/kubeflow-images-public/ingress-setup:stable\n        name: iap\n        volumeMounts:\n        - mountPath: /var/run/secrets/sa\n          name: sa-key\n          readOnly: true\n        - mountPath: /var/envoy-config/\n          name: config-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      serviceAccountName: kf-admin\n      volumes:\n      - name: sa-key\n        secret:\n          secretName: admin-gcp-sa\n      - configMap:\n          name: envoy-config\n        name: config-volume\n",
    "errors": []
  },
  {
    "id": "04622",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    kustomize.component: iap-ingress\n  name: iap-enabler\n  namespace: kubeflow\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      kustomize.component: iap-ingress\n  template:\n    metadata:\n      labels:\n        kustomize.component: iap-ingress\n        service: iap-enabler\n    spec:\n      containers:\n      - command:\n        - bash\n        - /var/envoy-config/setup_backend.sh\n        env:\n        - name: GOOGLE_APPLICATION_CREDENTIALS\n          value: /var/run/secrets/sa/admin-gcp-sa.json\n        - name: NAMESPACE\n          value: istio-system\n        - name: SERVICE\n          value: istio-ingressgateway\n        - name: INGRESS_NAME\n          value: envoy-ingress\n        - name: ENVOY_ADMIN\n          value: http://localhost:8001\n        - name: USE_ISTIO\n          value: 'true'\n        image: gcr.io/kubeflow-images-public/ingress-setup:stable\n        name: iap\n        volumeMounts:\n        - mountPath: /var/run/secrets/sa\n          name: sa-key\n          readOnly: true\n        - mountPath: /var/envoy-config/\n          name: config-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      serviceAccountName: kf-admin\n      volumes:\n      - name: sa-key\n        secret:\n          secretName: admin-gcp-sa\n      - configMap:\n          name: envoy-config\n        name: config-volume\n",
    "errors": []
  },
  {
    "id": "04623",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-9619\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    securityContext:\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      privileged: false\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n      readOnlyRootFilesystem: true\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "04624",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-9619\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    securityContext:\n      readOnlyRootFilesystem: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "04625",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-9619\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    securityContext:\n      runAsNonRoot: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      readOnlyRootFilesystem: true\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "04626",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-9619\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n      readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "04627",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-9619\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n      readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "04628",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: packageserver\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: packageserver\n  template:\n    metadata:\n      labels:\n        app: packageserver\n        hypershift.openshift.io/control-plane-component: packageserver\n    spec:\n      containers:\n      - name: socks5-proxy\n        command:\n        - /usr/bin/konnectivity-socks5-proxy\n        args:\n        - run\n        image: SOCKS5_PROXY_IMAGE:stable\n        env:\n        - name: KUBECONFIG\n          value: /etc/openshift/kubeconfig/kubeconfig\n        ports:\n        - containerPort: 8090\n        volumeMounts:\n        - mountPath: /etc/konnectivity-proxy-tls\n          name: oas-konnectivity-proxy-cert\n          readOnly: true\n        - mountPath: /etc/openshift/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - command:\n        - /bin/package-server\n        - -v=4\n        - --secure-port\n        - '5443'\n        - --global-namespace\n        - openshift-marketplace\n        - --kubeconfig\n        - /etc/openshift/kubeconfig/kubeconfig\n        - --authentication-kubeconfig\n        - /etc/openshift/kubeconfig/kubeconfig\n        - --authorization-kubeconfig\n        - /etc/openshift/kubeconfig/kubeconfig\n        env:\n        - name: OPERATOR_CONDITION_NAME\n          value: packageserver\n        - name: GRPC_PROXY\n          value: socks5://127.0.0.1:8090\n        - name: NO_PROXY\n          value: kube-apiserver,redhat-operators,certified-operators,community-operators,redhat-marketplace\n        image: OLM_OPERATOR_IMAGE:stable\n        imagePullPolicy: IfNotPresent\n        livenessProbe:\n          failureThreshold: 3\n          httpGet:\n            path: /healthz\n            port: 5443\n            scheme: HTTPS\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        name: packageserver\n        ports:\n        - containerPort: 5443\n          protocol: TCP\n        readinessProbe:\n          failureThreshold: 3\n          httpGet:\n            path: /healthz\n            port: 5443\n            scheme: HTTPS\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        resources:\n          requests:\n            cpu: 10m\n            memory: 70Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmpfs\n        - mountPath: /apiserver.local.config/certificates\n          name: apiservice-cert\n        - mountPath: /tmp/k8s-webhook-server/serving-certs\n          name: webhook-cert\n        - mountPath: /etc/openshift/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      securityContext: {}\n      volumes:\n      - emptyDir: {}\n        name: tmpfs\n      - name: apiservice-cert\n        secret:\n          defaultMode: 420\n          items:\n          - key: tls.crt\n            path: apiserver.crt\n          - key: tls.key\n            path: apiserver.key\n          secretName: packageserver-cert\n      - name: webhook-cert\n        secret:\n          defaultMode: 420\n          secretName: packageserver-cert\n      - name: kubeconfig\n        secret:\n          secretName: service-network-admin-kubeconfig\n      - name: oas-konnectivity-proxy-cert\n        secret:\n          secretName: konnectivity-client\n",
    "errors": []
  },
  {
    "id": "04629",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: packageserver\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: packageserver\n  template:\n    metadata:\n      labels:\n        app: packageserver\n        hypershift.openshift.io/control-plane-component: packageserver\n    spec:\n      containers:\n      - name: socks5-proxy\n        command:\n        - /usr/bin/konnectivity-socks5-proxy\n        args:\n        - run\n        image: SOCKS5_PROXY_IMAGE:stable\n        env:\n        - name: KUBECONFIG\n          value: /etc/openshift/kubeconfig/kubeconfig\n        ports:\n        - containerPort: 8090\n        volumeMounts:\n        - mountPath: /etc/konnectivity-proxy-tls\n          name: oas-konnectivity-proxy-cert\n          readOnly: true\n        - mountPath: /etc/openshift/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - command:\n        - /bin/package-server\n        - -v=4\n        - --secure-port\n        - '5443'\n        - --global-namespace\n        - openshift-marketplace\n        - --kubeconfig\n        - /etc/openshift/kubeconfig/kubeconfig\n        - --authentication-kubeconfig\n        - /etc/openshift/kubeconfig/kubeconfig\n        - --authorization-kubeconfig\n        - /etc/openshift/kubeconfig/kubeconfig\n        env:\n        - name: OPERATOR_CONDITION_NAME\n          value: packageserver\n        - name: GRPC_PROXY\n          value: socks5://127.0.0.1:8090\n        - name: NO_PROXY\n          value: kube-apiserver,redhat-operators,certified-operators,community-operators,redhat-marketplace\n        image: OLM_OPERATOR_IMAGE:stable\n        imagePullPolicy: IfNotPresent\n        livenessProbe:\n          failureThreshold: 3\n          httpGet:\n            path: /healthz\n            port: 5443\n            scheme: HTTPS\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        name: packageserver\n        ports:\n        - containerPort: 5443\n          protocol: TCP\n        readinessProbe:\n          failureThreshold: 3\n          httpGet:\n            path: /healthz\n            port: 5443\n            scheme: HTTPS\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        resources:\n          requests:\n            cpu: 10m\n            memory: 70Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmpfs\n        - mountPath: /apiserver.local.config/certificates\n          name: apiservice-cert\n        - mountPath: /tmp/k8s-webhook-server/serving-certs\n          name: webhook-cert\n        - mountPath: /etc/openshift/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      securityContext: {}\n      volumes:\n      - emptyDir: {}\n        name: tmpfs\n      - name: apiservice-cert\n        secret:\n          defaultMode: 420\n          items:\n          - key: tls.crt\n            path: apiserver.crt\n          - key: tls.key\n            path: apiserver.key\n          secretName: packageserver-cert\n      - name: webhook-cert\n        secret:\n          defaultMode: 420\n          secretName: packageserver-cert\n      - name: kubeconfig\n        secret:\n          secretName: service-network-admin-kubeconfig\n      - name: oas-konnectivity-proxy-cert\n        secret:\n          secretName: konnectivity-client\n",
    "errors": []
  },
  {
    "id": "04630",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: packageserver\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: packageserver\n  template:\n    metadata:\n      labels:\n        app: packageserver\n        hypershift.openshift.io/control-plane-component: packageserver\n    spec:\n      containers:\n      - name: socks5-proxy\n        command:\n        - /usr/bin/konnectivity-socks5-proxy\n        args:\n        - run\n        image: SOCKS5_PROXY_IMAGE:stable\n        env:\n        - name: KUBECONFIG\n          value: /etc/openshift/kubeconfig/kubeconfig\n        ports:\n        - containerPort: 8090\n        volumeMounts:\n        - mountPath: /etc/konnectivity-proxy-tls\n          name: oas-konnectivity-proxy-cert\n          readOnly: true\n        - mountPath: /etc/openshift/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - command:\n        - /bin/package-server\n        - -v=4\n        - --secure-port\n        - '5443'\n        - --global-namespace\n        - openshift-marketplace\n        - --kubeconfig\n        - /etc/openshift/kubeconfig/kubeconfig\n        - --authentication-kubeconfig\n        - /etc/openshift/kubeconfig/kubeconfig\n        - --authorization-kubeconfig\n        - /etc/openshift/kubeconfig/kubeconfig\n        env:\n        - name: OPERATOR_CONDITION_NAME\n          value: packageserver\n        - name: GRPC_PROXY\n          value: socks5://127.0.0.1:8090\n        - name: NO_PROXY\n          value: kube-apiserver,redhat-operators,certified-operators,community-operators,redhat-marketplace\n        image: OLM_OPERATOR_IMAGE:stable\n        imagePullPolicy: IfNotPresent\n        livenessProbe:\n          failureThreshold: 3\n          httpGet:\n            path: /healthz\n            port: 5443\n            scheme: HTTPS\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        name: packageserver\n        ports:\n        - containerPort: 5443\n          protocol: TCP\n        readinessProbe:\n          failureThreshold: 3\n          httpGet:\n            path: /healthz\n            port: 5443\n            scheme: HTTPS\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        resources:\n          requests:\n            cpu: 10m\n            memory: 70Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmpfs\n        - mountPath: /apiserver.local.config/certificates\n          name: apiservice-cert\n        - mountPath: /tmp/k8s-webhook-server/serving-certs\n          name: webhook-cert\n        - mountPath: /etc/openshift/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n      securityContext: {}\n      volumes:\n      - emptyDir: {}\n        name: tmpfs\n      - name: apiservice-cert\n        secret:\n          defaultMode: 420\n          items:\n          - key: tls.crt\n            path: apiserver.crt\n          - key: tls.key\n            path: apiserver.key\n          secretName: packageserver-cert\n      - name: webhook-cert\n        secret:\n          defaultMode: 420\n          secretName: packageserver-cert\n      - name: kubeconfig\n        secret:\n          secretName: service-network-admin-kubeconfig\n      - name: oas-konnectivity-proxy-cert\n        secret:\n          secretName: konnectivity-client\n",
    "errors": []
  },
  {
    "id": "04631",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: packageserver\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: packageserver\n  template:\n    metadata:\n      labels:\n        app: packageserver\n        hypershift.openshift.io/control-plane-component: packageserver\n    spec:\n      containers:\n      - name: socks5-proxy\n        command:\n        - /usr/bin/konnectivity-socks5-proxy\n        args:\n        - run\n        image: SOCKS5_PROXY_IMAGE:stable\n        env:\n        - name: KUBECONFIG\n          value: /etc/openshift/kubeconfig/kubeconfig\n        ports:\n        - containerPort: 8090\n        volumeMounts:\n        - mountPath: /etc/konnectivity-proxy-tls\n          name: oas-konnectivity-proxy-cert\n          readOnly: true\n        - mountPath: /etc/openshift/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n      - command:\n        - /bin/package-server\n        - -v=4\n        - --secure-port\n        - '5443'\n        - --global-namespace\n        - openshift-marketplace\n        - --kubeconfig\n        - /etc/openshift/kubeconfig/kubeconfig\n        - --authentication-kubeconfig\n        - /etc/openshift/kubeconfig/kubeconfig\n        - --authorization-kubeconfig\n        - /etc/openshift/kubeconfig/kubeconfig\n        env:\n        - name: OPERATOR_CONDITION_NAME\n          value: packageserver\n        - name: GRPC_PROXY\n          value: socks5://127.0.0.1:8090\n        - name: NO_PROXY\n          value: kube-apiserver,redhat-operators,certified-operators,community-operators,redhat-marketplace\n        image: OLM_OPERATOR_IMAGE:stable\n        imagePullPolicy: IfNotPresent\n        livenessProbe:\n          failureThreshold: 3\n          httpGet:\n            path: /healthz\n            port: 5443\n            scheme: HTTPS\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        name: packageserver\n        ports:\n        - containerPort: 5443\n          protocol: TCP\n        readinessProbe:\n          failureThreshold: 3\n          httpGet:\n            path: /healthz\n            port: 5443\n            scheme: HTTPS\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        resources:\n          requests:\n            cpu: 10m\n            memory: 70Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmpfs\n        - mountPath: /apiserver.local.config/certificates\n          name: apiservice-cert\n        - mountPath: /tmp/k8s-webhook-server/serving-certs\n          name: webhook-cert\n        - mountPath: /etc/openshift/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n      securityContext: {}\n      volumes:\n      - emptyDir: {}\n        name: tmpfs\n      - name: apiservice-cert\n        secret:\n          defaultMode: 420\n          items:\n          - key: tls.crt\n            path: apiserver.crt\n          - key: tls.key\n            path: apiserver.key\n          secretName: packageserver-cert\n      - name: webhook-cert\n        secret:\n          defaultMode: 420\n          secretName: packageserver-cert\n      - name: kubeconfig\n        secret:\n          secretName: service-network-admin-kubeconfig\n      - name: oas-konnectivity-proxy-cert\n        secret:\n          secretName: konnectivity-client\n",
    "errors": []
  },
  {
    "id": "04632",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: packageserver\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: packageserver\n  template:\n    metadata:\n      labels:\n        app: packageserver\n        hypershift.openshift.io/control-plane-component: packageserver\n    spec:\n      containers:\n      - name: socks5-proxy\n        command:\n        - /usr/bin/konnectivity-socks5-proxy\n        args:\n        - run\n        image: SOCKS5_PROXY_IMAGE:stable\n        env:\n        - name: KUBECONFIG\n          value: /etc/openshift/kubeconfig/kubeconfig\n        ports:\n        - containerPort: 8090\n        volumeMounts:\n        - mountPath: /etc/konnectivity-proxy-tls\n          name: oas-konnectivity-proxy-cert\n          readOnly: true\n        - mountPath: /etc/openshift/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n      - command:\n        - /bin/package-server\n        - -v=4\n        - --secure-port\n        - '5443'\n        - --global-namespace\n        - openshift-marketplace\n        - --kubeconfig\n        - /etc/openshift/kubeconfig/kubeconfig\n        - --authentication-kubeconfig\n        - /etc/openshift/kubeconfig/kubeconfig\n        - --authorization-kubeconfig\n        - /etc/openshift/kubeconfig/kubeconfig\n        env:\n        - name: OPERATOR_CONDITION_NAME\n          value: packageserver\n        - name: GRPC_PROXY\n          value: socks5://127.0.0.1:8090\n        - name: NO_PROXY\n          value: kube-apiserver,redhat-operators,certified-operators,community-operators,redhat-marketplace\n        image: OLM_OPERATOR_IMAGE:stable\n        imagePullPolicy: IfNotPresent\n        livenessProbe:\n          failureThreshold: 3\n          httpGet:\n            path: /healthz\n            port: 5443\n            scheme: HTTPS\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        name: packageserver\n        ports:\n        - containerPort: 5443\n          protocol: TCP\n        readinessProbe:\n          failureThreshold: 3\n          httpGet:\n            path: /healthz\n            port: 5443\n            scheme: HTTPS\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        resources:\n          requests:\n            cpu: 10m\n            memory: 70Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmpfs\n        - mountPath: /apiserver.local.config/certificates\n          name: apiservice-cert\n        - mountPath: /tmp/k8s-webhook-server/serving-certs\n          name: webhook-cert\n        - mountPath: /etc/openshift/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n      securityContext:\n        runAsNonRoot: true\n      volumes:\n      - emptyDir: {}\n        name: tmpfs\n      - name: apiservice-cert\n        secret:\n          defaultMode: 420\n          items:\n          - key: tls.crt\n            path: apiserver.crt\n          - key: tls.key\n            path: apiserver.key\n          secretName: packageserver-cert\n      - name: webhook-cert\n        secret:\n          defaultMode: 420\n          secretName: packageserver-cert\n      - name: kubeconfig\n        secret:\n          secretName: service-network-admin-kubeconfig\n      - name: oas-konnectivity-proxy-cert\n        secret:\n          secretName: konnectivity-client\n",
    "errors": []
  },
  {
    "id": "04633",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: packageserver\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: packageserver\n  template:\n    metadata:\n      labels:\n        app: packageserver\n        hypershift.openshift.io/control-plane-component: packageserver\n    spec:\n      containers:\n      - name: socks5-proxy\n        command:\n        - /usr/bin/konnectivity-socks5-proxy\n        args:\n        - run\n        image: SOCKS5_PROXY_IMAGE:stable\n        env:\n        - name: KUBECONFIG\n          value: /etc/openshift/kubeconfig/kubeconfig\n        ports:\n        - containerPort: 8090\n        volumeMounts:\n        - mountPath: /etc/konnectivity-proxy-tls\n          name: oas-konnectivity-proxy-cert\n          readOnly: true\n        - mountPath: /etc/openshift/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n      - command:\n        - /bin/package-server\n        - -v=4\n        - --secure-port\n        - '5443'\n        - --global-namespace\n        - openshift-marketplace\n        - --kubeconfig\n        - /etc/openshift/kubeconfig/kubeconfig\n        - --authentication-kubeconfig\n        - /etc/openshift/kubeconfig/kubeconfig\n        - --authorization-kubeconfig\n        - /etc/openshift/kubeconfig/kubeconfig\n        env:\n        - name: OPERATOR_CONDITION_NAME\n          value: packageserver\n        - name: GRPC_PROXY\n          value: socks5://127.0.0.1:8090\n        - name: NO_PROXY\n          value: kube-apiserver,redhat-operators,certified-operators,community-operators,redhat-marketplace\n        image: OLM_OPERATOR_IMAGE:stable\n        imagePullPolicy: IfNotPresent\n        livenessProbe:\n          failureThreshold: 3\n          httpGet:\n            path: /healthz\n            port: 5443\n            scheme: HTTPS\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        name: packageserver\n        ports:\n        - containerPort: 5443\n          protocol: TCP\n        readinessProbe:\n          failureThreshold: 3\n          httpGet:\n            path: /healthz\n            port: 5443\n            scheme: HTTPS\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        resources:\n          requests:\n            cpu: 10m\n            memory: 70Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmpfs\n        - mountPath: /apiserver.local.config/certificates\n          name: apiservice-cert\n        - mountPath: /tmp/k8s-webhook-server/serving-certs\n          name: webhook-cert\n        - mountPath: /etc/openshift/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n      securityContext:\n        runAsNonRoot: true\n      volumes:\n      - emptyDir: {}\n        name: tmpfs\n      - name: apiservice-cert\n        secret:\n          defaultMode: 420\n          items:\n          - key: tls.crt\n            path: apiserver.crt\n          - key: tls.key\n            path: apiserver.key\n          secretName: packageserver-cert\n      - name: webhook-cert\n        secret:\n          defaultMode: 420\n          secretName: packageserver-cert\n      - name: kubeconfig\n        secret:\n          secretName: service-network-admin-kubeconfig\n      - name: oas-konnectivity-proxy-cert\n        secret:\n          secretName: konnectivity-client\n",
    "errors": []
  },
  {
    "id": "04634",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: packageserver\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: packageserver\n  template:\n    metadata:\n      labels:\n        app: packageserver\n        hypershift.openshift.io/control-plane-component: packageserver\n    spec:\n      containers:\n      - name: socks5-proxy\n        command:\n        - /usr/bin/konnectivity-socks5-proxy\n        args:\n        - run\n        image: SOCKS5_PROXY_IMAGE:stable\n        env:\n        - name: KUBECONFIG\n          value: /etc/openshift/kubeconfig/kubeconfig\n        ports:\n        - containerPort: 8090\n        volumeMounts:\n        - mountPath: /etc/konnectivity-proxy-tls\n          name: oas-konnectivity-proxy-cert\n          readOnly: true\n        - mountPath: /etc/openshift/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - command:\n        - /bin/package-server\n        - -v=4\n        - --secure-port\n        - '5443'\n        - --global-namespace\n        - openshift-marketplace\n        - --kubeconfig\n        - /etc/openshift/kubeconfig/kubeconfig\n        - --authentication-kubeconfig\n        - /etc/openshift/kubeconfig/kubeconfig\n        - --authorization-kubeconfig\n        - /etc/openshift/kubeconfig/kubeconfig\n        env:\n        - name: OPERATOR_CONDITION_NAME\n          value: packageserver\n        - name: GRPC_PROXY\n          value: socks5://127.0.0.1:8090\n        - name: NO_PROXY\n          value: kube-apiserver,redhat-operators,certified-operators,community-operators,redhat-marketplace\n        image: OLM_OPERATOR_IMAGE:stable\n        imagePullPolicy: IfNotPresent\n        livenessProbe:\n          failureThreshold: 3\n          httpGet:\n            path: /healthz\n            port: 5443\n            scheme: HTTPS\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        name: packageserver\n        ports:\n        - containerPort: 5443\n          protocol: TCP\n        readinessProbe:\n          failureThreshold: 3\n          httpGet:\n            path: /healthz\n            port: 5443\n            scheme: HTTPS\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        resources:\n          requests:\n            cpu: 10m\n            memory: 70Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmpfs\n        - mountPath: /apiserver.local.config/certificates\n          name: apiservice-cert\n        - mountPath: /tmp/k8s-webhook-server/serving-certs\n          name: webhook-cert\n        - mountPath: /etc/openshift/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      securityContext: {}\n      volumes:\n      - emptyDir: {}\n        name: tmpfs\n      - name: apiservice-cert\n        secret:\n          defaultMode: 420\n          items:\n          - key: tls.crt\n            path: apiserver.crt\n          - key: tls.key\n            path: apiserver.key\n          secretName: packageserver-cert\n      - name: webhook-cert\n        secret:\n          defaultMode: 420\n          secretName: packageserver-cert\n      - name: kubeconfig\n        secret:\n          secretName: service-network-admin-kubeconfig\n      - name: oas-konnectivity-proxy-cert\n        secret:\n          secretName: konnectivity-client\n",
    "errors": []
  },
  {
    "id": "04635",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: packageserver\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: packageserver\n  template:\n    metadata:\n      labels:\n        app: packageserver\n        hypershift.openshift.io/control-plane-component: packageserver\n    spec:\n      containers:\n      - name: socks5-proxy\n        command:\n        - /usr/bin/konnectivity-socks5-proxy\n        args:\n        - run\n        image: SOCKS5_PROXY_IMAGE:stable\n        env:\n        - name: KUBECONFIG\n          value: /etc/openshift/kubeconfig/kubeconfig\n        ports:\n        - containerPort: 8090\n        volumeMounts:\n        - mountPath: /etc/konnectivity-proxy-tls\n          name: oas-konnectivity-proxy-cert\n          readOnly: true\n        - mountPath: /etc/openshift/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - command:\n        - /bin/package-server\n        - -v=4\n        - --secure-port\n        - '5443'\n        - --global-namespace\n        - openshift-marketplace\n        - --kubeconfig\n        - /etc/openshift/kubeconfig/kubeconfig\n        - --authentication-kubeconfig\n        - /etc/openshift/kubeconfig/kubeconfig\n        - --authorization-kubeconfig\n        - /etc/openshift/kubeconfig/kubeconfig\n        env:\n        - name: OPERATOR_CONDITION_NAME\n          value: packageserver\n        - name: GRPC_PROXY\n          value: socks5://127.0.0.1:8090\n        - name: NO_PROXY\n          value: kube-apiserver,redhat-operators,certified-operators,community-operators,redhat-marketplace\n        image: OLM_OPERATOR_IMAGE:stable\n        imagePullPolicy: IfNotPresent\n        livenessProbe:\n          failureThreshold: 3\n          httpGet:\n            path: /healthz\n            port: 5443\n            scheme: HTTPS\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        name: packageserver\n        ports:\n        - containerPort: 5443\n          protocol: TCP\n        readinessProbe:\n          failureThreshold: 3\n          httpGet:\n            path: /healthz\n            port: 5443\n            scheme: HTTPS\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        resources:\n          requests:\n            cpu: 10m\n            memory: 70Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmpfs\n        - mountPath: /apiserver.local.config/certificates\n          name: apiservice-cert\n        - mountPath: /tmp/k8s-webhook-server/serving-certs\n          name: webhook-cert\n        - mountPath: /etc/openshift/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      securityContext: {}\n      volumes:\n      - emptyDir: {}\n        name: tmpfs\n      - name: apiservice-cert\n        secret:\n          defaultMode: 420\n          items:\n          - key: tls.crt\n            path: apiserver.crt\n          - key: tls.key\n            path: apiserver.key\n          secretName: packageserver-cert\n      - name: webhook-cert\n        secret:\n          defaultMode: 420\n          secretName: packageserver-cert\n      - name: kubeconfig\n        secret:\n          secretName: service-network-admin-kubeconfig\n      - name: oas-konnectivity-proxy-cert\n        secret:\n          secretName: konnectivity-client\n",
    "errors": []
  },
  {
    "id": "04636",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: packageserver\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: packageserver\n  template:\n    metadata:\n      labels:\n        app: packageserver\n        hypershift.openshift.io/control-plane-component: packageserver\n    spec:\n      containers:\n      - name: socks5-proxy\n        command:\n        - /usr/bin/konnectivity-socks5-proxy\n        args:\n        - run\n        image: SOCKS5_PROXY_IMAGE:stable\n        env:\n        - name: KUBECONFIG\n          value: /etc/openshift/kubeconfig/kubeconfig\n        ports:\n        - containerPort: 8090\n        volumeMounts:\n        - mountPath: /etc/konnectivity-proxy-tls\n          name: oas-konnectivity-proxy-cert\n          readOnly: true\n        - mountPath: /etc/openshift/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - command:\n        - /bin/package-server\n        - -v=4\n        - --secure-port\n        - '5443'\n        - --global-namespace\n        - openshift-marketplace\n        - --kubeconfig\n        - /etc/openshift/kubeconfig/kubeconfig\n        - --authentication-kubeconfig\n        - /etc/openshift/kubeconfig/kubeconfig\n        - --authorization-kubeconfig\n        - /etc/openshift/kubeconfig/kubeconfig\n        env:\n        - name: OPERATOR_CONDITION_NAME\n          value: packageserver\n        - name: GRPC_PROXY\n          value: socks5://127.0.0.1:8090\n        - name: NO_PROXY\n          value: kube-apiserver,redhat-operators,certified-operators,community-operators,redhat-marketplace\n        image: OLM_OPERATOR_IMAGE:stable\n        imagePullPolicy: IfNotPresent\n        livenessProbe:\n          failureThreshold: 3\n          httpGet:\n            path: /healthz\n            port: 5443\n            scheme: HTTPS\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        name: packageserver\n        ports:\n        - containerPort: 5443\n          protocol: TCP\n        readinessProbe:\n          failureThreshold: 3\n          httpGet:\n            path: /healthz\n            port: 5443\n            scheme: HTTPS\n          periodSeconds: 10\n          successThreshold: 1\n          timeoutSeconds: 1\n        resources:\n          requests:\n            cpu: 10m\n            memory: 70Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmpfs\n        - mountPath: /apiserver.local.config/certificates\n          name: apiservice-cert\n        - mountPath: /tmp/k8s-webhook-server/serving-certs\n          name: webhook-cert\n        - mountPath: /etc/openshift/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      securityContext: {}\n      volumes:\n      - emptyDir: {}\n        name: tmpfs\n      - name: apiservice-cert\n        secret:\n          defaultMode: 420\n          items:\n          - key: tls.crt\n            path: apiserver.crt\n          - key: tls.key\n            path: apiserver.key\n          secretName: packageserver-cert\n      - name: webhook-cert\n        secret:\n          defaultMode: 420\n          secretName: packageserver-cert\n      - name: kubeconfig\n        secret:\n          secretName: service-network-admin-kubeconfig\n      - name: oas-konnectivity-proxy-cert\n        secret:\n          secretName: konnectivity-client\n",
    "errors": []
  },
  {
    "id": "04637",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: hello\nspec:\n  containers:\n  - name: hello\n    image: raelga/hello:stable\n    resources:\n      limits:\n        cpu: 50m\n        memory: 0.1G\n      requests:\n        cpu: 50m\n        memory: 0.1G\n    securityContext:\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      privileged: false\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n      readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "04638",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: hello\nspec:\n  containers:\n  - name: hello\n    image: raelga/hello:stable\n    resources:\n      limits:\n        cpu: 50m\n        memory: 0.1G\n      requests:\n        cpu: 50m\n        memory: 0.1G\n    securityContext:\n      readOnlyRootFilesystem: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "04639",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: hello\nspec:\n  containers:\n  - name: hello\n    image: raelga/hello:stable\n    resources:\n      limits:\n        cpu: 50m\n        memory: 0.1G\n      requests:\n        cpu: 50m\n        memory: 0.1G\n    securityContext:\n      runAsNonRoot: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "04640",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: my-pod\n  namespace: workshop-303\nspec:\n  containers:\n  - name: first-container\n    image: fedora:29\n    command:\n    - sleep\n    - '36000'\n    env:\n    - name: SECRET_USERNAME\n      valueFrom:\n        secretKeyRef:\n          name: my-secret\n          key: username\n    - name: SECRET_PASSWORD\n      valueFrom:\n        secretKeyRef:\n          name: my-secret\n          key: password\n    volumeMounts:\n    - name: my-configmap\n      mountPath: /config\n    securityContext:\n      readOnlyRootFilesystem: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n  volumes:\n  - name: my-configmap\n    configMap:\n      name: my-configmap\n",
    "errors": []
  }
]