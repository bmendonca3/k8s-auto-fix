[
  {
    "id": "03201",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: red\n  labels:\n    app: red\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: red\n  template:\n    metadata:\n      labels:\n        app: red\n    spec:\n      containers:\n      - name: red\n        image: nginx:1.19.2\n        volumeMounts:\n        - name: html\n          mountPath: /usr/share/nginx/html\n        resources:\n          requests:\n            cpu: 100m\n            memory: 100Mi\n          limits:\n            cpu: 100m\n            memory: 100Mi\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: html\n        configMap:\n          name: red\n          items:\n          - key: body\n            path: index.html\n",
    "errors": []
  },
  {
    "id": "03202",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: CronJob\nmetadata:\n  name: blockvalidator\nspec:\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          containers:\n          - name: blockvalidator\n            image: funkypenguin/grinpool-services:stable\n            command:\n            - /usr/local/bin/blockValidator.py\n            env:\n            - name: MYSQL_ROOT_PASSWORD\n              valueFrom:\n                secretKeyRef:\n                  name: mysql-pass\n                  key: password\n            securityContext:\n              capabilities:\n                drop:\n                - NET_RAW\n                - NET_ADMIN\n                - SYS_ADMIN\n                - SYS_MODULE\n                - SYS_PTRACE\n                - SYS_CHROOT\n              privileged: false\n              allowPrivilegeEscalation: false\n              runAsNonRoot: true\n              readOnlyRootFilesystem: true\n            resources:\n              requests:\n                cpu: 100m\n                memory: 128Mi\n              limits:\n                cpu: 500m\n                memory: 256Mi\n          restartPolicy: OnFailure\n  schedule: 0 0 * * *\n",
    "errors": []
  },
  {
    "id": "03203",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: CronJob\nmetadata:\n  name: blockvalidator\nspec:\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          containers:\n          - name: blockvalidator\n            image: funkypenguin/grinpool-services:stable\n            command:\n            - /usr/local/bin/blockValidator.py\n            env:\n            - name: MYSQL_ROOT_PASSWORD\n              valueFrom:\n                secretKeyRef:\n                  name: mysql-pass\n                  key: password\n            securityContext:\n              readOnlyRootFilesystem: true\n              privileged: false\n              capabilities:\n                drop:\n                - NET_RAW\n                - NET_ADMIN\n                - SYS_ADMIN\n                - SYS_MODULE\n                - SYS_PTRACE\n                - SYS_CHROOT\n              allowPrivilegeEscalation: false\n              runAsNonRoot: true\n            resources:\n              requests:\n                cpu: 100m\n                memory: 128Mi\n              limits:\n                cpu: 500m\n                memory: 256Mi\n          restartPolicy: OnFailure\n  schedule: 0 0 * * *\n",
    "errors": []
  },
  {
    "id": "03204",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: CronJob\nmetadata:\n  name: blockvalidator\nspec:\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          containers:\n          - name: blockvalidator\n            image: funkypenguin/grinpool-services:stable\n            command:\n            - /usr/local/bin/blockValidator.py\n            env:\n            - name: MYSQL_ROOT_PASSWORD\n              valueFrom:\n                secretKeyRef:\n                  name: mysql-pass\n                  key: password\n            securityContext:\n              runAsNonRoot: true\n              privileged: false\n              capabilities:\n                drop:\n                - NET_RAW\n                - NET_ADMIN\n                - SYS_ADMIN\n                - SYS_MODULE\n                - SYS_PTRACE\n                - SYS_CHROOT\n              allowPrivilegeEscalation: false\n              readOnlyRootFilesystem: true\n            resources:\n              requests:\n                cpu: 100m\n                memory: 128Mi\n              limits:\n                cpu: 500m\n                memory: 256Mi\n          restartPolicy: OnFailure\n  schedule: 0 0 * * *\n",
    "errors": []
  },
  {
    "id": "03205",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: CronJob\nmetadata:\n  name: blockvalidator\nspec:\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          containers:\n          - name: blockvalidator\n            image: funkypenguin/grinpool-services:stable\n            command:\n            - /usr/local/bin/blockValidator.py\n            env:\n            - name: MYSQL_ROOT_PASSWORD\n              valueFrom:\n                secretKeyRef:\n                  name: mysql-pass\n                  key: password\n            resources:\n              requests:\n                cpu: 100m\n                memory: 128Mi\n              limits:\n                cpu: 500m\n                memory: 256Mi\n            securityContext:\n              privileged: false\n              capabilities:\n                drop:\n                - NET_RAW\n                - NET_ADMIN\n                - SYS_ADMIN\n                - SYS_MODULE\n                - SYS_PTRACE\n                - SYS_CHROOT\n              allowPrivilegeEscalation: false\n              runAsNonRoot: true\n              readOnlyRootFilesystem: true\n          restartPolicy: OnFailure\n  schedule: 0 0 * * *\n",
    "errors": []
  },
  {
    "id": "03206",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: CronJob\nmetadata:\n  name: blockvalidator\nspec:\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          containers:\n          - name: blockvalidator\n            image: funkypenguin/grinpool-services:stable\n            command:\n            - /usr/local/bin/blockValidator.py\n            env:\n            - name: MYSQL_ROOT_PASSWORD\n              valueFrom:\n                secretKeyRef:\n                  name: mysql-pass\n                  key: password\n            resources:\n              requests:\n                cpu: 100m\n                memory: 128Mi\n              limits:\n                cpu: 500m\n                memory: 256Mi\n            securityContext:\n              privileged: false\n              capabilities:\n                drop:\n                - NET_RAW\n                - NET_ADMIN\n                - SYS_ADMIN\n                - SYS_MODULE\n                - SYS_PTRACE\n                - SYS_CHROOT\n              allowPrivilegeEscalation: false\n              runAsNonRoot: true\n              readOnlyRootFilesystem: true\n          restartPolicy: OnFailure\n  schedule: 0 0 * * *\n",
    "errors": []
  },
  {
    "id": "03207",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: reefer-itgtests-job\nspec:\n  template:\n    metadata:\n      name: reefer-itgtests-job\n    spec:\n      containers:\n      - name: ibmcase-python\n        image: quay.io/ibmcase/kcontainer-python:itgtests\n        imagePullPolicy: Always\n        command:\n        - /bin/bash\n        - -c\n        - \"# Obfuscate KAFKA_PASSWORD\\nif [ \\\"`echo -n ${KAFKA_PASSWORD} | wc -c`\\\"\\\n          \\ -gt 3 ]; then\\n  FIRST_CH=${KAFKA_PASSWORD:0:1}\\n  LAST_CH=${KAFKA_PASSWORD:\\\n          \\ -1}\\n  OBFUSCATED_PASSWORD=\\\"${FIRST_CH}*****${LAST_CH}\\\"\\nelse\\n  OBFUSCATED_PASSWORD=\\\"\\\n          *******\\\"\\nfi\\n\\necho \\\"-----------------------------------------------------------------\\\"\\\n          \\necho \\\"-- Reefer Container Shipment EDA application Integration Tests\\\n          \\ --\\\"\\necho \\\"-----------------------------------------------------------------\\\"\\\n          \\necho\\necho \\\"Executing integrations tests from branch $BRANCH of $GITHUB_REPO\\\"\\\n          \\necho \\\"Kafka Brokers: $KAFKA_BROKERS\\\"\\necho \\\"Kafka Security protocol:\\\n          \\ $SECURITY_PROTOCOL\\\"\\necho \\\"Kafka SASL mechanism: $SASL_MECHANISM\\\"\\n\\\n          echo \\\"Kafka user: $KAFKA_USER\\\"\\necho \\\"Kafka password: $OBFUSCATED_PASSWORD\\\"\\\n          \\necho \\\"Orders topic name: $ITGTESTS_ORDERS_TOPIC\\\"\\necho \\\"Order Command\\\n          \\ topic name: $ITGTESTS_ORDER_COMMANDS_TOPIC\\\"\\necho \\\"Containers topic\\\n          \\ name: $ITGTESTS_CONTAINERS_TOPIC\\\"\\necho \\\"------------------------------------------------------------------\\\"\\\n          \\necho\\n\\n# Check important environments variables are properly set\\nif\\\n          \\ [ -z \\\"$KAFKA_BROKERS\\\" ]; then\\n  echo \\\"[ERROR] - KAFKA_BROKERS environment\\\n          \\ variable must be set.\\\"\\n  exit 1\\nfi\\n\\n# Check that a Kafka user and\\\n          \\ password are provided if there is authentication set up\\nif [ \\\"$SECURITY_PROTOCOL\\\"\\\n          \\ == \\\"SASL_PLAINTEXT\\\" ] || [ \\\"$SECURITY_PROTOCOL\\\" == \\\"SASL_SSL\\\" ];\\\n          \\ then\\n  if [ -z \\\"$KAFKA_USER\\\" ]; then\\n    echo \\\"[ERROR] - A Kafka\\\n          \\ user was not provided.\\\"\\n    exit 1\\n  fi\\n  if [ -z \\\"$KAFKA_PASSWORD\\\"\\\n          \\ ]; then\\n    echo \\\"[ERROR] - A Kafka password was not provided.\\\"\\n \\\n          \\   exit 1\\n  fi\\nfi\\n\\n# Ideally, we would check here if SECURITY_PROTOCOL\\\n          \\ is SSL or SASL_SSL which are the two security protocols that use SSL certs.\\n\\\n          # However, IBM Event Streams on IBM Cloud uses SASL_SSL but there is no\\\n          \\ need for a certificate.\\n# Hence, we can only warn that\\nif [ \\\"$SECURITY_PROTOCOL\\\"\\\n          \\ == \\\"SSL\\\" ] || [ \\\"$SECURITY_PROTOCOL\\\" == \\\"SASL_SSL\\\" ]; then\\n  if\\\n          \\ [ ! -f \\\"$PEM_CERT\\\" ]; then\\n    echo \\\"[WARNING] - A PEM certificate\\\n          \\ could not be found. This might be necessary to establish the appropriate\\\n          \\ secured communication to the Kafka cluster.\\\"\\n    echo \\\"[WARNING] -\\\n          \\ If it is needed, make sure you have created a Kubernetes Secret named\\\n          \\ 'kafka-truststore-pem' with the PEM certificate\\\"\\n    echo \\\"[WARNING]\\\n          \\ - as referenced in the Integration Tests YAML file.\\\"\\n  fi\\nfi\\n\\n# Creating\\\n          \\ the working directory\\nmkdir ${WORKING_DIR} && cd ${WORKING_DIR}\\n\\n#\\\n          \\ Clone the repository where the integration tests to be executed are and\\\n          \\ checkout the specific branch\\ngit clone ${GITHUB_REPO} && cd ${REPO_NAME}\\\n          \\ && if [ \\\"master\\\" != \\\"${BRANCH}\\\" ]; then git checkout ${BRANCH}; fi\\n\\\n          \\n# Get into the location for the integration tests\\ncd ${ITGTESTS_LOCATION}\\n\\\n          \\n# Execute the integration tests\\n\\n# Create the tests reporting file\\n\\\n          touch /tmp/results.txt\\n\\nexport PYTHONPATH=${PYTHONPATH}:${WORKING_DIR}/${REPO_NAME}/itg-tests\\n\\\n          \\necho '******************************************'\\necho '******************************************'\\n\\\n          echo '**********   E2E Happy Path   ************'\\necho '******************************************'\\n\\\n          echo '******************************************'\\n\\npython -u E2EHappyPath.py\\\n          \\ && source /tmp/E2EHappyPath.properties\\n\\necho '******************************************'\\n\\\n          echo '******************************************'\\necho '*********   Saga\\\n          \\ No Container   **********'\\necho '******************************************'\\n\\\n          echo '******************************************'\\n\\npython -u Saga_NoContainer.py\\n\\\n          \\necho '******************************************'\\necho '******************************************'\\n\\\n          echo '**********   Saga No Voyage   ************'\\necho '******************************************'\\n\\\n          echo '******************************************'\\n\\npython -u Saga_NoVoyage.py\\\n          \\ && source /tmp/SagaNoVoyage.properties\\n\\necho '******************************************'\\n\\\n          echo '******************************************'\\necho '**********   Order\\\n          \\ Cancelled   ***********'\\necho '******************************************'\\n\\\n          echo '******************************************'\\n\\npython -u OrderCancellation.py\\n\\\n          \\necho '******************************************'\\necho '******************************************'\\n\\\n          echo '*********   Container Anomaly   **********'\\necho '******************************************'\\n\\\n          echo '******************************************'\\n\\npython -u ContainerAnomaly.py\\n\\\n          \\necho '****************************************************'\\necho '****************************************************'\\n\\\n          echo '*********   Retry and Dead Letter Queue   **********'\\necho '****************************************************'\\n\\\n          echo '****************************************************'\\n\\npython -u\\\n          \\ ContainerAnomalyDlq.py\\n\\necho\\necho 'END RESULTS:'\\necho\\ncat /tmp/results.txt\\n\\\n          \\necho \\\"---------\\\"\\necho \\\"-- END --\\\"\\necho \\\"---------\\\"\\n\"\n        env:\n        - name: KAFKA_BROKERS\n          valueFrom:\n            configMapKeyRef:\n              name: kafka-brokers\n              key: brokers\n        - name: KAFKA_USER\n          valueFrom:\n            secretKeyRef:\n              name: kafka-credentials\n              key: username\n              optional: true\n        - name: KAFKA_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: kafka-credentials\n              key: password\n              optional: true\n        - name: PEM_CERT\n          value: /tmp/certs/kafka-cert.pem\n        - name: SASL_MECHANISM\n          value: PLAIN\n        - name: SECURITY_PROTOCOL\n          value: SASL_SSL\n        - name: WORKING_DIR\n          value: /tmp/github\n        - name: GITHUB_REPO\n          value: https://github.com/ibm-cloud-architecture/refarch-kc.git\n        - name: BRANCH\n          value: master\n        - name: REPO_NAME\n          value: refarch-kc\n        - name: ITGTESTS_LOCATION\n          value: itg-tests/es-it\n        - name: ORDER_CMD_MS\n          value: order-command-ms:9080\n        - name: ORDER_QUERY_MS\n          value: order-query-ms:9080\n        - name: CONTAINER_SPRING_MS\n          value: spring-container-ms:8080\n        - name: VOYAGE_MS\n          value: voyages-ms:3000\n        - name: ITGTESTS_ORDERS_TOPIC\n          valueFrom:\n            configMapKeyRef:\n              name: kafka-topics\n              key: ordersTopic\n        - name: ITGTESTS_ORDER_COMMANDS_TOPIC\n          valueFrom:\n            configMapKeyRef:\n              name: kafka-topics\n              key: orderCommandsTopic\n        - name: ITGTESTS_CONTAINERS_TOPIC\n          valueFrom:\n            configMapKeyRef:\n              name: kafka-topics\n              key: containersTopic\n        - name: ITGTESTS_CONTAINER_ANOMALY_RETRY_TOPIC\n          valueFrom:\n            configMapKeyRef:\n              name: kafka-topics\n              key: containerAnomalyRetryTopic\n        - name: ITGTESTS_CONTAINER_ANOMALY_DEAD_TOPIC\n          valueFrom:\n            configMapKeyRef:\n              name: kafka-topics\n              key: containerAnomalyDeadTopic\n        volumeMounts:\n        - mountPath: /tmp\n          name: tmp-volume\n        - mountPath: /tmp/certs\n          name: eventstreams-pem-file\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: eventstreams-pem-file\n        secret:\n          secretName: kafka-truststore-pem\n          optional: true\n      - name: tmp-volume\n        emptyDir: {}\n      restartPolicy: OnFailure\n",
    "errors": []
  },
  {
    "id": "03208",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: reefer-itgtests-job\nspec:\n  template:\n    metadata:\n      name: reefer-itgtests-job\n    spec:\n      containers:\n      - name: ibmcase-python\n        image: quay.io/ibmcase/kcontainer-python:itgtests\n        imagePullPolicy: Always\n        command:\n        - /bin/bash\n        - -c\n        - \"# Obfuscate KAFKA_PASSWORD\\nif [ \\\"`echo -n ${KAFKA_PASSWORD} | wc -c`\\\"\\\n          \\ -gt 3 ]; then\\n  FIRST_CH=${KAFKA_PASSWORD:0:1}\\n  LAST_CH=${KAFKA_PASSWORD:\\\n          \\ -1}\\n  OBFUSCATED_PASSWORD=\\\"${FIRST_CH}*****${LAST_CH}\\\"\\nelse\\n  OBFUSCATED_PASSWORD=\\\"\\\n          *******\\\"\\nfi\\n\\necho \\\"-----------------------------------------------------------------\\\"\\\n          \\necho \\\"-- Reefer Container Shipment EDA application Integration Tests\\\n          \\ --\\\"\\necho \\\"-----------------------------------------------------------------\\\"\\\n          \\necho\\necho \\\"Executing integrations tests from branch $BRANCH of $GITHUB_REPO\\\"\\\n          \\necho \\\"Kafka Brokers: $KAFKA_BROKERS\\\"\\necho \\\"Kafka Security protocol:\\\n          \\ $SECURITY_PROTOCOL\\\"\\necho \\\"Kafka SASL mechanism: $SASL_MECHANISM\\\"\\n\\\n          echo \\\"Kafka user: $KAFKA_USER\\\"\\necho \\\"Kafka password: $OBFUSCATED_PASSWORD\\\"\\\n          \\necho \\\"Orders topic name: $ITGTESTS_ORDERS_TOPIC\\\"\\necho \\\"Order Command\\\n          \\ topic name: $ITGTESTS_ORDER_COMMANDS_TOPIC\\\"\\necho \\\"Containers topic\\\n          \\ name: $ITGTESTS_CONTAINERS_TOPIC\\\"\\necho \\\"------------------------------------------------------------------\\\"\\\n          \\necho\\n\\n# Check important environments variables are properly set\\nif\\\n          \\ [ -z \\\"$KAFKA_BROKERS\\\" ]; then\\n  echo \\\"[ERROR] - KAFKA_BROKERS environment\\\n          \\ variable must be set.\\\"\\n  exit 1\\nfi\\n\\n# Check that a Kafka user and\\\n          \\ password are provided if there is authentication set up\\nif [ \\\"$SECURITY_PROTOCOL\\\"\\\n          \\ == \\\"SASL_PLAINTEXT\\\" ] || [ \\\"$SECURITY_PROTOCOL\\\" == \\\"SASL_SSL\\\" ];\\\n          \\ then\\n  if [ -z \\\"$KAFKA_USER\\\" ]; then\\n    echo \\\"[ERROR] - A Kafka\\\n          \\ user was not provided.\\\"\\n    exit 1\\n  fi\\n  if [ -z \\\"$KAFKA_PASSWORD\\\"\\\n          \\ ]; then\\n    echo \\\"[ERROR] - A Kafka password was not provided.\\\"\\n \\\n          \\   exit 1\\n  fi\\nfi\\n\\n# Ideally, we would check here if SECURITY_PROTOCOL\\\n          \\ is SSL or SASL_SSL which are the two security protocols that use SSL certs.\\n\\\n          # However, IBM Event Streams on IBM Cloud uses SASL_SSL but there is no\\\n          \\ need for a certificate.\\n# Hence, we can only warn that\\nif [ \\\"$SECURITY_PROTOCOL\\\"\\\n          \\ == \\\"SSL\\\" ] || [ \\\"$SECURITY_PROTOCOL\\\" == \\\"SASL_SSL\\\" ]; then\\n  if\\\n          \\ [ ! -f \\\"$PEM_CERT\\\" ]; then\\n    echo \\\"[WARNING] - A PEM certificate\\\n          \\ could not be found. This might be necessary to establish the appropriate\\\n          \\ secured communication to the Kafka cluster.\\\"\\n    echo \\\"[WARNING] -\\\n          \\ If it is needed, make sure you have created a Kubernetes Secret named\\\n          \\ 'kafka-truststore-pem' with the PEM certificate\\\"\\n    echo \\\"[WARNING]\\\n          \\ - as referenced in the Integration Tests YAML file.\\\"\\n  fi\\nfi\\n\\n# Creating\\\n          \\ the working directory\\nmkdir ${WORKING_DIR} && cd ${WORKING_DIR}\\n\\n#\\\n          \\ Clone the repository where the integration tests to be executed are and\\\n          \\ checkout the specific branch\\ngit clone ${GITHUB_REPO} && cd ${REPO_NAME}\\\n          \\ && if [ \\\"master\\\" != \\\"${BRANCH}\\\" ]; then git checkout ${BRANCH}; fi\\n\\\n          \\n# Get into the location for the integration tests\\ncd ${ITGTESTS_LOCATION}\\n\\\n          \\n# Execute the integration tests\\n\\n# Create the tests reporting file\\n\\\n          touch /tmp/results.txt\\n\\nexport PYTHONPATH=${PYTHONPATH}:${WORKING_DIR}/${REPO_NAME}/itg-tests\\n\\\n          \\necho '******************************************'\\necho '******************************************'\\n\\\n          echo '**********   E2E Happy Path   ************'\\necho '******************************************'\\n\\\n          echo '******************************************'\\n\\npython -u E2EHappyPath.py\\\n          \\ && source /tmp/E2EHappyPath.properties\\n\\necho '******************************************'\\n\\\n          echo '******************************************'\\necho '*********   Saga\\\n          \\ No Container   **********'\\necho '******************************************'\\n\\\n          echo '******************************************'\\n\\npython -u Saga_NoContainer.py\\n\\\n          \\necho '******************************************'\\necho '******************************************'\\n\\\n          echo '**********   Saga No Voyage   ************'\\necho '******************************************'\\n\\\n          echo '******************************************'\\n\\npython -u Saga_NoVoyage.py\\\n          \\ && source /tmp/SagaNoVoyage.properties\\n\\necho '******************************************'\\n\\\n          echo '******************************************'\\necho '**********   Order\\\n          \\ Cancelled   ***********'\\necho '******************************************'\\n\\\n          echo '******************************************'\\n\\npython -u OrderCancellation.py\\n\\\n          \\necho '******************************************'\\necho '******************************************'\\n\\\n          echo '*********   Container Anomaly   **********'\\necho '******************************************'\\n\\\n          echo '******************************************'\\n\\npython -u ContainerAnomaly.py\\n\\\n          \\necho '****************************************************'\\necho '****************************************************'\\n\\\n          echo '*********   Retry and Dead Letter Queue   **********'\\necho '****************************************************'\\n\\\n          echo '****************************************************'\\n\\npython -u\\\n          \\ ContainerAnomalyDlq.py\\n\\necho\\necho 'END RESULTS:'\\necho\\ncat /tmp/results.txt\\n\\\n          \\necho \\\"---------\\\"\\necho \\\"-- END --\\\"\\necho \\\"---------\\\"\\n\"\n        env:\n        - name: KAFKA_BROKERS\n          valueFrom:\n            configMapKeyRef:\n              name: kafka-brokers\n              key: brokers\n        - name: KAFKA_USER\n          valueFrom:\n            secretKeyRef:\n              name: kafka-credentials\n              key: username\n              optional: true\n        - name: KAFKA_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: kafka-credentials\n              key: password\n              optional: true\n        - name: PEM_CERT\n          value: /tmp/certs/kafka-cert.pem\n        - name: SASL_MECHANISM\n          value: PLAIN\n        - name: SECURITY_PROTOCOL\n          value: SASL_SSL\n        - name: WORKING_DIR\n          value: /tmp/github\n        - name: GITHUB_REPO\n          value: https://github.com/ibm-cloud-architecture/refarch-kc.git\n        - name: BRANCH\n          value: master\n        - name: REPO_NAME\n          value: refarch-kc\n        - name: ITGTESTS_LOCATION\n          value: itg-tests/es-it\n        - name: ORDER_CMD_MS\n          value: order-command-ms:9080\n        - name: ORDER_QUERY_MS\n          value: order-query-ms:9080\n        - name: CONTAINER_SPRING_MS\n          value: spring-container-ms:8080\n        - name: VOYAGE_MS\n          value: voyages-ms:3000\n        - name: ITGTESTS_ORDERS_TOPIC\n          valueFrom:\n            configMapKeyRef:\n              name: kafka-topics\n              key: ordersTopic\n        - name: ITGTESTS_ORDER_COMMANDS_TOPIC\n          valueFrom:\n            configMapKeyRef:\n              name: kafka-topics\n              key: orderCommandsTopic\n        - name: ITGTESTS_CONTAINERS_TOPIC\n          valueFrom:\n            configMapKeyRef:\n              name: kafka-topics\n              key: containersTopic\n        - name: ITGTESTS_CONTAINER_ANOMALY_RETRY_TOPIC\n          valueFrom:\n            configMapKeyRef:\n              name: kafka-topics\n              key: containerAnomalyRetryTopic\n        - name: ITGTESTS_CONTAINER_ANOMALY_DEAD_TOPIC\n          valueFrom:\n            configMapKeyRef:\n              name: kafka-topics\n              key: containerAnomalyDeadTopic\n        volumeMounts:\n        - mountPath: /tmp/certs\n          name: eventstreams-pem-file\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: eventstreams-pem-file\n        secret:\n          secretName: kafka-truststore-pem\n          optional: true\n      securityContext:\n        runAsNonRoot: true\n      restartPolicy: OnFailure\n",
    "errors": []
  },
  {
    "id": "03209",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: reefer-itgtests-job\nspec:\n  template:\n    metadata:\n      name: reefer-itgtests-job\n    spec:\n      containers:\n      - name: ibmcase-python\n        image: quay.io/ibmcase/kcontainer-python:itgtests\n        imagePullPolicy: Always\n        command:\n        - /bin/bash\n        - -c\n        - \"# Obfuscate KAFKA_PASSWORD\\nif [ \\\"`echo -n ${KAFKA_PASSWORD} | wc -c`\\\"\\\n          \\ -gt 3 ]; then\\n  FIRST_CH=${KAFKA_PASSWORD:0:1}\\n  LAST_CH=${KAFKA_PASSWORD:\\\n          \\ -1}\\n  OBFUSCATED_PASSWORD=\\\"${FIRST_CH}*****${LAST_CH}\\\"\\nelse\\n  OBFUSCATED_PASSWORD=\\\"\\\n          *******\\\"\\nfi\\n\\necho \\\"-----------------------------------------------------------------\\\"\\\n          \\necho \\\"-- Reefer Container Shipment EDA application Integration Tests\\\n          \\ --\\\"\\necho \\\"-----------------------------------------------------------------\\\"\\\n          \\necho\\necho \\\"Executing integrations tests from branch $BRANCH of $GITHUB_REPO\\\"\\\n          \\necho \\\"Kafka Brokers: $KAFKA_BROKERS\\\"\\necho \\\"Kafka Security protocol:\\\n          \\ $SECURITY_PROTOCOL\\\"\\necho \\\"Kafka SASL mechanism: $SASL_MECHANISM\\\"\\n\\\n          echo \\\"Kafka user: $KAFKA_USER\\\"\\necho \\\"Kafka password: $OBFUSCATED_PASSWORD\\\"\\\n          \\necho \\\"Orders topic name: $ITGTESTS_ORDERS_TOPIC\\\"\\necho \\\"Order Command\\\n          \\ topic name: $ITGTESTS_ORDER_COMMANDS_TOPIC\\\"\\necho \\\"Containers topic\\\n          \\ name: $ITGTESTS_CONTAINERS_TOPIC\\\"\\necho \\\"------------------------------------------------------------------\\\"\\\n          \\necho\\n\\n# Check important environments variables are properly set\\nif\\\n          \\ [ -z \\\"$KAFKA_BROKERS\\\" ]; then\\n  echo \\\"[ERROR] - KAFKA_BROKERS environment\\\n          \\ variable must be set.\\\"\\n  exit 1\\nfi\\n\\n# Check that a Kafka user and\\\n          \\ password are provided if there is authentication set up\\nif [ \\\"$SECURITY_PROTOCOL\\\"\\\n          \\ == \\\"SASL_PLAINTEXT\\\" ] || [ \\\"$SECURITY_PROTOCOL\\\" == \\\"SASL_SSL\\\" ];\\\n          \\ then\\n  if [ -z \\\"$KAFKA_USER\\\" ]; then\\n    echo \\\"[ERROR] - A Kafka\\\n          \\ user was not provided.\\\"\\n    exit 1\\n  fi\\n  if [ -z \\\"$KAFKA_PASSWORD\\\"\\\n          \\ ]; then\\n    echo \\\"[ERROR] - A Kafka password was not provided.\\\"\\n \\\n          \\   exit 1\\n  fi\\nfi\\n\\n# Ideally, we would check here if SECURITY_PROTOCOL\\\n          \\ is SSL or SASL_SSL which are the two security protocols that use SSL certs.\\n\\\n          # However, IBM Event Streams on IBM Cloud uses SASL_SSL but there is no\\\n          \\ need for a certificate.\\n# Hence, we can only warn that\\nif [ \\\"$SECURITY_PROTOCOL\\\"\\\n          \\ == \\\"SSL\\\" ] || [ \\\"$SECURITY_PROTOCOL\\\" == \\\"SASL_SSL\\\" ]; then\\n  if\\\n          \\ [ ! -f \\\"$PEM_CERT\\\" ]; then\\n    echo \\\"[WARNING] - A PEM certificate\\\n          \\ could not be found. This might be necessary to establish the appropriate\\\n          \\ secured communication to the Kafka cluster.\\\"\\n    echo \\\"[WARNING] -\\\n          \\ If it is needed, make sure you have created a Kubernetes Secret named\\\n          \\ 'kafka-truststore-pem' with the PEM certificate\\\"\\n    echo \\\"[WARNING]\\\n          \\ - as referenced in the Integration Tests YAML file.\\\"\\n  fi\\nfi\\n\\n# Creating\\\n          \\ the working directory\\nmkdir ${WORKING_DIR} && cd ${WORKING_DIR}\\n\\n#\\\n          \\ Clone the repository where the integration tests to be executed are and\\\n          \\ checkout the specific branch\\ngit clone ${GITHUB_REPO} && cd ${REPO_NAME}\\\n          \\ && if [ \\\"master\\\" != \\\"${BRANCH}\\\" ]; then git checkout ${BRANCH}; fi\\n\\\n          \\n# Get into the location for the integration tests\\ncd ${ITGTESTS_LOCATION}\\n\\\n          \\n# Execute the integration tests\\n\\n# Create the tests reporting file\\n\\\n          touch /tmp/results.txt\\n\\nexport PYTHONPATH=${PYTHONPATH}:${WORKING_DIR}/${REPO_NAME}/itg-tests\\n\\\n          \\necho '******************************************'\\necho '******************************************'\\n\\\n          echo '**********   E2E Happy Path   ************'\\necho '******************************************'\\n\\\n          echo '******************************************'\\n\\npython -u E2EHappyPath.py\\\n          \\ && source /tmp/E2EHappyPath.properties\\n\\necho '******************************************'\\n\\\n          echo '******************************************'\\necho '*********   Saga\\\n          \\ No Container   **********'\\necho '******************************************'\\n\\\n          echo '******************************************'\\n\\npython -u Saga_NoContainer.py\\n\\\n          \\necho '******************************************'\\necho '******************************************'\\n\\\n          echo '**********   Saga No Voyage   ************'\\necho '******************************************'\\n\\\n          echo '******************************************'\\n\\npython -u Saga_NoVoyage.py\\\n          \\ && source /tmp/SagaNoVoyage.properties\\n\\necho '******************************************'\\n\\\n          echo '******************************************'\\necho '**********   Order\\\n          \\ Cancelled   ***********'\\necho '******************************************'\\n\\\n          echo '******************************************'\\n\\npython -u OrderCancellation.py\\n\\\n          \\necho '******************************************'\\necho '******************************************'\\n\\\n          echo '*********   Container Anomaly   **********'\\necho '******************************************'\\n\\\n          echo '******************************************'\\n\\npython -u ContainerAnomaly.py\\n\\\n          \\necho '****************************************************'\\necho '****************************************************'\\n\\\n          echo '*********   Retry and Dead Letter Queue   **********'\\necho '****************************************************'\\n\\\n          echo '****************************************************'\\n\\npython -u\\\n          \\ ContainerAnomalyDlq.py\\n\\necho\\necho 'END RESULTS:'\\necho\\ncat /tmp/results.txt\\n\\\n          \\necho \\\"---------\\\"\\necho \\\"-- END --\\\"\\necho \\\"---------\\\"\\n\"\n        env:\n        - name: KAFKA_BROKERS\n          valueFrom:\n            configMapKeyRef:\n              name: kafka-brokers\n              key: brokers\n        - name: KAFKA_USER\n          valueFrom:\n            secretKeyRef:\n              name: kafka-credentials\n              key: username\n              optional: true\n        - name: KAFKA_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: kafka-credentials\n              key: password\n              optional: true\n        - name: PEM_CERT\n          value: /tmp/certs/kafka-cert.pem\n        - name: SASL_MECHANISM\n          value: PLAIN\n        - name: SECURITY_PROTOCOL\n          value: SASL_SSL\n        - name: WORKING_DIR\n          value: /tmp/github\n        - name: GITHUB_REPO\n          value: https://github.com/ibm-cloud-architecture/refarch-kc.git\n        - name: BRANCH\n          value: master\n        - name: REPO_NAME\n          value: refarch-kc\n        - name: ITGTESTS_LOCATION\n          value: itg-tests/es-it\n        - name: ORDER_CMD_MS\n          value: order-command-ms:9080\n        - name: ORDER_QUERY_MS\n          value: order-query-ms:9080\n        - name: CONTAINER_SPRING_MS\n          value: spring-container-ms:8080\n        - name: VOYAGE_MS\n          value: voyages-ms:3000\n        - name: ITGTESTS_ORDERS_TOPIC\n          valueFrom:\n            configMapKeyRef:\n              name: kafka-topics\n              key: ordersTopic\n        - name: ITGTESTS_ORDER_COMMANDS_TOPIC\n          valueFrom:\n            configMapKeyRef:\n              name: kafka-topics\n              key: orderCommandsTopic\n        - name: ITGTESTS_CONTAINERS_TOPIC\n          valueFrom:\n            configMapKeyRef:\n              name: kafka-topics\n              key: containersTopic\n        - name: ITGTESTS_CONTAINER_ANOMALY_RETRY_TOPIC\n          valueFrom:\n            configMapKeyRef:\n              name: kafka-topics\n              key: containerAnomalyRetryTopic\n        - name: ITGTESTS_CONTAINER_ANOMALY_DEAD_TOPIC\n          valueFrom:\n            configMapKeyRef:\n              name: kafka-topics\n              key: containerAnomalyDeadTopic\n        volumeMounts:\n        - mountPath: /tmp/certs\n          name: eventstreams-pem-file\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: eventstreams-pem-file\n        secret:\n          secretName: kafka-truststore-pem\n          optional: true\n      restartPolicy: OnFailure\n",
    "errors": []
  },
  {
    "id": "03210",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: reefer-itgtests-job\nspec:\n  template:\n    metadata:\n      name: reefer-itgtests-job\n    spec:\n      containers:\n      - name: ibmcase-python\n        image: quay.io/ibmcase/kcontainer-python:itgtests\n        imagePullPolicy: Always\n        command:\n        - /bin/bash\n        - -c\n        - \"# Obfuscate KAFKA_PASSWORD\\nif [ \\\"`echo -n ${KAFKA_PASSWORD} | wc -c`\\\"\\\n          \\ -gt 3 ]; then\\n  FIRST_CH=${KAFKA_PASSWORD:0:1}\\n  LAST_CH=${KAFKA_PASSWORD:\\\n          \\ -1}\\n  OBFUSCATED_PASSWORD=\\\"${FIRST_CH}*****${LAST_CH}\\\"\\nelse\\n  OBFUSCATED_PASSWORD=\\\"\\\n          *******\\\"\\nfi\\n\\necho \\\"-----------------------------------------------------------------\\\"\\\n          \\necho \\\"-- Reefer Container Shipment EDA application Integration Tests\\\n          \\ --\\\"\\necho \\\"-----------------------------------------------------------------\\\"\\\n          \\necho\\necho \\\"Executing integrations tests from branch $BRANCH of $GITHUB_REPO\\\"\\\n          \\necho \\\"Kafka Brokers: $KAFKA_BROKERS\\\"\\necho \\\"Kafka Security protocol:\\\n          \\ $SECURITY_PROTOCOL\\\"\\necho \\\"Kafka SASL mechanism: $SASL_MECHANISM\\\"\\n\\\n          echo \\\"Kafka user: $KAFKA_USER\\\"\\necho \\\"Kafka password: $OBFUSCATED_PASSWORD\\\"\\\n          \\necho \\\"Orders topic name: $ITGTESTS_ORDERS_TOPIC\\\"\\necho \\\"Order Command\\\n          \\ topic name: $ITGTESTS_ORDER_COMMANDS_TOPIC\\\"\\necho \\\"Containers topic\\\n          \\ name: $ITGTESTS_CONTAINERS_TOPIC\\\"\\necho \\\"------------------------------------------------------------------\\\"\\\n          \\necho\\n\\n# Check important environments variables are properly set\\nif\\\n          \\ [ -z \\\"$KAFKA_BROKERS\\\" ]; then\\n  echo \\\"[ERROR] - KAFKA_BROKERS environment\\\n          \\ variable must be set.\\\"\\n  exit 1\\nfi\\n\\n# Check that a Kafka user and\\\n          \\ password are provided if there is authentication set up\\nif [ \\\"$SECURITY_PROTOCOL\\\"\\\n          \\ == \\\"SASL_PLAINTEXT\\\" ] || [ \\\"$SECURITY_PROTOCOL\\\" == \\\"SASL_SSL\\\" ];\\\n          \\ then\\n  if [ -z \\\"$KAFKA_USER\\\" ]; then\\n    echo \\\"[ERROR] - A Kafka\\\n          \\ user was not provided.\\\"\\n    exit 1\\n  fi\\n  if [ -z \\\"$KAFKA_PASSWORD\\\"\\\n          \\ ]; then\\n    echo \\\"[ERROR] - A Kafka password was not provided.\\\"\\n \\\n          \\   exit 1\\n  fi\\nfi\\n\\n# Ideally, we would check here if SECURITY_PROTOCOL\\\n          \\ is SSL or SASL_SSL which are the two security protocols that use SSL certs.\\n\\\n          # However, IBM Event Streams on IBM Cloud uses SASL_SSL but there is no\\\n          \\ need for a certificate.\\n# Hence, we can only warn that\\nif [ \\\"$SECURITY_PROTOCOL\\\"\\\n          \\ == \\\"SSL\\\" ] || [ \\\"$SECURITY_PROTOCOL\\\" == \\\"SASL_SSL\\\" ]; then\\n  if\\\n          \\ [ ! -f \\\"$PEM_CERT\\\" ]; then\\n    echo \\\"[WARNING] - A PEM certificate\\\n          \\ could not be found. This might be necessary to establish the appropriate\\\n          \\ secured communication to the Kafka cluster.\\\"\\n    echo \\\"[WARNING] -\\\n          \\ If it is needed, make sure you have created a Kubernetes Secret named\\\n          \\ 'kafka-truststore-pem' with the PEM certificate\\\"\\n    echo \\\"[WARNING]\\\n          \\ - as referenced in the Integration Tests YAML file.\\\"\\n  fi\\nfi\\n\\n# Creating\\\n          \\ the working directory\\nmkdir ${WORKING_DIR} && cd ${WORKING_DIR}\\n\\n#\\\n          \\ Clone the repository where the integration tests to be executed are and\\\n          \\ checkout the specific branch\\ngit clone ${GITHUB_REPO} && cd ${REPO_NAME}\\\n          \\ && if [ \\\"master\\\" != \\\"${BRANCH}\\\" ]; then git checkout ${BRANCH}; fi\\n\\\n          \\n# Get into the location for the integration tests\\ncd ${ITGTESTS_LOCATION}\\n\\\n          \\n# Execute the integration tests\\n\\n# Create the tests reporting file\\n\\\n          touch /tmp/results.txt\\n\\nexport PYTHONPATH=${PYTHONPATH}:${WORKING_DIR}/${REPO_NAME}/itg-tests\\n\\\n          \\necho '******************************************'\\necho '******************************************'\\n\\\n          echo '**********   E2E Happy Path   ************'\\necho '******************************************'\\n\\\n          echo '******************************************'\\n\\npython -u E2EHappyPath.py\\\n          \\ && source /tmp/E2EHappyPath.properties\\n\\necho '******************************************'\\n\\\n          echo '******************************************'\\necho '*********   Saga\\\n          \\ No Container   **********'\\necho '******************************************'\\n\\\n          echo '******************************************'\\n\\npython -u Saga_NoContainer.py\\n\\\n          \\necho '******************************************'\\necho '******************************************'\\n\\\n          echo '**********   Saga No Voyage   ************'\\necho '******************************************'\\n\\\n          echo '******************************************'\\n\\npython -u Saga_NoVoyage.py\\\n          \\ && source /tmp/SagaNoVoyage.properties\\n\\necho '******************************************'\\n\\\n          echo '******************************************'\\necho '**********   Order\\\n          \\ Cancelled   ***********'\\necho '******************************************'\\n\\\n          echo '******************************************'\\n\\npython -u OrderCancellation.py\\n\\\n          \\necho '******************************************'\\necho '******************************************'\\n\\\n          echo '*********   Container Anomaly   **********'\\necho '******************************************'\\n\\\n          echo '******************************************'\\n\\npython -u ContainerAnomaly.py\\n\\\n          \\necho '****************************************************'\\necho '****************************************************'\\n\\\n          echo '*********   Retry and Dead Letter Queue   **********'\\necho '****************************************************'\\n\\\n          echo '****************************************************'\\n\\npython -u\\\n          \\ ContainerAnomalyDlq.py\\n\\necho\\necho 'END RESULTS:'\\necho\\ncat /tmp/results.txt\\n\\\n          \\necho \\\"---------\\\"\\necho \\\"-- END --\\\"\\necho \\\"---------\\\"\\n\"\n        env:\n        - name: KAFKA_BROKERS\n          valueFrom:\n            configMapKeyRef:\n              name: kafka-brokers\n              key: brokers\n        - name: KAFKA_USER\n          valueFrom:\n            secretKeyRef:\n              name: kafka-credentials\n              key: username\n              optional: true\n        - name: KAFKA_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: kafka-credentials\n              key: password\n              optional: true\n        - name: PEM_CERT\n          value: /tmp/certs/kafka-cert.pem\n        - name: SASL_MECHANISM\n          value: PLAIN\n        - name: SECURITY_PROTOCOL\n          value: SASL_SSL\n        - name: WORKING_DIR\n          value: /tmp/github\n        - name: GITHUB_REPO\n          value: https://github.com/ibm-cloud-architecture/refarch-kc.git\n        - name: BRANCH\n          value: master\n        - name: REPO_NAME\n          value: refarch-kc\n        - name: ITGTESTS_LOCATION\n          value: itg-tests/es-it\n        - name: ORDER_CMD_MS\n          value: order-command-ms:9080\n        - name: ORDER_QUERY_MS\n          value: order-query-ms:9080\n        - name: CONTAINER_SPRING_MS\n          value: spring-container-ms:8080\n        - name: VOYAGE_MS\n          value: voyages-ms:3000\n        - name: ITGTESTS_ORDERS_TOPIC\n          valueFrom:\n            configMapKeyRef:\n              name: kafka-topics\n              key: ordersTopic\n        - name: ITGTESTS_ORDER_COMMANDS_TOPIC\n          valueFrom:\n            configMapKeyRef:\n              name: kafka-topics\n              key: orderCommandsTopic\n        - name: ITGTESTS_CONTAINERS_TOPIC\n          valueFrom:\n            configMapKeyRef:\n              name: kafka-topics\n              key: containersTopic\n        - name: ITGTESTS_CONTAINER_ANOMALY_RETRY_TOPIC\n          valueFrom:\n            configMapKeyRef:\n              name: kafka-topics\n              key: containerAnomalyRetryTopic\n        - name: ITGTESTS_CONTAINER_ANOMALY_DEAD_TOPIC\n          valueFrom:\n            configMapKeyRef:\n              name: kafka-topics\n              key: containerAnomalyDeadTopic\n        volumeMounts:\n        - mountPath: /tmp/certs\n          name: eventstreams-pem-file\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: eventstreams-pem-file\n        secret:\n          secretName: kafka-truststore-pem\n          optional: true\n      restartPolicy: OnFailure\n",
    "errors": []
  },
  {
    "id": "03211",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: ReplicaSet\nmetadata:\n  name: portal-noticias-replicaset\nspec:\n  template:\n    metadata:\n      name: portal-de-noticias\n      labels:\n        app: portal-noticias\n    spec:\n      containers:\n      - name: portal-conainer\n        image: aluracursos/portal-noticias:1\n        ports:\n        - containerPort: 80\n        envFrom:\n        - configMapRef:\n            name: portal-configmap\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n  replicas: 3\n  selector:\n    matchLabels:\n      app: portal-noticias\n",
    "errors": []
  },
  {
    "id": "03212",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: ReplicaSet\nmetadata:\n  name: portal-noticias-replicaset\nspec:\n  template:\n    metadata:\n      name: portal-de-noticias\n      labels:\n        app: portal-noticias\n    spec:\n      containers:\n      - name: portal-conainer\n        image: aluracursos/portal-noticias:1\n        ports:\n        - containerPort: 80\n        envFrom:\n        - configMapRef:\n            name: portal-configmap\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      securityContext:\n        runAsNonRoot: true\n  replicas: 3\n  selector:\n    matchLabels:\n      app: portal-noticias\n",
    "errors": []
  },
  {
    "id": "03213",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: ReplicaSet\nmetadata:\n  name: portal-noticias-replicaset\nspec:\n  template:\n    metadata:\n      name: portal-de-noticias\n      labels:\n        app: portal-noticias\n    spec:\n      containers:\n      - name: portal-conainer\n        image: aluracursos/portal-noticias:1\n        ports:\n        - containerPort: 80\n        envFrom:\n        - configMapRef:\n            name: portal-configmap\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n  replicas: 3\n  selector:\n    matchLabels:\n      app: portal-noticias\n",
    "errors": []
  },
  {
    "id": "03214",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: ReplicaSet\nmetadata:\n  name: portal-noticias-replicaset\nspec:\n  template:\n    metadata:\n      name: portal-de-noticias\n      labels:\n        app: portal-noticias\n    spec:\n      containers:\n      - name: portal-conainer\n        image: aluracursos/portal-noticias:1\n        ports:\n        - containerPort: 80\n        envFrom:\n        - configMapRef:\n            name: portal-configmap\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n  replicas: 3\n  selector:\n    matchLabels:\n      app: portal-noticias\n",
    "errors": []
  },
  {
    "id": "03215",
    "policy_id": "read_only_root_fs",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed: Error from server (BadRequest): error when creating \"STDIN\": Deployment in version \"v1\" cannot be handled as a Deployment: strict decoding error: unknown field \"spec.template.spec.securityContext.allowPrivilegeEscalation\""
    ]
  },
  {
    "id": "03216",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: jenkins\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: jenkins\n  template:\n    metadata:\n      labels:\n        app: jenkins\n    spec:\n      securityContext:\n        runAsUser: 1000\n        fsGroup: 1000\n      containers:\n      - name: jenkins\n        image: jenkins/jenkins:lts\n        ports:\n        - name: http-port\n          containerPort: 8080\n        - name: jnlp-port\n          containerPort: 50000\n        volumeMounts:\n        - name: jenkins-storage\n          mountPath: /var/jenkins_home\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: jenkins-storage\n        persistentVolumeClaim:\n          claimName: jenkins-pvc\n",
    "errors": []
  },
  {
    "id": "03217",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: jenkins\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: jenkins\n  template:\n    metadata:\n      labels:\n        app: jenkins\n    spec:\n      securityContext:\n        runAsUser: 0\n        fsGroup: 0\n      containers:\n      - name: jenkins\n        image: jenkins/jenkins:lts\n        ports:\n        - name: http-port\n          containerPort: 8080\n        - name: jnlp-port\n          containerPort: 50000\n        volumeMounts:\n        - name: jenkins-storage\n          mountPath: /var/jenkins_home\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: jenkins-storage\n        persistentVolumeClaim:\n          claimName: jenkins-pvc\n",
    "errors": []
  },
  {
    "id": "03218",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: jenkins\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: jenkins\n  template:\n    metadata:\n      labels:\n        app: jenkins\n    spec:\n      securityContext:\n        runAsUser: 0\n        fsGroup: 0\n      containers:\n      - name: jenkins\n        image: jenkins/jenkins:lts\n        ports:\n        - name: http-port\n          containerPort: 8080\n        - name: jnlp-port\n          containerPort: 50000\n        volumeMounts:\n        - name: jenkins-storage\n          mountPath: /var/jenkins_home\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: jenkins-storage\n        persistentVolumeClaim:\n          claimName: jenkins-pvc\n",
    "errors": []
  },
  {
    "id": "03219",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: updateservice-operator\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: updateservice-operator\n  template:\n    metadata:\n      labels:\n        name: updateservice-operator\n    spec:\n      serviceAccountName: updateservice-operator\n      containers:\n      - name: updateservice-operator\n        image: controller:stable\n        imagePullPolicy: Always\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: OPERATOR_NAME\n          value: updateservice-operator\n        - name: RELATED_IMAGE_OPERAND\n          value: quay.io/cincinnati/cincinnati:v1.0.0\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "03220",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: updateservice-operator\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: updateservice-operator\n  template:\n    metadata:\n      labels:\n        name: updateservice-operator\n    spec:\n      serviceAccountName: updateservice-operator\n      containers:\n      - name: updateservice-operator\n        image: controller:stable\n        imagePullPolicy: Always\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: OPERATOR_NAME\n          value: updateservice-operator\n        - name: RELATED_IMAGE_OPERAND\n          value: quay.io/cincinnati/cincinnati:latest\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      securityContext:\n        seccompProfile:\n          type: RuntimeDefault\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "03221",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: updateservice-operator\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: updateservice-operator\n  template:\n    metadata:\n      labels:\n        name: updateservice-operator\n    spec:\n      serviceAccountName: updateservice-operator\n      containers:\n      - name: updateservice-operator\n        image: controller:stable\n        imagePullPolicy: Always\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: OPERATOR_NAME\n          value: updateservice-operator\n        - name: RELATED_IMAGE_OPERAND\n          value: quay.io/cincinnati/cincinnati:latest\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "03222",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: updateservice-operator\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: updateservice-operator\n  template:\n    metadata:\n      labels:\n        name: updateservice-operator\n    spec:\n      serviceAccountName: updateservice-operator\n      containers:\n      - name: updateservice-operator\n        image: controller:stable\n        imagePullPolicy: Always\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: OPERATOR_NAME\n          value: updateservice-operator\n        - name: RELATED_IMAGE_OPERAND\n          value: quay.io/cincinnati/cincinnati:latest\n        resources:\n          limits:\n            cpu: 500m\n            memory: 256Mi\n          requests:\n            cpu: 100m\n            memory: 128Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "03223",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: updateservice-operator\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: updateservice-operator\n  template:\n    metadata:\n      labels:\n        name: updateservice-operator\n    spec:\n      serviceAccountName: updateservice-operator\n      containers:\n      - name: updateservice-operator\n        image: controller:stable\n        imagePullPolicy: Always\n        env:\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: OPERATOR_NAME\n          value: updateservice-operator\n        - name: RELATED_IMAGE_OPERAND\n          value: quay.io/cincinnati/cincinnati:latest\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "03224",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: pbft-keys\nspec:\n  template:\n    spec:\n      containers:\n      - name: pbft-keys-generator\n        image: hyperledger/sawtooth-shell:stable\n        command:\n        - bash\n        args:\n        - -c\n        - 'for i in {0..4}; do sawadm keygen -q pbft${i}; done && cd /etc/sawtooth/keys/\n          && grep '''' * | sed ''s/\\.//'' | sed ''s/:/: /'''\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      restartPolicy: OnFailure\n",
    "errors": []
  },
  {
    "id": "03225",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: pbft-keys\nspec:\n  template:\n    spec:\n      containers:\n      - name: pbft-keys-generator\n        image: hyperledger/sawtooth-shell:stable\n        command:\n        - bash\n        args:\n        - -c\n        - 'for i in {0..4}; do sawadm keygen -q pbft${i}; done && cd /etc/sawtooth/keys/\n          && grep '''' * | sed ''s/\\.//'' | sed ''s/:/: /'''\n        workingDir: /etc/sawtooth/keys\n        volumeMounts:\n        - mountPath: /etc/sawtooth/keys\n          name: sawtooth-keys\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      securityContext:\n        seccompProfile:\n          type: RuntimeDefault\n      volumes:\n      - name: sawtooth-keys\n        emptyDir: {}\n      restartPolicy: OnFailure\n",
    "errors": []
  },
  {
    "id": "03226",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: pbft-keys\nspec:\n  template:\n    spec:\n      containers:\n      - name: pbft-keys-generator\n        image: hyperledger/sawtooth-shell:stable\n        command:\n        - bash\n        args:\n        - -c\n        - 'for i in {0..4}; do sawadm keygen -q pbft${i}; done && cd /etc/sawtooth/keys/\n          && grep '''' * | sed ''s/\\.//'' | sed ''s/:/: /'''\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      securityContext:\n        runAsNonRoot: true\n      restartPolicy: OnFailure\n",
    "errors": []
  },
  {
    "id": "03227",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: pbft-keys\nspec:\n  template:\n    spec:\n      containers:\n      - name: pbft-keys-generator\n        image: hyperledger/sawtooth-shell:stable\n        command:\n        - bash\n        args:\n        - -c\n        - 'for i in {0..4}; do sawadm keygen -q pbft${i}; done && cd /etc/sawtooth/keys/\n          && grep '''' * | sed ''s/\\.//'' | sed ''s/:/: /'''\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      restartPolicy: OnFailure\n",
    "errors": []
  },
  {
    "id": "03228",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: pbft-keys\nspec:\n  template:\n    spec:\n      containers:\n      - name: pbft-keys-generator\n        image: hyperledger/sawtooth-shell:stable\n        command:\n        - bash\n        args:\n        - -c\n        - 'for i in {0..4}; do sawadm keygen -q pbft${i}; done && cd /etc/sawtooth/keys/\n          && grep '''' * | sed ''s/\\.//'' | sed ''s/:/: /'''\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      restartPolicy: OnFailure\n",
    "errors": []
  },
  {
    "id": "03229",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: nfs-server\nspec:\n  replicas: 1\n  selector:\n    role: nfs-server\n  template:\n    metadata:\n      labels:\n        role: nfs-server\n    spec:\n      containers:\n      - name: nfs-server\n        image: gcr.io/google_containers/volume-nfs:0.8\n        ports:\n        - name: nfs\n          containerPort: 2049\n        - name: mountd\n          containerPort: 20048\n        - name: rpcbind\n          containerPort: 111\n        securityContext:\n          privileged: false\n          readOnlyRootFilesystem: true\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n        volumeMounts:\n        - mountPath: /exports\n          name: nfs-export-fast\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: nfs-export-fast\n        persistentVolumeClaim:\n          claimName: nfs-server-pvc-fast\n",
    "errors": []
  },
  {
    "id": "03230",
    "policy_id": "drop_capabilities",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: nfs-server\nspec:\n  replicas: 1\n  selector:\n    role: nfs-server\n  template:\n    metadata:\n      labels:\n        role: nfs-server\n    spec:\n      containers:\n      - name: nfs-server\n        image: gcr.io/google_containers/volume-nfs:0.8\n        ports:\n        - name: nfs\n          containerPort: 2049\n        - name: mountd\n          containerPort: 20048\n        - name: rpcbind\n          containerPort: 111\n        securityContext:\n          privileged: false\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n        volumeMounts:\n        - mountPath: /exports\n          name: nfs-export-fast\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: nfs-export-fast\n        persistentVolumeClaim:\n          claimName: nfs-server-pvc-fast\n",
    "errors": []
  },
  {
    "id": "03231",
    "policy_id": "no_privileged",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: nfs-server\nspec:\n  replicas: 1\n  selector:\n    role: nfs-server\n  template:\n    metadata:\n      labels:\n        role: nfs-server\n    spec:\n      containers:\n      - name: nfs-server\n        image: gcr.io/google_containers/volume-nfs:0.8\n        ports:\n        - name: nfs\n          containerPort: 2049\n        - name: mountd\n          containerPort: 20048\n        - name: rpcbind\n          containerPort: 111\n        securityContext:\n          privileged: false\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          seccompProfile:\n            type: RuntimeDefault\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n        volumeMounts:\n        - mountPath: /exports\n          name: nfs-export-fast\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: nfs-export-fast\n        persistentVolumeClaim:\n          claimName: nfs-server-pvc-fast\n",
    "errors": []
  },
  {
    "id": "03232",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: nfs-server\nspec:\n  replicas: 1\n  selector:\n    role: nfs-server\n  template:\n    metadata:\n      labels:\n        role: nfs-server\n    spec:\n      containers:\n      - name: nfs-server\n        image: gcr.io/google_containers/volume-nfs:0.8\n        ports:\n        - name: nfs\n          containerPort: 2049\n        - name: mountd\n          containerPort: 20048\n        - name: rpcbind\n          containerPort: 111\n        securityContext:\n          privileged: false\n          runAsNonRoot: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /exports\n          name: nfs-export-fast\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: nfs-export-fast\n        persistentVolumeClaim:\n          claimName: nfs-server-pvc-fast\n",
    "errors": []
  },
  {
    "id": "03233",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: nfs-server\nspec:\n  replicas: 1\n  selector:\n    role: nfs-server\n  template:\n    metadata:\n      labels:\n        role: nfs-server\n    spec:\n      containers:\n      - name: nfs-server\n        image: gcr.io/google_containers/volume-nfs:0.8\n        ports:\n        - name: nfs\n          containerPort: 2049\n        - name: mountd\n          containerPort: 20048\n        - name: rpcbind\n          containerPort: 111\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /exports\n          name: nfs-export-fast\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: nfs-export-fast\n        persistentVolumeClaim:\n          claimName: nfs-server-pvc-fast\n",
    "errors": []
  },
  {
    "id": "03234",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: nfs-server\nspec:\n  replicas: 1\n  selector:\n    role: nfs-server\n  template:\n    metadata:\n      labels:\n        role: nfs-server\n    spec:\n      containers:\n      - name: nfs-server\n        image: gcr.io/google_containers/volume-nfs:0.8\n        ports:\n        - name: nfs\n          containerPort: 2049\n        - name: mountd\n          containerPort: 20048\n        - name: rpcbind\n          containerPort: 111\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /exports\n          name: nfs-export-fast\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: nfs-export-fast\n        persistentVolumeClaim:\n          claimName: nfs-server-pvc-fast\n",
    "errors": []
  },
  {
    "id": "03235",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: intel-fpga-webhook-deployment\n  labels:\n    app: intel-fpga-webhook\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: intel-fpga-webhook\n  template:\n    metadata:\n      labels:\n        app: intel-fpga-webhook\n    spec:\n      containers:\n      - name: fpga-mutator\n        image: intel/intel-fpga-admissionwebhook:devel\n        imagePullPolicy: IfNotPresent\n        ports:\n        - containerPort: 8443\n          name: webhook-api\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 3210\n          runAsGroup: 3210\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        args:\n        - -tls-cert-file=/etc/webhook/certs/cert.pem\n        - -tls-private-key-file=/etc/webhook/certs/key.pem\n        - -mode=preprogrammed\n        - -v=1\n        volumeMounts:\n        - name: webhook-certs\n          mountPath: /etc/webhook/certs\n          readOnly: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: webhook-certs\n        secret:\n          secretName: intel-fpga-webhook-certs\n",
    "errors": []
  },
  {
    "id": "03236",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: intel-fpga-webhook-deployment\n  labels:\n    app: intel-fpga-webhook\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: intel-fpga-webhook\n  template:\n    metadata:\n      labels:\n        app: intel-fpga-webhook\n    spec:\n      containers:\n      - name: fpga-mutator\n        image: intel/intel-fpga-admissionwebhook:devel\n        imagePullPolicy: IfNotPresent\n        ports:\n        - containerPort: 8443\n          name: webhook-api\n        securityContext:\n          runAsNonRoot: true\n          runAsUser: 3210\n          runAsGroup: 3210\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        args:\n        - -tls-cert-file=/etc/webhook/certs/cert.pem\n        - -tls-private-key-file=/etc/webhook/certs/key.pem\n        - -mode=preprogrammed\n        - -v=1\n        volumeMounts:\n        - name: webhook-certs\n          mountPath: /etc/webhook/certs\n          readOnly: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: webhook-certs\n        secret:\n          secretName: intel-fpga-webhook-certs\n",
    "errors": []
  },
  {
    "id": "03237",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: cyborg-seeder-qualifiers-nrfin00033\n  labels:\n    type: cyborg-seeder\nspec:\n  volumes:\n  - name: cyborg-results\n    persistentVolumeClaim:\n      claimName: cyborg-results\n  containers:\n  - name: cyborg-seeder-qualifiers-nrfin00033\n    image: zardus/research:cyborg-generator\n    command:\n    - /bin/bash\n    - -c\n    - python /home/angr/cyborg-generator/kubernetes_seeder.py qualifiers NRFIN_00033\n      3600 6\n    imagePullPolicy: Always\n    volumeMounts:\n    - name: cyborg-results\n      mountPath: /results\n    resources:\n      limits:\n        cpu: 500m\n        memory: 10Gi\n      requests:\n        cpu: 100m\n        memory: 10Gi\n    securityContext:\n      readOnlyRootFilesystem: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "03238",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: cyborg-seeder-qualifiers-nrfin00033\n  labels:\n    type: cyborg-seeder\nspec:\n  volumes:\n  - name: cyborg-results\n    persistentVolumeClaim:\n      claimName: cyborg-results\n  containers:\n  - name: cyborg-seeder-qualifiers-nrfin00033\n    image: zardus/research:cyborg-generator\n    command:\n    - /bin/bash\n    - -c\n    - python /home/angr/cyborg-generator/kubernetes_seeder.py qualifiers NRFIN_00033\n      3600 6\n    imagePullPolicy: Always\n    volumeMounts:\n    - name: cyborg-results\n      mountPath: /results\n    resources:\n      limits:\n        cpu: 500m\n        memory: 10Gi\n      requests:\n        cpu: 100m\n        memory: 10Gi\n    securityContext:\n      runAsNonRoot: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "03239",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-1000\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    securityContext:\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      privileged: false\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n      readOnlyRootFilesystem: true\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "03240",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-1000\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    securityContext:\n      readOnlyRootFilesystem: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n",
    "errors": []
  }
]