[
  {
    "id": "01081",
    "manifest_path": "data/manifests/the_stack_sample/sample_0280.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: director\n  namespace: dataleague\n  labels:\n    app: director\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: director\n  template:\n    metadata:\n      labels:\n        app: director\n      annotations:\n        timestamp: '{{ .Values.timestamp }}'\n    spec:\n      initContainers:\n      - name: wait-nakama-grpc-api\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz nakama.dataleague.svc.cluster.local 7349; do echo \"Waiting\n          for Nakama gRPC API\"; sleep 2; done;\n      - name: wait-open-match-backend\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz open-match-backend.open-match.svc.cluster.local 50505; do echo\n          \"Waiting for OM backend\"; sleep 2; done;\n      - name: wait-om-function\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz matchfunction.dataleague.svc.cluster.local 50502; do echo \"Waiting\n          for OM function\"; sleep 2; done;\n      containers:\n      - name: director\n        image: '{{- .Values.openmatch.director.image -}}'\n        imagePullPolicy: Always\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"director\" is using an invalid container image, \"{{- .Values.openmatch.director.image -}}\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "01082",
    "manifest_path": "data/manifests/the_stack_sample/sample_0280.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: director\n  namespace: dataleague\n  labels:\n    app: director\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: director\n  template:\n    metadata:\n      labels:\n        app: director\n      annotations:\n        timestamp: '{{ .Values.timestamp }}'\n    spec:\n      initContainers:\n      - name: wait-nakama-grpc-api\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz nakama.dataleague.svc.cluster.local 7349; do echo \"Waiting\n          for Nakama gRPC API\"; sleep 2; done;\n      - name: wait-open-match-backend\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz open-match-backend.open-match.svc.cluster.local 50505; do echo\n          \"Waiting for OM backend\"; sleep 2; done;\n      - name: wait-om-function\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz matchfunction.dataleague.svc.cluster.local 50502; do echo \"Waiting\n          for OM function\"; sleep 2; done;\n      containers:\n      - name: director\n        image: '{{- .Values.openmatch.director.image -}}'\n        imagePullPolicy: Always\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"wait-nakama-grpc-api\" is using an invalid container image, \"busybox:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "01083",
    "manifest_path": "data/manifests/the_stack_sample/sample_0280.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: director\n  namespace: dataleague\n  labels:\n    app: director\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: director\n  template:\n    metadata:\n      labels:\n        app: director\n      annotations:\n        timestamp: '{{ .Values.timestamp }}'\n    spec:\n      initContainers:\n      - name: wait-nakama-grpc-api\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz nakama.dataleague.svc.cluster.local 7349; do echo \"Waiting\n          for Nakama gRPC API\"; sleep 2; done;\n      - name: wait-open-match-backend\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz open-match-backend.open-match.svc.cluster.local 50505; do echo\n          \"Waiting for OM backend\"; sleep 2; done;\n      - name: wait-om-function\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz matchfunction.dataleague.svc.cluster.local 50502; do echo \"Waiting\n          for OM function\"; sleep 2; done;\n      containers:\n      - name: director\n        image: '{{- .Values.openmatch.director.image -}}'\n        imagePullPolicy: Always\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"wait-om-function\" is using an invalid container image, \"busybox:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "01084",
    "manifest_path": "data/manifests/the_stack_sample/sample_0280.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: director\n  namespace: dataleague\n  labels:\n    app: director\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: director\n  template:\n    metadata:\n      labels:\n        app: director\n      annotations:\n        timestamp: '{{ .Values.timestamp }}'\n    spec:\n      initContainers:\n      - name: wait-nakama-grpc-api\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz nakama.dataleague.svc.cluster.local 7349; do echo \"Waiting\n          for Nakama gRPC API\"; sleep 2; done;\n      - name: wait-open-match-backend\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz open-match-backend.open-match.svc.cluster.local 50505; do echo\n          \"Waiting for OM backend\"; sleep 2; done;\n      - name: wait-om-function\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz matchfunction.dataleague.svc.cluster.local 50502; do echo \"Waiting\n          for OM function\"; sleep 2; done;\n      containers:\n      - name: director\n        image: '{{- .Values.openmatch.director.image -}}'\n        imagePullPolicy: Always\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"wait-open-match-backend\" is using an invalid container image, \"busybox:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "01085",
    "manifest_path": "data/manifests/the_stack_sample/sample_0280.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: director\n  namespace: dataleague\n  labels:\n    app: director\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: director\n  template:\n    metadata:\n      labels:\n        app: director\n      annotations:\n        timestamp: '{{ .Values.timestamp }}'\n    spec:\n      initContainers:\n      - name: wait-nakama-grpc-api\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz nakama.dataleague.svc.cluster.local 7349; do echo \"Waiting\n          for Nakama gRPC API\"; sleep 2; done;\n      - name: wait-open-match-backend\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz open-match-backend.open-match.svc.cluster.local 50505; do echo\n          \"Waiting for OM backend\"; sleep 2; done;\n      - name: wait-om-function\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz matchfunction.dataleague.svc.cluster.local 50502; do echo \"Waiting\n          for OM function\"; sleep 2; done;\n      containers:\n      - name: director\n        image: '{{- .Values.openmatch.director.image -}}'\n        imagePullPolicy: Always\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"director\" does not have a read-only root file system"
  },
  {
    "id": "01086",
    "manifest_path": "data/manifests/the_stack_sample/sample_0280.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: director\n  namespace: dataleague\n  labels:\n    app: director\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: director\n  template:\n    metadata:\n      labels:\n        app: director\n      annotations:\n        timestamp: '{{ .Values.timestamp }}'\n    spec:\n      initContainers:\n      - name: wait-nakama-grpc-api\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz nakama.dataleague.svc.cluster.local 7349; do echo \"Waiting\n          for Nakama gRPC API\"; sleep 2; done;\n      - name: wait-open-match-backend\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz open-match-backend.open-match.svc.cluster.local 50505; do echo\n          \"Waiting for OM backend\"; sleep 2; done;\n      - name: wait-om-function\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz matchfunction.dataleague.svc.cluster.local 50502; do echo \"Waiting\n          for OM function\"; sleep 2; done;\n      containers:\n      - name: director\n        image: '{{- .Values.openmatch.director.image -}}'\n        imagePullPolicy: Always\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"wait-nakama-grpc-api\" does not have a read-only root file system"
  },
  {
    "id": "01087",
    "manifest_path": "data/manifests/the_stack_sample/sample_0280.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: director\n  namespace: dataleague\n  labels:\n    app: director\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: director\n  template:\n    metadata:\n      labels:\n        app: director\n      annotations:\n        timestamp: '{{ .Values.timestamp }}'\n    spec:\n      initContainers:\n      - name: wait-nakama-grpc-api\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz nakama.dataleague.svc.cluster.local 7349; do echo \"Waiting\n          for Nakama gRPC API\"; sleep 2; done;\n      - name: wait-open-match-backend\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz open-match-backend.open-match.svc.cluster.local 50505; do echo\n          \"Waiting for OM backend\"; sleep 2; done;\n      - name: wait-om-function\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz matchfunction.dataleague.svc.cluster.local 50502; do echo \"Waiting\n          for OM function\"; sleep 2; done;\n      containers:\n      - name: director\n        image: '{{- .Values.openmatch.director.image -}}'\n        imagePullPolicy: Always\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"wait-om-function\" does not have a read-only root file system"
  },
  {
    "id": "01088",
    "manifest_path": "data/manifests/the_stack_sample/sample_0280.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: director\n  namespace: dataleague\n  labels:\n    app: director\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: director\n  template:\n    metadata:\n      labels:\n        app: director\n      annotations:\n        timestamp: '{{ .Values.timestamp }}'\n    spec:\n      initContainers:\n      - name: wait-nakama-grpc-api\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz nakama.dataleague.svc.cluster.local 7349; do echo \"Waiting\n          for Nakama gRPC API\"; sleep 2; done;\n      - name: wait-open-match-backend\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz open-match-backend.open-match.svc.cluster.local 50505; do echo\n          \"Waiting for OM backend\"; sleep 2; done;\n      - name: wait-om-function\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz matchfunction.dataleague.svc.cluster.local 50502; do echo \"Waiting\n          for OM function\"; sleep 2; done;\n      containers:\n      - name: director\n        image: '{{- .Values.openmatch.director.image -}}'\n        imagePullPolicy: Always\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"wait-open-match-backend\" does not have a read-only root file system"
  },
  {
    "id": "01089",
    "manifest_path": "data/manifests/the_stack_sample/sample_0280.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: director\n  namespace: dataleague\n  labels:\n    app: director\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: director\n  template:\n    metadata:\n      labels:\n        app: director\n      annotations:\n        timestamp: '{{ .Values.timestamp }}'\n    spec:\n      initContainers:\n      - name: wait-nakama-grpc-api\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz nakama.dataleague.svc.cluster.local 7349; do echo \"Waiting\n          for Nakama gRPC API\"; sleep 2; done;\n      - name: wait-open-match-backend\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz open-match-backend.open-match.svc.cluster.local 50505; do echo\n          \"Waiting for OM backend\"; sleep 2; done;\n      - name: wait-om-function\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz matchfunction.dataleague.svc.cluster.local 50502; do echo \"Waiting\n          for OM function\"; sleep 2; done;\n      containers:\n      - name: director\n        image: '{{- .Values.openmatch.director.image -}}'\n        imagePullPolicy: Always\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"director\" is not set to runAsNonRoot"
  },
  {
    "id": "01090",
    "manifest_path": "data/manifests/the_stack_sample/sample_0280.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: director\n  namespace: dataleague\n  labels:\n    app: director\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: director\n  template:\n    metadata:\n      labels:\n        app: director\n      annotations:\n        timestamp: '{{ .Values.timestamp }}'\n    spec:\n      initContainers:\n      - name: wait-nakama-grpc-api\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz nakama.dataleague.svc.cluster.local 7349; do echo \"Waiting\n          for Nakama gRPC API\"; sleep 2; done;\n      - name: wait-open-match-backend\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz open-match-backend.open-match.svc.cluster.local 50505; do echo\n          \"Waiting for OM backend\"; sleep 2; done;\n      - name: wait-om-function\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz matchfunction.dataleague.svc.cluster.local 50502; do echo \"Waiting\n          for OM function\"; sleep 2; done;\n      containers:\n      - name: director\n        image: '{{- .Values.openmatch.director.image -}}'\n        imagePullPolicy: Always\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"wait-nakama-grpc-api\" is not set to runAsNonRoot"
  },
  {
    "id": "01091",
    "manifest_path": "data/manifests/the_stack_sample/sample_0280.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: director\n  namespace: dataleague\n  labels:\n    app: director\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: director\n  template:\n    metadata:\n      labels:\n        app: director\n      annotations:\n        timestamp: '{{ .Values.timestamp }}'\n    spec:\n      initContainers:\n      - name: wait-nakama-grpc-api\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz nakama.dataleague.svc.cluster.local 7349; do echo \"Waiting\n          for Nakama gRPC API\"; sleep 2; done;\n      - name: wait-open-match-backend\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz open-match-backend.open-match.svc.cluster.local 50505; do echo\n          \"Waiting for OM backend\"; sleep 2; done;\n      - name: wait-om-function\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz matchfunction.dataleague.svc.cluster.local 50502; do echo \"Waiting\n          for OM function\"; sleep 2; done;\n      containers:\n      - name: director\n        image: '{{- .Values.openmatch.director.image -}}'\n        imagePullPolicy: Always\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"wait-om-function\" is not set to runAsNonRoot"
  },
  {
    "id": "01092",
    "manifest_path": "data/manifests/the_stack_sample/sample_0280.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: director\n  namespace: dataleague\n  labels:\n    app: director\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: director\n  template:\n    metadata:\n      labels:\n        app: director\n      annotations:\n        timestamp: '{{ .Values.timestamp }}'\n    spec:\n      initContainers:\n      - name: wait-nakama-grpc-api\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz nakama.dataleague.svc.cluster.local 7349; do echo \"Waiting\n          for Nakama gRPC API\"; sleep 2; done;\n      - name: wait-open-match-backend\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz open-match-backend.open-match.svc.cluster.local 50505; do echo\n          \"Waiting for OM backend\"; sleep 2; done;\n      - name: wait-om-function\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz matchfunction.dataleague.svc.cluster.local 50502; do echo \"Waiting\n          for OM function\"; sleep 2; done;\n      containers:\n      - name: director\n        image: '{{- .Values.openmatch.director.image -}}'\n        imagePullPolicy: Always\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"wait-open-match-backend\" is not set to runAsNonRoot"
  },
  {
    "id": "01093",
    "manifest_path": "data/manifests/the_stack_sample/sample_0280.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: director\n  namespace: dataleague\n  labels:\n    app: director\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: director\n  template:\n    metadata:\n      labels:\n        app: director\n      annotations:\n        timestamp: '{{ .Values.timestamp }}'\n    spec:\n      initContainers:\n      - name: wait-nakama-grpc-api\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz nakama.dataleague.svc.cluster.local 7349; do echo \"Waiting\n          for Nakama gRPC API\"; sleep 2; done;\n      - name: wait-open-match-backend\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz open-match-backend.open-match.svc.cluster.local 50505; do echo\n          \"Waiting for OM backend\"; sleep 2; done;\n      - name: wait-om-function\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz matchfunction.dataleague.svc.cluster.local 50502; do echo \"Waiting\n          for OM function\"; sleep 2; done;\n      containers:\n      - name: director\n        image: '{{- .Values.openmatch.director.image -}}'\n        imagePullPolicy: Always\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"director\" has cpu request 0"
  },
  {
    "id": "01094",
    "manifest_path": "data/manifests/the_stack_sample/sample_0280.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: director\n  namespace: dataleague\n  labels:\n    app: director\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: director\n  template:\n    metadata:\n      labels:\n        app: director\n      annotations:\n        timestamp: '{{ .Values.timestamp }}'\n    spec:\n      initContainers:\n      - name: wait-nakama-grpc-api\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz nakama.dataleague.svc.cluster.local 7349; do echo \"Waiting\n          for Nakama gRPC API\"; sleep 2; done;\n      - name: wait-open-match-backend\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz open-match-backend.open-match.svc.cluster.local 50505; do echo\n          \"Waiting for OM backend\"; sleep 2; done;\n      - name: wait-om-function\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz matchfunction.dataleague.svc.cluster.local 50502; do echo \"Waiting\n          for OM function\"; sleep 2; done;\n      containers:\n      - name: director\n        image: '{{- .Values.openmatch.director.image -}}'\n        imagePullPolicy: Always\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"wait-nakama-grpc-api\" has cpu request 0"
  },
  {
    "id": "01095",
    "manifest_path": "data/manifests/the_stack_sample/sample_0280.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: director\n  namespace: dataleague\n  labels:\n    app: director\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: director\n  template:\n    metadata:\n      labels:\n        app: director\n      annotations:\n        timestamp: '{{ .Values.timestamp }}'\n    spec:\n      initContainers:\n      - name: wait-nakama-grpc-api\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz nakama.dataleague.svc.cluster.local 7349; do echo \"Waiting\n          for Nakama gRPC API\"; sleep 2; done;\n      - name: wait-open-match-backend\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz open-match-backend.open-match.svc.cluster.local 50505; do echo\n          \"Waiting for OM backend\"; sleep 2; done;\n      - name: wait-om-function\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz matchfunction.dataleague.svc.cluster.local 50502; do echo \"Waiting\n          for OM function\"; sleep 2; done;\n      containers:\n      - name: director\n        image: '{{- .Values.openmatch.director.image -}}'\n        imagePullPolicy: Always\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"wait-om-function\" has cpu request 0"
  },
  {
    "id": "01096",
    "manifest_path": "data/manifests/the_stack_sample/sample_0280.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: director\n  namespace: dataleague\n  labels:\n    app: director\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: director\n  template:\n    metadata:\n      labels:\n        app: director\n      annotations:\n        timestamp: '{{ .Values.timestamp }}'\n    spec:\n      initContainers:\n      - name: wait-nakama-grpc-api\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz nakama.dataleague.svc.cluster.local 7349; do echo \"Waiting\n          for Nakama gRPC API\"; sleep 2; done;\n      - name: wait-open-match-backend\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz open-match-backend.open-match.svc.cluster.local 50505; do echo\n          \"Waiting for OM backend\"; sleep 2; done;\n      - name: wait-om-function\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz matchfunction.dataleague.svc.cluster.local 50502; do echo \"Waiting\n          for OM function\"; sleep 2; done;\n      containers:\n      - name: director\n        image: '{{- .Values.openmatch.director.image -}}'\n        imagePullPolicy: Always\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"wait-open-match-backend\" has cpu request 0"
  },
  {
    "id": "01097",
    "manifest_path": "data/manifests/the_stack_sample/sample_0280.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: director\n  namespace: dataleague\n  labels:\n    app: director\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: director\n  template:\n    metadata:\n      labels:\n        app: director\n      annotations:\n        timestamp: '{{ .Values.timestamp }}'\n    spec:\n      initContainers:\n      - name: wait-nakama-grpc-api\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz nakama.dataleague.svc.cluster.local 7349; do echo \"Waiting\n          for Nakama gRPC API\"; sleep 2; done;\n      - name: wait-open-match-backend\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz open-match-backend.open-match.svc.cluster.local 50505; do echo\n          \"Waiting for OM backend\"; sleep 2; done;\n      - name: wait-om-function\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz matchfunction.dataleague.svc.cluster.local 50502; do echo \"Waiting\n          for OM function\"; sleep 2; done;\n      containers:\n      - name: director\n        image: '{{- .Values.openmatch.director.image -}}'\n        imagePullPolicy: Always\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"director\" has memory limit 0"
  },
  {
    "id": "01098",
    "manifest_path": "data/manifests/the_stack_sample/sample_0280.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: director\n  namespace: dataleague\n  labels:\n    app: director\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: director\n  template:\n    metadata:\n      labels:\n        app: director\n      annotations:\n        timestamp: '{{ .Values.timestamp }}'\n    spec:\n      initContainers:\n      - name: wait-nakama-grpc-api\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz nakama.dataleague.svc.cluster.local 7349; do echo \"Waiting\n          for Nakama gRPC API\"; sleep 2; done;\n      - name: wait-open-match-backend\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz open-match-backend.open-match.svc.cluster.local 50505; do echo\n          \"Waiting for OM backend\"; sleep 2; done;\n      - name: wait-om-function\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz matchfunction.dataleague.svc.cluster.local 50502; do echo \"Waiting\n          for OM function\"; sleep 2; done;\n      containers:\n      - name: director\n        image: '{{- .Values.openmatch.director.image -}}'\n        imagePullPolicy: Always\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"wait-nakama-grpc-api\" has memory limit 0"
  },
  {
    "id": "01099",
    "manifest_path": "data/manifests/the_stack_sample/sample_0280.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: director\n  namespace: dataleague\n  labels:\n    app: director\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: director\n  template:\n    metadata:\n      labels:\n        app: director\n      annotations:\n        timestamp: '{{ .Values.timestamp }}'\n    spec:\n      initContainers:\n      - name: wait-nakama-grpc-api\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz nakama.dataleague.svc.cluster.local 7349; do echo \"Waiting\n          for Nakama gRPC API\"; sleep 2; done;\n      - name: wait-open-match-backend\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz open-match-backend.open-match.svc.cluster.local 50505; do echo\n          \"Waiting for OM backend\"; sleep 2; done;\n      - name: wait-om-function\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz matchfunction.dataleague.svc.cluster.local 50502; do echo \"Waiting\n          for OM function\"; sleep 2; done;\n      containers:\n      - name: director\n        image: '{{- .Values.openmatch.director.image -}}'\n        imagePullPolicy: Always\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"wait-om-function\" has memory limit 0"
  },
  {
    "id": "01100",
    "manifest_path": "data/manifests/the_stack_sample/sample_0280.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: director\n  namespace: dataleague\n  labels:\n    app: director\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: director\n  template:\n    metadata:\n      labels:\n        app: director\n      annotations:\n        timestamp: '{{ .Values.timestamp }}'\n    spec:\n      initContainers:\n      - name: wait-nakama-grpc-api\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz nakama.dataleague.svc.cluster.local 7349; do echo \"Waiting\n          for Nakama gRPC API\"; sleep 2; done;\n      - name: wait-open-match-backend\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz open-match-backend.open-match.svc.cluster.local 50505; do echo\n          \"Waiting for OM backend\"; sleep 2; done;\n      - name: wait-om-function\n        image: busybox:latest\n        command:\n        - sh\n        - -c\n        - until nc -vz matchfunction.dataleague.svc.cluster.local 50502; do echo \"Waiting\n          for OM function\"; sleep 2; done;\n      containers:\n      - name: director\n        image: '{{- .Values.openmatch.director.image -}}'\n        imagePullPolicy: Always\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"wait-open-match-backend\" has memory limit 0"
  },
  {
    "id": "01101",
    "manifest_path": "data/manifests/the_stack_sample/sample_0284.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: blossom-reposter-staging\n  name: instagram-producer\n  labels:\n    app: instagram-producer\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: instagram-producer\n  template:\n    metadata:\n      labels:\n        app: instagram-producer\n    spec:\n      containers:\n      - name: instagram-producer\n        image: docker.pkg.github.com/wmw9/blossom-reposter/instagram-producer:latest\n        imagePullPolicy: Always\n        ports:\n        - containerPort: 80\n        envFrom:\n        - configMapRef:\n            name: blossom-reposter-config\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"instagram-producer\" is using an invalid container image, \"docker.pkg.github.com/wmw9/blossom-reposter/instagram-producer:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "01102",
    "manifest_path": "data/manifests/the_stack_sample/sample_0284.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: blossom-reposter-staging\n  name: instagram-producer\n  labels:\n    app: instagram-producer\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: instagram-producer\n  template:\n    metadata:\n      labels:\n        app: instagram-producer\n    spec:\n      containers:\n      - name: instagram-producer\n        image: docker.pkg.github.com/wmw9/blossom-reposter/instagram-producer:latest\n        imagePullPolicy: Always\n        ports:\n        - containerPort: 80\n        envFrom:\n        - configMapRef:\n            name: blossom-reposter-config\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"instagram-producer\" does not have a read-only root file system"
  },
  {
    "id": "01103",
    "manifest_path": "data/manifests/the_stack_sample/sample_0284.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: blossom-reposter-staging\n  name: instagram-producer\n  labels:\n    app: instagram-producer\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: instagram-producer\n  template:\n    metadata:\n      labels:\n        app: instagram-producer\n    spec:\n      containers:\n      - name: instagram-producer\n        image: docker.pkg.github.com/wmw9/blossom-reposter/instagram-producer:latest\n        imagePullPolicy: Always\n        ports:\n        - containerPort: 80\n        envFrom:\n        - configMapRef:\n            name: blossom-reposter-config\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"instagram-producer\" is not set to runAsNonRoot"
  },
  {
    "id": "01104",
    "manifest_path": "data/manifests/the_stack_sample/sample_0284.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: blossom-reposter-staging\n  name: instagram-producer\n  labels:\n    app: instagram-producer\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: instagram-producer\n  template:\n    metadata:\n      labels:\n        app: instagram-producer\n    spec:\n      containers:\n      - name: instagram-producer\n        image: docker.pkg.github.com/wmw9/blossom-reposter/instagram-producer:latest\n        imagePullPolicy: Always\n        ports:\n        - containerPort: 80\n        envFrom:\n        - configMapRef:\n            name: blossom-reposter-config\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"instagram-producer\" has cpu request 0"
  },
  {
    "id": "01105",
    "manifest_path": "data/manifests/the_stack_sample/sample_0284.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: blossom-reposter-staging\n  name: instagram-producer\n  labels:\n    app: instagram-producer\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: instagram-producer\n  template:\n    metadata:\n      labels:\n        app: instagram-producer\n    spec:\n      containers:\n      - name: instagram-producer\n        image: docker.pkg.github.com/wmw9/blossom-reposter/instagram-producer:latest\n        imagePullPolicy: Always\n        ports:\n        - containerPort: 80\n        envFrom:\n        - configMapRef:\n            name: blossom-reposter-config\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"instagram-producer\" has memory limit 0"
  },
  {
    "id": "01106",
    "manifest_path": "data/manifests/the_stack_sample/sample_0287.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: ttcs-agent\n  labels:\n    app: ttcs-agent\nspec:\n  selector:\n    matchLabels:\n      app: ttcs-agent\n  template:\n    metadata:\n      labels:\n        app: ttcs-agent\n    spec:\n      containers:\n      - name: ttcs-agent\n        image: gcr.io/canvas-diagram-295814/ttcs-agent-image:latest\n        ports:\n        - containerPort: 6171\n        securityContext:\n          privileged: true\n        env:\n        - name: FLAGS_subscription_mode\n          value: 'true'\n        - name: FLAGS_coordinator_address\n          value: c-jb7399-264b.gcp.ticktocknetworks.com\n        - name: FLAGS_coordinator_subscription_service_port\n          value: '6176'\n        - name: FLAGS_probe_port\n          value: '3190'\n        - name: FLAGS_correct_clock\n          value: 'true'\n        - name: FLAGS_management_address\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: FLAGS_probe_address\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: FLAGS_agent_name\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"ttcs-agent\" is using an invalid container image, \"gcr.io/canvas-diagram-295814/ttcs-agent-image:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "01107",
    "manifest_path": "data/manifests/the_stack_sample/sample_0287.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: ttcs-agent\n  labels:\n    app: ttcs-agent\nspec:\n  selector:\n    matchLabels:\n      app: ttcs-agent\n  template:\n    metadata:\n      labels:\n        app: ttcs-agent\n    spec:\n      containers:\n      - name: ttcs-agent\n        image: gcr.io/canvas-diagram-295814/ttcs-agent-image:latest\n        ports:\n        - containerPort: 6171\n        securityContext:\n          privileged: true\n        env:\n        - name: FLAGS_subscription_mode\n          value: 'true'\n        - name: FLAGS_coordinator_address\n          value: c-jb7399-264b.gcp.ticktocknetworks.com\n        - name: FLAGS_coordinator_subscription_service_port\n          value: '6176'\n        - name: FLAGS_probe_port\n          value: '3190'\n        - name: FLAGS_correct_clock\n          value: 'true'\n        - name: FLAGS_management_address\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: FLAGS_probe_address\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: FLAGS_agent_name\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"ttcs-agent\" does not have a read-only root file system"
  },
  {
    "id": "01108",
    "manifest_path": "data/manifests/the_stack_sample/sample_0287.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: ttcs-agent\n  labels:\n    app: ttcs-agent\nspec:\n  selector:\n    matchLabels:\n      app: ttcs-agent\n  template:\n    metadata:\n      labels:\n        app: ttcs-agent\n    spec:\n      containers:\n      - name: ttcs-agent\n        image: gcr.io/canvas-diagram-295814/ttcs-agent-image:latest\n        ports:\n        - containerPort: 6171\n        securityContext:\n          privileged: true\n        env:\n        - name: FLAGS_subscription_mode\n          value: 'true'\n        - name: FLAGS_coordinator_address\n          value: c-jb7399-264b.gcp.ticktocknetworks.com\n        - name: FLAGS_coordinator_subscription_service_port\n          value: '6176'\n        - name: FLAGS_probe_port\n          value: '3190'\n        - name: FLAGS_correct_clock\n          value: 'true'\n        - name: FLAGS_management_address\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: FLAGS_probe_address\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: FLAGS_agent_name\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n",
    "policy_id": "privilege-escalation-container",
    "violation_text": "container \"ttcs-agent\" is Privileged hence allows privilege escalation."
  },
  {
    "id": "01109",
    "manifest_path": "data/manifests/the_stack_sample/sample_0287.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: ttcs-agent\n  labels:\n    app: ttcs-agent\nspec:\n  selector:\n    matchLabels:\n      app: ttcs-agent\n  template:\n    metadata:\n      labels:\n        app: ttcs-agent\n    spec:\n      containers:\n      - name: ttcs-agent\n        image: gcr.io/canvas-diagram-295814/ttcs-agent-image:latest\n        ports:\n        - containerPort: 6171\n        securityContext:\n          privileged: true\n        env:\n        - name: FLAGS_subscription_mode\n          value: 'true'\n        - name: FLAGS_coordinator_address\n          value: c-jb7399-264b.gcp.ticktocknetworks.com\n        - name: FLAGS_coordinator_subscription_service_port\n          value: '6176'\n        - name: FLAGS_probe_port\n          value: '3190'\n        - name: FLAGS_correct_clock\n          value: 'true'\n        - name: FLAGS_management_address\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: FLAGS_probe_address\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: FLAGS_agent_name\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n",
    "policy_id": "privileged-container",
    "violation_text": "container \"ttcs-agent\" is privileged"
  },
  {
    "id": "01110",
    "manifest_path": "data/manifests/the_stack_sample/sample_0287.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: ttcs-agent\n  labels:\n    app: ttcs-agent\nspec:\n  selector:\n    matchLabels:\n      app: ttcs-agent\n  template:\n    metadata:\n      labels:\n        app: ttcs-agent\n    spec:\n      containers:\n      - name: ttcs-agent\n        image: gcr.io/canvas-diagram-295814/ttcs-agent-image:latest\n        ports:\n        - containerPort: 6171\n        securityContext:\n          privileged: true\n        env:\n        - name: FLAGS_subscription_mode\n          value: 'true'\n        - name: FLAGS_coordinator_address\n          value: c-jb7399-264b.gcp.ticktocknetworks.com\n        - name: FLAGS_coordinator_subscription_service_port\n          value: '6176'\n        - name: FLAGS_probe_port\n          value: '3190'\n        - name: FLAGS_correct_clock\n          value: 'true'\n        - name: FLAGS_management_address\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: FLAGS_probe_address\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: FLAGS_agent_name\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"ttcs-agent\" is not set to runAsNonRoot"
  },
  {
    "id": "01111",
    "manifest_path": "data/manifests/the_stack_sample/sample_0287.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: ttcs-agent\n  labels:\n    app: ttcs-agent\nspec:\n  selector:\n    matchLabels:\n      app: ttcs-agent\n  template:\n    metadata:\n      labels:\n        app: ttcs-agent\n    spec:\n      containers:\n      - name: ttcs-agent\n        image: gcr.io/canvas-diagram-295814/ttcs-agent-image:latest\n        ports:\n        - containerPort: 6171\n        securityContext:\n          privileged: true\n        env:\n        - name: FLAGS_subscription_mode\n          value: 'true'\n        - name: FLAGS_coordinator_address\n          value: c-jb7399-264b.gcp.ticktocknetworks.com\n        - name: FLAGS_coordinator_subscription_service_port\n          value: '6176'\n        - name: FLAGS_probe_port\n          value: '3190'\n        - name: FLAGS_correct_clock\n          value: 'true'\n        - name: FLAGS_management_address\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: FLAGS_probe_address\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: FLAGS_agent_name\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"ttcs-agent\" has cpu request 0"
  },
  {
    "id": "01112",
    "manifest_path": "data/manifests/the_stack_sample/sample_0287.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: ttcs-agent\n  labels:\n    app: ttcs-agent\nspec:\n  selector:\n    matchLabels:\n      app: ttcs-agent\n  template:\n    metadata:\n      labels:\n        app: ttcs-agent\n    spec:\n      containers:\n      - name: ttcs-agent\n        image: gcr.io/canvas-diagram-295814/ttcs-agent-image:latest\n        ports:\n        - containerPort: 6171\n        securityContext:\n          privileged: true\n        env:\n        - name: FLAGS_subscription_mode\n          value: 'true'\n        - name: FLAGS_coordinator_address\n          value: c-jb7399-264b.gcp.ticktocknetworks.com\n        - name: FLAGS_coordinator_subscription_service_port\n          value: '6176'\n        - name: FLAGS_probe_port\n          value: '3190'\n        - name: FLAGS_correct_clock\n          value: 'true'\n        - name: FLAGS_management_address\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: FLAGS_probe_address\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: FLAGS_agent_name\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"ttcs-agent\" has memory limit 0"
  },
  {
    "id": "01113",
    "manifest_path": "data/manifests/the_stack_sample/sample_0291.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: cli\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: cli\n  template:\n    metadata:\n      labels:\n        app: cli\n    spec:\n      containers:\n      - name: cli\n        image: target/consensource-cli\n        imagePullPolicy: IfNotPresent\n        resources:\n          limits:\n            cpu: 50m\n            memory: 100Mi\n          requests:\n            cpu: 20m\n            memory: 50Mi\n        command:\n        - bash\n        args:\n        - -c\n        - 'tail -f /dev/null\n\n          '\n        volumeMounts:\n        - name: consensource-keys\n          mountPath: /root/.sawtooth\n          readOnly: true\n      volumes:\n      - name: consensource-keys\n        secret:\n          secretName: cli\n          items:\n          - key: sawtooth-pub-key\n            path: keys/root.pub\n          - key: sawtooth-priv-key\n            path: keys/root.priv\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"cli\" is using an invalid container image, \"target/consensource-cli\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "01114",
    "manifest_path": "data/manifests/the_stack_sample/sample_0291.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: cli\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: cli\n  template:\n    metadata:\n      labels:\n        app: cli\n    spec:\n      containers:\n      - name: cli\n        image: target/consensource-cli\n        imagePullPolicy: IfNotPresent\n        resources:\n          limits:\n            cpu: 50m\n            memory: 100Mi\n          requests:\n            cpu: 20m\n            memory: 50Mi\n        command:\n        - bash\n        args:\n        - -c\n        - 'tail -f /dev/null\n\n          '\n        volumeMounts:\n        - name: consensource-keys\n          mountPath: /root/.sawtooth\n          readOnly: true\n      volumes:\n      - name: consensource-keys\n        secret:\n          secretName: cli\n          items:\n          - key: sawtooth-pub-key\n            path: keys/root.pub\n          - key: sawtooth-priv-key\n            path: keys/root.priv\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"cli\" does not have a read-only root file system"
  },
  {
    "id": "01115",
    "manifest_path": "data/manifests/the_stack_sample/sample_0291.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: cli\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: cli\n  template:\n    metadata:\n      labels:\n        app: cli\n    spec:\n      containers:\n      - name: cli\n        image: target/consensource-cli\n        imagePullPolicy: IfNotPresent\n        resources:\n          limits:\n            cpu: 50m\n            memory: 100Mi\n          requests:\n            cpu: 20m\n            memory: 50Mi\n        command:\n        - bash\n        args:\n        - -c\n        - 'tail -f /dev/null\n\n          '\n        volumeMounts:\n        - name: consensource-keys\n          mountPath: /root/.sawtooth\n          readOnly: true\n      volumes:\n      - name: consensource-keys\n        secret:\n          secretName: cli\n          items:\n          - key: sawtooth-pub-key\n            path: keys/root.pub\n          - key: sawtooth-priv-key\n            path: keys/root.priv\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"cli\" is not set to runAsNonRoot"
  },
  {
    "id": "01116",
    "manifest_path": "data/manifests/the_stack_sample/sample_0293.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: keda-olm-operator\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: keda-olm-operator\n  template:\n    metadata:\n      labels:\n        name: keda-olm-operator\n    spec:\n      serviceAccountName: keda-olm-operator\n      containers:\n      - name: keda-olm-operator\n        image: ghcr.io/kedacore/keda-olm-operator:main\n        command:\n        - /manager\n        imagePullPolicy: Always\n        resources:\n          requests:\n            cpu: 100m\n            memory: 100Mi\n          limits:\n            cpu: 500m\n            memory: 500Mi\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 8081\n          initialDelaySeconds: 25\n        readinessProbe:\n          httpGet:\n            path: /readyz\n            port: 8081\n          initialDelaySeconds: 20\n        env:\n        - name: WATCH_NAMESPACE\n          value: ''\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"keda-olm-operator\" does not have a read-only root file system"
  },
  {
    "id": "01117",
    "manifest_path": "data/manifests/the_stack_sample/sample_0293.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: keda-olm-operator\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: keda-olm-operator\n  template:\n    metadata:\n      labels:\n        name: keda-olm-operator\n    spec:\n      serviceAccountName: keda-olm-operator\n      containers:\n      - name: keda-olm-operator\n        image: ghcr.io/kedacore/keda-olm-operator:main\n        command:\n        - /manager\n        imagePullPolicy: Always\n        resources:\n          requests:\n            cpu: 100m\n            memory: 100Mi\n          limits:\n            cpu: 500m\n            memory: 500Mi\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 8081\n          initialDelaySeconds: 25\n        readinessProbe:\n          httpGet:\n            path: /readyz\n            port: 8081\n          initialDelaySeconds: 20\n        env:\n        - name: WATCH_NAMESPACE\n          value: ''\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"keda-olm-operator\" is not set to runAsNonRoot"
  },
  {
    "id": "01118",
    "manifest_path": "data/manifests/the_stack_sample/sample_0297.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: mongodb-datastore-distributor\n  namespace: keptn-datastore\nspec:\n  selector:\n    matchLabels:\n      run: distributor\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        run: distributor\n    spec:\n      containers:\n      - name: distributor\n        image: keptn/distributor:latest\n        ports:\n        - containerPort: 8080\n        resources:\n          requests:\n            memory: 32Mi\n            cpu: 50m\n          limits:\n            memory: 128Mi\n            cpu: 500m\n        env:\n        - name: PUBSUB_IMPL\n          value: nats\n        - name: PUBSUB_URL\n          value: nats://keptn-nats-cluster.keptn.svc.cluster.local\n        - name: PUBSUB_TOPIC\n          value: sh.keptn.>\n        - name: PUBSUB_RECIPIENT\n          value: mongodb-datastore\n        - name: PUBSUB_RECIPIENT_PATH\n          value: /event\n      serviceAccountName: keptn-ds-default\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"distributor\" is using an invalid container image, \"keptn/distributor:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "01119",
    "manifest_path": "data/manifests/the_stack_sample/sample_0297.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: mongodb-datastore-distributor\n  namespace: keptn-datastore\nspec:\n  selector:\n    matchLabels:\n      run: distributor\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        run: distributor\n    spec:\n      containers:\n      - name: distributor\n        image: keptn/distributor:latest\n        ports:\n        - containerPort: 8080\n        resources:\n          requests:\n            memory: 32Mi\n            cpu: 50m\n          limits:\n            memory: 128Mi\n            cpu: 500m\n        env:\n        - name: PUBSUB_IMPL\n          value: nats\n        - name: PUBSUB_URL\n          value: nats://keptn-nats-cluster.keptn.svc.cluster.local\n        - name: PUBSUB_TOPIC\n          value: sh.keptn.>\n        - name: PUBSUB_RECIPIENT\n          value: mongodb-datastore\n        - name: PUBSUB_RECIPIENT_PATH\n          value: /event\n      serviceAccountName: keptn-ds-default\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"distributor\" does not have a read-only root file system"
  },
  {
    "id": "01120",
    "manifest_path": "data/manifests/the_stack_sample/sample_0297.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: mongodb-datastore-distributor\n  namespace: keptn-datastore\nspec:\n  selector:\n    matchLabels:\n      run: distributor\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        run: distributor\n    spec:\n      containers:\n      - name: distributor\n        image: keptn/distributor:latest\n        ports:\n        - containerPort: 8080\n        resources:\n          requests:\n            memory: 32Mi\n            cpu: 50m\n          limits:\n            memory: 128Mi\n            cpu: 500m\n        env:\n        - name: PUBSUB_IMPL\n          value: nats\n        - name: PUBSUB_URL\n          value: nats://keptn-nats-cluster.keptn.svc.cluster.local\n        - name: PUBSUB_TOPIC\n          value: sh.keptn.>\n        - name: PUBSUB_RECIPIENT\n          value: mongodb-datastore\n        - name: PUBSUB_RECIPIENT_PATH\n          value: /event\n      serviceAccountName: keptn-ds-default\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"distributor\" is not set to runAsNonRoot"
  }
]