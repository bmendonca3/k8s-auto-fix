[
  {
    "id": "03321",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: CronJob\nmetadata:\n  name: community-operators-catalog-rollout\n  annotations:\n    target.workload.openshift.io/management: '{\"effect\": \"PreferredDuringScheduling\"}'\nspec:\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          serviceAccountName: catalog-rollout\n          containers:\n          - name: rollout\n            image: CLI_IMAGE:stable\n            imagePullPolicy: IfNotPresent\n            command:\n            - oc\n            - rollout\n            - restart\n            - deployment/community-operators-catalog\n            resources:\n              requests:\n                cpu: 100m\n                memory: 128Mi\n              limits:\n                cpu: 500m\n                memory: 256Mi\n            securityContext:\n              privileged: false\n              capabilities:\n                drop:\n                - NET_RAW\n                - NET_ADMIN\n                - SYS_ADMIN\n                - SYS_MODULE\n                - SYS_PTRACE\n                - SYS_CHROOT\n              allowPrivilegeEscalation: false\n              runAsNonRoot: true\n              readOnlyRootFilesystem: true\n          restartPolicy: OnFailure\n  schedule: 0 0 * * *\n",
    "errors": []
  },
  {
    "id": "03322",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: horologium\n  labels:\n    app: horologium\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: horologium\n  template:\n    metadata:\n      labels:\n        app: horologium\n    spec:\n      serviceAccountName: horologium\n      containers:\n      - name: horologium\n        image: gcr.io/k8s-prow/horologium:v20200619-56de83d071\n        args:\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        - --dry-run=false\n        volumeMounts:\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n",
    "errors": []
  },
  {
    "id": "03323",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: horologium\n  labels:\n    app: horologium\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: horologium\n  template:\n    metadata:\n      labels:\n        app: horologium\n    spec:\n      serviceAccountName: horologium\n      containers:\n      - name: horologium\n        image: gcr.io/k8s-prow/horologium:v20200619-56de83d071\n        args:\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        - --dry-run=false\n        volumeMounts:\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "03324",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: horologium\n  labels:\n    app: horologium\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: horologium\n  template:\n    metadata:\n      labels:\n        app: horologium\n    spec:\n      serviceAccountName: horologium\n      containers:\n      - name: horologium\n        image: gcr.io/k8s-prow/horologium:v20200619-56de83d071\n        args:\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        - --dry-run=false\n        volumeMounts:\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n",
    "errors": []
  },
  {
    "id": "03325",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: horologium\n  labels:\n    app: horologium\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: horologium\n  template:\n    metadata:\n      labels:\n        app: horologium\n    spec:\n      serviceAccountName: horologium\n      containers:\n      - name: horologium\n        image: gcr.io/k8s-prow/horologium:v20200619-56de83d071\n        args:\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        - --dry-run=false\n        volumeMounts:\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n",
    "errors": []
  },
  {
    "id": "03326",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: orders-view-app\n  namespace: default\n  labels:\n    app: orders-view-app\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: orders-view-app\n  template:\n    metadata:\n      labels:\n        app: orders-view-app\n    spec:\n      securityContext:\n        fsGroup: 2000\n      affinity:\n        podAntiAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n          - labelSelector:\n              matchExpressions:\n              - key: app\n                operator: In\n                values:\n                - orders-view-app\n            topologyKey: kubernetes.io/hostname\n      volumes:\n      - name: spring-boot-application-properties\n        secret:\n          secretName: spring-boot-application-properties\n      - name: rocksdb\n        emptyDir: {}\n      containers:\n      - name: orders-view-app\n        image: docker.io/gamussa/livestreams-orders-view-app:stable\n        ports:\n        - containerPort: 8080\n        volumeMounts:\n        - mountPath: /mnt/app\n          name: spring-boot-application-properties\n        - mountPath: /mnt/kafka-streams-store/\n          name: rocksdb\n        env:\n        - name: SPRING_CONFIG_LOCATION\n          value: /mnt/app/application.properties\n        - name: JAVA_TOOL_OPTIONS\n          value: -DLOGLEVEL=INFO\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "03327",
    "policy_id": "read_only_root_fs",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed: The StatefulSet \"orders-view-app\" is invalid: spec.template.spec.containers[0].volumeMounts[1].name: Not found: \"rocksdb\""
    ]
  },
  {
    "id": "03328",
    "policy_id": "run_as_non_root",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed: The StatefulSet \"orders-view-app\" is invalid: spec.template.spec.containers[0].volumeMounts[1].name: Not found: \"rocksdb\""
    ]
  },
  {
    "id": "03329",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed: The StatefulSet \"orders-view-app\" is invalid: spec.template.spec.containers[0].volumeMounts[1].name: Not found: \"rocksdb\""
    ]
  },
  {
    "id": "03330",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed: The StatefulSet \"orders-view-app\" is invalid: spec.template.spec.containers[0].volumeMounts[1].name: Not found: \"rocksdb\""
    ]
  },
  {
    "id": "03331",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: titan-ccp-load-generator\nspec:\n  selector:\n    matchLabels:\n      app: titan-ccp-load-generator\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: titan-ccp-load-generator\n    spec:\n      containers:\n      - name: workload-generator\n        image: workload-generator:stable\n        env:\n        - name: NUM_SENSORS\n          value: '25000'\n        - name: INSTANCES\n          value: '1'\n        - name: NUM_NESTED_GROUPS\n          value: '5'\n        - name: ZK_HOST\n          value: my-confluent-cp-zookeeper\n        - name: ZK_PORT\n          value: '2181'\n        - name: KAFKA_BOOTSTRAP_SERVERS\n          value: my-confluent-cp-kafka:9092\n        - name: SCHEMA_REGISTRY_URL\n          value: http://my-confluent-cp-schema-registry:8081\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "03332",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: titan-ccp-load-generator\nspec:\n  selector:\n    matchLabels:\n      app: titan-ccp-load-generator\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: titan-ccp-load-generator\n    spec:\n      containers:\n      - name: workload-generator\n        image: workload-generator:stable\n        env:\n        - name: NUM_SENSORS\n          value: '25000'\n        - name: INSTANCES\n          value: '1'\n        - name: NUM_NESTED_GROUPS\n          value: '5'\n        - name: ZK_HOST\n          value: my-confluent-cp-zookeeper\n        - name: ZK_PORT\n          value: '2181'\n        - name: KAFKA_BOOTSTRAP_SERVERS\n          value: my-confluent-cp-kafka:9092\n        - name: SCHEMA_REGISTRY_URL\n          value: http://my-confluent-cp-schema-registry:8081\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "03333",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: titan-ccp-load-generator\nspec:\n  selector:\n    matchLabels:\n      app: titan-ccp-load-generator\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: titan-ccp-load-generator\n    spec:\n      containers:\n      - name: workload-generator\n        image: workload-generator:stable\n        env:\n        - name: NUM_SENSORS\n          value: '25000'\n        - name: INSTANCES\n          value: '1'\n        - name: NUM_NESTED_GROUPS\n          value: '5'\n        - name: ZK_HOST\n          value: my-confluent-cp-zookeeper\n        - name: ZK_PORT\n          value: '2181'\n        - name: KAFKA_BOOTSTRAP_SERVERS\n          value: my-confluent-cp-kafka:9092\n        - name: SCHEMA_REGISTRY_URL\n          value: http://my-confluent-cp-schema-registry:8081\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "03334",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: titan-ccp-load-generator\nspec:\n  selector:\n    matchLabels:\n      app: titan-ccp-load-generator\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: titan-ccp-load-generator\n    spec:\n      containers:\n      - name: workload-generator\n        image: workload-generator:stable\n        env:\n        - name: NUM_SENSORS\n          value: '25000'\n        - name: INSTANCES\n          value: '1'\n        - name: NUM_NESTED_GROUPS\n          value: '5'\n        - name: ZK_HOST\n          value: my-confluent-cp-zookeeper\n        - name: ZK_PORT\n          value: '2181'\n        - name: KAFKA_BOOTSTRAP_SERVERS\n          value: my-confluent-cp-kafka:9092\n        - name: SCHEMA_REGISTRY_URL\n          value: http://my-confluent-cp-schema-registry:8081\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "03335",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: titan-ccp-load-generator\nspec:\n  selector:\n    matchLabels:\n      app: titan-ccp-load-generator\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: titan-ccp-load-generator\n    spec:\n      containers:\n      - name: workload-generator\n        image: workload-generator:stable\n        env:\n        - name: NUM_SENSORS\n          value: '25000'\n        - name: INSTANCES\n          value: '1'\n        - name: NUM_NESTED_GROUPS\n          value: '5'\n        - name: ZK_HOST\n          value: my-confluent-cp-zookeeper\n        - name: ZK_PORT\n          value: '2181'\n        - name: KAFKA_BOOTSTRAP_SERVERS\n          value: my-confluent-cp-kafka:9092\n        - name: SCHEMA_REGISTRY_URL\n          value: http://my-confluent-cp-schema-registry:8081\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "03336",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: openvpn-server\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: openvpn-server\n  template:\n    metadata:\n      labels:\n        app: openvpn-server\n    spec:\n      containers:\n      - name: openvpn-server\n        image: quay.io/sjenning/poc:openvpn\n        imagePullPolicy: Always\n        command:\n        - /usr/sbin/openvpn\n        - --config\n        - /etc/openvpn/server/server.conf\n        workingDir: /etc/openvpn/server\n        securityContext:\n          privileged: false\n          readOnlyRootFilesystem: true\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n        volumeMounts:\n        - mountPath: /etc/openvpn/server\n          name: server\n        - mountPath: /etc/openvpn/ccd\n          name: ccd\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - secret:\n          secretName: openvpn-server\n        name: server\n      - secret:\n          secretName: openvpn-ccd\n        name: ccd\n",
    "errors": []
  },
  {
    "id": "03337",
    "policy_id": "drop_capabilities",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: openvpn-server\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: openvpn-server\n  template:\n    metadata:\n      labels:\n        app: openvpn-server\n    spec:\n      containers:\n      - name: openvpn-server\n        image: quay.io/sjenning/poc:openvpn\n        imagePullPolicy: Always\n        command:\n        - /usr/sbin/openvpn\n        - --config\n        - /etc/openvpn/server/server.conf\n        workingDir: /etc/openvpn/server\n        securityContext:\n          privileged: false\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          readOnlyRootFilesystem: true\n          runAsNonRoot: true\n        volumeMounts:\n        - mountPath: /etc/openvpn/server\n          name: server\n        - mountPath: /etc/openvpn/ccd\n          name: ccd\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - secret:\n          secretName: openvpn-server\n        name: server\n      - secret:\n          secretName: openvpn-ccd\n        name: ccd\n",
    "errors": []
  },
  {
    "id": "03338",
    "policy_id": "no_privileged",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: openvpn-server\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: openvpn-server\n  template:\n    metadata:\n      labels:\n        app: openvpn-server\n    spec:\n      containers:\n      - name: openvpn-server\n        image: quay.io/sjenning/poc:openvpn\n        imagePullPolicy: Always\n        command:\n        - /usr/sbin/openvpn\n        - --config\n        - /etc/openvpn/server/server.conf\n        workingDir: /etc/openvpn/server\n        securityContext:\n          privileged: false\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n        volumeMounts:\n        - mountPath: /etc/openvpn/server\n          name: server\n        - mountPath: /etc/openvpn/ccd\n          name: ccd\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - secret:\n          secretName: openvpn-server\n        name: server\n      - secret:\n          secretName: openvpn-ccd\n        name: ccd\n",
    "errors": []
  },
  {
    "id": "03339",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: openvpn-server\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: openvpn-server\n  template:\n    metadata:\n      labels:\n        app: openvpn-server\n    spec:\n      containers:\n      - name: openvpn-server\n        image: quay.io/sjenning/poc:openvpn\n        imagePullPolicy: Always\n        command:\n        - /usr/sbin/openvpn\n        - --config\n        - /etc/openvpn/server/server.conf\n        workingDir: /etc/openvpn/server\n        securityContext:\n          privileged: false\n          runAsNonRoot: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /etc/openvpn/server\n          name: server\n        - mountPath: /etc/openvpn/ccd\n          name: ccd\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - secret:\n          secretName: openvpn-server\n        name: server\n      - secret:\n          secretName: openvpn-ccd\n        name: ccd\n",
    "errors": []
  },
  {
    "id": "03340",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: openvpn-server\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: openvpn-server\n  template:\n    metadata:\n      labels:\n        app: openvpn-server\n    spec:\n      containers:\n      - name: openvpn-server\n        image: quay.io/sjenning/poc:openvpn\n        imagePullPolicy: Always\n        command:\n        - /usr/sbin/openvpn\n        - --config\n        - /etc/openvpn/server/server.conf\n        workingDir: /etc/openvpn/server\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /etc/openvpn/server\n          name: server\n        - mountPath: /etc/openvpn/ccd\n          name: ccd\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - secret:\n          secretName: openvpn-server\n        name: server\n      - secret:\n          secretName: openvpn-ccd\n        name: ccd\n",
    "errors": []
  },
  {
    "id": "03341",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: openvpn-server\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: openvpn-server\n  template:\n    metadata:\n      labels:\n        app: openvpn-server\n    spec:\n      containers:\n      - name: openvpn-server\n        image: quay.io/sjenning/poc:openvpn\n        imagePullPolicy: Always\n        command:\n        - /usr/sbin/openvpn\n        - --config\n        - /etc/openvpn/server/server.conf\n        workingDir: /etc/openvpn/server\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /etc/openvpn/server\n          name: server\n        - mountPath: /etc/openvpn/ccd\n          name: ccd\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - secret:\n          secretName: openvpn-server\n        name: server\n      - secret:\n          secretName: openvpn-ccd\n        name: ccd\n",
    "errors": []
  },
  {
    "id": "03342",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-7631\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    securityContext:\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      privileged: false\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n      readOnlyRootFilesystem: true\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "03343",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-7631\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    securityContext:\n      readOnlyRootFilesystem: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "03344",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-7631\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    securityContext:\n      runAsNonRoot: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      readOnlyRootFilesystem: true\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "03345",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-7631\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    resources:\n      limits:\n        cpu: 500m\n        memory: 256Mi\n      requests:\n        cpu: 100m\n        memory: 128Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n      readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "03346",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-7631\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n      readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "03347",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: CronJob\nmetadata:\n  name: branchprotector\nspec:\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          containers:\n          - name: branchprotector\n            image: gcr.io/k8s-prow/branchprotector:v20180622-df01a7f2b\n            args:\n            - --config-path=/etc/config/config\n            - --job-config-path=/etc/job-config\n            - --github-token-path=/etc/github/oauth\n            - --confirm\n            - --github-endpoint=http://ghproxy\n            - --github-endpoint=https://api.github.com\n            volumeMounts:\n            - name: oauth\n              mountPath: /etc/github\n              readOnly: true\n            - name: config\n              mountPath: /etc/config\n              readOnly: true\n            - name: job-config\n              mountPath: /etc/job-config\n              readOnly: true\n            securityContext:\n              readOnlyRootFilesystem: true\n              privileged: false\n              capabilities:\n                drop:\n                - NET_RAW\n                - NET_ADMIN\n                - SYS_ADMIN\n                - SYS_MODULE\n                - SYS_PTRACE\n                - SYS_CHROOT\n              allowPrivilegeEscalation: false\n              runAsNonRoot: true\n            resources:\n              requests:\n                cpu: 100m\n                memory: 128Mi\n              limits:\n                cpu: 500m\n                memory: 256Mi\n          volumes:\n          - name: oauth\n            secret:\n              secretName: oauth-token\n          - name: config\n            configMap:\n              name: config\n          - name: job-config\n            configMap:\n              name: job-config\n          restartPolicy: OnFailure\n  schedule: 0 0 * * *\n",
    "errors": []
  },
  {
    "id": "03348",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: CronJob\nmetadata:\n  name: branchprotector\nspec:\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          containers:\n          - name: branchprotector\n            image: gcr.io/k8s-prow/branchprotector:v20180622-df01a7f2b\n            args:\n            - --config-path=/etc/config/config\n            - --job-config-path=/etc/job-config\n            - --github-token-path=/etc/github/oauth\n            - --confirm\n            - --github-endpoint=http://ghproxy\n            - --github-endpoint=https://api.github.com\n            volumeMounts:\n            - name: oauth\n              mountPath: /etc/github\n              readOnly: true\n            - name: config\n              mountPath: /etc/config\n              readOnly: true\n            - name: job-config\n              mountPath: /etc/job-config\n              readOnly: true\n            securityContext:\n              runAsNonRoot: true\n              privileged: false\n              capabilities:\n                drop:\n                - NET_RAW\n                - NET_ADMIN\n                - SYS_ADMIN\n                - SYS_MODULE\n                - SYS_PTRACE\n                - SYS_CHROOT\n              allowPrivilegeEscalation: false\n              readOnlyRootFilesystem: true\n            resources:\n              requests:\n                cpu: 100m\n                memory: 128Mi\n              limits:\n                cpu: 500m\n                memory: 256Mi\n          volumes:\n          - name: oauth\n            secret:\n              secretName: oauth-token\n          - name: config\n            configMap:\n              name: config\n          - name: job-config\n            configMap:\n              name: job-config\n          restartPolicy: OnFailure\n  schedule: 0 0 * * *\n",
    "errors": []
  },
  {
    "id": "03349",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: CronJob\nmetadata:\n  name: branchprotector\nspec:\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          containers:\n          - name: branchprotector\n            image: gcr.io/k8s-prow/branchprotector:v20180622-df01a7f2b\n            args:\n            - --config-path=/etc/config/config\n            - --job-config-path=/etc/job-config\n            - --github-token-path=/etc/github/oauth\n            - --confirm\n            - --github-endpoint=http://ghproxy\n            - --github-endpoint=https://api.github.com\n            volumeMounts:\n            - name: oauth\n              mountPath: /etc/github\n              readOnly: true\n            - name: config\n              mountPath: /etc/config\n              readOnly: true\n            - name: job-config\n              mountPath: /etc/job-config\n              readOnly: true\n            resources:\n              requests:\n                cpu: 100m\n                memory: 128Mi\n              limits:\n                cpu: 500m\n                memory: 256Mi\n            securityContext:\n              privileged: false\n              capabilities:\n                drop:\n                - NET_RAW\n                - NET_ADMIN\n                - SYS_ADMIN\n                - SYS_MODULE\n                - SYS_PTRACE\n                - SYS_CHROOT\n              allowPrivilegeEscalation: false\n              runAsNonRoot: true\n              readOnlyRootFilesystem: true\n          volumes:\n          - name: oauth\n            secret:\n              secretName: oauth-token\n          - name: config\n            configMap:\n              name: config\n          - name: job-config\n            configMap:\n              name: job-config\n          restartPolicy: OnFailure\n  schedule: 0 0 * * *\n",
    "errors": []
  },
  {
    "id": "03350",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: CronJob\nmetadata:\n  name: branchprotector\nspec:\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          containers:\n          - name: branchprotector\n            image: gcr.io/k8s-prow/branchprotector:v20180622-df01a7f2b\n            args:\n            - --config-path=/etc/config/config\n            - --job-config-path=/etc/job-config\n            - --github-token-path=/etc/github/oauth\n            - --confirm\n            - --github-endpoint=http://ghproxy\n            - --github-endpoint=https://api.github.com\n            volumeMounts:\n            - name: oauth\n              mountPath: /etc/github\n              readOnly: true\n            - name: config\n              mountPath: /etc/config\n              readOnly: true\n            - name: job-config\n              mountPath: /etc/job-config\n              readOnly: true\n            resources:\n              requests:\n                cpu: 100m\n                memory: 128Mi\n              limits:\n                cpu: 500m\n                memory: 256Mi\n            securityContext:\n              privileged: false\n              capabilities:\n                drop:\n                - NET_RAW\n                - NET_ADMIN\n                - SYS_ADMIN\n                - SYS_MODULE\n                - SYS_PTRACE\n                - SYS_CHROOT\n              allowPrivilegeEscalation: false\n              runAsNonRoot: true\n              readOnlyRootFilesystem: true\n          volumes:\n          - name: oauth\n            secret:\n              secretName: oauth-token\n          - name: config\n            configMap:\n              name: config\n          - name: job-config\n            configMap:\n              name: job-config\n          restartPolicy: OnFailure\n  schedule: 0 0 * * *\n",
    "errors": []
  },
  {
    "id": "03351",
    "policy_id": "env_var_secret",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: CronJob\nmetadata:\n  name: nightly-test-trigger\nspec:\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          containers:\n          - name: trigger\n            env:\n            - name: SINK_URL\n              value: http://el-test-nightly.default.svc.cluster.local:8080\n            - name: TARGET_PROJECT\n              value: operator\n            - name: NAMESPACE\n              value: bastion-p\n            - name: REGISTRY\n              value: ppc64le-cluster.bastion-p.svc.cluster.local:443\n            - name: TARGET_ARCH\n              value: ppc64le\n            - name: REMOTE_SECRET_NAME\n              valueFrom:\n                secretKeyRef:\n                  name: remote-secret-name-secret\n                  key: remote_secret_name\n            securityContext:\n              capabilities:\n                drop:\n                - NET_RAW\n                - NET_ADMIN\n                - SYS_ADMIN\n                - SYS_MODULE\n                - SYS_PTRACE\n                - SYS_CHROOT\n              privileged: false\n              allowPrivilegeEscalation: false\n              runAsNonRoot: true\n              readOnlyRootFilesystem: true\n            image: busybox:stable\n            resources:\n              requests:\n                cpu: 100m\n                memory: 128Mi\n              limits:\n                cpu: 500m\n                memory: 256Mi\n          restartPolicy: OnFailure\n  schedule: 0 0 * * *\n",
    "errors": []
  },
  {
    "id": "03352",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: CronJob\nmetadata:\n  name: nightly-test-trigger\nspec:\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          containers:\n          - name: trigger\n            env:\n            - name: SINK_URL\n              value: http://el-test-nightly.default.svc.cluster.local:8080\n            - name: TARGET_PROJECT\n              value: operator\n            - name: NAMESPACE\n              value: bastion-p\n            - name: REGISTRY\n              value: ppc64le-cluster.bastion-p.svc.cluster.local:443\n            - name: TARGET_ARCH\n              value: ppc64le\n            - name: REMOTE_SECRET_NAME\n              valueFrom:\n                secretKeyRef:\n                  name: remote-secret-name-secret\n                  key: remote_secret_name\n            image: busybox:stable\n            securityContext:\n              capabilities:\n                drop:\n                - NET_RAW\n                - NET_ADMIN\n                - SYS_ADMIN\n                - SYS_MODULE\n                - SYS_PTRACE\n                - SYS_CHROOT\n              privileged: false\n              allowPrivilegeEscalation: false\n              runAsNonRoot: true\n              readOnlyRootFilesystem: true\n            resources:\n              requests:\n                cpu: 100m\n                memory: 128Mi\n              limits:\n                cpu: 500m\n                memory: 256Mi\n          restartPolicy: OnFailure\n  schedule: 0 0 * * *\n",
    "errors": []
  },
  {
    "id": "03353",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: CronJob\nmetadata:\n  name: nightly-test-trigger\nspec:\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          containers:\n          - name: trigger\n            env:\n            - name: SINK_URL\n              value: http://el-test-nightly.default.svc.cluster.local:8080\n            - name: TARGET_PROJECT\n              value: operator\n            - name: NAMESPACE\n              value: bastion-p\n            - name: REGISTRY\n              value: ppc64le-cluster.bastion-p.svc.cluster.local:443\n            - name: TARGET_ARCH\n              value: ppc64le\n            - name: REMOTE_SECRET_NAME\n              valueFrom:\n                secretKeyRef:\n                  name: remote-secret-name-secret\n                  key: remote_secret_name\n            securityContext:\n              readOnlyRootFilesystem: true\n              privileged: false\n              capabilities:\n                drop:\n                - NET_RAW\n                - NET_ADMIN\n                - SYS_ADMIN\n                - SYS_MODULE\n                - SYS_PTRACE\n                - SYS_CHROOT\n              allowPrivilegeEscalation: false\n              runAsNonRoot: true\n            image: busybox:stable\n            resources:\n              requests:\n                cpu: 100m\n                memory: 128Mi\n              limits:\n                cpu: 500m\n                memory: 256Mi\n          restartPolicy: OnFailure\n  schedule: 0 0 * * *\n",
    "errors": []
  },
  {
    "id": "03354",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: CronJob\nmetadata:\n  name: nightly-test-trigger\nspec:\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          containers:\n          - name: trigger\n            env:\n            - name: SINK_URL\n              value: http://el-test-nightly.default.svc.cluster.local:8080\n            - name: TARGET_PROJECT\n              value: operator\n            - name: NAMESPACE\n              value: bastion-p\n            - name: REGISTRY\n              value: ppc64le-cluster.bastion-p.svc.cluster.local:443\n            - name: TARGET_ARCH\n              value: ppc64le\n            - name: REMOTE_SECRET_NAME\n              valueFrom:\n                secretKeyRef:\n                  name: remote-secret-name-secret\n                  key: remote_secret_name\n            securityContext:\n              runAsNonRoot: true\n              privileged: false\n              capabilities:\n                drop:\n                - NET_RAW\n                - NET_ADMIN\n                - SYS_ADMIN\n                - SYS_MODULE\n                - SYS_PTRACE\n                - SYS_CHROOT\n              allowPrivilegeEscalation: false\n              readOnlyRootFilesystem: true\n            image: busybox:stable\n            resources:\n              requests:\n                cpu: 100m\n                memory: 128Mi\n              limits:\n                cpu: 500m\n                memory: 256Mi\n          restartPolicy: OnFailure\n  schedule: 0 0 * * *\n",
    "errors": []
  },
  {
    "id": "03355",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: CronJob\nmetadata:\n  name: nightly-test-trigger\nspec:\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          containers:\n          - name: trigger\n            env:\n            - name: SINK_URL\n              value: http://el-test-nightly.default.svc.cluster.local:8080\n            - name: TARGET_PROJECT\n              value: operator\n            - name: NAMESPACE\n              value: bastion-p\n            - name: REGISTRY\n              value: ppc64le-cluster.bastion-p.svc.cluster.local:443\n            - name: TARGET_ARCH\n              value: ppc64le\n            - name: REMOTE_SECRET_NAME\n              valueFrom:\n                secretKeyRef:\n                  name: remote-secret-name-secret\n                  key: remote_secret_name\n            resources:\n              requests:\n                cpu: 100m\n                memory: 128Mi\n              limits:\n                cpu: 500m\n                memory: 256Mi\n            securityContext:\n              privileged: false\n              capabilities:\n                drop:\n                - NET_RAW\n                - NET_ADMIN\n                - SYS_ADMIN\n                - SYS_MODULE\n                - SYS_PTRACE\n                - SYS_CHROOT\n              allowPrivilegeEscalation: false\n              runAsNonRoot: true\n              readOnlyRootFilesystem: true\n            image: busybox:stable\n          restartPolicy: OnFailure\n  schedule: 0 0 * * *\n",
    "errors": []
  },
  {
    "id": "03356",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: CronJob\nmetadata:\n  name: nightly-test-trigger\nspec:\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          containers:\n          - name: trigger\n            env:\n            - name: SINK_URL\n              value: http://el-test-nightly.default.svc.cluster.local:8080\n            - name: TARGET_PROJECT\n              value: operator\n            - name: NAMESPACE\n              value: bastion-p\n            - name: REGISTRY\n              value: ppc64le-cluster.bastion-p.svc.cluster.local:443\n            - name: TARGET_ARCH\n              value: ppc64le\n            - name: REMOTE_SECRET_NAME\n              valueFrom:\n                secretKeyRef:\n                  name: remote-secret-name-secret\n                  key: remote_secret_name\n            resources:\n              requests:\n                cpu: 100m\n                memory: 128Mi\n              limits:\n                cpu: 500m\n                memory: 256Mi\n            securityContext:\n              privileged: false\n              capabilities:\n                drop:\n                - NET_RAW\n                - NET_ADMIN\n                - SYS_ADMIN\n                - SYS_MODULE\n                - SYS_PTRACE\n                - SYS_CHROOT\n              allowPrivilegeEscalation: false\n              runAsNonRoot: true\n              readOnlyRootFilesystem: true\n            image: busybox:stable\n          restartPolicy: OnFailure\n  schedule: 0 0 * * *\n",
    "errors": []
  },
  {
    "id": "03357",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: statusreconciler\n  labels:\n    app: statusreconciler\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: statusreconciler\n  template:\n    metadata:\n      labels:\n        app: statusreconciler\n    spec:\n      containers:\n      - name: statusreconciler\n        image: gcr.io/k8s-prow/status-reconciler:v20220510-5840068ce9\n        imagePullPolicy: Always\n        args:\n        - --config-path=/etc/config/config.yaml\n        - --continue-on-error=true\n        - --dry-run=false\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --github-token-path=/etc/github/oauth\n        - --job-config-path=/etc/job-config\n        - --plugin-config=/etc/plugins/plugins.yaml\n        volumeMounts:\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        - name: plugins\n          mountPath: /etc/plugins\n          readOnly: true\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n      - name: plugins\n        configMap:\n          name: plugins\n",
    "errors": []
  },
  {
    "id": "03358",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: statusreconciler\n  labels:\n    app: statusreconciler\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: statusreconciler\n  template:\n    metadata:\n      labels:\n        app: statusreconciler\n    spec:\n      containers:\n      - name: statusreconciler\n        image: gcr.io/k8s-prow/status-reconciler:v20220510-5840068ce9\n        imagePullPolicy: Always\n        args:\n        - --config-path=/etc/config/config.yaml\n        - --continue-on-error=true\n        - --dry-run=false\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --github-token-path=/etc/github/oauth\n        - --job-config-path=/etc/job-config\n        - --plugin-config=/etc/plugins/plugins.yaml\n        volumeMounts:\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        - name: plugins\n          mountPath: /etc/plugins\n          readOnly: true\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n      - name: plugins\n        configMap:\n          name: plugins\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "03359",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: statusreconciler\n  labels:\n    app: statusreconciler\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: statusreconciler\n  template:\n    metadata:\n      labels:\n        app: statusreconciler\n    spec:\n      containers:\n      - name: statusreconciler\n        image: gcr.io/k8s-prow/status-reconciler:v20220510-5840068ce9\n        imagePullPolicy: Always\n        args:\n        - --config-path=/etc/config/config.yaml\n        - --continue-on-error=true\n        - --dry-run=false\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --github-token-path=/etc/github/oauth\n        - --job-config-path=/etc/job-config\n        - --plugin-config=/etc/plugins/plugins.yaml\n        volumeMounts:\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        - name: plugins\n          mountPath: /etc/plugins\n          readOnly: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n      - name: plugins\n        configMap:\n          name: plugins\n",
    "errors": []
  },
  {
    "id": "03360",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: statusreconciler\n  labels:\n    app: statusreconciler\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: statusreconciler\n  template:\n    metadata:\n      labels:\n        app: statusreconciler\n    spec:\n      containers:\n      - name: statusreconciler\n        image: gcr.io/k8s-prow/status-reconciler:v20220510-5840068ce9\n        imagePullPolicy: Always\n        args:\n        - --config-path=/etc/config/config.yaml\n        - --continue-on-error=true\n        - --dry-run=false\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --github-token-path=/etc/github/oauth\n        - --job-config-path=/etc/job-config\n        - --plugin-config=/etc/plugins/plugins.yaml\n        volumeMounts:\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        - name: plugins\n          mountPath: /etc/plugins\n          readOnly: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n      - name: plugins\n        configMap:\n          name: plugins\n",
    "errors": []
  }
]