[
  {
    "id": "02801",
    "manifest_path": "data/manifests/the_stack_sample/sample_1143.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: verifier-vcs-add-profiles\nspec:\n  template:\n    spec:\n      volumes:\n      - name: script\n        configMap:\n          name: verifier-vcs-add-profiles-script\n      initContainers:\n      - name: wait\n        image: busybox\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        args:\n        - -c\n        - sleep 5\n      - name: healthcheck-ready\n        image: busybox\n        imagePullPolicy: IfNotPresent\n        command:\n        - /bin/sh\n        args:\n        - -c\n        - 'while [[ \"$(wget -T 5 -S --spider http://${VERIFIER_VCS_SERVICE_HOST}/healthcheck\n          2>&1 | grep ''200 OK'')\" == \"\" ]];\n\n          do echo \"waiting for endpoint\";\n\n          sleep 5;\n\n          done;\n\n          '\n      containers:\n      - name: verifier-vcs-add-profiles\n        image: alpine:latest\n        imagePullPolicy: IfNotPresent\n        command:\n        - /bin/sh\n        args:\n        - /opt/vcs_verifier_configure.sh\n        volumeMounts:\n        - name: script\n          mountPath: /opt\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"healthcheck-ready\" has memory limit 0"
  },
  {
    "id": "02802",
    "manifest_path": "data/manifests/the_stack_sample/sample_1143.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: verifier-vcs-add-profiles\nspec:\n  template:\n    spec:\n      volumes:\n      - name: script\n        configMap:\n          name: verifier-vcs-add-profiles-script\n      initContainers:\n      - name: wait\n        image: busybox\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        args:\n        - -c\n        - sleep 5\n      - name: healthcheck-ready\n        image: busybox\n        imagePullPolicy: IfNotPresent\n        command:\n        - /bin/sh\n        args:\n        - -c\n        - 'while [[ \"$(wget -T 5 -S --spider http://${VERIFIER_VCS_SERVICE_HOST}/healthcheck\n          2>&1 | grep ''200 OK'')\" == \"\" ]];\n\n          do echo \"waiting for endpoint\";\n\n          sleep 5;\n\n          done;\n\n          '\n      containers:\n      - name: verifier-vcs-add-profiles\n        image: alpine:latest\n        imagePullPolicy: IfNotPresent\n        command:\n        - /bin/sh\n        args:\n        - /opt/vcs_verifier_configure.sh\n        volumeMounts:\n        - name: script\n          mountPath: /opt\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"verifier-vcs-add-profiles\" has memory limit 0"
  },
  {
    "id": "02803",
    "manifest_path": "data/manifests/the_stack_sample/sample_1143.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: verifier-vcs-add-profiles\nspec:\n  template:\n    spec:\n      volumes:\n      - name: script\n        configMap:\n          name: verifier-vcs-add-profiles-script\n      initContainers:\n      - name: wait\n        image: busybox\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        args:\n        - -c\n        - sleep 5\n      - name: healthcheck-ready\n        image: busybox\n        imagePullPolicy: IfNotPresent\n        command:\n        - /bin/sh\n        args:\n        - -c\n        - 'while [[ \"$(wget -T 5 -S --spider http://${VERIFIER_VCS_SERVICE_HOST}/healthcheck\n          2>&1 | grep ''200 OK'')\" == \"\" ]];\n\n          do echo \"waiting for endpoint\";\n\n          sleep 5;\n\n          done;\n\n          '\n      containers:\n      - name: verifier-vcs-add-profiles\n        image: alpine:latest\n        imagePullPolicy: IfNotPresent\n        command:\n        - /bin/sh\n        args:\n        - /opt/vcs_verifier_configure.sh\n        volumeMounts:\n        - name: script\n          mountPath: /opt\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"wait\" has memory limit 0"
  },
  {
    "id": "02804",
    "manifest_path": "data/manifests/the_stack_sample/sample_1144.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: cockroachdb-client-secure\n  labels:\n    app: cockroachdb-client\nspec:\n  serviceAccountName: cockroachdb\n  containers:\n  - name: cockroachdb-client\n    image: cockroachdb/cockroach:v20.1.0\n    imagePullPolicy: IfNotPresent\n    volumeMounts:\n    - name: client-certs\n      mountPath: /cockroach-certs\n    command:\n    - sleep\n    - '2147483648'\n  volumes:\n  - name: client-certs\n    secret:\n      secretName: cockroachdb.client.root\n      defaultMode: 256\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"cockroachdb-client\" does not have a read-only root file system"
  },
  {
    "id": "02805",
    "manifest_path": "data/manifests/the_stack_sample/sample_1144.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: cockroachdb-client-secure\n  labels:\n    app: cockroachdb-client\nspec:\n  serviceAccountName: cockroachdb\n  containers:\n  - name: cockroachdb-client\n    image: cockroachdb/cockroach:v20.1.0\n    imagePullPolicy: IfNotPresent\n    volumeMounts:\n    - name: client-certs\n      mountPath: /cockroach-certs\n    command:\n    - sleep\n    - '2147483648'\n  volumes:\n  - name: client-certs\n    secret:\n      secretName: cockroachdb.client.root\n      defaultMode: 256\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"cockroachdb-client\" is not set to runAsNonRoot"
  },
  {
    "id": "02806",
    "manifest_path": "data/manifests/the_stack_sample/sample_1144.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: cockroachdb-client-secure\n  labels:\n    app: cockroachdb-client\nspec:\n  serviceAccountName: cockroachdb\n  containers:\n  - name: cockroachdb-client\n    image: cockroachdb/cockroach:v20.1.0\n    imagePullPolicy: IfNotPresent\n    volumeMounts:\n    - name: client-certs\n      mountPath: /cockroach-certs\n    command:\n    - sleep\n    - '2147483648'\n  volumes:\n  - name: client-certs\n    secret:\n      secretName: cockroachdb.client.root\n      defaultMode: 256\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"cockroachdb-client\" has cpu request 0"
  },
  {
    "id": "02807",
    "manifest_path": "data/manifests/the_stack_sample/sample_1144.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: cockroachdb-client-secure\n  labels:\n    app: cockroachdb-client\nspec:\n  serviceAccountName: cockroachdb\n  containers:\n  - name: cockroachdb-client\n    image: cockroachdb/cockroach:v20.1.0\n    imagePullPolicy: IfNotPresent\n    volumeMounts:\n    - name: client-certs\n      mountPath: /cockroach-certs\n    command:\n    - sleep\n    - '2147483648'\n  volumes:\n  - name: client-certs\n    secret:\n      secretName: cockroachdb.client.root\n      defaultMode: 256\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"cockroachdb-client\" has memory limit 0"
  },
  {
    "id": "02808",
    "manifest_path": "data/manifests/the_stack_sample/sample_1145.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: task-4\nspec:\n  containers:\n  - image: ubuntu\n    name: ubuntu\n    command:\n    - /bin/bash\n    - -c\n    args:\n    - sleep 3600\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"ubuntu\" is using an invalid container image, \"ubuntu\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02809",
    "manifest_path": "data/manifests/the_stack_sample/sample_1145.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: task-4\nspec:\n  containers:\n  - image: ubuntu\n    name: ubuntu\n    command:\n    - /bin/bash\n    - -c\n    args:\n    - sleep 3600\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"ubuntu\" does not have a read-only root file system"
  },
  {
    "id": "02810",
    "manifest_path": "data/manifests/the_stack_sample/sample_1145.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: task-4\nspec:\n  containers:\n  - image: ubuntu\n    name: ubuntu\n    command:\n    - /bin/bash\n    - -c\n    args:\n    - sleep 3600\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"ubuntu\" is not set to runAsNonRoot"
  },
  {
    "id": "02811",
    "manifest_path": "data/manifests/the_stack_sample/sample_1145.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: task-4\nspec:\n  containers:\n  - image: ubuntu\n    name: ubuntu\n    command:\n    - /bin/bash\n    - -c\n    args:\n    - sleep 3600\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"ubuntu\" has cpu request 0"
  },
  {
    "id": "02812",
    "manifest_path": "data/manifests/the_stack_sample/sample_1145.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: task-4\nspec:\n  containers:\n  - image: ubuntu\n    name: ubuntu\n    command:\n    - /bin/bash\n    - -c\n    args:\n    - sleep 3600\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"ubuntu\" has memory limit 0"
  },
  {
    "id": "02813",
    "manifest_path": "data/manifests/the_stack_sample/sample_1146.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: phpmyadmin\nspec:\n  selector:\n    matchLabels:\n      app: phpmyadmin\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: phpmyadmin\n    spec:\n      containers:\n      - image: my_phpmyadmin\n        name: phpmyadmin\n        imagePullPolicy: Never\n        ports:\n        - name: php-port\n          containerPort: 5000\n        livenessProbe:\n          exec:\n            command:\n            - sh\n            - -c\n            - service telegraf status && service nginx status && service mariadb status\n              && service php-fpm7 status\n          initialDelaySeconds: 5\n          periodSeconds: 5\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"phpmyadmin\" is using an invalid container image, \"my_phpmyadmin\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02814",
    "manifest_path": "data/manifests/the_stack_sample/sample_1146.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: phpmyadmin\nspec:\n  selector:\n    matchLabels:\n      app: phpmyadmin\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: phpmyadmin\n    spec:\n      containers:\n      - image: my_phpmyadmin\n        name: phpmyadmin\n        imagePullPolicy: Never\n        ports:\n        - name: php-port\n          containerPort: 5000\n        livenessProbe:\n          exec:\n            command:\n            - sh\n            - -c\n            - service telegraf status && service nginx status && service mariadb status\n              && service php-fpm7 status\n          initialDelaySeconds: 5\n          periodSeconds: 5\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"phpmyadmin\" does not have a read-only root file system"
  },
  {
    "id": "02815",
    "manifest_path": "data/manifests/the_stack_sample/sample_1146.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: phpmyadmin\nspec:\n  selector:\n    matchLabels:\n      app: phpmyadmin\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: phpmyadmin\n    spec:\n      containers:\n      - image: my_phpmyadmin\n        name: phpmyadmin\n        imagePullPolicy: Never\n        ports:\n        - name: php-port\n          containerPort: 5000\n        livenessProbe:\n          exec:\n            command:\n            - sh\n            - -c\n            - service telegraf status && service nginx status && service mariadb status\n              && service php-fpm7 status\n          initialDelaySeconds: 5\n          periodSeconds: 5\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"phpmyadmin\" is not set to runAsNonRoot"
  },
  {
    "id": "02816",
    "manifest_path": "data/manifests/the_stack_sample/sample_1146.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: phpmyadmin\nspec:\n  selector:\n    matchLabels:\n      app: phpmyadmin\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: phpmyadmin\n    spec:\n      containers:\n      - image: my_phpmyadmin\n        name: phpmyadmin\n        imagePullPolicy: Never\n        ports:\n        - name: php-port\n          containerPort: 5000\n        livenessProbe:\n          exec:\n            command:\n            - sh\n            - -c\n            - service telegraf status && service nginx status && service mariadb status\n              && service php-fpm7 status\n          initialDelaySeconds: 5\n          periodSeconds: 5\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"phpmyadmin\" has cpu request 0"
  },
  {
    "id": "02817",
    "manifest_path": "data/manifests/the_stack_sample/sample_1146.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: phpmyadmin\nspec:\n  selector:\n    matchLabels:\n      app: phpmyadmin\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: phpmyadmin\n    spec:\n      containers:\n      - image: my_phpmyadmin\n        name: phpmyadmin\n        imagePullPolicy: Never\n        ports:\n        - name: php-port\n          containerPort: 5000\n        livenessProbe:\n          exec:\n            command:\n            - sh\n            - -c\n            - service telegraf status && service nginx status && service mariadb status\n              && service php-fpm7 status\n          initialDelaySeconds: 5\n          periodSeconds: 5\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"phpmyadmin\" has memory limit 0"
  },
  {
    "id": "02818",
    "manifest_path": "data/manifests/the_stack_sample/sample_1147.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: hrz\nspec:\n  selector:\n    matchLabels:\n      app: hrz\n  template:\n    metadata:\n      labels:\n        app: hrz\n    spec:\n      containers:\n      - name: sitecore-horizon\n        env:\n        - name: Sitecore_Plugins__Filters__ContentHub\n          value: +ContentHub\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"sitecore-horizon\" is using an invalid container image, \"\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02819",
    "manifest_path": "data/manifests/the_stack_sample/sample_1147.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: hrz\nspec:\n  selector:\n    matchLabels:\n      app: hrz\n  template:\n    metadata:\n      labels:\n        app: hrz\n    spec:\n      containers:\n      - name: sitecore-horizon\n        env:\n        - name: Sitecore_Plugins__Filters__ContentHub\n          value: +ContentHub\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"sitecore-horizon\" does not have a read-only root file system"
  },
  {
    "id": "02820",
    "manifest_path": "data/manifests/the_stack_sample/sample_1147.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: hrz\nspec:\n  selector:\n    matchLabels:\n      app: hrz\n  template:\n    metadata:\n      labels:\n        app: hrz\n    spec:\n      containers:\n      - name: sitecore-horizon\n        env:\n        - name: Sitecore_Plugins__Filters__ContentHub\n          value: +ContentHub\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"sitecore-horizon\" is not set to runAsNonRoot"
  },
  {
    "id": "02821",
    "manifest_path": "data/manifests/the_stack_sample/sample_1147.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: hrz\nspec:\n  selector:\n    matchLabels:\n      app: hrz\n  template:\n    metadata:\n      labels:\n        app: hrz\n    spec:\n      containers:\n      - name: sitecore-horizon\n        env:\n        - name: Sitecore_Plugins__Filters__ContentHub\n          value: +ContentHub\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"sitecore-horizon\" has cpu request 0"
  },
  {
    "id": "02822",
    "manifest_path": "data/manifests/the_stack_sample/sample_1147.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: hrz\nspec:\n  selector:\n    matchLabels:\n      app: hrz\n  template:\n    metadata:\n      labels:\n        app: hrz\n    spec:\n      containers:\n      - name: sitecore-horizon\n        env:\n        - name: Sitecore_Plugins__Filters__ContentHub\n          value: +ContentHub\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"sitecore-horizon\" has memory limit 0"
  },
  {
    "id": "02823",
    "manifest_path": "data/manifests/the_stack_sample/sample_1150.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: gcsb-run\n  namespace: gcsb\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: gcsb-run\n  template:\n    metadata:\n      labels:\n        app: gcsb-run\n    spec:\n      serviceAccountName: gcsb\n      containers:\n      - name: gcsb-run\n        image: gcr.io/<project>/gcsb:latest\n        command:\n        - /gcsb\n        - run\n        args:\n        - --project=YOUR_PROJECT_ID\n        - --instance=YOUR_INSTANCE_ID\n        - --database=YOUR_DATABASE\n        - --table=YOUR_TABLE\n        - --operations=1000000\n        - --threads=10\n        - --reads=50\n        - --writes=50\n        - --sample-size=5\n        resources:\n          requests:\n            cpu: '6'\n            memory: 4Gi\n          limits:\n            cpu: '6'\n            memory: 4Gi\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"gcsb-run\" is using an invalid container image, \"gcr.io/<project>/gcsb:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02824",
    "manifest_path": "data/manifests/the_stack_sample/sample_1150.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: gcsb-run\n  namespace: gcsb\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: gcsb-run\n  template:\n    metadata:\n      labels:\n        app: gcsb-run\n    spec:\n      serviceAccountName: gcsb\n      containers:\n      - name: gcsb-run\n        image: gcr.io/<project>/gcsb:latest\n        command:\n        - /gcsb\n        - run\n        args:\n        - --project=YOUR_PROJECT_ID\n        - --instance=YOUR_INSTANCE_ID\n        - --database=YOUR_DATABASE\n        - --table=YOUR_TABLE\n        - --operations=1000000\n        - --threads=10\n        - --reads=50\n        - --writes=50\n        - --sample-size=5\n        resources:\n          requests:\n            cpu: '6'\n            memory: 4Gi\n          limits:\n            cpu: '6'\n            memory: 4Gi\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"gcsb-run\" does not have a read-only root file system"
  },
  {
    "id": "02825",
    "manifest_path": "data/manifests/the_stack_sample/sample_1150.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: gcsb-run\n  namespace: gcsb\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: gcsb-run\n  template:\n    metadata:\n      labels:\n        app: gcsb-run\n    spec:\n      serviceAccountName: gcsb\n      containers:\n      - name: gcsb-run\n        image: gcr.io/<project>/gcsb:latest\n        command:\n        - /gcsb\n        - run\n        args:\n        - --project=YOUR_PROJECT_ID\n        - --instance=YOUR_INSTANCE_ID\n        - --database=YOUR_DATABASE\n        - --table=YOUR_TABLE\n        - --operations=1000000\n        - --threads=10\n        - --reads=50\n        - --writes=50\n        - --sample-size=5\n        resources:\n          requests:\n            cpu: '6'\n            memory: 4Gi\n          limits:\n            cpu: '6'\n            memory: 4Gi\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"gcsb-run\" is not set to runAsNonRoot"
  },
  {
    "id": "02826",
    "manifest_path": "data/manifests/the_stack_sample/sample_1153.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: openshift-oauth-apiserver\n  name: apiserver\n  labels:\n    app: openshift-oauth-apiserver\n    apiserver: 'true'\nspec:\n  selector:\n    matchLabels:\n      app: openshift-oauth-apiserver\n      apiserver: 'true'\n  template:\n    metadata:\n      name: openshift-oauth-apiserver\n      labels:\n        app: openshift-oauth-apiserver\n        apiserver: 'true'\n    spec:\n      serviceAccountName: oauth-apiserver-sa\n      initContainers:\n      - name: fix-audit-permissions\n        image: ${IMAGE}\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - chmod 0700 /var/log/oauth-apiserver && touch /var/log/oauth-apiserver/audit.log\n          && chmod 0600 /var/log/oauth-apiserver/*\n        securityContext:\n          privileged: true\n        resources:\n          requests:\n            cpu: 15m\n            memory: 50Mi\n        volumeMounts:\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n      containers:\n      - name: oauth-apiserver\n        image: ${IMAGE}\n        imagePullPolicy: IfNotPresent\n        command:\n        - /bin/bash\n        - -ec\n        args:\n        - \"if [ -s /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem ]; then\\n\\\n          \\  echo \\\"Copying system trust bundle\\\"\\n  cp -f /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem\\\n          \\ /etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem\\nfi\\nexec oauth-apiserver\\\n          \\ start \\\\\\n  --secure-port=8443 \\\\\\n  --audit-log-path=/var/log/oauth-apiserver/audit.log\\\n          \\ \\\\\\n  --audit-log-format=json \\\\\\n  --audit-log-maxsize=100 \\\\\\n  --audit-log-maxbackup=10\\\n          \\ \\\\\\n  --etcd-cafile=/var/run/configmaps/etcd-serving-ca/ca-bundle.crt\\\n          \\ \\\\\\n  --etcd-keyfile=/var/run/secrets/etcd-client/tls.key \\\\\\n  --etcd-certfile=/var/run/secrets/etcd-client/tls.crt\\\n          \\ \\\\\\n  --shutdown-delay-duration=3s \\\\\\n  --tls-private-key-file=/var/run/secrets/serving-cert/tls.key\\\n          \\ \\\\\\n  --tls-cert-file=/var/run/secrets/serving-cert/tls.crt \\\\\\n  ${FLAGS}\\n\"\n        resources:\n          requests:\n            memory: 200Mi\n            cpu: 150m\n        securityContext:\n          privileged: true\n        ports:\n        - containerPort: 8443\n        volumeMounts:\n        - mountPath: /var/run/configmaps/audit\n          name: audit-policies\n        - mountPath: /var/run/secrets/etcd-client\n          name: etcd-client\n        - mountPath: /var/run/configmaps/etcd-serving-ca\n          name: etcd-serving-ca\n        - mountPath: /var/run/configmaps/trusted-ca-bundle\n          name: trusted-ca-bundle\n        - mountPath: /var/run/secrets/serving-cert\n          name: serving-cert\n        - mountPath: /var/run/secrets/encryption-config\n          name: encryption-config\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n        livenessProbe:\n          initialDelaySeconds: 30\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: healthz\n        readinessProbe:\n          failureThreshold: 10\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: readyz\n      volumes:\n      - name: audit-policies\n        configMap:\n          name: audit-${REVISION}\n      - name: etcd-client\n        secret:\n          secretName: etcd-client\n      - name: etcd-serving-ca\n        configMap:\n          name: etcd-serving-ca\n      - name: serving-cert\n        secret:\n          secretName: serving-cert\n      - name: trusted-ca-bundle\n        configMap:\n          name: trusted-ca-bundle\n          optional: true\n          items:\n          - key: ca-bundle.crt\n            path: tls-ca-bundle.pem\n      - name: encryption-config\n        secret:\n          secretName: encryption-config-${REVISION}\n          optional: true\n      - hostPath:\n          path: /var/log/oauth-apiserver\n        name: audit-dir\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"fix-audit-permissions\" is using an invalid container image, \"${IMAGE}\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02827",
    "manifest_path": "data/manifests/the_stack_sample/sample_1153.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: openshift-oauth-apiserver\n  name: apiserver\n  labels:\n    app: openshift-oauth-apiserver\n    apiserver: 'true'\nspec:\n  selector:\n    matchLabels:\n      app: openshift-oauth-apiserver\n      apiserver: 'true'\n  template:\n    metadata:\n      name: openshift-oauth-apiserver\n      labels:\n        app: openshift-oauth-apiserver\n        apiserver: 'true'\n    spec:\n      serviceAccountName: oauth-apiserver-sa\n      initContainers:\n      - name: fix-audit-permissions\n        image: ${IMAGE}\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - chmod 0700 /var/log/oauth-apiserver && touch /var/log/oauth-apiserver/audit.log\n          && chmod 0600 /var/log/oauth-apiserver/*\n        securityContext:\n          privileged: true\n        resources:\n          requests:\n            cpu: 15m\n            memory: 50Mi\n        volumeMounts:\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n      containers:\n      - name: oauth-apiserver\n        image: ${IMAGE}\n        imagePullPolicy: IfNotPresent\n        command:\n        - /bin/bash\n        - -ec\n        args:\n        - \"if [ -s /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem ]; then\\n\\\n          \\  echo \\\"Copying system trust bundle\\\"\\n  cp -f /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem\\\n          \\ /etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem\\nfi\\nexec oauth-apiserver\\\n          \\ start \\\\\\n  --secure-port=8443 \\\\\\n  --audit-log-path=/var/log/oauth-apiserver/audit.log\\\n          \\ \\\\\\n  --audit-log-format=json \\\\\\n  --audit-log-maxsize=100 \\\\\\n  --audit-log-maxbackup=10\\\n          \\ \\\\\\n  --etcd-cafile=/var/run/configmaps/etcd-serving-ca/ca-bundle.crt\\\n          \\ \\\\\\n  --etcd-keyfile=/var/run/secrets/etcd-client/tls.key \\\\\\n  --etcd-certfile=/var/run/secrets/etcd-client/tls.crt\\\n          \\ \\\\\\n  --shutdown-delay-duration=3s \\\\\\n  --tls-private-key-file=/var/run/secrets/serving-cert/tls.key\\\n          \\ \\\\\\n  --tls-cert-file=/var/run/secrets/serving-cert/tls.crt \\\\\\n  ${FLAGS}\\n\"\n        resources:\n          requests:\n            memory: 200Mi\n            cpu: 150m\n        securityContext:\n          privileged: true\n        ports:\n        - containerPort: 8443\n        volumeMounts:\n        - mountPath: /var/run/configmaps/audit\n          name: audit-policies\n        - mountPath: /var/run/secrets/etcd-client\n          name: etcd-client\n        - mountPath: /var/run/configmaps/etcd-serving-ca\n          name: etcd-serving-ca\n        - mountPath: /var/run/configmaps/trusted-ca-bundle\n          name: trusted-ca-bundle\n        - mountPath: /var/run/secrets/serving-cert\n          name: serving-cert\n        - mountPath: /var/run/secrets/encryption-config\n          name: encryption-config\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n        livenessProbe:\n          initialDelaySeconds: 30\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: healthz\n        readinessProbe:\n          failureThreshold: 10\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: readyz\n      volumes:\n      - name: audit-policies\n        configMap:\n          name: audit-${REVISION}\n      - name: etcd-client\n        secret:\n          secretName: etcd-client\n      - name: etcd-serving-ca\n        configMap:\n          name: etcd-serving-ca\n      - name: serving-cert\n        secret:\n          secretName: serving-cert\n      - name: trusted-ca-bundle\n        configMap:\n          name: trusted-ca-bundle\n          optional: true\n          items:\n          - key: ca-bundle.crt\n            path: tls-ca-bundle.pem\n      - name: encryption-config\n        secret:\n          secretName: encryption-config-${REVISION}\n          optional: true\n      - hostPath:\n          path: /var/log/oauth-apiserver\n        name: audit-dir\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"oauth-apiserver\" is using an invalid container image, \"${IMAGE}\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02828",
    "manifest_path": "data/manifests/the_stack_sample/sample_1153.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: openshift-oauth-apiserver\n  name: apiserver\n  labels:\n    app: openshift-oauth-apiserver\n    apiserver: 'true'\nspec:\n  selector:\n    matchLabels:\n      app: openshift-oauth-apiserver\n      apiserver: 'true'\n  template:\n    metadata:\n      name: openshift-oauth-apiserver\n      labels:\n        app: openshift-oauth-apiserver\n        apiserver: 'true'\n    spec:\n      serviceAccountName: oauth-apiserver-sa\n      initContainers:\n      - name: fix-audit-permissions\n        image: ${IMAGE}\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - chmod 0700 /var/log/oauth-apiserver && touch /var/log/oauth-apiserver/audit.log\n          && chmod 0600 /var/log/oauth-apiserver/*\n        securityContext:\n          privileged: true\n        resources:\n          requests:\n            cpu: 15m\n            memory: 50Mi\n        volumeMounts:\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n      containers:\n      - name: oauth-apiserver\n        image: ${IMAGE}\n        imagePullPolicy: IfNotPresent\n        command:\n        - /bin/bash\n        - -ec\n        args:\n        - \"if [ -s /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem ]; then\\n\\\n          \\  echo \\\"Copying system trust bundle\\\"\\n  cp -f /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem\\\n          \\ /etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem\\nfi\\nexec oauth-apiserver\\\n          \\ start \\\\\\n  --secure-port=8443 \\\\\\n  --audit-log-path=/var/log/oauth-apiserver/audit.log\\\n          \\ \\\\\\n  --audit-log-format=json \\\\\\n  --audit-log-maxsize=100 \\\\\\n  --audit-log-maxbackup=10\\\n          \\ \\\\\\n  --etcd-cafile=/var/run/configmaps/etcd-serving-ca/ca-bundle.crt\\\n          \\ \\\\\\n  --etcd-keyfile=/var/run/secrets/etcd-client/tls.key \\\\\\n  --etcd-certfile=/var/run/secrets/etcd-client/tls.crt\\\n          \\ \\\\\\n  --shutdown-delay-duration=3s \\\\\\n  --tls-private-key-file=/var/run/secrets/serving-cert/tls.key\\\n          \\ \\\\\\n  --tls-cert-file=/var/run/secrets/serving-cert/tls.crt \\\\\\n  ${FLAGS}\\n\"\n        resources:\n          requests:\n            memory: 200Mi\n            cpu: 150m\n        securityContext:\n          privileged: true\n        ports:\n        - containerPort: 8443\n        volumeMounts:\n        - mountPath: /var/run/configmaps/audit\n          name: audit-policies\n        - mountPath: /var/run/secrets/etcd-client\n          name: etcd-client\n        - mountPath: /var/run/configmaps/etcd-serving-ca\n          name: etcd-serving-ca\n        - mountPath: /var/run/configmaps/trusted-ca-bundle\n          name: trusted-ca-bundle\n        - mountPath: /var/run/secrets/serving-cert\n          name: serving-cert\n        - mountPath: /var/run/secrets/encryption-config\n          name: encryption-config\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n        livenessProbe:\n          initialDelaySeconds: 30\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: healthz\n        readinessProbe:\n          failureThreshold: 10\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: readyz\n      volumes:\n      - name: audit-policies\n        configMap:\n          name: audit-${REVISION}\n      - name: etcd-client\n        secret:\n          secretName: etcd-client\n      - name: etcd-serving-ca\n        configMap:\n          name: etcd-serving-ca\n      - name: serving-cert\n        secret:\n          secretName: serving-cert\n      - name: trusted-ca-bundle\n        configMap:\n          name: trusted-ca-bundle\n          optional: true\n          items:\n          - key: ca-bundle.crt\n            path: tls-ca-bundle.pem\n      - name: encryption-config\n        secret:\n          secretName: encryption-config-${REVISION}\n          optional: true\n      - hostPath:\n          path: /var/log/oauth-apiserver\n        name: audit-dir\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"fix-audit-permissions\" does not have a read-only root file system"
  },
  {
    "id": "02829",
    "manifest_path": "data/manifests/the_stack_sample/sample_1153.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: openshift-oauth-apiserver\n  name: apiserver\n  labels:\n    app: openshift-oauth-apiserver\n    apiserver: 'true'\nspec:\n  selector:\n    matchLabels:\n      app: openshift-oauth-apiserver\n      apiserver: 'true'\n  template:\n    metadata:\n      name: openshift-oauth-apiserver\n      labels:\n        app: openshift-oauth-apiserver\n        apiserver: 'true'\n    spec:\n      serviceAccountName: oauth-apiserver-sa\n      initContainers:\n      - name: fix-audit-permissions\n        image: ${IMAGE}\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - chmod 0700 /var/log/oauth-apiserver && touch /var/log/oauth-apiserver/audit.log\n          && chmod 0600 /var/log/oauth-apiserver/*\n        securityContext:\n          privileged: true\n        resources:\n          requests:\n            cpu: 15m\n            memory: 50Mi\n        volumeMounts:\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n      containers:\n      - name: oauth-apiserver\n        image: ${IMAGE}\n        imagePullPolicy: IfNotPresent\n        command:\n        - /bin/bash\n        - -ec\n        args:\n        - \"if [ -s /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem ]; then\\n\\\n          \\  echo \\\"Copying system trust bundle\\\"\\n  cp -f /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem\\\n          \\ /etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem\\nfi\\nexec oauth-apiserver\\\n          \\ start \\\\\\n  --secure-port=8443 \\\\\\n  --audit-log-path=/var/log/oauth-apiserver/audit.log\\\n          \\ \\\\\\n  --audit-log-format=json \\\\\\n  --audit-log-maxsize=100 \\\\\\n  --audit-log-maxbackup=10\\\n          \\ \\\\\\n  --etcd-cafile=/var/run/configmaps/etcd-serving-ca/ca-bundle.crt\\\n          \\ \\\\\\n  --etcd-keyfile=/var/run/secrets/etcd-client/tls.key \\\\\\n  --etcd-certfile=/var/run/secrets/etcd-client/tls.crt\\\n          \\ \\\\\\n  --shutdown-delay-duration=3s \\\\\\n  --tls-private-key-file=/var/run/secrets/serving-cert/tls.key\\\n          \\ \\\\\\n  --tls-cert-file=/var/run/secrets/serving-cert/tls.crt \\\\\\n  ${FLAGS}\\n\"\n        resources:\n          requests:\n            memory: 200Mi\n            cpu: 150m\n        securityContext:\n          privileged: true\n        ports:\n        - containerPort: 8443\n        volumeMounts:\n        - mountPath: /var/run/configmaps/audit\n          name: audit-policies\n        - mountPath: /var/run/secrets/etcd-client\n          name: etcd-client\n        - mountPath: /var/run/configmaps/etcd-serving-ca\n          name: etcd-serving-ca\n        - mountPath: /var/run/configmaps/trusted-ca-bundle\n          name: trusted-ca-bundle\n        - mountPath: /var/run/secrets/serving-cert\n          name: serving-cert\n        - mountPath: /var/run/secrets/encryption-config\n          name: encryption-config\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n        livenessProbe:\n          initialDelaySeconds: 30\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: healthz\n        readinessProbe:\n          failureThreshold: 10\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: readyz\n      volumes:\n      - name: audit-policies\n        configMap:\n          name: audit-${REVISION}\n      - name: etcd-client\n        secret:\n          secretName: etcd-client\n      - name: etcd-serving-ca\n        configMap:\n          name: etcd-serving-ca\n      - name: serving-cert\n        secret:\n          secretName: serving-cert\n      - name: trusted-ca-bundle\n        configMap:\n          name: trusted-ca-bundle\n          optional: true\n          items:\n          - key: ca-bundle.crt\n            path: tls-ca-bundle.pem\n      - name: encryption-config\n        secret:\n          secretName: encryption-config-${REVISION}\n          optional: true\n      - hostPath:\n          path: /var/log/oauth-apiserver\n        name: audit-dir\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"oauth-apiserver\" does not have a read-only root file system"
  },
  {
    "id": "02830",
    "manifest_path": "data/manifests/the_stack_sample/sample_1153.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: openshift-oauth-apiserver\n  name: apiserver\n  labels:\n    app: openshift-oauth-apiserver\n    apiserver: 'true'\nspec:\n  selector:\n    matchLabels:\n      app: openshift-oauth-apiserver\n      apiserver: 'true'\n  template:\n    metadata:\n      name: openshift-oauth-apiserver\n      labels:\n        app: openshift-oauth-apiserver\n        apiserver: 'true'\n    spec:\n      serviceAccountName: oauth-apiserver-sa\n      initContainers:\n      - name: fix-audit-permissions\n        image: ${IMAGE}\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - chmod 0700 /var/log/oauth-apiserver && touch /var/log/oauth-apiserver/audit.log\n          && chmod 0600 /var/log/oauth-apiserver/*\n        securityContext:\n          privileged: true\n        resources:\n          requests:\n            cpu: 15m\n            memory: 50Mi\n        volumeMounts:\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n      containers:\n      - name: oauth-apiserver\n        image: ${IMAGE}\n        imagePullPolicy: IfNotPresent\n        command:\n        - /bin/bash\n        - -ec\n        args:\n        - \"if [ -s /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem ]; then\\n\\\n          \\  echo \\\"Copying system trust bundle\\\"\\n  cp -f /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem\\\n          \\ /etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem\\nfi\\nexec oauth-apiserver\\\n          \\ start \\\\\\n  --secure-port=8443 \\\\\\n  --audit-log-path=/var/log/oauth-apiserver/audit.log\\\n          \\ \\\\\\n  --audit-log-format=json \\\\\\n  --audit-log-maxsize=100 \\\\\\n  --audit-log-maxbackup=10\\\n          \\ \\\\\\n  --etcd-cafile=/var/run/configmaps/etcd-serving-ca/ca-bundle.crt\\\n          \\ \\\\\\n  --etcd-keyfile=/var/run/secrets/etcd-client/tls.key \\\\\\n  --etcd-certfile=/var/run/secrets/etcd-client/tls.crt\\\n          \\ \\\\\\n  --shutdown-delay-duration=3s \\\\\\n  --tls-private-key-file=/var/run/secrets/serving-cert/tls.key\\\n          \\ \\\\\\n  --tls-cert-file=/var/run/secrets/serving-cert/tls.crt \\\\\\n  ${FLAGS}\\n\"\n        resources:\n          requests:\n            memory: 200Mi\n            cpu: 150m\n        securityContext:\n          privileged: true\n        ports:\n        - containerPort: 8443\n        volumeMounts:\n        - mountPath: /var/run/configmaps/audit\n          name: audit-policies\n        - mountPath: /var/run/secrets/etcd-client\n          name: etcd-client\n        - mountPath: /var/run/configmaps/etcd-serving-ca\n          name: etcd-serving-ca\n        - mountPath: /var/run/configmaps/trusted-ca-bundle\n          name: trusted-ca-bundle\n        - mountPath: /var/run/secrets/serving-cert\n          name: serving-cert\n        - mountPath: /var/run/secrets/encryption-config\n          name: encryption-config\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n        livenessProbe:\n          initialDelaySeconds: 30\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: healthz\n        readinessProbe:\n          failureThreshold: 10\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: readyz\n      volumes:\n      - name: audit-policies\n        configMap:\n          name: audit-${REVISION}\n      - name: etcd-client\n        secret:\n          secretName: etcd-client\n      - name: etcd-serving-ca\n        configMap:\n          name: etcd-serving-ca\n      - name: serving-cert\n        secret:\n          secretName: serving-cert\n      - name: trusted-ca-bundle\n        configMap:\n          name: trusted-ca-bundle\n          optional: true\n          items:\n          - key: ca-bundle.crt\n            path: tls-ca-bundle.pem\n      - name: encryption-config\n        secret:\n          secretName: encryption-config-${REVISION}\n          optional: true\n      - hostPath:\n          path: /var/log/oauth-apiserver\n        name: audit-dir\n",
    "policy_id": "privilege-escalation-container",
    "violation_text": "container \"fix-audit-permissions\" is Privileged hence allows privilege escalation."
  },
  {
    "id": "02831",
    "manifest_path": "data/manifests/the_stack_sample/sample_1153.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: openshift-oauth-apiserver\n  name: apiserver\n  labels:\n    app: openshift-oauth-apiserver\n    apiserver: 'true'\nspec:\n  selector:\n    matchLabels:\n      app: openshift-oauth-apiserver\n      apiserver: 'true'\n  template:\n    metadata:\n      name: openshift-oauth-apiserver\n      labels:\n        app: openshift-oauth-apiserver\n        apiserver: 'true'\n    spec:\n      serviceAccountName: oauth-apiserver-sa\n      initContainers:\n      - name: fix-audit-permissions\n        image: ${IMAGE}\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - chmod 0700 /var/log/oauth-apiserver && touch /var/log/oauth-apiserver/audit.log\n          && chmod 0600 /var/log/oauth-apiserver/*\n        securityContext:\n          privileged: true\n        resources:\n          requests:\n            cpu: 15m\n            memory: 50Mi\n        volumeMounts:\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n      containers:\n      - name: oauth-apiserver\n        image: ${IMAGE}\n        imagePullPolicy: IfNotPresent\n        command:\n        - /bin/bash\n        - -ec\n        args:\n        - \"if [ -s /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem ]; then\\n\\\n          \\  echo \\\"Copying system trust bundle\\\"\\n  cp -f /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem\\\n          \\ /etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem\\nfi\\nexec oauth-apiserver\\\n          \\ start \\\\\\n  --secure-port=8443 \\\\\\n  --audit-log-path=/var/log/oauth-apiserver/audit.log\\\n          \\ \\\\\\n  --audit-log-format=json \\\\\\n  --audit-log-maxsize=100 \\\\\\n  --audit-log-maxbackup=10\\\n          \\ \\\\\\n  --etcd-cafile=/var/run/configmaps/etcd-serving-ca/ca-bundle.crt\\\n          \\ \\\\\\n  --etcd-keyfile=/var/run/secrets/etcd-client/tls.key \\\\\\n  --etcd-certfile=/var/run/secrets/etcd-client/tls.crt\\\n          \\ \\\\\\n  --shutdown-delay-duration=3s \\\\\\n  --tls-private-key-file=/var/run/secrets/serving-cert/tls.key\\\n          \\ \\\\\\n  --tls-cert-file=/var/run/secrets/serving-cert/tls.crt \\\\\\n  ${FLAGS}\\n\"\n        resources:\n          requests:\n            memory: 200Mi\n            cpu: 150m\n        securityContext:\n          privileged: true\n        ports:\n        - containerPort: 8443\n        volumeMounts:\n        - mountPath: /var/run/configmaps/audit\n          name: audit-policies\n        - mountPath: /var/run/secrets/etcd-client\n          name: etcd-client\n        - mountPath: /var/run/configmaps/etcd-serving-ca\n          name: etcd-serving-ca\n        - mountPath: /var/run/configmaps/trusted-ca-bundle\n          name: trusted-ca-bundle\n        - mountPath: /var/run/secrets/serving-cert\n          name: serving-cert\n        - mountPath: /var/run/secrets/encryption-config\n          name: encryption-config\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n        livenessProbe:\n          initialDelaySeconds: 30\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: healthz\n        readinessProbe:\n          failureThreshold: 10\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: readyz\n      volumes:\n      - name: audit-policies\n        configMap:\n          name: audit-${REVISION}\n      - name: etcd-client\n        secret:\n          secretName: etcd-client\n      - name: etcd-serving-ca\n        configMap:\n          name: etcd-serving-ca\n      - name: serving-cert\n        secret:\n          secretName: serving-cert\n      - name: trusted-ca-bundle\n        configMap:\n          name: trusted-ca-bundle\n          optional: true\n          items:\n          - key: ca-bundle.crt\n            path: tls-ca-bundle.pem\n      - name: encryption-config\n        secret:\n          secretName: encryption-config-${REVISION}\n          optional: true\n      - hostPath:\n          path: /var/log/oauth-apiserver\n        name: audit-dir\n",
    "policy_id": "privilege-escalation-container",
    "violation_text": "container \"oauth-apiserver\" is Privileged hence allows privilege escalation."
  },
  {
    "id": "02832",
    "manifest_path": "data/manifests/the_stack_sample/sample_1153.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: openshift-oauth-apiserver\n  name: apiserver\n  labels:\n    app: openshift-oauth-apiserver\n    apiserver: 'true'\nspec:\n  selector:\n    matchLabels:\n      app: openshift-oauth-apiserver\n      apiserver: 'true'\n  template:\n    metadata:\n      name: openshift-oauth-apiserver\n      labels:\n        app: openshift-oauth-apiserver\n        apiserver: 'true'\n    spec:\n      serviceAccountName: oauth-apiserver-sa\n      initContainers:\n      - name: fix-audit-permissions\n        image: ${IMAGE}\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - chmod 0700 /var/log/oauth-apiserver && touch /var/log/oauth-apiserver/audit.log\n          && chmod 0600 /var/log/oauth-apiserver/*\n        securityContext:\n          privileged: true\n        resources:\n          requests:\n            cpu: 15m\n            memory: 50Mi\n        volumeMounts:\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n      containers:\n      - name: oauth-apiserver\n        image: ${IMAGE}\n        imagePullPolicy: IfNotPresent\n        command:\n        - /bin/bash\n        - -ec\n        args:\n        - \"if [ -s /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem ]; then\\n\\\n          \\  echo \\\"Copying system trust bundle\\\"\\n  cp -f /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem\\\n          \\ /etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem\\nfi\\nexec oauth-apiserver\\\n          \\ start \\\\\\n  --secure-port=8443 \\\\\\n  --audit-log-path=/var/log/oauth-apiserver/audit.log\\\n          \\ \\\\\\n  --audit-log-format=json \\\\\\n  --audit-log-maxsize=100 \\\\\\n  --audit-log-maxbackup=10\\\n          \\ \\\\\\n  --etcd-cafile=/var/run/configmaps/etcd-serving-ca/ca-bundle.crt\\\n          \\ \\\\\\n  --etcd-keyfile=/var/run/secrets/etcd-client/tls.key \\\\\\n  --etcd-certfile=/var/run/secrets/etcd-client/tls.crt\\\n          \\ \\\\\\n  --shutdown-delay-duration=3s \\\\\\n  --tls-private-key-file=/var/run/secrets/serving-cert/tls.key\\\n          \\ \\\\\\n  --tls-cert-file=/var/run/secrets/serving-cert/tls.crt \\\\\\n  ${FLAGS}\\n\"\n        resources:\n          requests:\n            memory: 200Mi\n            cpu: 150m\n        securityContext:\n          privileged: true\n        ports:\n        - containerPort: 8443\n        volumeMounts:\n        - mountPath: /var/run/configmaps/audit\n          name: audit-policies\n        - mountPath: /var/run/secrets/etcd-client\n          name: etcd-client\n        - mountPath: /var/run/configmaps/etcd-serving-ca\n          name: etcd-serving-ca\n        - mountPath: /var/run/configmaps/trusted-ca-bundle\n          name: trusted-ca-bundle\n        - mountPath: /var/run/secrets/serving-cert\n          name: serving-cert\n        - mountPath: /var/run/secrets/encryption-config\n          name: encryption-config\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n        livenessProbe:\n          initialDelaySeconds: 30\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: healthz\n        readinessProbe:\n          failureThreshold: 10\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: readyz\n      volumes:\n      - name: audit-policies\n        configMap:\n          name: audit-${REVISION}\n      - name: etcd-client\n        secret:\n          secretName: etcd-client\n      - name: etcd-serving-ca\n        configMap:\n          name: etcd-serving-ca\n      - name: serving-cert\n        secret:\n          secretName: serving-cert\n      - name: trusted-ca-bundle\n        configMap:\n          name: trusted-ca-bundle\n          optional: true\n          items:\n          - key: ca-bundle.crt\n            path: tls-ca-bundle.pem\n      - name: encryption-config\n        secret:\n          secretName: encryption-config-${REVISION}\n          optional: true\n      - hostPath:\n          path: /var/log/oauth-apiserver\n        name: audit-dir\n",
    "policy_id": "privileged-container",
    "violation_text": "container \"fix-audit-permissions\" is privileged"
  },
  {
    "id": "02833",
    "manifest_path": "data/manifests/the_stack_sample/sample_1153.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: openshift-oauth-apiserver\n  name: apiserver\n  labels:\n    app: openshift-oauth-apiserver\n    apiserver: 'true'\nspec:\n  selector:\n    matchLabels:\n      app: openshift-oauth-apiserver\n      apiserver: 'true'\n  template:\n    metadata:\n      name: openshift-oauth-apiserver\n      labels:\n        app: openshift-oauth-apiserver\n        apiserver: 'true'\n    spec:\n      serviceAccountName: oauth-apiserver-sa\n      initContainers:\n      - name: fix-audit-permissions\n        image: ${IMAGE}\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - chmod 0700 /var/log/oauth-apiserver && touch /var/log/oauth-apiserver/audit.log\n          && chmod 0600 /var/log/oauth-apiserver/*\n        securityContext:\n          privileged: true\n        resources:\n          requests:\n            cpu: 15m\n            memory: 50Mi\n        volumeMounts:\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n      containers:\n      - name: oauth-apiserver\n        image: ${IMAGE}\n        imagePullPolicy: IfNotPresent\n        command:\n        - /bin/bash\n        - -ec\n        args:\n        - \"if [ -s /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem ]; then\\n\\\n          \\  echo \\\"Copying system trust bundle\\\"\\n  cp -f /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem\\\n          \\ /etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem\\nfi\\nexec oauth-apiserver\\\n          \\ start \\\\\\n  --secure-port=8443 \\\\\\n  --audit-log-path=/var/log/oauth-apiserver/audit.log\\\n          \\ \\\\\\n  --audit-log-format=json \\\\\\n  --audit-log-maxsize=100 \\\\\\n  --audit-log-maxbackup=10\\\n          \\ \\\\\\n  --etcd-cafile=/var/run/configmaps/etcd-serving-ca/ca-bundle.crt\\\n          \\ \\\\\\n  --etcd-keyfile=/var/run/secrets/etcd-client/tls.key \\\\\\n  --etcd-certfile=/var/run/secrets/etcd-client/tls.crt\\\n          \\ \\\\\\n  --shutdown-delay-duration=3s \\\\\\n  --tls-private-key-file=/var/run/secrets/serving-cert/tls.key\\\n          \\ \\\\\\n  --tls-cert-file=/var/run/secrets/serving-cert/tls.crt \\\\\\n  ${FLAGS}\\n\"\n        resources:\n          requests:\n            memory: 200Mi\n            cpu: 150m\n        securityContext:\n          privileged: true\n        ports:\n        - containerPort: 8443\n        volumeMounts:\n        - mountPath: /var/run/configmaps/audit\n          name: audit-policies\n        - mountPath: /var/run/secrets/etcd-client\n          name: etcd-client\n        - mountPath: /var/run/configmaps/etcd-serving-ca\n          name: etcd-serving-ca\n        - mountPath: /var/run/configmaps/trusted-ca-bundle\n          name: trusted-ca-bundle\n        - mountPath: /var/run/secrets/serving-cert\n          name: serving-cert\n        - mountPath: /var/run/secrets/encryption-config\n          name: encryption-config\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n        livenessProbe:\n          initialDelaySeconds: 30\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: healthz\n        readinessProbe:\n          failureThreshold: 10\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: readyz\n      volumes:\n      - name: audit-policies\n        configMap:\n          name: audit-${REVISION}\n      - name: etcd-client\n        secret:\n          secretName: etcd-client\n      - name: etcd-serving-ca\n        configMap:\n          name: etcd-serving-ca\n      - name: serving-cert\n        secret:\n          secretName: serving-cert\n      - name: trusted-ca-bundle\n        configMap:\n          name: trusted-ca-bundle\n          optional: true\n          items:\n          - key: ca-bundle.crt\n            path: tls-ca-bundle.pem\n      - name: encryption-config\n        secret:\n          secretName: encryption-config-${REVISION}\n          optional: true\n      - hostPath:\n          path: /var/log/oauth-apiserver\n        name: audit-dir\n",
    "policy_id": "privileged-container",
    "violation_text": "container \"oauth-apiserver\" is privileged"
  },
  {
    "id": "02834",
    "manifest_path": "data/manifests/the_stack_sample/sample_1153.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: openshift-oauth-apiserver\n  name: apiserver\n  labels:\n    app: openshift-oauth-apiserver\n    apiserver: 'true'\nspec:\n  selector:\n    matchLabels:\n      app: openshift-oauth-apiserver\n      apiserver: 'true'\n  template:\n    metadata:\n      name: openshift-oauth-apiserver\n      labels:\n        app: openshift-oauth-apiserver\n        apiserver: 'true'\n    spec:\n      serviceAccountName: oauth-apiserver-sa\n      initContainers:\n      - name: fix-audit-permissions\n        image: ${IMAGE}\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - chmod 0700 /var/log/oauth-apiserver && touch /var/log/oauth-apiserver/audit.log\n          && chmod 0600 /var/log/oauth-apiserver/*\n        securityContext:\n          privileged: true\n        resources:\n          requests:\n            cpu: 15m\n            memory: 50Mi\n        volumeMounts:\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n      containers:\n      - name: oauth-apiserver\n        image: ${IMAGE}\n        imagePullPolicy: IfNotPresent\n        command:\n        - /bin/bash\n        - -ec\n        args:\n        - \"if [ -s /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem ]; then\\n\\\n          \\  echo \\\"Copying system trust bundle\\\"\\n  cp -f /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem\\\n          \\ /etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem\\nfi\\nexec oauth-apiserver\\\n          \\ start \\\\\\n  --secure-port=8443 \\\\\\n  --audit-log-path=/var/log/oauth-apiserver/audit.log\\\n          \\ \\\\\\n  --audit-log-format=json \\\\\\n  --audit-log-maxsize=100 \\\\\\n  --audit-log-maxbackup=10\\\n          \\ \\\\\\n  --etcd-cafile=/var/run/configmaps/etcd-serving-ca/ca-bundle.crt\\\n          \\ \\\\\\n  --etcd-keyfile=/var/run/secrets/etcd-client/tls.key \\\\\\n  --etcd-certfile=/var/run/secrets/etcd-client/tls.crt\\\n          \\ \\\\\\n  --shutdown-delay-duration=3s \\\\\\n  --tls-private-key-file=/var/run/secrets/serving-cert/tls.key\\\n          \\ \\\\\\n  --tls-cert-file=/var/run/secrets/serving-cert/tls.crt \\\\\\n  ${FLAGS}\\n\"\n        resources:\n          requests:\n            memory: 200Mi\n            cpu: 150m\n        securityContext:\n          privileged: true\n        ports:\n        - containerPort: 8443\n        volumeMounts:\n        - mountPath: /var/run/configmaps/audit\n          name: audit-policies\n        - mountPath: /var/run/secrets/etcd-client\n          name: etcd-client\n        - mountPath: /var/run/configmaps/etcd-serving-ca\n          name: etcd-serving-ca\n        - mountPath: /var/run/configmaps/trusted-ca-bundle\n          name: trusted-ca-bundle\n        - mountPath: /var/run/secrets/serving-cert\n          name: serving-cert\n        - mountPath: /var/run/secrets/encryption-config\n          name: encryption-config\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n        livenessProbe:\n          initialDelaySeconds: 30\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: healthz\n        readinessProbe:\n          failureThreshold: 10\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: readyz\n      volumes:\n      - name: audit-policies\n        configMap:\n          name: audit-${REVISION}\n      - name: etcd-client\n        secret:\n          secretName: etcd-client\n      - name: etcd-serving-ca\n        configMap:\n          name: etcd-serving-ca\n      - name: serving-cert\n        secret:\n          secretName: serving-cert\n      - name: trusted-ca-bundle\n        configMap:\n          name: trusted-ca-bundle\n          optional: true\n          items:\n          - key: ca-bundle.crt\n            path: tls-ca-bundle.pem\n      - name: encryption-config\n        secret:\n          secretName: encryption-config-${REVISION}\n          optional: true\n      - hostPath:\n          path: /var/log/oauth-apiserver\n        name: audit-dir\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"fix-audit-permissions\" is not set to runAsNonRoot"
  },
  {
    "id": "02835",
    "manifest_path": "data/manifests/the_stack_sample/sample_1153.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: openshift-oauth-apiserver\n  name: apiserver\n  labels:\n    app: openshift-oauth-apiserver\n    apiserver: 'true'\nspec:\n  selector:\n    matchLabels:\n      app: openshift-oauth-apiserver\n      apiserver: 'true'\n  template:\n    metadata:\n      name: openshift-oauth-apiserver\n      labels:\n        app: openshift-oauth-apiserver\n        apiserver: 'true'\n    spec:\n      serviceAccountName: oauth-apiserver-sa\n      initContainers:\n      - name: fix-audit-permissions\n        image: ${IMAGE}\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - chmod 0700 /var/log/oauth-apiserver && touch /var/log/oauth-apiserver/audit.log\n          && chmod 0600 /var/log/oauth-apiserver/*\n        securityContext:\n          privileged: true\n        resources:\n          requests:\n            cpu: 15m\n            memory: 50Mi\n        volumeMounts:\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n      containers:\n      - name: oauth-apiserver\n        image: ${IMAGE}\n        imagePullPolicy: IfNotPresent\n        command:\n        - /bin/bash\n        - -ec\n        args:\n        - \"if [ -s /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem ]; then\\n\\\n          \\  echo \\\"Copying system trust bundle\\\"\\n  cp -f /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem\\\n          \\ /etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem\\nfi\\nexec oauth-apiserver\\\n          \\ start \\\\\\n  --secure-port=8443 \\\\\\n  --audit-log-path=/var/log/oauth-apiserver/audit.log\\\n          \\ \\\\\\n  --audit-log-format=json \\\\\\n  --audit-log-maxsize=100 \\\\\\n  --audit-log-maxbackup=10\\\n          \\ \\\\\\n  --etcd-cafile=/var/run/configmaps/etcd-serving-ca/ca-bundle.crt\\\n          \\ \\\\\\n  --etcd-keyfile=/var/run/secrets/etcd-client/tls.key \\\\\\n  --etcd-certfile=/var/run/secrets/etcd-client/tls.crt\\\n          \\ \\\\\\n  --shutdown-delay-duration=3s \\\\\\n  --tls-private-key-file=/var/run/secrets/serving-cert/tls.key\\\n          \\ \\\\\\n  --tls-cert-file=/var/run/secrets/serving-cert/tls.crt \\\\\\n  ${FLAGS}\\n\"\n        resources:\n          requests:\n            memory: 200Mi\n            cpu: 150m\n        securityContext:\n          privileged: true\n        ports:\n        - containerPort: 8443\n        volumeMounts:\n        - mountPath: /var/run/configmaps/audit\n          name: audit-policies\n        - mountPath: /var/run/secrets/etcd-client\n          name: etcd-client\n        - mountPath: /var/run/configmaps/etcd-serving-ca\n          name: etcd-serving-ca\n        - mountPath: /var/run/configmaps/trusted-ca-bundle\n          name: trusted-ca-bundle\n        - mountPath: /var/run/secrets/serving-cert\n          name: serving-cert\n        - mountPath: /var/run/secrets/encryption-config\n          name: encryption-config\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n        livenessProbe:\n          initialDelaySeconds: 30\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: healthz\n        readinessProbe:\n          failureThreshold: 10\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: readyz\n      volumes:\n      - name: audit-policies\n        configMap:\n          name: audit-${REVISION}\n      - name: etcd-client\n        secret:\n          secretName: etcd-client\n      - name: etcd-serving-ca\n        configMap:\n          name: etcd-serving-ca\n      - name: serving-cert\n        secret:\n          secretName: serving-cert\n      - name: trusted-ca-bundle\n        configMap:\n          name: trusted-ca-bundle\n          optional: true\n          items:\n          - key: ca-bundle.crt\n            path: tls-ca-bundle.pem\n      - name: encryption-config\n        secret:\n          secretName: encryption-config-${REVISION}\n          optional: true\n      - hostPath:\n          path: /var/log/oauth-apiserver\n        name: audit-dir\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"oauth-apiserver\" is not set to runAsNonRoot"
  },
  {
    "id": "02836",
    "manifest_path": "data/manifests/the_stack_sample/sample_1153.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: openshift-oauth-apiserver\n  name: apiserver\n  labels:\n    app: openshift-oauth-apiserver\n    apiserver: 'true'\nspec:\n  selector:\n    matchLabels:\n      app: openshift-oauth-apiserver\n      apiserver: 'true'\n  template:\n    metadata:\n      name: openshift-oauth-apiserver\n      labels:\n        app: openshift-oauth-apiserver\n        apiserver: 'true'\n    spec:\n      serviceAccountName: oauth-apiserver-sa\n      initContainers:\n      - name: fix-audit-permissions\n        image: ${IMAGE}\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - chmod 0700 /var/log/oauth-apiserver && touch /var/log/oauth-apiserver/audit.log\n          && chmod 0600 /var/log/oauth-apiserver/*\n        securityContext:\n          privileged: true\n        resources:\n          requests:\n            cpu: 15m\n            memory: 50Mi\n        volumeMounts:\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n      containers:\n      - name: oauth-apiserver\n        image: ${IMAGE}\n        imagePullPolicy: IfNotPresent\n        command:\n        - /bin/bash\n        - -ec\n        args:\n        - \"if [ -s /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem ]; then\\n\\\n          \\  echo \\\"Copying system trust bundle\\\"\\n  cp -f /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem\\\n          \\ /etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem\\nfi\\nexec oauth-apiserver\\\n          \\ start \\\\\\n  --secure-port=8443 \\\\\\n  --audit-log-path=/var/log/oauth-apiserver/audit.log\\\n          \\ \\\\\\n  --audit-log-format=json \\\\\\n  --audit-log-maxsize=100 \\\\\\n  --audit-log-maxbackup=10\\\n          \\ \\\\\\n  --etcd-cafile=/var/run/configmaps/etcd-serving-ca/ca-bundle.crt\\\n          \\ \\\\\\n  --etcd-keyfile=/var/run/secrets/etcd-client/tls.key \\\\\\n  --etcd-certfile=/var/run/secrets/etcd-client/tls.crt\\\n          \\ \\\\\\n  --shutdown-delay-duration=3s \\\\\\n  --tls-private-key-file=/var/run/secrets/serving-cert/tls.key\\\n          \\ \\\\\\n  --tls-cert-file=/var/run/secrets/serving-cert/tls.crt \\\\\\n  ${FLAGS}\\n\"\n        resources:\n          requests:\n            memory: 200Mi\n            cpu: 150m\n        securityContext:\n          privileged: true\n        ports:\n        - containerPort: 8443\n        volumeMounts:\n        - mountPath: /var/run/configmaps/audit\n          name: audit-policies\n        - mountPath: /var/run/secrets/etcd-client\n          name: etcd-client\n        - mountPath: /var/run/configmaps/etcd-serving-ca\n          name: etcd-serving-ca\n        - mountPath: /var/run/configmaps/trusted-ca-bundle\n          name: trusted-ca-bundle\n        - mountPath: /var/run/secrets/serving-cert\n          name: serving-cert\n        - mountPath: /var/run/secrets/encryption-config\n          name: encryption-config\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n        livenessProbe:\n          initialDelaySeconds: 30\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: healthz\n        readinessProbe:\n          failureThreshold: 10\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: readyz\n      volumes:\n      - name: audit-policies\n        configMap:\n          name: audit-${REVISION}\n      - name: etcd-client\n        secret:\n          secretName: etcd-client\n      - name: etcd-serving-ca\n        configMap:\n          name: etcd-serving-ca\n      - name: serving-cert\n        secret:\n          secretName: serving-cert\n      - name: trusted-ca-bundle\n        configMap:\n          name: trusted-ca-bundle\n          optional: true\n          items:\n          - key: ca-bundle.crt\n            path: tls-ca-bundle.pem\n      - name: encryption-config\n        secret:\n          secretName: encryption-config-${REVISION}\n          optional: true\n      - hostPath:\n          path: /var/log/oauth-apiserver\n        name: audit-dir\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"fix-audit-permissions\" has memory limit 0"
  },
  {
    "id": "02837",
    "manifest_path": "data/manifests/the_stack_sample/sample_1153.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: openshift-oauth-apiserver\n  name: apiserver\n  labels:\n    app: openshift-oauth-apiserver\n    apiserver: 'true'\nspec:\n  selector:\n    matchLabels:\n      app: openshift-oauth-apiserver\n      apiserver: 'true'\n  template:\n    metadata:\n      name: openshift-oauth-apiserver\n      labels:\n        app: openshift-oauth-apiserver\n        apiserver: 'true'\n    spec:\n      serviceAccountName: oauth-apiserver-sa\n      initContainers:\n      - name: fix-audit-permissions\n        image: ${IMAGE}\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - chmod 0700 /var/log/oauth-apiserver && touch /var/log/oauth-apiserver/audit.log\n          && chmod 0600 /var/log/oauth-apiserver/*\n        securityContext:\n          privileged: true\n        resources:\n          requests:\n            cpu: 15m\n            memory: 50Mi\n        volumeMounts:\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n      containers:\n      - name: oauth-apiserver\n        image: ${IMAGE}\n        imagePullPolicy: IfNotPresent\n        command:\n        - /bin/bash\n        - -ec\n        args:\n        - \"if [ -s /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem ]; then\\n\\\n          \\  echo \\\"Copying system trust bundle\\\"\\n  cp -f /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem\\\n          \\ /etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem\\nfi\\nexec oauth-apiserver\\\n          \\ start \\\\\\n  --secure-port=8443 \\\\\\n  --audit-log-path=/var/log/oauth-apiserver/audit.log\\\n          \\ \\\\\\n  --audit-log-format=json \\\\\\n  --audit-log-maxsize=100 \\\\\\n  --audit-log-maxbackup=10\\\n          \\ \\\\\\n  --etcd-cafile=/var/run/configmaps/etcd-serving-ca/ca-bundle.crt\\\n          \\ \\\\\\n  --etcd-keyfile=/var/run/secrets/etcd-client/tls.key \\\\\\n  --etcd-certfile=/var/run/secrets/etcd-client/tls.crt\\\n          \\ \\\\\\n  --shutdown-delay-duration=3s \\\\\\n  --tls-private-key-file=/var/run/secrets/serving-cert/tls.key\\\n          \\ \\\\\\n  --tls-cert-file=/var/run/secrets/serving-cert/tls.crt \\\\\\n  ${FLAGS}\\n\"\n        resources:\n          requests:\n            memory: 200Mi\n            cpu: 150m\n        securityContext:\n          privileged: true\n        ports:\n        - containerPort: 8443\n        volumeMounts:\n        - mountPath: /var/run/configmaps/audit\n          name: audit-policies\n        - mountPath: /var/run/secrets/etcd-client\n          name: etcd-client\n        - mountPath: /var/run/configmaps/etcd-serving-ca\n          name: etcd-serving-ca\n        - mountPath: /var/run/configmaps/trusted-ca-bundle\n          name: trusted-ca-bundle\n        - mountPath: /var/run/secrets/serving-cert\n          name: serving-cert\n        - mountPath: /var/run/secrets/encryption-config\n          name: encryption-config\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n        livenessProbe:\n          initialDelaySeconds: 30\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: healthz\n        readinessProbe:\n          failureThreshold: 10\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: readyz\n      volumes:\n      - name: audit-policies\n        configMap:\n          name: audit-${REVISION}\n      - name: etcd-client\n        secret:\n          secretName: etcd-client\n      - name: etcd-serving-ca\n        configMap:\n          name: etcd-serving-ca\n      - name: serving-cert\n        secret:\n          secretName: serving-cert\n      - name: trusted-ca-bundle\n        configMap:\n          name: trusted-ca-bundle\n          optional: true\n          items:\n          - key: ca-bundle.crt\n            path: tls-ca-bundle.pem\n      - name: encryption-config\n        secret:\n          secretName: encryption-config-${REVISION}\n          optional: true\n      - hostPath:\n          path: /var/log/oauth-apiserver\n        name: audit-dir\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"oauth-apiserver\" has memory limit 0"
  },
  {
    "id": "02838",
    "manifest_path": "data/manifests/the_stack_sample/sample_1155.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: readiness-pod\n  labels:\n    test: readiness\n  namespace: default\nspec:\n  containers:\n  - name: readiness\n    env:\n    - name: APP_START_DELAY\n      value: '60'\n    image: kodekloud/webapp-delayed-start\n    resources: {}\n    imagePullPolicy: Always\n    ports:\n    - containerPort: 8080\n      protocol: TCP\n    readinessProbe:\n      httpGet:\n        path: /ready\n        port: 8080\n      initialDelaySeconds: 30\n      periodSeconds: 5\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"readiness\" is using an invalid container image, \"kodekloud/webapp-delayed-start\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02839",
    "manifest_path": "data/manifests/the_stack_sample/sample_1155.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: readiness-pod\n  labels:\n    test: readiness\n  namespace: default\nspec:\n  containers:\n  - name: readiness\n    env:\n    - name: APP_START_DELAY\n      value: '60'\n    image: kodekloud/webapp-delayed-start\n    resources: {}\n    imagePullPolicy: Always\n    ports:\n    - containerPort: 8080\n      protocol: TCP\n    readinessProbe:\n      httpGet:\n        path: /ready\n        port: 8080\n      initialDelaySeconds: 30\n      periodSeconds: 5\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"readiness\" does not have a read-only root file system"
  },
  {
    "id": "02840",
    "manifest_path": "data/manifests/the_stack_sample/sample_1155.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: readiness-pod\n  labels:\n    test: readiness\n  namespace: default\nspec:\n  containers:\n  - name: readiness\n    env:\n    - name: APP_START_DELAY\n      value: '60'\n    image: kodekloud/webapp-delayed-start\n    resources: {}\n    imagePullPolicy: Always\n    ports:\n    - containerPort: 8080\n      protocol: TCP\n    readinessProbe:\n      httpGet:\n        path: /ready\n        port: 8080\n      initialDelaySeconds: 30\n      periodSeconds: 5\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"readiness\" is not set to runAsNonRoot"
  }
]