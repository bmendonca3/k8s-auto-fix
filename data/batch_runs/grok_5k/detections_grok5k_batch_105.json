[
  {
    "id": "04201",
    "manifest_path": "data/manifests/the_stack_sample/sample_1919.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-7229\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"nginx\" has cpu request 0"
  },
  {
    "id": "04202",
    "manifest_path": "data/manifests/the_stack_sample/sample_1919.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-7229\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"nginx\" has memory limit 0"
  },
  {
    "id": "04203",
    "manifest_path": "data/manifests/the_stack_sample/sample_1922.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: ibm-vpc-block-csi-node\nspec:\n  selector:\n    matchLabels:\n      app: ibm-vpc-block-csi-driver\n  template:\n    metadata:\n      annotations:\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9080'\n        prometheus.io/path: /metrics\n      labels:\n        app: ibm-vpc-block-csi-driver\n    spec:\n      serviceAccountName: ibm-vpc-block-node-sa\n      containers:\n      - name: csi-driver-registrar\n        image: MUSTPATCHWITHKUSTOMIZE\n        imagePullPolicy: Always\n        securityContext:\n          runAsNonRoot: false\n          runAsUser: 0\n          privileged: false\n        args:\n        - --v=5\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REGISTRATION_SOCK)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REGISTRATION_SOCK\n          value: /var/lib/kubelet/csi-plugins/vpc.block.csi.ibm.io/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        resources:\n          limits:\n            cpu: 100m\n            memory: 100Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n        volumeMounts:\n        - name: plugin-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n      - name: iks-vpc-block-node-driver\n        securityContext:\n          runAsNonRoot: false\n          runAsUser: 0\n          privileged: true\n        image: MUSTPATCHWITHKUSTOMIZE\n        imagePullPolicy: Always\n        args:\n        - --v=5\n        - --endpoint=unix:/csi/csi.sock\n        env:\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        envFrom:\n        - configMapRef:\n            name: ibm-vpc-block-csi-configmap\n        resources:\n          limits:\n            cpu: 200m\n            memory: 250Mi\n          requests:\n            cpu: 20m\n            memory: 50Mi\n        ports:\n        - name: healthz\n          containerPort: 9808\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 10\n          timeoutSeconds: 3\n          periodSeconds: 10\n          failureThreshold: 5\n        volumeMounts:\n        - name: kubelet-data-dir\n          mountPath: /var/data/kubelet\n          mountPropagation: Bidirectional\n        - name: plugin-dir\n          mountPath: /csi\n        - name: device-dir\n          mountPath: /dev\n        - name: etcudevpath\n          mountPath: /etc/udev\n        - name: runudevpath\n          mountPath: /run/udev\n        - name: libudevpath\n          mountPath: /lib/udev\n        - name: syspath\n          mountPath: /sys\n        - name: customer-auth\n          readOnly: true\n          mountPath: /etc/storage_ibmc\n        - name: cluster-info\n          readOnly: true\n          mountPath: /etc/storage_ibmc/cluster_info\n      - name: liveness-probe\n        image: MUSTPATCHWITHKUSTOMIZE\n        securityContext:\n          runAsNonRoot: false\n          runAsUser: 0\n          privileged: false\n        args:\n        - --csi-address=/csi/csi.sock\n        resources:\n          limits:\n            cpu: 50m\n            memory: 50Mi\n          requests:\n            cpu: 5m\n            memory: 10Mi\n        volumeMounts:\n        - name: plugin-dir\n          mountPath: /csi\n      volumes:\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-data-dir\n        hostPath:\n          path: /var/data/kubelet\n          type: Directory\n      - name: plugin-dir\n        hostPath:\n          path: /var/lib/kubelet/csi-plugins/vpc.block.csi.ibm.io/\n          type: DirectoryOrCreate\n      - name: device-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: etcudevpath\n        hostPath:\n          path: /etc/udev\n          type: Directory\n      - name: runudevpath\n        hostPath:\n          path: /run/udev\n          type: Directory\n      - name: libudevpath\n        hostPath:\n          path: /lib/udev\n          type: Directory\n      - name: syspath\n        hostPath:\n          path: /sys\n          type: Directory\n      - name: customer-auth\n        secret:\n          secretName: storage-secret-store\n      - name: cluster-info\n        configMap:\n          name: cluster-info\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"csi-driver-registrar\" is using an invalid container image, \"MUSTPATCHWITHKUSTOMIZE\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "04204",
    "manifest_path": "data/manifests/the_stack_sample/sample_1922.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: ibm-vpc-block-csi-node\nspec:\n  selector:\n    matchLabels:\n      app: ibm-vpc-block-csi-driver\n  template:\n    metadata:\n      annotations:\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9080'\n        prometheus.io/path: /metrics\n      labels:\n        app: ibm-vpc-block-csi-driver\n    spec:\n      serviceAccountName: ibm-vpc-block-node-sa\n      containers:\n      - name: csi-driver-registrar\n        image: MUSTPATCHWITHKUSTOMIZE\n        imagePullPolicy: Always\n        securityContext:\n          runAsNonRoot: false\n          runAsUser: 0\n          privileged: false\n        args:\n        - --v=5\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REGISTRATION_SOCK)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REGISTRATION_SOCK\n          value: /var/lib/kubelet/csi-plugins/vpc.block.csi.ibm.io/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        resources:\n          limits:\n            cpu: 100m\n            memory: 100Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n        volumeMounts:\n        - name: plugin-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n      - name: iks-vpc-block-node-driver\n        securityContext:\n          runAsNonRoot: false\n          runAsUser: 0\n          privileged: true\n        image: MUSTPATCHWITHKUSTOMIZE\n        imagePullPolicy: Always\n        args:\n        - --v=5\n        - --endpoint=unix:/csi/csi.sock\n        env:\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        envFrom:\n        - configMapRef:\n            name: ibm-vpc-block-csi-configmap\n        resources:\n          limits:\n            cpu: 200m\n            memory: 250Mi\n          requests:\n            cpu: 20m\n            memory: 50Mi\n        ports:\n        - name: healthz\n          containerPort: 9808\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 10\n          timeoutSeconds: 3\n          periodSeconds: 10\n          failureThreshold: 5\n        volumeMounts:\n        - name: kubelet-data-dir\n          mountPath: /var/data/kubelet\n          mountPropagation: Bidirectional\n        - name: plugin-dir\n          mountPath: /csi\n        - name: device-dir\n          mountPath: /dev\n        - name: etcudevpath\n          mountPath: /etc/udev\n        - name: runudevpath\n          mountPath: /run/udev\n        - name: libudevpath\n          mountPath: /lib/udev\n        - name: syspath\n          mountPath: /sys\n        - name: customer-auth\n          readOnly: true\n          mountPath: /etc/storage_ibmc\n        - name: cluster-info\n          readOnly: true\n          mountPath: /etc/storage_ibmc/cluster_info\n      - name: liveness-probe\n        image: MUSTPATCHWITHKUSTOMIZE\n        securityContext:\n          runAsNonRoot: false\n          runAsUser: 0\n          privileged: false\n        args:\n        - --csi-address=/csi/csi.sock\n        resources:\n          limits:\n            cpu: 50m\n            memory: 50Mi\n          requests:\n            cpu: 5m\n            memory: 10Mi\n        volumeMounts:\n        - name: plugin-dir\n          mountPath: /csi\n      volumes:\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-data-dir\n        hostPath:\n          path: /var/data/kubelet\n          type: Directory\n      - name: plugin-dir\n        hostPath:\n          path: /var/lib/kubelet/csi-plugins/vpc.block.csi.ibm.io/\n          type: DirectoryOrCreate\n      - name: device-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: etcudevpath\n        hostPath:\n          path: /etc/udev\n          type: Directory\n      - name: runudevpath\n        hostPath:\n          path: /run/udev\n          type: Directory\n      - name: libudevpath\n        hostPath:\n          path: /lib/udev\n          type: Directory\n      - name: syspath\n        hostPath:\n          path: /sys\n          type: Directory\n      - name: customer-auth\n        secret:\n          secretName: storage-secret-store\n      - name: cluster-info\n        configMap:\n          name: cluster-info\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"iks-vpc-block-node-driver\" is using an invalid container image, \"MUSTPATCHWITHKUSTOMIZE\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "04205",
    "manifest_path": "data/manifests/the_stack_sample/sample_1922.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: ibm-vpc-block-csi-node\nspec:\n  selector:\n    matchLabels:\n      app: ibm-vpc-block-csi-driver\n  template:\n    metadata:\n      annotations:\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9080'\n        prometheus.io/path: /metrics\n      labels:\n        app: ibm-vpc-block-csi-driver\n    spec:\n      serviceAccountName: ibm-vpc-block-node-sa\n      containers:\n      - name: csi-driver-registrar\n        image: MUSTPATCHWITHKUSTOMIZE\n        imagePullPolicy: Always\n        securityContext:\n          runAsNonRoot: false\n          runAsUser: 0\n          privileged: false\n        args:\n        - --v=5\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REGISTRATION_SOCK)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REGISTRATION_SOCK\n          value: /var/lib/kubelet/csi-plugins/vpc.block.csi.ibm.io/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        resources:\n          limits:\n            cpu: 100m\n            memory: 100Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n        volumeMounts:\n        - name: plugin-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n      - name: iks-vpc-block-node-driver\n        securityContext:\n          runAsNonRoot: false\n          runAsUser: 0\n          privileged: true\n        image: MUSTPATCHWITHKUSTOMIZE\n        imagePullPolicy: Always\n        args:\n        - --v=5\n        - --endpoint=unix:/csi/csi.sock\n        env:\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        envFrom:\n        - configMapRef:\n            name: ibm-vpc-block-csi-configmap\n        resources:\n          limits:\n            cpu: 200m\n            memory: 250Mi\n          requests:\n            cpu: 20m\n            memory: 50Mi\n        ports:\n        - name: healthz\n          containerPort: 9808\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 10\n          timeoutSeconds: 3\n          periodSeconds: 10\n          failureThreshold: 5\n        volumeMounts:\n        - name: kubelet-data-dir\n          mountPath: /var/data/kubelet\n          mountPropagation: Bidirectional\n        - name: plugin-dir\n          mountPath: /csi\n        - name: device-dir\n          mountPath: /dev\n        - name: etcudevpath\n          mountPath: /etc/udev\n        - name: runudevpath\n          mountPath: /run/udev\n        - name: libudevpath\n          mountPath: /lib/udev\n        - name: syspath\n          mountPath: /sys\n        - name: customer-auth\n          readOnly: true\n          mountPath: /etc/storage_ibmc\n        - name: cluster-info\n          readOnly: true\n          mountPath: /etc/storage_ibmc/cluster_info\n      - name: liveness-probe\n        image: MUSTPATCHWITHKUSTOMIZE\n        securityContext:\n          runAsNonRoot: false\n          runAsUser: 0\n          privileged: false\n        args:\n        - --csi-address=/csi/csi.sock\n        resources:\n          limits:\n            cpu: 50m\n            memory: 50Mi\n          requests:\n            cpu: 5m\n            memory: 10Mi\n        volumeMounts:\n        - name: plugin-dir\n          mountPath: /csi\n      volumes:\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-data-dir\n        hostPath:\n          path: /var/data/kubelet\n          type: Directory\n      - name: plugin-dir\n        hostPath:\n          path: /var/lib/kubelet/csi-plugins/vpc.block.csi.ibm.io/\n          type: DirectoryOrCreate\n      - name: device-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: etcudevpath\n        hostPath:\n          path: /etc/udev\n          type: Directory\n      - name: runudevpath\n        hostPath:\n          path: /run/udev\n          type: Directory\n      - name: libudevpath\n        hostPath:\n          path: /lib/udev\n          type: Directory\n      - name: syspath\n        hostPath:\n          path: /sys\n          type: Directory\n      - name: customer-auth\n        secret:\n          secretName: storage-secret-store\n      - name: cluster-info\n        configMap:\n          name: cluster-info\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"liveness-probe\" is using an invalid container image, \"MUSTPATCHWITHKUSTOMIZE\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "04206",
    "manifest_path": "data/manifests/the_stack_sample/sample_1922.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: ibm-vpc-block-csi-node\nspec:\n  selector:\n    matchLabels:\n      app: ibm-vpc-block-csi-driver\n  template:\n    metadata:\n      annotations:\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9080'\n        prometheus.io/path: /metrics\n      labels:\n        app: ibm-vpc-block-csi-driver\n    spec:\n      serviceAccountName: ibm-vpc-block-node-sa\n      containers:\n      - name: csi-driver-registrar\n        image: MUSTPATCHWITHKUSTOMIZE\n        imagePullPolicy: Always\n        securityContext:\n          runAsNonRoot: false\n          runAsUser: 0\n          privileged: false\n        args:\n        - --v=5\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REGISTRATION_SOCK)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REGISTRATION_SOCK\n          value: /var/lib/kubelet/csi-plugins/vpc.block.csi.ibm.io/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        resources:\n          limits:\n            cpu: 100m\n            memory: 100Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n        volumeMounts:\n        - name: plugin-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n      - name: iks-vpc-block-node-driver\n        securityContext:\n          runAsNonRoot: false\n          runAsUser: 0\n          privileged: true\n        image: MUSTPATCHWITHKUSTOMIZE\n        imagePullPolicy: Always\n        args:\n        - --v=5\n        - --endpoint=unix:/csi/csi.sock\n        env:\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        envFrom:\n        - configMapRef:\n            name: ibm-vpc-block-csi-configmap\n        resources:\n          limits:\n            cpu: 200m\n            memory: 250Mi\n          requests:\n            cpu: 20m\n            memory: 50Mi\n        ports:\n        - name: healthz\n          containerPort: 9808\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 10\n          timeoutSeconds: 3\n          periodSeconds: 10\n          failureThreshold: 5\n        volumeMounts:\n        - name: kubelet-data-dir\n          mountPath: /var/data/kubelet\n          mountPropagation: Bidirectional\n        - name: plugin-dir\n          mountPath: /csi\n        - name: device-dir\n          mountPath: /dev\n        - name: etcudevpath\n          mountPath: /etc/udev\n        - name: runudevpath\n          mountPath: /run/udev\n        - name: libudevpath\n          mountPath: /lib/udev\n        - name: syspath\n          mountPath: /sys\n        - name: customer-auth\n          readOnly: true\n          mountPath: /etc/storage_ibmc\n        - name: cluster-info\n          readOnly: true\n          mountPath: /etc/storage_ibmc/cluster_info\n      - name: liveness-probe\n        image: MUSTPATCHWITHKUSTOMIZE\n        securityContext:\n          runAsNonRoot: false\n          runAsUser: 0\n          privileged: false\n        args:\n        - --csi-address=/csi/csi.sock\n        resources:\n          limits:\n            cpu: 50m\n            memory: 50Mi\n          requests:\n            cpu: 5m\n            memory: 10Mi\n        volumeMounts:\n        - name: plugin-dir\n          mountPath: /csi\n      volumes:\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-data-dir\n        hostPath:\n          path: /var/data/kubelet\n          type: Directory\n      - name: plugin-dir\n        hostPath:\n          path: /var/lib/kubelet/csi-plugins/vpc.block.csi.ibm.io/\n          type: DirectoryOrCreate\n      - name: device-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: etcudevpath\n        hostPath:\n          path: /etc/udev\n          type: Directory\n      - name: runudevpath\n        hostPath:\n          path: /run/udev\n          type: Directory\n      - name: libudevpath\n        hostPath:\n          path: /lib/udev\n          type: Directory\n      - name: syspath\n        hostPath:\n          path: /sys\n          type: Directory\n      - name: customer-auth\n        secret:\n          secretName: storage-secret-store\n      - name: cluster-info\n        configMap:\n          name: cluster-info\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"csi-driver-registrar\" does not have a read-only root file system"
  },
  {
    "id": "04207",
    "manifest_path": "data/manifests/the_stack_sample/sample_1922.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: ibm-vpc-block-csi-node\nspec:\n  selector:\n    matchLabels:\n      app: ibm-vpc-block-csi-driver\n  template:\n    metadata:\n      annotations:\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9080'\n        prometheus.io/path: /metrics\n      labels:\n        app: ibm-vpc-block-csi-driver\n    spec:\n      serviceAccountName: ibm-vpc-block-node-sa\n      containers:\n      - name: csi-driver-registrar\n        image: MUSTPATCHWITHKUSTOMIZE\n        imagePullPolicy: Always\n        securityContext:\n          runAsNonRoot: false\n          runAsUser: 0\n          privileged: false\n        args:\n        - --v=5\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REGISTRATION_SOCK)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REGISTRATION_SOCK\n          value: /var/lib/kubelet/csi-plugins/vpc.block.csi.ibm.io/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        resources:\n          limits:\n            cpu: 100m\n            memory: 100Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n        volumeMounts:\n        - name: plugin-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n      - name: iks-vpc-block-node-driver\n        securityContext:\n          runAsNonRoot: false\n          runAsUser: 0\n          privileged: true\n        image: MUSTPATCHWITHKUSTOMIZE\n        imagePullPolicy: Always\n        args:\n        - --v=5\n        - --endpoint=unix:/csi/csi.sock\n        env:\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        envFrom:\n        - configMapRef:\n            name: ibm-vpc-block-csi-configmap\n        resources:\n          limits:\n            cpu: 200m\n            memory: 250Mi\n          requests:\n            cpu: 20m\n            memory: 50Mi\n        ports:\n        - name: healthz\n          containerPort: 9808\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 10\n          timeoutSeconds: 3\n          periodSeconds: 10\n          failureThreshold: 5\n        volumeMounts:\n        - name: kubelet-data-dir\n          mountPath: /var/data/kubelet\n          mountPropagation: Bidirectional\n        - name: plugin-dir\n          mountPath: /csi\n        - name: device-dir\n          mountPath: /dev\n        - name: etcudevpath\n          mountPath: /etc/udev\n        - name: runudevpath\n          mountPath: /run/udev\n        - name: libudevpath\n          mountPath: /lib/udev\n        - name: syspath\n          mountPath: /sys\n        - name: customer-auth\n          readOnly: true\n          mountPath: /etc/storage_ibmc\n        - name: cluster-info\n          readOnly: true\n          mountPath: /etc/storage_ibmc/cluster_info\n      - name: liveness-probe\n        image: MUSTPATCHWITHKUSTOMIZE\n        securityContext:\n          runAsNonRoot: false\n          runAsUser: 0\n          privileged: false\n        args:\n        - --csi-address=/csi/csi.sock\n        resources:\n          limits:\n            cpu: 50m\n            memory: 50Mi\n          requests:\n            cpu: 5m\n            memory: 10Mi\n        volumeMounts:\n        - name: plugin-dir\n          mountPath: /csi\n      volumes:\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-data-dir\n        hostPath:\n          path: /var/data/kubelet\n          type: Directory\n      - name: plugin-dir\n        hostPath:\n          path: /var/lib/kubelet/csi-plugins/vpc.block.csi.ibm.io/\n          type: DirectoryOrCreate\n      - name: device-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: etcudevpath\n        hostPath:\n          path: /etc/udev\n          type: Directory\n      - name: runudevpath\n        hostPath:\n          path: /run/udev\n          type: Directory\n      - name: libudevpath\n        hostPath:\n          path: /lib/udev\n          type: Directory\n      - name: syspath\n        hostPath:\n          path: /sys\n          type: Directory\n      - name: customer-auth\n        secret:\n          secretName: storage-secret-store\n      - name: cluster-info\n        configMap:\n          name: cluster-info\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"iks-vpc-block-node-driver\" does not have a read-only root file system"
  },
  {
    "id": "04208",
    "manifest_path": "data/manifests/the_stack_sample/sample_1922.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: ibm-vpc-block-csi-node\nspec:\n  selector:\n    matchLabels:\n      app: ibm-vpc-block-csi-driver\n  template:\n    metadata:\n      annotations:\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9080'\n        prometheus.io/path: /metrics\n      labels:\n        app: ibm-vpc-block-csi-driver\n    spec:\n      serviceAccountName: ibm-vpc-block-node-sa\n      containers:\n      - name: csi-driver-registrar\n        image: MUSTPATCHWITHKUSTOMIZE\n        imagePullPolicy: Always\n        securityContext:\n          runAsNonRoot: false\n          runAsUser: 0\n          privileged: false\n        args:\n        - --v=5\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REGISTRATION_SOCK)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REGISTRATION_SOCK\n          value: /var/lib/kubelet/csi-plugins/vpc.block.csi.ibm.io/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        resources:\n          limits:\n            cpu: 100m\n            memory: 100Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n        volumeMounts:\n        - name: plugin-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n      - name: iks-vpc-block-node-driver\n        securityContext:\n          runAsNonRoot: false\n          runAsUser: 0\n          privileged: true\n        image: MUSTPATCHWITHKUSTOMIZE\n        imagePullPolicy: Always\n        args:\n        - --v=5\n        - --endpoint=unix:/csi/csi.sock\n        env:\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        envFrom:\n        - configMapRef:\n            name: ibm-vpc-block-csi-configmap\n        resources:\n          limits:\n            cpu: 200m\n            memory: 250Mi\n          requests:\n            cpu: 20m\n            memory: 50Mi\n        ports:\n        - name: healthz\n          containerPort: 9808\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 10\n          timeoutSeconds: 3\n          periodSeconds: 10\n          failureThreshold: 5\n        volumeMounts:\n        - name: kubelet-data-dir\n          mountPath: /var/data/kubelet\n          mountPropagation: Bidirectional\n        - name: plugin-dir\n          mountPath: /csi\n        - name: device-dir\n          mountPath: /dev\n        - name: etcudevpath\n          mountPath: /etc/udev\n        - name: runudevpath\n          mountPath: /run/udev\n        - name: libudevpath\n          mountPath: /lib/udev\n        - name: syspath\n          mountPath: /sys\n        - name: customer-auth\n          readOnly: true\n          mountPath: /etc/storage_ibmc\n        - name: cluster-info\n          readOnly: true\n          mountPath: /etc/storage_ibmc/cluster_info\n      - name: liveness-probe\n        image: MUSTPATCHWITHKUSTOMIZE\n        securityContext:\n          runAsNonRoot: false\n          runAsUser: 0\n          privileged: false\n        args:\n        - --csi-address=/csi/csi.sock\n        resources:\n          limits:\n            cpu: 50m\n            memory: 50Mi\n          requests:\n            cpu: 5m\n            memory: 10Mi\n        volumeMounts:\n        - name: plugin-dir\n          mountPath: /csi\n      volumes:\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-data-dir\n        hostPath:\n          path: /var/data/kubelet\n          type: Directory\n      - name: plugin-dir\n        hostPath:\n          path: /var/lib/kubelet/csi-plugins/vpc.block.csi.ibm.io/\n          type: DirectoryOrCreate\n      - name: device-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: etcudevpath\n        hostPath:\n          path: /etc/udev\n          type: Directory\n      - name: runudevpath\n        hostPath:\n          path: /run/udev\n          type: Directory\n      - name: libudevpath\n        hostPath:\n          path: /lib/udev\n          type: Directory\n      - name: syspath\n        hostPath:\n          path: /sys\n          type: Directory\n      - name: customer-auth\n        secret:\n          secretName: storage-secret-store\n      - name: cluster-info\n        configMap:\n          name: cluster-info\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"liveness-probe\" does not have a read-only root file system"
  },
  {
    "id": "04209",
    "manifest_path": "data/manifests/the_stack_sample/sample_1922.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: ibm-vpc-block-csi-node\nspec:\n  selector:\n    matchLabels:\n      app: ibm-vpc-block-csi-driver\n  template:\n    metadata:\n      annotations:\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9080'\n        prometheus.io/path: /metrics\n      labels:\n        app: ibm-vpc-block-csi-driver\n    spec:\n      serviceAccountName: ibm-vpc-block-node-sa\n      containers:\n      - name: csi-driver-registrar\n        image: MUSTPATCHWITHKUSTOMIZE\n        imagePullPolicy: Always\n        securityContext:\n          runAsNonRoot: false\n          runAsUser: 0\n          privileged: false\n        args:\n        - --v=5\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REGISTRATION_SOCK)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REGISTRATION_SOCK\n          value: /var/lib/kubelet/csi-plugins/vpc.block.csi.ibm.io/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        resources:\n          limits:\n            cpu: 100m\n            memory: 100Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n        volumeMounts:\n        - name: plugin-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n      - name: iks-vpc-block-node-driver\n        securityContext:\n          runAsNonRoot: false\n          runAsUser: 0\n          privileged: true\n        image: MUSTPATCHWITHKUSTOMIZE\n        imagePullPolicy: Always\n        args:\n        - --v=5\n        - --endpoint=unix:/csi/csi.sock\n        env:\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        envFrom:\n        - configMapRef:\n            name: ibm-vpc-block-csi-configmap\n        resources:\n          limits:\n            cpu: 200m\n            memory: 250Mi\n          requests:\n            cpu: 20m\n            memory: 50Mi\n        ports:\n        - name: healthz\n          containerPort: 9808\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 10\n          timeoutSeconds: 3\n          periodSeconds: 10\n          failureThreshold: 5\n        volumeMounts:\n        - name: kubelet-data-dir\n          mountPath: /var/data/kubelet\n          mountPropagation: Bidirectional\n        - name: plugin-dir\n          mountPath: /csi\n        - name: device-dir\n          mountPath: /dev\n        - name: etcudevpath\n          mountPath: /etc/udev\n        - name: runudevpath\n          mountPath: /run/udev\n        - name: libudevpath\n          mountPath: /lib/udev\n        - name: syspath\n          mountPath: /sys\n        - name: customer-auth\n          readOnly: true\n          mountPath: /etc/storage_ibmc\n        - name: cluster-info\n          readOnly: true\n          mountPath: /etc/storage_ibmc/cluster_info\n      - name: liveness-probe\n        image: MUSTPATCHWITHKUSTOMIZE\n        securityContext:\n          runAsNonRoot: false\n          runAsUser: 0\n          privileged: false\n        args:\n        - --csi-address=/csi/csi.sock\n        resources:\n          limits:\n            cpu: 50m\n            memory: 50Mi\n          requests:\n            cpu: 5m\n            memory: 10Mi\n        volumeMounts:\n        - name: plugin-dir\n          mountPath: /csi\n      volumes:\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-data-dir\n        hostPath:\n          path: /var/data/kubelet\n          type: Directory\n      - name: plugin-dir\n        hostPath:\n          path: /var/lib/kubelet/csi-plugins/vpc.block.csi.ibm.io/\n          type: DirectoryOrCreate\n      - name: device-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: etcudevpath\n        hostPath:\n          path: /etc/udev\n          type: Directory\n      - name: runudevpath\n        hostPath:\n          path: /run/udev\n          type: Directory\n      - name: libudevpath\n        hostPath:\n          path: /lib/udev\n          type: Directory\n      - name: syspath\n        hostPath:\n          path: /sys\n          type: Directory\n      - name: customer-auth\n        secret:\n          secretName: storage-secret-store\n      - name: cluster-info\n        configMap:\n          name: cluster-info\n",
    "policy_id": "privilege-escalation-container",
    "violation_text": "container \"iks-vpc-block-node-driver\" is Privileged hence allows privilege escalation."
  },
  {
    "id": "04210",
    "manifest_path": "data/manifests/the_stack_sample/sample_1922.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: ibm-vpc-block-csi-node\nspec:\n  selector:\n    matchLabels:\n      app: ibm-vpc-block-csi-driver\n  template:\n    metadata:\n      annotations:\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9080'\n        prometheus.io/path: /metrics\n      labels:\n        app: ibm-vpc-block-csi-driver\n    spec:\n      serviceAccountName: ibm-vpc-block-node-sa\n      containers:\n      - name: csi-driver-registrar\n        image: MUSTPATCHWITHKUSTOMIZE\n        imagePullPolicy: Always\n        securityContext:\n          runAsNonRoot: false\n          runAsUser: 0\n          privileged: false\n        args:\n        - --v=5\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REGISTRATION_SOCK)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REGISTRATION_SOCK\n          value: /var/lib/kubelet/csi-plugins/vpc.block.csi.ibm.io/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        resources:\n          limits:\n            cpu: 100m\n            memory: 100Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n        volumeMounts:\n        - name: plugin-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n      - name: iks-vpc-block-node-driver\n        securityContext:\n          runAsNonRoot: false\n          runAsUser: 0\n          privileged: true\n        image: MUSTPATCHWITHKUSTOMIZE\n        imagePullPolicy: Always\n        args:\n        - --v=5\n        - --endpoint=unix:/csi/csi.sock\n        env:\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        envFrom:\n        - configMapRef:\n            name: ibm-vpc-block-csi-configmap\n        resources:\n          limits:\n            cpu: 200m\n            memory: 250Mi\n          requests:\n            cpu: 20m\n            memory: 50Mi\n        ports:\n        - name: healthz\n          containerPort: 9808\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 10\n          timeoutSeconds: 3\n          periodSeconds: 10\n          failureThreshold: 5\n        volumeMounts:\n        - name: kubelet-data-dir\n          mountPath: /var/data/kubelet\n          mountPropagation: Bidirectional\n        - name: plugin-dir\n          mountPath: /csi\n        - name: device-dir\n          mountPath: /dev\n        - name: etcudevpath\n          mountPath: /etc/udev\n        - name: runudevpath\n          mountPath: /run/udev\n        - name: libudevpath\n          mountPath: /lib/udev\n        - name: syspath\n          mountPath: /sys\n        - name: customer-auth\n          readOnly: true\n          mountPath: /etc/storage_ibmc\n        - name: cluster-info\n          readOnly: true\n          mountPath: /etc/storage_ibmc/cluster_info\n      - name: liveness-probe\n        image: MUSTPATCHWITHKUSTOMIZE\n        securityContext:\n          runAsNonRoot: false\n          runAsUser: 0\n          privileged: false\n        args:\n        - --csi-address=/csi/csi.sock\n        resources:\n          limits:\n            cpu: 50m\n            memory: 50Mi\n          requests:\n            cpu: 5m\n            memory: 10Mi\n        volumeMounts:\n        - name: plugin-dir\n          mountPath: /csi\n      volumes:\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-data-dir\n        hostPath:\n          path: /var/data/kubelet\n          type: Directory\n      - name: plugin-dir\n        hostPath:\n          path: /var/lib/kubelet/csi-plugins/vpc.block.csi.ibm.io/\n          type: DirectoryOrCreate\n      - name: device-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: etcudevpath\n        hostPath:\n          path: /etc/udev\n          type: Directory\n      - name: runudevpath\n        hostPath:\n          path: /run/udev\n          type: Directory\n      - name: libudevpath\n        hostPath:\n          path: /lib/udev\n          type: Directory\n      - name: syspath\n        hostPath:\n          path: /sys\n          type: Directory\n      - name: customer-auth\n        secret:\n          secretName: storage-secret-store\n      - name: cluster-info\n        configMap:\n          name: cluster-info\n",
    "policy_id": "privileged-container",
    "violation_text": "container \"iks-vpc-block-node-driver\" is privileged"
  },
  {
    "id": "04211",
    "manifest_path": "data/manifests/the_stack_sample/sample_1922.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: ibm-vpc-block-csi-node\nspec:\n  selector:\n    matchLabels:\n      app: ibm-vpc-block-csi-driver\n  template:\n    metadata:\n      annotations:\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9080'\n        prometheus.io/path: /metrics\n      labels:\n        app: ibm-vpc-block-csi-driver\n    spec:\n      serviceAccountName: ibm-vpc-block-node-sa\n      containers:\n      - name: csi-driver-registrar\n        image: MUSTPATCHWITHKUSTOMIZE\n        imagePullPolicy: Always\n        securityContext:\n          runAsNonRoot: false\n          runAsUser: 0\n          privileged: false\n        args:\n        - --v=5\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REGISTRATION_SOCK)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REGISTRATION_SOCK\n          value: /var/lib/kubelet/csi-plugins/vpc.block.csi.ibm.io/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        resources:\n          limits:\n            cpu: 100m\n            memory: 100Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n        volumeMounts:\n        - name: plugin-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n      - name: iks-vpc-block-node-driver\n        securityContext:\n          runAsNonRoot: false\n          runAsUser: 0\n          privileged: true\n        image: MUSTPATCHWITHKUSTOMIZE\n        imagePullPolicy: Always\n        args:\n        - --v=5\n        - --endpoint=unix:/csi/csi.sock\n        env:\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        envFrom:\n        - configMapRef:\n            name: ibm-vpc-block-csi-configmap\n        resources:\n          limits:\n            cpu: 200m\n            memory: 250Mi\n          requests:\n            cpu: 20m\n            memory: 50Mi\n        ports:\n        - name: healthz\n          containerPort: 9808\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 10\n          timeoutSeconds: 3\n          periodSeconds: 10\n          failureThreshold: 5\n        volumeMounts:\n        - name: kubelet-data-dir\n          mountPath: /var/data/kubelet\n          mountPropagation: Bidirectional\n        - name: plugin-dir\n          mountPath: /csi\n        - name: device-dir\n          mountPath: /dev\n        - name: etcudevpath\n          mountPath: /etc/udev\n        - name: runudevpath\n          mountPath: /run/udev\n        - name: libudevpath\n          mountPath: /lib/udev\n        - name: syspath\n          mountPath: /sys\n        - name: customer-auth\n          readOnly: true\n          mountPath: /etc/storage_ibmc\n        - name: cluster-info\n          readOnly: true\n          mountPath: /etc/storage_ibmc/cluster_info\n      - name: liveness-probe\n        image: MUSTPATCHWITHKUSTOMIZE\n        securityContext:\n          runAsNonRoot: false\n          runAsUser: 0\n          privileged: false\n        args:\n        - --csi-address=/csi/csi.sock\n        resources:\n          limits:\n            cpu: 50m\n            memory: 50Mi\n          requests:\n            cpu: 5m\n            memory: 10Mi\n        volumeMounts:\n        - name: plugin-dir\n          mountPath: /csi\n      volumes:\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-data-dir\n        hostPath:\n          path: /var/data/kubelet\n          type: Directory\n      - name: plugin-dir\n        hostPath:\n          path: /var/lib/kubelet/csi-plugins/vpc.block.csi.ibm.io/\n          type: DirectoryOrCreate\n      - name: device-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: etcudevpath\n        hostPath:\n          path: /etc/udev\n          type: Directory\n      - name: runudevpath\n        hostPath:\n          path: /run/udev\n          type: Directory\n      - name: libudevpath\n        hostPath:\n          path: /lib/udev\n          type: Directory\n      - name: syspath\n        hostPath:\n          path: /sys\n          type: Directory\n      - name: customer-auth\n        secret:\n          secretName: storage-secret-store\n      - name: cluster-info\n        configMap:\n          name: cluster-info\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"csi-driver-registrar\" is not set to runAsNonRoot"
  },
  {
    "id": "04212",
    "manifest_path": "data/manifests/the_stack_sample/sample_1922.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: ibm-vpc-block-csi-node\nspec:\n  selector:\n    matchLabels:\n      app: ibm-vpc-block-csi-driver\n  template:\n    metadata:\n      annotations:\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9080'\n        prometheus.io/path: /metrics\n      labels:\n        app: ibm-vpc-block-csi-driver\n    spec:\n      serviceAccountName: ibm-vpc-block-node-sa\n      containers:\n      - name: csi-driver-registrar\n        image: MUSTPATCHWITHKUSTOMIZE\n        imagePullPolicy: Always\n        securityContext:\n          runAsNonRoot: false\n          runAsUser: 0\n          privileged: false\n        args:\n        - --v=5\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REGISTRATION_SOCK)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REGISTRATION_SOCK\n          value: /var/lib/kubelet/csi-plugins/vpc.block.csi.ibm.io/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        resources:\n          limits:\n            cpu: 100m\n            memory: 100Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n        volumeMounts:\n        - name: plugin-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n      - name: iks-vpc-block-node-driver\n        securityContext:\n          runAsNonRoot: false\n          runAsUser: 0\n          privileged: true\n        image: MUSTPATCHWITHKUSTOMIZE\n        imagePullPolicy: Always\n        args:\n        - --v=5\n        - --endpoint=unix:/csi/csi.sock\n        env:\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        envFrom:\n        - configMapRef:\n            name: ibm-vpc-block-csi-configmap\n        resources:\n          limits:\n            cpu: 200m\n            memory: 250Mi\n          requests:\n            cpu: 20m\n            memory: 50Mi\n        ports:\n        - name: healthz\n          containerPort: 9808\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 10\n          timeoutSeconds: 3\n          periodSeconds: 10\n          failureThreshold: 5\n        volumeMounts:\n        - name: kubelet-data-dir\n          mountPath: /var/data/kubelet\n          mountPropagation: Bidirectional\n        - name: plugin-dir\n          mountPath: /csi\n        - name: device-dir\n          mountPath: /dev\n        - name: etcudevpath\n          mountPath: /etc/udev\n        - name: runudevpath\n          mountPath: /run/udev\n        - name: libudevpath\n          mountPath: /lib/udev\n        - name: syspath\n          mountPath: /sys\n        - name: customer-auth\n          readOnly: true\n          mountPath: /etc/storage_ibmc\n        - name: cluster-info\n          readOnly: true\n          mountPath: /etc/storage_ibmc/cluster_info\n      - name: liveness-probe\n        image: MUSTPATCHWITHKUSTOMIZE\n        securityContext:\n          runAsNonRoot: false\n          runAsUser: 0\n          privileged: false\n        args:\n        - --csi-address=/csi/csi.sock\n        resources:\n          limits:\n            cpu: 50m\n            memory: 50Mi\n          requests:\n            cpu: 5m\n            memory: 10Mi\n        volumeMounts:\n        - name: plugin-dir\n          mountPath: /csi\n      volumes:\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-data-dir\n        hostPath:\n          path: /var/data/kubelet\n          type: Directory\n      - name: plugin-dir\n        hostPath:\n          path: /var/lib/kubelet/csi-plugins/vpc.block.csi.ibm.io/\n          type: DirectoryOrCreate\n      - name: device-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: etcudevpath\n        hostPath:\n          path: /etc/udev\n          type: Directory\n      - name: runudevpath\n        hostPath:\n          path: /run/udev\n          type: Directory\n      - name: libudevpath\n        hostPath:\n          path: /lib/udev\n          type: Directory\n      - name: syspath\n        hostPath:\n          path: /sys\n          type: Directory\n      - name: customer-auth\n        secret:\n          secretName: storage-secret-store\n      - name: cluster-info\n        configMap:\n          name: cluster-info\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"iks-vpc-block-node-driver\" is not set to runAsNonRoot"
  },
  {
    "id": "04213",
    "manifest_path": "data/manifests/the_stack_sample/sample_1922.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: ibm-vpc-block-csi-node\nspec:\n  selector:\n    matchLabels:\n      app: ibm-vpc-block-csi-driver\n  template:\n    metadata:\n      annotations:\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9080'\n        prometheus.io/path: /metrics\n      labels:\n        app: ibm-vpc-block-csi-driver\n    spec:\n      serviceAccountName: ibm-vpc-block-node-sa\n      containers:\n      - name: csi-driver-registrar\n        image: MUSTPATCHWITHKUSTOMIZE\n        imagePullPolicy: Always\n        securityContext:\n          runAsNonRoot: false\n          runAsUser: 0\n          privileged: false\n        args:\n        - --v=5\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REGISTRATION_SOCK)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REGISTRATION_SOCK\n          value: /var/lib/kubelet/csi-plugins/vpc.block.csi.ibm.io/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        resources:\n          limits:\n            cpu: 100m\n            memory: 100Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n        volumeMounts:\n        - name: plugin-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n      - name: iks-vpc-block-node-driver\n        securityContext:\n          runAsNonRoot: false\n          runAsUser: 0\n          privileged: true\n        image: MUSTPATCHWITHKUSTOMIZE\n        imagePullPolicy: Always\n        args:\n        - --v=5\n        - --endpoint=unix:/csi/csi.sock\n        env:\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        envFrom:\n        - configMapRef:\n            name: ibm-vpc-block-csi-configmap\n        resources:\n          limits:\n            cpu: 200m\n            memory: 250Mi\n          requests:\n            cpu: 20m\n            memory: 50Mi\n        ports:\n        - name: healthz\n          containerPort: 9808\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 10\n          timeoutSeconds: 3\n          periodSeconds: 10\n          failureThreshold: 5\n        volumeMounts:\n        - name: kubelet-data-dir\n          mountPath: /var/data/kubelet\n          mountPropagation: Bidirectional\n        - name: plugin-dir\n          mountPath: /csi\n        - name: device-dir\n          mountPath: /dev\n        - name: etcudevpath\n          mountPath: /etc/udev\n        - name: runudevpath\n          mountPath: /run/udev\n        - name: libudevpath\n          mountPath: /lib/udev\n        - name: syspath\n          mountPath: /sys\n        - name: customer-auth\n          readOnly: true\n          mountPath: /etc/storage_ibmc\n        - name: cluster-info\n          readOnly: true\n          mountPath: /etc/storage_ibmc/cluster_info\n      - name: liveness-probe\n        image: MUSTPATCHWITHKUSTOMIZE\n        securityContext:\n          runAsNonRoot: false\n          runAsUser: 0\n          privileged: false\n        args:\n        - --csi-address=/csi/csi.sock\n        resources:\n          limits:\n            cpu: 50m\n            memory: 50Mi\n          requests:\n            cpu: 5m\n            memory: 10Mi\n        volumeMounts:\n        - name: plugin-dir\n          mountPath: /csi\n      volumes:\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-data-dir\n        hostPath:\n          path: /var/data/kubelet\n          type: Directory\n      - name: plugin-dir\n        hostPath:\n          path: /var/lib/kubelet/csi-plugins/vpc.block.csi.ibm.io/\n          type: DirectoryOrCreate\n      - name: device-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: etcudevpath\n        hostPath:\n          path: /etc/udev\n          type: Directory\n      - name: runudevpath\n        hostPath:\n          path: /run/udev\n          type: Directory\n      - name: libudevpath\n        hostPath:\n          path: /lib/udev\n          type: Directory\n      - name: syspath\n        hostPath:\n          path: /sys\n          type: Directory\n      - name: customer-auth\n        secret:\n          secretName: storage-secret-store\n      - name: cluster-info\n        configMap:\n          name: cluster-info\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"liveness-probe\" is not set to runAsNonRoot"
  },
  {
    "id": "04214",
    "manifest_path": "data/manifests/the_stack_sample/sample_1929.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx7\nspec:\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - name: nginx\n        image: bitnami/nginx\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"nginx\" is using an invalid container image, \"bitnami/nginx\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "04215",
    "manifest_path": "data/manifests/the_stack_sample/sample_1929.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx7\nspec:\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - name: nginx\n        image: bitnami/nginx\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"nginx\" does not have a read-only root file system"
  },
  {
    "id": "04216",
    "manifest_path": "data/manifests/the_stack_sample/sample_1929.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx7\nspec:\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - name: nginx\n        image: bitnami/nginx\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"nginx\" is not set to runAsNonRoot"
  },
  {
    "id": "04217",
    "manifest_path": "data/manifests/the_stack_sample/sample_1929.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx7\nspec:\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - name: nginx\n        image: bitnami/nginx\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"nginx\" has cpu request 0"
  },
  {
    "id": "04218",
    "manifest_path": "data/manifests/the_stack_sample/sample_1929.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx7\nspec:\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - name: nginx\n        image: bitnami/nginx\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"nginx\" has memory limit 0"
  },
  {
    "id": "04219",
    "manifest_path": "data/manifests/the_stack_sample/sample_1930.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: web\nspec:\n  selector:\n    matchLabels:\n      app: nginx\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - name: nginx\n        image: k8s.gcr.io/nginx-slim:0.8\n        ports:\n        - containerPort: 80\n          name: web\n        volumeMounts:\n        - name: www\n          mountPath: /usr/share/nginx/html\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"nginx\" does not have a read-only root file system"
  },
  {
    "id": "04220",
    "manifest_path": "data/manifests/the_stack_sample/sample_1930.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: web\nspec:\n  selector:\n    matchLabels:\n      app: nginx\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - name: nginx\n        image: k8s.gcr.io/nginx-slim:0.8\n        ports:\n        - containerPort: 80\n          name: web\n        volumeMounts:\n        - name: www\n          mountPath: /usr/share/nginx/html\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"nginx\" is not set to runAsNonRoot"
  },
  {
    "id": "04221",
    "manifest_path": "data/manifests/the_stack_sample/sample_1930.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: web\nspec:\n  selector:\n    matchLabels:\n      app: nginx\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - name: nginx\n        image: k8s.gcr.io/nginx-slim:0.8\n        ports:\n        - containerPort: 80\n          name: web\n        volumeMounts:\n        - name: www\n          mountPath: /usr/share/nginx/html\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"nginx\" has cpu request 0"
  },
  {
    "id": "04222",
    "manifest_path": "data/manifests/the_stack_sample/sample_1930.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: web\nspec:\n  selector:\n    matchLabels:\n      app: nginx\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - name: nginx\n        image: k8s.gcr.io/nginx-slim:0.8\n        ports:\n        - containerPort: 80\n          name: web\n        volumeMounts:\n        - name: www\n          mountPath: /usr/share/nginx/html\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"nginx\" has memory limit 0"
  },
  {
    "id": "04223",
    "manifest_path": "data/manifests/the_stack_sample/sample_1932.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: enmasse\n    name: address-space-controller\n  name: address-space-controller\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: enmasse\n      name: address-space-controller\n  template:\n    metadata:\n      labels:\n        app: enmasse\n        name: address-space-controller\n    spec:\n      affinity:\n        nodeAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - weight: 1\n            preference:\n              matchExpressions:\n              - key: node-role.enmasse.io/operator-infra\n                operator: In\n                values:\n                - 'true'\n      containers:\n      - env:\n        - name: JAVA_OPTS\n          value: -verbose:gc\n        - name: ENABLE_EVENT_LOGGER\n          value: 'true'\n        - name: EXPOSE_ENDPOINTS_BY_DEFAULT\n          valueFrom:\n            configMapKeyRef:\n              key: exposeEndpointsByDefault\n              name: address-space-controller-config\n              optional: true\n        - name: ENVIRONMENT\n          valueFrom:\n            configMapKeyRef:\n              key: environment\n              name: address-space-controller-config\n              optional: true\n        - name: TEMPLATE_DIR\n          value: /opt/templates\n        - name: RESOURCES_DIR\n          value: /opt\n        - name: STANDARD_AUTHSERVICE_CONFIG_NAME\n          value: keycloak-config\n        - name: STANDARD_AUTHSERVICE_CREDENTIALS_SECRET_NAME\n          value: keycloak-credentials\n        - name: STANDARD_AUTHSERVICE_CERT_SECRET_NAME\n          value: standard-authservice-cert\n        - name: WILDCARD_ENDPOINT_CERT_SECRET\n          valueFrom:\n            configMapKeyRef:\n              key: wildcardEndpointCertSecret\n              name: address-space-controller-config\n              optional: true\n        - name: RESYNC_INTERVAL\n          valueFrom:\n            configMapKeyRef:\n              key: resyncInterval\n              name: address-space-controller-config\n              optional: true\n        - name: RECHECK_INTERVAL\n          valueFrom:\n            configMapKeyRef:\n              key: recheckInterval\n              name: address-space-controller-config\n              optional: true\n        - name: IMAGE_PULL_POLICY\n          value: Always\n        - name: ROUTER_IMAGE\n          value: registry.redhat.io/amq7/amq-interconnect:1.4\n        - name: STANDARD_CONTROLLER_IMAGE\n          value: registry.redhat.io/amq7/amq-online-1-standard-controller:dev\n        - name: AGENT_IMAGE\n          value: registry.redhat.io/amq7/amq-online-1-agent:dev\n        - name: BROKER_IMAGE\n          value: registry.redhat.io/amq-broker-7/amq-broker-73-openshift:latest\n        - name: BROKER_PLUGIN_IMAGE\n          value: registry.redhat.io/amq7/amq-online-1-broker-plugin:dev\n        - name: TOPIC_FORWARDER_IMAGE\n          value: registry.redhat.io/amq7/amq-online-1-topic-forwarder:dev\n        - name: MQTT_GATEWAY_IMAGE\n          value: registry.redhat.io/amq7/amq-online-1-mqtt-gateway:dev\n        - name: MQTT_LWT_IMAGE\n          value: registry.redhat.io/amq7/amq-online-1-mqtt-lwt:dev\n        image: registry.redhat.io/amq7/amq-online-1-address-space-controller:dev\n        imagePullPolicy: Always\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: http\n            scheme: HTTP\n        name: address-space-controller\n        ports:\n        - containerPort: 8080\n          name: http\n        readinessProbe:\n          httpGet:\n            path: /healthz\n            port: http\n            scheme: HTTP\n        resources:\n          limits:\n            memory: 512Mi\n          requests:\n            memory: 256Mi\n      serviceAccountName: address-space-controller\n",
    "policy_id": "env-var-secret",
    "violation_text": "environment variable STANDARD_AUTHSERVICE_CERT_SECRET_NAME in container \"address-space-controller\" found"
  },
  {
    "id": "04224",
    "manifest_path": "data/manifests/the_stack_sample/sample_1932.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: enmasse\n    name: address-space-controller\n  name: address-space-controller\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: enmasse\n      name: address-space-controller\n  template:\n    metadata:\n      labels:\n        app: enmasse\n        name: address-space-controller\n    spec:\n      affinity:\n        nodeAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - weight: 1\n            preference:\n              matchExpressions:\n              - key: node-role.enmasse.io/operator-infra\n                operator: In\n                values:\n                - 'true'\n      containers:\n      - env:\n        - name: JAVA_OPTS\n          value: -verbose:gc\n        - name: ENABLE_EVENT_LOGGER\n          value: 'true'\n        - name: EXPOSE_ENDPOINTS_BY_DEFAULT\n          valueFrom:\n            configMapKeyRef:\n              key: exposeEndpointsByDefault\n              name: address-space-controller-config\n              optional: true\n        - name: ENVIRONMENT\n          valueFrom:\n            configMapKeyRef:\n              key: environment\n              name: address-space-controller-config\n              optional: true\n        - name: TEMPLATE_DIR\n          value: /opt/templates\n        - name: RESOURCES_DIR\n          value: /opt\n        - name: STANDARD_AUTHSERVICE_CONFIG_NAME\n          value: keycloak-config\n        - name: STANDARD_AUTHSERVICE_CREDENTIALS_SECRET_NAME\n          value: keycloak-credentials\n        - name: STANDARD_AUTHSERVICE_CERT_SECRET_NAME\n          value: standard-authservice-cert\n        - name: WILDCARD_ENDPOINT_CERT_SECRET\n          valueFrom:\n            configMapKeyRef:\n              key: wildcardEndpointCertSecret\n              name: address-space-controller-config\n              optional: true\n        - name: RESYNC_INTERVAL\n          valueFrom:\n            configMapKeyRef:\n              key: resyncInterval\n              name: address-space-controller-config\n              optional: true\n        - name: RECHECK_INTERVAL\n          valueFrom:\n            configMapKeyRef:\n              key: recheckInterval\n              name: address-space-controller-config\n              optional: true\n        - name: IMAGE_PULL_POLICY\n          value: Always\n        - name: ROUTER_IMAGE\n          value: registry.redhat.io/amq7/amq-interconnect:1.4\n        - name: STANDARD_CONTROLLER_IMAGE\n          value: registry.redhat.io/amq7/amq-online-1-standard-controller:dev\n        - name: AGENT_IMAGE\n          value: registry.redhat.io/amq7/amq-online-1-agent:dev\n        - name: BROKER_IMAGE\n          value: registry.redhat.io/amq-broker-7/amq-broker-73-openshift:latest\n        - name: BROKER_PLUGIN_IMAGE\n          value: registry.redhat.io/amq7/amq-online-1-broker-plugin:dev\n        - name: TOPIC_FORWARDER_IMAGE\n          value: registry.redhat.io/amq7/amq-online-1-topic-forwarder:dev\n        - name: MQTT_GATEWAY_IMAGE\n          value: registry.redhat.io/amq7/amq-online-1-mqtt-gateway:dev\n        - name: MQTT_LWT_IMAGE\n          value: registry.redhat.io/amq7/amq-online-1-mqtt-lwt:dev\n        image: registry.redhat.io/amq7/amq-online-1-address-space-controller:dev\n        imagePullPolicy: Always\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: http\n            scheme: HTTP\n        name: address-space-controller\n        ports:\n        - containerPort: 8080\n          name: http\n        readinessProbe:\n          httpGet:\n            path: /healthz\n            port: http\n            scheme: HTTP\n        resources:\n          limits:\n            memory: 512Mi\n          requests:\n            memory: 256Mi\n      serviceAccountName: address-space-controller\n",
    "policy_id": "env-var-secret",
    "violation_text": "environment variable STANDARD_AUTHSERVICE_CREDENTIALS_SECRET_NAME in container \"address-space-controller\" found"
  },
  {
    "id": "04225",
    "manifest_path": "data/manifests/the_stack_sample/sample_1932.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: enmasse\n    name: address-space-controller\n  name: address-space-controller\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: enmasse\n      name: address-space-controller\n  template:\n    metadata:\n      labels:\n        app: enmasse\n        name: address-space-controller\n    spec:\n      affinity:\n        nodeAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - weight: 1\n            preference:\n              matchExpressions:\n              - key: node-role.enmasse.io/operator-infra\n                operator: In\n                values:\n                - 'true'\n      containers:\n      - env:\n        - name: JAVA_OPTS\n          value: -verbose:gc\n        - name: ENABLE_EVENT_LOGGER\n          value: 'true'\n        - name: EXPOSE_ENDPOINTS_BY_DEFAULT\n          valueFrom:\n            configMapKeyRef:\n              key: exposeEndpointsByDefault\n              name: address-space-controller-config\n              optional: true\n        - name: ENVIRONMENT\n          valueFrom:\n            configMapKeyRef:\n              key: environment\n              name: address-space-controller-config\n              optional: true\n        - name: TEMPLATE_DIR\n          value: /opt/templates\n        - name: RESOURCES_DIR\n          value: /opt\n        - name: STANDARD_AUTHSERVICE_CONFIG_NAME\n          value: keycloak-config\n        - name: STANDARD_AUTHSERVICE_CREDENTIALS_SECRET_NAME\n          value: keycloak-credentials\n        - name: STANDARD_AUTHSERVICE_CERT_SECRET_NAME\n          value: standard-authservice-cert\n        - name: WILDCARD_ENDPOINT_CERT_SECRET\n          valueFrom:\n            configMapKeyRef:\n              key: wildcardEndpointCertSecret\n              name: address-space-controller-config\n              optional: true\n        - name: RESYNC_INTERVAL\n          valueFrom:\n            configMapKeyRef:\n              key: resyncInterval\n              name: address-space-controller-config\n              optional: true\n        - name: RECHECK_INTERVAL\n          valueFrom:\n            configMapKeyRef:\n              key: recheckInterval\n              name: address-space-controller-config\n              optional: true\n        - name: IMAGE_PULL_POLICY\n          value: Always\n        - name: ROUTER_IMAGE\n          value: registry.redhat.io/amq7/amq-interconnect:1.4\n        - name: STANDARD_CONTROLLER_IMAGE\n          value: registry.redhat.io/amq7/amq-online-1-standard-controller:dev\n        - name: AGENT_IMAGE\n          value: registry.redhat.io/amq7/amq-online-1-agent:dev\n        - name: BROKER_IMAGE\n          value: registry.redhat.io/amq-broker-7/amq-broker-73-openshift:latest\n        - name: BROKER_PLUGIN_IMAGE\n          value: registry.redhat.io/amq7/amq-online-1-broker-plugin:dev\n        - name: TOPIC_FORWARDER_IMAGE\n          value: registry.redhat.io/amq7/amq-online-1-topic-forwarder:dev\n        - name: MQTT_GATEWAY_IMAGE\n          value: registry.redhat.io/amq7/amq-online-1-mqtt-gateway:dev\n        - name: MQTT_LWT_IMAGE\n          value: registry.redhat.io/amq7/amq-online-1-mqtt-lwt:dev\n        image: registry.redhat.io/amq7/amq-online-1-address-space-controller:dev\n        imagePullPolicy: Always\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: http\n            scheme: HTTP\n        name: address-space-controller\n        ports:\n        - containerPort: 8080\n          name: http\n        readinessProbe:\n          httpGet:\n            path: /healthz\n            port: http\n            scheme: HTTP\n        resources:\n          limits:\n            memory: 512Mi\n          requests:\n            memory: 256Mi\n      serviceAccountName: address-space-controller\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"address-space-controller\" does not have a read-only root file system"
  },
  {
    "id": "04226",
    "manifest_path": "data/manifests/the_stack_sample/sample_1932.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: enmasse\n    name: address-space-controller\n  name: address-space-controller\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: enmasse\n      name: address-space-controller\n  template:\n    metadata:\n      labels:\n        app: enmasse\n        name: address-space-controller\n    spec:\n      affinity:\n        nodeAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - weight: 1\n            preference:\n              matchExpressions:\n              - key: node-role.enmasse.io/operator-infra\n                operator: In\n                values:\n                - 'true'\n      containers:\n      - env:\n        - name: JAVA_OPTS\n          value: -verbose:gc\n        - name: ENABLE_EVENT_LOGGER\n          value: 'true'\n        - name: EXPOSE_ENDPOINTS_BY_DEFAULT\n          valueFrom:\n            configMapKeyRef:\n              key: exposeEndpointsByDefault\n              name: address-space-controller-config\n              optional: true\n        - name: ENVIRONMENT\n          valueFrom:\n            configMapKeyRef:\n              key: environment\n              name: address-space-controller-config\n              optional: true\n        - name: TEMPLATE_DIR\n          value: /opt/templates\n        - name: RESOURCES_DIR\n          value: /opt\n        - name: STANDARD_AUTHSERVICE_CONFIG_NAME\n          value: keycloak-config\n        - name: STANDARD_AUTHSERVICE_CREDENTIALS_SECRET_NAME\n          value: keycloak-credentials\n        - name: STANDARD_AUTHSERVICE_CERT_SECRET_NAME\n          value: standard-authservice-cert\n        - name: WILDCARD_ENDPOINT_CERT_SECRET\n          valueFrom:\n            configMapKeyRef:\n              key: wildcardEndpointCertSecret\n              name: address-space-controller-config\n              optional: true\n        - name: RESYNC_INTERVAL\n          valueFrom:\n            configMapKeyRef:\n              key: resyncInterval\n              name: address-space-controller-config\n              optional: true\n        - name: RECHECK_INTERVAL\n          valueFrom:\n            configMapKeyRef:\n              key: recheckInterval\n              name: address-space-controller-config\n              optional: true\n        - name: IMAGE_PULL_POLICY\n          value: Always\n        - name: ROUTER_IMAGE\n          value: registry.redhat.io/amq7/amq-interconnect:1.4\n        - name: STANDARD_CONTROLLER_IMAGE\n          value: registry.redhat.io/amq7/amq-online-1-standard-controller:dev\n        - name: AGENT_IMAGE\n          value: registry.redhat.io/amq7/amq-online-1-agent:dev\n        - name: BROKER_IMAGE\n          value: registry.redhat.io/amq-broker-7/amq-broker-73-openshift:latest\n        - name: BROKER_PLUGIN_IMAGE\n          value: registry.redhat.io/amq7/amq-online-1-broker-plugin:dev\n        - name: TOPIC_FORWARDER_IMAGE\n          value: registry.redhat.io/amq7/amq-online-1-topic-forwarder:dev\n        - name: MQTT_GATEWAY_IMAGE\n          value: registry.redhat.io/amq7/amq-online-1-mqtt-gateway:dev\n        - name: MQTT_LWT_IMAGE\n          value: registry.redhat.io/amq7/amq-online-1-mqtt-lwt:dev\n        image: registry.redhat.io/amq7/amq-online-1-address-space-controller:dev\n        imagePullPolicy: Always\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: http\n            scheme: HTTP\n        name: address-space-controller\n        ports:\n        - containerPort: 8080\n          name: http\n        readinessProbe:\n          httpGet:\n            path: /healthz\n            port: http\n            scheme: HTTP\n        resources:\n          limits:\n            memory: 512Mi\n          requests:\n            memory: 256Mi\n      serviceAccountName: address-space-controller\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"address-space-controller\" is not set to runAsNonRoot"
  },
  {
    "id": "04227",
    "manifest_path": "data/manifests/the_stack_sample/sample_1932.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: enmasse\n    name: address-space-controller\n  name: address-space-controller\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: enmasse\n      name: address-space-controller\n  template:\n    metadata:\n      labels:\n        app: enmasse\n        name: address-space-controller\n    spec:\n      affinity:\n        nodeAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - weight: 1\n            preference:\n              matchExpressions:\n              - key: node-role.enmasse.io/operator-infra\n                operator: In\n                values:\n                - 'true'\n      containers:\n      - env:\n        - name: JAVA_OPTS\n          value: -verbose:gc\n        - name: ENABLE_EVENT_LOGGER\n          value: 'true'\n        - name: EXPOSE_ENDPOINTS_BY_DEFAULT\n          valueFrom:\n            configMapKeyRef:\n              key: exposeEndpointsByDefault\n              name: address-space-controller-config\n              optional: true\n        - name: ENVIRONMENT\n          valueFrom:\n            configMapKeyRef:\n              key: environment\n              name: address-space-controller-config\n              optional: true\n        - name: TEMPLATE_DIR\n          value: /opt/templates\n        - name: RESOURCES_DIR\n          value: /opt\n        - name: STANDARD_AUTHSERVICE_CONFIG_NAME\n          value: keycloak-config\n        - name: STANDARD_AUTHSERVICE_CREDENTIALS_SECRET_NAME\n          value: keycloak-credentials\n        - name: STANDARD_AUTHSERVICE_CERT_SECRET_NAME\n          value: standard-authservice-cert\n        - name: WILDCARD_ENDPOINT_CERT_SECRET\n          valueFrom:\n            configMapKeyRef:\n              key: wildcardEndpointCertSecret\n              name: address-space-controller-config\n              optional: true\n        - name: RESYNC_INTERVAL\n          valueFrom:\n            configMapKeyRef:\n              key: resyncInterval\n              name: address-space-controller-config\n              optional: true\n        - name: RECHECK_INTERVAL\n          valueFrom:\n            configMapKeyRef:\n              key: recheckInterval\n              name: address-space-controller-config\n              optional: true\n        - name: IMAGE_PULL_POLICY\n          value: Always\n        - name: ROUTER_IMAGE\n          value: registry.redhat.io/amq7/amq-interconnect:1.4\n        - name: STANDARD_CONTROLLER_IMAGE\n          value: registry.redhat.io/amq7/amq-online-1-standard-controller:dev\n        - name: AGENT_IMAGE\n          value: registry.redhat.io/amq7/amq-online-1-agent:dev\n        - name: BROKER_IMAGE\n          value: registry.redhat.io/amq-broker-7/amq-broker-73-openshift:latest\n        - name: BROKER_PLUGIN_IMAGE\n          value: registry.redhat.io/amq7/amq-online-1-broker-plugin:dev\n        - name: TOPIC_FORWARDER_IMAGE\n          value: registry.redhat.io/amq7/amq-online-1-topic-forwarder:dev\n        - name: MQTT_GATEWAY_IMAGE\n          value: registry.redhat.io/amq7/amq-online-1-mqtt-gateway:dev\n        - name: MQTT_LWT_IMAGE\n          value: registry.redhat.io/amq7/amq-online-1-mqtt-lwt:dev\n        image: registry.redhat.io/amq7/amq-online-1-address-space-controller:dev\n        imagePullPolicy: Always\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: http\n            scheme: HTTP\n        name: address-space-controller\n        ports:\n        - containerPort: 8080\n          name: http\n        readinessProbe:\n          httpGet:\n            path: /healthz\n            port: http\n            scheme: HTTP\n        resources:\n          limits:\n            memory: 512Mi\n          requests:\n            memory: 256Mi\n      serviceAccountName: address-space-controller\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"address-space-controller\" has cpu request 0"
  },
  {
    "id": "04228",
    "manifest_path": "data/manifests/the_stack_sample/sample_1933.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: dc-api\n  labels:\n    app: dc-api\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: dc-api\n  template:\n    metadata:\n      labels:\n        app: dc-api\n    spec:\n      containers:\n      - name: dc-api\n        image: gcr.io/neural-pattern-278618/dc-api\n        imagePullPolicy: Always\n        ports:\n        - containerPort: 8080\n        envFrom:\n        - configMapRef:\n            name: dc-api\n        - secretRef:\n            name: dc-api\n        - secretRef:\n            name: postgres\n        resources:\n          limits:\n            cpu: '0.3'\n          requests:\n            cpu: '0.3'\n        readinessProbe:\n          httpGet:\n            path: /health\n            port: 8080\n          initialDelaySeconds: 10\n          periodSeconds: 3\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: 8080\n          periodSeconds: 5\n          initialDelaySeconds: 200\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"dc-api\" is using an invalid container image, \"gcr.io/neural-pattern-278618/dc-api\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "04229",
    "manifest_path": "data/manifests/the_stack_sample/sample_1933.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: dc-api\n  labels:\n    app: dc-api\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: dc-api\n  template:\n    metadata:\n      labels:\n        app: dc-api\n    spec:\n      containers:\n      - name: dc-api\n        image: gcr.io/neural-pattern-278618/dc-api\n        imagePullPolicy: Always\n        ports:\n        - containerPort: 8080\n        envFrom:\n        - configMapRef:\n            name: dc-api\n        - secretRef:\n            name: dc-api\n        - secretRef:\n            name: postgres\n        resources:\n          limits:\n            cpu: '0.3'\n          requests:\n            cpu: '0.3'\n        readinessProbe:\n          httpGet:\n            path: /health\n            port: 8080\n          initialDelaySeconds: 10\n          periodSeconds: 3\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: 8080\n          periodSeconds: 5\n          initialDelaySeconds: 200\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"dc-api\" does not have a read-only root file system"
  },
  {
    "id": "04230",
    "manifest_path": "data/manifests/the_stack_sample/sample_1933.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: dc-api\n  labels:\n    app: dc-api\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: dc-api\n  template:\n    metadata:\n      labels:\n        app: dc-api\n    spec:\n      containers:\n      - name: dc-api\n        image: gcr.io/neural-pattern-278618/dc-api\n        imagePullPolicy: Always\n        ports:\n        - containerPort: 8080\n        envFrom:\n        - configMapRef:\n            name: dc-api\n        - secretRef:\n            name: dc-api\n        - secretRef:\n            name: postgres\n        resources:\n          limits:\n            cpu: '0.3'\n          requests:\n            cpu: '0.3'\n        readinessProbe:\n          httpGet:\n            path: /health\n            port: 8080\n          initialDelaySeconds: 10\n          periodSeconds: 3\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: 8080\n          periodSeconds: 5\n          initialDelaySeconds: 200\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"dc-api\" is not set to runAsNonRoot"
  },
  {
    "id": "04231",
    "manifest_path": "data/manifests/the_stack_sample/sample_1933.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: dc-api\n  labels:\n    app: dc-api\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: dc-api\n  template:\n    metadata:\n      labels:\n        app: dc-api\n    spec:\n      containers:\n      - name: dc-api\n        image: gcr.io/neural-pattern-278618/dc-api\n        imagePullPolicy: Always\n        ports:\n        - containerPort: 8080\n        envFrom:\n        - configMapRef:\n            name: dc-api\n        - secretRef:\n            name: dc-api\n        - secretRef:\n            name: postgres\n        resources:\n          limits:\n            cpu: '0.3'\n          requests:\n            cpu: '0.3'\n        readinessProbe:\n          httpGet:\n            path: /health\n            port: 8080\n          initialDelaySeconds: 10\n          periodSeconds: 3\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: 8080\n          periodSeconds: 5\n          initialDelaySeconds: 200\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"dc-api\" has memory limit 0"
  },
  {
    "id": "04232",
    "manifest_path": "data/manifests/the_stack_sample/sample_1934.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: foo\n  name: foo\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: foo\n  template:\n    metadata:\n      labels:\n        app: foo\n    spec:\n      containers:\n      - image: dgkanatsios/simpleapp\n        name: simpleapp\n        ports:\n        - containerPort: 8080\n        resources: {}\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"simpleapp\" is using an invalid container image, \"dgkanatsios/simpleapp\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "04233",
    "manifest_path": "data/manifests/the_stack_sample/sample_1934.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: foo\n  name: foo\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: foo\n  template:\n    metadata:\n      labels:\n        app: foo\n    spec:\n      containers:\n      - image: dgkanatsios/simpleapp\n        name: simpleapp\n        ports:\n        - containerPort: 8080\n        resources: {}\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"simpleapp\" does not have a read-only root file system"
  },
  {
    "id": "04234",
    "manifest_path": "data/manifests/the_stack_sample/sample_1934.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: foo\n  name: foo\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: foo\n  template:\n    metadata:\n      labels:\n        app: foo\n    spec:\n      containers:\n      - image: dgkanatsios/simpleapp\n        name: simpleapp\n        ports:\n        - containerPort: 8080\n        resources: {}\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"simpleapp\" is not set to runAsNonRoot"
  },
  {
    "id": "04235",
    "manifest_path": "data/manifests/the_stack_sample/sample_1934.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: foo\n  name: foo\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: foo\n  template:\n    metadata:\n      labels:\n        app: foo\n    spec:\n      containers:\n      - image: dgkanatsios/simpleapp\n        name: simpleapp\n        ports:\n        - containerPort: 8080\n        resources: {}\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"simpleapp\" has cpu request 0"
  },
  {
    "id": "04236",
    "manifest_path": "data/manifests/the_stack_sample/sample_1934.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: foo\n  name: foo\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: foo\n  template:\n    metadata:\n      labels:\n        app: foo\n    spec:\n      containers:\n      - image: dgkanatsios/simpleapp\n        name: simpleapp\n        ports:\n        - containerPort: 8080\n        resources: {}\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"simpleapp\" has memory limit 0"
  },
  {
    "id": "04237",
    "manifest_path": "data/manifests/the_stack_sample/sample_1938.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: banias-frontend\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: banias-frontend\n  template:\n    metadata:\n      labels:\n        app: banias-frontend\n        k8s-app: banias-frontend\n    spec:\n      initContainers:\n      - name: init-sysctl\n        image: busybox\n        command:\n        - /bin/sh\n        - -c\n        - 'sysctl -w net.ipv4.ip_forward=0\n\n          sysctl -w net.ipv4.conf.default.rp_filter=1\n\n          sysctl -w net.ipv4.conf.default.accept_source_route=0\n\n          sysctl -w net.ipv4.icmp_echo_ignore_broadcasts=1\n\n          sysctl -w net.ipv4.icmp_ignore_bogus_error_responses=1\n\n          sysctl -w kernel.msgmnb=65536\n\n          sysctl -w kernel.msgmax=65536\n\n          sysctl -w kernel.shmmax=68719476736\n\n          sysctl -w kernel.shmall=4294967296\n\n          sysctl -w net.core.somaxconn=50000\n\n          sysctl -w fs.file-max=100000\n\n          sysctl -w net.ipv4.tcp_syncookies=1\n\n          sysctl -w net.ipv4.conf.all.log_martians=0\n\n          sysctl -w net.core.somaxconn=50000\n\n          sysctl -w net.ipv4.tcp_max_syn_backlog=30000\n\n          sysctl -w net.ipv4.conf.all.send_redirects=0\n\n          sysctl -w net.ipv4.conf.all.accept_redirects=0\n\n          sysctl -w net.ipv4.conf.all.accept_source_route=0\n\n          sysctl -w net.ipv6.conf.all.forwarding=0\n\n          sysctl -w net.ipv4.tcp_slow_start_after_idle=0\n\n          sysctl -w net.ipv4.tcp_window_scaling=1\n\n          sysctl -w net.ipv4.tcp_timestamp=1\n\n          sysctl -w net.ipv4.tcp_sack=1\n\n          sysctl -w net.ipv4.tcp_congestion_control=htcp\n\n          sysctl -w net.ipv4.tcp_keepalive_time=60\n\n          sysctl -w net.netfilter.nf_conntrack_tcp_timeout_time_wait=10\n\n          sysctl -w net.netfilter.nf_conntrack_tcp_timeout_established=300\n\n          sysctl -w net.netfilter.nf_conntrack_generic_timeout=300\n\n          sysctl -w net.ipv4.tcp_max_tw_buckets=2000000\n\n          sysctl -w net.ipv4.tcp_fin_timeout=10\n\n          sysctl -w net.ipv4.tcp_tw_reuse=1\n\n          sysctl -w net.ipv4.tcp_keepalive_intvl=15\n\n          sysctl -w net.ipv4.tcp_keepalive_probes=5\n\n          '\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          privileged: true\n      containers:\n      - name: banias-frontend\n        image: gcr.io/my-project/banias-frontend:test\n        resources:\n          limits:\n            cpu: '3'\n            memory: 12G\n          requests:\n            cpu: 500m\n            memory: 200Mi\n        volumeMounts:\n        - name: google-cloud-key\n          mountPath: /var/secrets/google\n        ports:\n        - name: http\n          containerPort: 8081\n        - name: prom-metrics\n          containerPort: 8080\n        env:\n        - name: BANIAS_PROJECTID\n          valueFrom:\n            configMapKeyRef:\n              key: BANIAS_PROJECTID\n              name: banias-frontend-config\n        - name: BANIAS_DEBUG\n          valueFrom:\n            configMapKeyRef:\n              key: BANIAS_DEBUG\n              name: banias-frontend-config\n        - name: BANIAS_TOPIC\n          valueFrom:\n            configMapKeyRef:\n              key: BANIAS_TOPIC\n              name: banias-frontend-config\n        - name: BANIAS_PORT\n          valueFrom:\n            configMapKeyRef:\n              key: BANIAS_PORT\n              name: banias-frontend-config\n        - name: BANIAS_METRICSPORT\n          valueFrom:\n            configMapKeyRef:\n              key: BANIAS_METRICSPORT\n              name: banias-frontend-config\n        - name: BANIAS_PUBSUBMAXBATCH\n          valueFrom:\n            configMapKeyRef:\n              key: BANIAS_PUBSUBMAXBATCH\n              name: banias-frontend-config\n        - name: BANIAS_PUBSUBAGGRIGATORS\n          valueFrom:\n            configMapKeyRef:\n              key: BANIAS_PUBSUBAGGRIGATORS\n              name: banias-frontend-config\n        - name: BANIAS_PUBSUBMAXPUBLISHDELAY\n          valueFrom:\n            configMapKeyRef:\n              key: BANIAS_PUBSUBMAXPUBLISHDELAY\n              name: banias-frontend-config\n        - name: BANIAS_MAXPUBSUBGOROUTINESAMOUNT\n          valueFrom:\n            configMapKeyRef:\n              key: BANIAS_MAXPUBSUBGOROUTINESAMOUNT\n              name: banias-frontend-config\n        - name: BANIAS_MAXPUBSUBGOROUTINEIDLEDURATION\n          valueFrom:\n            configMapKeyRef:\n              key: BANIAS_MAXPUBSUBGOROUTINEIDLEDURATION\n              name: banias-frontend-config\n        - name: GOOGLE_APPLICATION_CREDENTIALS\n          value: /var/secrets/google/key.json\n        imagePullPolicy: Always\n      volumes:\n      - name: google-cloud-key\n        secret:\n          secretName: pubsub-key\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"init-sysctl\" is using an invalid container image, \"busybox\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "04238",
    "manifest_path": "data/manifests/the_stack_sample/sample_1938.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: banias-frontend\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: banias-frontend\n  template:\n    metadata:\n      labels:\n        app: banias-frontend\n        k8s-app: banias-frontend\n    spec:\n      initContainers:\n      - name: init-sysctl\n        image: busybox\n        command:\n        - /bin/sh\n        - -c\n        - 'sysctl -w net.ipv4.ip_forward=0\n\n          sysctl -w net.ipv4.conf.default.rp_filter=1\n\n          sysctl -w net.ipv4.conf.default.accept_source_route=0\n\n          sysctl -w net.ipv4.icmp_echo_ignore_broadcasts=1\n\n          sysctl -w net.ipv4.icmp_ignore_bogus_error_responses=1\n\n          sysctl -w kernel.msgmnb=65536\n\n          sysctl -w kernel.msgmax=65536\n\n          sysctl -w kernel.shmmax=68719476736\n\n          sysctl -w kernel.shmall=4294967296\n\n          sysctl -w net.core.somaxconn=50000\n\n          sysctl -w fs.file-max=100000\n\n          sysctl -w net.ipv4.tcp_syncookies=1\n\n          sysctl -w net.ipv4.conf.all.log_martians=0\n\n          sysctl -w net.core.somaxconn=50000\n\n          sysctl -w net.ipv4.tcp_max_syn_backlog=30000\n\n          sysctl -w net.ipv4.conf.all.send_redirects=0\n\n          sysctl -w net.ipv4.conf.all.accept_redirects=0\n\n          sysctl -w net.ipv4.conf.all.accept_source_route=0\n\n          sysctl -w net.ipv6.conf.all.forwarding=0\n\n          sysctl -w net.ipv4.tcp_slow_start_after_idle=0\n\n          sysctl -w net.ipv4.tcp_window_scaling=1\n\n          sysctl -w net.ipv4.tcp_timestamp=1\n\n          sysctl -w net.ipv4.tcp_sack=1\n\n          sysctl -w net.ipv4.tcp_congestion_control=htcp\n\n          sysctl -w net.ipv4.tcp_keepalive_time=60\n\n          sysctl -w net.netfilter.nf_conntrack_tcp_timeout_time_wait=10\n\n          sysctl -w net.netfilter.nf_conntrack_tcp_timeout_established=300\n\n          sysctl -w net.netfilter.nf_conntrack_generic_timeout=300\n\n          sysctl -w net.ipv4.tcp_max_tw_buckets=2000000\n\n          sysctl -w net.ipv4.tcp_fin_timeout=10\n\n          sysctl -w net.ipv4.tcp_tw_reuse=1\n\n          sysctl -w net.ipv4.tcp_keepalive_intvl=15\n\n          sysctl -w net.ipv4.tcp_keepalive_probes=5\n\n          '\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          privileged: true\n      containers:\n      - name: banias-frontend\n        image: gcr.io/my-project/banias-frontend:test\n        resources:\n          limits:\n            cpu: '3'\n            memory: 12G\n          requests:\n            cpu: 500m\n            memory: 200Mi\n        volumeMounts:\n        - name: google-cloud-key\n          mountPath: /var/secrets/google\n        ports:\n        - name: http\n          containerPort: 8081\n        - name: prom-metrics\n          containerPort: 8080\n        env:\n        - name: BANIAS_PROJECTID\n          valueFrom:\n            configMapKeyRef:\n              key: BANIAS_PROJECTID\n              name: banias-frontend-config\n        - name: BANIAS_DEBUG\n          valueFrom:\n            configMapKeyRef:\n              key: BANIAS_DEBUG\n              name: banias-frontend-config\n        - name: BANIAS_TOPIC\n          valueFrom:\n            configMapKeyRef:\n              key: BANIAS_TOPIC\n              name: banias-frontend-config\n        - name: BANIAS_PORT\n          valueFrom:\n            configMapKeyRef:\n              key: BANIAS_PORT\n              name: banias-frontend-config\n        - name: BANIAS_METRICSPORT\n          valueFrom:\n            configMapKeyRef:\n              key: BANIAS_METRICSPORT\n              name: banias-frontend-config\n        - name: BANIAS_PUBSUBMAXBATCH\n          valueFrom:\n            configMapKeyRef:\n              key: BANIAS_PUBSUBMAXBATCH\n              name: banias-frontend-config\n        - name: BANIAS_PUBSUBAGGRIGATORS\n          valueFrom:\n            configMapKeyRef:\n              key: BANIAS_PUBSUBAGGRIGATORS\n              name: banias-frontend-config\n        - name: BANIAS_PUBSUBMAXPUBLISHDELAY\n          valueFrom:\n            configMapKeyRef:\n              key: BANIAS_PUBSUBMAXPUBLISHDELAY\n              name: banias-frontend-config\n        - name: BANIAS_MAXPUBSUBGOROUTINESAMOUNT\n          valueFrom:\n            configMapKeyRef:\n              key: BANIAS_MAXPUBSUBGOROUTINESAMOUNT\n              name: banias-frontend-config\n        - name: BANIAS_MAXPUBSUBGOROUTINEIDLEDURATION\n          valueFrom:\n            configMapKeyRef:\n              key: BANIAS_MAXPUBSUBGOROUTINEIDLEDURATION\n              name: banias-frontend-config\n        - name: GOOGLE_APPLICATION_CREDENTIALS\n          value: /var/secrets/google/key.json\n        imagePullPolicy: Always\n      volumes:\n      - name: google-cloud-key\n        secret:\n          secretName: pubsub-key\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"banias-frontend\" does not have a read-only root file system"
  },
  {
    "id": "04239",
    "manifest_path": "data/manifests/the_stack_sample/sample_1938.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: banias-frontend\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: banias-frontend\n  template:\n    metadata:\n      labels:\n        app: banias-frontend\n        k8s-app: banias-frontend\n    spec:\n      initContainers:\n      - name: init-sysctl\n        image: busybox\n        command:\n        - /bin/sh\n        - -c\n        - 'sysctl -w net.ipv4.ip_forward=0\n\n          sysctl -w net.ipv4.conf.default.rp_filter=1\n\n          sysctl -w net.ipv4.conf.default.accept_source_route=0\n\n          sysctl -w net.ipv4.icmp_echo_ignore_broadcasts=1\n\n          sysctl -w net.ipv4.icmp_ignore_bogus_error_responses=1\n\n          sysctl -w kernel.msgmnb=65536\n\n          sysctl -w kernel.msgmax=65536\n\n          sysctl -w kernel.shmmax=68719476736\n\n          sysctl -w kernel.shmall=4294967296\n\n          sysctl -w net.core.somaxconn=50000\n\n          sysctl -w fs.file-max=100000\n\n          sysctl -w net.ipv4.tcp_syncookies=1\n\n          sysctl -w net.ipv4.conf.all.log_martians=0\n\n          sysctl -w net.core.somaxconn=50000\n\n          sysctl -w net.ipv4.tcp_max_syn_backlog=30000\n\n          sysctl -w net.ipv4.conf.all.send_redirects=0\n\n          sysctl -w net.ipv4.conf.all.accept_redirects=0\n\n          sysctl -w net.ipv4.conf.all.accept_source_route=0\n\n          sysctl -w net.ipv6.conf.all.forwarding=0\n\n          sysctl -w net.ipv4.tcp_slow_start_after_idle=0\n\n          sysctl -w net.ipv4.tcp_window_scaling=1\n\n          sysctl -w net.ipv4.tcp_timestamp=1\n\n          sysctl -w net.ipv4.tcp_sack=1\n\n          sysctl -w net.ipv4.tcp_congestion_control=htcp\n\n          sysctl -w net.ipv4.tcp_keepalive_time=60\n\n          sysctl -w net.netfilter.nf_conntrack_tcp_timeout_time_wait=10\n\n          sysctl -w net.netfilter.nf_conntrack_tcp_timeout_established=300\n\n          sysctl -w net.netfilter.nf_conntrack_generic_timeout=300\n\n          sysctl -w net.ipv4.tcp_max_tw_buckets=2000000\n\n          sysctl -w net.ipv4.tcp_fin_timeout=10\n\n          sysctl -w net.ipv4.tcp_tw_reuse=1\n\n          sysctl -w net.ipv4.tcp_keepalive_intvl=15\n\n          sysctl -w net.ipv4.tcp_keepalive_probes=5\n\n          '\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          privileged: true\n      containers:\n      - name: banias-frontend\n        image: gcr.io/my-project/banias-frontend:test\n        resources:\n          limits:\n            cpu: '3'\n            memory: 12G\n          requests:\n            cpu: 500m\n            memory: 200Mi\n        volumeMounts:\n        - name: google-cloud-key\n          mountPath: /var/secrets/google\n        ports:\n        - name: http\n          containerPort: 8081\n        - name: prom-metrics\n          containerPort: 8080\n        env:\n        - name: BANIAS_PROJECTID\n          valueFrom:\n            configMapKeyRef:\n              key: BANIAS_PROJECTID\n              name: banias-frontend-config\n        - name: BANIAS_DEBUG\n          valueFrom:\n            configMapKeyRef:\n              key: BANIAS_DEBUG\n              name: banias-frontend-config\n        - name: BANIAS_TOPIC\n          valueFrom:\n            configMapKeyRef:\n              key: BANIAS_TOPIC\n              name: banias-frontend-config\n        - name: BANIAS_PORT\n          valueFrom:\n            configMapKeyRef:\n              key: BANIAS_PORT\n              name: banias-frontend-config\n        - name: BANIAS_METRICSPORT\n          valueFrom:\n            configMapKeyRef:\n              key: BANIAS_METRICSPORT\n              name: banias-frontend-config\n        - name: BANIAS_PUBSUBMAXBATCH\n          valueFrom:\n            configMapKeyRef:\n              key: BANIAS_PUBSUBMAXBATCH\n              name: banias-frontend-config\n        - name: BANIAS_PUBSUBAGGRIGATORS\n          valueFrom:\n            configMapKeyRef:\n              key: BANIAS_PUBSUBAGGRIGATORS\n              name: banias-frontend-config\n        - name: BANIAS_PUBSUBMAXPUBLISHDELAY\n          valueFrom:\n            configMapKeyRef:\n              key: BANIAS_PUBSUBMAXPUBLISHDELAY\n              name: banias-frontend-config\n        - name: BANIAS_MAXPUBSUBGOROUTINESAMOUNT\n          valueFrom:\n            configMapKeyRef:\n              key: BANIAS_MAXPUBSUBGOROUTINESAMOUNT\n              name: banias-frontend-config\n        - name: BANIAS_MAXPUBSUBGOROUTINEIDLEDURATION\n          valueFrom:\n            configMapKeyRef:\n              key: BANIAS_MAXPUBSUBGOROUTINEIDLEDURATION\n              name: banias-frontend-config\n        - name: GOOGLE_APPLICATION_CREDENTIALS\n          value: /var/secrets/google/key.json\n        imagePullPolicy: Always\n      volumes:\n      - name: google-cloud-key\n        secret:\n          secretName: pubsub-key\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"init-sysctl\" does not have a read-only root file system"
  },
  {
    "id": "04240",
    "manifest_path": "data/manifests/the_stack_sample/sample_1938.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: banias-frontend\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: banias-frontend\n  template:\n    metadata:\n      labels:\n        app: banias-frontend\n        k8s-app: banias-frontend\n    spec:\n      initContainers:\n      - name: init-sysctl\n        image: busybox\n        command:\n        - /bin/sh\n        - -c\n        - 'sysctl -w net.ipv4.ip_forward=0\n\n          sysctl -w net.ipv4.conf.default.rp_filter=1\n\n          sysctl -w net.ipv4.conf.default.accept_source_route=0\n\n          sysctl -w net.ipv4.icmp_echo_ignore_broadcasts=1\n\n          sysctl -w net.ipv4.icmp_ignore_bogus_error_responses=1\n\n          sysctl -w kernel.msgmnb=65536\n\n          sysctl -w kernel.msgmax=65536\n\n          sysctl -w kernel.shmmax=68719476736\n\n          sysctl -w kernel.shmall=4294967296\n\n          sysctl -w net.core.somaxconn=50000\n\n          sysctl -w fs.file-max=100000\n\n          sysctl -w net.ipv4.tcp_syncookies=1\n\n          sysctl -w net.ipv4.conf.all.log_martians=0\n\n          sysctl -w net.core.somaxconn=50000\n\n          sysctl -w net.ipv4.tcp_max_syn_backlog=30000\n\n          sysctl -w net.ipv4.conf.all.send_redirects=0\n\n          sysctl -w net.ipv4.conf.all.accept_redirects=0\n\n          sysctl -w net.ipv4.conf.all.accept_source_route=0\n\n          sysctl -w net.ipv6.conf.all.forwarding=0\n\n          sysctl -w net.ipv4.tcp_slow_start_after_idle=0\n\n          sysctl -w net.ipv4.tcp_window_scaling=1\n\n          sysctl -w net.ipv4.tcp_timestamp=1\n\n          sysctl -w net.ipv4.tcp_sack=1\n\n          sysctl -w net.ipv4.tcp_congestion_control=htcp\n\n          sysctl -w net.ipv4.tcp_keepalive_time=60\n\n          sysctl -w net.netfilter.nf_conntrack_tcp_timeout_time_wait=10\n\n          sysctl -w net.netfilter.nf_conntrack_tcp_timeout_established=300\n\n          sysctl -w net.netfilter.nf_conntrack_generic_timeout=300\n\n          sysctl -w net.ipv4.tcp_max_tw_buckets=2000000\n\n          sysctl -w net.ipv4.tcp_fin_timeout=10\n\n          sysctl -w net.ipv4.tcp_tw_reuse=1\n\n          sysctl -w net.ipv4.tcp_keepalive_intvl=15\n\n          sysctl -w net.ipv4.tcp_keepalive_probes=5\n\n          '\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          privileged: true\n      containers:\n      - name: banias-frontend\n        image: gcr.io/my-project/banias-frontend:test\n        resources:\n          limits:\n            cpu: '3'\n            memory: 12G\n          requests:\n            cpu: 500m\n            memory: 200Mi\n        volumeMounts:\n        - name: google-cloud-key\n          mountPath: /var/secrets/google\n        ports:\n        - name: http\n          containerPort: 8081\n        - name: prom-metrics\n          containerPort: 8080\n        env:\n        - name: BANIAS_PROJECTID\n          valueFrom:\n            configMapKeyRef:\n              key: BANIAS_PROJECTID\n              name: banias-frontend-config\n        - name: BANIAS_DEBUG\n          valueFrom:\n            configMapKeyRef:\n              key: BANIAS_DEBUG\n              name: banias-frontend-config\n        - name: BANIAS_TOPIC\n          valueFrom:\n            configMapKeyRef:\n              key: BANIAS_TOPIC\n              name: banias-frontend-config\n        - name: BANIAS_PORT\n          valueFrom:\n            configMapKeyRef:\n              key: BANIAS_PORT\n              name: banias-frontend-config\n        - name: BANIAS_METRICSPORT\n          valueFrom:\n            configMapKeyRef:\n              key: BANIAS_METRICSPORT\n              name: banias-frontend-config\n        - name: BANIAS_PUBSUBMAXBATCH\n          valueFrom:\n            configMapKeyRef:\n              key: BANIAS_PUBSUBMAXBATCH\n              name: banias-frontend-config\n        - name: BANIAS_PUBSUBAGGRIGATORS\n          valueFrom:\n            configMapKeyRef:\n              key: BANIAS_PUBSUBAGGRIGATORS\n              name: banias-frontend-config\n        - name: BANIAS_PUBSUBMAXPUBLISHDELAY\n          valueFrom:\n            configMapKeyRef:\n              key: BANIAS_PUBSUBMAXPUBLISHDELAY\n              name: banias-frontend-config\n        - name: BANIAS_MAXPUBSUBGOROUTINESAMOUNT\n          valueFrom:\n            configMapKeyRef:\n              key: BANIAS_MAXPUBSUBGOROUTINESAMOUNT\n              name: banias-frontend-config\n        - name: BANIAS_MAXPUBSUBGOROUTINEIDLEDURATION\n          valueFrom:\n            configMapKeyRef:\n              key: BANIAS_MAXPUBSUBGOROUTINEIDLEDURATION\n              name: banias-frontend-config\n        - name: GOOGLE_APPLICATION_CREDENTIALS\n          value: /var/secrets/google/key.json\n        imagePullPolicy: Always\n      volumes:\n      - name: google-cloud-key\n        secret:\n          secretName: pubsub-key\n",
    "policy_id": "privilege-escalation-container",
    "violation_text": "container \"init-sysctl\" is Privileged hence allows privilege escalation."
  }
]