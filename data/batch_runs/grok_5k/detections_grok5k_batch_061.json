[
  {
    "id": "02441",
    "manifest_path": "data/manifests/the_stack_sample/sample_0964.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: paymentservice\n  labels:\n    app: paymentservice\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: paymentservice\n  template:\n    metadata:\n      labels:\n        app: paymentservice\n    spec:\n      containers:\n      - name: server\n        image: alexeyyakovlev1982/hipster_shop_paymentservice_v0.0.2\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"server\" is using an invalid container image, \"alexeyyakovlev1982/hipster_shop_paymentservice_v0.0.2\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02442",
    "manifest_path": "data/manifests/the_stack_sample/sample_0964.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: paymentservice\n  labels:\n    app: paymentservice\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: paymentservice\n  template:\n    metadata:\n      labels:\n        app: paymentservice\n    spec:\n      containers:\n      - name: server\n        image: alexeyyakovlev1982/hipster_shop_paymentservice_v0.0.2\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"server\" does not have a read-only root file system"
  },
  {
    "id": "02443",
    "manifest_path": "data/manifests/the_stack_sample/sample_0964.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: paymentservice\n  labels:\n    app: paymentservice\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: paymentservice\n  template:\n    metadata:\n      labels:\n        app: paymentservice\n    spec:\n      containers:\n      - name: server\n        image: alexeyyakovlev1982/hipster_shop_paymentservice_v0.0.2\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"server\" is not set to runAsNonRoot"
  },
  {
    "id": "02444",
    "manifest_path": "data/manifests/the_stack_sample/sample_0964.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: paymentservice\n  labels:\n    app: paymentservice\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: paymentservice\n  template:\n    metadata:\n      labels:\n        app: paymentservice\n    spec:\n      containers:\n      - name: server\n        image: alexeyyakovlev1982/hipster_shop_paymentservice_v0.0.2\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"server\" has cpu request 0"
  },
  {
    "id": "02445",
    "manifest_path": "data/manifests/the_stack_sample/sample_0964.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: paymentservice\n  labels:\n    app: paymentservice\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: paymentservice\n  template:\n    metadata:\n      labels:\n        app: paymentservice\n    spec:\n      containers:\n      - name: server\n        image: alexeyyakovlev1982/hipster_shop_paymentservice_v0.0.2\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"server\" has memory limit 0"
  },
  {
    "id": "02446",
    "manifest_path": "data/manifests/the_stack_sample/sample_0966.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: demo-k8s-pod\n  labels:\n    app: demo-k8s\nspec:\n  containers:\n  - name: demok8s\n    image: karatejb/demo-k8s:latest\n    ports:\n    - containerPort: 5000\n    - containerPort: 5001\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"demok8s\" is using an invalid container image, \"karatejb/demo-k8s:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02447",
    "manifest_path": "data/manifests/the_stack_sample/sample_0966.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: demo-k8s-pod\n  labels:\n    app: demo-k8s\nspec:\n  containers:\n  - name: demok8s\n    image: karatejb/demo-k8s:latest\n    ports:\n    - containerPort: 5000\n    - containerPort: 5001\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"demok8s\" does not have a read-only root file system"
  },
  {
    "id": "02448",
    "manifest_path": "data/manifests/the_stack_sample/sample_0966.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: demo-k8s-pod\n  labels:\n    app: demo-k8s\nspec:\n  containers:\n  - name: demok8s\n    image: karatejb/demo-k8s:latest\n    ports:\n    - containerPort: 5000\n    - containerPort: 5001\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"demok8s\" is not set to runAsNonRoot"
  },
  {
    "id": "02449",
    "manifest_path": "data/manifests/the_stack_sample/sample_0966.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: demo-k8s-pod\n  labels:\n    app: demo-k8s\nspec:\n  containers:\n  - name: demok8s\n    image: karatejb/demo-k8s:latest\n    ports:\n    - containerPort: 5000\n    - containerPort: 5001\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"demok8s\" has cpu request 0"
  },
  {
    "id": "02450",
    "manifest_path": "data/manifests/the_stack_sample/sample_0966.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: demo-k8s-pod\n  labels:\n    app: demo-k8s\nspec:\n  containers:\n  - name: demok8s\n    image: karatejb/demo-k8s:latest\n    ports:\n    - containerPort: 5000\n    - containerPort: 5001\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"demok8s\" has memory limit 0"
  },
  {
    "id": "02451",
    "manifest_path": "data/manifests/the_stack_sample/sample_0970.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: ReplicaSet\nmetadata:\n  name: scum-rs\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      kind: scum\n  template:\n    metadata:\n      labels:\n        kind: scum\n    spec:\n      containers:\n      - name: scum-pod\n        image: ihippik/k8s-scum:main\n        args:\n        - server\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"scum-pod\" does not have a read-only root file system"
  },
  {
    "id": "02452",
    "manifest_path": "data/manifests/the_stack_sample/sample_0970.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: ReplicaSet\nmetadata:\n  name: scum-rs\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      kind: scum\n  template:\n    metadata:\n      labels:\n        kind: scum\n    spec:\n      containers:\n      - name: scum-pod\n        image: ihippik/k8s-scum:main\n        args:\n        - server\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"scum-pod\" is not set to runAsNonRoot"
  },
  {
    "id": "02453",
    "manifest_path": "data/manifests/the_stack_sample/sample_0970.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: ReplicaSet\nmetadata:\n  name: scum-rs\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      kind: scum\n  template:\n    metadata:\n      labels:\n        kind: scum\n    spec:\n      containers:\n      - name: scum-pod\n        image: ihippik/k8s-scum:main\n        args:\n        - server\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"scum-pod\" has cpu request 0"
  },
  {
    "id": "02454",
    "manifest_path": "data/manifests/the_stack_sample/sample_0970.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: ReplicaSet\nmetadata:\n  name: scum-rs\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      kind: scum\n  template:\n    metadata:\n      labels:\n        kind: scum\n    spec:\n      containers:\n      - name: scum-pod\n        image: ihippik/k8s-scum:main\n        args:\n        - server\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"scum-pod\" has memory limit 0"
  },
  {
    "id": "02455",
    "manifest_path": "data/manifests/the_stack_sample/sample_0971.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: prow-exporter\n  labels:\n    app: prow-exporter\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: prow-exporter\n  template:\n    metadata:\n      labels:\n        app: prow-exporter\n    spec:\n      serviceAccountName: prow-exporter\n      containers:\n      - name: prow-exporter\n        image: gcr.io/k8s-prow/exporter:v20211028-7017c540b0\n        imagePullPolicy: Always\n        ports:\n        - name: metrics\n          containerPort: 9090\n        - name: healthz\n          containerPort: 8081\n        args:\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        env:\n        - name: KUBECONFIG\n          value: /etc/kubeconfig/config\n        volumeMounts:\n        - mountPath: /etc/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 30\n          timeoutSeconds: 15\n        readinessProbe:\n          httpGet:\n            path: /healthz/ready\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 30\n          timeoutSeconds: 15\n        resources:\n          requests:\n            cpu: 100m\n            memory: 500Mi\n          limits:\n            cpu: 100m\n            memory: 500Mi\n      volumes:\n      - name: kubeconfig\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"prow-exporter\" does not have a read-only root file system"
  },
  {
    "id": "02456",
    "manifest_path": "data/manifests/the_stack_sample/sample_0971.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: prow-exporter\n  labels:\n    app: prow-exporter\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: prow-exporter\n  template:\n    metadata:\n      labels:\n        app: prow-exporter\n    spec:\n      serviceAccountName: prow-exporter\n      containers:\n      - name: prow-exporter\n        image: gcr.io/k8s-prow/exporter:v20211028-7017c540b0\n        imagePullPolicy: Always\n        ports:\n        - name: metrics\n          containerPort: 9090\n        - name: healthz\n          containerPort: 8081\n        args:\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        env:\n        - name: KUBECONFIG\n          value: /etc/kubeconfig/config\n        volumeMounts:\n        - mountPath: /etc/kubeconfig\n          name: kubeconfig\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 30\n          timeoutSeconds: 15\n        readinessProbe:\n          httpGet:\n            path: /healthz/ready\n            port: 8081\n          initialDelaySeconds: 10\n          periodSeconds: 30\n          timeoutSeconds: 15\n        resources:\n          requests:\n            cpu: 100m\n            memory: 500Mi\n          limits:\n            cpu: 100m\n            memory: 500Mi\n      volumes:\n      - name: kubeconfig\n        secret:\n          defaultMode: 420\n          secretName: kubeconfig\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"prow-exporter\" is not set to runAsNonRoot"
  },
  {
    "id": "02457",
    "manifest_path": "data/manifests/the_stack_sample/sample_0973.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: privileged\n  labels:\n    app: privileged\nspec:\n  replicas: 1\n  template:\n    metadata:\n      name: privileged\n      labels:\n        app: privileged\n    spec:\n      containers:\n      - name: test\n        image: e2eteam/busybox:1.29-windows-amd64-1809\n        command:\n        - cmd\n        - /c\n        - ping -t localhost\n        resources:\n          limits:\n            cpu: 1\n            memory: 800m\n          requests:\n            cpu: '0.1'\n            memory: 300m\n  selector:\n    matchLabels:\n      app: privileged\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"test\" does not have a read-only root file system"
  },
  {
    "id": "02458",
    "manifest_path": "data/manifests/the_stack_sample/sample_0973.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: privileged\n  labels:\n    app: privileged\nspec:\n  replicas: 1\n  template:\n    metadata:\n      name: privileged\n      labels:\n        app: privileged\n    spec:\n      containers:\n      - name: test\n        image: e2eteam/busybox:1.29-windows-amd64-1809\n        command:\n        - cmd\n        - /c\n        - ping -t localhost\n        resources:\n          limits:\n            cpu: 1\n            memory: 800m\n          requests:\n            cpu: '0.1'\n            memory: 300m\n  selector:\n    matchLabels:\n      app: privileged\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"test\" is not set to runAsNonRoot"
  },
  {
    "id": "02459",
    "manifest_path": "data/manifests/the_stack_sample/sample_0975.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: web\n  labels:\n    app: web\nspec:\n  containers:\n  - name: web\n    image: alsam/alex:latest\n    volumeMounts:\n    - name: app\n      mountPath: /app\n  initContainers:\n  - name: init-web\n    image: busybox:1.31.0\n    volumeMounts:\n    - name: app\n      mountPath: /app\n    command:\n    - sh\n    - -c\n    - wget -O- --no-check-certificate https://raw.githubusercontent.com/express42/otus-platform-snippets/master/Module-02/Introduction-to-Kubernetes/wget.sh\n      | sh\n  volumes:\n  - name: app\n    emptyDir: {}\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"web\" is using an invalid container image, \"alsam/alex:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02460",
    "manifest_path": "data/manifests/the_stack_sample/sample_0975.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: web\n  labels:\n    app: web\nspec:\n  containers:\n  - name: web\n    image: alsam/alex:latest\n    volumeMounts:\n    - name: app\n      mountPath: /app\n  initContainers:\n  - name: init-web\n    image: busybox:1.31.0\n    volumeMounts:\n    - name: app\n      mountPath: /app\n    command:\n    - sh\n    - -c\n    - wget -O- --no-check-certificate https://raw.githubusercontent.com/express42/otus-platform-snippets/master/Module-02/Introduction-to-Kubernetes/wget.sh\n      | sh\n  volumes:\n  - name: app\n    emptyDir: {}\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"init-web\" does not have a read-only root file system"
  },
  {
    "id": "02461",
    "manifest_path": "data/manifests/the_stack_sample/sample_0975.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: web\n  labels:\n    app: web\nspec:\n  containers:\n  - name: web\n    image: alsam/alex:latest\n    volumeMounts:\n    - name: app\n      mountPath: /app\n  initContainers:\n  - name: init-web\n    image: busybox:1.31.0\n    volumeMounts:\n    - name: app\n      mountPath: /app\n    command:\n    - sh\n    - -c\n    - wget -O- --no-check-certificate https://raw.githubusercontent.com/express42/otus-platform-snippets/master/Module-02/Introduction-to-Kubernetes/wget.sh\n      | sh\n  volumes:\n  - name: app\n    emptyDir: {}\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"web\" does not have a read-only root file system"
  },
  {
    "id": "02462",
    "manifest_path": "data/manifests/the_stack_sample/sample_0975.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: web\n  labels:\n    app: web\nspec:\n  containers:\n  - name: web\n    image: alsam/alex:latest\n    volumeMounts:\n    - name: app\n      mountPath: /app\n  initContainers:\n  - name: init-web\n    image: busybox:1.31.0\n    volumeMounts:\n    - name: app\n      mountPath: /app\n    command:\n    - sh\n    - -c\n    - wget -O- --no-check-certificate https://raw.githubusercontent.com/express42/otus-platform-snippets/master/Module-02/Introduction-to-Kubernetes/wget.sh\n      | sh\n  volumes:\n  - name: app\n    emptyDir: {}\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"init-web\" is not set to runAsNonRoot"
  },
  {
    "id": "02463",
    "manifest_path": "data/manifests/the_stack_sample/sample_0975.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: web\n  labels:\n    app: web\nspec:\n  containers:\n  - name: web\n    image: alsam/alex:latest\n    volumeMounts:\n    - name: app\n      mountPath: /app\n  initContainers:\n  - name: init-web\n    image: busybox:1.31.0\n    volumeMounts:\n    - name: app\n      mountPath: /app\n    command:\n    - sh\n    - -c\n    - wget -O- --no-check-certificate https://raw.githubusercontent.com/express42/otus-platform-snippets/master/Module-02/Introduction-to-Kubernetes/wget.sh\n      | sh\n  volumes:\n  - name: app\n    emptyDir: {}\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"web\" is not set to runAsNonRoot"
  },
  {
    "id": "02464",
    "manifest_path": "data/manifests/the_stack_sample/sample_0975.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: web\n  labels:\n    app: web\nspec:\n  containers:\n  - name: web\n    image: alsam/alex:latest\n    volumeMounts:\n    - name: app\n      mountPath: /app\n  initContainers:\n  - name: init-web\n    image: busybox:1.31.0\n    volumeMounts:\n    - name: app\n      mountPath: /app\n    command:\n    - sh\n    - -c\n    - wget -O- --no-check-certificate https://raw.githubusercontent.com/express42/otus-platform-snippets/master/Module-02/Introduction-to-Kubernetes/wget.sh\n      | sh\n  volumes:\n  - name: app\n    emptyDir: {}\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"init-web\" has cpu request 0"
  },
  {
    "id": "02465",
    "manifest_path": "data/manifests/the_stack_sample/sample_0975.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: web\n  labels:\n    app: web\nspec:\n  containers:\n  - name: web\n    image: alsam/alex:latest\n    volumeMounts:\n    - name: app\n      mountPath: /app\n  initContainers:\n  - name: init-web\n    image: busybox:1.31.0\n    volumeMounts:\n    - name: app\n      mountPath: /app\n    command:\n    - sh\n    - -c\n    - wget -O- --no-check-certificate https://raw.githubusercontent.com/express42/otus-platform-snippets/master/Module-02/Introduction-to-Kubernetes/wget.sh\n      | sh\n  volumes:\n  - name: app\n    emptyDir: {}\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"web\" has cpu request 0"
  },
  {
    "id": "02466",
    "manifest_path": "data/manifests/the_stack_sample/sample_0975.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: web\n  labels:\n    app: web\nspec:\n  containers:\n  - name: web\n    image: alsam/alex:latest\n    volumeMounts:\n    - name: app\n      mountPath: /app\n  initContainers:\n  - name: init-web\n    image: busybox:1.31.0\n    volumeMounts:\n    - name: app\n      mountPath: /app\n    command:\n    - sh\n    - -c\n    - wget -O- --no-check-certificate https://raw.githubusercontent.com/express42/otus-platform-snippets/master/Module-02/Introduction-to-Kubernetes/wget.sh\n      | sh\n  volumes:\n  - name: app\n    emptyDir: {}\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"init-web\" has memory limit 0"
  },
  {
    "id": "02467",
    "manifest_path": "data/manifests/the_stack_sample/sample_0975.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: web\n  labels:\n    app: web\nspec:\n  containers:\n  - name: web\n    image: alsam/alex:latest\n    volumeMounts:\n    - name: app\n      mountPath: /app\n  initContainers:\n  - name: init-web\n    image: busybox:1.31.0\n    volumeMounts:\n    - name: app\n      mountPath: /app\n    command:\n    - sh\n    - -c\n    - wget -O- --no-check-certificate https://raw.githubusercontent.com/express42/otus-platform-snippets/master/Module-02/Introduction-to-Kubernetes/wget.sh\n      | sh\n  volumes:\n  - name: app\n    emptyDir: {}\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"web\" has memory limit 0"
  },
  {
    "id": "02468",
    "manifest_path": "data/manifests/the_stack_sample/sample_0978.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: frontend\nspec:\n  selector:\n    matchLabels:\n      app: guestbook\n      tier: frontend\n  replicas: 3\n  template:\n    metadata:\n      labels:\n        app: guestbook\n        tier: frontend\n        blinkt: show\n        blinktColor: 3307A2\n    spec:\n      containers:\n      - name: php-redis\n        image: gcr.io/google-samples/gb-frontend:v4\n        resources:\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        env:\n        - name: GET_HOSTS_FROM\n          value: dns\n        ports:\n        - containerPort: 80\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"php-redis\" does not have a read-only root file system"
  },
  {
    "id": "02469",
    "manifest_path": "data/manifests/the_stack_sample/sample_0978.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: frontend\nspec:\n  selector:\n    matchLabels:\n      app: guestbook\n      tier: frontend\n  replicas: 3\n  template:\n    metadata:\n      labels:\n        app: guestbook\n        tier: frontend\n        blinkt: show\n        blinktColor: 3307A2\n    spec:\n      containers:\n      - name: php-redis\n        image: gcr.io/google-samples/gb-frontend:v4\n        resources:\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        env:\n        - name: GET_HOSTS_FROM\n          value: dns\n        ports:\n        - containerPort: 80\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"php-redis\" is not set to runAsNonRoot"
  },
  {
    "id": "02470",
    "manifest_path": "data/manifests/the_stack_sample/sample_0978.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: frontend\nspec:\n  selector:\n    matchLabels:\n      app: guestbook\n      tier: frontend\n  replicas: 3\n  template:\n    metadata:\n      labels:\n        app: guestbook\n        tier: frontend\n        blinkt: show\n        blinktColor: 3307A2\n    spec:\n      containers:\n      - name: php-redis\n        image: gcr.io/google-samples/gb-frontend:v4\n        resources:\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        env:\n        - name: GET_HOSTS_FROM\n          value: dns\n        ports:\n        - containerPort: 80\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"php-redis\" has memory limit 0"
  },
  {
    "id": "02471",
    "manifest_path": "data/manifests/the_stack_sample/sample_0982.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: foo\n  name: foo\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: foo\n  template:\n    metadata:\n      labels:\n        app: foo\n    spec:\n      containers:\n      - image: foo@sha256:your-image-digest\n        imagePullPolicy: Always\n        name: foo\n        resources:\n          limits:\n            memory: 768Mi\n        env:\n        - name: HOST_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.hostIP\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: POD_SERVICE_ACCOUNT\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.serviceAccountName\n        livenessProbe:\n          httpGet:\n            path: /actuator/health/liveness\n            port: 8080\n          initialDelaySeconds: 2\n          timeoutSeconds: 10\n        readinessProbe:\n          httpGet:\n            path: /actuator/health/readiness\n            port: 8080\n          initialDelaySeconds: 2\n          timeoutSeconds: 11\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"foo\" does not have a read-only root file system"
  },
  {
    "id": "02472",
    "manifest_path": "data/manifests/the_stack_sample/sample_0982.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: foo\n  name: foo\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: foo\n  template:\n    metadata:\n      labels:\n        app: foo\n    spec:\n      containers:\n      - image: foo@sha256:your-image-digest\n        imagePullPolicy: Always\n        name: foo\n        resources:\n          limits:\n            memory: 768Mi\n        env:\n        - name: HOST_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.hostIP\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: POD_SERVICE_ACCOUNT\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.serviceAccountName\n        livenessProbe:\n          httpGet:\n            path: /actuator/health/liveness\n            port: 8080\n          initialDelaySeconds: 2\n          timeoutSeconds: 10\n        readinessProbe:\n          httpGet:\n            path: /actuator/health/readiness\n            port: 8080\n          initialDelaySeconds: 2\n          timeoutSeconds: 11\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"foo\" is not set to runAsNonRoot"
  },
  {
    "id": "02473",
    "manifest_path": "data/manifests/the_stack_sample/sample_0982.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: foo\n  name: foo\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: foo\n  template:\n    metadata:\n      labels:\n        app: foo\n    spec:\n      containers:\n      - image: foo@sha256:your-image-digest\n        imagePullPolicy: Always\n        name: foo\n        resources:\n          limits:\n            memory: 768Mi\n        env:\n        - name: HOST_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.hostIP\n        - name: POD_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: POD_SERVICE_ACCOUNT\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.serviceAccountName\n        livenessProbe:\n          httpGet:\n            path: /actuator/health/liveness\n            port: 8080\n          initialDelaySeconds: 2\n          timeoutSeconds: 10\n        readinessProbe:\n          httpGet:\n            path: /actuator/health/readiness\n            port: 8080\n          initialDelaySeconds: 2\n          timeoutSeconds: 11\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"foo\" has cpu request 0"
  },
  {
    "id": "02474",
    "manifest_path": "data/manifests/the_stack_sample/sample_0983.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: weave-scope-app\n  labels:\n    name: weave-scope-app\n    app: weave-scope\n    weave-cloud-component: scope\n    weave-scope-component: app\n  namespace: weave\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: weave-scope\n  template:\n    metadata:\n      labels:\n        name: weave-scope-app\n        app: weave-scope\n        weave-cloud-component: scope\n        weave-scope-component: app\n    spec:\n      containers:\n      - name: app\n        args:\n        - --no-probe\n        env: []\n        image: weaveworks/scope:1.13.2\n        imagePullPolicy: IfNotPresent\n        ports:\n        - containerPort: 4040\n          protocol: TCP\n        resources:\n          requests:\n            cpu: 200m\n            memory: 200Mi\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"app\" does not have a read-only root file system"
  },
  {
    "id": "02475",
    "manifest_path": "data/manifests/the_stack_sample/sample_0983.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: weave-scope-app\n  labels:\n    name: weave-scope-app\n    app: weave-scope\n    weave-cloud-component: scope\n    weave-scope-component: app\n  namespace: weave\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: weave-scope\n  template:\n    metadata:\n      labels:\n        name: weave-scope-app\n        app: weave-scope\n        weave-cloud-component: scope\n        weave-scope-component: app\n    spec:\n      containers:\n      - name: app\n        args:\n        - --no-probe\n        env: []\n        image: weaveworks/scope:1.13.2\n        imagePullPolicy: IfNotPresent\n        ports:\n        - containerPort: 4040\n          protocol: TCP\n        resources:\n          requests:\n            cpu: 200m\n            memory: 200Mi\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"app\" is not set to runAsNonRoot"
  },
  {
    "id": "02476",
    "manifest_path": "data/manifests/the_stack_sample/sample_0983.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: weave-scope-app\n  labels:\n    name: weave-scope-app\n    app: weave-scope\n    weave-cloud-component: scope\n    weave-scope-component: app\n  namespace: weave\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: weave-scope\n  template:\n    metadata:\n      labels:\n        name: weave-scope-app\n        app: weave-scope\n        weave-cloud-component: scope\n        weave-scope-component: app\n    spec:\n      containers:\n      - name: app\n        args:\n        - --no-probe\n        env: []\n        image: weaveworks/scope:1.13.2\n        imagePullPolicy: IfNotPresent\n        ports:\n        - containerPort: 4040\n          protocol: TCP\n        resources:\n          requests:\n            cpu: 200m\n            memory: 200Mi\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"app\" has memory limit 0"
  },
  {
    "id": "02477",
    "manifest_path": "data/manifests/the_stack_sample/sample_0987.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: lighthouse-foghorn\n  labels:\n    draft: draft-app\n    chart: lighthouse-0.0.885\n    app: lighthouse-foghorn\n    gitops.jenkins-x.io/pipeline: namespaces\n  namespace: jx\n  annotations:\n    wave.pusher.com/update-on-config-change: 'true'\n    jenkins-x.io/hash: e815f2ccc606190328779dadb61e45181c1c8c828dbf6f63e28438c1fba1f776\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      draft: draft-app\n      app: lighthouse-foghorn\n  template:\n    metadata:\n      labels:\n        draft: draft-app\n        app: lighthouse-foghorn\n    spec:\n      serviceAccountName: lighthouse-foghorn\n      containers:\n      - name: lighthouse-foghorn\n        image: gcr.io/jenkinsxio/lighthouse-foghorn:0.0.885\n        imagePullPolicy: IfNotPresent\n        args:\n        - --namespace=jx\n        env:\n        - name: GIT_KIND\n          value: github\n        - name: GIT_SERVER\n          value: https://github.com\n        - name: GIT_USER\n          value: hlechuga\n        - name: GIT_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: lighthouse-oauth-token\n              key: oauth\n        - name: HMAC_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: lighthouse-hmac-token\n              key: hmac\n        - name: JX_LOG_FORMAT\n          value: json\n        - name: LOGRUS_FORMAT\n          value: json\n        - name: DEFAULT_PIPELINE_RUN_SERVICE_ACCOUNT\n          value: tekton-bot\n        - name: DEFAULT_PIPELINE_RUN_TIMEOUT\n          value: 2h0m0s\n        - name: FILE_BROWSER\n          value: git\n        - name: JX_DEFAULT_IMAGE\n          value: gcr.io/jenkinsxio/builder-maven:2.1.142-761\n        - name: LIGHTHOUSE_DASHBOARD_TEMPLATE\n          value: namespaces/{{ .Namespace }}/pipelineruns/{{ .PipelineRun }}\n        resources:\n          limits:\n            cpu: 100m\n            memory: 256Mi\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"lighthouse-foghorn\" does not have a read-only root file system"
  },
  {
    "id": "02478",
    "manifest_path": "data/manifests/the_stack_sample/sample_0987.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: lighthouse-foghorn\n  labels:\n    draft: draft-app\n    chart: lighthouse-0.0.885\n    app: lighthouse-foghorn\n    gitops.jenkins-x.io/pipeline: namespaces\n  namespace: jx\n  annotations:\n    wave.pusher.com/update-on-config-change: 'true'\n    jenkins-x.io/hash: e815f2ccc606190328779dadb61e45181c1c8c828dbf6f63e28438c1fba1f776\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      draft: draft-app\n      app: lighthouse-foghorn\n  template:\n    metadata:\n      labels:\n        draft: draft-app\n        app: lighthouse-foghorn\n    spec:\n      serviceAccountName: lighthouse-foghorn\n      containers:\n      - name: lighthouse-foghorn\n        image: gcr.io/jenkinsxio/lighthouse-foghorn:0.0.885\n        imagePullPolicy: IfNotPresent\n        args:\n        - --namespace=jx\n        env:\n        - name: GIT_KIND\n          value: github\n        - name: GIT_SERVER\n          value: https://github.com\n        - name: GIT_USER\n          value: hlechuga\n        - name: GIT_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: lighthouse-oauth-token\n              key: oauth\n        - name: HMAC_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: lighthouse-hmac-token\n              key: hmac\n        - name: JX_LOG_FORMAT\n          value: json\n        - name: LOGRUS_FORMAT\n          value: json\n        - name: DEFAULT_PIPELINE_RUN_SERVICE_ACCOUNT\n          value: tekton-bot\n        - name: DEFAULT_PIPELINE_RUN_TIMEOUT\n          value: 2h0m0s\n        - name: FILE_BROWSER\n          value: git\n        - name: JX_DEFAULT_IMAGE\n          value: gcr.io/jenkinsxio/builder-maven:2.1.142-761\n        - name: LIGHTHOUSE_DASHBOARD_TEMPLATE\n          value: namespaces/{{ .Namespace }}/pipelineruns/{{ .PipelineRun }}\n        resources:\n          limits:\n            cpu: 100m\n            memory: 256Mi\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"lighthouse-foghorn\" is not set to runAsNonRoot"
  },
  {
    "id": "02479",
    "manifest_path": "data/manifests/the_stack_sample/sample_0987.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: lighthouse-foghorn\n  labels:\n    draft: draft-app\n    chart: lighthouse-0.0.885\n    app: lighthouse-foghorn\n    gitops.jenkins-x.io/pipeline: namespaces\n  namespace: jx\n  annotations:\n    wave.pusher.com/update-on-config-change: 'true'\n    jenkins-x.io/hash: e815f2ccc606190328779dadb61e45181c1c8c828dbf6f63e28438c1fba1f776\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      draft: draft-app\n      app: lighthouse-foghorn\n  template:\n    metadata:\n      labels:\n        draft: draft-app\n        app: lighthouse-foghorn\n    spec:\n      serviceAccountName: lighthouse-foghorn\n      containers:\n      - name: lighthouse-foghorn\n        image: gcr.io/jenkinsxio/lighthouse-foghorn:0.0.885\n        imagePullPolicy: IfNotPresent\n        args:\n        - --namespace=jx\n        env:\n        - name: GIT_KIND\n          value: github\n        - name: GIT_SERVER\n          value: https://github.com\n        - name: GIT_USER\n          value: hlechuga\n        - name: GIT_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: lighthouse-oauth-token\n              key: oauth\n        - name: HMAC_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: lighthouse-hmac-token\n              key: hmac\n        - name: JX_LOG_FORMAT\n          value: json\n        - name: LOGRUS_FORMAT\n          value: json\n        - name: DEFAULT_PIPELINE_RUN_SERVICE_ACCOUNT\n          value: tekton-bot\n        - name: DEFAULT_PIPELINE_RUN_TIMEOUT\n          value: 2h0m0s\n        - name: FILE_BROWSER\n          value: git\n        - name: JX_DEFAULT_IMAGE\n          value: gcr.io/jenkinsxio/builder-maven:2.1.142-761\n        - name: LIGHTHOUSE_DASHBOARD_TEMPLATE\n          value: namespaces/{{ .Namespace }}/pipelineruns/{{ .PipelineRun }}\n        resources:\n          limits:\n            cpu: 100m\n            memory: 256Mi\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"lighthouse-foghorn\" has cpu request 0"
  },
  {
    "id": "02480",
    "manifest_path": "data/manifests/the_stack_sample/sample_0997.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: mysql-operator\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: mysql-operator\n  template:\n    metadata:\n      labels:\n        name: mysql-operator\n    spec:\n      serviceAccountName: mysql-operator\n      containers:\n      - name: operator\n        image: atalabirchuk/otus:mysql-operator_v1\n        imagePullPolicy: Always\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"operator\" does not have a read-only root file system"
  }
]