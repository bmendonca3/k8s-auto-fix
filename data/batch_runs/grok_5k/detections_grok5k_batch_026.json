[
  {
    "id": "01041",
    "manifest_path": "data/manifests/the_stack_sample/sample_0265.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-6084\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"nginx\" is using an invalid container image, \"nginx\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "01042",
    "manifest_path": "data/manifests/the_stack_sample/sample_0265.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-6084\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"nginx\" does not have a read-only root file system"
  },
  {
    "id": "01043",
    "manifest_path": "data/manifests/the_stack_sample/sample_0265.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-6084\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"nginx\" is not set to runAsNonRoot"
  },
  {
    "id": "01044",
    "manifest_path": "data/manifests/the_stack_sample/sample_0265.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-6084\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"nginx\" has cpu request 0"
  },
  {
    "id": "01045",
    "manifest_path": "data/manifests/the_stack_sample/sample_0265.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-6084\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"nginx\" has memory limit 0"
  },
  {
    "id": "01046",
    "manifest_path": "data/manifests/the_stack_sample/sample_0266.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    run: test\n  name: test18\n  namespace: default\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      run: test\n  template:\n    metadata:\n      labels:\n        run: test\n    spec:\n      containers:\n      - image: docker.io/dgeiger/alpine@sha256:5555555\n        name: container1\n      - image: docker.io/dgeiger/nginx@sha256:e770165fef9e36b990882a4083d8ccf5e29e469a8609bb6b2e3b47d9510e2c8d\n        name: container2\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"container1\" does not have a read-only root file system"
  },
  {
    "id": "01047",
    "manifest_path": "data/manifests/the_stack_sample/sample_0266.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    run: test\n  name: test18\n  namespace: default\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      run: test\n  template:\n    metadata:\n      labels:\n        run: test\n    spec:\n      containers:\n      - image: docker.io/dgeiger/alpine@sha256:5555555\n        name: container1\n      - image: docker.io/dgeiger/nginx@sha256:e770165fef9e36b990882a4083d8ccf5e29e469a8609bb6b2e3b47d9510e2c8d\n        name: container2\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"container2\" does not have a read-only root file system"
  },
  {
    "id": "01048",
    "manifest_path": "data/manifests/the_stack_sample/sample_0266.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    run: test\n  name: test18\n  namespace: default\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      run: test\n  template:\n    metadata:\n      labels:\n        run: test\n    spec:\n      containers:\n      - image: docker.io/dgeiger/alpine@sha256:5555555\n        name: container1\n      - image: docker.io/dgeiger/nginx@sha256:e770165fef9e36b990882a4083d8ccf5e29e469a8609bb6b2e3b47d9510e2c8d\n        name: container2\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"container1\" is not set to runAsNonRoot"
  },
  {
    "id": "01049",
    "manifest_path": "data/manifests/the_stack_sample/sample_0266.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    run: test\n  name: test18\n  namespace: default\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      run: test\n  template:\n    metadata:\n      labels:\n        run: test\n    spec:\n      containers:\n      - image: docker.io/dgeiger/alpine@sha256:5555555\n        name: container1\n      - image: docker.io/dgeiger/nginx@sha256:e770165fef9e36b990882a4083d8ccf5e29e469a8609bb6b2e3b47d9510e2c8d\n        name: container2\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"container2\" is not set to runAsNonRoot"
  },
  {
    "id": "01050",
    "manifest_path": "data/manifests/the_stack_sample/sample_0266.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    run: test\n  name: test18\n  namespace: default\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      run: test\n  template:\n    metadata:\n      labels:\n        run: test\n    spec:\n      containers:\n      - image: docker.io/dgeiger/alpine@sha256:5555555\n        name: container1\n      - image: docker.io/dgeiger/nginx@sha256:e770165fef9e36b990882a4083d8ccf5e29e469a8609bb6b2e3b47d9510e2c8d\n        name: container2\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"container1\" has cpu request 0"
  },
  {
    "id": "01051",
    "manifest_path": "data/manifests/the_stack_sample/sample_0266.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    run: test\n  name: test18\n  namespace: default\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      run: test\n  template:\n    metadata:\n      labels:\n        run: test\n    spec:\n      containers:\n      - image: docker.io/dgeiger/alpine@sha256:5555555\n        name: container1\n      - image: docker.io/dgeiger/nginx@sha256:e770165fef9e36b990882a4083d8ccf5e29e469a8609bb6b2e3b47d9510e2c8d\n        name: container2\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"container2\" has cpu request 0"
  },
  {
    "id": "01052",
    "manifest_path": "data/manifests/the_stack_sample/sample_0266.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    run: test\n  name: test18\n  namespace: default\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      run: test\n  template:\n    metadata:\n      labels:\n        run: test\n    spec:\n      containers:\n      - image: docker.io/dgeiger/alpine@sha256:5555555\n        name: container1\n      - image: docker.io/dgeiger/nginx@sha256:e770165fef9e36b990882a4083d8ccf5e29e469a8609bb6b2e3b47d9510e2c8d\n        name: container2\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"container1\" has memory limit 0"
  },
  {
    "id": "01053",
    "manifest_path": "data/manifests/the_stack_sample/sample_0266.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    run: test\n  name: test18\n  namespace: default\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      run: test\n  template:\n    metadata:\n      labels:\n        run: test\n    spec:\n      containers:\n      - image: docker.io/dgeiger/alpine@sha256:5555555\n        name: container1\n      - image: docker.io/dgeiger/nginx@sha256:e770165fef9e36b990882a4083d8ccf5e29e469a8609bb6b2e3b47d9510e2c8d\n        name: container2\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"container2\" has memory limit 0"
  },
  {
    "id": "01054",
    "manifest_path": "data/manifests/the_stack_sample/sample_0268.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: monitoring\n  name: grafana-deployment\nspec:\n  selector:\n    matchLabels:\n      app: grafana-deployment\n  template:\n    metadata:\n      labels:\n        app: grafana-deployment\n    spec:\n      securityContext:\n        runAsUser: 472\n        fsGroup: 472\n      containers:\n      - name: grafana\n        image: grafana/grafana\n        env:\n        - name: GF_SECURITY_ADMIN_PASSWORD\n          value: admin\n        - name: GF_INSTALL_PLUGINS\n          value: grafana-clock-panel,grafana-piechart-panel,camptocamp-prometheus-alertmanager-datasource,vonage-status-panel,alexanderzobnin-zabbix-app,grafana-worldmap-panel,raintank-worldping-app,agenty-flowcharting-panel\n        ports:\n        - containerPort: 3000\n        volumeMounts:\n        - name: grafana-storage\n          mountPath: /var/lib/grafana\n      volumes:\n      - name: grafana-storage\n        persistentVolumeClaim:\n          claimName: grafana-pvc\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"grafana\" is using an invalid container image, \"grafana/grafana\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "01055",
    "manifest_path": "data/manifests/the_stack_sample/sample_0268.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: monitoring\n  name: grafana-deployment\nspec:\n  selector:\n    matchLabels:\n      app: grafana-deployment\n  template:\n    metadata:\n      labels:\n        app: grafana-deployment\n    spec:\n      securityContext:\n        runAsUser: 472\n        fsGroup: 472\n      containers:\n      - name: grafana\n        image: grafana/grafana\n        env:\n        - name: GF_SECURITY_ADMIN_PASSWORD\n          value: admin\n        - name: GF_INSTALL_PLUGINS\n          value: grafana-clock-panel,grafana-piechart-panel,camptocamp-prometheus-alertmanager-datasource,vonage-status-panel,alexanderzobnin-zabbix-app,grafana-worldmap-panel,raintank-worldping-app,agenty-flowcharting-panel\n        ports:\n        - containerPort: 3000\n        volumeMounts:\n        - name: grafana-storage\n          mountPath: /var/lib/grafana\n      volumes:\n      - name: grafana-storage\n        persistentVolumeClaim:\n          claimName: grafana-pvc\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"grafana\" does not have a read-only root file system"
  },
  {
    "id": "01056",
    "manifest_path": "data/manifests/the_stack_sample/sample_0268.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: monitoring\n  name: grafana-deployment\nspec:\n  selector:\n    matchLabels:\n      app: grafana-deployment\n  template:\n    metadata:\n      labels:\n        app: grafana-deployment\n    spec:\n      securityContext:\n        runAsUser: 472\n        fsGroup: 472\n      containers:\n      - name: grafana\n        image: grafana/grafana\n        env:\n        - name: GF_SECURITY_ADMIN_PASSWORD\n          value: admin\n        - name: GF_INSTALL_PLUGINS\n          value: grafana-clock-panel,grafana-piechart-panel,camptocamp-prometheus-alertmanager-datasource,vonage-status-panel,alexanderzobnin-zabbix-app,grafana-worldmap-panel,raintank-worldping-app,agenty-flowcharting-panel\n        ports:\n        - containerPort: 3000\n        volumeMounts:\n        - name: grafana-storage\n          mountPath: /var/lib/grafana\n      volumes:\n      - name: grafana-storage\n        persistentVolumeClaim:\n          claimName: grafana-pvc\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"grafana\" has cpu request 0"
  },
  {
    "id": "01057",
    "manifest_path": "data/manifests/the_stack_sample/sample_0268.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: monitoring\n  name: grafana-deployment\nspec:\n  selector:\n    matchLabels:\n      app: grafana-deployment\n  template:\n    metadata:\n      labels:\n        app: grafana-deployment\n    spec:\n      securityContext:\n        runAsUser: 472\n        fsGroup: 472\n      containers:\n      - name: grafana\n        image: grafana/grafana\n        env:\n        - name: GF_SECURITY_ADMIN_PASSWORD\n          value: admin\n        - name: GF_INSTALL_PLUGINS\n          value: grafana-clock-panel,grafana-piechart-panel,camptocamp-prometheus-alertmanager-datasource,vonage-status-panel,alexanderzobnin-zabbix-app,grafana-worldmap-panel,raintank-worldping-app,agenty-flowcharting-panel\n        ports:\n        - containerPort: 3000\n        volumeMounts:\n        - name: grafana-storage\n          mountPath: /var/lib/grafana\n      volumes:\n      - name: grafana-storage\n        persistentVolumeClaim:\n          claimName: grafana-pvc\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"grafana\" has memory limit 0"
  },
  {
    "id": "01058",
    "manifest_path": "data/manifests/the_stack_sample/sample_0269.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: test-taint\nspec:\n  containers:\n  - name: nginx-image\n    image: nginx\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"nginx-image\" is using an invalid container image, \"nginx\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "01059",
    "manifest_path": "data/manifests/the_stack_sample/sample_0269.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: test-taint\nspec:\n  containers:\n  - name: nginx-image\n    image: nginx\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"nginx-image\" does not have a read-only root file system"
  },
  {
    "id": "01060",
    "manifest_path": "data/manifests/the_stack_sample/sample_0269.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: test-taint\nspec:\n  containers:\n  - name: nginx-image\n    image: nginx\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"nginx-image\" is not set to runAsNonRoot"
  },
  {
    "id": "01061",
    "manifest_path": "data/manifests/the_stack_sample/sample_0269.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: test-taint\nspec:\n  containers:\n  - name: nginx-image\n    image: nginx\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"nginx-image\" has cpu request 0"
  },
  {
    "id": "01062",
    "manifest_path": "data/manifests/the_stack_sample/sample_0269.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: test-taint\nspec:\n  containers:\n  - name: nginx-image\n    image: nginx\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"nginx-image\" has memory limit 0"
  },
  {
    "id": "01063",
    "manifest_path": "data/manifests/the_stack_sample/sample_0272.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: addresses-service-deployment\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: addresses-service\n  template:\n    metadata:\n      labels:\n        app: addresses-service\n    spec:\n      containers:\n      - name: addresses-service\n        image: stokei/addresses-service:latest\n        resources: {}\n        imagePullPolicy: Always\n        env:\n        - name: DB_NAME\n          value: addresses\n        - name: DB_HOST\n          valueFrom:\n            secretKeyRef:\n              name: mongodb-secret\n              key: db-host\n        - name: DB_PORT\n          valueFrom:\n            secretKeyRef:\n              name: mongodb-secret\n              key: db-port\n        - name: DB_USER\n          valueFrom:\n            secretKeyRef:\n              name: mongodb-secret\n              key: db-user\n        - name: DB_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: mongodb-secret\n              key: db-password\n        - name: DB_OPTIONS\n          valueFrom:\n            secretKeyRef:\n              name: mongodb-secret\n              key: db-options\n        - name: DB_PREFIX\n          valueFrom:\n            secretKeyRef:\n              name: mongodb-secret\n              key: db-prefix\n        - name: DB_TIMEOUT\n          valueFrom:\n            secretKeyRef:\n              name: mongodb-secret\n              key: db-timeout\n        - name: QUEUE_HOST\n          valueFrom:\n            secretKeyRef:\n              name: redis-secret\n              key: queue-host\n        - name: QUEUE_PORT\n          valueFrom:\n            secretKeyRef:\n              name: redis-secret\n              key: queue-port\n        - name: QUEUE_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: redis-secret\n              key: queue-password\n        - name: QUEUE_TIMEOUT\n          valueFrom:\n            secretKeyRef:\n              name: redis-secret\n              key: queue-timeout\n        - name: MICROSERVICE_URL\n          valueFrom:\n            secretKeyRef:\n              name: rabbitmq-secret\n              key: url\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"addresses-service\" is using an invalid container image, \"stokei/addresses-service:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "01064",
    "manifest_path": "data/manifests/the_stack_sample/sample_0272.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: addresses-service-deployment\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: addresses-service\n  template:\n    metadata:\n      labels:\n        app: addresses-service\n    spec:\n      containers:\n      - name: addresses-service\n        image: stokei/addresses-service:latest\n        resources: {}\n        imagePullPolicy: Always\n        env:\n        - name: DB_NAME\n          value: addresses\n        - name: DB_HOST\n          valueFrom:\n            secretKeyRef:\n              name: mongodb-secret\n              key: db-host\n        - name: DB_PORT\n          valueFrom:\n            secretKeyRef:\n              name: mongodb-secret\n              key: db-port\n        - name: DB_USER\n          valueFrom:\n            secretKeyRef:\n              name: mongodb-secret\n              key: db-user\n        - name: DB_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: mongodb-secret\n              key: db-password\n        - name: DB_OPTIONS\n          valueFrom:\n            secretKeyRef:\n              name: mongodb-secret\n              key: db-options\n        - name: DB_PREFIX\n          valueFrom:\n            secretKeyRef:\n              name: mongodb-secret\n              key: db-prefix\n        - name: DB_TIMEOUT\n          valueFrom:\n            secretKeyRef:\n              name: mongodb-secret\n              key: db-timeout\n        - name: QUEUE_HOST\n          valueFrom:\n            secretKeyRef:\n              name: redis-secret\n              key: queue-host\n        - name: QUEUE_PORT\n          valueFrom:\n            secretKeyRef:\n              name: redis-secret\n              key: queue-port\n        - name: QUEUE_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: redis-secret\n              key: queue-password\n        - name: QUEUE_TIMEOUT\n          valueFrom:\n            secretKeyRef:\n              name: redis-secret\n              key: queue-timeout\n        - name: MICROSERVICE_URL\n          valueFrom:\n            secretKeyRef:\n              name: rabbitmq-secret\n              key: url\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"addresses-service\" does not have a read-only root file system"
  },
  {
    "id": "01065",
    "manifest_path": "data/manifests/the_stack_sample/sample_0272.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: addresses-service-deployment\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: addresses-service\n  template:\n    metadata:\n      labels:\n        app: addresses-service\n    spec:\n      containers:\n      - name: addresses-service\n        image: stokei/addresses-service:latest\n        resources: {}\n        imagePullPolicy: Always\n        env:\n        - name: DB_NAME\n          value: addresses\n        - name: DB_HOST\n          valueFrom:\n            secretKeyRef:\n              name: mongodb-secret\n              key: db-host\n        - name: DB_PORT\n          valueFrom:\n            secretKeyRef:\n              name: mongodb-secret\n              key: db-port\n        - name: DB_USER\n          valueFrom:\n            secretKeyRef:\n              name: mongodb-secret\n              key: db-user\n        - name: DB_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: mongodb-secret\n              key: db-password\n        - name: DB_OPTIONS\n          valueFrom:\n            secretKeyRef:\n              name: mongodb-secret\n              key: db-options\n        - name: DB_PREFIX\n          valueFrom:\n            secretKeyRef:\n              name: mongodb-secret\n              key: db-prefix\n        - name: DB_TIMEOUT\n          valueFrom:\n            secretKeyRef:\n              name: mongodb-secret\n              key: db-timeout\n        - name: QUEUE_HOST\n          valueFrom:\n            secretKeyRef:\n              name: redis-secret\n              key: queue-host\n        - name: QUEUE_PORT\n          valueFrom:\n            secretKeyRef:\n              name: redis-secret\n              key: queue-port\n        - name: QUEUE_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: redis-secret\n              key: queue-password\n        - name: QUEUE_TIMEOUT\n          valueFrom:\n            secretKeyRef:\n              name: redis-secret\n              key: queue-timeout\n        - name: MICROSERVICE_URL\n          valueFrom:\n            secretKeyRef:\n              name: rabbitmq-secret\n              key: url\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"addresses-service\" is not set to runAsNonRoot"
  },
  {
    "id": "01066",
    "manifest_path": "data/manifests/the_stack_sample/sample_0272.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: addresses-service-deployment\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: addresses-service\n  template:\n    metadata:\n      labels:\n        app: addresses-service\n    spec:\n      containers:\n      - name: addresses-service\n        image: stokei/addresses-service:latest\n        resources: {}\n        imagePullPolicy: Always\n        env:\n        - name: DB_NAME\n          value: addresses\n        - name: DB_HOST\n          valueFrom:\n            secretKeyRef:\n              name: mongodb-secret\n              key: db-host\n        - name: DB_PORT\n          valueFrom:\n            secretKeyRef:\n              name: mongodb-secret\n              key: db-port\n        - name: DB_USER\n          valueFrom:\n            secretKeyRef:\n              name: mongodb-secret\n              key: db-user\n        - name: DB_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: mongodb-secret\n              key: db-password\n        - name: DB_OPTIONS\n          valueFrom:\n            secretKeyRef:\n              name: mongodb-secret\n              key: db-options\n        - name: DB_PREFIX\n          valueFrom:\n            secretKeyRef:\n              name: mongodb-secret\n              key: db-prefix\n        - name: DB_TIMEOUT\n          valueFrom:\n            secretKeyRef:\n              name: mongodb-secret\n              key: db-timeout\n        - name: QUEUE_HOST\n          valueFrom:\n            secretKeyRef:\n              name: redis-secret\n              key: queue-host\n        - name: QUEUE_PORT\n          valueFrom:\n            secretKeyRef:\n              name: redis-secret\n              key: queue-port\n        - name: QUEUE_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: redis-secret\n              key: queue-password\n        - name: QUEUE_TIMEOUT\n          valueFrom:\n            secretKeyRef:\n              name: redis-secret\n              key: queue-timeout\n        - name: MICROSERVICE_URL\n          valueFrom:\n            secretKeyRef:\n              name: rabbitmq-secret\n              key: url\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"addresses-service\" has cpu request 0"
  },
  {
    "id": "01067",
    "manifest_path": "data/manifests/the_stack_sample/sample_0272.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: addresses-service-deployment\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: addresses-service\n  template:\n    metadata:\n      labels:\n        app: addresses-service\n    spec:\n      containers:\n      - name: addresses-service\n        image: stokei/addresses-service:latest\n        resources: {}\n        imagePullPolicy: Always\n        env:\n        - name: DB_NAME\n          value: addresses\n        - name: DB_HOST\n          valueFrom:\n            secretKeyRef:\n              name: mongodb-secret\n              key: db-host\n        - name: DB_PORT\n          valueFrom:\n            secretKeyRef:\n              name: mongodb-secret\n              key: db-port\n        - name: DB_USER\n          valueFrom:\n            secretKeyRef:\n              name: mongodb-secret\n              key: db-user\n        - name: DB_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: mongodb-secret\n              key: db-password\n        - name: DB_OPTIONS\n          valueFrom:\n            secretKeyRef:\n              name: mongodb-secret\n              key: db-options\n        - name: DB_PREFIX\n          valueFrom:\n            secretKeyRef:\n              name: mongodb-secret\n              key: db-prefix\n        - name: DB_TIMEOUT\n          valueFrom:\n            secretKeyRef:\n              name: mongodb-secret\n              key: db-timeout\n        - name: QUEUE_HOST\n          valueFrom:\n            secretKeyRef:\n              name: redis-secret\n              key: queue-host\n        - name: QUEUE_PORT\n          valueFrom:\n            secretKeyRef:\n              name: redis-secret\n              key: queue-port\n        - name: QUEUE_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: redis-secret\n              key: queue-password\n        - name: QUEUE_TIMEOUT\n          valueFrom:\n            secretKeyRef:\n              name: redis-secret\n              key: queue-timeout\n        - name: MICROSERVICE_URL\n          valueFrom:\n            secretKeyRef:\n              name: rabbitmq-secret\n              key: url\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"addresses-service\" has memory limit 0"
  },
  {
    "id": "01068",
    "manifest_path": "data/manifests/the_stack_sample/sample_0274.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: startstopdemo-687f\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: startstopdemo-687f\n  template:\n    metadata:\n      labels:\n        app: startstopdemo-687f\n    spec:\n      containers:\n      - name: startstopdemo-687f\n        image: testrg12.azurecr.io/startstopdemo\n        ports:\n        - containerPort: 80\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"startstopdemo-687f\" is using an invalid container image, \"testrg12.azurecr.io/startstopdemo\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "01069",
    "manifest_path": "data/manifests/the_stack_sample/sample_0274.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: startstopdemo-687f\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: startstopdemo-687f\n  template:\n    metadata:\n      labels:\n        app: startstopdemo-687f\n    spec:\n      containers:\n      - name: startstopdemo-687f\n        image: testrg12.azurecr.io/startstopdemo\n        ports:\n        - containerPort: 80\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"startstopdemo-687f\" does not have a read-only root file system"
  },
  {
    "id": "01070",
    "manifest_path": "data/manifests/the_stack_sample/sample_0274.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: startstopdemo-687f\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: startstopdemo-687f\n  template:\n    metadata:\n      labels:\n        app: startstopdemo-687f\n    spec:\n      containers:\n      - name: startstopdemo-687f\n        image: testrg12.azurecr.io/startstopdemo\n        ports:\n        - containerPort: 80\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"startstopdemo-687f\" is not set to runAsNonRoot"
  },
  {
    "id": "01071",
    "manifest_path": "data/manifests/the_stack_sample/sample_0274.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: startstopdemo-687f\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: startstopdemo-687f\n  template:\n    metadata:\n      labels:\n        app: startstopdemo-687f\n    spec:\n      containers:\n      - name: startstopdemo-687f\n        image: testrg12.azurecr.io/startstopdemo\n        ports:\n        - containerPort: 80\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"startstopdemo-687f\" has cpu request 0"
  },
  {
    "id": "01072",
    "manifest_path": "data/manifests/the_stack_sample/sample_0274.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: startstopdemo-687f\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: startstopdemo-687f\n  template:\n    metadata:\n      labels:\n        app: startstopdemo-687f\n    spec:\n      containers:\n      - name: startstopdemo-687f\n        image: testrg12.azurecr.io/startstopdemo\n        ports:\n        - containerPort: 80\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"startstopdemo-687f\" has memory limit 0"
  },
  {
    "id": "01073",
    "manifest_path": "data/manifests/the_stack_sample/sample_0275.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: ci\n  name: statusreconciler\n  labels:\n    app: prow\n    component: statusreconciler\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: prow\n      component: statusreconciler\n  template:\n    metadata:\n      labels:\n        app: prow\n        component: statusreconciler\n    spec:\n      serviceAccountName: statusreconciler\n      containers:\n      - name: statusreconciler\n        image: gcr.io/k8s-prow/status-reconciler:v20200404-591527a41\n        imagePullPolicy: Always\n        args:\n        - --dry-run=false\n        - --continue-on-error=true\n        - --plugin-config=/etc/plugins/plugins.yaml\n        - --config-path=/etc/config/config.yaml\n        - --github-token-path=/etc/github/oauth\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --github-graphql-endpoint=http://ghproxy/graphql\n        - --job-config-path=/etc/job-config\n        ports:\n        - name: http\n          containerPort: 8888\n        volumeMounts:\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config-misc\n          mountPath: /etc/job-config/misc\n          readOnly: true\n        - name: job-config-master\n          mountPath: /etc/job-config/master\n          readOnly: true\n        - name: job-config-3x\n          mountPath: /etc/job-config/3.x\n          readOnly: true\n        - name: job-config-41\n          mountPath: /etc/job-config/4.1\n          readOnly: true\n        - name: job-config-42\n          mountPath: /etc/job-config/4.2\n          readOnly: true\n        - name: job-config-43\n          mountPath: /etc/job-config/4.3\n          readOnly: true\n        - name: job-config-44\n          mountPath: /etc/job-config/4.4\n          readOnly: true\n        - name: job-config-45\n          mountPath: /etc/job-config/4.5\n          readOnly: true\n        - name: job-config-46\n          mountPath: /etc/job-config/4.6\n          readOnly: true\n        - name: plugins\n          mountPath: /etc/plugins\n          readOnly: true\n        resources:\n          requests:\n            memory: 200Mi\n            cpu: 20m\n      volumes:\n      - name: oauth\n        secret:\n          secretName: github-credentials-openshift-ci-robot\n      - name: config\n        configMap:\n          name: config\n      - name: job-config-misc\n        configMap:\n          name: job-config-misc\n      - name: job-config-master\n        configMap:\n          name: job-config-master\n      - name: job-config-3x\n        configMap:\n          name: job-config-3.x\n      - name: job-config-41\n        configMap:\n          name: job-config-4.1\n      - name: job-config-42\n        configMap:\n          name: job-config-4.2\n      - name: job-config-43\n        configMap:\n          name: job-config-4.3\n      - name: job-config-44\n        configMap:\n          name: job-config-4.4\n      - name: job-config-45\n        configMap:\n          name: job-config-4.5\n      - name: job-config-46\n        configMap:\n          name: job-config-4.6\n      - name: plugins\n        configMap:\n          name: plugins\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"statusreconciler\" does not have a read-only root file system"
  },
  {
    "id": "01074",
    "manifest_path": "data/manifests/the_stack_sample/sample_0275.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: ci\n  name: statusreconciler\n  labels:\n    app: prow\n    component: statusreconciler\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: prow\n      component: statusreconciler\n  template:\n    metadata:\n      labels:\n        app: prow\n        component: statusreconciler\n    spec:\n      serviceAccountName: statusreconciler\n      containers:\n      - name: statusreconciler\n        image: gcr.io/k8s-prow/status-reconciler:v20200404-591527a41\n        imagePullPolicy: Always\n        args:\n        - --dry-run=false\n        - --continue-on-error=true\n        - --plugin-config=/etc/plugins/plugins.yaml\n        - --config-path=/etc/config/config.yaml\n        - --github-token-path=/etc/github/oauth\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --github-graphql-endpoint=http://ghproxy/graphql\n        - --job-config-path=/etc/job-config\n        ports:\n        - name: http\n          containerPort: 8888\n        volumeMounts:\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config-misc\n          mountPath: /etc/job-config/misc\n          readOnly: true\n        - name: job-config-master\n          mountPath: /etc/job-config/master\n          readOnly: true\n        - name: job-config-3x\n          mountPath: /etc/job-config/3.x\n          readOnly: true\n        - name: job-config-41\n          mountPath: /etc/job-config/4.1\n          readOnly: true\n        - name: job-config-42\n          mountPath: /etc/job-config/4.2\n          readOnly: true\n        - name: job-config-43\n          mountPath: /etc/job-config/4.3\n          readOnly: true\n        - name: job-config-44\n          mountPath: /etc/job-config/4.4\n          readOnly: true\n        - name: job-config-45\n          mountPath: /etc/job-config/4.5\n          readOnly: true\n        - name: job-config-46\n          mountPath: /etc/job-config/4.6\n          readOnly: true\n        - name: plugins\n          mountPath: /etc/plugins\n          readOnly: true\n        resources:\n          requests:\n            memory: 200Mi\n            cpu: 20m\n      volumes:\n      - name: oauth\n        secret:\n          secretName: github-credentials-openshift-ci-robot\n      - name: config\n        configMap:\n          name: config\n      - name: job-config-misc\n        configMap:\n          name: job-config-misc\n      - name: job-config-master\n        configMap:\n          name: job-config-master\n      - name: job-config-3x\n        configMap:\n          name: job-config-3.x\n      - name: job-config-41\n        configMap:\n          name: job-config-4.1\n      - name: job-config-42\n        configMap:\n          name: job-config-4.2\n      - name: job-config-43\n        configMap:\n          name: job-config-4.3\n      - name: job-config-44\n        configMap:\n          name: job-config-4.4\n      - name: job-config-45\n        configMap:\n          name: job-config-4.5\n      - name: job-config-46\n        configMap:\n          name: job-config-4.6\n      - name: plugins\n        configMap:\n          name: plugins\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"statusreconciler\" is not set to runAsNonRoot"
  },
  {
    "id": "01075",
    "manifest_path": "data/manifests/the_stack_sample/sample_0275.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: ci\n  name: statusreconciler\n  labels:\n    app: prow\n    component: statusreconciler\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: prow\n      component: statusreconciler\n  template:\n    metadata:\n      labels:\n        app: prow\n        component: statusreconciler\n    spec:\n      serviceAccountName: statusreconciler\n      containers:\n      - name: statusreconciler\n        image: gcr.io/k8s-prow/status-reconciler:v20200404-591527a41\n        imagePullPolicy: Always\n        args:\n        - --dry-run=false\n        - --continue-on-error=true\n        - --plugin-config=/etc/plugins/plugins.yaml\n        - --config-path=/etc/config/config.yaml\n        - --github-token-path=/etc/github/oauth\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --github-graphql-endpoint=http://ghproxy/graphql\n        - --job-config-path=/etc/job-config\n        ports:\n        - name: http\n          containerPort: 8888\n        volumeMounts:\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config-misc\n          mountPath: /etc/job-config/misc\n          readOnly: true\n        - name: job-config-master\n          mountPath: /etc/job-config/master\n          readOnly: true\n        - name: job-config-3x\n          mountPath: /etc/job-config/3.x\n          readOnly: true\n        - name: job-config-41\n          mountPath: /etc/job-config/4.1\n          readOnly: true\n        - name: job-config-42\n          mountPath: /etc/job-config/4.2\n          readOnly: true\n        - name: job-config-43\n          mountPath: /etc/job-config/4.3\n          readOnly: true\n        - name: job-config-44\n          mountPath: /etc/job-config/4.4\n          readOnly: true\n        - name: job-config-45\n          mountPath: /etc/job-config/4.5\n          readOnly: true\n        - name: job-config-46\n          mountPath: /etc/job-config/4.6\n          readOnly: true\n        - name: plugins\n          mountPath: /etc/plugins\n          readOnly: true\n        resources:\n          requests:\n            memory: 200Mi\n            cpu: 20m\n      volumes:\n      - name: oauth\n        secret:\n          secretName: github-credentials-openshift-ci-robot\n      - name: config\n        configMap:\n          name: config\n      - name: job-config-misc\n        configMap:\n          name: job-config-misc\n      - name: job-config-master\n        configMap:\n          name: job-config-master\n      - name: job-config-3x\n        configMap:\n          name: job-config-3.x\n      - name: job-config-41\n        configMap:\n          name: job-config-4.1\n      - name: job-config-42\n        configMap:\n          name: job-config-4.2\n      - name: job-config-43\n        configMap:\n          name: job-config-4.3\n      - name: job-config-44\n        configMap:\n          name: job-config-4.4\n      - name: job-config-45\n        configMap:\n          name: job-config-4.5\n      - name: job-config-46\n        configMap:\n          name: job-config-4.6\n      - name: plugins\n        configMap:\n          name: plugins\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"statusreconciler\" has memory limit 0"
  },
  {
    "id": "01076",
    "manifest_path": "data/manifests/the_stack_sample/sample_0278.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: security-context-demo\nspec:\n  containers:\n  - name: sec-ctx-demo\n    image: gcr.io/google-samples/node-hello:1.0\n    securityContext:\n      capabilities:\n        add:\n        - SYS_ADMIN\n        - CHOWN\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"sec-ctx-demo\" does not have a read-only root file system"
  },
  {
    "id": "01077",
    "manifest_path": "data/manifests/the_stack_sample/sample_0278.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: security-context-demo\nspec:\n  containers:\n  - name: sec-ctx-demo\n    image: gcr.io/google-samples/node-hello:1.0\n    securityContext:\n      capabilities:\n        add:\n        - SYS_ADMIN\n        - CHOWN\n",
    "policy_id": "privilege-escalation-container",
    "violation_text": "container \"sec-ctx-demo\" has SYS_ADMIN capability hence allows privilege escalation."
  },
  {
    "id": "01078",
    "manifest_path": "data/manifests/the_stack_sample/sample_0278.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: security-context-demo\nspec:\n  containers:\n  - name: sec-ctx-demo\n    image: gcr.io/google-samples/node-hello:1.0\n    securityContext:\n      capabilities:\n        add:\n        - SYS_ADMIN\n        - CHOWN\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"sec-ctx-demo\" is not set to runAsNonRoot"
  },
  {
    "id": "01079",
    "manifest_path": "data/manifests/the_stack_sample/sample_0278.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: security-context-demo\nspec:\n  containers:\n  - name: sec-ctx-demo\n    image: gcr.io/google-samples/node-hello:1.0\n    securityContext:\n      capabilities:\n        add:\n        - SYS_ADMIN\n        - CHOWN\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"sec-ctx-demo\" has cpu request 0"
  },
  {
    "id": "01080",
    "manifest_path": "data/manifests/the_stack_sample/sample_0278.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: security-context-demo\nspec:\n  containers:\n  - name: sec-ctx-demo\n    image: gcr.io/google-samples/node-hello:1.0\n    securityContext:\n      capabilities:\n        add:\n        - SYS_ADMIN\n        - CHOWN\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"sec-ctx-demo\" has memory limit 0"
  }
]