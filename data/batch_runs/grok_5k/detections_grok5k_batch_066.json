[
  {
    "id": "02641",
    "manifest_path": "data/manifests/the_stack_sample/sample_1071.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: lighthouse-foghorn\n  labels:\n    chart: lighthouse-1.1.52\n    app: lighthouse-foghorn\n    gitops.jenkins-x.io/pipeline: namespaces\n  annotations:\n    meta.helm.sh/release-name: lighthouse\n    wave.pusher.com/update-on-config-change: 'true'\n  namespace: jx\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: lighthouse-foghorn\n  template:\n    metadata:\n      labels:\n        app: lighthouse-foghorn\n      annotations:\n        jenkins-x.io/hash: 8a8b833ba1b6bd7a447a0e751960deed2ecd8106c1fcc7411dada4beae187d06\n    spec:\n      serviceAccountName: lighthouse-foghorn\n      containers:\n      - name: lighthouse-foghorn\n        image: ghcr.io/jenkins-x/lighthouse-foghorn:1.1.52\n        imagePullPolicy: IfNotPresent\n        args:\n        - --namespace=jx\n        env:\n        - name: GIT_KIND\n          value: github\n        - name: GIT_SERVER\n          value: https://github.com\n        - name: GIT_USER\n          value: gastonborba\n        - name: GIT_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: lighthouse-oauth-token\n              key: oauth\n        - name: HMAC_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: lighthouse-hmac-token\n              key: hmac\n              optional: false\n        - name: JX_LOG_FORMAT\n          value: json\n        - name: LOGRUS_FORMAT\n          value: json\n        - name: LOGRUS_SERVICE\n          value: lighthouse\n        - name: LOGRUS_SERVICE_VERSION\n          value: 1.1.52\n        - name: LOGRUS_STACK_SKIP\n          value: ''\n        - name: DEFAULT_PIPELINE_RUN_SERVICE_ACCOUNT\n          value: tekton-bot\n        - name: DEFAULT_PIPELINE_RUN_TIMEOUT\n          value: 2h0m0s\n        - name: FILE_BROWSER\n          value: git\n        - name: JX_DEFAULT_IMAGE\n          value: ghcr.io/jenkins-x/builder-maven:2.1.149-768\n        - name: LIGHTHOUSE_DASHBOARD_TEMPLATE\n          value: namespaces/{{ .Namespace }}/pipelineruns/{{ .PipelineRun }}\n        - name: LIGHTHOUSE_VERSIONSTREAM_JENKINS_X_JX3_PIPELINE_CATALOG\n          value: b8c01fa3c78e49707b1664fd573cbe2d129a2b78\n        resources:\n          limits:\n            cpu: 100m\n            memory: 256Mi\n          requests:\n            cpu: 80m\n            memory: 128Mi\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"lighthouse-foghorn\" is not set to runAsNonRoot"
  },
  {
    "id": "02642",
    "manifest_path": "data/manifests/the_stack_sample/sample_1075.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: ubu\nspec:\n  selector:\n    matchLabels:\n      app: ubu\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: ubu\n    spec:\n      containers:\n      - name: ubu\n        image: ubuntu\n        ports:\n        - containerPort: 5000\n        command:\n        - /bin/sleep\n        - 3650d\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"ubu\" is using an invalid container image, \"ubuntu\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02643",
    "manifest_path": "data/manifests/the_stack_sample/sample_1075.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: ubu\nspec:\n  selector:\n    matchLabels:\n      app: ubu\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: ubu\n    spec:\n      containers:\n      - name: ubu\n        image: ubuntu\n        ports:\n        - containerPort: 5000\n        command:\n        - /bin/sleep\n        - 3650d\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"ubu\" does not have a read-only root file system"
  },
  {
    "id": "02644",
    "manifest_path": "data/manifests/the_stack_sample/sample_1075.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: ubu\nspec:\n  selector:\n    matchLabels:\n      app: ubu\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: ubu\n    spec:\n      containers:\n      - name: ubu\n        image: ubuntu\n        ports:\n        - containerPort: 5000\n        command:\n        - /bin/sleep\n        - 3650d\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"ubu\" is not set to runAsNonRoot"
  },
  {
    "id": "02645",
    "manifest_path": "data/manifests/the_stack_sample/sample_1075.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: ubu\nspec:\n  selector:\n    matchLabels:\n      app: ubu\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: ubu\n    spec:\n      containers:\n      - name: ubu\n        image: ubuntu\n        ports:\n        - containerPort: 5000\n        command:\n        - /bin/sleep\n        - 3650d\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"ubu\" has cpu request 0"
  },
  {
    "id": "02646",
    "manifest_path": "data/manifests/the_stack_sample/sample_1075.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: ubu\nspec:\n  selector:\n    matchLabels:\n      app: ubu\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: ubu\n    spec:\n      containers:\n      - name: ubu\n        image: ubuntu\n        ports:\n        - containerPort: 5000\n        command:\n        - /bin/sleep\n        - 3650d\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"ubu\" has memory limit 0"
  },
  {
    "id": "02647",
    "manifest_path": "data/manifests/the_stack_sample/sample_1076.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: pt-1.6-python-ops-func-v2-8\n  namespace: automated\nspec:\n  jobTemplate:\n    template:\n      metadata:\n        annotations:\n          tf-version.cloud-tpus.google.com: pytorch-1.6\n      spec:\n        containers:\n        - env:\n          - name: POD_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.name\n          - name: POD_NAMESPACE\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.namespace\n          image: gcr.io/xl-ml-test/health-monitor:stable\n          imagePullPolicy: Always\n          name: monitor\n        - args:\n          - bash\n          - pytorch/xla/test/run_tests.sh\n          env:\n          - name: POD_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.name\n          - name: POD_UID\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.uid\n          - name: POD_NAMESPACE\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.namespace\n          - name: JOB_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.labels['job-name']\n          - name: MODEL_DIR\n            value: $(OUTPUT_BUCKET)/pt-1.6/python-ops/func/v2-8/$(JOB_NAME)\n          - name: XLA_USE_BF16\n            value: '0'\n          envFrom:\n          - configMapRef:\n              name: gcs-buckets\n          image: gcr.io/xl-ml-test/pytorch-xla:r1.6\n          imagePullPolicy: Always\n          name: train\n          resources:\n            limits:\n              cloud-tpus.google.com/v2: 8\n            requests:\n              cpu: '4.5'\n              memory: 8Gi\n          volumeMounts:\n          - mountPath: /dev/shm\n            name: dshm\n            readOnly: false\n        initContainers:\n        - env:\n          - name: POD_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.name\n          - name: POD_UID\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.uid\n          - name: POD_NAMESPACE\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.namespace\n          - name: JOB_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.labels['job-name']\n          - name: MODEL_DIR\n            value: $(OUTPUT_BUCKET)/pt-1.6/python-ops/func/v2-8/$(JOB_NAME)\n          - name: METRIC_CONFIG\n            value: \"{\\n \\\"metric_collection_config\\\": {\\n  \\\"default_aggregation_strategies\\\"\\\n              : [\\n   \\\"final\\\"\\n  ],\\n  \\\"tags_to_ignore\\\": [\\n   \\\"LearningRate\\\"\\\n              \\n  ],\\n  \\\"write_to_bigquery\\\": true\\n },\\n \\\"regression_test_config\\\"\\\n              : null,\\n \\\"test_name\\\": \\\"pt-1.6-python-ops-func-v2-8\\\"\\n}\\n\"\n          envFrom:\n          - configMapRef:\n              name: gcs-buckets\n          image: gcr.io/xl-ml-test/publisher:stable\n          imagePullPolicy: Always\n          name: publisher\n        volumes:\n        - emptyDir:\n            medium: Memory\n          name: dshm\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"monitor\" does not have a read-only root file system"
  },
  {
    "id": "02648",
    "manifest_path": "data/manifests/the_stack_sample/sample_1076.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: pt-1.6-python-ops-func-v2-8\n  namespace: automated\nspec:\n  jobTemplate:\n    template:\n      metadata:\n        annotations:\n          tf-version.cloud-tpus.google.com: pytorch-1.6\n      spec:\n        containers:\n        - env:\n          - name: POD_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.name\n          - name: POD_NAMESPACE\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.namespace\n          image: gcr.io/xl-ml-test/health-monitor:stable\n          imagePullPolicy: Always\n          name: monitor\n        - args:\n          - bash\n          - pytorch/xla/test/run_tests.sh\n          env:\n          - name: POD_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.name\n          - name: POD_UID\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.uid\n          - name: POD_NAMESPACE\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.namespace\n          - name: JOB_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.labels['job-name']\n          - name: MODEL_DIR\n            value: $(OUTPUT_BUCKET)/pt-1.6/python-ops/func/v2-8/$(JOB_NAME)\n          - name: XLA_USE_BF16\n            value: '0'\n          envFrom:\n          - configMapRef:\n              name: gcs-buckets\n          image: gcr.io/xl-ml-test/pytorch-xla:r1.6\n          imagePullPolicy: Always\n          name: train\n          resources:\n            limits:\n              cloud-tpus.google.com/v2: 8\n            requests:\n              cpu: '4.5'\n              memory: 8Gi\n          volumeMounts:\n          - mountPath: /dev/shm\n            name: dshm\n            readOnly: false\n        initContainers:\n        - env:\n          - name: POD_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.name\n          - name: POD_UID\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.uid\n          - name: POD_NAMESPACE\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.namespace\n          - name: JOB_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.labels['job-name']\n          - name: MODEL_DIR\n            value: $(OUTPUT_BUCKET)/pt-1.6/python-ops/func/v2-8/$(JOB_NAME)\n          - name: METRIC_CONFIG\n            value: \"{\\n \\\"metric_collection_config\\\": {\\n  \\\"default_aggregation_strategies\\\"\\\n              : [\\n   \\\"final\\\"\\n  ],\\n  \\\"tags_to_ignore\\\": [\\n   \\\"LearningRate\\\"\\\n              \\n  ],\\n  \\\"write_to_bigquery\\\": true\\n },\\n \\\"regression_test_config\\\"\\\n              : null,\\n \\\"test_name\\\": \\\"pt-1.6-python-ops-func-v2-8\\\"\\n}\\n\"\n          envFrom:\n          - configMapRef:\n              name: gcs-buckets\n          image: gcr.io/xl-ml-test/publisher:stable\n          imagePullPolicy: Always\n          name: publisher\n        volumes:\n        - emptyDir:\n            medium: Memory\n          name: dshm\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"publisher\" does not have a read-only root file system"
  },
  {
    "id": "02649",
    "manifest_path": "data/manifests/the_stack_sample/sample_1076.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: pt-1.6-python-ops-func-v2-8\n  namespace: automated\nspec:\n  jobTemplate:\n    template:\n      metadata:\n        annotations:\n          tf-version.cloud-tpus.google.com: pytorch-1.6\n      spec:\n        containers:\n        - env:\n          - name: POD_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.name\n          - name: POD_NAMESPACE\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.namespace\n          image: gcr.io/xl-ml-test/health-monitor:stable\n          imagePullPolicy: Always\n          name: monitor\n        - args:\n          - bash\n          - pytorch/xla/test/run_tests.sh\n          env:\n          - name: POD_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.name\n          - name: POD_UID\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.uid\n          - name: POD_NAMESPACE\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.namespace\n          - name: JOB_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.labels['job-name']\n          - name: MODEL_DIR\n            value: $(OUTPUT_BUCKET)/pt-1.6/python-ops/func/v2-8/$(JOB_NAME)\n          - name: XLA_USE_BF16\n            value: '0'\n          envFrom:\n          - configMapRef:\n              name: gcs-buckets\n          image: gcr.io/xl-ml-test/pytorch-xla:r1.6\n          imagePullPolicy: Always\n          name: train\n          resources:\n            limits:\n              cloud-tpus.google.com/v2: 8\n            requests:\n              cpu: '4.5'\n              memory: 8Gi\n          volumeMounts:\n          - mountPath: /dev/shm\n            name: dshm\n            readOnly: false\n        initContainers:\n        - env:\n          - name: POD_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.name\n          - name: POD_UID\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.uid\n          - name: POD_NAMESPACE\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.namespace\n          - name: JOB_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.labels['job-name']\n          - name: MODEL_DIR\n            value: $(OUTPUT_BUCKET)/pt-1.6/python-ops/func/v2-8/$(JOB_NAME)\n          - name: METRIC_CONFIG\n            value: \"{\\n \\\"metric_collection_config\\\": {\\n  \\\"default_aggregation_strategies\\\"\\\n              : [\\n   \\\"final\\\"\\n  ],\\n  \\\"tags_to_ignore\\\": [\\n   \\\"LearningRate\\\"\\\n              \\n  ],\\n  \\\"write_to_bigquery\\\": true\\n },\\n \\\"regression_test_config\\\"\\\n              : null,\\n \\\"test_name\\\": \\\"pt-1.6-python-ops-func-v2-8\\\"\\n}\\n\"\n          envFrom:\n          - configMapRef:\n              name: gcs-buckets\n          image: gcr.io/xl-ml-test/publisher:stable\n          imagePullPolicy: Always\n          name: publisher\n        volumes:\n        - emptyDir:\n            medium: Memory\n          name: dshm\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"train\" does not have a read-only root file system"
  },
  {
    "id": "02650",
    "manifest_path": "data/manifests/the_stack_sample/sample_1076.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: pt-1.6-python-ops-func-v2-8\n  namespace: automated\nspec:\n  jobTemplate:\n    template:\n      metadata:\n        annotations:\n          tf-version.cloud-tpus.google.com: pytorch-1.6\n      spec:\n        containers:\n        - env:\n          - name: POD_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.name\n          - name: POD_NAMESPACE\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.namespace\n          image: gcr.io/xl-ml-test/health-monitor:stable\n          imagePullPolicy: Always\n          name: monitor\n        - args:\n          - bash\n          - pytorch/xla/test/run_tests.sh\n          env:\n          - name: POD_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.name\n          - name: POD_UID\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.uid\n          - name: POD_NAMESPACE\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.namespace\n          - name: JOB_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.labels['job-name']\n          - name: MODEL_DIR\n            value: $(OUTPUT_BUCKET)/pt-1.6/python-ops/func/v2-8/$(JOB_NAME)\n          - name: XLA_USE_BF16\n            value: '0'\n          envFrom:\n          - configMapRef:\n              name: gcs-buckets\n          image: gcr.io/xl-ml-test/pytorch-xla:r1.6\n          imagePullPolicy: Always\n          name: train\n          resources:\n            limits:\n              cloud-tpus.google.com/v2: 8\n            requests:\n              cpu: '4.5'\n              memory: 8Gi\n          volumeMounts:\n          - mountPath: /dev/shm\n            name: dshm\n            readOnly: false\n        initContainers:\n        - env:\n          - name: POD_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.name\n          - name: POD_UID\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.uid\n          - name: POD_NAMESPACE\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.namespace\n          - name: JOB_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.labels['job-name']\n          - name: MODEL_DIR\n            value: $(OUTPUT_BUCKET)/pt-1.6/python-ops/func/v2-8/$(JOB_NAME)\n          - name: METRIC_CONFIG\n            value: \"{\\n \\\"metric_collection_config\\\": {\\n  \\\"default_aggregation_strategies\\\"\\\n              : [\\n   \\\"final\\\"\\n  ],\\n  \\\"tags_to_ignore\\\": [\\n   \\\"LearningRate\\\"\\\n              \\n  ],\\n  \\\"write_to_bigquery\\\": true\\n },\\n \\\"regression_test_config\\\"\\\n              : null,\\n \\\"test_name\\\": \\\"pt-1.6-python-ops-func-v2-8\\\"\\n}\\n\"\n          envFrom:\n          - configMapRef:\n              name: gcs-buckets\n          image: gcr.io/xl-ml-test/publisher:stable\n          imagePullPolicy: Always\n          name: publisher\n        volumes:\n        - emptyDir:\n            medium: Memory\n          name: dshm\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"monitor\" is not set to runAsNonRoot"
  },
  {
    "id": "02651",
    "manifest_path": "data/manifests/the_stack_sample/sample_1076.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: pt-1.6-python-ops-func-v2-8\n  namespace: automated\nspec:\n  jobTemplate:\n    template:\n      metadata:\n        annotations:\n          tf-version.cloud-tpus.google.com: pytorch-1.6\n      spec:\n        containers:\n        - env:\n          - name: POD_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.name\n          - name: POD_NAMESPACE\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.namespace\n          image: gcr.io/xl-ml-test/health-monitor:stable\n          imagePullPolicy: Always\n          name: monitor\n        - args:\n          - bash\n          - pytorch/xla/test/run_tests.sh\n          env:\n          - name: POD_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.name\n          - name: POD_UID\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.uid\n          - name: POD_NAMESPACE\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.namespace\n          - name: JOB_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.labels['job-name']\n          - name: MODEL_DIR\n            value: $(OUTPUT_BUCKET)/pt-1.6/python-ops/func/v2-8/$(JOB_NAME)\n          - name: XLA_USE_BF16\n            value: '0'\n          envFrom:\n          - configMapRef:\n              name: gcs-buckets\n          image: gcr.io/xl-ml-test/pytorch-xla:r1.6\n          imagePullPolicy: Always\n          name: train\n          resources:\n            limits:\n              cloud-tpus.google.com/v2: 8\n            requests:\n              cpu: '4.5'\n              memory: 8Gi\n          volumeMounts:\n          - mountPath: /dev/shm\n            name: dshm\n            readOnly: false\n        initContainers:\n        - env:\n          - name: POD_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.name\n          - name: POD_UID\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.uid\n          - name: POD_NAMESPACE\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.namespace\n          - name: JOB_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.labels['job-name']\n          - name: MODEL_DIR\n            value: $(OUTPUT_BUCKET)/pt-1.6/python-ops/func/v2-8/$(JOB_NAME)\n          - name: METRIC_CONFIG\n            value: \"{\\n \\\"metric_collection_config\\\": {\\n  \\\"default_aggregation_strategies\\\"\\\n              : [\\n   \\\"final\\\"\\n  ],\\n  \\\"tags_to_ignore\\\": [\\n   \\\"LearningRate\\\"\\\n              \\n  ],\\n  \\\"write_to_bigquery\\\": true\\n },\\n \\\"regression_test_config\\\"\\\n              : null,\\n \\\"test_name\\\": \\\"pt-1.6-python-ops-func-v2-8\\\"\\n}\\n\"\n          envFrom:\n          - configMapRef:\n              name: gcs-buckets\n          image: gcr.io/xl-ml-test/publisher:stable\n          imagePullPolicy: Always\n          name: publisher\n        volumes:\n        - emptyDir:\n            medium: Memory\n          name: dshm\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"publisher\" is not set to runAsNonRoot"
  },
  {
    "id": "02652",
    "manifest_path": "data/manifests/the_stack_sample/sample_1076.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: pt-1.6-python-ops-func-v2-8\n  namespace: automated\nspec:\n  jobTemplate:\n    template:\n      metadata:\n        annotations:\n          tf-version.cloud-tpus.google.com: pytorch-1.6\n      spec:\n        containers:\n        - env:\n          - name: POD_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.name\n          - name: POD_NAMESPACE\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.namespace\n          image: gcr.io/xl-ml-test/health-monitor:stable\n          imagePullPolicy: Always\n          name: monitor\n        - args:\n          - bash\n          - pytorch/xla/test/run_tests.sh\n          env:\n          - name: POD_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.name\n          - name: POD_UID\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.uid\n          - name: POD_NAMESPACE\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.namespace\n          - name: JOB_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.labels['job-name']\n          - name: MODEL_DIR\n            value: $(OUTPUT_BUCKET)/pt-1.6/python-ops/func/v2-8/$(JOB_NAME)\n          - name: XLA_USE_BF16\n            value: '0'\n          envFrom:\n          - configMapRef:\n              name: gcs-buckets\n          image: gcr.io/xl-ml-test/pytorch-xla:r1.6\n          imagePullPolicy: Always\n          name: train\n          resources:\n            limits:\n              cloud-tpus.google.com/v2: 8\n            requests:\n              cpu: '4.5'\n              memory: 8Gi\n          volumeMounts:\n          - mountPath: /dev/shm\n            name: dshm\n            readOnly: false\n        initContainers:\n        - env:\n          - name: POD_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.name\n          - name: POD_UID\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.uid\n          - name: POD_NAMESPACE\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.namespace\n          - name: JOB_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.labels['job-name']\n          - name: MODEL_DIR\n            value: $(OUTPUT_BUCKET)/pt-1.6/python-ops/func/v2-8/$(JOB_NAME)\n          - name: METRIC_CONFIG\n            value: \"{\\n \\\"metric_collection_config\\\": {\\n  \\\"default_aggregation_strategies\\\"\\\n              : [\\n   \\\"final\\\"\\n  ],\\n  \\\"tags_to_ignore\\\": [\\n   \\\"LearningRate\\\"\\\n              \\n  ],\\n  \\\"write_to_bigquery\\\": true\\n },\\n \\\"regression_test_config\\\"\\\n              : null,\\n \\\"test_name\\\": \\\"pt-1.6-python-ops-func-v2-8\\\"\\n}\\n\"\n          envFrom:\n          - configMapRef:\n              name: gcs-buckets\n          image: gcr.io/xl-ml-test/publisher:stable\n          imagePullPolicy: Always\n          name: publisher\n        volumes:\n        - emptyDir:\n            medium: Memory\n          name: dshm\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"train\" is not set to runAsNonRoot"
  },
  {
    "id": "02653",
    "manifest_path": "data/manifests/the_stack_sample/sample_1076.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: pt-1.6-python-ops-func-v2-8\n  namespace: automated\nspec:\n  jobTemplate:\n    template:\n      metadata:\n        annotations:\n          tf-version.cloud-tpus.google.com: pytorch-1.6\n      spec:\n        containers:\n        - env:\n          - name: POD_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.name\n          - name: POD_NAMESPACE\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.namespace\n          image: gcr.io/xl-ml-test/health-monitor:stable\n          imagePullPolicy: Always\n          name: monitor\n        - args:\n          - bash\n          - pytorch/xla/test/run_tests.sh\n          env:\n          - name: POD_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.name\n          - name: POD_UID\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.uid\n          - name: POD_NAMESPACE\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.namespace\n          - name: JOB_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.labels['job-name']\n          - name: MODEL_DIR\n            value: $(OUTPUT_BUCKET)/pt-1.6/python-ops/func/v2-8/$(JOB_NAME)\n          - name: XLA_USE_BF16\n            value: '0'\n          envFrom:\n          - configMapRef:\n              name: gcs-buckets\n          image: gcr.io/xl-ml-test/pytorch-xla:r1.6\n          imagePullPolicy: Always\n          name: train\n          resources:\n            limits:\n              cloud-tpus.google.com/v2: 8\n            requests:\n              cpu: '4.5'\n              memory: 8Gi\n          volumeMounts:\n          - mountPath: /dev/shm\n            name: dshm\n            readOnly: false\n        initContainers:\n        - env:\n          - name: POD_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.name\n          - name: POD_UID\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.uid\n          - name: POD_NAMESPACE\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.namespace\n          - name: JOB_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.labels['job-name']\n          - name: MODEL_DIR\n            value: $(OUTPUT_BUCKET)/pt-1.6/python-ops/func/v2-8/$(JOB_NAME)\n          - name: METRIC_CONFIG\n            value: \"{\\n \\\"metric_collection_config\\\": {\\n  \\\"default_aggregation_strategies\\\"\\\n              : [\\n   \\\"final\\\"\\n  ],\\n  \\\"tags_to_ignore\\\": [\\n   \\\"LearningRate\\\"\\\n              \\n  ],\\n  \\\"write_to_bigquery\\\": true\\n },\\n \\\"regression_test_config\\\"\\\n              : null,\\n \\\"test_name\\\": \\\"pt-1.6-python-ops-func-v2-8\\\"\\n}\\n\"\n          envFrom:\n          - configMapRef:\n              name: gcs-buckets\n          image: gcr.io/xl-ml-test/publisher:stable\n          imagePullPolicy: Always\n          name: publisher\n        volumes:\n        - emptyDir:\n            medium: Memory\n          name: dshm\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"monitor\" has cpu request 0"
  },
  {
    "id": "02654",
    "manifest_path": "data/manifests/the_stack_sample/sample_1076.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: pt-1.6-python-ops-func-v2-8\n  namespace: automated\nspec:\n  jobTemplate:\n    template:\n      metadata:\n        annotations:\n          tf-version.cloud-tpus.google.com: pytorch-1.6\n      spec:\n        containers:\n        - env:\n          - name: POD_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.name\n          - name: POD_NAMESPACE\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.namespace\n          image: gcr.io/xl-ml-test/health-monitor:stable\n          imagePullPolicy: Always\n          name: monitor\n        - args:\n          - bash\n          - pytorch/xla/test/run_tests.sh\n          env:\n          - name: POD_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.name\n          - name: POD_UID\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.uid\n          - name: POD_NAMESPACE\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.namespace\n          - name: JOB_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.labels['job-name']\n          - name: MODEL_DIR\n            value: $(OUTPUT_BUCKET)/pt-1.6/python-ops/func/v2-8/$(JOB_NAME)\n          - name: XLA_USE_BF16\n            value: '0'\n          envFrom:\n          - configMapRef:\n              name: gcs-buckets\n          image: gcr.io/xl-ml-test/pytorch-xla:r1.6\n          imagePullPolicy: Always\n          name: train\n          resources:\n            limits:\n              cloud-tpus.google.com/v2: 8\n            requests:\n              cpu: '4.5'\n              memory: 8Gi\n          volumeMounts:\n          - mountPath: /dev/shm\n            name: dshm\n            readOnly: false\n        initContainers:\n        - env:\n          - name: POD_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.name\n          - name: POD_UID\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.uid\n          - name: POD_NAMESPACE\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.namespace\n          - name: JOB_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.labels['job-name']\n          - name: MODEL_DIR\n            value: $(OUTPUT_BUCKET)/pt-1.6/python-ops/func/v2-8/$(JOB_NAME)\n          - name: METRIC_CONFIG\n            value: \"{\\n \\\"metric_collection_config\\\": {\\n  \\\"default_aggregation_strategies\\\"\\\n              : [\\n   \\\"final\\\"\\n  ],\\n  \\\"tags_to_ignore\\\": [\\n   \\\"LearningRate\\\"\\\n              \\n  ],\\n  \\\"write_to_bigquery\\\": true\\n },\\n \\\"regression_test_config\\\"\\\n              : null,\\n \\\"test_name\\\": \\\"pt-1.6-python-ops-func-v2-8\\\"\\n}\\n\"\n          envFrom:\n          - configMapRef:\n              name: gcs-buckets\n          image: gcr.io/xl-ml-test/publisher:stable\n          imagePullPolicy: Always\n          name: publisher\n        volumes:\n        - emptyDir:\n            medium: Memory\n          name: dshm\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"publisher\" has cpu request 0"
  },
  {
    "id": "02655",
    "manifest_path": "data/manifests/the_stack_sample/sample_1076.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: pt-1.6-python-ops-func-v2-8\n  namespace: automated\nspec:\n  jobTemplate:\n    template:\n      metadata:\n        annotations:\n          tf-version.cloud-tpus.google.com: pytorch-1.6\n      spec:\n        containers:\n        - env:\n          - name: POD_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.name\n          - name: POD_NAMESPACE\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.namespace\n          image: gcr.io/xl-ml-test/health-monitor:stable\n          imagePullPolicy: Always\n          name: monitor\n        - args:\n          - bash\n          - pytorch/xla/test/run_tests.sh\n          env:\n          - name: POD_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.name\n          - name: POD_UID\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.uid\n          - name: POD_NAMESPACE\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.namespace\n          - name: JOB_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.labels['job-name']\n          - name: MODEL_DIR\n            value: $(OUTPUT_BUCKET)/pt-1.6/python-ops/func/v2-8/$(JOB_NAME)\n          - name: XLA_USE_BF16\n            value: '0'\n          envFrom:\n          - configMapRef:\n              name: gcs-buckets\n          image: gcr.io/xl-ml-test/pytorch-xla:r1.6\n          imagePullPolicy: Always\n          name: train\n          resources:\n            limits:\n              cloud-tpus.google.com/v2: 8\n            requests:\n              cpu: '4.5'\n              memory: 8Gi\n          volumeMounts:\n          - mountPath: /dev/shm\n            name: dshm\n            readOnly: false\n        initContainers:\n        - env:\n          - name: POD_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.name\n          - name: POD_UID\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.uid\n          - name: POD_NAMESPACE\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.namespace\n          - name: JOB_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.labels['job-name']\n          - name: MODEL_DIR\n            value: $(OUTPUT_BUCKET)/pt-1.6/python-ops/func/v2-8/$(JOB_NAME)\n          - name: METRIC_CONFIG\n            value: \"{\\n \\\"metric_collection_config\\\": {\\n  \\\"default_aggregation_strategies\\\"\\\n              : [\\n   \\\"final\\\"\\n  ],\\n  \\\"tags_to_ignore\\\": [\\n   \\\"LearningRate\\\"\\\n              \\n  ],\\n  \\\"write_to_bigquery\\\": true\\n },\\n \\\"regression_test_config\\\"\\\n              : null,\\n \\\"test_name\\\": \\\"pt-1.6-python-ops-func-v2-8\\\"\\n}\\n\"\n          envFrom:\n          - configMapRef:\n              name: gcs-buckets\n          image: gcr.io/xl-ml-test/publisher:stable\n          imagePullPolicy: Always\n          name: publisher\n        volumes:\n        - emptyDir:\n            medium: Memory\n          name: dshm\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"monitor\" has memory limit 0"
  },
  {
    "id": "02656",
    "manifest_path": "data/manifests/the_stack_sample/sample_1076.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: pt-1.6-python-ops-func-v2-8\n  namespace: automated\nspec:\n  jobTemplate:\n    template:\n      metadata:\n        annotations:\n          tf-version.cloud-tpus.google.com: pytorch-1.6\n      spec:\n        containers:\n        - env:\n          - name: POD_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.name\n          - name: POD_NAMESPACE\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.namespace\n          image: gcr.io/xl-ml-test/health-monitor:stable\n          imagePullPolicy: Always\n          name: monitor\n        - args:\n          - bash\n          - pytorch/xla/test/run_tests.sh\n          env:\n          - name: POD_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.name\n          - name: POD_UID\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.uid\n          - name: POD_NAMESPACE\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.namespace\n          - name: JOB_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.labels['job-name']\n          - name: MODEL_DIR\n            value: $(OUTPUT_BUCKET)/pt-1.6/python-ops/func/v2-8/$(JOB_NAME)\n          - name: XLA_USE_BF16\n            value: '0'\n          envFrom:\n          - configMapRef:\n              name: gcs-buckets\n          image: gcr.io/xl-ml-test/pytorch-xla:r1.6\n          imagePullPolicy: Always\n          name: train\n          resources:\n            limits:\n              cloud-tpus.google.com/v2: 8\n            requests:\n              cpu: '4.5'\n              memory: 8Gi\n          volumeMounts:\n          - mountPath: /dev/shm\n            name: dshm\n            readOnly: false\n        initContainers:\n        - env:\n          - name: POD_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.name\n          - name: POD_UID\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.uid\n          - name: POD_NAMESPACE\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.namespace\n          - name: JOB_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.labels['job-name']\n          - name: MODEL_DIR\n            value: $(OUTPUT_BUCKET)/pt-1.6/python-ops/func/v2-8/$(JOB_NAME)\n          - name: METRIC_CONFIG\n            value: \"{\\n \\\"metric_collection_config\\\": {\\n  \\\"default_aggregation_strategies\\\"\\\n              : [\\n   \\\"final\\\"\\n  ],\\n  \\\"tags_to_ignore\\\": [\\n   \\\"LearningRate\\\"\\\n              \\n  ],\\n  \\\"write_to_bigquery\\\": true\\n },\\n \\\"regression_test_config\\\"\\\n              : null,\\n \\\"test_name\\\": \\\"pt-1.6-python-ops-func-v2-8\\\"\\n}\\n\"\n          envFrom:\n          - configMapRef:\n              name: gcs-buckets\n          image: gcr.io/xl-ml-test/publisher:stable\n          imagePullPolicy: Always\n          name: publisher\n        volumes:\n        - emptyDir:\n            medium: Memory\n          name: dshm\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"publisher\" has memory limit 0"
  },
  {
    "id": "02657",
    "manifest_path": "data/manifests/the_stack_sample/sample_1076.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: pt-1.6-python-ops-func-v2-8\n  namespace: automated\nspec:\n  jobTemplate:\n    template:\n      metadata:\n        annotations:\n          tf-version.cloud-tpus.google.com: pytorch-1.6\n      spec:\n        containers:\n        - env:\n          - name: POD_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.name\n          - name: POD_NAMESPACE\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.namespace\n          image: gcr.io/xl-ml-test/health-monitor:stable\n          imagePullPolicy: Always\n          name: monitor\n        - args:\n          - bash\n          - pytorch/xla/test/run_tests.sh\n          env:\n          - name: POD_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.name\n          - name: POD_UID\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.uid\n          - name: POD_NAMESPACE\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.namespace\n          - name: JOB_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.labels['job-name']\n          - name: MODEL_DIR\n            value: $(OUTPUT_BUCKET)/pt-1.6/python-ops/func/v2-8/$(JOB_NAME)\n          - name: XLA_USE_BF16\n            value: '0'\n          envFrom:\n          - configMapRef:\n              name: gcs-buckets\n          image: gcr.io/xl-ml-test/pytorch-xla:r1.6\n          imagePullPolicy: Always\n          name: train\n          resources:\n            limits:\n              cloud-tpus.google.com/v2: 8\n            requests:\n              cpu: '4.5'\n              memory: 8Gi\n          volumeMounts:\n          - mountPath: /dev/shm\n            name: dshm\n            readOnly: false\n        initContainers:\n        - env:\n          - name: POD_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.name\n          - name: POD_UID\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.uid\n          - name: POD_NAMESPACE\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.namespace\n          - name: JOB_NAME\n            valueFrom:\n              fieldRef:\n                fieldPath: metadata.labels['job-name']\n          - name: MODEL_DIR\n            value: $(OUTPUT_BUCKET)/pt-1.6/python-ops/func/v2-8/$(JOB_NAME)\n          - name: METRIC_CONFIG\n            value: \"{\\n \\\"metric_collection_config\\\": {\\n  \\\"default_aggregation_strategies\\\"\\\n              : [\\n   \\\"final\\\"\\n  ],\\n  \\\"tags_to_ignore\\\": [\\n   \\\"LearningRate\\\"\\\n              \\n  ],\\n  \\\"write_to_bigquery\\\": true\\n },\\n \\\"regression_test_config\\\"\\\n              : null,\\n \\\"test_name\\\": \\\"pt-1.6-python-ops-func-v2-8\\\"\\n}\\n\"\n          envFrom:\n          - configMapRef:\n              name: gcs-buckets\n          image: gcr.io/xl-ml-test/publisher:stable\n          imagePullPolicy: Always\n          name: publisher\n        volumes:\n        - emptyDir:\n            medium: Memory\n          name: dshm\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"train\" has memory limit 0"
  },
  {
    "id": "02658",
    "manifest_path": "data/manifests/the_stack_sample/sample_1081.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: ReplicaSet\nmetadata:\n  name: skydive-test-replicaset\n  labels:\n    app: guestbook\n    tier: frontend\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      tier: frontend\n    matchExpressions:\n    - key: tier\n      operator: In\n      values:\n      - frontend\n  template:\n    metadata:\n      labels:\n        app: guestbook\n        tier: frontend\n    spec:\n      containers:\n      - name: skydive-test-replicaset-php-redis\n        image: gcr.io/google_samples/gb-frontend:v3\n        resources:\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        env:\n        - name: GET_HOSTS_FROM\n          value: dns\n        ports:\n        - containerPort: 80\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"skydive-test-replicaset-php-redis\" does not have a read-only root file system"
  },
  {
    "id": "02659",
    "manifest_path": "data/manifests/the_stack_sample/sample_1081.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: ReplicaSet\nmetadata:\n  name: skydive-test-replicaset\n  labels:\n    app: guestbook\n    tier: frontend\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      tier: frontend\n    matchExpressions:\n    - key: tier\n      operator: In\n      values:\n      - frontend\n  template:\n    metadata:\n      labels:\n        app: guestbook\n        tier: frontend\n    spec:\n      containers:\n      - name: skydive-test-replicaset-php-redis\n        image: gcr.io/google_samples/gb-frontend:v3\n        resources:\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        env:\n        - name: GET_HOSTS_FROM\n          value: dns\n        ports:\n        - containerPort: 80\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"skydive-test-replicaset-php-redis\" is not set to runAsNonRoot"
  },
  {
    "id": "02660",
    "manifest_path": "data/manifests/the_stack_sample/sample_1081.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: ReplicaSet\nmetadata:\n  name: skydive-test-replicaset\n  labels:\n    app: guestbook\n    tier: frontend\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      tier: frontend\n    matchExpressions:\n    - key: tier\n      operator: In\n      values:\n      - frontend\n  template:\n    metadata:\n      labels:\n        app: guestbook\n        tier: frontend\n    spec:\n      containers:\n      - name: skydive-test-replicaset-php-redis\n        image: gcr.io/google_samples/gb-frontend:v3\n        resources:\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        env:\n        - name: GET_HOSTS_FROM\n          value: dns\n        ports:\n        - containerPort: 80\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"skydive-test-replicaset-php-redis\" has memory limit 0"
  },
  {
    "id": "02661",
    "manifest_path": "data/manifests/the_stack_sample/sample_1082.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: echo-1\nspec:\n  selector:\n    matchLabels:\n      app: echo-1\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: echo-1\n    spec:\n      containers:\n      - name: echo-1\n        image: hashicorp/http-echo\n        args:\n        - -text=echo-1\n        ports:\n        - containerPort: 5678\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"echo-1\" is using an invalid container image, \"hashicorp/http-echo\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02662",
    "manifest_path": "data/manifests/the_stack_sample/sample_1082.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: echo-1\nspec:\n  selector:\n    matchLabels:\n      app: echo-1\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: echo-1\n    spec:\n      containers:\n      - name: echo-1\n        image: hashicorp/http-echo\n        args:\n        - -text=echo-1\n        ports:\n        - containerPort: 5678\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"echo-1\" does not have a read-only root file system"
  },
  {
    "id": "02663",
    "manifest_path": "data/manifests/the_stack_sample/sample_1082.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: echo-1\nspec:\n  selector:\n    matchLabels:\n      app: echo-1\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: echo-1\n    spec:\n      containers:\n      - name: echo-1\n        image: hashicorp/http-echo\n        args:\n        - -text=echo-1\n        ports:\n        - containerPort: 5678\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"echo-1\" is not set to runAsNonRoot"
  },
  {
    "id": "02664",
    "manifest_path": "data/manifests/the_stack_sample/sample_1082.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: echo-1\nspec:\n  selector:\n    matchLabels:\n      app: echo-1\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: echo-1\n    spec:\n      containers:\n      - name: echo-1\n        image: hashicorp/http-echo\n        args:\n        - -text=echo-1\n        ports:\n        - containerPort: 5678\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"echo-1\" has cpu request 0"
  },
  {
    "id": "02665",
    "manifest_path": "data/manifests/the_stack_sample/sample_1082.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: echo-1\nspec:\n  selector:\n    matchLabels:\n      app: echo-1\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: echo-1\n    spec:\n      containers:\n      - name: echo-1\n        image: hashicorp/http-echo\n        args:\n        - -text=echo-1\n        ports:\n        - containerPort: 5678\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"echo-1\" has memory limit 0"
  },
  {
    "id": "02666",
    "manifest_path": "data/manifests/the_stack_sample/sample_1086.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deployment\n  labels:\n    app: nginx\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - name: nginx\n        image: nginx:1.7.9\n        ports:\n        - containerPort: 80\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"nginx\" does not have a read-only root file system"
  },
  {
    "id": "02667",
    "manifest_path": "data/manifests/the_stack_sample/sample_1086.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deployment\n  labels:\n    app: nginx\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - name: nginx\n        image: nginx:1.7.9\n        ports:\n        - containerPort: 80\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"nginx\" is not set to runAsNonRoot"
  },
  {
    "id": "02668",
    "manifest_path": "data/manifests/the_stack_sample/sample_1086.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deployment\n  labels:\n    app: nginx\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - name: nginx\n        image: nginx:1.7.9\n        ports:\n        - containerPort: 80\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"nginx\" has cpu request 0"
  },
  {
    "id": "02669",
    "manifest_path": "data/manifests/the_stack_sample/sample_1086.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deployment\n  labels:\n    app: nginx\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - name: nginx\n        image: nginx:1.7.9\n        ports:\n        - containerPort: 80\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"nginx\" has memory limit 0"
  },
  {
    "id": "02670",
    "manifest_path": "data/manifests/the_stack_sample/sample_1088.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: ember-csi-operator\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: ember-csi-operator\n  template:\n    metadata:\n      labels:\n        name: ember-csi-operator\n    spec:\n      serviceAccountName: ember-csi-operator\n      containers:\n      - name: ember-csi-operator\n        image: docker.io/embercsi/ember-csi-operator:latest\n        ports:\n        - containerPort: 60000\n          name: metrics\n        command:\n        - ember-csi-operator\n        args:\n        - -v=3\n        imagePullPolicy: Always\n        readinessProbe:\n          exec:\n            command:\n            - stat\n            - /tmp/operator-sdk-ready\n          initialDelaySeconds: 4\n          periodSeconds: 10\n          failureThreshold: 1\n        env:\n        - name: X_EMBER_OPERATOR_CLUSTER\n          value: default\n        - name: WATCH_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: OPERATOR_NAME\n          value: ember-csi-operator\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"ember-csi-operator\" is using an invalid container image, \"docker.io/embercsi/ember-csi-operator:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02671",
    "manifest_path": "data/manifests/the_stack_sample/sample_1088.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: ember-csi-operator\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: ember-csi-operator\n  template:\n    metadata:\n      labels:\n        name: ember-csi-operator\n    spec:\n      serviceAccountName: ember-csi-operator\n      containers:\n      - name: ember-csi-operator\n        image: docker.io/embercsi/ember-csi-operator:latest\n        ports:\n        - containerPort: 60000\n          name: metrics\n        command:\n        - ember-csi-operator\n        args:\n        - -v=3\n        imagePullPolicy: Always\n        readinessProbe:\n          exec:\n            command:\n            - stat\n            - /tmp/operator-sdk-ready\n          initialDelaySeconds: 4\n          periodSeconds: 10\n          failureThreshold: 1\n        env:\n        - name: X_EMBER_OPERATOR_CLUSTER\n          value: default\n        - name: WATCH_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: OPERATOR_NAME\n          value: ember-csi-operator\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"ember-csi-operator\" does not have a read-only root file system"
  },
  {
    "id": "02672",
    "manifest_path": "data/manifests/the_stack_sample/sample_1088.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: ember-csi-operator\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: ember-csi-operator\n  template:\n    metadata:\n      labels:\n        name: ember-csi-operator\n    spec:\n      serviceAccountName: ember-csi-operator\n      containers:\n      - name: ember-csi-operator\n        image: docker.io/embercsi/ember-csi-operator:latest\n        ports:\n        - containerPort: 60000\n          name: metrics\n        command:\n        - ember-csi-operator\n        args:\n        - -v=3\n        imagePullPolicy: Always\n        readinessProbe:\n          exec:\n            command:\n            - stat\n            - /tmp/operator-sdk-ready\n          initialDelaySeconds: 4\n          periodSeconds: 10\n          failureThreshold: 1\n        env:\n        - name: X_EMBER_OPERATOR_CLUSTER\n          value: default\n        - name: WATCH_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: OPERATOR_NAME\n          value: ember-csi-operator\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"ember-csi-operator\" is not set to runAsNonRoot"
  },
  {
    "id": "02673",
    "manifest_path": "data/manifests/the_stack_sample/sample_1088.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: ember-csi-operator\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: ember-csi-operator\n  template:\n    metadata:\n      labels:\n        name: ember-csi-operator\n    spec:\n      serviceAccountName: ember-csi-operator\n      containers:\n      - name: ember-csi-operator\n        image: docker.io/embercsi/ember-csi-operator:latest\n        ports:\n        - containerPort: 60000\n          name: metrics\n        command:\n        - ember-csi-operator\n        args:\n        - -v=3\n        imagePullPolicy: Always\n        readinessProbe:\n          exec:\n            command:\n            - stat\n            - /tmp/operator-sdk-ready\n          initialDelaySeconds: 4\n          periodSeconds: 10\n          failureThreshold: 1\n        env:\n        - name: X_EMBER_OPERATOR_CLUSTER\n          value: default\n        - name: WATCH_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: OPERATOR_NAME\n          value: ember-csi-operator\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"ember-csi-operator\" has cpu request 0"
  },
  {
    "id": "02674",
    "manifest_path": "data/manifests/the_stack_sample/sample_1088.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: ember-csi-operator\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: ember-csi-operator\n  template:\n    metadata:\n      labels:\n        name: ember-csi-operator\n    spec:\n      serviceAccountName: ember-csi-operator\n      containers:\n      - name: ember-csi-operator\n        image: docker.io/embercsi/ember-csi-operator:latest\n        ports:\n        - containerPort: 60000\n          name: metrics\n        command:\n        - ember-csi-operator\n        args:\n        - -v=3\n        imagePullPolicy: Always\n        readinessProbe:\n          exec:\n            command:\n            - stat\n            - /tmp/operator-sdk-ready\n          initialDelaySeconds: 4\n          periodSeconds: 10\n          failureThreshold: 1\n        env:\n        - name: X_EMBER_OPERATOR_CLUSTER\n          value: default\n        - name: WATCH_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: OPERATOR_NAME\n          value: ember-csi-operator\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"ember-csi-operator\" has memory limit 0"
  },
  {
    "id": "02675",
    "manifest_path": "data/manifests/the_stack_sample/sample_1089.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: test-${storageClass}\nspec:\n  selector:\n    matchLabels:\n      app: test-${storageClass}\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: test-${storageClass}\n    spec:\n      containers:\n      - name: nginx\n        image: sreworks-registry.cn-beijing.cr.aliyuncs.com/mirror/alpine:latest\n        command:\n        - df\n        volumeMounts:\n        - name: test\n          mountPath: /test\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"nginx\" is using an invalid container image, \"sreworks-registry.cn-beijing.cr.aliyuncs.com/mirror/alpine:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02676",
    "manifest_path": "data/manifests/the_stack_sample/sample_1089.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: test-${storageClass}\nspec:\n  selector:\n    matchLabels:\n      app: test-${storageClass}\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: test-${storageClass}\n    spec:\n      containers:\n      - name: nginx\n        image: sreworks-registry.cn-beijing.cr.aliyuncs.com/mirror/alpine:latest\n        command:\n        - df\n        volumeMounts:\n        - name: test\n          mountPath: /test\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"nginx\" does not have a read-only root file system"
  },
  {
    "id": "02677",
    "manifest_path": "data/manifests/the_stack_sample/sample_1089.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: test-${storageClass}\nspec:\n  selector:\n    matchLabels:\n      app: test-${storageClass}\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: test-${storageClass}\n    spec:\n      containers:\n      - name: nginx\n        image: sreworks-registry.cn-beijing.cr.aliyuncs.com/mirror/alpine:latest\n        command:\n        - df\n        volumeMounts:\n        - name: test\n          mountPath: /test\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"nginx\" is not set to runAsNonRoot"
  },
  {
    "id": "02678",
    "manifest_path": "data/manifests/the_stack_sample/sample_1089.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: test-${storageClass}\nspec:\n  selector:\n    matchLabels:\n      app: test-${storageClass}\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: test-${storageClass}\n    spec:\n      containers:\n      - name: nginx\n        image: sreworks-registry.cn-beijing.cr.aliyuncs.com/mirror/alpine:latest\n        command:\n        - df\n        volumeMounts:\n        - name: test\n          mountPath: /test\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"nginx\" has cpu request 0"
  },
  {
    "id": "02679",
    "manifest_path": "data/manifests/the_stack_sample/sample_1089.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: test-${storageClass}\nspec:\n  selector:\n    matchLabels:\n      app: test-${storageClass}\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: test-${storageClass}\n    spec:\n      containers:\n      - name: nginx\n        image: sreworks-registry.cn-beijing.cr.aliyuncs.com/mirror/alpine:latest\n        command:\n        - df\n        volumeMounts:\n        - name: test\n          mountPath: /test\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"nginx\" has memory limit 0"
  },
  {
    "id": "02680",
    "manifest_path": "data/manifests/the_stack_sample/sample_1091.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: trousseau-hcvault\n  namespace: kube-system\n  labels:\n    tier: control-plane\n    app: trousseau-hcvault\nspec:\n  selector:\n    matchLabels:\n      name: trousseau-hcvault\n  template:\n    metadata:\n      labels:\n        name: trousseau-hcvault\n    spec:\n      containers:\n      - name: trousseau-hcvault\n        image: ghcr.io/ondat/trousseau:v1.1.0\n        imagePullPolicy: Always\n        env:\n        - name: VAULT_NAMESPACE\n          value: admin\n        - name: VAULT_SKIP_VERIFY\n          value: 'false'\n        args:\n        - -v=5\n        - --config-file-path=/opt/vault-kms/config.yaml\n        - --listen-addr=unix:///opt/vault-kms/vaultkms.socket\n        - --zap-encoder=json\n        - --v=3\n        securityContext:\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - ALL\n          readOnlyRootFilesystem: true\n          runAsUser: 0\n        ports:\n        - containerPort: 8787\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 8787\n          failureThreshold: 3\n          periodSeconds: 10\n        resources:\n          requests:\n            cpu: 50m\n            memory: 64Mi\n          limits:\n            cpu: 300m\n            memory: 256Mi\n        volumeMounts:\n        - name: vault-kms\n          mountPath: /opt/vault-kms\n      volumes:\n      - name: vault-kms\n        hostPath:\n          path: /opt/vault-kms\n      affinity:\n        nodeAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n            nodeSelectorTerms:\n            - matchExpressions:\n              - key: node-role.kubernetes.io/control-plane\n                operator: Exists\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"trousseau-hcvault\" is not set to runAsNonRoot"
  }
]