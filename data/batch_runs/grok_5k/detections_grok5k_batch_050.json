[
  {
    "id": "02001",
    "manifest_path": "data/manifests/the_stack_sample/sample_0739.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app.kubernetes.io/name: sample-app\n  name: sample-app\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: sample-app\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/name: sample-app\n    spec:\n      containers:\n      - image: quay.io/mpeters/sample-app:latest\n        imagePullPolicy: Always\n        name: sample-app\n        ports:\n        - containerPort: 8080\n        env:\n        - name: NODE_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.hostIP\n        - name: POD_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"sample-app\" is not set to runAsNonRoot"
  },
  {
    "id": "02002",
    "manifest_path": "data/manifests/the_stack_sample/sample_0739.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app.kubernetes.io/name: sample-app\n  name: sample-app\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: sample-app\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/name: sample-app\n    spec:\n      containers:\n      - image: quay.io/mpeters/sample-app:latest\n        imagePullPolicy: Always\n        name: sample-app\n        ports:\n        - containerPort: 8080\n        env:\n        - name: NODE_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.hostIP\n        - name: POD_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"sample-app\" has cpu request 0"
  },
  {
    "id": "02003",
    "manifest_path": "data/manifests/the_stack_sample/sample_0739.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app.kubernetes.io/name: sample-app\n  name: sample-app\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: sample-app\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/name: sample-app\n    spec:\n      containers:\n      - image: quay.io/mpeters/sample-app:latest\n        imagePullPolicy: Always\n        name: sample-app\n        ports:\n        - containerPort: 8080\n        env:\n        - name: NODE_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.hostIP\n        - name: POD_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"sample-app\" has memory limit 0"
  },
  {
    "id": "02004",
    "manifest_path": "data/manifests/the_stack_sample/sample_0740.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  labels:\n    app.kubernetes.io/component: adaptor\n  name: adaptor\n  namespace: system\nspec:\n  selector:\n    matchLabels:\n      app.kubernetes.io/component: adaptor\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/component: adaptor\n    spec:\n      containers:\n      - name: octopus\n        image: cnrancher/octopus-adaptor-modbus:master\n        volumeMounts:\n        - mountPath: /var/lib/octopus/adaptors/\n          name: sockets\n        - mountPath: /dev\n          name: dev\n        securityContext:\n          privileged: true\n      volumes:\n      - name: sockets\n        hostPath:\n          path: /var/lib/octopus/adaptors/\n          type: DirectoryOrCreate\n      - name: dev\n        hostPath:\n          path: /dev\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"octopus\" does not have a read-only root file system"
  },
  {
    "id": "02005",
    "manifest_path": "data/manifests/the_stack_sample/sample_0740.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  labels:\n    app.kubernetes.io/component: adaptor\n  name: adaptor\n  namespace: system\nspec:\n  selector:\n    matchLabels:\n      app.kubernetes.io/component: adaptor\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/component: adaptor\n    spec:\n      containers:\n      - name: octopus\n        image: cnrancher/octopus-adaptor-modbus:master\n        volumeMounts:\n        - mountPath: /var/lib/octopus/adaptors/\n          name: sockets\n        - mountPath: /dev\n          name: dev\n        securityContext:\n          privileged: true\n      volumes:\n      - name: sockets\n        hostPath:\n          path: /var/lib/octopus/adaptors/\n          type: DirectoryOrCreate\n      - name: dev\n        hostPath:\n          path: /dev\n",
    "policy_id": "privilege-escalation-container",
    "violation_text": "container \"octopus\" is Privileged hence allows privilege escalation."
  },
  {
    "id": "02006",
    "manifest_path": "data/manifests/the_stack_sample/sample_0740.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  labels:\n    app.kubernetes.io/component: adaptor\n  name: adaptor\n  namespace: system\nspec:\n  selector:\n    matchLabels:\n      app.kubernetes.io/component: adaptor\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/component: adaptor\n    spec:\n      containers:\n      - name: octopus\n        image: cnrancher/octopus-adaptor-modbus:master\n        volumeMounts:\n        - mountPath: /var/lib/octopus/adaptors/\n          name: sockets\n        - mountPath: /dev\n          name: dev\n        securityContext:\n          privileged: true\n      volumes:\n      - name: sockets\n        hostPath:\n          path: /var/lib/octopus/adaptors/\n          type: DirectoryOrCreate\n      - name: dev\n        hostPath:\n          path: /dev\n",
    "policy_id": "privileged-container",
    "violation_text": "container \"octopus\" is privileged"
  },
  {
    "id": "02007",
    "manifest_path": "data/manifests/the_stack_sample/sample_0740.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  labels:\n    app.kubernetes.io/component: adaptor\n  name: adaptor\n  namespace: system\nspec:\n  selector:\n    matchLabels:\n      app.kubernetes.io/component: adaptor\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/component: adaptor\n    spec:\n      containers:\n      - name: octopus\n        image: cnrancher/octopus-adaptor-modbus:master\n        volumeMounts:\n        - mountPath: /var/lib/octopus/adaptors/\n          name: sockets\n        - mountPath: /dev\n          name: dev\n        securityContext:\n          privileged: true\n      volumes:\n      - name: sockets\n        hostPath:\n          path: /var/lib/octopus/adaptors/\n          type: DirectoryOrCreate\n      - name: dev\n        hostPath:\n          path: /dev\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"octopus\" is not set to runAsNonRoot"
  },
  {
    "id": "02008",
    "manifest_path": "data/manifests/the_stack_sample/sample_0740.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  labels:\n    app.kubernetes.io/component: adaptor\n  name: adaptor\n  namespace: system\nspec:\n  selector:\n    matchLabels:\n      app.kubernetes.io/component: adaptor\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/component: adaptor\n    spec:\n      containers:\n      - name: octopus\n        image: cnrancher/octopus-adaptor-modbus:master\n        volumeMounts:\n        - mountPath: /var/lib/octopus/adaptors/\n          name: sockets\n        - mountPath: /dev\n          name: dev\n        securityContext:\n          privileged: true\n      volumes:\n      - name: sockets\n        hostPath:\n          path: /var/lib/octopus/adaptors/\n          type: DirectoryOrCreate\n      - name: dev\n        hostPath:\n          path: /dev\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"octopus\" has cpu request 0"
  },
  {
    "id": "02009",
    "manifest_path": "data/manifests/the_stack_sample/sample_0740.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  labels:\n    app.kubernetes.io/component: adaptor\n  name: adaptor\n  namespace: system\nspec:\n  selector:\n    matchLabels:\n      app.kubernetes.io/component: adaptor\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/component: adaptor\n    spec:\n      containers:\n      - name: octopus\n        image: cnrancher/octopus-adaptor-modbus:master\n        volumeMounts:\n        - mountPath: /var/lib/octopus/adaptors/\n          name: sockets\n        - mountPath: /dev\n          name: dev\n        securityContext:\n          privileged: true\n      volumes:\n      - name: sockets\n        hostPath:\n          path: /var/lib/octopus/adaptors/\n          type: DirectoryOrCreate\n      - name: dev\n        hostPath:\n          path: /dev\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"octopus\" has memory limit 0"
  },
  {
    "id": "02010",
    "manifest_path": "data/manifests/the_stack_sample/sample_0742.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: cron-composites-lib-unb-ca\n  namespace: dev\n  labels:\n    app: drupal\n    tier: cron\nspec:\n  jobTemplate:\n    template:\n      spec:\n        containers:\n        - name: cron-composites-lib-unb-ca\n          command:\n          - /scripts/drupalCronEntry.sh\n          env:\n          - name: DEPLOY_ENV\n            value: dev\n          - name: MYSQL_HOSTNAME\n            value: drupal-mysql-lib-unb-ca\n          - name: MYSQL_PORT\n            value: '3306'\n          image: '||DEPLOYMENTIMAGE||'\n          imagePullPolicy: Always\n          volumeMounts:\n          - mountPath: /app/html/sites/default\n            name: drupal-persistent-storage\n        volumes:\n        - name: drupal-persistent-storage\n          persistentVolumeClaim:\n            claimName: composites-lib-unb-ca\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"cron-composites-lib-unb-ca\" is using an invalid container image, \"||DEPLOYMENTIMAGE||\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02011",
    "manifest_path": "data/manifests/the_stack_sample/sample_0742.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: cron-composites-lib-unb-ca\n  namespace: dev\n  labels:\n    app: drupal\n    tier: cron\nspec:\n  jobTemplate:\n    template:\n      spec:\n        containers:\n        - name: cron-composites-lib-unb-ca\n          command:\n          - /scripts/drupalCronEntry.sh\n          env:\n          - name: DEPLOY_ENV\n            value: dev\n          - name: MYSQL_HOSTNAME\n            value: drupal-mysql-lib-unb-ca\n          - name: MYSQL_PORT\n            value: '3306'\n          image: '||DEPLOYMENTIMAGE||'\n          imagePullPolicy: Always\n          volumeMounts:\n          - mountPath: /app/html/sites/default\n            name: drupal-persistent-storage\n        volumes:\n        - name: drupal-persistent-storage\n          persistentVolumeClaim:\n            claimName: composites-lib-unb-ca\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"cron-composites-lib-unb-ca\" does not have a read-only root file system"
  },
  {
    "id": "02012",
    "manifest_path": "data/manifests/the_stack_sample/sample_0742.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: cron-composites-lib-unb-ca\n  namespace: dev\n  labels:\n    app: drupal\n    tier: cron\nspec:\n  jobTemplate:\n    template:\n      spec:\n        containers:\n        - name: cron-composites-lib-unb-ca\n          command:\n          - /scripts/drupalCronEntry.sh\n          env:\n          - name: DEPLOY_ENV\n            value: dev\n          - name: MYSQL_HOSTNAME\n            value: drupal-mysql-lib-unb-ca\n          - name: MYSQL_PORT\n            value: '3306'\n          image: '||DEPLOYMENTIMAGE||'\n          imagePullPolicy: Always\n          volumeMounts:\n          - mountPath: /app/html/sites/default\n            name: drupal-persistent-storage\n        volumes:\n        - name: drupal-persistent-storage\n          persistentVolumeClaim:\n            claimName: composites-lib-unb-ca\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"cron-composites-lib-unb-ca\" is not set to runAsNonRoot"
  },
  {
    "id": "02013",
    "manifest_path": "data/manifests/the_stack_sample/sample_0742.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: cron-composites-lib-unb-ca\n  namespace: dev\n  labels:\n    app: drupal\n    tier: cron\nspec:\n  jobTemplate:\n    template:\n      spec:\n        containers:\n        - name: cron-composites-lib-unb-ca\n          command:\n          - /scripts/drupalCronEntry.sh\n          env:\n          - name: DEPLOY_ENV\n            value: dev\n          - name: MYSQL_HOSTNAME\n            value: drupal-mysql-lib-unb-ca\n          - name: MYSQL_PORT\n            value: '3306'\n          image: '||DEPLOYMENTIMAGE||'\n          imagePullPolicy: Always\n          volumeMounts:\n          - mountPath: /app/html/sites/default\n            name: drupal-persistent-storage\n        volumes:\n        - name: drupal-persistent-storage\n          persistentVolumeClaim:\n            claimName: composites-lib-unb-ca\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"cron-composites-lib-unb-ca\" has cpu request 0"
  },
  {
    "id": "02014",
    "manifest_path": "data/manifests/the_stack_sample/sample_0742.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: cron-composites-lib-unb-ca\n  namespace: dev\n  labels:\n    app: drupal\n    tier: cron\nspec:\n  jobTemplate:\n    template:\n      spec:\n        containers:\n        - name: cron-composites-lib-unb-ca\n          command:\n          - /scripts/drupalCronEntry.sh\n          env:\n          - name: DEPLOY_ENV\n            value: dev\n          - name: MYSQL_HOSTNAME\n            value: drupal-mysql-lib-unb-ca\n          - name: MYSQL_PORT\n            value: '3306'\n          image: '||DEPLOYMENTIMAGE||'\n          imagePullPolicy: Always\n          volumeMounts:\n          - mountPath: /app/html/sites/default\n            name: drupal-persistent-storage\n        volumes:\n        - name: drupal-persistent-storage\n          persistentVolumeClaim:\n            claimName: composites-lib-unb-ca\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"cron-composites-lib-unb-ca\" has memory limit 0"
  },
  {
    "id": "02015",
    "manifest_path": "data/manifests/the_stack_sample/sample_0747.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: graphql-server-deployment\n  namespace: hm\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      component: graphql-server\n  template:\n    metadata:\n      labels:\n        component: graphql-server\n    spec:\n      containers:\n      - name: graphql-server\n        image: hongbomiao/hm-graphql-server:latest\n        env:\n        - name: APP_ENV\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: app_env\n        - name: PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: port\n        - name: GRPC_SERVER_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: grpc_server_host\n        - name: GRPC_SERVER_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: grpc_server_port\n        - name: OPA_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opa_host\n        - name: OPA_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opa_port\n        - name: DGRAPH_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: dgraph_host\n        - name: DGRAPH_GRPC_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: dgraph_grpc_port\n        - name: REDIS_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_host\n        - name: REDIS_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_port\n        - name: REDIS_DB\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_db\n        - name: MINIO_ENDPOINT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_endpoint\n        - name: MINIO_ACCESS_KEY_ID\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_access_key_id\n        - name: MINIO_SECRET_ACCESS_KEY\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_secret_access_key\n        - name: TORCH_SERVE_GRPC_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: torch_serve_grpc_host\n        - name: TORCH_SERVE_GRPC_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: torch_serve_grpc_port\n        - name: OPEN_CENSUS_AGENT_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: open_census_agent_host\n        - name: OPEN_CENSUS_AGENT_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: open_census_agent_port\n        - name: JAEGER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: jaeger_url\n        - name: JWT_SECRET\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: jwt_secret\n        - name: ELASTIC_APM_SERVICE_NAME\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: elastic_apm_service_name\n        - name: ELASTIC_APM_SERVER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_server_url\n        - name: ELASTIC_APM_ENVIRONMENT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_environment\n        - name: ELASTIC_APM_SECRET_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: hm-elastic-apm\n              key: token\n        - name: ELASTIC_APM_VERIFY_SERVER_CERT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_verify_server_cert\n        - name: ELASTIC_APM_SERVER_CERT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_server_cert\n        - name: ELASTIC_APM_LOG_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_log_level\n        - name: ELASTIC_APM_LOG_FILE\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_log_file\n        ports:\n        - name: graphql-server\n          protocol: TCP\n          containerPort: 31800\n        volumeMounts:\n        - mountPath: /data/elastic-apm\n          name: elastic-apm-volume\n      - name: opal-client\n        image: hongbomiao/hm-opal-client:latest\n        env:\n        - name: OPAL_CLIENT_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: hm-opal-client-secret\n              key: opal_client_token\n        - name: OPAL_SERVER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_server_url\n        - name: OPAL_FETCH_PROVIDER_MODULES\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_fetch_provider_modules\n        - name: OPAL_INLINE_OPA_CONFIG\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_inline_opa_config\n        - name: OPAL_INLINE_OPA_LOG_FORMAT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_inline_opa_log_format\n        - name: OPAL_LOG_MODULE_EXCLUDE_LIST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_log_module_exclude_list\n        - name: OPAL_LOG_COLORIZE\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_log_colorize\n        ports:\n        - name: opal-client\n          protocol: TCP\n          containerPort: 7000\n        - name: opa\n          protocol: TCP\n          containerPort: 8181\n        volumeMounts:\n        - mountPath: /data/opa\n          name: opa-volume\n      volumes:\n      - name: elastic-apm-volume\n        persistentVolumeClaim:\n          claimName: elastic-apm-pvc\n      - name: opa-volume\n        persistentVolumeClaim:\n          claimName: opa-pvc\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"graphql-server\" is using an invalid container image, \"hongbomiao/hm-graphql-server:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02016",
    "manifest_path": "data/manifests/the_stack_sample/sample_0747.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: graphql-server-deployment\n  namespace: hm\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      component: graphql-server\n  template:\n    metadata:\n      labels:\n        component: graphql-server\n    spec:\n      containers:\n      - name: graphql-server\n        image: hongbomiao/hm-graphql-server:latest\n        env:\n        - name: APP_ENV\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: app_env\n        - name: PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: port\n        - name: GRPC_SERVER_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: grpc_server_host\n        - name: GRPC_SERVER_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: grpc_server_port\n        - name: OPA_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opa_host\n        - name: OPA_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opa_port\n        - name: DGRAPH_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: dgraph_host\n        - name: DGRAPH_GRPC_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: dgraph_grpc_port\n        - name: REDIS_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_host\n        - name: REDIS_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_port\n        - name: REDIS_DB\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_db\n        - name: MINIO_ENDPOINT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_endpoint\n        - name: MINIO_ACCESS_KEY_ID\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_access_key_id\n        - name: MINIO_SECRET_ACCESS_KEY\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_secret_access_key\n        - name: TORCH_SERVE_GRPC_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: torch_serve_grpc_host\n        - name: TORCH_SERVE_GRPC_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: torch_serve_grpc_port\n        - name: OPEN_CENSUS_AGENT_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: open_census_agent_host\n        - name: OPEN_CENSUS_AGENT_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: open_census_agent_port\n        - name: JAEGER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: jaeger_url\n        - name: JWT_SECRET\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: jwt_secret\n        - name: ELASTIC_APM_SERVICE_NAME\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: elastic_apm_service_name\n        - name: ELASTIC_APM_SERVER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_server_url\n        - name: ELASTIC_APM_ENVIRONMENT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_environment\n        - name: ELASTIC_APM_SECRET_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: hm-elastic-apm\n              key: token\n        - name: ELASTIC_APM_VERIFY_SERVER_CERT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_verify_server_cert\n        - name: ELASTIC_APM_SERVER_CERT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_server_cert\n        - name: ELASTIC_APM_LOG_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_log_level\n        - name: ELASTIC_APM_LOG_FILE\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_log_file\n        ports:\n        - name: graphql-server\n          protocol: TCP\n          containerPort: 31800\n        volumeMounts:\n        - mountPath: /data/elastic-apm\n          name: elastic-apm-volume\n      - name: opal-client\n        image: hongbomiao/hm-opal-client:latest\n        env:\n        - name: OPAL_CLIENT_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: hm-opal-client-secret\n              key: opal_client_token\n        - name: OPAL_SERVER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_server_url\n        - name: OPAL_FETCH_PROVIDER_MODULES\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_fetch_provider_modules\n        - name: OPAL_INLINE_OPA_CONFIG\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_inline_opa_config\n        - name: OPAL_INLINE_OPA_LOG_FORMAT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_inline_opa_log_format\n        - name: OPAL_LOG_MODULE_EXCLUDE_LIST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_log_module_exclude_list\n        - name: OPAL_LOG_COLORIZE\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_log_colorize\n        ports:\n        - name: opal-client\n          protocol: TCP\n          containerPort: 7000\n        - name: opa\n          protocol: TCP\n          containerPort: 8181\n        volumeMounts:\n        - mountPath: /data/opa\n          name: opa-volume\n      volumes:\n      - name: elastic-apm-volume\n        persistentVolumeClaim:\n          claimName: elastic-apm-pvc\n      - name: opa-volume\n        persistentVolumeClaim:\n          claimName: opa-pvc\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"opal-client\" is using an invalid container image, \"hongbomiao/hm-opal-client:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02017",
    "manifest_path": "data/manifests/the_stack_sample/sample_0747.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: graphql-server-deployment\n  namespace: hm\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      component: graphql-server\n  template:\n    metadata:\n      labels:\n        component: graphql-server\n    spec:\n      containers:\n      - name: graphql-server\n        image: hongbomiao/hm-graphql-server:latest\n        env:\n        - name: APP_ENV\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: app_env\n        - name: PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: port\n        - name: GRPC_SERVER_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: grpc_server_host\n        - name: GRPC_SERVER_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: grpc_server_port\n        - name: OPA_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opa_host\n        - name: OPA_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opa_port\n        - name: DGRAPH_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: dgraph_host\n        - name: DGRAPH_GRPC_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: dgraph_grpc_port\n        - name: REDIS_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_host\n        - name: REDIS_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_port\n        - name: REDIS_DB\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_db\n        - name: MINIO_ENDPOINT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_endpoint\n        - name: MINIO_ACCESS_KEY_ID\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_access_key_id\n        - name: MINIO_SECRET_ACCESS_KEY\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_secret_access_key\n        - name: TORCH_SERVE_GRPC_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: torch_serve_grpc_host\n        - name: TORCH_SERVE_GRPC_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: torch_serve_grpc_port\n        - name: OPEN_CENSUS_AGENT_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: open_census_agent_host\n        - name: OPEN_CENSUS_AGENT_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: open_census_agent_port\n        - name: JAEGER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: jaeger_url\n        - name: JWT_SECRET\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: jwt_secret\n        - name: ELASTIC_APM_SERVICE_NAME\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: elastic_apm_service_name\n        - name: ELASTIC_APM_SERVER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_server_url\n        - name: ELASTIC_APM_ENVIRONMENT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_environment\n        - name: ELASTIC_APM_SECRET_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: hm-elastic-apm\n              key: token\n        - name: ELASTIC_APM_VERIFY_SERVER_CERT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_verify_server_cert\n        - name: ELASTIC_APM_SERVER_CERT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_server_cert\n        - name: ELASTIC_APM_LOG_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_log_level\n        - name: ELASTIC_APM_LOG_FILE\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_log_file\n        ports:\n        - name: graphql-server\n          protocol: TCP\n          containerPort: 31800\n        volumeMounts:\n        - mountPath: /data/elastic-apm\n          name: elastic-apm-volume\n      - name: opal-client\n        image: hongbomiao/hm-opal-client:latest\n        env:\n        - name: OPAL_CLIENT_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: hm-opal-client-secret\n              key: opal_client_token\n        - name: OPAL_SERVER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_server_url\n        - name: OPAL_FETCH_PROVIDER_MODULES\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_fetch_provider_modules\n        - name: OPAL_INLINE_OPA_CONFIG\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_inline_opa_config\n        - name: OPAL_INLINE_OPA_LOG_FORMAT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_inline_opa_log_format\n        - name: OPAL_LOG_MODULE_EXCLUDE_LIST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_log_module_exclude_list\n        - name: OPAL_LOG_COLORIZE\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_log_colorize\n        ports:\n        - name: opal-client\n          protocol: TCP\n          containerPort: 7000\n        - name: opa\n          protocol: TCP\n          containerPort: 8181\n        volumeMounts:\n        - mountPath: /data/opa\n          name: opa-volume\n      volumes:\n      - name: elastic-apm-volume\n        persistentVolumeClaim:\n          claimName: elastic-apm-pvc\n      - name: opa-volume\n        persistentVolumeClaim:\n          claimName: opa-pvc\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"graphql-server\" does not have a read-only root file system"
  },
  {
    "id": "02018",
    "manifest_path": "data/manifests/the_stack_sample/sample_0747.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: graphql-server-deployment\n  namespace: hm\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      component: graphql-server\n  template:\n    metadata:\n      labels:\n        component: graphql-server\n    spec:\n      containers:\n      - name: graphql-server\n        image: hongbomiao/hm-graphql-server:latest\n        env:\n        - name: APP_ENV\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: app_env\n        - name: PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: port\n        - name: GRPC_SERVER_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: grpc_server_host\n        - name: GRPC_SERVER_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: grpc_server_port\n        - name: OPA_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opa_host\n        - name: OPA_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opa_port\n        - name: DGRAPH_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: dgraph_host\n        - name: DGRAPH_GRPC_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: dgraph_grpc_port\n        - name: REDIS_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_host\n        - name: REDIS_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_port\n        - name: REDIS_DB\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_db\n        - name: MINIO_ENDPOINT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_endpoint\n        - name: MINIO_ACCESS_KEY_ID\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_access_key_id\n        - name: MINIO_SECRET_ACCESS_KEY\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_secret_access_key\n        - name: TORCH_SERVE_GRPC_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: torch_serve_grpc_host\n        - name: TORCH_SERVE_GRPC_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: torch_serve_grpc_port\n        - name: OPEN_CENSUS_AGENT_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: open_census_agent_host\n        - name: OPEN_CENSUS_AGENT_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: open_census_agent_port\n        - name: JAEGER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: jaeger_url\n        - name: JWT_SECRET\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: jwt_secret\n        - name: ELASTIC_APM_SERVICE_NAME\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: elastic_apm_service_name\n        - name: ELASTIC_APM_SERVER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_server_url\n        - name: ELASTIC_APM_ENVIRONMENT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_environment\n        - name: ELASTIC_APM_SECRET_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: hm-elastic-apm\n              key: token\n        - name: ELASTIC_APM_VERIFY_SERVER_CERT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_verify_server_cert\n        - name: ELASTIC_APM_SERVER_CERT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_server_cert\n        - name: ELASTIC_APM_LOG_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_log_level\n        - name: ELASTIC_APM_LOG_FILE\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_log_file\n        ports:\n        - name: graphql-server\n          protocol: TCP\n          containerPort: 31800\n        volumeMounts:\n        - mountPath: /data/elastic-apm\n          name: elastic-apm-volume\n      - name: opal-client\n        image: hongbomiao/hm-opal-client:latest\n        env:\n        - name: OPAL_CLIENT_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: hm-opal-client-secret\n              key: opal_client_token\n        - name: OPAL_SERVER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_server_url\n        - name: OPAL_FETCH_PROVIDER_MODULES\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_fetch_provider_modules\n        - name: OPAL_INLINE_OPA_CONFIG\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_inline_opa_config\n        - name: OPAL_INLINE_OPA_LOG_FORMAT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_inline_opa_log_format\n        - name: OPAL_LOG_MODULE_EXCLUDE_LIST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_log_module_exclude_list\n        - name: OPAL_LOG_COLORIZE\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_log_colorize\n        ports:\n        - name: opal-client\n          protocol: TCP\n          containerPort: 7000\n        - name: opa\n          protocol: TCP\n          containerPort: 8181\n        volumeMounts:\n        - mountPath: /data/opa\n          name: opa-volume\n      volumes:\n      - name: elastic-apm-volume\n        persistentVolumeClaim:\n          claimName: elastic-apm-pvc\n      - name: opa-volume\n        persistentVolumeClaim:\n          claimName: opa-pvc\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"opal-client\" does not have a read-only root file system"
  },
  {
    "id": "02019",
    "manifest_path": "data/manifests/the_stack_sample/sample_0747.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: graphql-server-deployment\n  namespace: hm\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      component: graphql-server\n  template:\n    metadata:\n      labels:\n        component: graphql-server\n    spec:\n      containers:\n      - name: graphql-server\n        image: hongbomiao/hm-graphql-server:latest\n        env:\n        - name: APP_ENV\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: app_env\n        - name: PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: port\n        - name: GRPC_SERVER_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: grpc_server_host\n        - name: GRPC_SERVER_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: grpc_server_port\n        - name: OPA_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opa_host\n        - name: OPA_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opa_port\n        - name: DGRAPH_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: dgraph_host\n        - name: DGRAPH_GRPC_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: dgraph_grpc_port\n        - name: REDIS_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_host\n        - name: REDIS_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_port\n        - name: REDIS_DB\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_db\n        - name: MINIO_ENDPOINT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_endpoint\n        - name: MINIO_ACCESS_KEY_ID\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_access_key_id\n        - name: MINIO_SECRET_ACCESS_KEY\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_secret_access_key\n        - name: TORCH_SERVE_GRPC_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: torch_serve_grpc_host\n        - name: TORCH_SERVE_GRPC_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: torch_serve_grpc_port\n        - name: OPEN_CENSUS_AGENT_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: open_census_agent_host\n        - name: OPEN_CENSUS_AGENT_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: open_census_agent_port\n        - name: JAEGER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: jaeger_url\n        - name: JWT_SECRET\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: jwt_secret\n        - name: ELASTIC_APM_SERVICE_NAME\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: elastic_apm_service_name\n        - name: ELASTIC_APM_SERVER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_server_url\n        - name: ELASTIC_APM_ENVIRONMENT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_environment\n        - name: ELASTIC_APM_SECRET_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: hm-elastic-apm\n              key: token\n        - name: ELASTIC_APM_VERIFY_SERVER_CERT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_verify_server_cert\n        - name: ELASTIC_APM_SERVER_CERT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_server_cert\n        - name: ELASTIC_APM_LOG_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_log_level\n        - name: ELASTIC_APM_LOG_FILE\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_log_file\n        ports:\n        - name: graphql-server\n          protocol: TCP\n          containerPort: 31800\n        volumeMounts:\n        - mountPath: /data/elastic-apm\n          name: elastic-apm-volume\n      - name: opal-client\n        image: hongbomiao/hm-opal-client:latest\n        env:\n        - name: OPAL_CLIENT_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: hm-opal-client-secret\n              key: opal_client_token\n        - name: OPAL_SERVER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_server_url\n        - name: OPAL_FETCH_PROVIDER_MODULES\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_fetch_provider_modules\n        - name: OPAL_INLINE_OPA_CONFIG\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_inline_opa_config\n        - name: OPAL_INLINE_OPA_LOG_FORMAT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_inline_opa_log_format\n        - name: OPAL_LOG_MODULE_EXCLUDE_LIST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_log_module_exclude_list\n        - name: OPAL_LOG_COLORIZE\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_log_colorize\n        ports:\n        - name: opal-client\n          protocol: TCP\n          containerPort: 7000\n        - name: opa\n          protocol: TCP\n          containerPort: 8181\n        volumeMounts:\n        - mountPath: /data/opa\n          name: opa-volume\n      volumes:\n      - name: elastic-apm-volume\n        persistentVolumeClaim:\n          claimName: elastic-apm-pvc\n      - name: opa-volume\n        persistentVolumeClaim:\n          claimName: opa-pvc\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"graphql-server\" is not set to runAsNonRoot"
  },
  {
    "id": "02020",
    "manifest_path": "data/manifests/the_stack_sample/sample_0747.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: graphql-server-deployment\n  namespace: hm\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      component: graphql-server\n  template:\n    metadata:\n      labels:\n        component: graphql-server\n    spec:\n      containers:\n      - name: graphql-server\n        image: hongbomiao/hm-graphql-server:latest\n        env:\n        - name: APP_ENV\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: app_env\n        - name: PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: port\n        - name: GRPC_SERVER_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: grpc_server_host\n        - name: GRPC_SERVER_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: grpc_server_port\n        - name: OPA_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opa_host\n        - name: OPA_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opa_port\n        - name: DGRAPH_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: dgraph_host\n        - name: DGRAPH_GRPC_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: dgraph_grpc_port\n        - name: REDIS_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_host\n        - name: REDIS_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_port\n        - name: REDIS_DB\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_db\n        - name: MINIO_ENDPOINT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_endpoint\n        - name: MINIO_ACCESS_KEY_ID\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_access_key_id\n        - name: MINIO_SECRET_ACCESS_KEY\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_secret_access_key\n        - name: TORCH_SERVE_GRPC_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: torch_serve_grpc_host\n        - name: TORCH_SERVE_GRPC_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: torch_serve_grpc_port\n        - name: OPEN_CENSUS_AGENT_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: open_census_agent_host\n        - name: OPEN_CENSUS_AGENT_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: open_census_agent_port\n        - name: JAEGER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: jaeger_url\n        - name: JWT_SECRET\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: jwt_secret\n        - name: ELASTIC_APM_SERVICE_NAME\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: elastic_apm_service_name\n        - name: ELASTIC_APM_SERVER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_server_url\n        - name: ELASTIC_APM_ENVIRONMENT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_environment\n        - name: ELASTIC_APM_SECRET_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: hm-elastic-apm\n              key: token\n        - name: ELASTIC_APM_VERIFY_SERVER_CERT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_verify_server_cert\n        - name: ELASTIC_APM_SERVER_CERT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_server_cert\n        - name: ELASTIC_APM_LOG_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_log_level\n        - name: ELASTIC_APM_LOG_FILE\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_log_file\n        ports:\n        - name: graphql-server\n          protocol: TCP\n          containerPort: 31800\n        volumeMounts:\n        - mountPath: /data/elastic-apm\n          name: elastic-apm-volume\n      - name: opal-client\n        image: hongbomiao/hm-opal-client:latest\n        env:\n        - name: OPAL_CLIENT_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: hm-opal-client-secret\n              key: opal_client_token\n        - name: OPAL_SERVER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_server_url\n        - name: OPAL_FETCH_PROVIDER_MODULES\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_fetch_provider_modules\n        - name: OPAL_INLINE_OPA_CONFIG\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_inline_opa_config\n        - name: OPAL_INLINE_OPA_LOG_FORMAT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_inline_opa_log_format\n        - name: OPAL_LOG_MODULE_EXCLUDE_LIST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_log_module_exclude_list\n        - name: OPAL_LOG_COLORIZE\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_log_colorize\n        ports:\n        - name: opal-client\n          protocol: TCP\n          containerPort: 7000\n        - name: opa\n          protocol: TCP\n          containerPort: 8181\n        volumeMounts:\n        - mountPath: /data/opa\n          name: opa-volume\n      volumes:\n      - name: elastic-apm-volume\n        persistentVolumeClaim:\n          claimName: elastic-apm-pvc\n      - name: opa-volume\n        persistentVolumeClaim:\n          claimName: opa-pvc\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"opal-client\" is not set to runAsNonRoot"
  },
  {
    "id": "02021",
    "manifest_path": "data/manifests/the_stack_sample/sample_0747.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: graphql-server-deployment\n  namespace: hm\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      component: graphql-server\n  template:\n    metadata:\n      labels:\n        component: graphql-server\n    spec:\n      containers:\n      - name: graphql-server\n        image: hongbomiao/hm-graphql-server:latest\n        env:\n        - name: APP_ENV\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: app_env\n        - name: PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: port\n        - name: GRPC_SERVER_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: grpc_server_host\n        - name: GRPC_SERVER_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: grpc_server_port\n        - name: OPA_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opa_host\n        - name: OPA_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opa_port\n        - name: DGRAPH_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: dgraph_host\n        - name: DGRAPH_GRPC_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: dgraph_grpc_port\n        - name: REDIS_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_host\n        - name: REDIS_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_port\n        - name: REDIS_DB\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_db\n        - name: MINIO_ENDPOINT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_endpoint\n        - name: MINIO_ACCESS_KEY_ID\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_access_key_id\n        - name: MINIO_SECRET_ACCESS_KEY\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_secret_access_key\n        - name: TORCH_SERVE_GRPC_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: torch_serve_grpc_host\n        - name: TORCH_SERVE_GRPC_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: torch_serve_grpc_port\n        - name: OPEN_CENSUS_AGENT_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: open_census_agent_host\n        - name: OPEN_CENSUS_AGENT_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: open_census_agent_port\n        - name: JAEGER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: jaeger_url\n        - name: JWT_SECRET\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: jwt_secret\n        - name: ELASTIC_APM_SERVICE_NAME\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: elastic_apm_service_name\n        - name: ELASTIC_APM_SERVER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_server_url\n        - name: ELASTIC_APM_ENVIRONMENT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_environment\n        - name: ELASTIC_APM_SECRET_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: hm-elastic-apm\n              key: token\n        - name: ELASTIC_APM_VERIFY_SERVER_CERT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_verify_server_cert\n        - name: ELASTIC_APM_SERVER_CERT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_server_cert\n        - name: ELASTIC_APM_LOG_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_log_level\n        - name: ELASTIC_APM_LOG_FILE\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_log_file\n        ports:\n        - name: graphql-server\n          protocol: TCP\n          containerPort: 31800\n        volumeMounts:\n        - mountPath: /data/elastic-apm\n          name: elastic-apm-volume\n      - name: opal-client\n        image: hongbomiao/hm-opal-client:latest\n        env:\n        - name: OPAL_CLIENT_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: hm-opal-client-secret\n              key: opal_client_token\n        - name: OPAL_SERVER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_server_url\n        - name: OPAL_FETCH_PROVIDER_MODULES\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_fetch_provider_modules\n        - name: OPAL_INLINE_OPA_CONFIG\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_inline_opa_config\n        - name: OPAL_INLINE_OPA_LOG_FORMAT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_inline_opa_log_format\n        - name: OPAL_LOG_MODULE_EXCLUDE_LIST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_log_module_exclude_list\n        - name: OPAL_LOG_COLORIZE\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_log_colorize\n        ports:\n        - name: opal-client\n          protocol: TCP\n          containerPort: 7000\n        - name: opa\n          protocol: TCP\n          containerPort: 8181\n        volumeMounts:\n        - mountPath: /data/opa\n          name: opa-volume\n      volumes:\n      - name: elastic-apm-volume\n        persistentVolumeClaim:\n          claimName: elastic-apm-pvc\n      - name: opa-volume\n        persistentVolumeClaim:\n          claimName: opa-pvc\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"graphql-server\" has cpu request 0"
  },
  {
    "id": "02022",
    "manifest_path": "data/manifests/the_stack_sample/sample_0747.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: graphql-server-deployment\n  namespace: hm\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      component: graphql-server\n  template:\n    metadata:\n      labels:\n        component: graphql-server\n    spec:\n      containers:\n      - name: graphql-server\n        image: hongbomiao/hm-graphql-server:latest\n        env:\n        - name: APP_ENV\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: app_env\n        - name: PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: port\n        - name: GRPC_SERVER_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: grpc_server_host\n        - name: GRPC_SERVER_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: grpc_server_port\n        - name: OPA_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opa_host\n        - name: OPA_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opa_port\n        - name: DGRAPH_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: dgraph_host\n        - name: DGRAPH_GRPC_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: dgraph_grpc_port\n        - name: REDIS_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_host\n        - name: REDIS_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_port\n        - name: REDIS_DB\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_db\n        - name: MINIO_ENDPOINT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_endpoint\n        - name: MINIO_ACCESS_KEY_ID\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_access_key_id\n        - name: MINIO_SECRET_ACCESS_KEY\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_secret_access_key\n        - name: TORCH_SERVE_GRPC_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: torch_serve_grpc_host\n        - name: TORCH_SERVE_GRPC_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: torch_serve_grpc_port\n        - name: OPEN_CENSUS_AGENT_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: open_census_agent_host\n        - name: OPEN_CENSUS_AGENT_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: open_census_agent_port\n        - name: JAEGER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: jaeger_url\n        - name: JWT_SECRET\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: jwt_secret\n        - name: ELASTIC_APM_SERVICE_NAME\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: elastic_apm_service_name\n        - name: ELASTIC_APM_SERVER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_server_url\n        - name: ELASTIC_APM_ENVIRONMENT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_environment\n        - name: ELASTIC_APM_SECRET_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: hm-elastic-apm\n              key: token\n        - name: ELASTIC_APM_VERIFY_SERVER_CERT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_verify_server_cert\n        - name: ELASTIC_APM_SERVER_CERT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_server_cert\n        - name: ELASTIC_APM_LOG_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_log_level\n        - name: ELASTIC_APM_LOG_FILE\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_log_file\n        ports:\n        - name: graphql-server\n          protocol: TCP\n          containerPort: 31800\n        volumeMounts:\n        - mountPath: /data/elastic-apm\n          name: elastic-apm-volume\n      - name: opal-client\n        image: hongbomiao/hm-opal-client:latest\n        env:\n        - name: OPAL_CLIENT_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: hm-opal-client-secret\n              key: opal_client_token\n        - name: OPAL_SERVER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_server_url\n        - name: OPAL_FETCH_PROVIDER_MODULES\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_fetch_provider_modules\n        - name: OPAL_INLINE_OPA_CONFIG\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_inline_opa_config\n        - name: OPAL_INLINE_OPA_LOG_FORMAT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_inline_opa_log_format\n        - name: OPAL_LOG_MODULE_EXCLUDE_LIST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_log_module_exclude_list\n        - name: OPAL_LOG_COLORIZE\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_log_colorize\n        ports:\n        - name: opal-client\n          protocol: TCP\n          containerPort: 7000\n        - name: opa\n          protocol: TCP\n          containerPort: 8181\n        volumeMounts:\n        - mountPath: /data/opa\n          name: opa-volume\n      volumes:\n      - name: elastic-apm-volume\n        persistentVolumeClaim:\n          claimName: elastic-apm-pvc\n      - name: opa-volume\n        persistentVolumeClaim:\n          claimName: opa-pvc\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"opal-client\" has cpu request 0"
  },
  {
    "id": "02023",
    "manifest_path": "data/manifests/the_stack_sample/sample_0747.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: graphql-server-deployment\n  namespace: hm\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      component: graphql-server\n  template:\n    metadata:\n      labels:\n        component: graphql-server\n    spec:\n      containers:\n      - name: graphql-server\n        image: hongbomiao/hm-graphql-server:latest\n        env:\n        - name: APP_ENV\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: app_env\n        - name: PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: port\n        - name: GRPC_SERVER_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: grpc_server_host\n        - name: GRPC_SERVER_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: grpc_server_port\n        - name: OPA_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opa_host\n        - name: OPA_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opa_port\n        - name: DGRAPH_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: dgraph_host\n        - name: DGRAPH_GRPC_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: dgraph_grpc_port\n        - name: REDIS_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_host\n        - name: REDIS_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_port\n        - name: REDIS_DB\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_db\n        - name: MINIO_ENDPOINT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_endpoint\n        - name: MINIO_ACCESS_KEY_ID\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_access_key_id\n        - name: MINIO_SECRET_ACCESS_KEY\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_secret_access_key\n        - name: TORCH_SERVE_GRPC_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: torch_serve_grpc_host\n        - name: TORCH_SERVE_GRPC_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: torch_serve_grpc_port\n        - name: OPEN_CENSUS_AGENT_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: open_census_agent_host\n        - name: OPEN_CENSUS_AGENT_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: open_census_agent_port\n        - name: JAEGER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: jaeger_url\n        - name: JWT_SECRET\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: jwt_secret\n        - name: ELASTIC_APM_SERVICE_NAME\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: elastic_apm_service_name\n        - name: ELASTIC_APM_SERVER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_server_url\n        - name: ELASTIC_APM_ENVIRONMENT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_environment\n        - name: ELASTIC_APM_SECRET_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: hm-elastic-apm\n              key: token\n        - name: ELASTIC_APM_VERIFY_SERVER_CERT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_verify_server_cert\n        - name: ELASTIC_APM_SERVER_CERT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_server_cert\n        - name: ELASTIC_APM_LOG_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_log_level\n        - name: ELASTIC_APM_LOG_FILE\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_log_file\n        ports:\n        - name: graphql-server\n          protocol: TCP\n          containerPort: 31800\n        volumeMounts:\n        - mountPath: /data/elastic-apm\n          name: elastic-apm-volume\n      - name: opal-client\n        image: hongbomiao/hm-opal-client:latest\n        env:\n        - name: OPAL_CLIENT_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: hm-opal-client-secret\n              key: opal_client_token\n        - name: OPAL_SERVER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_server_url\n        - name: OPAL_FETCH_PROVIDER_MODULES\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_fetch_provider_modules\n        - name: OPAL_INLINE_OPA_CONFIG\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_inline_opa_config\n        - name: OPAL_INLINE_OPA_LOG_FORMAT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_inline_opa_log_format\n        - name: OPAL_LOG_MODULE_EXCLUDE_LIST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_log_module_exclude_list\n        - name: OPAL_LOG_COLORIZE\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_log_colorize\n        ports:\n        - name: opal-client\n          protocol: TCP\n          containerPort: 7000\n        - name: opa\n          protocol: TCP\n          containerPort: 8181\n        volumeMounts:\n        - mountPath: /data/opa\n          name: opa-volume\n      volumes:\n      - name: elastic-apm-volume\n        persistentVolumeClaim:\n          claimName: elastic-apm-pvc\n      - name: opa-volume\n        persistentVolumeClaim:\n          claimName: opa-pvc\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"graphql-server\" has memory limit 0"
  },
  {
    "id": "02024",
    "manifest_path": "data/manifests/the_stack_sample/sample_0747.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: graphql-server-deployment\n  namespace: hm\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      component: graphql-server\n  template:\n    metadata:\n      labels:\n        component: graphql-server\n    spec:\n      containers:\n      - name: graphql-server\n        image: hongbomiao/hm-graphql-server:latest\n        env:\n        - name: APP_ENV\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: app_env\n        - name: PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: port\n        - name: GRPC_SERVER_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: grpc_server_host\n        - name: GRPC_SERVER_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: grpc_server_port\n        - name: OPA_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opa_host\n        - name: OPA_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opa_port\n        - name: DGRAPH_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: dgraph_host\n        - name: DGRAPH_GRPC_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: dgraph_grpc_port\n        - name: REDIS_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_host\n        - name: REDIS_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_port\n        - name: REDIS_DB\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: redis_db\n        - name: MINIO_ENDPOINT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_endpoint\n        - name: MINIO_ACCESS_KEY_ID\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_access_key_id\n        - name: MINIO_SECRET_ACCESS_KEY\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: minio_secret_access_key\n        - name: TORCH_SERVE_GRPC_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: torch_serve_grpc_host\n        - name: TORCH_SERVE_GRPC_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: torch_serve_grpc_port\n        - name: OPEN_CENSUS_AGENT_HOST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: open_census_agent_host\n        - name: OPEN_CENSUS_AGENT_PORT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: open_census_agent_port\n        - name: JAEGER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: jaeger_url\n        - name: JWT_SECRET\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: jwt_secret\n        - name: ELASTIC_APM_SERVICE_NAME\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: elastic_apm_service_name\n        - name: ELASTIC_APM_SERVER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_server_url\n        - name: ELASTIC_APM_ENVIRONMENT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_environment\n        - name: ELASTIC_APM_SECRET_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: hm-elastic-apm\n              key: token\n        - name: ELASTIC_APM_VERIFY_SERVER_CERT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_verify_server_cert\n        - name: ELASTIC_APM_SERVER_CERT\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_server_cert\n        - name: ELASTIC_APM_LOG_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_log_level\n        - name: ELASTIC_APM_LOG_FILE\n          valueFrom:\n            configMapKeyRef:\n              name: elastic-apm-configmap\n              key: elastic_apm_log_file\n        ports:\n        - name: graphql-server\n          protocol: TCP\n          containerPort: 31800\n        volumeMounts:\n        - mountPath: /data/elastic-apm\n          name: elastic-apm-volume\n      - name: opal-client\n        image: hongbomiao/hm-opal-client:latest\n        env:\n        - name: OPAL_CLIENT_TOKEN\n          valueFrom:\n            secretKeyRef:\n              name: hm-opal-client-secret\n              key: opal_client_token\n        - name: OPAL_SERVER_URL\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_server_url\n        - name: OPAL_FETCH_PROVIDER_MODULES\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_fetch_provider_modules\n        - name: OPAL_INLINE_OPA_CONFIG\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_inline_opa_config\n        - name: OPAL_INLINE_OPA_LOG_FORMAT\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_inline_opa_log_format\n        - name: OPAL_LOG_MODULE_EXCLUDE_LIST\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_log_module_exclude_list\n        - name: OPAL_LOG_COLORIZE\n          valueFrom:\n            configMapKeyRef:\n              name: graphql-server-configmap\n              key: opal_log_colorize\n        ports:\n        - name: opal-client\n          protocol: TCP\n          containerPort: 7000\n        - name: opa\n          protocol: TCP\n          containerPort: 8181\n        volumeMounts:\n        - mountPath: /data/opa\n          name: opa-volume\n      volumes:\n      - name: elastic-apm-volume\n        persistentVolumeClaim:\n          claimName: elastic-apm-pvc\n      - name: opa-volume\n        persistentVolumeClaim:\n          claimName: opa-pvc\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"opal-client\" has memory limit 0"
  },
  {
    "id": "02025",
    "manifest_path": "data/manifests/the_stack_sample/sample_0749.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: catalogue-db\n  labels:\n    name: catalogue-db\nspec:\n  containers:\n  - name: catalogue-db\n    image: weaveworksdemos/catalogue-db:0.2.0\n    env:\n    - name: MYSQL_ROOT_PASSWORD\n      value: fake_password\n    - name: MYSQL_DATABASE\n      value: socksdb\n    ports:\n    - name: mysql\n      containerPort: 3306\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"catalogue-db\" does not have a read-only root file system"
  },
  {
    "id": "02026",
    "manifest_path": "data/manifests/the_stack_sample/sample_0749.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: catalogue-db\n  labels:\n    name: catalogue-db\nspec:\n  containers:\n  - name: catalogue-db\n    image: weaveworksdemos/catalogue-db:0.2.0\n    env:\n    - name: MYSQL_ROOT_PASSWORD\n      value: fake_password\n    - name: MYSQL_DATABASE\n      value: socksdb\n    ports:\n    - name: mysql\n      containerPort: 3306\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"catalogue-db\" is not set to runAsNonRoot"
  },
  {
    "id": "02027",
    "manifest_path": "data/manifests/the_stack_sample/sample_0749.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: catalogue-db\n  labels:\n    name: catalogue-db\nspec:\n  containers:\n  - name: catalogue-db\n    image: weaveworksdemos/catalogue-db:0.2.0\n    env:\n    - name: MYSQL_ROOT_PASSWORD\n      value: fake_password\n    - name: MYSQL_DATABASE\n      value: socksdb\n    ports:\n    - name: mysql\n      containerPort: 3306\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"catalogue-db\" has cpu request 0"
  },
  {
    "id": "02028",
    "manifest_path": "data/manifests/the_stack_sample/sample_0749.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: catalogue-db\n  labels:\n    name: catalogue-db\nspec:\n  containers:\n  - name: catalogue-db\n    image: weaveworksdemos/catalogue-db:0.2.0\n    env:\n    - name: MYSQL_ROOT_PASSWORD\n      value: fake_password\n    - name: MYSQL_DATABASE\n      value: socksdb\n    ports:\n    - name: mysql\n      containerPort: 3306\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"catalogue-db\" has memory limit 0"
  },
  {
    "id": "02029",
    "manifest_path": "data/manifests/the_stack_sample/sample_0751.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: quotesweb\n  labels:\n    app: quotesweb\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: quotesweb\n  template:\n    metadata:\n      labels:\n        app: quotesweb\n    spec:\n      containers:\n      - name: quotes\n        image: quay.io/donschenck/quotesweb:v1\n        imagePullPolicy: Always\n        ports:\n        - containerPort: 3000\n          protocol: TCP\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"quotes\" does not have a read-only root file system"
  },
  {
    "id": "02030",
    "manifest_path": "data/manifests/the_stack_sample/sample_0751.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: quotesweb\n  labels:\n    app: quotesweb\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: quotesweb\n  template:\n    metadata:\n      labels:\n        app: quotesweb\n    spec:\n      containers:\n      - name: quotes\n        image: quay.io/donschenck/quotesweb:v1\n        imagePullPolicy: Always\n        ports:\n        - containerPort: 3000\n          protocol: TCP\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"quotes\" is not set to runAsNonRoot"
  },
  {
    "id": "02031",
    "manifest_path": "data/manifests/the_stack_sample/sample_0751.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: quotesweb\n  labels:\n    app: quotesweb\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: quotesweb\n  template:\n    metadata:\n      labels:\n        app: quotesweb\n    spec:\n      containers:\n      - name: quotes\n        image: quay.io/donschenck/quotesweb:v1\n        imagePullPolicy: Always\n        ports:\n        - containerPort: 3000\n          protocol: TCP\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"quotes\" has cpu request 0"
  },
  {
    "id": "02032",
    "manifest_path": "data/manifests/the_stack_sample/sample_0751.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: quotesweb\n  labels:\n    app: quotesweb\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: quotesweb\n  template:\n    metadata:\n      labels:\n        app: quotesweb\n    spec:\n      containers:\n      - name: quotes\n        image: quay.io/donschenck/quotesweb:v1\n        imagePullPolicy: Always\n        ports:\n        - containerPort: 3000\n          protocol: TCP\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"quotes\" has memory limit 0"
  },
  {
    "id": "02033",
    "manifest_path": "data/manifests/the_stack_sample/sample_0757.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: demo-php\n  labels:\n    app: demo\nspec:\n  selector:\n    matchLabels:\n      app: demo\n  replicas: 3\n  template:\n    metadata:\n      labels:\n        app: demo\n    spec:\n      containers:\n      - name: demo-php\n        image: demo-php:latest\n        imagePullPolicy: Never\n        resources:\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        ports:\n        - containerPort: 9000\n      - name: demo-nginx\n        image: demo-nginx:latest\n        imagePullPolicy: Never\n        ports:\n        - containerPort: 80\n        resources:\n          limits:\n            cpu: 150m\n          requests:\n            cpu: 50m\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"demo-nginx\" is using an invalid container image, \"demo-nginx:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02034",
    "manifest_path": "data/manifests/the_stack_sample/sample_0757.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: demo-php\n  labels:\n    app: demo\nspec:\n  selector:\n    matchLabels:\n      app: demo\n  replicas: 3\n  template:\n    metadata:\n      labels:\n        app: demo\n    spec:\n      containers:\n      - name: demo-php\n        image: demo-php:latest\n        imagePullPolicy: Never\n        resources:\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        ports:\n        - containerPort: 9000\n      - name: demo-nginx\n        image: demo-nginx:latest\n        imagePullPolicy: Never\n        ports:\n        - containerPort: 80\n        resources:\n          limits:\n            cpu: 150m\n          requests:\n            cpu: 50m\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"demo-php\" is using an invalid container image, \"demo-php:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02035",
    "manifest_path": "data/manifests/the_stack_sample/sample_0757.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: demo-php\n  labels:\n    app: demo\nspec:\n  selector:\n    matchLabels:\n      app: demo\n  replicas: 3\n  template:\n    metadata:\n      labels:\n        app: demo\n    spec:\n      containers:\n      - name: demo-php\n        image: demo-php:latest\n        imagePullPolicy: Never\n        resources:\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        ports:\n        - containerPort: 9000\n      - name: demo-nginx\n        image: demo-nginx:latest\n        imagePullPolicy: Never\n        ports:\n        - containerPort: 80\n        resources:\n          limits:\n            cpu: 150m\n          requests:\n            cpu: 50m\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"demo-nginx\" does not have a read-only root file system"
  },
  {
    "id": "02036",
    "manifest_path": "data/manifests/the_stack_sample/sample_0757.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: demo-php\n  labels:\n    app: demo\nspec:\n  selector:\n    matchLabels:\n      app: demo\n  replicas: 3\n  template:\n    metadata:\n      labels:\n        app: demo\n    spec:\n      containers:\n      - name: demo-php\n        image: demo-php:latest\n        imagePullPolicy: Never\n        resources:\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        ports:\n        - containerPort: 9000\n      - name: demo-nginx\n        image: demo-nginx:latest\n        imagePullPolicy: Never\n        ports:\n        - containerPort: 80\n        resources:\n          limits:\n            cpu: 150m\n          requests:\n            cpu: 50m\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"demo-php\" does not have a read-only root file system"
  },
  {
    "id": "02037",
    "manifest_path": "data/manifests/the_stack_sample/sample_0757.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: demo-php\n  labels:\n    app: demo\nspec:\n  selector:\n    matchLabels:\n      app: demo\n  replicas: 3\n  template:\n    metadata:\n      labels:\n        app: demo\n    spec:\n      containers:\n      - name: demo-php\n        image: demo-php:latest\n        imagePullPolicy: Never\n        resources:\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        ports:\n        - containerPort: 9000\n      - name: demo-nginx\n        image: demo-nginx:latest\n        imagePullPolicy: Never\n        ports:\n        - containerPort: 80\n        resources:\n          limits:\n            cpu: 150m\n          requests:\n            cpu: 50m\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"demo-nginx\" is not set to runAsNonRoot"
  },
  {
    "id": "02038",
    "manifest_path": "data/manifests/the_stack_sample/sample_0757.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: demo-php\n  labels:\n    app: demo\nspec:\n  selector:\n    matchLabels:\n      app: demo\n  replicas: 3\n  template:\n    metadata:\n      labels:\n        app: demo\n    spec:\n      containers:\n      - name: demo-php\n        image: demo-php:latest\n        imagePullPolicy: Never\n        resources:\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        ports:\n        - containerPort: 9000\n      - name: demo-nginx\n        image: demo-nginx:latest\n        imagePullPolicy: Never\n        ports:\n        - containerPort: 80\n        resources:\n          limits:\n            cpu: 150m\n          requests:\n            cpu: 50m\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"demo-php\" is not set to runAsNonRoot"
  },
  {
    "id": "02039",
    "manifest_path": "data/manifests/the_stack_sample/sample_0757.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: demo-php\n  labels:\n    app: demo\nspec:\n  selector:\n    matchLabels:\n      app: demo\n  replicas: 3\n  template:\n    metadata:\n      labels:\n        app: demo\n    spec:\n      containers:\n      - name: demo-php\n        image: demo-php:latest\n        imagePullPolicy: Never\n        resources:\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        ports:\n        - containerPort: 9000\n      - name: demo-nginx\n        image: demo-nginx:latest\n        imagePullPolicy: Never\n        ports:\n        - containerPort: 80\n        resources:\n          limits:\n            cpu: 150m\n          requests:\n            cpu: 50m\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"demo-nginx\" has memory limit 0"
  },
  {
    "id": "02040",
    "manifest_path": "data/manifests/the_stack_sample/sample_0757.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: demo-php\n  labels:\n    app: demo\nspec:\n  selector:\n    matchLabels:\n      app: demo\n  replicas: 3\n  template:\n    metadata:\n      labels:\n        app: demo\n    spec:\n      containers:\n      - name: demo-php\n        image: demo-php:latest\n        imagePullPolicy: Never\n        resources:\n          requests:\n            cpu: 100m\n            memory: 100Mi\n        ports:\n        - containerPort: 9000\n      - name: demo-nginx\n        image: demo-nginx:latest\n        imagePullPolicy: Never\n        ports:\n        - containerPort: 80\n        resources:\n          limits:\n            cpu: 150m\n          requests:\n            cpu: 50m\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"demo-php\" has memory limit 0"
  }
]