[
  {
    "id": "03481",
    "manifest_path": "data/manifests/the_stack_sample/sample_1520.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app.kubernetes.io/name: spring-petclinic-scott\n  name: spring-petclinic-scott-app\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: spring-petclinic-scott\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/name: spring-petclinic-scott\n        app.kubernetes.io/part-of: spring-petclinic-scott\n        tanzu.app.live.view: 'true'\n        tanzu.app.live.view.application.name: spring-petclinic-scott\n    spec:\n      containers:\n      - image: spring-petclinic-scott:2.4.2\n        imagePullPolicy: IfNotPresent\n        livenessProbe:\n          httpGet:\n            path: /actuator/health/liveness\n            port: 8080\n          initialDelaySeconds: 15\n        name: app\n        ports:\n        - containerPort: 8080\n        readinessProbe:\n          httpGet:\n            path: /actuator/health/readiness\n            port: 8080\n          initialDelaySeconds: 15\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"app\" is not set to runAsNonRoot"
  },
  {
    "id": "03482",
    "manifest_path": "data/manifests/the_stack_sample/sample_1520.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app.kubernetes.io/name: spring-petclinic-scott\n  name: spring-petclinic-scott-app\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: spring-petclinic-scott\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/name: spring-petclinic-scott\n        app.kubernetes.io/part-of: spring-petclinic-scott\n        tanzu.app.live.view: 'true'\n        tanzu.app.live.view.application.name: spring-petclinic-scott\n    spec:\n      containers:\n      - image: spring-petclinic-scott:2.4.2\n        imagePullPolicy: IfNotPresent\n        livenessProbe:\n          httpGet:\n            path: /actuator/health/liveness\n            port: 8080\n          initialDelaySeconds: 15\n        name: app\n        ports:\n        - containerPort: 8080\n        readinessProbe:\n          httpGet:\n            path: /actuator/health/readiness\n            port: 8080\n          initialDelaySeconds: 15\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"app\" has cpu request 0"
  },
  {
    "id": "03483",
    "manifest_path": "data/manifests/the_stack_sample/sample_1520.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app.kubernetes.io/name: spring-petclinic-scott\n  name: spring-petclinic-scott-app\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: spring-petclinic-scott\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/name: spring-petclinic-scott\n        app.kubernetes.io/part-of: spring-petclinic-scott\n        tanzu.app.live.view: 'true'\n        tanzu.app.live.view.application.name: spring-petclinic-scott\n    spec:\n      containers:\n      - image: spring-petclinic-scott:2.4.2\n        imagePullPolicy: IfNotPresent\n        livenessProbe:\n          httpGet:\n            path: /actuator/health/liveness\n            port: 8080\n          initialDelaySeconds: 15\n        name: app\n        ports:\n        - containerPort: 8080\n        readinessProbe:\n          httpGet:\n            path: /actuator/health/readiness\n            port: 8080\n          initialDelaySeconds: 15\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"app\" has memory limit 0"
  },
  {
    "id": "03484",
    "manifest_path": "data/manifests/the_stack_sample/sample_1524.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: web\n  labels:\n    app: web\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: web\n  template:\n    metadata:\n      labels:\n        app: web\n    spec:\n      containers:\n      - image: registry.example.com/cryb/web:latest\n        name: web\n        imagePullPolicy: Always\n        envFrom:\n        - secretRef:\n            name: web-env-secret\n        env:\n        - name: K8S_POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        ports:\n        - containerPort: 4000\n          name: http-server\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"web\" is using an invalid container image, \"registry.example.com/cryb/web:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "03485",
    "manifest_path": "data/manifests/the_stack_sample/sample_1524.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: web\n  labels:\n    app: web\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: web\n  template:\n    metadata:\n      labels:\n        app: web\n    spec:\n      containers:\n      - image: registry.example.com/cryb/web:latest\n        name: web\n        imagePullPolicy: Always\n        envFrom:\n        - secretRef:\n            name: web-env-secret\n        env:\n        - name: K8S_POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        ports:\n        - containerPort: 4000\n          name: http-server\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"web\" does not have a read-only root file system"
  },
  {
    "id": "03486",
    "manifest_path": "data/manifests/the_stack_sample/sample_1524.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: web\n  labels:\n    app: web\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: web\n  template:\n    metadata:\n      labels:\n        app: web\n    spec:\n      containers:\n      - image: registry.example.com/cryb/web:latest\n        name: web\n        imagePullPolicy: Always\n        envFrom:\n        - secretRef:\n            name: web-env-secret\n        env:\n        - name: K8S_POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        ports:\n        - containerPort: 4000\n          name: http-server\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"web\" is not set to runAsNonRoot"
  },
  {
    "id": "03487",
    "manifest_path": "data/manifests/the_stack_sample/sample_1524.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: web\n  labels:\n    app: web\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: web\n  template:\n    metadata:\n      labels:\n        app: web\n    spec:\n      containers:\n      - image: registry.example.com/cryb/web:latest\n        name: web\n        imagePullPolicy: Always\n        envFrom:\n        - secretRef:\n            name: web-env-secret\n        env:\n        - name: K8S_POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        ports:\n        - containerPort: 4000\n          name: http-server\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"web\" has cpu request 0"
  },
  {
    "id": "03488",
    "manifest_path": "data/manifests/the_stack_sample/sample_1524.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: web\n  labels:\n    app: web\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: web\n  template:\n    metadata:\n      labels:\n        app: web\n    spec:\n      containers:\n      - image: registry.example.com/cryb/web:latest\n        name: web\n        imagePullPolicy: Always\n        envFrom:\n        - secretRef:\n            name: web-env-secret\n        env:\n        - name: K8S_POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        ports:\n        - containerPort: 4000\n          name: http-server\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"web\" has memory limit 0"
  },
  {
    "id": "03489",
    "manifest_path": "data/manifests/the_stack_sample/sample_1525.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: getting-started-kaniko\nspec:\n  containers:\n  - name: getting-started\n    image: gcr.io/k8s-skaffold/skaffold-example-sub\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"getting-started\" is using an invalid container image, \"gcr.io/k8s-skaffold/skaffold-example-sub\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "03490",
    "manifest_path": "data/manifests/the_stack_sample/sample_1525.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: getting-started-kaniko\nspec:\n  containers:\n  - name: getting-started\n    image: gcr.io/k8s-skaffold/skaffold-example-sub\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"getting-started\" does not have a read-only root file system"
  },
  {
    "id": "03491",
    "manifest_path": "data/manifests/the_stack_sample/sample_1525.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: getting-started-kaniko\nspec:\n  containers:\n  - name: getting-started\n    image: gcr.io/k8s-skaffold/skaffold-example-sub\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"getting-started\" is not set to runAsNonRoot"
  },
  {
    "id": "03492",
    "manifest_path": "data/manifests/the_stack_sample/sample_1525.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: getting-started-kaniko\nspec:\n  containers:\n  - name: getting-started\n    image: gcr.io/k8s-skaffold/skaffold-example-sub\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"getting-started\" has cpu request 0"
  },
  {
    "id": "03493",
    "manifest_path": "data/manifests/the_stack_sample/sample_1525.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: getting-started-kaniko\nspec:\n  containers:\n  - name: getting-started\n    image: gcr.io/k8s-skaffold/skaffold-example-sub\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"getting-started\" has memory limit 0"
  },
  {
    "id": "03494",
    "manifest_path": "data/manifests/the_stack_sample/sample_1526.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: vaccine\n  labels:\n    app: vaccine\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: vaccine\n  template:\n    metadata:\n      labels:\n        app: vaccine\n    spec:\n      containers:\n      - name: vaccine\n        image: user09acr.azurecr.io/vaccine:latest\n        ports:\n        - containerPort: 8080\n        readinessProbe:\n          httpGet:\n            path: /actuator/health\n            port: 8080\n          initialDelaySeconds: 10\n          timeoutSeconds: 2\n          periodSeconds: 5\n          failureThreshold: 10\n        livenessProbe:\n          httpGet:\n            path: /actuator/health\n            port: 8080\n          initialDelaySeconds: 120\n          timeoutSeconds: 2\n          periodSeconds: 5\n          failureThreshold: 5\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"vaccine\" is using an invalid container image, \"user09acr.azurecr.io/vaccine:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "03495",
    "manifest_path": "data/manifests/the_stack_sample/sample_1526.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: vaccine\n  labels:\n    app: vaccine\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: vaccine\n  template:\n    metadata:\n      labels:\n        app: vaccine\n    spec:\n      containers:\n      - name: vaccine\n        image: user09acr.azurecr.io/vaccine:latest\n        ports:\n        - containerPort: 8080\n        readinessProbe:\n          httpGet:\n            path: /actuator/health\n            port: 8080\n          initialDelaySeconds: 10\n          timeoutSeconds: 2\n          periodSeconds: 5\n          failureThreshold: 10\n        livenessProbe:\n          httpGet:\n            path: /actuator/health\n            port: 8080\n          initialDelaySeconds: 120\n          timeoutSeconds: 2\n          periodSeconds: 5\n          failureThreshold: 5\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"vaccine\" does not have a read-only root file system"
  },
  {
    "id": "03496",
    "manifest_path": "data/manifests/the_stack_sample/sample_1526.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: vaccine\n  labels:\n    app: vaccine\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: vaccine\n  template:\n    metadata:\n      labels:\n        app: vaccine\n    spec:\n      containers:\n      - name: vaccine\n        image: user09acr.azurecr.io/vaccine:latest\n        ports:\n        - containerPort: 8080\n        readinessProbe:\n          httpGet:\n            path: /actuator/health\n            port: 8080\n          initialDelaySeconds: 10\n          timeoutSeconds: 2\n          periodSeconds: 5\n          failureThreshold: 10\n        livenessProbe:\n          httpGet:\n            path: /actuator/health\n            port: 8080\n          initialDelaySeconds: 120\n          timeoutSeconds: 2\n          periodSeconds: 5\n          failureThreshold: 5\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"vaccine\" is not set to runAsNonRoot"
  },
  {
    "id": "03497",
    "manifest_path": "data/manifests/the_stack_sample/sample_1526.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: vaccine\n  labels:\n    app: vaccine\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: vaccine\n  template:\n    metadata:\n      labels:\n        app: vaccine\n    spec:\n      containers:\n      - name: vaccine\n        image: user09acr.azurecr.io/vaccine:latest\n        ports:\n        - containerPort: 8080\n        readinessProbe:\n          httpGet:\n            path: /actuator/health\n            port: 8080\n          initialDelaySeconds: 10\n          timeoutSeconds: 2\n          periodSeconds: 5\n          failureThreshold: 10\n        livenessProbe:\n          httpGet:\n            path: /actuator/health\n            port: 8080\n          initialDelaySeconds: 120\n          timeoutSeconds: 2\n          periodSeconds: 5\n          failureThreshold: 5\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"vaccine\" has cpu request 0"
  },
  {
    "id": "03498",
    "manifest_path": "data/manifests/the_stack_sample/sample_1526.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: vaccine\n  labels:\n    app: vaccine\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: vaccine\n  template:\n    metadata:\n      labels:\n        app: vaccine\n    spec:\n      containers:\n      - name: vaccine\n        image: user09acr.azurecr.io/vaccine:latest\n        ports:\n        - containerPort: 8080\n        readinessProbe:\n          httpGet:\n            path: /actuator/health\n            port: 8080\n          initialDelaySeconds: 10\n          timeoutSeconds: 2\n          periodSeconds: 5\n          failureThreshold: 10\n        livenessProbe:\n          httpGet:\n            path: /actuator/health\n            port: 8080\n          initialDelaySeconds: 120\n          timeoutSeconds: 2\n          periodSeconds: 5\n          failureThreshold: 5\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"vaccine\" has memory limit 0"
  },
  {
    "id": "03499",
    "manifest_path": "data/manifests/the_stack_sample/sample_1528.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: podinfo\n  namespace: demo\n  labels:\n    app: podinfo\n  annotations:\n    fluxcd.io/automated: 'true'\n    fluxcd.io/tag.init: regex:^3.10.*\n    fluxcd.io/tag.podinfod: semver:~2.1\nspec:\n  selector:\n    matchLabels:\n      app: podinfo\n  template:\n    metadata:\n      annotations:\n        prometheus.io/scrape: 'true'\n      labels:\n        app: podinfo\n    spec:\n      initContainers:\n      - name: init\n        image: alpine:3.10\n        command:\n        - sleep\n        - '1'\n      containers:\n      - name: podinfod\n        image: stefanprodan/podinfo:2.1.3\n        imagePullPolicy: IfNotPresent\n        ports:\n        - containerPort: 9898\n          name: http\n          protocol: TCP\n        command:\n        - ./podinfo\n        - --port=9898\n        - --level=info\n        - --random-delay=false\n        - --random-error=false\n        env:\n        - name: PODINFO_UI_MESSAGE\n          value: Welcome to Flux Mr. Bond\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 9898\n        readinessProbe:\n          httpGet:\n            path: /readyz\n            port: 9898\n        resources:\n          limits:\n            cpu: 1000m\n            memory: 128Mi\n          requests:\n            cpu: 10m\n            memory: 64Mi\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"init\" does not have a read-only root file system"
  },
  {
    "id": "03500",
    "manifest_path": "data/manifests/the_stack_sample/sample_1528.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: podinfo\n  namespace: demo\n  labels:\n    app: podinfo\n  annotations:\n    fluxcd.io/automated: 'true'\n    fluxcd.io/tag.init: regex:^3.10.*\n    fluxcd.io/tag.podinfod: semver:~2.1\nspec:\n  selector:\n    matchLabels:\n      app: podinfo\n  template:\n    metadata:\n      annotations:\n        prometheus.io/scrape: 'true'\n      labels:\n        app: podinfo\n    spec:\n      initContainers:\n      - name: init\n        image: alpine:3.10\n        command:\n        - sleep\n        - '1'\n      containers:\n      - name: podinfod\n        image: stefanprodan/podinfo:2.1.3\n        imagePullPolicy: IfNotPresent\n        ports:\n        - containerPort: 9898\n          name: http\n          protocol: TCP\n        command:\n        - ./podinfo\n        - --port=9898\n        - --level=info\n        - --random-delay=false\n        - --random-error=false\n        env:\n        - name: PODINFO_UI_MESSAGE\n          value: Welcome to Flux Mr. Bond\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 9898\n        readinessProbe:\n          httpGet:\n            path: /readyz\n            port: 9898\n        resources:\n          limits:\n            cpu: 1000m\n            memory: 128Mi\n          requests:\n            cpu: 10m\n            memory: 64Mi\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"podinfod\" does not have a read-only root file system"
  },
  {
    "id": "03501",
    "manifest_path": "data/manifests/the_stack_sample/sample_1528.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: podinfo\n  namespace: demo\n  labels:\n    app: podinfo\n  annotations:\n    fluxcd.io/automated: 'true'\n    fluxcd.io/tag.init: regex:^3.10.*\n    fluxcd.io/tag.podinfod: semver:~2.1\nspec:\n  selector:\n    matchLabels:\n      app: podinfo\n  template:\n    metadata:\n      annotations:\n        prometheus.io/scrape: 'true'\n      labels:\n        app: podinfo\n    spec:\n      initContainers:\n      - name: init\n        image: alpine:3.10\n        command:\n        - sleep\n        - '1'\n      containers:\n      - name: podinfod\n        image: stefanprodan/podinfo:2.1.3\n        imagePullPolicy: IfNotPresent\n        ports:\n        - containerPort: 9898\n          name: http\n          protocol: TCP\n        command:\n        - ./podinfo\n        - --port=9898\n        - --level=info\n        - --random-delay=false\n        - --random-error=false\n        env:\n        - name: PODINFO_UI_MESSAGE\n          value: Welcome to Flux Mr. Bond\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 9898\n        readinessProbe:\n          httpGet:\n            path: /readyz\n            port: 9898\n        resources:\n          limits:\n            cpu: 1000m\n            memory: 128Mi\n          requests:\n            cpu: 10m\n            memory: 64Mi\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"init\" is not set to runAsNonRoot"
  },
  {
    "id": "03502",
    "manifest_path": "data/manifests/the_stack_sample/sample_1528.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: podinfo\n  namespace: demo\n  labels:\n    app: podinfo\n  annotations:\n    fluxcd.io/automated: 'true'\n    fluxcd.io/tag.init: regex:^3.10.*\n    fluxcd.io/tag.podinfod: semver:~2.1\nspec:\n  selector:\n    matchLabels:\n      app: podinfo\n  template:\n    metadata:\n      annotations:\n        prometheus.io/scrape: 'true'\n      labels:\n        app: podinfo\n    spec:\n      initContainers:\n      - name: init\n        image: alpine:3.10\n        command:\n        - sleep\n        - '1'\n      containers:\n      - name: podinfod\n        image: stefanprodan/podinfo:2.1.3\n        imagePullPolicy: IfNotPresent\n        ports:\n        - containerPort: 9898\n          name: http\n          protocol: TCP\n        command:\n        - ./podinfo\n        - --port=9898\n        - --level=info\n        - --random-delay=false\n        - --random-error=false\n        env:\n        - name: PODINFO_UI_MESSAGE\n          value: Welcome to Flux Mr. Bond\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 9898\n        readinessProbe:\n          httpGet:\n            path: /readyz\n            port: 9898\n        resources:\n          limits:\n            cpu: 1000m\n            memory: 128Mi\n          requests:\n            cpu: 10m\n            memory: 64Mi\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"podinfod\" is not set to runAsNonRoot"
  },
  {
    "id": "03503",
    "manifest_path": "data/manifests/the_stack_sample/sample_1528.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: podinfo\n  namespace: demo\n  labels:\n    app: podinfo\n  annotations:\n    fluxcd.io/automated: 'true'\n    fluxcd.io/tag.init: regex:^3.10.*\n    fluxcd.io/tag.podinfod: semver:~2.1\nspec:\n  selector:\n    matchLabels:\n      app: podinfo\n  template:\n    metadata:\n      annotations:\n        prometheus.io/scrape: 'true'\n      labels:\n        app: podinfo\n    spec:\n      initContainers:\n      - name: init\n        image: alpine:3.10\n        command:\n        - sleep\n        - '1'\n      containers:\n      - name: podinfod\n        image: stefanprodan/podinfo:2.1.3\n        imagePullPolicy: IfNotPresent\n        ports:\n        - containerPort: 9898\n          name: http\n          protocol: TCP\n        command:\n        - ./podinfo\n        - --port=9898\n        - --level=info\n        - --random-delay=false\n        - --random-error=false\n        env:\n        - name: PODINFO_UI_MESSAGE\n          value: Welcome to Flux Mr. Bond\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 9898\n        readinessProbe:\n          httpGet:\n            path: /readyz\n            port: 9898\n        resources:\n          limits:\n            cpu: 1000m\n            memory: 128Mi\n          requests:\n            cpu: 10m\n            memory: 64Mi\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"init\" has cpu request 0"
  },
  {
    "id": "03504",
    "manifest_path": "data/manifests/the_stack_sample/sample_1528.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: podinfo\n  namespace: demo\n  labels:\n    app: podinfo\n  annotations:\n    fluxcd.io/automated: 'true'\n    fluxcd.io/tag.init: regex:^3.10.*\n    fluxcd.io/tag.podinfod: semver:~2.1\nspec:\n  selector:\n    matchLabels:\n      app: podinfo\n  template:\n    metadata:\n      annotations:\n        prometheus.io/scrape: 'true'\n      labels:\n        app: podinfo\n    spec:\n      initContainers:\n      - name: init\n        image: alpine:3.10\n        command:\n        - sleep\n        - '1'\n      containers:\n      - name: podinfod\n        image: stefanprodan/podinfo:2.1.3\n        imagePullPolicy: IfNotPresent\n        ports:\n        - containerPort: 9898\n          name: http\n          protocol: TCP\n        command:\n        - ./podinfo\n        - --port=9898\n        - --level=info\n        - --random-delay=false\n        - --random-error=false\n        env:\n        - name: PODINFO_UI_MESSAGE\n          value: Welcome to Flux Mr. Bond\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 9898\n        readinessProbe:\n          httpGet:\n            path: /readyz\n            port: 9898\n        resources:\n          limits:\n            cpu: 1000m\n            memory: 128Mi\n          requests:\n            cpu: 10m\n            memory: 64Mi\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"init\" has memory limit 0"
  },
  {
    "id": "03505",
    "manifest_path": "data/manifests/the_stack_sample/sample_1531.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: karmada-kube-controller-manager\n  namespace: karmada-system\n  labels:\n    app: kube-controller-manager\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: kube-controller-manager\n  template:\n    metadata:\n      labels:\n        app: kube-controller-manager\n    spec:\n      affinity:\n        nodeAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n            nodeSelectorTerms:\n            - matchExpressions:\n              - key: node-role.kubernetes.io/master\n                operator: In\n                values:\n                - ''\n        podAntiAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n          - labelSelector:\n              matchExpressions:\n              - key: app\n                operator: In\n                values:\n                - kube-controller-manager\n            topologyKey: kubernetes.io/hostname\n      containers:\n      - command:\n        - kube-controller-manager\n        - --allocate-node-cidrs=true\n        - --authentication-kubeconfig=/etc/karmada/kubeconfig\n        - --authorization-kubeconfig=/etc/karmada/kubeconfig\n        - --bind-address=0.0.0.0\n        - --client-ca-file=/etc/karmada/pki/ca.crt\n        - --cluster-cidr=10.244.0.0/16\n        - --cluster-name=karmada\n        - --cluster-signing-cert-file=/etc/karmada/pki/ca.crt\n        - --cluster-signing-key-file=/etc/karmada/pki/ca.key\n        - --controllers=namespace,garbagecollector,serviceaccount-token\n        - --kubeconfig=/etc/karmada/kubeconfig\n        - --leader-elect=true\n        - --node-cidr-mask-size=24\n        - --port=0\n        - --root-ca-file=/etc/karmada/pki/ca.crt\n        - --service-account-private-key-file=/etc/karmada/pki/sa.key\n        - --service-cluster-ip-range=10.96.0.0/12\n        - --use-service-account-credentials=true\n        - --v=4\n        image: k8s.gcr.io/kube-controller-manager:{{ kube_version }}\n        imagePullPolicy: IfNotPresent\n        name: kube-controller-manager\n        resources:\n          requests:\n            cpu: 200m\n        volumeMounts:\n        - mountPath: /etc/karmada\n          name: k8s-certs\n          readOnly: true\n      volumes:\n      - hostPath:\n          path: /etc/karmada\n          type: DirectoryOrCreate\n        name: k8s-certs\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"kube-controller-manager\" does not have a read-only root file system"
  },
  {
    "id": "03506",
    "manifest_path": "data/manifests/the_stack_sample/sample_1531.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: karmada-kube-controller-manager\n  namespace: karmada-system\n  labels:\n    app: kube-controller-manager\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: kube-controller-manager\n  template:\n    metadata:\n      labels:\n        app: kube-controller-manager\n    spec:\n      affinity:\n        nodeAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n            nodeSelectorTerms:\n            - matchExpressions:\n              - key: node-role.kubernetes.io/master\n                operator: In\n                values:\n                - ''\n        podAntiAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n          - labelSelector:\n              matchExpressions:\n              - key: app\n                operator: In\n                values:\n                - kube-controller-manager\n            topologyKey: kubernetes.io/hostname\n      containers:\n      - command:\n        - kube-controller-manager\n        - --allocate-node-cidrs=true\n        - --authentication-kubeconfig=/etc/karmada/kubeconfig\n        - --authorization-kubeconfig=/etc/karmada/kubeconfig\n        - --bind-address=0.0.0.0\n        - --client-ca-file=/etc/karmada/pki/ca.crt\n        - --cluster-cidr=10.244.0.0/16\n        - --cluster-name=karmada\n        - --cluster-signing-cert-file=/etc/karmada/pki/ca.crt\n        - --cluster-signing-key-file=/etc/karmada/pki/ca.key\n        - --controllers=namespace,garbagecollector,serviceaccount-token\n        - --kubeconfig=/etc/karmada/kubeconfig\n        - --leader-elect=true\n        - --node-cidr-mask-size=24\n        - --port=0\n        - --root-ca-file=/etc/karmada/pki/ca.crt\n        - --service-account-private-key-file=/etc/karmada/pki/sa.key\n        - --service-cluster-ip-range=10.96.0.0/12\n        - --use-service-account-credentials=true\n        - --v=4\n        image: k8s.gcr.io/kube-controller-manager:{{ kube_version }}\n        imagePullPolicy: IfNotPresent\n        name: kube-controller-manager\n        resources:\n          requests:\n            cpu: 200m\n        volumeMounts:\n        - mountPath: /etc/karmada\n          name: k8s-certs\n          readOnly: true\n      volumes:\n      - hostPath:\n          path: /etc/karmada\n          type: DirectoryOrCreate\n        name: k8s-certs\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"kube-controller-manager\" is not set to runAsNonRoot"
  },
  {
    "id": "03507",
    "manifest_path": "data/manifests/the_stack_sample/sample_1531.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: karmada-kube-controller-manager\n  namespace: karmada-system\n  labels:\n    app: kube-controller-manager\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: kube-controller-manager\n  template:\n    metadata:\n      labels:\n        app: kube-controller-manager\n    spec:\n      affinity:\n        nodeAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n            nodeSelectorTerms:\n            - matchExpressions:\n              - key: node-role.kubernetes.io/master\n                operator: In\n                values:\n                - ''\n        podAntiAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n          - labelSelector:\n              matchExpressions:\n              - key: app\n                operator: In\n                values:\n                - kube-controller-manager\n            topologyKey: kubernetes.io/hostname\n      containers:\n      - command:\n        - kube-controller-manager\n        - --allocate-node-cidrs=true\n        - --authentication-kubeconfig=/etc/karmada/kubeconfig\n        - --authorization-kubeconfig=/etc/karmada/kubeconfig\n        - --bind-address=0.0.0.0\n        - --client-ca-file=/etc/karmada/pki/ca.crt\n        - --cluster-cidr=10.244.0.0/16\n        - --cluster-name=karmada\n        - --cluster-signing-cert-file=/etc/karmada/pki/ca.crt\n        - --cluster-signing-key-file=/etc/karmada/pki/ca.key\n        - --controllers=namespace,garbagecollector,serviceaccount-token\n        - --kubeconfig=/etc/karmada/kubeconfig\n        - --leader-elect=true\n        - --node-cidr-mask-size=24\n        - --port=0\n        - --root-ca-file=/etc/karmada/pki/ca.crt\n        - --service-account-private-key-file=/etc/karmada/pki/sa.key\n        - --service-cluster-ip-range=10.96.0.0/12\n        - --use-service-account-credentials=true\n        - --v=4\n        image: k8s.gcr.io/kube-controller-manager:{{ kube_version }}\n        imagePullPolicy: IfNotPresent\n        name: kube-controller-manager\n        resources:\n          requests:\n            cpu: 200m\n        volumeMounts:\n        - mountPath: /etc/karmada\n          name: k8s-certs\n          readOnly: true\n      volumes:\n      - hostPath:\n          path: /etc/karmada\n          type: DirectoryOrCreate\n        name: k8s-certs\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"kube-controller-manager\" has memory limit 0"
  },
  {
    "id": "03508",
    "manifest_path": "data/manifests/the_stack_sample/sample_1533.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-6724\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"nginx\" is using an invalid container image, \"nginx\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "03509",
    "manifest_path": "data/manifests/the_stack_sample/sample_1533.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-6724\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"nginx\" does not have a read-only root file system"
  },
  {
    "id": "03510",
    "manifest_path": "data/manifests/the_stack_sample/sample_1533.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-6724\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"nginx\" is not set to runAsNonRoot"
  },
  {
    "id": "03511",
    "manifest_path": "data/manifests/the_stack_sample/sample_1533.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-6724\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"nginx\" has cpu request 0"
  },
  {
    "id": "03512",
    "manifest_path": "data/manifests/the_stack_sample/sample_1533.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-6724\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"nginx\" has memory limit 0"
  },
  {
    "id": "03513",
    "manifest_path": "data/manifests/the_stack_sample/sample_1534.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: busybox0\n  labels:\n    app: busybox0\nspec:\n  replicas: 1\n  selector:\n    app: busybox0\n  template:\n    metadata:\n      name: busybox0\n      labels:\n        app: busybox0\n    spec:\n      containers:\n      - image: busybox\n        command:\n        - sleep\n        - '3600'\n        imagePullPolicy: IfNotPresent\n        name: busybox\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"busybox\" is using an invalid container image, \"busybox\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "03514",
    "manifest_path": "data/manifests/the_stack_sample/sample_1534.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: busybox0\n  labels:\n    app: busybox0\nspec:\n  replicas: 1\n  selector:\n    app: busybox0\n  template:\n    metadata:\n      name: busybox0\n      labels:\n        app: busybox0\n    spec:\n      containers:\n      - image: busybox\n        command:\n        - sleep\n        - '3600'\n        imagePullPolicy: IfNotPresent\n        name: busybox\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"busybox\" does not have a read-only root file system"
  },
  {
    "id": "03515",
    "manifest_path": "data/manifests/the_stack_sample/sample_1534.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: busybox0\n  labels:\n    app: busybox0\nspec:\n  replicas: 1\n  selector:\n    app: busybox0\n  template:\n    metadata:\n      name: busybox0\n      labels:\n        app: busybox0\n    spec:\n      containers:\n      - image: busybox\n        command:\n        - sleep\n        - '3600'\n        imagePullPolicy: IfNotPresent\n        name: busybox\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"busybox\" is not set to runAsNonRoot"
  },
  {
    "id": "03516",
    "manifest_path": "data/manifests/the_stack_sample/sample_1534.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: busybox0\n  labels:\n    app: busybox0\nspec:\n  replicas: 1\n  selector:\n    app: busybox0\n  template:\n    metadata:\n      name: busybox0\n      labels:\n        app: busybox0\n    spec:\n      containers:\n      - image: busybox\n        command:\n        - sleep\n        - '3600'\n        imagePullPolicy: IfNotPresent\n        name: busybox\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"busybox\" has cpu request 0"
  },
  {
    "id": "03517",
    "manifest_path": "data/manifests/the_stack_sample/sample_1534.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: busybox0\n  labels:\n    app: busybox0\nspec:\n  replicas: 1\n  selector:\n    app: busybox0\n  template:\n    metadata:\n      name: busybox0\n      labels:\n        app: busybox0\n    spec:\n      containers:\n      - image: busybox\n        command:\n        - sleep\n        - '3600'\n        imagePullPolicy: IfNotPresent\n        name: busybox\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"busybox\" has memory limit 0"
  },
  {
    "id": "03518",
    "manifest_path": "data/manifests/the_stack_sample/sample_1538.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: cowweb\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: cowweb\n  template:\n    metadata:\n      labels:\n        app: cowweb\n    spec:\n      containers:\n      - name: cowweb\n        image: phx.ocir.io/orasejapan/handsontest-001/cowweb:v1.0\n        ports:\n        - name: api\n          containerPort: 8080\n        readinessProbe:\n          httpGet:\n            path: /cowsay/ping\n            port: api\n          initialDelaySeconds: 5\n          periodSeconds: 10\n        livenessProbe:\n          httpGet:\n            path: /cowsay/ping\n            port: api\n          initialDelaySeconds: 15\n          periodSeconds: 20\n        imagePullPolicy: Always\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"cowweb\" does not have a read-only root file system"
  },
  {
    "id": "03519",
    "manifest_path": "data/manifests/the_stack_sample/sample_1538.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: cowweb\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: cowweb\n  template:\n    metadata:\n      labels:\n        app: cowweb\n    spec:\n      containers:\n      - name: cowweb\n        image: phx.ocir.io/orasejapan/handsontest-001/cowweb:v1.0\n        ports:\n        - name: api\n          containerPort: 8080\n        readinessProbe:\n          httpGet:\n            path: /cowsay/ping\n            port: api\n          initialDelaySeconds: 5\n          periodSeconds: 10\n        livenessProbe:\n          httpGet:\n            path: /cowsay/ping\n            port: api\n          initialDelaySeconds: 15\n          periodSeconds: 20\n        imagePullPolicy: Always\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"cowweb\" is not set to runAsNonRoot"
  },
  {
    "id": "03520",
    "manifest_path": "data/manifests/the_stack_sample/sample_1538.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: cowweb\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: cowweb\n  template:\n    metadata:\n      labels:\n        app: cowweb\n    spec:\n      containers:\n      - name: cowweb\n        image: phx.ocir.io/orasejapan/handsontest-001/cowweb:v1.0\n        ports:\n        - name: api\n          containerPort: 8080\n        readinessProbe:\n          httpGet:\n            path: /cowsay/ping\n            port: api\n          initialDelaySeconds: 5\n          periodSeconds: 10\n        livenessProbe:\n          httpGet:\n            path: /cowsay/ping\n            port: api\n          initialDelaySeconds: 15\n          periodSeconds: 20\n        imagePullPolicy: Always\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"cowweb\" has cpu request 0"
  }
]