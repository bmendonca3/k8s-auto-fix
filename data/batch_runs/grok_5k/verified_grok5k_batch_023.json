[
  {
    "id": "00921",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: quobyte\nspec:\n  containers:\n  - name: quobyte\n    image: kubernetes/pause:stable\n    volumeMounts:\n    - mountPath: /mnt\n      name: quobytevolume\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n  volumes:\n  - name: quobytevolume\n    quobyte:\n      registry: registry:7861\n      volume: testVolume\n      readOnly: false\n      user: root\n      group: root\n",
    "errors": []
  },
  {
    "id": "00922",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: quobyte\nspec:\n  containers:\n  - name: quobyte\n    image: kubernetes/pause:stable\n    volumeMounts:\n    - mountPath: /mnt\n      name: quobytevolume\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n  volumes:\n  - name: quobytevolume\n    quobyte:\n      registry: registry:7861\n      volume: testVolume\n      readOnly: false\n      user: root\n      group: root\n",
    "errors": []
  },
  {
    "id": "00923",
    "policy_id": "no_latest_tag",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": false,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "no containers found in manifest",
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "00924",
    "policy_id": "read_only_root_fs",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": false,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "no containers found in manifest",
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "00925",
    "policy_id": "run_as_non_root",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": false,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "no containers found in manifest",
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "00926",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": false,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "no containers found in manifest",
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "00927",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": false,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "no containers found in manifest",
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "00928",
    "policy_id": "read_only_root_fs",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "00929",
    "policy_id": "run_as_non_root",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "00930",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "00931",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "00932",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: monitoring-heapster-v6\n  namespace: kube-system\n  labels:\n    k8s-app: heapster\n    version: v6\n    kubernetes.io/cluster-service: 'true'\nspec:\n  replicas: 1\n  selector:\n    k8s-app: heapster\n    version: v6\n  template:\n    metadata:\n      labels:\n        k8s-app: heapster\n        version: v6\n        kubernetes.io/cluster-service: 'true'\n    spec:\n      containers:\n      - image: gcr.io/google_containers/heapster:v0.16.1\n        name: heapster\n        resources:\n          limits:\n            cpu: 100m\n            memory: 300Mi\n        command:\n        - /heapster\n        - --source=kubernetes:''\n        - --sink=gcl\n        - --sink=influxdb:http://monitoring-influxdb:8086\n        - --poll_duration=2m\n        - --stats_resolution=1m\n        volumeMounts:\n        - name: ssl-certs\n          mountPath: /etc/ssl/certs\n          readOnly: true\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: ssl-certs\n        hostPath:\n          path: /etc/ssl/certs\n",
    "errors": []
  },
  {
    "id": "00933",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: monitoring-heapster-v6\n  namespace: kube-system\n  labels:\n    k8s-app: heapster\n    version: v6\n    kubernetes.io/cluster-service: 'true'\nspec:\n  replicas: 1\n  selector:\n    k8s-app: heapster\n    version: v6\n  template:\n    metadata:\n      labels:\n        k8s-app: heapster\n        version: v6\n        kubernetes.io/cluster-service: 'true'\n    spec:\n      containers:\n      - image: gcr.io/google_containers/heapster:v0.16.1\n        name: heapster\n        resources:\n          limits:\n            cpu: 100m\n            memory: 300Mi\n        command:\n        - /heapster\n        - --source=kubernetes:''\n        - --sink=gcl\n        - --sink=influxdb:http://monitoring-influxdb:8086\n        - --poll_duration=2m\n        - --stats_resolution=1m\n        volumeMounts:\n        - name: ssl-certs\n          mountPath: /etc/ssl/certs\n          readOnly: true\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: ssl-certs\n        hostPath:\n          path: /etc/ssl/certs\n",
    "errors": []
  },
  {
    "id": "00934",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: monitoring-heapster-v6\n  namespace: kube-system\n  labels:\n    k8s-app: heapster\n    version: v6\n    kubernetes.io/cluster-service: 'true'\nspec:\n  replicas: 1\n  selector:\n    k8s-app: heapster\n    version: v6\n  template:\n    metadata:\n      labels:\n        k8s-app: heapster\n        version: v6\n        kubernetes.io/cluster-service: 'true'\n    spec:\n      containers:\n      - image: gcr.io/google_containers/heapster:v0.16.1\n        name: heapster\n        resources:\n          limits:\n            cpu: 100m\n            memory: 300Mi\n          requests:\n            cpu: 100m\n            memory: 128Mi\n        command:\n        - /heapster\n        - --source=kubernetes:''\n        - --sink=gcl\n        - --sink=influxdb:http://monitoring-influxdb:8086\n        - --poll_duration=2m\n        - --stats_resolution=1m\n        volumeMounts:\n        - name: ssl-certs\n          mountPath: /etc/ssl/certs\n          readOnly: true\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: ssl-certs\n        hostPath:\n          path: /etc/ssl/certs\n",
    "errors": []
  },
  {
    "id": "00935",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: users-deployment\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      component: users\n  template:\n    metadata:\n      labels:\n        component: users\n    spec:\n      containers:\n      - name: users\n        image: sbalasubramanian14/users-api:stable\n        ports:\n        - containerPort: 5000\n        env:\n        - name: DATABASE_HOST\n          value: mysql-cluster-ip-service\n        - name: DATABASE_NAME\n          value: mydatabase\n        - name: DATABASE_USERNAME\n          value: root\n        - name: DATABASE_PASSWORD\n          value: admin@123\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "00936",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: users-deployment\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      component: users\n  template:\n    metadata:\n      labels:\n        component: users\n    spec:\n      containers:\n      - name: users\n        image: sbalasubramanian14/users-api:stable\n        ports:\n        - containerPort: 5000\n        env:\n        - name: DATABASE_HOST\n          value: mysql-cluster-ip-service\n        - name: DATABASE_NAME\n          value: mydatabase\n        - name: DATABASE_USERNAME\n          value: root\n        - name: DATABASE_PASSWORD\n          value: admin@123\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "00937",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: users-deployment\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      component: users\n  template:\n    metadata:\n      labels:\n        component: users\n    spec:\n      containers:\n      - name: users\n        image: sbalasubramanian14/users-api:stable\n        ports:\n        - containerPort: 5000\n        env:\n        - name: DATABASE_HOST\n          value: mysql-cluster-ip-service\n        - name: DATABASE_NAME\n          value: mydatabase\n        - name: DATABASE_USERNAME\n          value: root\n        - name: DATABASE_PASSWORD\n          value: admin@123\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "00938",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: users-deployment\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      component: users\n  template:\n    metadata:\n      labels:\n        component: users\n    spec:\n      containers:\n      - name: users\n        image: sbalasubramanian14/users-api:stable\n        ports:\n        - containerPort: 5000\n        env:\n        - name: DATABASE_HOST\n          value: mysql-cluster-ip-service\n        - name: DATABASE_NAME\n          value: mydatabase\n        - name: DATABASE_USERNAME\n          value: root\n        - name: DATABASE_PASSWORD\n          value: admin@123\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "00939",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: users-deployment\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      component: users\n  template:\n    metadata:\n      labels:\n        component: users\n    spec:\n      containers:\n      - name: users\n        image: sbalasubramanian14/users-api:stable\n        ports:\n        - containerPort: 5000\n        env:\n        - name: DATABASE_HOST\n          value: mysql-cluster-ip-service\n        - name: DATABASE_NAME\n          value: mydatabase\n        - name: DATABASE_USERNAME\n          value: root\n        - name: DATABASE_PASSWORD\n          value: admin@123\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "00940",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: cilium\n  namespace: kube-system\nspec:\n  selector:\n    matchLabels:\n      k8s-app: cilium\n      kubernetes.io/cluster-service: 'true'\n  template:\n    metadata:\n      labels:\n        k8s-app: cilium\n        kubernetes.io/cluster-service: 'true'\n      annotations:\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n        scheduler.alpha.kubernetes.io/tolerations: '[{\"key\":\"dedicated\",\"operator\":\"Equal\",\"value\":\"master\",\"effect\":\"NoSchedule\"}]'\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9090'\n    spec:\n      serviceAccountName: cilium\n      initContainers:\n      - name: clean-cilium-state\n        image: docker.io/library/busybox:1.28.4\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - if [ \"${CLEAN_CILIUM_STATE}\" = \"true\" ]; then rm -rf /var/run/cilium/state;\n          rm -rf /sys/fs/bpf/tc/globals/cilium_*; fi\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        env:\n        - name: CLEAN_CILIUM_STATE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: clean-cilium-state\n      containers:\n      - image: docker.io/cilium/cilium:stable\n        imagePullPolicy: Always\n        name: cilium-agent\n        command:\n        - cilium-agent\n        args:\n        - --debug=$(CILIUM_DEBUG)\n        - --kvstore=etcd\n        - --kvstore-opt=etcd.config=/var/lib/etcd-config/etcd.config\n        - --disable-ipv4=$(DISABLE_IPV4)\n        ports:\n        - name: prometheus\n          containerPort: 9090\n        env:\n        - name: K8S_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CILIUM_DEBUG\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: debug\n        - name: DISABLE_IPV4\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: disable-ipv4\n        - name: CILIUM_PROMETHEUS_SERVE_ADDR\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-metrics-config\n              optional: true\n              key: prometheus-serve-addr\n        - name: CILIUM_LEGACY_HOST_ALLOWS_WORLD\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: legacy-host-allows-world\n        - name: CILIUM_SIDECAR_ISTIO_PROXY_IMAGE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: sidecar-istio-proxy-image\n              optional: true\n        - name: CILIUM_TUNNEL\n          valueFrom:\n            configMapKeyRef:\n              key: tunnel\n              name: cilium-config\n              optional: true\n        - name: CILIUM_MONITOR_AGGREGATION_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              key: monitor-aggregation-level\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTERMESH_CONFIG\n          value: /var/lib/cilium/clustermesh/\n        - name: CILIUM_CLUSTER_NAME\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-name\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTER_ID\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-id\n              name: cilium-config\n              optional: true\n        livenessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 120\n          failureThreshold: 10\n          periodSeconds: 10\n        readinessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 5\n          periodSeconds: 5\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        - name: cni-path\n          mountPath: /host/opt/cni/bin\n        - name: etc-cni-netd\n          mountPath: /host/etc/cni/net.d\n        - name: docker-socket\n          mountPath: /var/run/docker.sock\n          readOnly: true\n        - name: etcd-config-path\n          mountPath: /var/lib/etcd-config\n          readOnly: true\n        - name: etcd-secrets\n          mountPath: /var/lib/etcd-secrets\n          readOnly: true\n        - name: clustermesh-secrets\n          mountPath: /var/lib/cilium/clustermesh\n          readOnly: true\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: cilium-run\n        hostPath:\n          path: /var/run/cilium\n          type: DirectoryOrCreate\n      - name: bpf-maps\n        hostPath:\n          path: /sys/fs/bpf\n          type: DirectoryOrCreate\n      - name: docker-socket\n        hostPath:\n          path: /var/run/docker.sock\n          type: Socket\n      - name: cni-path\n        hostPath:\n          path: /opt/cni/bin\n          type: DirectoryOrCreate\n      - name: etc-cni-netd\n        hostPath:\n          path: /etc/cni/net.d\n          type: DirectoryOrCreate\n      - name: etcd-config-path\n        configMap:\n          name: cilium-config\n          items:\n          - key: etcd-config\n            path: etcd.config\n      - name: etcd-secrets\n        secret:\n          secretName: cilium-etcd-secrets\n          optional: true\n      - name: clustermesh-secrets\n        secret:\n          defaultMode: 420\n          optional: true\n          secretName: cilium-clustermesh\n",
    "errors": []
  },
  {
    "id": "00941",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: cilium\n  namespace: kube-system\nspec:\n  selector:\n    matchLabels:\n      k8s-app: cilium\n      kubernetes.io/cluster-service: 'true'\n  template:\n    metadata:\n      labels:\n        k8s-app: cilium\n        kubernetes.io/cluster-service: 'true'\n      annotations:\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n        scheduler.alpha.kubernetes.io/tolerations: '[{\"key\":\"dedicated\",\"operator\":\"Equal\",\"value\":\"master\",\"effect\":\"NoSchedule\"}]'\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9090'\n    spec:\n      serviceAccountName: cilium\n      initContainers:\n      - name: clean-cilium-state\n        image: docker.io/library/busybox:1.28.4\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - if [ \"${CLEAN_CILIUM_STATE}\" = \"true\" ]; then rm -rf /var/run/cilium/state;\n          rm -rf /sys/fs/bpf/tc/globals/cilium_*; fi\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          readOnlyRootFilesystem: true\n          allowPrivilegeEscalation: false\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        env:\n        - name: CLEAN_CILIUM_STATE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: clean-cilium-state\n      containers:\n      - image: docker.io/cilium/cilium:stable\n        imagePullPolicy: Always\n        name: cilium-agent\n        command:\n        - cilium-agent\n        args:\n        - --debug=$(CILIUM_DEBUG)\n        - --kvstore=etcd\n        - --kvstore-opt=etcd.config=/var/lib/etcd-config/etcd.config\n        - --disable-ipv4=$(DISABLE_IPV4)\n        ports:\n        - name: prometheus\n          containerPort: 9090\n        env:\n        - name: K8S_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CILIUM_DEBUG\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: debug\n        - name: DISABLE_IPV4\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: disable-ipv4\n        - name: CILIUM_PROMETHEUS_SERVE_ADDR\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-metrics-config\n              optional: true\n              key: prometheus-serve-addr\n        - name: CILIUM_LEGACY_HOST_ALLOWS_WORLD\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: legacy-host-allows-world\n        - name: CILIUM_SIDECAR_ISTIO_PROXY_IMAGE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: sidecar-istio-proxy-image\n              optional: true\n        - name: CILIUM_TUNNEL\n          valueFrom:\n            configMapKeyRef:\n              key: tunnel\n              name: cilium-config\n              optional: true\n        - name: CILIUM_MONITOR_AGGREGATION_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              key: monitor-aggregation-level\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTERMESH_CONFIG\n          value: /var/lib/cilium/clustermesh/\n        - name: CILIUM_CLUSTER_NAME\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-name\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTER_ID\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-id\n              name: cilium-config\n              optional: true\n        livenessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 120\n          failureThreshold: 10\n          periodSeconds: 10\n        readinessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 5\n          periodSeconds: 5\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        - name: cni-path\n          mountPath: /host/opt/cni/bin\n        - name: etc-cni-netd\n          mountPath: /host/etc/cni/net.d\n        - name: docker-socket\n          mountPath: /var/run/docker.sock\n          readOnly: true\n        - name: etcd-config-path\n          mountPath: /var/lib/etcd-config\n          readOnly: true\n        - name: etcd-secrets\n          mountPath: /var/lib/etcd-secrets\n          readOnly: true\n        - name: clustermesh-secrets\n          mountPath: /var/lib/cilium/clustermesh\n          readOnly: true\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          readOnlyRootFilesystem: true\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: cilium-run\n        hostPath:\n          path: /var/run/cilium\n          type: DirectoryOrCreate\n      - name: bpf-maps\n        hostPath:\n          path: /sys/fs/bpf\n          type: DirectoryOrCreate\n      - name: docker-socket\n        hostPath:\n          path: /var/run/docker.sock\n          type: Socket\n      - name: cni-path\n        hostPath:\n          path: /opt/cni/bin\n          type: DirectoryOrCreate\n      - name: etc-cni-netd\n        hostPath:\n          path: /etc/cni/net.d\n          type: DirectoryOrCreate\n      - name: etcd-config-path\n        configMap:\n          name: cilium-config\n          items:\n          - key: etcd-config\n            path: etcd.config\n      - name: etcd-secrets\n        secret:\n          secretName: cilium-etcd-secrets\n          optional: true\n      - name: clustermesh-secrets\n        secret:\n          defaultMode: 420\n          optional: true\n          secretName: cilium-clustermesh\n",
    "errors": []
  },
  {
    "id": "00942",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: cilium\n  namespace: kube-system\nspec:\n  selector:\n    matchLabels:\n      k8s-app: cilium\n      kubernetes.io/cluster-service: 'true'\n  template:\n    metadata:\n      labels:\n        k8s-app: cilium\n        kubernetes.io/cluster-service: 'true'\n      annotations:\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n        scheduler.alpha.kubernetes.io/tolerations: '[{\"key\":\"dedicated\",\"operator\":\"Equal\",\"value\":\"master\",\"effect\":\"NoSchedule\"}]'\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9090'\n    spec:\n      serviceAccountName: cilium\n      initContainers:\n      - name: clean-cilium-state\n        image: docker.io/library/busybox:1.28.4\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - if [ \"${CLEAN_CILIUM_STATE}\" = \"true\" ]; then rm -rf /var/run/cilium/state;\n          rm -rf /sys/fs/bpf/tc/globals/cilium_*; fi\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          readOnlyRootFilesystem: true\n          allowPrivilegeEscalation: false\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        env:\n        - name: CLEAN_CILIUM_STATE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: clean-cilium-state\n      containers:\n      - image: docker.io/cilium/cilium:stable\n        imagePullPolicy: Always\n        name: cilium-agent\n        command:\n        - cilium-agent\n        args:\n        - --debug=$(CILIUM_DEBUG)\n        - --kvstore=etcd\n        - --kvstore-opt=etcd.config=/var/lib/etcd-config/etcd.config\n        - --disable-ipv4=$(DISABLE_IPV4)\n        ports:\n        - name: prometheus\n          containerPort: 9090\n        env:\n        - name: K8S_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CILIUM_DEBUG\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: debug\n        - name: DISABLE_IPV4\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: disable-ipv4\n        - name: CILIUM_PROMETHEUS_SERVE_ADDR\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-metrics-config\n              optional: true\n              key: prometheus-serve-addr\n        - name: CILIUM_LEGACY_HOST_ALLOWS_WORLD\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: legacy-host-allows-world\n        - name: CILIUM_SIDECAR_ISTIO_PROXY_IMAGE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: sidecar-istio-proxy-image\n              optional: true\n        - name: CILIUM_TUNNEL\n          valueFrom:\n            configMapKeyRef:\n              key: tunnel\n              name: cilium-config\n              optional: true\n        - name: CILIUM_MONITOR_AGGREGATION_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              key: monitor-aggregation-level\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTERMESH_CONFIG\n          value: /var/lib/cilium/clustermesh/\n        - name: CILIUM_CLUSTER_NAME\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-name\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTER_ID\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-id\n              name: cilium-config\n              optional: true\n        livenessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 120\n          failureThreshold: 10\n          periodSeconds: 10\n        readinessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 5\n          periodSeconds: 5\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        - name: cni-path\n          mountPath: /host/opt/cni/bin\n        - name: etc-cni-netd\n          mountPath: /host/etc/cni/net.d\n        - name: docker-socket\n          mountPath: /var/run/docker.sock\n          readOnly: true\n        - name: etcd-config-path\n          mountPath: /var/lib/etcd-config\n          readOnly: true\n        - name: etcd-secrets\n          mountPath: /var/lib/etcd-secrets\n          readOnly: true\n        - name: clustermesh-secrets\n          mountPath: /var/lib/cilium/clustermesh\n          readOnly: true\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          readOnlyRootFilesystem: true\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: cilium-run\n        hostPath:\n          path: /var/run/cilium\n          type: DirectoryOrCreate\n      - name: bpf-maps\n        hostPath:\n          path: /sys/fs/bpf\n          type: DirectoryOrCreate\n      - name: docker-socket\n        hostPath:\n          path: /var/run/docker.sock\n          type: Socket\n      - name: cni-path\n        hostPath:\n          path: /opt/cni/bin\n          type: DirectoryOrCreate\n      - name: etc-cni-netd\n        hostPath:\n          path: /etc/cni/net.d\n          type: DirectoryOrCreate\n      - name: etcd-config-path\n        configMap:\n          name: cilium-config\n          items:\n          - key: etcd-config\n            path: etcd.config\n      - name: etcd-secrets\n        secret:\n          secretName: cilium-etcd-secrets\n          optional: true\n      - name: clustermesh-secrets\n        secret:\n          defaultMode: 420\n          optional: true\n          secretName: cilium-clustermesh\n",
    "errors": []
  },
  {
    "id": "00943",
    "policy_id": "drop_capabilities",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: cilium\n  namespace: kube-system\nspec:\n  selector:\n    matchLabels:\n      k8s-app: cilium\n      kubernetes.io/cluster-service: 'true'\n  template:\n    metadata:\n      labels:\n        k8s-app: cilium\n        kubernetes.io/cluster-service: 'true'\n      annotations:\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n        scheduler.alpha.kubernetes.io/tolerations: '[{\"key\":\"dedicated\",\"operator\":\"Equal\",\"value\":\"master\",\"effect\":\"NoSchedule\"}]'\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9090'\n    spec:\n      serviceAccountName: cilium\n      initContainers:\n      - name: clean-cilium-state\n        image: docker.io/library/busybox:1.28.4\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - if [ \"${CLEAN_CILIUM_STATE}\" = \"true\" ]; then rm -rf /var/run/cilium/state;\n          rm -rf /sys/fs/bpf/tc/globals/cilium_*; fi\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        env:\n        - name: CLEAN_CILIUM_STATE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: clean-cilium-state\n      containers:\n      - image: docker.io/cilium/cilium:stable\n        imagePullPolicy: Always\n        name: cilium-agent\n        command:\n        - cilium-agent\n        args:\n        - --debug=$(CILIUM_DEBUG)\n        - --kvstore=etcd\n        - --kvstore-opt=etcd.config=/var/lib/etcd-config/etcd.config\n        - --disable-ipv4=$(DISABLE_IPV4)\n        ports:\n        - name: prometheus\n          containerPort: 9090\n        env:\n        - name: K8S_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CILIUM_DEBUG\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: debug\n        - name: DISABLE_IPV4\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: disable-ipv4\n        - name: CILIUM_PROMETHEUS_SERVE_ADDR\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-metrics-config\n              optional: true\n              key: prometheus-serve-addr\n        - name: CILIUM_LEGACY_HOST_ALLOWS_WORLD\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: legacy-host-allows-world\n        - name: CILIUM_SIDECAR_ISTIO_PROXY_IMAGE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: sidecar-istio-proxy-image\n              optional: true\n        - name: CILIUM_TUNNEL\n          valueFrom:\n            configMapKeyRef:\n              key: tunnel\n              name: cilium-config\n              optional: true\n        - name: CILIUM_MONITOR_AGGREGATION_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              key: monitor-aggregation-level\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTERMESH_CONFIG\n          value: /var/lib/cilium/clustermesh/\n        - name: CILIUM_CLUSTER_NAME\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-name\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTER_ID\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-id\n              name: cilium-config\n              optional: true\n        livenessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 120\n          failureThreshold: 10\n          periodSeconds: 10\n        readinessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 5\n          periodSeconds: 5\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        - name: cni-path\n          mountPath: /host/opt/cni/bin\n        - name: etc-cni-netd\n          mountPath: /host/etc/cni/net.d\n        - name: docker-socket\n          mountPath: /var/run/docker.sock\n          readOnly: true\n        - name: etcd-config-path\n          mountPath: /var/lib/etcd-config\n          readOnly: true\n        - name: etcd-secrets\n          mountPath: /var/lib/etcd-secrets\n          readOnly: true\n        - name: clustermesh-secrets\n          mountPath: /var/lib/cilium/clustermesh\n          readOnly: true\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: cilium-run\n        hostPath:\n          path: /var/run/cilium\n          type: DirectoryOrCreate\n      - name: bpf-maps\n        hostPath:\n          path: /sys/fs/bpf\n          type: DirectoryOrCreate\n      - name: docker-socket\n        hostPath:\n          path: /var/run/docker.sock\n          type: Socket\n      - name: cni-path\n        hostPath:\n          path: /opt/cni/bin\n          type: DirectoryOrCreate\n      - name: etc-cni-netd\n        hostPath:\n          path: /etc/cni/net.d\n          type: DirectoryOrCreate\n      - name: etcd-config-path\n        configMap:\n          name: cilium-config\n          items:\n          - key: etcd-config\n            path: etcd.config\n      - name: etcd-secrets\n        secret:\n          secretName: cilium-etcd-secrets\n          optional: true\n      - name: clustermesh-secrets\n        secret:\n          defaultMode: 420\n          optional: true\n          secretName: cilium-clustermesh\n",
    "errors": []
  },
  {
    "id": "00944",
    "policy_id": "drop_capabilities",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: cilium\n  namespace: kube-system\nspec:\n  selector:\n    matchLabels:\n      k8s-app: cilium\n      kubernetes.io/cluster-service: 'true'\n  template:\n    metadata:\n      labels:\n        k8s-app: cilium\n        kubernetes.io/cluster-service: 'true'\n      annotations:\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n        scheduler.alpha.kubernetes.io/tolerations: '[{\"key\":\"dedicated\",\"operator\":\"Equal\",\"value\":\"master\",\"effect\":\"NoSchedule\"}]'\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9090'\n    spec:\n      serviceAccountName: cilium\n      initContainers:\n      - name: clean-cilium-state\n        image: docker.io/library/busybox:1.28.4\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - if [ \"${CLEAN_CILIUM_STATE}\" = \"true\" ]; then rm -rf /var/run/cilium/state;\n          rm -rf /sys/fs/bpf/tc/globals/cilium_*; fi\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        env:\n        - name: CLEAN_CILIUM_STATE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: clean-cilium-state\n      containers:\n      - image: docker.io/cilium/cilium:stable\n        imagePullPolicy: Always\n        name: cilium-agent\n        command:\n        - cilium-agent\n        args:\n        - --debug=$(CILIUM_DEBUG)\n        - --kvstore=etcd\n        - --kvstore-opt=etcd.config=/var/lib/etcd-config/etcd.config\n        - --disable-ipv4=$(DISABLE_IPV4)\n        ports:\n        - name: prometheus\n          containerPort: 9090\n        env:\n        - name: K8S_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CILIUM_DEBUG\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: debug\n        - name: DISABLE_IPV4\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: disable-ipv4\n        - name: CILIUM_PROMETHEUS_SERVE_ADDR\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-metrics-config\n              optional: true\n              key: prometheus-serve-addr\n        - name: CILIUM_LEGACY_HOST_ALLOWS_WORLD\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: legacy-host-allows-world\n        - name: CILIUM_SIDECAR_ISTIO_PROXY_IMAGE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: sidecar-istio-proxy-image\n              optional: true\n        - name: CILIUM_TUNNEL\n          valueFrom:\n            configMapKeyRef:\n              key: tunnel\n              name: cilium-config\n              optional: true\n        - name: CILIUM_MONITOR_AGGREGATION_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              key: monitor-aggregation-level\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTERMESH_CONFIG\n          value: /var/lib/cilium/clustermesh/\n        - name: CILIUM_CLUSTER_NAME\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-name\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTER_ID\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-id\n              name: cilium-config\n              optional: true\n        livenessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 120\n          failureThreshold: 10\n          periodSeconds: 10\n        readinessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 5\n          periodSeconds: 5\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        - name: cni-path\n          mountPath: /host/opt/cni/bin\n        - name: etc-cni-netd\n          mountPath: /host/etc/cni/net.d\n        - name: docker-socket\n          mountPath: /var/run/docker.sock\n          readOnly: true\n        - name: etcd-config-path\n          mountPath: /var/lib/etcd-config\n          readOnly: true\n        - name: etcd-secrets\n          mountPath: /var/lib/etcd-secrets\n          readOnly: true\n        - name: clustermesh-secrets\n          mountPath: /var/lib/cilium/clustermesh\n          readOnly: true\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: cilium-run\n        hostPath:\n          path: /var/run/cilium\n          type: DirectoryOrCreate\n      - name: bpf-maps\n        hostPath:\n          path: /sys/fs/bpf\n          type: DirectoryOrCreate\n      - name: docker-socket\n        hostPath:\n          path: /var/run/docker.sock\n          type: Socket\n      - name: cni-path\n        hostPath:\n          path: /opt/cni/bin\n          type: DirectoryOrCreate\n      - name: etc-cni-netd\n        hostPath:\n          path: /etc/cni/net.d\n          type: DirectoryOrCreate\n      - name: etcd-config-path\n        configMap:\n          name: cilium-config\n          items:\n          - key: etcd-config\n            path: etcd.config\n      - name: etcd-secrets\n        secret:\n          secretName: cilium-etcd-secrets\n          optional: true\n      - name: clustermesh-secrets\n        secret:\n          defaultMode: 420\n          optional: true\n          secretName: cilium-clustermesh\n",
    "errors": []
  },
  {
    "id": "00945",
    "policy_id": "no_privileged",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: cilium\n  namespace: kube-system\nspec:\n  selector:\n    matchLabels:\n      k8s-app: cilium\n      kubernetes.io/cluster-service: 'true'\n  template:\n    metadata:\n      labels:\n        k8s-app: cilium\n        kubernetes.io/cluster-service: 'true'\n      annotations:\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n        scheduler.alpha.kubernetes.io/tolerations: '[{\"key\":\"dedicated\",\"operator\":\"Equal\",\"value\":\"master\",\"effect\":\"NoSchedule\"}]'\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9090'\n    spec:\n      serviceAccountName: cilium\n      initContainers:\n      - name: clean-cilium-state\n        image: docker.io/library/busybox:1.28.4\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - if [ \"${CLEAN_CILIUM_STATE}\" = \"true\" ]; then rm -rf /var/run/cilium/state;\n          rm -rf /sys/fs/bpf/tc/globals/cilium_*; fi\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        env:\n        - name: CLEAN_CILIUM_STATE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: clean-cilium-state\n      containers:\n      - image: docker.io/cilium/cilium:stable\n        imagePullPolicy: Always\n        name: cilium-agent\n        command:\n        - cilium-agent\n        args:\n        - --debug=$(CILIUM_DEBUG)\n        - --kvstore=etcd\n        - --kvstore-opt=etcd.config=/var/lib/etcd-config/etcd.config\n        - --disable-ipv4=$(DISABLE_IPV4)\n        ports:\n        - name: prometheus\n          containerPort: 9090\n        env:\n        - name: K8S_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CILIUM_DEBUG\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: debug\n        - name: DISABLE_IPV4\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: disable-ipv4\n        - name: CILIUM_PROMETHEUS_SERVE_ADDR\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-metrics-config\n              optional: true\n              key: prometheus-serve-addr\n        - name: CILIUM_LEGACY_HOST_ALLOWS_WORLD\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: legacy-host-allows-world\n        - name: CILIUM_SIDECAR_ISTIO_PROXY_IMAGE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: sidecar-istio-proxy-image\n              optional: true\n        - name: CILIUM_TUNNEL\n          valueFrom:\n            configMapKeyRef:\n              key: tunnel\n              name: cilium-config\n              optional: true\n        - name: CILIUM_MONITOR_AGGREGATION_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              key: monitor-aggregation-level\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTERMESH_CONFIG\n          value: /var/lib/cilium/clustermesh/\n        - name: CILIUM_CLUSTER_NAME\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-name\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTER_ID\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-id\n              name: cilium-config\n              optional: true\n        livenessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 120\n          failureThreshold: 10\n          periodSeconds: 10\n        readinessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 5\n          periodSeconds: 5\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        - name: cni-path\n          mountPath: /host/opt/cni/bin\n        - name: etc-cni-netd\n          mountPath: /host/etc/cni/net.d\n        - name: docker-socket\n          mountPath: /var/run/docker.sock\n          readOnly: true\n        - name: etcd-config-path\n          mountPath: /var/lib/etcd-config\n          readOnly: true\n        - name: etcd-secrets\n          mountPath: /var/lib/etcd-secrets\n          readOnly: true\n        - name: clustermesh-secrets\n          mountPath: /var/lib/cilium/clustermesh\n          readOnly: true\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: cilium-run\n        hostPath:\n          path: /var/run/cilium\n          type: DirectoryOrCreate\n      - name: bpf-maps\n        hostPath:\n          path: /sys/fs/bpf\n          type: DirectoryOrCreate\n      - name: docker-socket\n        hostPath:\n          path: /var/run/docker.sock\n          type: Socket\n      - name: cni-path\n        hostPath:\n          path: /opt/cni/bin\n          type: DirectoryOrCreate\n      - name: etc-cni-netd\n        hostPath:\n          path: /etc/cni/net.d\n          type: DirectoryOrCreate\n      - name: etcd-config-path\n        configMap:\n          name: cilium-config\n          items:\n          - key: etcd-config\n            path: etcd.config\n      - name: etcd-secrets\n        secret:\n          secretName: cilium-etcd-secrets\n          optional: true\n      - name: clustermesh-secrets\n        secret:\n          defaultMode: 420\n          optional: true\n          secretName: cilium-clustermesh\n",
    "errors": []
  },
  {
    "id": "00946",
    "policy_id": "no_privileged",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: cilium\n  namespace: kube-system\nspec:\n  selector:\n    matchLabels:\n      k8s-app: cilium\n      kubernetes.io/cluster-service: 'true'\n  template:\n    metadata:\n      labels:\n        k8s-app: cilium\n        kubernetes.io/cluster-service: 'true'\n      annotations:\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n        scheduler.alpha.kubernetes.io/tolerations: '[{\"key\":\"dedicated\",\"operator\":\"Equal\",\"value\":\"master\",\"effect\":\"NoSchedule\"}]'\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9090'\n    spec:\n      serviceAccountName: cilium\n      initContainers:\n      - name: clean-cilium-state\n        image: docker.io/library/busybox:1.28.4\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - if [ \"${CLEAN_CILIUM_STATE}\" = \"true\" ]; then rm -rf /var/run/cilium/state;\n          rm -rf /sys/fs/bpf/tc/globals/cilium_*; fi\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        env:\n        - name: CLEAN_CILIUM_STATE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: clean-cilium-state\n      containers:\n      - image: docker.io/cilium/cilium:stable\n        imagePullPolicy: Always\n        name: cilium-agent\n        command:\n        - cilium-agent\n        args:\n        - --debug=$(CILIUM_DEBUG)\n        - --kvstore=etcd\n        - --kvstore-opt=etcd.config=/var/lib/etcd-config/etcd.config\n        - --disable-ipv4=$(DISABLE_IPV4)\n        ports:\n        - name: prometheus\n          containerPort: 9090\n        env:\n        - name: K8S_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CILIUM_DEBUG\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: debug\n        - name: DISABLE_IPV4\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: disable-ipv4\n        - name: CILIUM_PROMETHEUS_SERVE_ADDR\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-metrics-config\n              optional: true\n              key: prometheus-serve-addr\n        - name: CILIUM_LEGACY_HOST_ALLOWS_WORLD\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: legacy-host-allows-world\n        - name: CILIUM_SIDECAR_ISTIO_PROXY_IMAGE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: sidecar-istio-proxy-image\n              optional: true\n        - name: CILIUM_TUNNEL\n          valueFrom:\n            configMapKeyRef:\n              key: tunnel\n              name: cilium-config\n              optional: true\n        - name: CILIUM_MONITOR_AGGREGATION_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              key: monitor-aggregation-level\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTERMESH_CONFIG\n          value: /var/lib/cilium/clustermesh/\n        - name: CILIUM_CLUSTER_NAME\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-name\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTER_ID\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-id\n              name: cilium-config\n              optional: true\n        livenessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 120\n          failureThreshold: 10\n          periodSeconds: 10\n        readinessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 5\n          periodSeconds: 5\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        - name: cni-path\n          mountPath: /host/opt/cni/bin\n        - name: etc-cni-netd\n          mountPath: /host/etc/cni/net.d\n        - name: docker-socket\n          mountPath: /var/run/docker.sock\n          readOnly: true\n        - name: etcd-config-path\n          mountPath: /var/lib/etcd-config\n          readOnly: true\n        - name: etcd-secrets\n          mountPath: /var/lib/etcd-secrets\n          readOnly: true\n        - name: clustermesh-secrets\n          mountPath: /var/lib/cilium/clustermesh\n          readOnly: true\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: cilium-run\n        hostPath:\n          path: /var/run/cilium\n          type: DirectoryOrCreate\n      - name: bpf-maps\n        hostPath:\n          path: /sys/fs/bpf\n          type: DirectoryOrCreate\n      - name: docker-socket\n        hostPath:\n          path: /var/run/docker.sock\n          type: Socket\n      - name: cni-path\n        hostPath:\n          path: /opt/cni/bin\n          type: DirectoryOrCreate\n      - name: etc-cni-netd\n        hostPath:\n          path: /etc/cni/net.d\n          type: DirectoryOrCreate\n      - name: etcd-config-path\n        configMap:\n          name: cilium-config\n          items:\n          - key: etcd-config\n            path: etcd.config\n      - name: etcd-secrets\n        secret:\n          secretName: cilium-etcd-secrets\n          optional: true\n      - name: clustermesh-secrets\n        secret:\n          defaultMode: 420\n          optional: true\n          secretName: cilium-clustermesh\n",
    "errors": []
  },
  {
    "id": "00947",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: cilium\n  namespace: kube-system\nspec:\n  selector:\n    matchLabels:\n      k8s-app: cilium\n      kubernetes.io/cluster-service: 'true'\n  template:\n    metadata:\n      labels:\n        k8s-app: cilium\n        kubernetes.io/cluster-service: 'true'\n      annotations:\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n        scheduler.alpha.kubernetes.io/tolerations: '[{\"key\":\"dedicated\",\"operator\":\"Equal\",\"value\":\"master\",\"effect\":\"NoSchedule\"}]'\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9090'\n    spec:\n      serviceAccountName: cilium\n      initContainers:\n      - name: clean-cilium-state\n        image: docker.io/library/busybox:1.28.4\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - if [ \"${CLEAN_CILIUM_STATE}\" = \"true\" ]; then rm -rf /var/run/cilium/state;\n          rm -rf /sys/fs/bpf/tc/globals/cilium_*; fi\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          runAsNonRoot: true\n          allowPrivilegeEscalation: false\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        env:\n        - name: CLEAN_CILIUM_STATE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: clean-cilium-state\n      containers:\n      - image: docker.io/cilium/cilium:stable\n        imagePullPolicy: Always\n        name: cilium-agent\n        command:\n        - cilium-agent\n        args:\n        - --debug=$(CILIUM_DEBUG)\n        - --kvstore=etcd\n        - --kvstore-opt=etcd.config=/var/lib/etcd-config/etcd.config\n        - --disable-ipv4=$(DISABLE_IPV4)\n        ports:\n        - name: prometheus\n          containerPort: 9090\n        env:\n        - name: K8S_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CILIUM_DEBUG\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: debug\n        - name: DISABLE_IPV4\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: disable-ipv4\n        - name: CILIUM_PROMETHEUS_SERVE_ADDR\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-metrics-config\n              optional: true\n              key: prometheus-serve-addr\n        - name: CILIUM_LEGACY_HOST_ALLOWS_WORLD\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: legacy-host-allows-world\n        - name: CILIUM_SIDECAR_ISTIO_PROXY_IMAGE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: sidecar-istio-proxy-image\n              optional: true\n        - name: CILIUM_TUNNEL\n          valueFrom:\n            configMapKeyRef:\n              key: tunnel\n              name: cilium-config\n              optional: true\n        - name: CILIUM_MONITOR_AGGREGATION_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              key: monitor-aggregation-level\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTERMESH_CONFIG\n          value: /var/lib/cilium/clustermesh/\n        - name: CILIUM_CLUSTER_NAME\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-name\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTER_ID\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-id\n              name: cilium-config\n              optional: true\n        livenessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 120\n          failureThreshold: 10\n          periodSeconds: 10\n        readinessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 5\n          periodSeconds: 5\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        - name: cni-path\n          mountPath: /host/opt/cni/bin\n        - name: etc-cni-netd\n          mountPath: /host/etc/cni/net.d\n        - name: docker-socket\n          mountPath: /var/run/docker.sock\n          readOnly: true\n        - name: etcd-config-path\n          mountPath: /var/lib/etcd-config\n          readOnly: true\n        - name: etcd-secrets\n          mountPath: /var/lib/etcd-secrets\n          readOnly: true\n        - name: clustermesh-secrets\n          mountPath: /var/lib/cilium/clustermesh\n          readOnly: true\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          runAsNonRoot: true\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: cilium-run\n        hostPath:\n          path: /var/run/cilium\n          type: DirectoryOrCreate\n      - name: bpf-maps\n        hostPath:\n          path: /sys/fs/bpf\n          type: DirectoryOrCreate\n      - name: docker-socket\n        hostPath:\n          path: /var/run/docker.sock\n          type: Socket\n      - name: cni-path\n        hostPath:\n          path: /opt/cni/bin\n          type: DirectoryOrCreate\n      - name: etc-cni-netd\n        hostPath:\n          path: /etc/cni/net.d\n          type: DirectoryOrCreate\n      - name: etcd-config-path\n        configMap:\n          name: cilium-config\n          items:\n          - key: etcd-config\n            path: etcd.config\n      - name: etcd-secrets\n        secret:\n          secretName: cilium-etcd-secrets\n          optional: true\n      - name: clustermesh-secrets\n        secret:\n          defaultMode: 420\n          optional: true\n          secretName: cilium-clustermesh\n",
    "errors": []
  },
  {
    "id": "00948",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: cilium\n  namespace: kube-system\nspec:\n  selector:\n    matchLabels:\n      k8s-app: cilium\n      kubernetes.io/cluster-service: 'true'\n  template:\n    metadata:\n      labels:\n        k8s-app: cilium\n        kubernetes.io/cluster-service: 'true'\n      annotations:\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n        scheduler.alpha.kubernetes.io/tolerations: '[{\"key\":\"dedicated\",\"operator\":\"Equal\",\"value\":\"master\",\"effect\":\"NoSchedule\"}]'\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9090'\n    spec:\n      serviceAccountName: cilium\n      initContainers:\n      - name: clean-cilium-state\n        image: docker.io/library/busybox:1.28.4\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - if [ \"${CLEAN_CILIUM_STATE}\" = \"true\" ]; then rm -rf /var/run/cilium/state;\n          rm -rf /sys/fs/bpf/tc/globals/cilium_*; fi\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          runAsNonRoot: true\n          allowPrivilegeEscalation: false\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        env:\n        - name: CLEAN_CILIUM_STATE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: clean-cilium-state\n      containers:\n      - image: docker.io/cilium/cilium:stable\n        imagePullPolicy: Always\n        name: cilium-agent\n        command:\n        - cilium-agent\n        args:\n        - --debug=$(CILIUM_DEBUG)\n        - --kvstore=etcd\n        - --kvstore-opt=etcd.config=/var/lib/etcd-config/etcd.config\n        - --disable-ipv4=$(DISABLE_IPV4)\n        ports:\n        - name: prometheus\n          containerPort: 9090\n        env:\n        - name: K8S_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CILIUM_DEBUG\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: debug\n        - name: DISABLE_IPV4\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: disable-ipv4\n        - name: CILIUM_PROMETHEUS_SERVE_ADDR\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-metrics-config\n              optional: true\n              key: prometheus-serve-addr\n        - name: CILIUM_LEGACY_HOST_ALLOWS_WORLD\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: legacy-host-allows-world\n        - name: CILIUM_SIDECAR_ISTIO_PROXY_IMAGE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: sidecar-istio-proxy-image\n              optional: true\n        - name: CILIUM_TUNNEL\n          valueFrom:\n            configMapKeyRef:\n              key: tunnel\n              name: cilium-config\n              optional: true\n        - name: CILIUM_MONITOR_AGGREGATION_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              key: monitor-aggregation-level\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTERMESH_CONFIG\n          value: /var/lib/cilium/clustermesh/\n        - name: CILIUM_CLUSTER_NAME\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-name\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTER_ID\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-id\n              name: cilium-config\n              optional: true\n        livenessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 120\n          failureThreshold: 10\n          periodSeconds: 10\n        readinessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 5\n          periodSeconds: 5\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        - name: cni-path\n          mountPath: /host/opt/cni/bin\n        - name: etc-cni-netd\n          mountPath: /host/etc/cni/net.d\n        - name: docker-socket\n          mountPath: /var/run/docker.sock\n          readOnly: true\n        - name: etcd-config-path\n          mountPath: /var/lib/etcd-config\n          readOnly: true\n        - name: etcd-secrets\n          mountPath: /var/lib/etcd-secrets\n          readOnly: true\n        - name: clustermesh-secrets\n          mountPath: /var/lib/cilium/clustermesh\n          readOnly: true\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          runAsNonRoot: true\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: cilium-run\n        hostPath:\n          path: /var/run/cilium\n          type: DirectoryOrCreate\n      - name: bpf-maps\n        hostPath:\n          path: /sys/fs/bpf\n          type: DirectoryOrCreate\n      - name: docker-socket\n        hostPath:\n          path: /var/run/docker.sock\n          type: Socket\n      - name: cni-path\n        hostPath:\n          path: /opt/cni/bin\n          type: DirectoryOrCreate\n      - name: etc-cni-netd\n        hostPath:\n          path: /etc/cni/net.d\n          type: DirectoryOrCreate\n      - name: etcd-config-path\n        configMap:\n          name: cilium-config\n          items:\n          - key: etcd-config\n            path: etcd.config\n      - name: etcd-secrets\n        secret:\n          secretName: cilium-etcd-secrets\n          optional: true\n      - name: clustermesh-secrets\n        secret:\n          defaultMode: 420\n          optional: true\n          secretName: cilium-clustermesh\n",
    "errors": []
  },
  {
    "id": "00949",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: cilium\n  namespace: kube-system\nspec:\n  selector:\n    matchLabels:\n      k8s-app: cilium\n      kubernetes.io/cluster-service: 'true'\n  template:\n    metadata:\n      labels:\n        k8s-app: cilium\n        kubernetes.io/cluster-service: 'true'\n      annotations:\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n        scheduler.alpha.kubernetes.io/tolerations: '[{\"key\":\"dedicated\",\"operator\":\"Equal\",\"value\":\"master\",\"effect\":\"NoSchedule\"}]'\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9090'\n    spec:\n      serviceAccountName: cilium\n      initContainers:\n      - name: clean-cilium-state\n        image: docker.io/library/busybox:1.28.4\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - if [ \"${CLEAN_CILIUM_STATE}\" = \"true\" ]; then rm -rf /var/run/cilium/state;\n          rm -rf /sys/fs/bpf/tc/globals/cilium_*; fi\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        env:\n        - name: CLEAN_CILIUM_STATE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: clean-cilium-state\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      containers:\n      - image: docker.io/cilium/cilium:stable\n        imagePullPolicy: Always\n        name: cilium-agent\n        command:\n        - cilium-agent\n        args:\n        - --debug=$(CILIUM_DEBUG)\n        - --kvstore=etcd\n        - --kvstore-opt=etcd.config=/var/lib/etcd-config/etcd.config\n        - --disable-ipv4=$(DISABLE_IPV4)\n        ports:\n        - name: prometheus\n          containerPort: 9090\n        env:\n        - name: K8S_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CILIUM_DEBUG\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: debug\n        - name: DISABLE_IPV4\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: disable-ipv4\n        - name: CILIUM_PROMETHEUS_SERVE_ADDR\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-metrics-config\n              optional: true\n              key: prometheus-serve-addr\n        - name: CILIUM_LEGACY_HOST_ALLOWS_WORLD\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: legacy-host-allows-world\n        - name: CILIUM_SIDECAR_ISTIO_PROXY_IMAGE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: sidecar-istio-proxy-image\n              optional: true\n        - name: CILIUM_TUNNEL\n          valueFrom:\n            configMapKeyRef:\n              key: tunnel\n              name: cilium-config\n              optional: true\n        - name: CILIUM_MONITOR_AGGREGATION_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              key: monitor-aggregation-level\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTERMESH_CONFIG\n          value: /var/lib/cilium/clustermesh/\n        - name: CILIUM_CLUSTER_NAME\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-name\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTER_ID\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-id\n              name: cilium-config\n              optional: true\n        livenessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 120\n          failureThreshold: 10\n          periodSeconds: 10\n        readinessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 5\n          periodSeconds: 5\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        - name: cni-path\n          mountPath: /host/opt/cni/bin\n        - name: etc-cni-netd\n          mountPath: /host/etc/cni/net.d\n        - name: docker-socket\n          mountPath: /var/run/docker.sock\n          readOnly: true\n        - name: etcd-config-path\n          mountPath: /var/lib/etcd-config\n          readOnly: true\n        - name: etcd-secrets\n          mountPath: /var/lib/etcd-secrets\n          readOnly: true\n        - name: clustermesh-secrets\n          mountPath: /var/lib/cilium/clustermesh\n          readOnly: true\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: cilium-run\n        hostPath:\n          path: /var/run/cilium\n          type: DirectoryOrCreate\n      - name: bpf-maps\n        hostPath:\n          path: /sys/fs/bpf\n          type: DirectoryOrCreate\n      - name: docker-socket\n        hostPath:\n          path: /var/run/docker.sock\n          type: Socket\n      - name: cni-path\n        hostPath:\n          path: /opt/cni/bin\n          type: DirectoryOrCreate\n      - name: etc-cni-netd\n        hostPath:\n          path: /etc/cni/net.d\n          type: DirectoryOrCreate\n      - name: etcd-config-path\n        configMap:\n          name: cilium-config\n          items:\n          - key: etcd-config\n            path: etcd.config\n      - name: etcd-secrets\n        secret:\n          secretName: cilium-etcd-secrets\n          optional: true\n      - name: clustermesh-secrets\n        secret:\n          defaultMode: 420\n          optional: true\n          secretName: cilium-clustermesh\n",
    "errors": []
  },
  {
    "id": "00950",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: cilium\n  namespace: kube-system\nspec:\n  selector:\n    matchLabels:\n      k8s-app: cilium\n      kubernetes.io/cluster-service: 'true'\n  template:\n    metadata:\n      labels:\n        k8s-app: cilium\n        kubernetes.io/cluster-service: 'true'\n      annotations:\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n        scheduler.alpha.kubernetes.io/tolerations: '[{\"key\":\"dedicated\",\"operator\":\"Equal\",\"value\":\"master\",\"effect\":\"NoSchedule\"}]'\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9090'\n    spec:\n      serviceAccountName: cilium\n      initContainers:\n      - name: clean-cilium-state\n        image: docker.io/library/busybox:1.28.4\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - if [ \"${CLEAN_CILIUM_STATE}\" = \"true\" ]; then rm -rf /var/run/cilium/state;\n          rm -rf /sys/fs/bpf/tc/globals/cilium_*; fi\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        env:\n        - name: CLEAN_CILIUM_STATE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: clean-cilium-state\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      containers:\n      - image: docker.io/cilium/cilium:stable\n        imagePullPolicy: Always\n        name: cilium-agent\n        command:\n        - cilium-agent\n        args:\n        - --debug=$(CILIUM_DEBUG)\n        - --kvstore=etcd\n        - --kvstore-opt=etcd.config=/var/lib/etcd-config/etcd.config\n        - --disable-ipv4=$(DISABLE_IPV4)\n        ports:\n        - name: prometheus\n          containerPort: 9090\n        env:\n        - name: K8S_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CILIUM_DEBUG\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: debug\n        - name: DISABLE_IPV4\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: disable-ipv4\n        - name: CILIUM_PROMETHEUS_SERVE_ADDR\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-metrics-config\n              optional: true\n              key: prometheus-serve-addr\n        - name: CILIUM_LEGACY_HOST_ALLOWS_WORLD\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: legacy-host-allows-world\n        - name: CILIUM_SIDECAR_ISTIO_PROXY_IMAGE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: sidecar-istio-proxy-image\n              optional: true\n        - name: CILIUM_TUNNEL\n          valueFrom:\n            configMapKeyRef:\n              key: tunnel\n              name: cilium-config\n              optional: true\n        - name: CILIUM_MONITOR_AGGREGATION_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              key: monitor-aggregation-level\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTERMESH_CONFIG\n          value: /var/lib/cilium/clustermesh/\n        - name: CILIUM_CLUSTER_NAME\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-name\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTER_ID\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-id\n              name: cilium-config\n              optional: true\n        livenessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 120\n          failureThreshold: 10\n          periodSeconds: 10\n        readinessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 5\n          periodSeconds: 5\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        - name: cni-path\n          mountPath: /host/opt/cni/bin\n        - name: etc-cni-netd\n          mountPath: /host/etc/cni/net.d\n        - name: docker-socket\n          mountPath: /var/run/docker.sock\n          readOnly: true\n        - name: etcd-config-path\n          mountPath: /var/lib/etcd-config\n          readOnly: true\n        - name: etcd-secrets\n          mountPath: /var/lib/etcd-secrets\n          readOnly: true\n        - name: clustermesh-secrets\n          mountPath: /var/lib/cilium/clustermesh\n          readOnly: true\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: cilium-run\n        hostPath:\n          path: /var/run/cilium\n          type: DirectoryOrCreate\n      - name: bpf-maps\n        hostPath:\n          path: /sys/fs/bpf\n          type: DirectoryOrCreate\n      - name: docker-socket\n        hostPath:\n          path: /var/run/docker.sock\n          type: Socket\n      - name: cni-path\n        hostPath:\n          path: /opt/cni/bin\n          type: DirectoryOrCreate\n      - name: etc-cni-netd\n        hostPath:\n          path: /etc/cni/net.d\n          type: DirectoryOrCreate\n      - name: etcd-config-path\n        configMap:\n          name: cilium-config\n          items:\n          - key: etcd-config\n            path: etcd.config\n      - name: etcd-secrets\n        secret:\n          secretName: cilium-etcd-secrets\n          optional: true\n      - name: clustermesh-secrets\n        secret:\n          defaultMode: 420\n          optional: true\n          secretName: cilium-clustermesh\n",
    "errors": []
  },
  {
    "id": "00951",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: cilium\n  namespace: kube-system\nspec:\n  selector:\n    matchLabels:\n      k8s-app: cilium\n      kubernetes.io/cluster-service: 'true'\n  template:\n    metadata:\n      labels:\n        k8s-app: cilium\n        kubernetes.io/cluster-service: 'true'\n      annotations:\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n        scheduler.alpha.kubernetes.io/tolerations: '[{\"key\":\"dedicated\",\"operator\":\"Equal\",\"value\":\"master\",\"effect\":\"NoSchedule\"}]'\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9090'\n    spec:\n      serviceAccountName: cilium\n      initContainers:\n      - name: clean-cilium-state\n        image: docker.io/library/busybox:1.28.4\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - if [ \"${CLEAN_CILIUM_STATE}\" = \"true\" ]; then rm -rf /var/run/cilium/state;\n          rm -rf /sys/fs/bpf/tc/globals/cilium_*; fi\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        env:\n        - name: CLEAN_CILIUM_STATE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: clean-cilium-state\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      containers:\n      - image: docker.io/cilium/cilium:stable\n        imagePullPolicy: Always\n        name: cilium-agent\n        command:\n        - cilium-agent\n        args:\n        - --debug=$(CILIUM_DEBUG)\n        - --kvstore=etcd\n        - --kvstore-opt=etcd.config=/var/lib/etcd-config/etcd.config\n        - --disable-ipv4=$(DISABLE_IPV4)\n        ports:\n        - name: prometheus\n          containerPort: 9090\n        env:\n        - name: K8S_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CILIUM_DEBUG\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: debug\n        - name: DISABLE_IPV4\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: disable-ipv4\n        - name: CILIUM_PROMETHEUS_SERVE_ADDR\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-metrics-config\n              optional: true\n              key: prometheus-serve-addr\n        - name: CILIUM_LEGACY_HOST_ALLOWS_WORLD\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: legacy-host-allows-world\n        - name: CILIUM_SIDECAR_ISTIO_PROXY_IMAGE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: sidecar-istio-proxy-image\n              optional: true\n        - name: CILIUM_TUNNEL\n          valueFrom:\n            configMapKeyRef:\n              key: tunnel\n              name: cilium-config\n              optional: true\n        - name: CILIUM_MONITOR_AGGREGATION_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              key: monitor-aggregation-level\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTERMESH_CONFIG\n          value: /var/lib/cilium/clustermesh/\n        - name: CILIUM_CLUSTER_NAME\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-name\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTER_ID\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-id\n              name: cilium-config\n              optional: true\n        livenessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 120\n          failureThreshold: 10\n          periodSeconds: 10\n        readinessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 5\n          periodSeconds: 5\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        - name: cni-path\n          mountPath: /host/opt/cni/bin\n        - name: etc-cni-netd\n          mountPath: /host/etc/cni/net.d\n        - name: docker-socket\n          mountPath: /var/run/docker.sock\n          readOnly: true\n        - name: etcd-config-path\n          mountPath: /var/lib/etcd-config\n          readOnly: true\n        - name: etcd-secrets\n          mountPath: /var/lib/etcd-secrets\n          readOnly: true\n        - name: clustermesh-secrets\n          mountPath: /var/lib/cilium/clustermesh\n          readOnly: true\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: cilium-run\n        hostPath:\n          path: /var/run/cilium\n          type: DirectoryOrCreate\n      - name: bpf-maps\n        hostPath:\n          path: /sys/fs/bpf\n          type: DirectoryOrCreate\n      - name: docker-socket\n        hostPath:\n          path: /var/run/docker.sock\n          type: Socket\n      - name: cni-path\n        hostPath:\n          path: /opt/cni/bin\n          type: DirectoryOrCreate\n      - name: etc-cni-netd\n        hostPath:\n          path: /etc/cni/net.d\n          type: DirectoryOrCreate\n      - name: etcd-config-path\n        configMap:\n          name: cilium-config\n          items:\n          - key: etcd-config\n            path: etcd.config\n      - name: etcd-secrets\n        secret:\n          secretName: cilium-etcd-secrets\n          optional: true\n      - name: clustermesh-secrets\n        secret:\n          defaultMode: 420\n          optional: true\n          secretName: cilium-clustermesh\n",
    "errors": []
  },
  {
    "id": "00952",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: cilium\n  namespace: kube-system\nspec:\n  selector:\n    matchLabels:\n      k8s-app: cilium\n      kubernetes.io/cluster-service: 'true'\n  template:\n    metadata:\n      labels:\n        k8s-app: cilium\n        kubernetes.io/cluster-service: 'true'\n      annotations:\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n        scheduler.alpha.kubernetes.io/tolerations: '[{\"key\":\"dedicated\",\"operator\":\"Equal\",\"value\":\"master\",\"effect\":\"NoSchedule\"}]'\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9090'\n    spec:\n      serviceAccountName: cilium\n      initContainers:\n      - name: clean-cilium-state\n        image: docker.io/library/busybox:1.28.4\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - if [ \"${CLEAN_CILIUM_STATE}\" = \"true\" ]; then rm -rf /var/run/cilium/state;\n          rm -rf /sys/fs/bpf/tc/globals/cilium_*; fi\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        env:\n        - name: CLEAN_CILIUM_STATE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: clean-cilium-state\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      containers:\n      - image: docker.io/cilium/cilium:stable\n        imagePullPolicy: Always\n        name: cilium-agent\n        command:\n        - cilium-agent\n        args:\n        - --debug=$(CILIUM_DEBUG)\n        - --kvstore=etcd\n        - --kvstore-opt=etcd.config=/var/lib/etcd-config/etcd.config\n        - --disable-ipv4=$(DISABLE_IPV4)\n        ports:\n        - name: prometheus\n          containerPort: 9090\n        env:\n        - name: K8S_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CILIUM_DEBUG\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: debug\n        - name: DISABLE_IPV4\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: disable-ipv4\n        - name: CILIUM_PROMETHEUS_SERVE_ADDR\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-metrics-config\n              optional: true\n              key: prometheus-serve-addr\n        - name: CILIUM_LEGACY_HOST_ALLOWS_WORLD\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: legacy-host-allows-world\n        - name: CILIUM_SIDECAR_ISTIO_PROXY_IMAGE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: sidecar-istio-proxy-image\n              optional: true\n        - name: CILIUM_TUNNEL\n          valueFrom:\n            configMapKeyRef:\n              key: tunnel\n              name: cilium-config\n              optional: true\n        - name: CILIUM_MONITOR_AGGREGATION_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              key: monitor-aggregation-level\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTERMESH_CONFIG\n          value: /var/lib/cilium/clustermesh/\n        - name: CILIUM_CLUSTER_NAME\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-name\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTER_ID\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-id\n              name: cilium-config\n              optional: true\n        livenessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 120\n          failureThreshold: 10\n          periodSeconds: 10\n        readinessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 5\n          periodSeconds: 5\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        - name: cni-path\n          mountPath: /host/opt/cni/bin\n        - name: etc-cni-netd\n          mountPath: /host/etc/cni/net.d\n        - name: docker-socket\n          mountPath: /var/run/docker.sock\n          readOnly: true\n        - name: etcd-config-path\n          mountPath: /var/lib/etcd-config\n          readOnly: true\n        - name: etcd-secrets\n          mountPath: /var/lib/etcd-secrets\n          readOnly: true\n        - name: clustermesh-secrets\n          mountPath: /var/lib/cilium/clustermesh\n          readOnly: true\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: cilium-run\n        hostPath:\n          path: /var/run/cilium\n          type: DirectoryOrCreate\n      - name: bpf-maps\n        hostPath:\n          path: /sys/fs/bpf\n          type: DirectoryOrCreate\n      - name: docker-socket\n        hostPath:\n          path: /var/run/docker.sock\n          type: Socket\n      - name: cni-path\n        hostPath:\n          path: /opt/cni/bin\n          type: DirectoryOrCreate\n      - name: etc-cni-netd\n        hostPath:\n          path: /etc/cni/net.d\n          type: DirectoryOrCreate\n      - name: etcd-config-path\n        configMap:\n          name: cilium-config\n          items:\n          - key: etcd-config\n            path: etcd.config\n      - name: etcd-secrets\n        secret:\n          secretName: cilium-etcd-secrets\n          optional: true\n      - name: clustermesh-secrets\n        secret:\n          defaultMode: 420\n          optional: true\n          secretName: cilium-clustermesh\n",
    "errors": []
  },
  {
    "id": "00953",
    "policy_id": "env_var_secret",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: kurl-proxy\n  labels:\n    app: kurl-proxy\nspec:\n  selector:\n    matchLabels:\n      app: kurl-proxy\n  template:\n    metadata:\n      labels:\n        app: kurl-proxy\n    spec:\n      containers:\n      - name: proxy\n        image: kurl/proxy:stable\n        env:\n        - name: NODE_PORT\n          value: '30880'\n        - name: UPSTREAM_ORIGIN\n          value: http://127.0.0.1:8800\n        - name: TLS_SECRET_NAME\n          valueFrom:\n            secretKeyRef:\n              name: tls-secret-name-secret\n              key: tls_secret_name\n        - name: NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        volumeMounts:\n        - name: kotsadm-config\n          mountPath: /etc/kotsadm\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n      serviceAccount: kurl-proxy\n      volumes:\n      - name: kotsadm-config\n        configMap:\n          name: kotsadm-application-metadata\n          optional: true\n",
    "errors": []
  },
  {
    "id": "00954",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: kurl-proxy\n  labels:\n    app: kurl-proxy\nspec:\n  selector:\n    matchLabels:\n      app: kurl-proxy\n  template:\n    metadata:\n      labels:\n        app: kurl-proxy\n    spec:\n      containers:\n      - name: proxy\n        image: kurl/proxy:stable\n        env:\n        - name: NODE_PORT\n          value: '30880'\n        - name: UPSTREAM_ORIGIN\n          value: http://127.0.0.1:8800\n        - name: TLS_SECRET_NAME\n          value: kotsadm-tls\n        - name: NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        volumeMounts:\n        - name: kotsadm-config\n          mountPath: /etc/kotsadm\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n      serviceAccount: kurl-proxy\n      volumes:\n      - name: kotsadm-config\n        configMap:\n          name: kotsadm-application-metadata\n          optional: true\n",
    "errors": []
  },
  {
    "id": "00955",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: kurl-proxy\n  labels:\n    app: kurl-proxy\nspec:\n  selector:\n    matchLabels:\n      app: kurl-proxy\n  template:\n    metadata:\n      labels:\n        app: kurl-proxy\n    spec:\n      containers:\n      - name: proxy\n        image: kurl/proxy:stable\n        env:\n        - name: NODE_PORT\n          value: '30880'\n        - name: UPSTREAM_ORIGIN\n          value: http://127.0.0.1:8800\n        - name: TLS_SECRET_NAME\n          value: kotsadm-tls\n        - name: NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        volumeMounts:\n        - name: kotsadm-config\n          mountPath: /etc/kotsadm\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      serviceAccount: kurl-proxy\n      volumes:\n      - name: kotsadm-config\n        configMap:\n          name: kotsadm-application-metadata\n          optional: true\n",
    "errors": []
  },
  {
    "id": "00956",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: kurl-proxy\n  labels:\n    app: kurl-proxy\nspec:\n  selector:\n    matchLabels:\n      app: kurl-proxy\n  template:\n    metadata:\n      labels:\n        app: kurl-proxy\n    spec:\n      containers:\n      - name: proxy\n        image: kurl/proxy:stable\n        env:\n        - name: NODE_PORT\n          value: '30880'\n        - name: UPSTREAM_ORIGIN\n          value: http://127.0.0.1:8800\n        - name: TLS_SECRET_NAME\n          value: kotsadm-tls\n        - name: NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        volumeMounts:\n        - name: kotsadm-config\n          mountPath: /etc/kotsadm\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      serviceAccount: kurl-proxy\n      volumes:\n      - name: kotsadm-config\n        configMap:\n          name: kotsadm-application-metadata\n          optional: true\n",
    "errors": []
  },
  {
    "id": "00957",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: kurl-proxy\n  labels:\n    app: kurl-proxy\nspec:\n  selector:\n    matchLabels:\n      app: kurl-proxy\n  template:\n    metadata:\n      labels:\n        app: kurl-proxy\n    spec:\n      containers:\n      - name: proxy\n        image: kurl/proxy:stable\n        env:\n        - name: NODE_PORT\n          value: '30880'\n        - name: UPSTREAM_ORIGIN\n          value: http://127.0.0.1:8800\n        - name: TLS_SECRET_NAME\n          value: kotsadm-tls\n        - name: NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        volumeMounts:\n        - name: kotsadm-config\n          mountPath: /etc/kotsadm\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      serviceAccount: kurl-proxy\n      volumes:\n      - name: kotsadm-config\n        configMap:\n          name: kotsadm-application-metadata\n          optional: true\n",
    "errors": []
  },
  {
    "id": "00958",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: kurl-proxy\n  labels:\n    app: kurl-proxy\nspec:\n  selector:\n    matchLabels:\n      app: kurl-proxy\n  template:\n    metadata:\n      labels:\n        app: kurl-proxy\n    spec:\n      containers:\n      - name: proxy\n        image: kurl/proxy:stable\n        env:\n        - name: NODE_PORT\n          value: '30880'\n        - name: UPSTREAM_ORIGIN\n          value: http://127.0.0.1:8800\n        - name: TLS_SECRET_NAME\n          value: kotsadm-tls\n        - name: NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        volumeMounts:\n        - name: kotsadm-config\n          mountPath: /etc/kotsadm\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      serviceAccount: kurl-proxy\n      volumes:\n      - name: kotsadm-config\n        configMap:\n          name: kotsadm-application-metadata\n          optional: true\n",
    "errors": []
  },
  {
    "id": "00959",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: client\n  labels:\n    app: client\nspec:\n  replicas: 1\n  template:\n    metadata:\n      name: client\n      labels:\n        app: client\n    spec:\n      containers:\n      - name: client\n        image: alpine:stable\n        imagePullPolicy: IfNotPresent\n        command:\n        - bin/sh\n        - -c\n        - sleep 10086\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n  selector:\n    matchLabels:\n      app: client\n",
    "errors": []
  },
  {
    "id": "00960",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: client\n  labels:\n    app: client\nspec:\n  replicas: 1\n  template:\n    metadata:\n      name: client\n      labels:\n        app: client\n    spec:\n      containers:\n      - name: client\n        image: alpine:stable\n        imagePullPolicy: IfNotPresent\n        command:\n        - bin/sh\n        - -c\n        - sleep 10086\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n  selector:\n    matchLabels:\n      app: client\n",
    "errors": []
  }
]