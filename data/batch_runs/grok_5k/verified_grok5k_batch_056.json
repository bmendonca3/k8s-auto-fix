[
  {
    "id": "02241",
    "policy_id": "drop_capabilities",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: csi-hostpathplugin\nspec:\n  selector:\n    matchLabels:\n      app: csi-hostpathplugin\n  template:\n    metadata:\n      labels:\n        app: csi-hostpathplugin\n    spec:\n      serviceAccountName: csi-driver-registrar\n      containers:\n      - name: driver-registrar\n        image: quay.io/k8scsi/driver-registrar:v0.4.1\n        args:\n        - --v=5\n        - --csi-address=/csi/csi.sock\n        - --kubelet-registration-path=/var/lib/kubelet/plugins/csi-hostpath/csi.sock\n        env:\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              apiVersion: v1\n              fieldPath: spec.nodeName\n        imagePullPolicy: Always\n        volumeMounts:\n        - mountPath: /csi\n          name: socket-dir\n        - mountPath: /registration\n          name: registration-dir\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - name: hostpath\n        image: quay.io/k8scsi/hostpathplugin:v0.4.1\n        args:\n        - --v=5\n        - --endpoint=$(CSI_ENDPOINT)\n        - --nodeid=$(KUBE_NODE_NAME)\n        env:\n        - name: CSI_ENDPOINT\n          value: unix:///csi/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              apiVersion: v1\n              fieldPath: spec.nodeName\n        imagePullPolicy: Always\n        securityContext:\n          privileged: false\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          runAsNonRoot: true\n          seccompProfile:\n            type: RuntimeDefault\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n        volumeMounts:\n        - mountPath: /csi\n          name: socket-dir\n        - mountPath: /var/lib/kubelet/pods\n          mountPropagation: HostToContainer\n          name: mountpoint-dir\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - emptyDir: {}\n        name: socket-dir\n      - emptyDir: {}\n        name: mountpoint-dir\n      - emptyDir: {}\n        name: registration-dir\n",
    "errors": []
  },
  {
    "id": "02242",
    "policy_id": "no_privileged",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: csi-hostpathplugin\nspec:\n  selector:\n    matchLabels:\n      app: csi-hostpathplugin\n  template:\n    metadata:\n      labels:\n        app: csi-hostpathplugin\n    spec:\n      serviceAccountName: csi-driver-registrar\n      containers:\n      - name: driver-registrar\n        image: quay.io/k8scsi/driver-registrar:v0.4.1\n        args:\n        - --v=5\n        - --csi-address=/csi/csi.sock\n        - --kubelet-registration-path=/var/lib/kubelet/plugins/csi-hostpath/csi.sock\n        env:\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              apiVersion: v1\n              fieldPath: spec.nodeName\n        imagePullPolicy: Always\n        volumeMounts:\n        - mountPath: /csi\n          name: socket-dir\n        - mountPath: /registration\n          name: registration-dir\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - name: hostpath\n        image: quay.io/k8scsi/hostpathplugin:v0.4.1\n        args:\n        - --v=5\n        - --endpoint=$(CSI_ENDPOINT)\n        - --nodeid=$(KUBE_NODE_NAME)\n        env:\n        - name: CSI_ENDPOINT\n          value: unix:///csi/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              apiVersion: v1\n              fieldPath: spec.nodeName\n        imagePullPolicy: Always\n        securityContext:\n          privileged: false\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n        volumeMounts:\n        - mountPath: /csi\n          name: socket-dir\n        - mountPath: /var/lib/kubelet/pods\n          mountPropagation: HostToContainer\n          name: mountpoint-dir\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - hostPath:\n          path: /var/lib/kubelet/plugins/csi-hostpath\n          type: DirectoryOrCreate\n        name: socket-dir\n      - hostPath:\n          path: /var/lib/kubelet/pods\n          type: DirectoryOrCreate\n        name: mountpoint-dir\n      - hostPath:\n          path: /var/lib/kubelet/plugins\n          type: Directory\n        name: registration-dir\n",
    "errors": []
  },
  {
    "id": "02243",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: csi-hostpathplugin\nspec:\n  selector:\n    matchLabels:\n      app: csi-hostpathplugin\n  template:\n    metadata:\n      labels:\n        app: csi-hostpathplugin\n    spec:\n      serviceAccountName: csi-driver-registrar\n      containers:\n      - name: driver-registrar\n        image: quay.io/k8scsi/driver-registrar:v0.4.1\n        args:\n        - --v=5\n        - --csi-address=/csi/csi.sock\n        - --kubelet-registration-path=/var/lib/kubelet/plugins/csi-hostpath/csi.sock\n        env:\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              apiVersion: v1\n              fieldPath: spec.nodeName\n        imagePullPolicy: Always\n        volumeMounts:\n        - mountPath: /csi\n          name: socket-dir\n        - mountPath: /registration\n          name: registration-dir\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - name: hostpath\n        image: quay.io/k8scsi/hostpathplugin:v0.4.1\n        args:\n        - --v=5\n        - --endpoint=$(CSI_ENDPOINT)\n        - --nodeid=$(KUBE_NODE_NAME)\n        env:\n        - name: CSI_ENDPOINT\n          value: unix:///csi/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              apiVersion: v1\n              fieldPath: spec.nodeName\n        imagePullPolicy: Always\n        securityContext:\n          privileged: false\n          runAsNonRoot: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /csi\n          name: socket-dir\n        - mountPath: /var/lib/kubelet/pods\n          mountPropagation: HostToContainer\n          name: mountpoint-dir\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - hostPath:\n          path: /var/lib/kubelet/plugins/csi-hostpath\n          type: DirectoryOrCreate\n        name: socket-dir\n      - hostPath:\n          path: /var/lib/kubelet/pods\n          type: DirectoryOrCreate\n        name: mountpoint-dir\n      - hostPath:\n          path: /var/lib/kubelet/plugins\n          type: Directory\n        name: registration-dir\n",
    "errors": []
  },
  {
    "id": "02244",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: csi-hostpathplugin\nspec:\n  selector:\n    matchLabels:\n      app: csi-hostpathplugin\n  template:\n    metadata:\n      labels:\n        app: csi-hostpathplugin\n    spec:\n      serviceAccountName: csi-driver-registrar\n      containers:\n      - name: driver-registrar\n        image: quay.io/k8scsi/driver-registrar:v0.4.1\n        args:\n        - --v=5\n        - --csi-address=/csi/csi.sock\n        - --kubelet-registration-path=/var/lib/kubelet/plugins/csi-hostpath/csi.sock\n        env:\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              apiVersion: v1\n              fieldPath: spec.nodeName\n        imagePullPolicy: Always\n        volumeMounts:\n        - mountPath: /csi\n          name: socket-dir\n        - mountPath: /registration\n          name: registration-dir\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - name: hostpath\n        image: quay.io/k8scsi/hostpathplugin:v0.4.1\n        args:\n        - --v=5\n        - --endpoint=$(CSI_ENDPOINT)\n        - --nodeid=$(KUBE_NODE_NAME)\n        env:\n        - name: CSI_ENDPOINT\n          value: unix:///csi/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              apiVersion: v1\n              fieldPath: spec.nodeName\n        imagePullPolicy: Always\n        securityContext:\n          privileged: false\n          runAsNonRoot: true\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /csi\n          name: socket-dir\n        - mountPath: /var/lib/kubelet/pods\n          mountPropagation: HostToContainer\n          name: mountpoint-dir\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - hostPath:\n          path: /var/lib/kubelet/plugins/csi-hostpath\n          type: DirectoryOrCreate\n        name: socket-dir\n      - hostPath:\n          path: /var/lib/kubelet/pods\n          type: DirectoryOrCreate\n        name: mountpoint-dir\n      - hostPath:\n          path: /var/lib/kubelet/plugins\n          type: Directory\n        name: registration-dir\n",
    "errors": []
  },
  {
    "id": "02245",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: csi-hostpathplugin\nspec:\n  selector:\n    matchLabels:\n      app: csi-hostpathplugin\n  template:\n    metadata:\n      labels:\n        app: csi-hostpathplugin\n    spec:\n      serviceAccountName: csi-driver-registrar\n      containers:\n      - name: driver-registrar\n        image: quay.io/k8scsi/driver-registrar:v0.4.1\n        args:\n        - --v=5\n        - --csi-address=/csi/csi.sock\n        - --kubelet-registration-path=/var/lib/kubelet/plugins/csi-hostpath/csi.sock\n        env:\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              apiVersion: v1\n              fieldPath: spec.nodeName\n        imagePullPolicy: Always\n        volumeMounts:\n        - mountPath: /csi\n          name: socket-dir\n        - mountPath: /registration\n          name: registration-dir\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - name: hostpath\n        image: quay.io/k8scsi/hostpathplugin:v0.4.1\n        args:\n        - --v=5\n        - --endpoint=$(CSI_ENDPOINT)\n        - --nodeid=$(KUBE_NODE_NAME)\n        env:\n        - name: CSI_ENDPOINT\n          value: unix:///csi/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              apiVersion: v1\n              fieldPath: spec.nodeName\n        imagePullPolicy: Always\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /csi\n          name: socket-dir\n        - mountPath: /var/lib/kubelet/pods\n          mountPropagation: HostToContainer\n          name: mountpoint-dir\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - hostPath:\n          path: /var/lib/kubelet/plugins/csi-hostpath\n          type: DirectoryOrCreate\n        name: socket-dir\n      - hostPath:\n          path: /var/lib/kubelet/pods\n          type: DirectoryOrCreate\n        name: mountpoint-dir\n      - hostPath:\n          path: /var/lib/kubelet/plugins\n          type: Directory\n        name: registration-dir\n",
    "errors": []
  },
  {
    "id": "02246",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: csi-hostpathplugin\nspec:\n  selector:\n    matchLabels:\n      app: csi-hostpathplugin\n  template:\n    metadata:\n      labels:\n        app: csi-hostpathplugin\n    spec:\n      serviceAccountName: csi-driver-registrar\n      containers:\n      - name: driver-registrar\n        image: quay.io/k8scsi/driver-registrar:v0.4.1\n        args:\n        - --v=5\n        - --csi-address=/csi/csi.sock\n        - --kubelet-registration-path=/var/lib/kubelet/plugins/csi-hostpath/csi.sock\n        env:\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              apiVersion: v1\n              fieldPath: spec.nodeName\n        imagePullPolicy: Always\n        volumeMounts:\n        - mountPath: /csi\n          name: socket-dir\n        - mountPath: /registration\n          name: registration-dir\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - name: hostpath\n        image: quay.io/k8scsi/hostpathplugin:v0.4.1\n        args:\n        - --v=5\n        - --endpoint=$(CSI_ENDPOINT)\n        - --nodeid=$(KUBE_NODE_NAME)\n        env:\n        - name: CSI_ENDPOINT\n          value: unix:///csi/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              apiVersion: v1\n              fieldPath: spec.nodeName\n        imagePullPolicy: Always\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /csi\n          name: socket-dir\n        - mountPath: /var/lib/kubelet/pods\n          mountPropagation: HostToContainer\n          name: mountpoint-dir\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - hostPath:\n          path: /var/lib/kubelet/plugins/csi-hostpath\n          type: DirectoryOrCreate\n        name: socket-dir\n      - hostPath:\n          path: /var/lib/kubelet/pods\n          type: DirectoryOrCreate\n        name: mountpoint-dir\n      - hostPath:\n          path: /var/lib/kubelet/plugins\n          type: Directory\n        name: registration-dir\n",
    "errors": []
  },
  {
    "id": "02247",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: csi-hostpathplugin\nspec:\n  selector:\n    matchLabels:\n      app: csi-hostpathplugin\n  template:\n    metadata:\n      labels:\n        app: csi-hostpathplugin\n    spec:\n      serviceAccountName: csi-driver-registrar\n      containers:\n      - name: driver-registrar\n        image: quay.io/k8scsi/driver-registrar:v0.4.1\n        args:\n        - --v=5\n        - --csi-address=/csi/csi.sock\n        - --kubelet-registration-path=/var/lib/kubelet/plugins/csi-hostpath/csi.sock\n        env:\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              apiVersion: v1\n              fieldPath: spec.nodeName\n        imagePullPolicy: Always\n        volumeMounts:\n        - mountPath: /csi\n          name: socket-dir\n        - mountPath: /registration\n          name: registration-dir\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - name: hostpath\n        image: quay.io/k8scsi/hostpathplugin:v0.4.1\n        args:\n        - --v=5\n        - --endpoint=$(CSI_ENDPOINT)\n        - --nodeid=$(KUBE_NODE_NAME)\n        env:\n        - name: CSI_ENDPOINT\n          value: unix:///csi/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              apiVersion: v1\n              fieldPath: spec.nodeName\n        imagePullPolicy: Always\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /csi\n          name: socket-dir\n        - mountPath: /var/lib/kubelet/pods\n          mountPropagation: HostToContainer\n          name: mountpoint-dir\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: socket-dir\n        emptyDir: {}\n      - name: mountpoint-dir\n        emptyDir: {}\n      - name: registration-dir\n        emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "02248",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: csi-hostpathplugin\nspec:\n  selector:\n    matchLabels:\n      app: csi-hostpathplugin\n  template:\n    metadata:\n      labels:\n        app: csi-hostpathplugin\n    spec:\n      serviceAccountName: csi-driver-registrar\n      containers:\n      - name: driver-registrar\n        image: quay.io/k8scsi/driver-registrar:v0.4.1\n        args:\n        - --v=5\n        - --csi-address=/csi/csi.sock\n        - --kubelet-registration-path=/var/lib/kubelet/plugins/csi-hostpath/csi.sock\n        env:\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              apiVersion: v1\n              fieldPath: spec.nodeName\n        imagePullPolicy: Always\n        volumeMounts:\n        - mountPath: /csi\n          name: socket-dir\n        - mountPath: /registration\n          name: registration-dir\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - name: hostpath\n        image: quay.io/k8scsi/hostpathplugin:v0.4.1\n        args:\n        - --v=5\n        - --endpoint=$(CSI_ENDPOINT)\n        - --nodeid=$(KUBE_NODE_NAME)\n        env:\n        - name: CSI_ENDPOINT\n          value: unix:///csi/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              apiVersion: v1\n              fieldPath: spec.nodeName\n        imagePullPolicy: Always\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /csi\n          name: socket-dir\n        - mountPath: /var/lib/kubelet/pods\n          mountPropagation: HostToContainer\n          name: mountpoint-dir\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      volumes:\n      - name: socket-dir\n        emptyDir: {}\n      - name: mountpoint-dir\n        emptyDir: {}\n      - name: registration-dir\n        emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "02249",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: paymentservice\n  labels:\n    app: paymentservice\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: paymentservice\n  template:\n    metadata:\n      labels:\n        app: paymentservice\n    spec:\n      containers:\n      - name: server\n        image: skuleshov/payment_service:v0.0.2\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "02250",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: paymentservice\n  labels:\n    app: paymentservice\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: paymentservice\n  template:\n    metadata:\n      labels:\n        app: paymentservice\n    spec:\n      containers:\n      - name: server\n        image: skuleshov/payment_service:v0.0.2\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "02251",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: paymentservice\n  labels:\n    app: paymentservice\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: paymentservice\n  template:\n    metadata:\n      labels:\n        app: paymentservice\n    spec:\n      containers:\n      - name: server\n        image: skuleshov/payment_service:v0.0.2\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "02252",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: paymentservice\n  labels:\n    app: paymentservice\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: paymentservice\n  template:\n    metadata:\n      labels:\n        app: paymentservice\n    spec:\n      containers:\n      - name: server\n        image: skuleshov/payment_service:v0.0.2\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "02253",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    run: test\n  name: test21\n  namespace: default\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      run: test\n  template:\n    metadata:\n      labels:\n        run: test\n    spec:\n      containers:\n      - image: redis:stable\n        name: container1\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - image: docker.io/dgeiger/alpine:3\n        name: container2\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - image: docker.io/dgeiger/nginx@sha256:e770165fef9e36b990882a4083d8ccf5e29e469a8609bb6b2e3b47d9510e2c8d\n        name: container3\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "02254",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    run: test\n  name: test21\n  namespace: default\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      run: test\n  template:\n    metadata:\n      labels:\n        run: test\n    spec:\n      containers:\n      - image: redis:stable\n        name: container1\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - image: docker.io/dgeiger/alpine:3\n        name: container2\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - image: docker.io/dgeiger/nginx@sha256:e770165fef9e36b990882a4083d8ccf5e29e469a8609bb6b2e3b47d9510e2c8d\n        name: container3\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "02255",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    run: test\n  name: test21\n  namespace: default\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      run: test\n  template:\n    metadata:\n      labels:\n        run: test\n    spec:\n      containers:\n      - image: redis:stable\n        name: container1\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - image: docker.io/dgeiger/alpine:3\n        name: container2\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - image: docker.io/dgeiger/nginx@sha256:e770165fef9e36b990882a4083d8ccf5e29e469a8609bb6b2e3b47d9510e2c8d\n        name: container3\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      securityContext:\n        runAsNonRoot: true\n        seccompProfile:\n          type: RuntimeDefault\n",
    "errors": []
  },
  {
    "id": "02256",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    run: test\n  name: test21\n  namespace: default\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      run: test\n  template:\n    metadata:\n      labels:\n        run: test\n    spec:\n      containers:\n      - image: redis:stable\n        name: container1\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - image: docker.io/dgeiger/alpine:3\n        name: container2\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - image: docker.io/dgeiger/nginx@sha256:e770165fef9e36b990882a4083d8ccf5e29e469a8609bb6b2e3b47d9510e2c8d\n        name: container3\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      securityContext:\n        seccompProfile:\n          type: RuntimeDefault\n",
    "errors": []
  },
  {
    "id": "02257",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    run: test\n  name: test21\n  namespace: default\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      run: test\n  template:\n    metadata:\n      labels:\n        run: test\n    spec:\n      containers:\n      - image: redis:stable\n        name: container1\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - image: docker.io/dgeiger/alpine:3\n        name: container2\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - image: docker.io/dgeiger/nginx@sha256:e770165fef9e36b990882a4083d8ccf5e29e469a8609bb6b2e3b47d9510e2c8d\n        name: container3\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "02258",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    run: test\n  name: test21\n  namespace: default\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      run: test\n  template:\n    metadata:\n      labels:\n        run: test\n    spec:\n      containers:\n      - image: redis:stable\n        name: container1\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - image: docker.io/dgeiger/alpine:3\n        name: container2\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - image: docker.io/dgeiger/nginx@sha256:e770165fef9e36b990882a4083d8ccf5e29e469a8609bb6b2e3b47d9510e2c8d\n        name: container3\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "02259",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    run: test\n  name: test21\n  namespace: default\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      run: test\n  template:\n    metadata:\n      labels:\n        run: test\n    spec:\n      containers:\n      - image: redis:stable\n        name: container1\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - image: docker.io/dgeiger/alpine:3\n        name: container2\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - image: docker.io/dgeiger/nginx@sha256:e770165fef9e36b990882a4083d8ccf5e29e469a8609bb6b2e3b47d9510e2c8d\n        name: container3\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "02260",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    run: test\n  name: test21\n  namespace: default\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      run: test\n  template:\n    metadata:\n      labels:\n        run: test\n    spec:\n      containers:\n      - image: redis:stable\n        name: container1\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - image: docker.io/dgeiger/alpine:3\n        name: container2\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - image: docker.io/dgeiger/nginx@sha256:e770165fef9e36b990882a4083d8ccf5e29e469a8609bb6b2e3b47d9510e2c8d\n        name: container3\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "02261",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    run: test\n  name: test21\n  namespace: default\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      run: test\n  template:\n    metadata:\n      labels:\n        run: test\n    spec:\n      containers:\n      - image: redis:stable\n        name: container1\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - image: docker.io/dgeiger/alpine:3\n        name: container2\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - image: docker.io/dgeiger/nginx@sha256:e770165fef9e36b990882a4083d8ccf5e29e469a8609bb6b2e3b47d9510e2c8d\n        name: container3\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "02262",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    run: test\n  name: test21\n  namespace: default\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      run: test\n  template:\n    metadata:\n      labels:\n        run: test\n    spec:\n      containers:\n      - image: redis:stable\n        name: container1\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - image: docker.io/dgeiger/alpine:3\n        name: container2\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - image: docker.io/dgeiger/nginx@sha256:e770165fef9e36b990882a4083d8ccf5e29e469a8609bb6b2e3b47d9510e2c8d\n        name: container3\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "02263",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    run: test\n  name: test21\n  namespace: default\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      run: test\n  template:\n    metadata:\n      labels:\n        run: test\n    spec:\n      containers:\n      - image: redis:stable\n        name: container1\n        resources:\n          limits:\n            cpu: 500m\n            memory: 256Mi\n          requests:\n            cpu: 100m\n            memory: 128Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - image: docker.io/dgeiger/alpine:3\n        name: container2\n        resources:\n          limits:\n            cpu: 500m\n            memory: 256Mi\n          requests:\n            cpu: 100m\n            memory: 128Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - image: docker.io/dgeiger/nginx@sha256:e770165fef9e36b990882a4083d8ccf5e29e469a8609bb6b2e3b47d9510e2c8d\n        name: container3\n        resources:\n          limits:\n            cpu: 500m\n            memory: 256Mi\n          requests:\n            cpu: 100m\n            memory: 128Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "02264",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    run: test\n  name: test21\n  namespace: default\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      run: test\n  template:\n    metadata:\n      labels:\n        run: test\n    spec:\n      containers:\n      - image: redis:stable\n        name: container1\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - image: docker.io/dgeiger/alpine:3\n        name: container2\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - image: docker.io/dgeiger/nginx@sha256:e770165fef9e36b990882a4083d8ccf5e29e469a8609bb6b2e3b47d9510e2c8d\n        name: container3\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "02265",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    run: test\n  name: test21\n  namespace: default\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      run: test\n  template:\n    metadata:\n      labels:\n        run: test\n    spec:\n      containers:\n      - image: redis:stable\n        name: container1\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - image: docker.io/dgeiger/alpine:3\n        name: container2\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - image: docker.io/dgeiger/nginx@sha256:e770165fef9e36b990882a4083d8ccf5e29e469a8609bb6b2e3b47d9510e2c8d\n        name: container3\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "02266",
    "policy_id": "env_var_secret",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: minio-deployment\nspec:\n  selector:\n    matchLabels:\n      app: minio\n  template:\n    metadata:\n      labels:\n        app: minio\n    spec:\n      volumes:\n      - name: gcs-credentials\n        secret:\n          secretName: gcs-credentials\n      containers:\n      - name: minio\n        image: minio/minio:RELEASE.2020-05-16T01-33-21Z\n        args:\n        - gateway\n        - gcs\n        - gcp_project_id\n        env:\n        - name: MINIO_ACCESS_KEY\n          value: minio\n        - name: MINIO_SECRET_KEY\n          valueFrom:\n            secretKeyRef:\n              name: gcs-credentials\n              key: minio_secret_key\n        - name: GOOGLE_APPLICATION_CREDENTIALS\n          value: /etc/credentials/application_default_credentials.json\n        ports:\n        - containerPort: 9000\n        volumeMounts:\n        - name: gcs-credentials\n          mountPath: /etc/credentials\n          readOnly: true\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "02267",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: minio-deployment\nspec:\n  selector:\n    matchLabels:\n      app: minio\n  template:\n    metadata:\n      labels:\n        app: minio\n    spec:\n      volumes:\n      - name: gcs-credentials\n        secret:\n          secretName: gcs-credentials\n      containers:\n      - name: minio\n        image: minio/minio:RELEASE.2020-05-16T01-33-21Z\n        args:\n        - gateway\n        - gcs\n        - gcp_project_id\n        env:\n        - name: MINIO_ACCESS_KEY\n          value: minio\n        - name: MINIO_SECRET_KEY\n          valueFrom:\n            secretKeyRef:\n              name: gcs-credentials\n              key: minio_secret_key\n        - name: GOOGLE_APPLICATION_CREDENTIALS\n          value: /etc/credentials/application_default_credentials.json\n        ports:\n        - containerPort: 9000\n        volumeMounts:\n        - name: gcs-credentials\n          mountPath: /etc/credentials\n          readOnly: true\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "02268",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: minio-deployment\nspec:\n  selector:\n    matchLabels:\n      app: minio\n  template:\n    metadata:\n      labels:\n        app: minio\n    spec:\n      volumes:\n      - name: gcs-credentials\n        secret:\n          secretName: gcs-credentials\n      containers:\n      - name: minio\n        image: minio/minio:RELEASE.2020-05-16T01-33-21Z\n        args:\n        - gateway\n        - gcs\n        - gcp_project_id\n        env:\n        - name: MINIO_ACCESS_KEY\n          value: minio\n        - name: MINIO_SECRET_KEY\n          valueFrom:\n            secretKeyRef:\n              name: gcs-credentials\n              key: minio_secret_key\n        - name: GOOGLE_APPLICATION_CREDENTIALS\n          value: /etc/credentials/application_default_credentials.json\n        ports:\n        - containerPort: 9000\n        volumeMounts:\n        - name: gcs-credentials\n          mountPath: /etc/credentials\n          readOnly: true\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "02269",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: minio-deployment\nspec:\n  selector:\n    matchLabels:\n      app: minio\n  template:\n    metadata:\n      labels:\n        app: minio\n    spec:\n      volumes:\n      - name: gcs-credentials\n        secret:\n          secretName: gcs-credentials\n      containers:\n      - name: minio\n        image: minio/minio:RELEASE.2020-05-16T01-33-21Z\n        args:\n        - gateway\n        - gcs\n        - gcp_project_id\n        env:\n        - name: MINIO_ACCESS_KEY\n          value: minio\n        - name: MINIO_SECRET_KEY\n          valueFrom:\n            secretKeyRef:\n              name: gcs-credentials\n              key: minio_secret_key\n        - name: GOOGLE_APPLICATION_CREDENTIALS\n          value: /etc/credentials/application_default_credentials.json\n        ports:\n        - containerPort: 9000\n        volumeMounts:\n        - name: gcs-credentials\n          mountPath: /etc/credentials\n          readOnly: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "02270",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: minio-deployment\nspec:\n  selector:\n    matchLabels:\n      app: minio\n  template:\n    metadata:\n      labels:\n        app: minio\n    spec:\n      volumes:\n      - name: gcs-credentials\n        secret:\n          secretName: gcs-credentials\n      containers:\n      - name: minio\n        image: minio/minio:RELEASE.2020-05-16T01-33-21Z\n        args:\n        - gateway\n        - gcs\n        - gcp_project_id\n        env:\n        - name: MINIO_ACCESS_KEY\n          value: minio\n        - name: MINIO_SECRET_KEY\n          valueFrom:\n            secretKeyRef:\n              name: gcs-credentials\n              key: minio_secret_key\n        - name: GOOGLE_APPLICATION_CREDENTIALS\n          value: /etc/credentials/application_default_credentials.json\n        ports:\n        - containerPort: 9000\n        volumeMounts:\n        - name: gcs-credentials\n          mountPath: /etc/credentials\n          readOnly: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "02271",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    io.sourceloop.service: postgres-orchestrator\n  name: postgres-orchestrator\n  namespace: sourceloop-sandbox\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      io.sourceloop.service: postgres-orchestrator\n  template:\n    metadata:\n      labels:\n        io.sourceloop.service: postgres-orchestrator\n    spec:\n      containers:\n      - args:\n        - bash\n        - -c\n        - 'export PGPASSWORD=${POSTGRES_PASSWORD:-changeme}; sleep 30;\n\n          psql -U ${POSTGRES_USER:-postgres} -d postgres -h postgres -c ''create database\n          authentication_db'' 2>&1;\n\n          psql -U ${POSTGRES_USER:-postgres} -d postgres -h postgres -c ''create database\n          notification_db'' 2>&1;\n\n          psql -U ${POSTGRES_USER:-postgres} -d postgres -h postgres -c ''create database\n          workflow_db'' 2>&1;\n\n          psql -U ${POSTGRES_USER:-postgres} -d postgres -h postgres -c ''create database\n          audit_db'' 2>&1;\n\n          psql -U ${POSTGRES_USER:-postgres} -d postgres -h postgres -c ''create database\n          scheduler_db'' 2>&1;\n\n          psql -U ${POSTGRES_USER:-postgres} -d postgres -h postgres -c ''create database\n          in_mail_db'' 2>&1;\n\n          exit 0'\n        env:\n        - name: PGDATA\n          value: /data/postgres\n        - name: PGPASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: pgpassword-secret\n              key: pgpassword\n        - name: POSTGRES_PASSWORD\n          value: changeme\n        - name: POSTGRES_USER\n          value: postgres\n        image: postgres:stable\n        name: postgres-orchestrator\n        ports:\n        - containerPort: 5433\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "02272",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    io.sourceloop.service: postgres-orchestrator\n  name: postgres-orchestrator\n  namespace: sourceloop-sandbox\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      io.sourceloop.service: postgres-orchestrator\n  template:\n    metadata:\n      labels:\n        io.sourceloop.service: postgres-orchestrator\n    spec:\n      containers:\n      - args:\n        - bash\n        - -c\n        - 'export PGPASSWORD=${POSTGRES_PASSWORD:-changeme}; sleep 30;\n\n          psql -U ${POSTGRES_USER:-postgres} -d postgres -h postgres -c ''create database\n          authentication_db'' 2>&1;\n\n          psql -U ${POSTGRES_USER:-postgres} -d postgres -h postgres -c ''create database\n          notification_db'' 2>&1;\n\n          psql -U ${POSTGRES_USER:-postgres} -d postgres -h postgres -c ''create database\n          workflow_db'' 2>&1;\n\n          psql -U ${POSTGRES_USER:-postgres} -d postgres -h postgres -c ''create database\n          audit_db'' 2>&1;\n\n          psql -U ${POSTGRES_USER:-postgres} -d postgres -h postgres -c ''create database\n          scheduler_db'' 2>&1;\n\n          psql -U ${POSTGRES_USER:-postgres} -d postgres -h postgres -c ''create database\n          in_mail_db'' 2>&1;\n\n          exit 0'\n        env:\n        - name: PGDATA\n          value: /data/postgres\n        - name: PGPASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: pgpassword-secret\n              key: pgpassword\n        - name: POSTGRES_PASSWORD\n          value: changeme\n        - name: POSTGRES_USER\n          value: postgres\n        image: postgres:stable\n        name: postgres-orchestrator\n        ports:\n        - containerPort: 5433\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "02273",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    io.sourceloop.service: postgres-orchestrator\n  name: postgres-orchestrator\n  namespace: sourceloop-sandbox\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      io.sourceloop.service: postgres-orchestrator\n  template:\n    metadata:\n      labels:\n        io.sourceloop.service: postgres-orchestrator\n    spec:\n      containers:\n      - args:\n        - bash\n        - -c\n        - 'export PGPASSWORD=${POSTGRES_PASSWORD:-changeme}; sleep 30;\n\n          psql -U ${POSTGRES_USER:-postgres} -d postgres -h postgres -c ''create database\n          authentication_db'' 2>&1;\n\n          psql -U ${POSTGRES_USER:-postgres} -d postgres -h postgres -c ''create database\n          notification_db'' 2>&1;\n\n          psql -U ${POSTGRES_USER:-postgres} -d postgres -h postgres -c ''create database\n          workflow_db'' 2>&1;\n\n          psql -U ${POSTGRES_USER:-postgres} -d postgres -h postgres -c ''create database\n          audit_db'' 2>&1;\n\n          psql -U ${POSTGRES_USER:-postgres} -d postgres -h postgres -c ''create database\n          scheduler_db'' 2>&1;\n\n          psql -U ${POSTGRES_USER:-postgres} -d postgres -h postgres -c ''create database\n          in_mail_db'' 2>&1;\n\n          exit 0'\n        env:\n        - name: PGDATA\n          value: /data/postgres\n        - name: PGPASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: pgpassword-secret\n              key: pgpassword\n        - name: POSTGRES_PASSWORD\n          value: changeme\n        - name: POSTGRES_USER\n          value: postgres\n        image: postgres:stable\n        name: postgres-orchestrator\n        ports:\n        - containerPort: 5433\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "02274",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    io.sourceloop.service: postgres-orchestrator\n  name: postgres-orchestrator\n  namespace: sourceloop-sandbox\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      io.sourceloop.service: postgres-orchestrator\n  template:\n    metadata:\n      labels:\n        io.sourceloop.service: postgres-orchestrator\n    spec:\n      containers:\n      - args:\n        - bash\n        - -c\n        - 'export PGPASSWORD=${POSTGRES_PASSWORD:-changeme}; sleep 30;\n\n          psql -U ${POSTGRES_USER:-postgres} -d postgres -h postgres -c ''create database\n          authentication_db'' 2>&1;\n\n          psql -U ${POSTGRES_USER:-postgres} -d postgres -h postgres -c ''create database\n          notification_db'' 2>&1;\n\n          psql -U ${POSTGRES_USER:-postgres} -d postgres -h postgres -c ''create database\n          workflow_db'' 2>&1;\n\n          psql -U ${POSTGRES_USER:-postgres} -d postgres -h postgres -c ''create database\n          audit_db'' 2>&1;\n\n          psql -U ${POSTGRES_USER:-postgres} -d postgres -h postgres -c ''create database\n          scheduler_db'' 2>&1;\n\n          psql -U ${POSTGRES_USER:-postgres} -d postgres -h postgres -c ''create database\n          in_mail_db'' 2>&1;\n\n          exit 0'\n        env:\n        - name: PGDATA\n          value: /data/postgres\n        - name: PGPASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: pgpassword-secret\n              key: pgpassword\n        - name: POSTGRES_PASSWORD\n          value: changeme\n        - name: POSTGRES_USER\n          value: postgres\n        image: postgres:stable\n        name: postgres-orchestrator\n        ports:\n        - containerPort: 5433\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "02275",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    io.sourceloop.service: postgres-orchestrator\n  name: postgres-orchestrator\n  namespace: sourceloop-sandbox\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      io.sourceloop.service: postgres-orchestrator\n  template:\n    metadata:\n      labels:\n        io.sourceloop.service: postgres-orchestrator\n    spec:\n      containers:\n      - args:\n        - bash\n        - -c\n        - 'export PGPASSWORD=${POSTGRES_PASSWORD:-changeme}; sleep 30;\n\n          psql -U ${POSTGRES_USER:-postgres} -d postgres -h postgres -c ''create database\n          authentication_db'' 2>&1;\n\n          psql -U ${POSTGRES_USER:-postgres} -d postgres -h postgres -c ''create database\n          notification_db'' 2>&1;\n\n          psql -U ${POSTGRES_USER:-postgres} -d postgres -h postgres -c ''create database\n          workflow_db'' 2>&1;\n\n          psql -U ${POSTGRES_USER:-postgres} -d postgres -h postgres -c ''create database\n          audit_db'' 2>&1;\n\n          psql -U ${POSTGRES_USER:-postgres} -d postgres -h postgres -c ''create database\n          scheduler_db'' 2>&1;\n\n          psql -U ${POSTGRES_USER:-postgres} -d postgres -h postgres -c ''create database\n          in_mail_db'' 2>&1;\n\n          exit 0'\n        env:\n        - name: PGDATA\n          value: /data/postgres\n        - name: PGPASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: pgpassword-secret\n              key: pgpassword\n        - name: POSTGRES_PASSWORD\n          value: changeme\n        - name: POSTGRES_USER\n          value: postgres\n        image: postgres:stable\n        name: postgres-orchestrator\n        ports:\n        - containerPort: 5433\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "02276",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: CronJob\nmetadata:\n  name: check-acr-sync\n  namespace: monitoring\n  labels:\n    app: check-acr-sync\nspec:\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          containers:\n          - name: check-acr-sync\n            image: hmctspublic.azurecr.io/check-acr-sync:dbbbwb\n            imagePullPolicy: IfNotPresent\n            resources:\n              requests:\n                memory: 64Mi\n                cpu: 250m\n              limits:\n                memory: 256Mi\n                cpu: 500m\n            env:\n            - name: SLACK_WEBHOOK\n              valueFrom:\n                secretKeyRef:\n                  name: monitoring-values\n                  key: slack-webhook\n            - name: SLACK_ICON\n              value: flux\n            - name: ACR_MAX_RESULTS\n              value: '3000'\n            - name: ACR_SYNC_DEBUG\n              value: 'true'\n            envFrom:\n            - secretRef:\n                name: acr-sync\n            securityContext:\n              readOnlyRootFilesystem: true\n              privileged: false\n              capabilities:\n                drop:\n                - NET_RAW\n                - NET_ADMIN\n                - SYS_ADMIN\n                - SYS_MODULE\n                - SYS_PTRACE\n                - SYS_CHROOT\n              allowPrivilegeEscalation: false\n              runAsNonRoot: true\n          restartPolicy: OnFailure\n  schedule: 0 0 * * *\n",
    "errors": []
  },
  {
    "id": "02277",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: CronJob\nmetadata:\n  name: check-acr-sync\n  namespace: monitoring\n  labels:\n    app: check-acr-sync\nspec:\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          containers:\n          - name: check-acr-sync\n            image: hmctspublic.azurecr.io/check-acr-sync:dbbbwb\n            imagePullPolicy: IfNotPresent\n            resources:\n              requests:\n                memory: 64Mi\n                cpu: 250m\n              limits:\n                memory: 256Mi\n                cpu: 500m\n            env:\n            - name: SLACK_WEBHOOK\n              valueFrom:\n                secretKeyRef:\n                  name: monitoring-values\n                  key: slack-webhook\n            - name: SLACK_ICON\n              value: flux\n            - name: ACR_MAX_RESULTS\n              value: '3000'\n            - name: ACR_SYNC_DEBUG\n              value: 'true'\n            envFrom:\n            - secretRef:\n                name: acr-sync\n            securityContext:\n              runAsNonRoot: true\n              privileged: false\n              capabilities:\n                drop:\n                - NET_RAW\n                - NET_ADMIN\n                - SYS_ADMIN\n                - SYS_MODULE\n                - SYS_PTRACE\n                - SYS_CHROOT\n              allowPrivilegeEscalation: false\n              readOnlyRootFilesystem: true\n          restartPolicy: OnFailure\n  schedule: 0 0 * * *\n",
    "errors": []
  },
  {
    "id": "02278",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: fortunes\n  labels:\n    app: fortunes\nspec:\n  containers:\n  - name: fortunes\n    image: localhost:5000/fortunes:stable\n    imagePullPolicy: Always\n    ports:\n    - name: app\n      containerPort: 3000\n    env:\n    - name: REDIS_HOST\n      value: redis-master\n    - name: REDIS_PORT\n      value: '6379'\n    - name: REDIS_PWD\n      value: none\n    - name: FORTUNES_TARGET_TOPIC\n      value: fc_fortunes_out\n    - name: FORTUNES_SOURCE_TOPIC\n      value: fc_fortunes_in\n    securityContext:\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      privileged: false\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n      readOnlyRootFilesystem: true\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "02279",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: fortunes\n  labels:\n    app: fortunes\nspec:\n  containers:\n  - name: fortunes\n    image: localhost:5000/fortunes:stable\n    imagePullPolicy: Always\n    ports:\n    - name: app\n      containerPort: 3000\n    env:\n    - name: REDIS_HOST\n      value: redis-master\n    - name: REDIS_PORT\n      value: '6379'\n    - name: REDIS_PWD\n      value: none\n    - name: FORTUNES_TARGET_TOPIC\n      value: fc_fortunes_out\n    - name: FORTUNES_SOURCE_TOPIC\n      value: fc_fortunes_in\n    securityContext:\n      readOnlyRootFilesystem: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "02280",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: fortunes\n  labels:\n    app: fortunes\nspec:\n  containers:\n  - name: fortunes\n    image: localhost:5000/fortunes:stable\n    imagePullPolicy: Always\n    ports:\n    - name: app\n      containerPort: 3000\n    env:\n    - name: REDIS_HOST\n      value: redis-master\n    - name: REDIS_PORT\n      value: '6379'\n    - name: REDIS_PWD\n      value: none\n    - name: FORTUNES_TARGET_TOPIC\n      value: fc_fortunes_out\n    - name: FORTUNES_SOURCE_TOPIC\n      value: fc_fortunes_in\n    securityContext:\n      runAsNonRoot: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      readOnlyRootFilesystem: true\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n",
    "errors": []
  }
]