[
  {
    "id": "02881",
    "manifest_path": "data/manifests/the_stack_sample/sample_1167.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: django-deployment\n  labels:\n    app: django\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: django\n  template:\n    metadata:\n      labels:\n        app: django\n    spec:\n      containers:\n      - name: django\n        image: kubernetes101/django_image:09f1419\n        ports:\n        - containerPort: 8000\n        resources:\n          requests:\n            memory: 64Mi\n            cpu: 200m\n          limits:\n            memory: 128Mi\n            cpu: 400m\n        envFrom:\n        - configMapRef:\n            name: postgres-config\n        env:\n        - name: POSTGRES_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: db-password\n              key: db-password\n        - name: AWS_STORAGE_BUCKET_NAME\n          valueFrom:\n            secretKeyRef:\n              name: s3-secrets\n              key: s3bucket\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: s3-secrets\n              key: s3accesskey\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: s3-secrets\n              key: s3secretkey\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"django\" does not have a read-only root file system"
  },
  {
    "id": "02882",
    "manifest_path": "data/manifests/the_stack_sample/sample_1167.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: django-deployment\n  labels:\n    app: django\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: django\n  template:\n    metadata:\n      labels:\n        app: django\n    spec:\n      containers:\n      - name: django\n        image: kubernetes101/django_image:09f1419\n        ports:\n        - containerPort: 8000\n        resources:\n          requests:\n            memory: 64Mi\n            cpu: 200m\n          limits:\n            memory: 128Mi\n            cpu: 400m\n        envFrom:\n        - configMapRef:\n            name: postgres-config\n        env:\n        - name: POSTGRES_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: db-password\n              key: db-password\n        - name: AWS_STORAGE_BUCKET_NAME\n          valueFrom:\n            secretKeyRef:\n              name: s3-secrets\n              key: s3bucket\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: s3-secrets\n              key: s3accesskey\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: s3-secrets\n              key: s3secretkey\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"django\" is not set to runAsNonRoot"
  },
  {
    "id": "02883",
    "manifest_path": "data/manifests/the_stack_sample/sample_1171.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app.kubernetes.io/component: controller\n    app.kubernetes.io/name: prometheus-operator\n    app.kubernetes.io/version: v0.33.0\n  name: prometheus-operator\n  namespace: telemeter-benchmark\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app.kubernetes.io/component: controller\n      app.kubernetes.io/name: prometheus-operator\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/component: controller\n        app.kubernetes.io/name: prometheus-operator\n        app.kubernetes.io/version: v0.33.0\n    spec:\n      containers:\n      - args:\n        - --kubelet-service=kube-system/kubelet\n        - --logtostderr=true\n        - --config-reloader-image=quay.io/coreos/configmap-reload:v0.0.1\n        - --prometheus-config-reloader=quay.io/coreos/prometheus-config-reloader:v0.33.0\n        image: quay.io/coreos/prometheus-operator:v0.33.0\n        name: prometheus-operator\n        ports:\n        - containerPort: 8080\n          name: http\n        resources:\n          limits:\n            cpu: 200m\n            memory: 200Mi\n          requests:\n            cpu: 100m\n            memory: 100Mi\n      serviceAccountName: prometheus-operator\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"prometheus-operator\" does not have a read-only root file system"
  },
  {
    "id": "02884",
    "manifest_path": "data/manifests/the_stack_sample/sample_1171.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app.kubernetes.io/component: controller\n    app.kubernetes.io/name: prometheus-operator\n    app.kubernetes.io/version: v0.33.0\n  name: prometheus-operator\n  namespace: telemeter-benchmark\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app.kubernetes.io/component: controller\n      app.kubernetes.io/name: prometheus-operator\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/component: controller\n        app.kubernetes.io/name: prometheus-operator\n        app.kubernetes.io/version: v0.33.0\n    spec:\n      containers:\n      - args:\n        - --kubelet-service=kube-system/kubelet\n        - --logtostderr=true\n        - --config-reloader-image=quay.io/coreos/configmap-reload:v0.0.1\n        - --prometheus-config-reloader=quay.io/coreos/prometheus-config-reloader:v0.33.0\n        image: quay.io/coreos/prometheus-operator:v0.33.0\n        name: prometheus-operator\n        ports:\n        - containerPort: 8080\n          name: http\n        resources:\n          limits:\n            cpu: 200m\n            memory: 200Mi\n          requests:\n            cpu: 100m\n            memory: 100Mi\n      serviceAccountName: prometheus-operator\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"prometheus-operator\" is not set to runAsNonRoot"
  },
  {
    "id": "02885",
    "manifest_path": "data/manifests/the_stack_sample/sample_1172.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-57\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"nginx\" is using an invalid container image, \"nginx\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02886",
    "manifest_path": "data/manifests/the_stack_sample/sample_1172.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-57\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"nginx\" does not have a read-only root file system"
  },
  {
    "id": "02887",
    "manifest_path": "data/manifests/the_stack_sample/sample_1172.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-57\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"nginx\" is not set to runAsNonRoot"
  },
  {
    "id": "02888",
    "manifest_path": "data/manifests/the_stack_sample/sample_1172.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-57\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"nginx\" has cpu request 0"
  },
  {
    "id": "02889",
    "manifest_path": "data/manifests/the_stack_sample/sample_1172.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-57\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"nginx\" has memory limit 0"
  },
  {
    "id": "02890",
    "manifest_path": "data/manifests/the_stack_sample/sample_1174.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: domino12\n  namespace: default\n  labels:\n    app: hcl-domino\nspec:\n  securityContext:\n    runAsNonRoot: true\n    runAsUser: 1000\n    fsGroup: 1000\n    fsGroupChangePolicy: OnRootMismatch\n  containers:\n  - env:\n    - name: LANG\n      value: en_US.UTF-8\n    - name: DOMINO_DOCKER_STDOUT\n      value: 'yes'\n    - name: SetupAutoConfigure\n      value: '1'\n    - name: SERVERSETUP_SERVER_TYPE\n      value: first\n    - name: SERVERSETUP_ADMIN_FIRSTNAME\n      value: Martin\n    - name: SERVERSETUP_ADMIN_LASTNAME\n      value: Bishop\n    - name: SERVERSETUP_ADMIN_PASSWORD\n      value: 2manysecrets\n    - name: SERVERSETUP_ADMIN_IDFILEPATH\n      value: /local/notesdata/domino/html/admin.id\n    - name: SERVERSETUP_NETWORK_HOSTNAME\n      value: master.domino-lab.net\n    - name: SERVERSETUP_ORG_CERTIFIERPASSWORD\n      value: 2manysecrets\n    - name: SERVERSETUP_SERVER_DOMAINNAME\n      value: DominoLab\n    - name: SERVERSETUP_ORG_ORGNAME\n      value: DominoLab\n    - name: SERVERSETUP_SERVER_NAME\n      value: master.domino.lab\n    - name: SERVERSETUP_SERVER_SERVERTASKS\n      value: replica,router,update,amgr,adminp,http,certmgr -ACCEPT_TOU_AUTO_CONFIG\n    - name: SERVERSETUP_SECURITY_ACL_PROHIBITANONYMOUSACCESS\n      value: 'true'\n    - name: SERVERSETUP_SECURITY_ACL_ADDLOCALDOMAINADMINS\n      value: 'true'\n    name: domino12\n    image: registry.domino-lab.net:5000/hclcom/domino:latest\n    securityContext:\n      capabilities:\n        add:\n        - SYS_PTRACE\n      runAsNonRoot: true\n      runAsUser: 1000\n    volumeMounts:\n    - name: domino-data\n      mountPath: /local\n    ports:\n    - containerPort: 1352\n      protocol: TCP\n    - containerPort: 80\n      protocol: TCP\n    - containerPort: 443\n      protocol: TCP\n    livenessProbe:\n      exec:\n        command:\n        - /domino_docker_healthcheck.sh\n      initialDelaySeconds: 60\n      periodSeconds: 20\n    readinessProbe:\n      exec:\n        command:\n        - /domino_docker_healthcheck.sh\n        - ready\n      initialDelaySeconds: 60\n      periodSeconds: 20\n  initContainers:\n  - name: domino-startup\n    image: busybox:latest\n    command:\n    - sh\n    - -c\n    - chmod 777 /local\n    securityContext:\n      privileged: true\n      runAsNonRoot: false\n      runAsUser: 0\n    volumeMounts:\n    - name: domino-data\n      mountPath: /local\n  volumes:\n  - name: domino-data\n    persistentVolumeClaim:\n      claimName: local-path-pvc\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"domino-startup\" is using an invalid container image, \"busybox:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02891",
    "manifest_path": "data/manifests/the_stack_sample/sample_1174.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: domino12\n  namespace: default\n  labels:\n    app: hcl-domino\nspec:\n  securityContext:\n    runAsNonRoot: true\n    runAsUser: 1000\n    fsGroup: 1000\n    fsGroupChangePolicy: OnRootMismatch\n  containers:\n  - env:\n    - name: LANG\n      value: en_US.UTF-8\n    - name: DOMINO_DOCKER_STDOUT\n      value: 'yes'\n    - name: SetupAutoConfigure\n      value: '1'\n    - name: SERVERSETUP_SERVER_TYPE\n      value: first\n    - name: SERVERSETUP_ADMIN_FIRSTNAME\n      value: Martin\n    - name: SERVERSETUP_ADMIN_LASTNAME\n      value: Bishop\n    - name: SERVERSETUP_ADMIN_PASSWORD\n      value: 2manysecrets\n    - name: SERVERSETUP_ADMIN_IDFILEPATH\n      value: /local/notesdata/domino/html/admin.id\n    - name: SERVERSETUP_NETWORK_HOSTNAME\n      value: master.domino-lab.net\n    - name: SERVERSETUP_ORG_CERTIFIERPASSWORD\n      value: 2manysecrets\n    - name: SERVERSETUP_SERVER_DOMAINNAME\n      value: DominoLab\n    - name: SERVERSETUP_ORG_ORGNAME\n      value: DominoLab\n    - name: SERVERSETUP_SERVER_NAME\n      value: master.domino.lab\n    - name: SERVERSETUP_SERVER_SERVERTASKS\n      value: replica,router,update,amgr,adminp,http,certmgr -ACCEPT_TOU_AUTO_CONFIG\n    - name: SERVERSETUP_SECURITY_ACL_PROHIBITANONYMOUSACCESS\n      value: 'true'\n    - name: SERVERSETUP_SECURITY_ACL_ADDLOCALDOMAINADMINS\n      value: 'true'\n    name: domino12\n    image: registry.domino-lab.net:5000/hclcom/domino:latest\n    securityContext:\n      capabilities:\n        add:\n        - SYS_PTRACE\n      runAsNonRoot: true\n      runAsUser: 1000\n    volumeMounts:\n    - name: domino-data\n      mountPath: /local\n    ports:\n    - containerPort: 1352\n      protocol: TCP\n    - containerPort: 80\n      protocol: TCP\n    - containerPort: 443\n      protocol: TCP\n    livenessProbe:\n      exec:\n        command:\n        - /domino_docker_healthcheck.sh\n      initialDelaySeconds: 60\n      periodSeconds: 20\n    readinessProbe:\n      exec:\n        command:\n        - /domino_docker_healthcheck.sh\n        - ready\n      initialDelaySeconds: 60\n      periodSeconds: 20\n  initContainers:\n  - name: domino-startup\n    image: busybox:latest\n    command:\n    - sh\n    - -c\n    - chmod 777 /local\n    securityContext:\n      privileged: true\n      runAsNonRoot: false\n      runAsUser: 0\n    volumeMounts:\n    - name: domino-data\n      mountPath: /local\n  volumes:\n  - name: domino-data\n    persistentVolumeClaim:\n      claimName: local-path-pvc\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"domino12\" is using an invalid container image, \"registry.domino-lab.net:5000/hclcom/domino:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02892",
    "manifest_path": "data/manifests/the_stack_sample/sample_1174.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: domino12\n  namespace: default\n  labels:\n    app: hcl-domino\nspec:\n  securityContext:\n    runAsNonRoot: true\n    runAsUser: 1000\n    fsGroup: 1000\n    fsGroupChangePolicy: OnRootMismatch\n  containers:\n  - env:\n    - name: LANG\n      value: en_US.UTF-8\n    - name: DOMINO_DOCKER_STDOUT\n      value: 'yes'\n    - name: SetupAutoConfigure\n      value: '1'\n    - name: SERVERSETUP_SERVER_TYPE\n      value: first\n    - name: SERVERSETUP_ADMIN_FIRSTNAME\n      value: Martin\n    - name: SERVERSETUP_ADMIN_LASTNAME\n      value: Bishop\n    - name: SERVERSETUP_ADMIN_PASSWORD\n      value: 2manysecrets\n    - name: SERVERSETUP_ADMIN_IDFILEPATH\n      value: /local/notesdata/domino/html/admin.id\n    - name: SERVERSETUP_NETWORK_HOSTNAME\n      value: master.domino-lab.net\n    - name: SERVERSETUP_ORG_CERTIFIERPASSWORD\n      value: 2manysecrets\n    - name: SERVERSETUP_SERVER_DOMAINNAME\n      value: DominoLab\n    - name: SERVERSETUP_ORG_ORGNAME\n      value: DominoLab\n    - name: SERVERSETUP_SERVER_NAME\n      value: master.domino.lab\n    - name: SERVERSETUP_SERVER_SERVERTASKS\n      value: replica,router,update,amgr,adminp,http,certmgr -ACCEPT_TOU_AUTO_CONFIG\n    - name: SERVERSETUP_SECURITY_ACL_PROHIBITANONYMOUSACCESS\n      value: 'true'\n    - name: SERVERSETUP_SECURITY_ACL_ADDLOCALDOMAINADMINS\n      value: 'true'\n    name: domino12\n    image: registry.domino-lab.net:5000/hclcom/domino:latest\n    securityContext:\n      capabilities:\n        add:\n        - SYS_PTRACE\n      runAsNonRoot: true\n      runAsUser: 1000\n    volumeMounts:\n    - name: domino-data\n      mountPath: /local\n    ports:\n    - containerPort: 1352\n      protocol: TCP\n    - containerPort: 80\n      protocol: TCP\n    - containerPort: 443\n      protocol: TCP\n    livenessProbe:\n      exec:\n        command:\n        - /domino_docker_healthcheck.sh\n      initialDelaySeconds: 60\n      periodSeconds: 20\n    readinessProbe:\n      exec:\n        command:\n        - /domino_docker_healthcheck.sh\n        - ready\n      initialDelaySeconds: 60\n      periodSeconds: 20\n  initContainers:\n  - name: domino-startup\n    image: busybox:latest\n    command:\n    - sh\n    - -c\n    - chmod 777 /local\n    securityContext:\n      privileged: true\n      runAsNonRoot: false\n      runAsUser: 0\n    volumeMounts:\n    - name: domino-data\n      mountPath: /local\n  volumes:\n  - name: domino-data\n    persistentVolumeClaim:\n      claimName: local-path-pvc\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"domino-startup\" does not have a read-only root file system"
  },
  {
    "id": "02893",
    "manifest_path": "data/manifests/the_stack_sample/sample_1174.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: domino12\n  namespace: default\n  labels:\n    app: hcl-domino\nspec:\n  securityContext:\n    runAsNonRoot: true\n    runAsUser: 1000\n    fsGroup: 1000\n    fsGroupChangePolicy: OnRootMismatch\n  containers:\n  - env:\n    - name: LANG\n      value: en_US.UTF-8\n    - name: DOMINO_DOCKER_STDOUT\n      value: 'yes'\n    - name: SetupAutoConfigure\n      value: '1'\n    - name: SERVERSETUP_SERVER_TYPE\n      value: first\n    - name: SERVERSETUP_ADMIN_FIRSTNAME\n      value: Martin\n    - name: SERVERSETUP_ADMIN_LASTNAME\n      value: Bishop\n    - name: SERVERSETUP_ADMIN_PASSWORD\n      value: 2manysecrets\n    - name: SERVERSETUP_ADMIN_IDFILEPATH\n      value: /local/notesdata/domino/html/admin.id\n    - name: SERVERSETUP_NETWORK_HOSTNAME\n      value: master.domino-lab.net\n    - name: SERVERSETUP_ORG_CERTIFIERPASSWORD\n      value: 2manysecrets\n    - name: SERVERSETUP_SERVER_DOMAINNAME\n      value: DominoLab\n    - name: SERVERSETUP_ORG_ORGNAME\n      value: DominoLab\n    - name: SERVERSETUP_SERVER_NAME\n      value: master.domino.lab\n    - name: SERVERSETUP_SERVER_SERVERTASKS\n      value: replica,router,update,amgr,adminp,http,certmgr -ACCEPT_TOU_AUTO_CONFIG\n    - name: SERVERSETUP_SECURITY_ACL_PROHIBITANONYMOUSACCESS\n      value: 'true'\n    - name: SERVERSETUP_SECURITY_ACL_ADDLOCALDOMAINADMINS\n      value: 'true'\n    name: domino12\n    image: registry.domino-lab.net:5000/hclcom/domino:latest\n    securityContext:\n      capabilities:\n        add:\n        - SYS_PTRACE\n      runAsNonRoot: true\n      runAsUser: 1000\n    volumeMounts:\n    - name: domino-data\n      mountPath: /local\n    ports:\n    - containerPort: 1352\n      protocol: TCP\n    - containerPort: 80\n      protocol: TCP\n    - containerPort: 443\n      protocol: TCP\n    livenessProbe:\n      exec:\n        command:\n        - /domino_docker_healthcheck.sh\n      initialDelaySeconds: 60\n      periodSeconds: 20\n    readinessProbe:\n      exec:\n        command:\n        - /domino_docker_healthcheck.sh\n        - ready\n      initialDelaySeconds: 60\n      periodSeconds: 20\n  initContainers:\n  - name: domino-startup\n    image: busybox:latest\n    command:\n    - sh\n    - -c\n    - chmod 777 /local\n    securityContext:\n      privileged: true\n      runAsNonRoot: false\n      runAsUser: 0\n    volumeMounts:\n    - name: domino-data\n      mountPath: /local\n  volumes:\n  - name: domino-data\n    persistentVolumeClaim:\n      claimName: local-path-pvc\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"domino12\" does not have a read-only root file system"
  },
  {
    "id": "02894",
    "manifest_path": "data/manifests/the_stack_sample/sample_1174.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: domino12\n  namespace: default\n  labels:\n    app: hcl-domino\nspec:\n  securityContext:\n    runAsNonRoot: true\n    runAsUser: 1000\n    fsGroup: 1000\n    fsGroupChangePolicy: OnRootMismatch\n  containers:\n  - env:\n    - name: LANG\n      value: en_US.UTF-8\n    - name: DOMINO_DOCKER_STDOUT\n      value: 'yes'\n    - name: SetupAutoConfigure\n      value: '1'\n    - name: SERVERSETUP_SERVER_TYPE\n      value: first\n    - name: SERVERSETUP_ADMIN_FIRSTNAME\n      value: Martin\n    - name: SERVERSETUP_ADMIN_LASTNAME\n      value: Bishop\n    - name: SERVERSETUP_ADMIN_PASSWORD\n      value: 2manysecrets\n    - name: SERVERSETUP_ADMIN_IDFILEPATH\n      value: /local/notesdata/domino/html/admin.id\n    - name: SERVERSETUP_NETWORK_HOSTNAME\n      value: master.domino-lab.net\n    - name: SERVERSETUP_ORG_CERTIFIERPASSWORD\n      value: 2manysecrets\n    - name: SERVERSETUP_SERVER_DOMAINNAME\n      value: DominoLab\n    - name: SERVERSETUP_ORG_ORGNAME\n      value: DominoLab\n    - name: SERVERSETUP_SERVER_NAME\n      value: master.domino.lab\n    - name: SERVERSETUP_SERVER_SERVERTASKS\n      value: replica,router,update,amgr,adminp,http,certmgr -ACCEPT_TOU_AUTO_CONFIG\n    - name: SERVERSETUP_SECURITY_ACL_PROHIBITANONYMOUSACCESS\n      value: 'true'\n    - name: SERVERSETUP_SECURITY_ACL_ADDLOCALDOMAINADMINS\n      value: 'true'\n    name: domino12\n    image: registry.domino-lab.net:5000/hclcom/domino:latest\n    securityContext:\n      capabilities:\n        add:\n        - SYS_PTRACE\n      runAsNonRoot: true\n      runAsUser: 1000\n    volumeMounts:\n    - name: domino-data\n      mountPath: /local\n    ports:\n    - containerPort: 1352\n      protocol: TCP\n    - containerPort: 80\n      protocol: TCP\n    - containerPort: 443\n      protocol: TCP\n    livenessProbe:\n      exec:\n        command:\n        - /domino_docker_healthcheck.sh\n      initialDelaySeconds: 60\n      periodSeconds: 20\n    readinessProbe:\n      exec:\n        command:\n        - /domino_docker_healthcheck.sh\n        - ready\n      initialDelaySeconds: 60\n      periodSeconds: 20\n  initContainers:\n  - name: domino-startup\n    image: busybox:latest\n    command:\n    - sh\n    - -c\n    - chmod 777 /local\n    securityContext:\n      privileged: true\n      runAsNonRoot: false\n      runAsUser: 0\n    volumeMounts:\n    - name: domino-data\n      mountPath: /local\n  volumes:\n  - name: domino-data\n    persistentVolumeClaim:\n      claimName: local-path-pvc\n",
    "policy_id": "privilege-escalation-container",
    "violation_text": "container \"domino-startup\" is Privileged hence allows privilege escalation."
  },
  {
    "id": "02895",
    "manifest_path": "data/manifests/the_stack_sample/sample_1174.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: domino12\n  namespace: default\n  labels:\n    app: hcl-domino\nspec:\n  securityContext:\n    runAsNonRoot: true\n    runAsUser: 1000\n    fsGroup: 1000\n    fsGroupChangePolicy: OnRootMismatch\n  containers:\n  - env:\n    - name: LANG\n      value: en_US.UTF-8\n    - name: DOMINO_DOCKER_STDOUT\n      value: 'yes'\n    - name: SetupAutoConfigure\n      value: '1'\n    - name: SERVERSETUP_SERVER_TYPE\n      value: first\n    - name: SERVERSETUP_ADMIN_FIRSTNAME\n      value: Martin\n    - name: SERVERSETUP_ADMIN_LASTNAME\n      value: Bishop\n    - name: SERVERSETUP_ADMIN_PASSWORD\n      value: 2manysecrets\n    - name: SERVERSETUP_ADMIN_IDFILEPATH\n      value: /local/notesdata/domino/html/admin.id\n    - name: SERVERSETUP_NETWORK_HOSTNAME\n      value: master.domino-lab.net\n    - name: SERVERSETUP_ORG_CERTIFIERPASSWORD\n      value: 2manysecrets\n    - name: SERVERSETUP_SERVER_DOMAINNAME\n      value: DominoLab\n    - name: SERVERSETUP_ORG_ORGNAME\n      value: DominoLab\n    - name: SERVERSETUP_SERVER_NAME\n      value: master.domino.lab\n    - name: SERVERSETUP_SERVER_SERVERTASKS\n      value: replica,router,update,amgr,adminp,http,certmgr -ACCEPT_TOU_AUTO_CONFIG\n    - name: SERVERSETUP_SECURITY_ACL_PROHIBITANONYMOUSACCESS\n      value: 'true'\n    - name: SERVERSETUP_SECURITY_ACL_ADDLOCALDOMAINADMINS\n      value: 'true'\n    name: domino12\n    image: registry.domino-lab.net:5000/hclcom/domino:latest\n    securityContext:\n      capabilities:\n        add:\n        - SYS_PTRACE\n      runAsNonRoot: true\n      runAsUser: 1000\n    volumeMounts:\n    - name: domino-data\n      mountPath: /local\n    ports:\n    - containerPort: 1352\n      protocol: TCP\n    - containerPort: 80\n      protocol: TCP\n    - containerPort: 443\n      protocol: TCP\n    livenessProbe:\n      exec:\n        command:\n        - /domino_docker_healthcheck.sh\n      initialDelaySeconds: 60\n      periodSeconds: 20\n    readinessProbe:\n      exec:\n        command:\n        - /domino_docker_healthcheck.sh\n        - ready\n      initialDelaySeconds: 60\n      periodSeconds: 20\n  initContainers:\n  - name: domino-startup\n    image: busybox:latest\n    command:\n    - sh\n    - -c\n    - chmod 777 /local\n    securityContext:\n      privileged: true\n      runAsNonRoot: false\n      runAsUser: 0\n    volumeMounts:\n    - name: domino-data\n      mountPath: /local\n  volumes:\n  - name: domino-data\n    persistentVolumeClaim:\n      claimName: local-path-pvc\n",
    "policy_id": "privileged-container",
    "violation_text": "container \"domino-startup\" is privileged"
  },
  {
    "id": "02896",
    "manifest_path": "data/manifests/the_stack_sample/sample_1174.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: domino12\n  namespace: default\n  labels:\n    app: hcl-domino\nspec:\n  securityContext:\n    runAsNonRoot: true\n    runAsUser: 1000\n    fsGroup: 1000\n    fsGroupChangePolicy: OnRootMismatch\n  containers:\n  - env:\n    - name: LANG\n      value: en_US.UTF-8\n    - name: DOMINO_DOCKER_STDOUT\n      value: 'yes'\n    - name: SetupAutoConfigure\n      value: '1'\n    - name: SERVERSETUP_SERVER_TYPE\n      value: first\n    - name: SERVERSETUP_ADMIN_FIRSTNAME\n      value: Martin\n    - name: SERVERSETUP_ADMIN_LASTNAME\n      value: Bishop\n    - name: SERVERSETUP_ADMIN_PASSWORD\n      value: 2manysecrets\n    - name: SERVERSETUP_ADMIN_IDFILEPATH\n      value: /local/notesdata/domino/html/admin.id\n    - name: SERVERSETUP_NETWORK_HOSTNAME\n      value: master.domino-lab.net\n    - name: SERVERSETUP_ORG_CERTIFIERPASSWORD\n      value: 2manysecrets\n    - name: SERVERSETUP_SERVER_DOMAINNAME\n      value: DominoLab\n    - name: SERVERSETUP_ORG_ORGNAME\n      value: DominoLab\n    - name: SERVERSETUP_SERVER_NAME\n      value: master.domino.lab\n    - name: SERVERSETUP_SERVER_SERVERTASKS\n      value: replica,router,update,amgr,adminp,http,certmgr -ACCEPT_TOU_AUTO_CONFIG\n    - name: SERVERSETUP_SECURITY_ACL_PROHIBITANONYMOUSACCESS\n      value: 'true'\n    - name: SERVERSETUP_SECURITY_ACL_ADDLOCALDOMAINADMINS\n      value: 'true'\n    name: domino12\n    image: registry.domino-lab.net:5000/hclcom/domino:latest\n    securityContext:\n      capabilities:\n        add:\n        - SYS_PTRACE\n      runAsNonRoot: true\n      runAsUser: 1000\n    volumeMounts:\n    - name: domino-data\n      mountPath: /local\n    ports:\n    - containerPort: 1352\n      protocol: TCP\n    - containerPort: 80\n      protocol: TCP\n    - containerPort: 443\n      protocol: TCP\n    livenessProbe:\n      exec:\n        command:\n        - /domino_docker_healthcheck.sh\n      initialDelaySeconds: 60\n      periodSeconds: 20\n    readinessProbe:\n      exec:\n        command:\n        - /domino_docker_healthcheck.sh\n        - ready\n      initialDelaySeconds: 60\n      periodSeconds: 20\n  initContainers:\n  - name: domino-startup\n    image: busybox:latest\n    command:\n    - sh\n    - -c\n    - chmod 777 /local\n    securityContext:\n      privileged: true\n      runAsNonRoot: false\n      runAsUser: 0\n    volumeMounts:\n    - name: domino-data\n      mountPath: /local\n  volumes:\n  - name: domino-data\n    persistentVolumeClaim:\n      claimName: local-path-pvc\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"domino-startup\" is not set to runAsNonRoot"
  },
  {
    "id": "02897",
    "manifest_path": "data/manifests/the_stack_sample/sample_1174.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: domino12\n  namespace: default\n  labels:\n    app: hcl-domino\nspec:\n  securityContext:\n    runAsNonRoot: true\n    runAsUser: 1000\n    fsGroup: 1000\n    fsGroupChangePolicy: OnRootMismatch\n  containers:\n  - env:\n    - name: LANG\n      value: en_US.UTF-8\n    - name: DOMINO_DOCKER_STDOUT\n      value: 'yes'\n    - name: SetupAutoConfigure\n      value: '1'\n    - name: SERVERSETUP_SERVER_TYPE\n      value: first\n    - name: SERVERSETUP_ADMIN_FIRSTNAME\n      value: Martin\n    - name: SERVERSETUP_ADMIN_LASTNAME\n      value: Bishop\n    - name: SERVERSETUP_ADMIN_PASSWORD\n      value: 2manysecrets\n    - name: SERVERSETUP_ADMIN_IDFILEPATH\n      value: /local/notesdata/domino/html/admin.id\n    - name: SERVERSETUP_NETWORK_HOSTNAME\n      value: master.domino-lab.net\n    - name: SERVERSETUP_ORG_CERTIFIERPASSWORD\n      value: 2manysecrets\n    - name: SERVERSETUP_SERVER_DOMAINNAME\n      value: DominoLab\n    - name: SERVERSETUP_ORG_ORGNAME\n      value: DominoLab\n    - name: SERVERSETUP_SERVER_NAME\n      value: master.domino.lab\n    - name: SERVERSETUP_SERVER_SERVERTASKS\n      value: replica,router,update,amgr,adminp,http,certmgr -ACCEPT_TOU_AUTO_CONFIG\n    - name: SERVERSETUP_SECURITY_ACL_PROHIBITANONYMOUSACCESS\n      value: 'true'\n    - name: SERVERSETUP_SECURITY_ACL_ADDLOCALDOMAINADMINS\n      value: 'true'\n    name: domino12\n    image: registry.domino-lab.net:5000/hclcom/domino:latest\n    securityContext:\n      capabilities:\n        add:\n        - SYS_PTRACE\n      runAsNonRoot: true\n      runAsUser: 1000\n    volumeMounts:\n    - name: domino-data\n      mountPath: /local\n    ports:\n    - containerPort: 1352\n      protocol: TCP\n    - containerPort: 80\n      protocol: TCP\n    - containerPort: 443\n      protocol: TCP\n    livenessProbe:\n      exec:\n        command:\n        - /domino_docker_healthcheck.sh\n      initialDelaySeconds: 60\n      periodSeconds: 20\n    readinessProbe:\n      exec:\n        command:\n        - /domino_docker_healthcheck.sh\n        - ready\n      initialDelaySeconds: 60\n      periodSeconds: 20\n  initContainers:\n  - name: domino-startup\n    image: busybox:latest\n    command:\n    - sh\n    - -c\n    - chmod 777 /local\n    securityContext:\n      privileged: true\n      runAsNonRoot: false\n      runAsUser: 0\n    volumeMounts:\n    - name: domino-data\n      mountPath: /local\n  volumes:\n  - name: domino-data\n    persistentVolumeClaim:\n      claimName: local-path-pvc\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"domino-startup\" has cpu request 0"
  },
  {
    "id": "02898",
    "manifest_path": "data/manifests/the_stack_sample/sample_1174.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: domino12\n  namespace: default\n  labels:\n    app: hcl-domino\nspec:\n  securityContext:\n    runAsNonRoot: true\n    runAsUser: 1000\n    fsGroup: 1000\n    fsGroupChangePolicy: OnRootMismatch\n  containers:\n  - env:\n    - name: LANG\n      value: en_US.UTF-8\n    - name: DOMINO_DOCKER_STDOUT\n      value: 'yes'\n    - name: SetupAutoConfigure\n      value: '1'\n    - name: SERVERSETUP_SERVER_TYPE\n      value: first\n    - name: SERVERSETUP_ADMIN_FIRSTNAME\n      value: Martin\n    - name: SERVERSETUP_ADMIN_LASTNAME\n      value: Bishop\n    - name: SERVERSETUP_ADMIN_PASSWORD\n      value: 2manysecrets\n    - name: SERVERSETUP_ADMIN_IDFILEPATH\n      value: /local/notesdata/domino/html/admin.id\n    - name: SERVERSETUP_NETWORK_HOSTNAME\n      value: master.domino-lab.net\n    - name: SERVERSETUP_ORG_CERTIFIERPASSWORD\n      value: 2manysecrets\n    - name: SERVERSETUP_SERVER_DOMAINNAME\n      value: DominoLab\n    - name: SERVERSETUP_ORG_ORGNAME\n      value: DominoLab\n    - name: SERVERSETUP_SERVER_NAME\n      value: master.domino.lab\n    - name: SERVERSETUP_SERVER_SERVERTASKS\n      value: replica,router,update,amgr,adminp,http,certmgr -ACCEPT_TOU_AUTO_CONFIG\n    - name: SERVERSETUP_SECURITY_ACL_PROHIBITANONYMOUSACCESS\n      value: 'true'\n    - name: SERVERSETUP_SECURITY_ACL_ADDLOCALDOMAINADMINS\n      value: 'true'\n    name: domino12\n    image: registry.domino-lab.net:5000/hclcom/domino:latest\n    securityContext:\n      capabilities:\n        add:\n        - SYS_PTRACE\n      runAsNonRoot: true\n      runAsUser: 1000\n    volumeMounts:\n    - name: domino-data\n      mountPath: /local\n    ports:\n    - containerPort: 1352\n      protocol: TCP\n    - containerPort: 80\n      protocol: TCP\n    - containerPort: 443\n      protocol: TCP\n    livenessProbe:\n      exec:\n        command:\n        - /domino_docker_healthcheck.sh\n      initialDelaySeconds: 60\n      periodSeconds: 20\n    readinessProbe:\n      exec:\n        command:\n        - /domino_docker_healthcheck.sh\n        - ready\n      initialDelaySeconds: 60\n      periodSeconds: 20\n  initContainers:\n  - name: domino-startup\n    image: busybox:latest\n    command:\n    - sh\n    - -c\n    - chmod 777 /local\n    securityContext:\n      privileged: true\n      runAsNonRoot: false\n      runAsUser: 0\n    volumeMounts:\n    - name: domino-data\n      mountPath: /local\n  volumes:\n  - name: domino-data\n    persistentVolumeClaim:\n      claimName: local-path-pvc\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"domino12\" has cpu request 0"
  },
  {
    "id": "02899",
    "manifest_path": "data/manifests/the_stack_sample/sample_1174.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: domino12\n  namespace: default\n  labels:\n    app: hcl-domino\nspec:\n  securityContext:\n    runAsNonRoot: true\n    runAsUser: 1000\n    fsGroup: 1000\n    fsGroupChangePolicy: OnRootMismatch\n  containers:\n  - env:\n    - name: LANG\n      value: en_US.UTF-8\n    - name: DOMINO_DOCKER_STDOUT\n      value: 'yes'\n    - name: SetupAutoConfigure\n      value: '1'\n    - name: SERVERSETUP_SERVER_TYPE\n      value: first\n    - name: SERVERSETUP_ADMIN_FIRSTNAME\n      value: Martin\n    - name: SERVERSETUP_ADMIN_LASTNAME\n      value: Bishop\n    - name: SERVERSETUP_ADMIN_PASSWORD\n      value: 2manysecrets\n    - name: SERVERSETUP_ADMIN_IDFILEPATH\n      value: /local/notesdata/domino/html/admin.id\n    - name: SERVERSETUP_NETWORK_HOSTNAME\n      value: master.domino-lab.net\n    - name: SERVERSETUP_ORG_CERTIFIERPASSWORD\n      value: 2manysecrets\n    - name: SERVERSETUP_SERVER_DOMAINNAME\n      value: DominoLab\n    - name: SERVERSETUP_ORG_ORGNAME\n      value: DominoLab\n    - name: SERVERSETUP_SERVER_NAME\n      value: master.domino.lab\n    - name: SERVERSETUP_SERVER_SERVERTASKS\n      value: replica,router,update,amgr,adminp,http,certmgr -ACCEPT_TOU_AUTO_CONFIG\n    - name: SERVERSETUP_SECURITY_ACL_PROHIBITANONYMOUSACCESS\n      value: 'true'\n    - name: SERVERSETUP_SECURITY_ACL_ADDLOCALDOMAINADMINS\n      value: 'true'\n    name: domino12\n    image: registry.domino-lab.net:5000/hclcom/domino:latest\n    securityContext:\n      capabilities:\n        add:\n        - SYS_PTRACE\n      runAsNonRoot: true\n      runAsUser: 1000\n    volumeMounts:\n    - name: domino-data\n      mountPath: /local\n    ports:\n    - containerPort: 1352\n      protocol: TCP\n    - containerPort: 80\n      protocol: TCP\n    - containerPort: 443\n      protocol: TCP\n    livenessProbe:\n      exec:\n        command:\n        - /domino_docker_healthcheck.sh\n      initialDelaySeconds: 60\n      periodSeconds: 20\n    readinessProbe:\n      exec:\n        command:\n        - /domino_docker_healthcheck.sh\n        - ready\n      initialDelaySeconds: 60\n      periodSeconds: 20\n  initContainers:\n  - name: domino-startup\n    image: busybox:latest\n    command:\n    - sh\n    - -c\n    - chmod 777 /local\n    securityContext:\n      privileged: true\n      runAsNonRoot: false\n      runAsUser: 0\n    volumeMounts:\n    - name: domino-data\n      mountPath: /local\n  volumes:\n  - name: domino-data\n    persistentVolumeClaim:\n      claimName: local-path-pvc\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"domino-startup\" has memory limit 0"
  },
  {
    "id": "02900",
    "manifest_path": "data/manifests/the_stack_sample/sample_1174.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: domino12\n  namespace: default\n  labels:\n    app: hcl-domino\nspec:\n  securityContext:\n    runAsNonRoot: true\n    runAsUser: 1000\n    fsGroup: 1000\n    fsGroupChangePolicy: OnRootMismatch\n  containers:\n  - env:\n    - name: LANG\n      value: en_US.UTF-8\n    - name: DOMINO_DOCKER_STDOUT\n      value: 'yes'\n    - name: SetupAutoConfigure\n      value: '1'\n    - name: SERVERSETUP_SERVER_TYPE\n      value: first\n    - name: SERVERSETUP_ADMIN_FIRSTNAME\n      value: Martin\n    - name: SERVERSETUP_ADMIN_LASTNAME\n      value: Bishop\n    - name: SERVERSETUP_ADMIN_PASSWORD\n      value: 2manysecrets\n    - name: SERVERSETUP_ADMIN_IDFILEPATH\n      value: /local/notesdata/domino/html/admin.id\n    - name: SERVERSETUP_NETWORK_HOSTNAME\n      value: master.domino-lab.net\n    - name: SERVERSETUP_ORG_CERTIFIERPASSWORD\n      value: 2manysecrets\n    - name: SERVERSETUP_SERVER_DOMAINNAME\n      value: DominoLab\n    - name: SERVERSETUP_ORG_ORGNAME\n      value: DominoLab\n    - name: SERVERSETUP_SERVER_NAME\n      value: master.domino.lab\n    - name: SERVERSETUP_SERVER_SERVERTASKS\n      value: replica,router,update,amgr,adminp,http,certmgr -ACCEPT_TOU_AUTO_CONFIG\n    - name: SERVERSETUP_SECURITY_ACL_PROHIBITANONYMOUSACCESS\n      value: 'true'\n    - name: SERVERSETUP_SECURITY_ACL_ADDLOCALDOMAINADMINS\n      value: 'true'\n    name: domino12\n    image: registry.domino-lab.net:5000/hclcom/domino:latest\n    securityContext:\n      capabilities:\n        add:\n        - SYS_PTRACE\n      runAsNonRoot: true\n      runAsUser: 1000\n    volumeMounts:\n    - name: domino-data\n      mountPath: /local\n    ports:\n    - containerPort: 1352\n      protocol: TCP\n    - containerPort: 80\n      protocol: TCP\n    - containerPort: 443\n      protocol: TCP\n    livenessProbe:\n      exec:\n        command:\n        - /domino_docker_healthcheck.sh\n      initialDelaySeconds: 60\n      periodSeconds: 20\n    readinessProbe:\n      exec:\n        command:\n        - /domino_docker_healthcheck.sh\n        - ready\n      initialDelaySeconds: 60\n      periodSeconds: 20\n  initContainers:\n  - name: domino-startup\n    image: busybox:latest\n    command:\n    - sh\n    - -c\n    - chmod 777 /local\n    securityContext:\n      privileged: true\n      runAsNonRoot: false\n      runAsUser: 0\n    volumeMounts:\n    - name: domino-data\n      mountPath: /local\n  volumes:\n  - name: domino-data\n    persistentVolumeClaim:\n      claimName: local-path-pvc\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"domino12\" has memory limit 0"
  },
  {
    "id": "02901",
    "manifest_path": "data/manifests/the_stack_sample/sample_1177.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: edge-worker\n  labels:\n    app: edge-worker\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: edge-worker\n  template:\n    metadata:\n      labels:\n        app: edge-worker\n    spec:\n      containers:\n      - name: edge-worker\n        image: mfatihaktas/edge-load-balance\n        ports:\n        - containerPort: 5000\n        command:\n        - python3\n        - -u\n        args:\n        - /home/app/worker.py\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"edge-worker\" is using an invalid container image, \"mfatihaktas/edge-load-balance\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02902",
    "manifest_path": "data/manifests/the_stack_sample/sample_1177.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: edge-worker\n  labels:\n    app: edge-worker\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: edge-worker\n  template:\n    metadata:\n      labels:\n        app: edge-worker\n    spec:\n      containers:\n      - name: edge-worker\n        image: mfatihaktas/edge-load-balance\n        ports:\n        - containerPort: 5000\n        command:\n        - python3\n        - -u\n        args:\n        - /home/app/worker.py\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"edge-worker\" does not have a read-only root file system"
  },
  {
    "id": "02903",
    "manifest_path": "data/manifests/the_stack_sample/sample_1177.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: edge-worker\n  labels:\n    app: edge-worker\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: edge-worker\n  template:\n    metadata:\n      labels:\n        app: edge-worker\n    spec:\n      containers:\n      - name: edge-worker\n        image: mfatihaktas/edge-load-balance\n        ports:\n        - containerPort: 5000\n        command:\n        - python3\n        - -u\n        args:\n        - /home/app/worker.py\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"edge-worker\" is not set to runAsNonRoot"
  },
  {
    "id": "02904",
    "manifest_path": "data/manifests/the_stack_sample/sample_1177.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: edge-worker\n  labels:\n    app: edge-worker\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: edge-worker\n  template:\n    metadata:\n      labels:\n        app: edge-worker\n    spec:\n      containers:\n      - name: edge-worker\n        image: mfatihaktas/edge-load-balance\n        ports:\n        - containerPort: 5000\n        command:\n        - python3\n        - -u\n        args:\n        - /home/app/worker.py\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"edge-worker\" has cpu request 0"
  },
  {
    "id": "02905",
    "manifest_path": "data/manifests/the_stack_sample/sample_1177.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: edge-worker\n  labels:\n    app: edge-worker\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: edge-worker\n  template:\n    metadata:\n      labels:\n        app: edge-worker\n    spec:\n      containers:\n      - name: edge-worker\n        image: mfatihaktas/edge-load-balance\n        ports:\n        - containerPort: 5000\n        command:\n        - python3\n        - -u\n        args:\n        - /home/app/worker.py\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"edge-worker\" has memory limit 0"
  },
  {
    "id": "02906",
    "manifest_path": "data/manifests/the_stack_sample/sample_1180.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: storage-pod\nspec:\n  containers:\n  - name: storage-pod\n    image: ubuntu\n    command:\n    - /bin/bash\n    - -ec\n    - while :; do sleep 2; done\n    volumeMounts:\n    - mountPath: /data\n      name: storage-pvc\n  volumes:\n  - name: storage-pvc\n    persistentVolumeClaim:\n      claimName: storage-pvc\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"storage-pod\" is using an invalid container image, \"ubuntu\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02907",
    "manifest_path": "data/manifests/the_stack_sample/sample_1180.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: storage-pod\nspec:\n  containers:\n  - name: storage-pod\n    image: ubuntu\n    command:\n    - /bin/bash\n    - -ec\n    - while :; do sleep 2; done\n    volumeMounts:\n    - mountPath: /data\n      name: storage-pvc\n  volumes:\n  - name: storage-pvc\n    persistentVolumeClaim:\n      claimName: storage-pvc\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"storage-pod\" does not have a read-only root file system"
  },
  {
    "id": "02908",
    "manifest_path": "data/manifests/the_stack_sample/sample_1180.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: storage-pod\nspec:\n  containers:\n  - name: storage-pod\n    image: ubuntu\n    command:\n    - /bin/bash\n    - -ec\n    - while :; do sleep 2; done\n    volumeMounts:\n    - mountPath: /data\n      name: storage-pvc\n  volumes:\n  - name: storage-pvc\n    persistentVolumeClaim:\n      claimName: storage-pvc\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"storage-pod\" is not set to runAsNonRoot"
  },
  {
    "id": "02909",
    "manifest_path": "data/manifests/the_stack_sample/sample_1180.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: storage-pod\nspec:\n  containers:\n  - name: storage-pod\n    image: ubuntu\n    command:\n    - /bin/bash\n    - -ec\n    - while :; do sleep 2; done\n    volumeMounts:\n    - mountPath: /data\n      name: storage-pvc\n  volumes:\n  - name: storage-pvc\n    persistentVolumeClaim:\n      claimName: storage-pvc\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"storage-pod\" has cpu request 0"
  },
  {
    "id": "02910",
    "manifest_path": "data/manifests/the_stack_sample/sample_1180.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: storage-pod\nspec:\n  containers:\n  - name: storage-pod\n    image: ubuntu\n    command:\n    - /bin/bash\n    - -ec\n    - while :; do sleep 2; done\n    volumeMounts:\n    - mountPath: /data\n      name: storage-pvc\n  volumes:\n  - name: storage-pvc\n    persistentVolumeClaim:\n      claimName: storage-pvc\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"storage-pod\" has memory limit 0"
  },
  {
    "id": "02911",
    "manifest_path": "data/manifests/the_stack_sample/sample_1184.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: jenkins\n  namespace: jenkins\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: jenkins-server\n  template:\n    metadata:\n      labels:\n        app: jenkins-server\n    spec:\n      securityContext:\n        fsGroup: 1000\n        runAsUser: 1000\n      serviceAccountName: jenkins-admin\n      containers:\n      - name: jenkins\n        image: jenkins4eval/jenkins:latest\n        resources:\n          limits:\n            memory: 1Gi\n            cpu: 1000m\n          requests:\n            memory: 500Mi\n            cpu: 500m\n        ports:\n        - name: httpport\n          containerPort: 8080\n        - name: jnlpport\n          containerPort: 50000\n        volumeMounts:\n        - name: jenkins-data\n          mountPath: /var/jenkins_home\n      volumes:\n      - name: jenkins-data\n        persistentVolumeClaim:\n          claimName: jenkins-pvc\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"jenkins\" is using an invalid container image, \"jenkins4eval/jenkins:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02912",
    "manifest_path": "data/manifests/the_stack_sample/sample_1184.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: jenkins\n  namespace: jenkins\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: jenkins-server\n  template:\n    metadata:\n      labels:\n        app: jenkins-server\n    spec:\n      securityContext:\n        fsGroup: 1000\n        runAsUser: 1000\n      serviceAccountName: jenkins-admin\n      containers:\n      - name: jenkins\n        image: jenkins4eval/jenkins:latest\n        resources:\n          limits:\n            memory: 1Gi\n            cpu: 1000m\n          requests:\n            memory: 500Mi\n            cpu: 500m\n        ports:\n        - name: httpport\n          containerPort: 8080\n        - name: jnlpport\n          containerPort: 50000\n        volumeMounts:\n        - name: jenkins-data\n          mountPath: /var/jenkins_home\n      volumes:\n      - name: jenkins-data\n        persistentVolumeClaim:\n          claimName: jenkins-pvc\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"jenkins\" does not have a read-only root file system"
  },
  {
    "id": "02913",
    "manifest_path": "data/manifests/the_stack_sample/sample_1186.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-4295\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"nginx\" is using an invalid container image, \"nginx\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "02914",
    "manifest_path": "data/manifests/the_stack_sample/sample_1186.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-4295\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"nginx\" does not have a read-only root file system"
  },
  {
    "id": "02915",
    "manifest_path": "data/manifests/the_stack_sample/sample_1186.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-4295\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"nginx\" is not set to runAsNonRoot"
  },
  {
    "id": "02916",
    "manifest_path": "data/manifests/the_stack_sample/sample_1186.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-4295\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"nginx\" has cpu request 0"
  },
  {
    "id": "02917",
    "manifest_path": "data/manifests/the_stack_sample/sample_1186.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-4295\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"nginx\" has memory limit 0"
  },
  {
    "id": "02918",
    "manifest_path": "data/manifests/the_stack_sample/sample_1188.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: kube-dns-v10\n  namespace: kube-system\n  labels:\n    k8s-app: kube-dns\n    version: v10\n    kubernetes.io/cluster-service: 'true'\nspec:\n  replicas: 1\n  selector:\n    k8s-app: kube-dns\n    version: v10\n  template:\n    metadata:\n      labels:\n        k8s-app: kube-dns\n        version: v10\n        kubernetes.io/cluster-service: 'true'\n    spec:\n      containers:\n      - name: etcd\n        image: gcr.io/google_containers/etcd:2.0.9\n        resources:\n          limits:\n            cpu: 100m\n            memory: 50Mi\n          requests:\n            cpu: 100m\n            memory: 50Mi\n        command:\n        - /usr/local/bin/etcd\n        - -data-dir\n        - /var/etcd/data\n        - -listen-client-urls\n        - http://127.0.0.1:2379,http://127.0.0.1:4001\n        - -advertise-client-urls\n        - http://127.0.0.1:2379,http://127.0.0.1:4001\n        - -initial-cluster-token\n        - skydns-etcd\n        volumeMounts:\n        - name: etcd-storage\n          mountPath: /var/etcd/data\n      - name: kube2sky\n        image: gcr.io/google_containers/kube2sky:1.12\n        resources:\n          limits:\n            cpu: 100m\n            memory: 50Mi\n          requests:\n            cpu: 100m\n            memory: 50Mi\n        args:\n        - --domain=cluster.local\n      - name: skydns\n        image: gcr.io/google_containers/skydns:2015-10-13-8c72f8c\n        resources:\n          limits:\n            cpu: 100m\n            memory: 50Mi\n          requests:\n            cpu: 100m\n            memory: 50Mi\n        args:\n        - -machines=http://127.0.0.1:4001\n        - -addr=0.0.0.0:53\n        - -ns-rotate=false\n        - -domain=cluster.local.\n        ports:\n        - containerPort: 53\n          name: dns\n          protocol: UDP\n        - containerPort: 53\n          name: dns-tcp\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 8080\n            scheme: HTTP\n          initialDelaySeconds: 30\n          timeoutSeconds: 5\n        readinessProbe:\n          httpGet:\n            path: /healthz\n            port: 8080\n            scheme: HTTP\n          initialDelaySeconds: 1\n          timeoutSeconds: 5\n      - name: healthz\n        image: gcr.io/google_containers/exechealthz:1.0\n        resources:\n          limits:\n            cpu: 10m\n            memory: 20Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n        args:\n        - -cmd=nslookup kubernetes.default.svc.cluster.local 127.0.0.1 >/dev/null\n        - -port=8080\n        ports:\n        - containerPort: 8080\n          protocol: TCP\n      volumes:\n      - name: etcd-storage\n        emptyDir: {}\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"etcd\" does not have a read-only root file system"
  },
  {
    "id": "02919",
    "manifest_path": "data/manifests/the_stack_sample/sample_1188.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: kube-dns-v10\n  namespace: kube-system\n  labels:\n    k8s-app: kube-dns\n    version: v10\n    kubernetes.io/cluster-service: 'true'\nspec:\n  replicas: 1\n  selector:\n    k8s-app: kube-dns\n    version: v10\n  template:\n    metadata:\n      labels:\n        k8s-app: kube-dns\n        version: v10\n        kubernetes.io/cluster-service: 'true'\n    spec:\n      containers:\n      - name: etcd\n        image: gcr.io/google_containers/etcd:2.0.9\n        resources:\n          limits:\n            cpu: 100m\n            memory: 50Mi\n          requests:\n            cpu: 100m\n            memory: 50Mi\n        command:\n        - /usr/local/bin/etcd\n        - -data-dir\n        - /var/etcd/data\n        - -listen-client-urls\n        - http://127.0.0.1:2379,http://127.0.0.1:4001\n        - -advertise-client-urls\n        - http://127.0.0.1:2379,http://127.0.0.1:4001\n        - -initial-cluster-token\n        - skydns-etcd\n        volumeMounts:\n        - name: etcd-storage\n          mountPath: /var/etcd/data\n      - name: kube2sky\n        image: gcr.io/google_containers/kube2sky:1.12\n        resources:\n          limits:\n            cpu: 100m\n            memory: 50Mi\n          requests:\n            cpu: 100m\n            memory: 50Mi\n        args:\n        - --domain=cluster.local\n      - name: skydns\n        image: gcr.io/google_containers/skydns:2015-10-13-8c72f8c\n        resources:\n          limits:\n            cpu: 100m\n            memory: 50Mi\n          requests:\n            cpu: 100m\n            memory: 50Mi\n        args:\n        - -machines=http://127.0.0.1:4001\n        - -addr=0.0.0.0:53\n        - -ns-rotate=false\n        - -domain=cluster.local.\n        ports:\n        - containerPort: 53\n          name: dns\n          protocol: UDP\n        - containerPort: 53\n          name: dns-tcp\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 8080\n            scheme: HTTP\n          initialDelaySeconds: 30\n          timeoutSeconds: 5\n        readinessProbe:\n          httpGet:\n            path: /healthz\n            port: 8080\n            scheme: HTTP\n          initialDelaySeconds: 1\n          timeoutSeconds: 5\n      - name: healthz\n        image: gcr.io/google_containers/exechealthz:1.0\n        resources:\n          limits:\n            cpu: 10m\n            memory: 20Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n        args:\n        - -cmd=nslookup kubernetes.default.svc.cluster.local 127.0.0.1 >/dev/null\n        - -port=8080\n        ports:\n        - containerPort: 8080\n          protocol: TCP\n      volumes:\n      - name: etcd-storage\n        emptyDir: {}\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"healthz\" does not have a read-only root file system"
  },
  {
    "id": "02920",
    "manifest_path": "data/manifests/the_stack_sample/sample_1188.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: kube-dns-v10\n  namespace: kube-system\n  labels:\n    k8s-app: kube-dns\n    version: v10\n    kubernetes.io/cluster-service: 'true'\nspec:\n  replicas: 1\n  selector:\n    k8s-app: kube-dns\n    version: v10\n  template:\n    metadata:\n      labels:\n        k8s-app: kube-dns\n        version: v10\n        kubernetes.io/cluster-service: 'true'\n    spec:\n      containers:\n      - name: etcd\n        image: gcr.io/google_containers/etcd:2.0.9\n        resources:\n          limits:\n            cpu: 100m\n            memory: 50Mi\n          requests:\n            cpu: 100m\n            memory: 50Mi\n        command:\n        - /usr/local/bin/etcd\n        - -data-dir\n        - /var/etcd/data\n        - -listen-client-urls\n        - http://127.0.0.1:2379,http://127.0.0.1:4001\n        - -advertise-client-urls\n        - http://127.0.0.1:2379,http://127.0.0.1:4001\n        - -initial-cluster-token\n        - skydns-etcd\n        volumeMounts:\n        - name: etcd-storage\n          mountPath: /var/etcd/data\n      - name: kube2sky\n        image: gcr.io/google_containers/kube2sky:1.12\n        resources:\n          limits:\n            cpu: 100m\n            memory: 50Mi\n          requests:\n            cpu: 100m\n            memory: 50Mi\n        args:\n        - --domain=cluster.local\n      - name: skydns\n        image: gcr.io/google_containers/skydns:2015-10-13-8c72f8c\n        resources:\n          limits:\n            cpu: 100m\n            memory: 50Mi\n          requests:\n            cpu: 100m\n            memory: 50Mi\n        args:\n        - -machines=http://127.0.0.1:4001\n        - -addr=0.0.0.0:53\n        - -ns-rotate=false\n        - -domain=cluster.local.\n        ports:\n        - containerPort: 53\n          name: dns\n          protocol: UDP\n        - containerPort: 53\n          name: dns-tcp\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 8080\n            scheme: HTTP\n          initialDelaySeconds: 30\n          timeoutSeconds: 5\n        readinessProbe:\n          httpGet:\n            path: /healthz\n            port: 8080\n            scheme: HTTP\n          initialDelaySeconds: 1\n          timeoutSeconds: 5\n      - name: healthz\n        image: gcr.io/google_containers/exechealthz:1.0\n        resources:\n          limits:\n            cpu: 10m\n            memory: 20Mi\n          requests:\n            cpu: 10m\n            memory: 20Mi\n        args:\n        - -cmd=nslookup kubernetes.default.svc.cluster.local 127.0.0.1 >/dev/null\n        - -port=8080\n        ports:\n        - containerPort: 8080\n          protocol: TCP\n      volumes:\n      - name: etcd-storage\n        emptyDir: {}\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"kube2sky\" does not have a read-only root file system"
  }
]