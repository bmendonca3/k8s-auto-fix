[
  {
    "id": "04561",
    "manifest_path": "data/manifests/the_stack_sample/sample_2090.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx\n  namespace: test\n  labels:\n    app: nginx\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - name: nginx\n        image: nginx\n        ports:\n        - containerPort: 80\n        resources:\n          requests:\n            cpu: 1\n            memory: 500Mi\n          limits:\n            cpu: 2\n            memory: 1024Mi\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"nginx\" is not set to runAsNonRoot"
  },
  {
    "id": "04562",
    "manifest_path": "data/manifests/the_stack_sample/sample_2092.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: user\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: user\n  template:\n    metadata:\n      labels:\n        app: user\n    spec:\n      containers:\n      - name: user\n        image: p3fightclub.azurecr.io/user\n        ports:\n        - containerPort: 5001\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"user\" is using an invalid container image, \"p3fightclub.azurecr.io/user\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "04563",
    "manifest_path": "data/manifests/the_stack_sample/sample_2092.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: user\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: user\n  template:\n    metadata:\n      labels:\n        app: user\n    spec:\n      containers:\n      - name: user\n        image: p3fightclub.azurecr.io/user\n        ports:\n        - containerPort: 5001\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"user\" does not have a read-only root file system"
  },
  {
    "id": "04564",
    "manifest_path": "data/manifests/the_stack_sample/sample_2092.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: user\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: user\n  template:\n    metadata:\n      labels:\n        app: user\n    spec:\n      containers:\n      - name: user\n        image: p3fightclub.azurecr.io/user\n        ports:\n        - containerPort: 5001\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"user\" is not set to runAsNonRoot"
  },
  {
    "id": "04565",
    "manifest_path": "data/manifests/the_stack_sample/sample_2092.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: user\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: user\n  template:\n    metadata:\n      labels:\n        app: user\n    spec:\n      containers:\n      - name: user\n        image: p3fightclub.azurecr.io/user\n        ports:\n        - containerPort: 5001\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"user\" has cpu request 0"
  },
  {
    "id": "04566",
    "manifest_path": "data/manifests/the_stack_sample/sample_2092.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: user\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: user\n  template:\n    metadata:\n      labels:\n        app: user\n    spec:\n      containers:\n      - name: user\n        image: p3fightclub.azurecr.io/user\n        ports:\n        - containerPort: 5001\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"user\" has memory limit 0"
  },
  {
    "id": "04567",
    "manifest_path": "data/manifests/the_stack_sample/sample_2094.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-5924\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"nginx\" is using an invalid container image, \"nginx\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "04568",
    "manifest_path": "data/manifests/the_stack_sample/sample_2094.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-5924\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"nginx\" does not have a read-only root file system"
  },
  {
    "id": "04569",
    "manifest_path": "data/manifests/the_stack_sample/sample_2094.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-5924\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"nginx\" is not set to runAsNonRoot"
  },
  {
    "id": "04570",
    "manifest_path": "data/manifests/the_stack_sample/sample_2094.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-5924\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"nginx\" has cpu request 0"
  },
  {
    "id": "04571",
    "manifest_path": "data/manifests/the_stack_sample/sample_2094.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-5924\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"nginx\" has memory limit 0"
  },
  {
    "id": "04572",
    "manifest_path": "data/manifests/the_stack_sample/sample_2095.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: tickets-celery\n  labels:\n    app: tickets-celery\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: tickets-celery\n  template:\n    metadata:\n      labels:\n        name: tickets-celery\n    spec:\n      containers:\n      - name: tickets-celery\n        image: ckreuzberger/tickets:1.0\n        imagePullPolicy: Always\n        command:\n        - celery\n        args:\n        - -A\n        - tickets\n        - worker\n        - --loglevel=info\n        env:\n        - name: POSTGRES_USER\n          valueFrom:\n            secretKeyRef:\n              name: postgres-credentials\n              key: user\n        - name: POSTGRES_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: postgres-credentials\n              key: password\n        - name: POSTGRES_DB\n          value: tickets\n        - name: DATABASE_URL\n          value: postgres://$(POSTGRES_USER):$(POSTGRES_PASSWORD)@postgres:5432/$(POSTGRES_DB)\n        - name: DJANGO_SETTINGS_MODULE\n          value: tickets.settings.prod\n        - name: SECRET_KEY\n          valueFrom:\n            secretKeyRef:\n              name: django-secret-key\n              key: secret_key\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"tickets-celery\" does not have a read-only root file system"
  },
  {
    "id": "04573",
    "manifest_path": "data/manifests/the_stack_sample/sample_2095.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: tickets-celery\n  labels:\n    app: tickets-celery\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: tickets-celery\n  template:\n    metadata:\n      labels:\n        name: tickets-celery\n    spec:\n      containers:\n      - name: tickets-celery\n        image: ckreuzberger/tickets:1.0\n        imagePullPolicy: Always\n        command:\n        - celery\n        args:\n        - -A\n        - tickets\n        - worker\n        - --loglevel=info\n        env:\n        - name: POSTGRES_USER\n          valueFrom:\n            secretKeyRef:\n              name: postgres-credentials\n              key: user\n        - name: POSTGRES_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: postgres-credentials\n              key: password\n        - name: POSTGRES_DB\n          value: tickets\n        - name: DATABASE_URL\n          value: postgres://$(POSTGRES_USER):$(POSTGRES_PASSWORD)@postgres:5432/$(POSTGRES_DB)\n        - name: DJANGO_SETTINGS_MODULE\n          value: tickets.settings.prod\n        - name: SECRET_KEY\n          valueFrom:\n            secretKeyRef:\n              name: django-secret-key\n              key: secret_key\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"tickets-celery\" is not set to runAsNonRoot"
  },
  {
    "id": "04574",
    "manifest_path": "data/manifests/the_stack_sample/sample_2095.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: tickets-celery\n  labels:\n    app: tickets-celery\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: tickets-celery\n  template:\n    metadata:\n      labels:\n        name: tickets-celery\n    spec:\n      containers:\n      - name: tickets-celery\n        image: ckreuzberger/tickets:1.0\n        imagePullPolicy: Always\n        command:\n        - celery\n        args:\n        - -A\n        - tickets\n        - worker\n        - --loglevel=info\n        env:\n        - name: POSTGRES_USER\n          valueFrom:\n            secretKeyRef:\n              name: postgres-credentials\n              key: user\n        - name: POSTGRES_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: postgres-credentials\n              key: password\n        - name: POSTGRES_DB\n          value: tickets\n        - name: DATABASE_URL\n          value: postgres://$(POSTGRES_USER):$(POSTGRES_PASSWORD)@postgres:5432/$(POSTGRES_DB)\n        - name: DJANGO_SETTINGS_MODULE\n          value: tickets.settings.prod\n        - name: SECRET_KEY\n          valueFrom:\n            secretKeyRef:\n              name: django-secret-key\n              key: secret_key\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"tickets-celery\" has cpu request 0"
  },
  {
    "id": "04575",
    "manifest_path": "data/manifests/the_stack_sample/sample_2095.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: tickets-celery\n  labels:\n    app: tickets-celery\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: tickets-celery\n  template:\n    metadata:\n      labels:\n        name: tickets-celery\n    spec:\n      containers:\n      - name: tickets-celery\n        image: ckreuzberger/tickets:1.0\n        imagePullPolicy: Always\n        command:\n        - celery\n        args:\n        - -A\n        - tickets\n        - worker\n        - --loglevel=info\n        env:\n        - name: POSTGRES_USER\n          valueFrom:\n            secretKeyRef:\n              name: postgres-credentials\n              key: user\n        - name: POSTGRES_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: postgres-credentials\n              key: password\n        - name: POSTGRES_DB\n          value: tickets\n        - name: DATABASE_URL\n          value: postgres://$(POSTGRES_USER):$(POSTGRES_PASSWORD)@postgres:5432/$(POSTGRES_DB)\n        - name: DJANGO_SETTINGS_MODULE\n          value: tickets.settings.prod\n        - name: SECRET_KEY\n          valueFrom:\n            secretKeyRef:\n              name: django-secret-key\n              key: secret_key\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"tickets-celery\" has memory limit 0"
  },
  {
    "id": "04576",
    "manifest_path": "data/manifests/the_stack_sample/sample_2097.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app.kubernetes.io/name: argocd-repo-server\n    app.kubernetes.io/part-of: argocd\n    app.kubernetes.io/component: repo-server\n  name: argocd-repo-server\nspec:\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: argocd-repo-server\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/name: argocd-repo-server\n    spec:\n      containers:\n      - name: argocd-repo-server\n        image: quay.io/argoproj/argocd:latest\n        imagePullPolicy: Always\n        command:\n        - entrypoint.sh\n        - argocd-repo-server\n        - --redis\n        - $(ARGOCD_REDIS_SERVICE):6379\n        env:\n        - name: ARGOCD_RECONCILIATION_TIMEOUT\n          valueFrom:\n            configMapKeyRef:\n              name: argocd-cm\n              key: timeout.reconciliation\n              optional: true\n        - name: ARGOCD_REPO_SERVER_LOGFORMAT\n          valueFrom:\n            configMapKeyRef:\n              name: argocd-cmd-params-cm\n              key: reposerver.log.format\n              optional: true\n        - name: ARGOCD_REPO_SERVER_LOGLEVEL\n          valueFrom:\n            configMapKeyRef:\n              name: argocd-cmd-params-cm\n              key: reposerver.log.level\n              optional: true\n        - name: ARGOCD_REPO_SERVER_PARALLELISM_LIMIT\n          valueFrom:\n            configMapKeyRef:\n              name: argocd-cmd-params-cm\n              key: reposerver.parallelism.limit\n              optional: true\n        - name: ARGOCD_REPO_SERVER_DISABLE_TLS\n          valueFrom:\n            configMapKeyRef:\n              name: argocd-cmd-params-cm\n              key: reposerver.disable.tls\n              optional: true\n        - name: ARGOCD_TLS_MIN_VERSION\n          valueFrom:\n            configMapKeyRef:\n              name: argocd-cmd-params-cm\n              key: reposerver.tls.minversion\n              optional: true\n        - name: ARGOCD_TLS_MAX_VERSION\n          valueFrom:\n            configMapKeyRef:\n              name: argocd-cmd-params-cm\n              key: reposerver.tls.maxversion\n              optional: true\n        - name: ARGOCD_TLS_CIPHERS\n          valueFrom:\n            configMapKeyRef:\n              name: argocd-cmd-params-cm\n              key: reposerver.tls.ciphers\n              optional: true\n        - name: ARGOCD_REPO_CACHE_EXPIRATION\n          valueFrom:\n            configMapKeyRef:\n              name: argocd-cmd-params-cm\n              key: reposerver.repo.cache.expiration\n              optional: true\n        - name: REDIS_SERVER\n          valueFrom:\n            configMapKeyRef:\n              name: argocd-cmd-params-cm\n              key: redis.server\n              optional: true\n        - name: REDISDB\n          valueFrom:\n            configMapKeyRef:\n              name: argocd-cmd-params-cm\n              key: redis.db\n              optional: true\n        - name: ARGOCD_DEFAULT_CACHE_EXPIRATION\n          valueFrom:\n            configMapKeyRef:\n              name: argocd-cmd-params-cm\n              key: reposerver.default.cache.expiration\n              optional: true\n        - name: HELM_CACHE_HOME\n          value: /helm-working-dir\n        - name: HELM_CONFIG_HOME\n          value: /helm-working-dir\n        - name: HELM_DATA_HOME\n          value: /helm-working-dir\n        ports:\n        - containerPort: 8081\n        - containerPort: 8084\n        livenessProbe:\n          httpGet:\n            path: /healthz?full=true\n            port: 8084\n          initialDelaySeconds: 30\n          periodSeconds: 5\n          failureThreshold: 3\n        readinessProbe:\n          httpGet:\n            path: /healthz\n            port: 8084\n          initialDelaySeconds: 5\n          periodSeconds: 10\n        securityContext:\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - all\n        volumeMounts:\n        - name: ssh-known-hosts\n          mountPath: /app/config/ssh\n        - name: tls-certs\n          mountPath: /app/config/tls\n        - name: gpg-keys\n          mountPath: /app/config/gpg/source\n        - name: gpg-keyring\n          mountPath: /app/config/gpg/keys\n        - name: argocd-repo-server-tls\n          mountPath: /app/config/reposerver/tls\n        - name: tmp\n          mountPath: /tmp\n        - mountPath: /helm-working-dir\n          name: helm-working-dir\n      volumes:\n      - name: ssh-known-hosts\n        configMap:\n          name: argocd-ssh-known-hosts-cm\n      - name: tls-certs\n        configMap:\n          name: argocd-tls-certs-cm\n      - name: gpg-keys\n        configMap:\n          name: argocd-gpg-keys-cm\n      - name: gpg-keyring\n        emptyDir: {}\n      - name: tmp\n        emptyDir: {}\n      - name: helm-working-dir\n        emptyDir: {}\n      - name: argocd-repo-server-tls\n        secret:\n          secretName: argocd-repo-server-tls\n          optional: true\n          items:\n          - key: tls.crt\n            path: tls.crt\n          - key: tls.key\n            path: tls.key\n          - key: ca.crt\n            path: ca.crt\n      affinity:\n        podAntiAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - weight: 100\n            podAffinityTerm:\n              labelSelector:\n                matchLabels:\n                  app.kubernetes.io/name: argocd-repo-server\n              topologyKey: kubernetes.io/hostname\n          - weight: 5\n            podAffinityTerm:\n              labelSelector:\n                matchLabels:\n                  app.kubernetes.io/part-of: argocd\n              topologyKey: kubernetes.io/hostname\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"argocd-repo-server\" is using an invalid container image, \"quay.io/argoproj/argocd:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "04577",
    "manifest_path": "data/manifests/the_stack_sample/sample_2097.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app.kubernetes.io/name: argocd-repo-server\n    app.kubernetes.io/part-of: argocd\n    app.kubernetes.io/component: repo-server\n  name: argocd-repo-server\nspec:\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: argocd-repo-server\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/name: argocd-repo-server\n    spec:\n      containers:\n      - name: argocd-repo-server\n        image: quay.io/argoproj/argocd:latest\n        imagePullPolicy: Always\n        command:\n        - entrypoint.sh\n        - argocd-repo-server\n        - --redis\n        - $(ARGOCD_REDIS_SERVICE):6379\n        env:\n        - name: ARGOCD_RECONCILIATION_TIMEOUT\n          valueFrom:\n            configMapKeyRef:\n              name: argocd-cm\n              key: timeout.reconciliation\n              optional: true\n        - name: ARGOCD_REPO_SERVER_LOGFORMAT\n          valueFrom:\n            configMapKeyRef:\n              name: argocd-cmd-params-cm\n              key: reposerver.log.format\n              optional: true\n        - name: ARGOCD_REPO_SERVER_LOGLEVEL\n          valueFrom:\n            configMapKeyRef:\n              name: argocd-cmd-params-cm\n              key: reposerver.log.level\n              optional: true\n        - name: ARGOCD_REPO_SERVER_PARALLELISM_LIMIT\n          valueFrom:\n            configMapKeyRef:\n              name: argocd-cmd-params-cm\n              key: reposerver.parallelism.limit\n              optional: true\n        - name: ARGOCD_REPO_SERVER_DISABLE_TLS\n          valueFrom:\n            configMapKeyRef:\n              name: argocd-cmd-params-cm\n              key: reposerver.disable.tls\n              optional: true\n        - name: ARGOCD_TLS_MIN_VERSION\n          valueFrom:\n            configMapKeyRef:\n              name: argocd-cmd-params-cm\n              key: reposerver.tls.minversion\n              optional: true\n        - name: ARGOCD_TLS_MAX_VERSION\n          valueFrom:\n            configMapKeyRef:\n              name: argocd-cmd-params-cm\n              key: reposerver.tls.maxversion\n              optional: true\n        - name: ARGOCD_TLS_CIPHERS\n          valueFrom:\n            configMapKeyRef:\n              name: argocd-cmd-params-cm\n              key: reposerver.tls.ciphers\n              optional: true\n        - name: ARGOCD_REPO_CACHE_EXPIRATION\n          valueFrom:\n            configMapKeyRef:\n              name: argocd-cmd-params-cm\n              key: reposerver.repo.cache.expiration\n              optional: true\n        - name: REDIS_SERVER\n          valueFrom:\n            configMapKeyRef:\n              name: argocd-cmd-params-cm\n              key: redis.server\n              optional: true\n        - name: REDISDB\n          valueFrom:\n            configMapKeyRef:\n              name: argocd-cmd-params-cm\n              key: redis.db\n              optional: true\n        - name: ARGOCD_DEFAULT_CACHE_EXPIRATION\n          valueFrom:\n            configMapKeyRef:\n              name: argocd-cmd-params-cm\n              key: reposerver.default.cache.expiration\n              optional: true\n        - name: HELM_CACHE_HOME\n          value: /helm-working-dir\n        - name: HELM_CONFIG_HOME\n          value: /helm-working-dir\n        - name: HELM_DATA_HOME\n          value: /helm-working-dir\n        ports:\n        - containerPort: 8081\n        - containerPort: 8084\n        livenessProbe:\n          httpGet:\n            path: /healthz?full=true\n            port: 8084\n          initialDelaySeconds: 30\n          periodSeconds: 5\n          failureThreshold: 3\n        readinessProbe:\n          httpGet:\n            path: /healthz\n            port: 8084\n          initialDelaySeconds: 5\n          periodSeconds: 10\n        securityContext:\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - all\n        volumeMounts:\n        - name: ssh-known-hosts\n          mountPath: /app/config/ssh\n        - name: tls-certs\n          mountPath: /app/config/tls\n        - name: gpg-keys\n          mountPath: /app/config/gpg/source\n        - name: gpg-keyring\n          mountPath: /app/config/gpg/keys\n        - name: argocd-repo-server-tls\n          mountPath: /app/config/reposerver/tls\n        - name: tmp\n          mountPath: /tmp\n        - mountPath: /helm-working-dir\n          name: helm-working-dir\n      volumes:\n      - name: ssh-known-hosts\n        configMap:\n          name: argocd-ssh-known-hosts-cm\n      - name: tls-certs\n        configMap:\n          name: argocd-tls-certs-cm\n      - name: gpg-keys\n        configMap:\n          name: argocd-gpg-keys-cm\n      - name: gpg-keyring\n        emptyDir: {}\n      - name: tmp\n        emptyDir: {}\n      - name: helm-working-dir\n        emptyDir: {}\n      - name: argocd-repo-server-tls\n        secret:\n          secretName: argocd-repo-server-tls\n          optional: true\n          items:\n          - key: tls.crt\n            path: tls.crt\n          - key: tls.key\n            path: tls.key\n          - key: ca.crt\n            path: ca.crt\n      affinity:\n        podAntiAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - weight: 100\n            podAffinityTerm:\n              labelSelector:\n                matchLabels:\n                  app.kubernetes.io/name: argocd-repo-server\n              topologyKey: kubernetes.io/hostname\n          - weight: 5\n            podAffinityTerm:\n              labelSelector:\n                matchLabels:\n                  app.kubernetes.io/part-of: argocd\n              topologyKey: kubernetes.io/hostname\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"argocd-repo-server\" has cpu request 0"
  },
  {
    "id": "04578",
    "manifest_path": "data/manifests/the_stack_sample/sample_2097.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app.kubernetes.io/name: argocd-repo-server\n    app.kubernetes.io/part-of: argocd\n    app.kubernetes.io/component: repo-server\n  name: argocd-repo-server\nspec:\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: argocd-repo-server\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/name: argocd-repo-server\n    spec:\n      containers:\n      - name: argocd-repo-server\n        image: quay.io/argoproj/argocd:latest\n        imagePullPolicy: Always\n        command:\n        - entrypoint.sh\n        - argocd-repo-server\n        - --redis\n        - $(ARGOCD_REDIS_SERVICE):6379\n        env:\n        - name: ARGOCD_RECONCILIATION_TIMEOUT\n          valueFrom:\n            configMapKeyRef:\n              name: argocd-cm\n              key: timeout.reconciliation\n              optional: true\n        - name: ARGOCD_REPO_SERVER_LOGFORMAT\n          valueFrom:\n            configMapKeyRef:\n              name: argocd-cmd-params-cm\n              key: reposerver.log.format\n              optional: true\n        - name: ARGOCD_REPO_SERVER_LOGLEVEL\n          valueFrom:\n            configMapKeyRef:\n              name: argocd-cmd-params-cm\n              key: reposerver.log.level\n              optional: true\n        - name: ARGOCD_REPO_SERVER_PARALLELISM_LIMIT\n          valueFrom:\n            configMapKeyRef:\n              name: argocd-cmd-params-cm\n              key: reposerver.parallelism.limit\n              optional: true\n        - name: ARGOCD_REPO_SERVER_DISABLE_TLS\n          valueFrom:\n            configMapKeyRef:\n              name: argocd-cmd-params-cm\n              key: reposerver.disable.tls\n              optional: true\n        - name: ARGOCD_TLS_MIN_VERSION\n          valueFrom:\n            configMapKeyRef:\n              name: argocd-cmd-params-cm\n              key: reposerver.tls.minversion\n              optional: true\n        - name: ARGOCD_TLS_MAX_VERSION\n          valueFrom:\n            configMapKeyRef:\n              name: argocd-cmd-params-cm\n              key: reposerver.tls.maxversion\n              optional: true\n        - name: ARGOCD_TLS_CIPHERS\n          valueFrom:\n            configMapKeyRef:\n              name: argocd-cmd-params-cm\n              key: reposerver.tls.ciphers\n              optional: true\n        - name: ARGOCD_REPO_CACHE_EXPIRATION\n          valueFrom:\n            configMapKeyRef:\n              name: argocd-cmd-params-cm\n              key: reposerver.repo.cache.expiration\n              optional: true\n        - name: REDIS_SERVER\n          valueFrom:\n            configMapKeyRef:\n              name: argocd-cmd-params-cm\n              key: redis.server\n              optional: true\n        - name: REDISDB\n          valueFrom:\n            configMapKeyRef:\n              name: argocd-cmd-params-cm\n              key: redis.db\n              optional: true\n        - name: ARGOCD_DEFAULT_CACHE_EXPIRATION\n          valueFrom:\n            configMapKeyRef:\n              name: argocd-cmd-params-cm\n              key: reposerver.default.cache.expiration\n              optional: true\n        - name: HELM_CACHE_HOME\n          value: /helm-working-dir\n        - name: HELM_CONFIG_HOME\n          value: /helm-working-dir\n        - name: HELM_DATA_HOME\n          value: /helm-working-dir\n        ports:\n        - containerPort: 8081\n        - containerPort: 8084\n        livenessProbe:\n          httpGet:\n            path: /healthz?full=true\n            port: 8084\n          initialDelaySeconds: 30\n          periodSeconds: 5\n          failureThreshold: 3\n        readinessProbe:\n          httpGet:\n            path: /healthz\n            port: 8084\n          initialDelaySeconds: 5\n          periodSeconds: 10\n        securityContext:\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - all\n        volumeMounts:\n        - name: ssh-known-hosts\n          mountPath: /app/config/ssh\n        - name: tls-certs\n          mountPath: /app/config/tls\n        - name: gpg-keys\n          mountPath: /app/config/gpg/source\n        - name: gpg-keyring\n          mountPath: /app/config/gpg/keys\n        - name: argocd-repo-server-tls\n          mountPath: /app/config/reposerver/tls\n        - name: tmp\n          mountPath: /tmp\n        - mountPath: /helm-working-dir\n          name: helm-working-dir\n      volumes:\n      - name: ssh-known-hosts\n        configMap:\n          name: argocd-ssh-known-hosts-cm\n      - name: tls-certs\n        configMap:\n          name: argocd-tls-certs-cm\n      - name: gpg-keys\n        configMap:\n          name: argocd-gpg-keys-cm\n      - name: gpg-keyring\n        emptyDir: {}\n      - name: tmp\n        emptyDir: {}\n      - name: helm-working-dir\n        emptyDir: {}\n      - name: argocd-repo-server-tls\n        secret:\n          secretName: argocd-repo-server-tls\n          optional: true\n          items:\n          - key: tls.crt\n            path: tls.crt\n          - key: tls.key\n            path: tls.key\n          - key: ca.crt\n            path: ca.crt\n      affinity:\n        podAntiAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - weight: 100\n            podAffinityTerm:\n              labelSelector:\n                matchLabels:\n                  app.kubernetes.io/name: argocd-repo-server\n              topologyKey: kubernetes.io/hostname\n          - weight: 5\n            podAffinityTerm:\n              labelSelector:\n                matchLabels:\n                  app.kubernetes.io/part-of: argocd\n              topologyKey: kubernetes.io/hostname\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"argocd-repo-server\" has memory limit 0"
  },
  {
    "id": "04579",
    "manifest_path": "data/manifests/the_stack_sample/sample_2099.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: tomcat\n  labels:\n    app: tomcat\nspec:\n  containers:\n  - name: tomcat\n    image: docker635067/test:preethu\n    ports:\n    - containerPort: 8080\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"tomcat\" does not have a read-only root file system"
  },
  {
    "id": "04580",
    "manifest_path": "data/manifests/the_stack_sample/sample_2099.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: tomcat\n  labels:\n    app: tomcat\nspec:\n  containers:\n  - name: tomcat\n    image: docker635067/test:preethu\n    ports:\n    - containerPort: 8080\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"tomcat\" is not set to runAsNonRoot"
  },
  {
    "id": "04581",
    "manifest_path": "data/manifests/the_stack_sample/sample_2099.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: tomcat\n  labels:\n    app: tomcat\nspec:\n  containers:\n  - name: tomcat\n    image: docker635067/test:preethu\n    ports:\n    - containerPort: 8080\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"tomcat\" has cpu request 0"
  },
  {
    "id": "04582",
    "manifest_path": "data/manifests/the_stack_sample/sample_2099.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: tomcat\n  labels:\n    app: tomcat\nspec:\n  containers:\n  - name: tomcat\n    image: docker635067/test:preethu\n    ports:\n    - containerPort: 8080\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"tomcat\" has memory limit 0"
  },
  {
    "id": "04583",
    "manifest_path": "data/manifests/the_stack_sample/sample_2100.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: label-sync\nspec:\n  template:\n    metadata:\n      labels:\n        name: label-sync\n    spec:\n      containers:\n      - name: label-sync\n        image: gcr.io/k8s-prow/label_sync:v20220114-25626d8ef5\n        args:\n        - --config=/etc/config/labels.yaml\n        - --confirm=true\n        - --orgs=kubernetes,kubernetes-client,kubernetes-csi,kubernetes-sigs\n        - --token=/etc/github/oauth\n        volumeMounts:\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n      volumes:\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: config\n        configMap:\n          name: label-config\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"label-sync\" does not have a read-only root file system"
  },
  {
    "id": "04584",
    "manifest_path": "data/manifests/the_stack_sample/sample_2100.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: label-sync\nspec:\n  template:\n    metadata:\n      labels:\n        name: label-sync\n    spec:\n      containers:\n      - name: label-sync\n        image: gcr.io/k8s-prow/label_sync:v20220114-25626d8ef5\n        args:\n        - --config=/etc/config/labels.yaml\n        - --confirm=true\n        - --orgs=kubernetes,kubernetes-client,kubernetes-csi,kubernetes-sigs\n        - --token=/etc/github/oauth\n        volumeMounts:\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n      volumes:\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: config\n        configMap:\n          name: label-config\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"label-sync\" is not set to runAsNonRoot"
  },
  {
    "id": "04585",
    "manifest_path": "data/manifests/the_stack_sample/sample_2100.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: label-sync\nspec:\n  template:\n    metadata:\n      labels:\n        name: label-sync\n    spec:\n      containers:\n      - name: label-sync\n        image: gcr.io/k8s-prow/label_sync:v20220114-25626d8ef5\n        args:\n        - --config=/etc/config/labels.yaml\n        - --confirm=true\n        - --orgs=kubernetes,kubernetes-client,kubernetes-csi,kubernetes-sigs\n        - --token=/etc/github/oauth\n        volumeMounts:\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n      volumes:\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: config\n        configMap:\n          name: label-config\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"label-sync\" has cpu request 0"
  },
  {
    "id": "04586",
    "manifest_path": "data/manifests/the_stack_sample/sample_2100.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: label-sync\nspec:\n  template:\n    metadata:\n      labels:\n        name: label-sync\n    spec:\n      containers:\n      - name: label-sync\n        image: gcr.io/k8s-prow/label_sync:v20220114-25626d8ef5\n        args:\n        - --config=/etc/config/labels.yaml\n        - --confirm=true\n        - --orgs=kubernetes,kubernetes-client,kubernetes-csi,kubernetes-sigs\n        - --token=/etc/github/oauth\n        volumeMounts:\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n      volumes:\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: config\n        configMap:\n          name: label-config\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"label-sync\" has memory limit 0"
  },
  {
    "id": "04587",
    "manifest_path": "data/manifests/the_stack_sample/sample_2101.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  annotations:\n    helm.sh/hook: post-install\n    helm.sh/hook-delete-policy: hook-succeeded\n  labels:\n    app: grafana\n    chart: grafana\n    heritage: Tiller\n    release: istio\n  name: istio-grafana-post-install-1.1.6\n  namespace: istio-system\nspec:\n  template:\n    metadata:\n      labels:\n        app: istio-grafana\n        chart: grafana\n        heritage: Tiller\n        release: istio\n      name: istio-grafana-post-install\n    spec:\n      affinity:\n        nodeAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - preference:\n              matchExpressions:\n              - key: beta.kubernetes.io/arch\n                operator: In\n                values:\n                - amd64\n            weight: 2\n          - preference:\n              matchExpressions:\n              - key: beta.kubernetes.io/arch\n                operator: In\n                values:\n                - ppc64le\n            weight: 2\n          - preference:\n              matchExpressions:\n              - key: beta.kubernetes.io/arch\n                operator: In\n                values:\n                - s390x\n            weight: 2\n          requiredDuringSchedulingIgnoredDuringExecution:\n            nodeSelectorTerms:\n            - matchExpressions:\n              - key: beta.kubernetes.io/arch\n                operator: In\n                values:\n                - amd64\n                - ppc64le\n                - s390x\n      containers:\n      - command:\n        - /bin/bash\n        - /tmp/grafana/run.sh\n        - /tmp/grafana/custom-resources.yaml\n        image: docker.io/istio/kubectl:1.1.6\n        name: kubectl\n        volumeMounts:\n        - mountPath: /tmp/grafana\n          name: tmp-configmap-grafana\n      serviceAccountName: istio-grafana-post-install-account\n      volumes:\n      - configMap:\n          name: istio-grafana-custom-resources\n        name: tmp-configmap-grafana\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"kubectl\" does not have a read-only root file system"
  },
  {
    "id": "04588",
    "manifest_path": "data/manifests/the_stack_sample/sample_2101.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  annotations:\n    helm.sh/hook: post-install\n    helm.sh/hook-delete-policy: hook-succeeded\n  labels:\n    app: grafana\n    chart: grafana\n    heritage: Tiller\n    release: istio\n  name: istio-grafana-post-install-1.1.6\n  namespace: istio-system\nspec:\n  template:\n    metadata:\n      labels:\n        app: istio-grafana\n        chart: grafana\n        heritage: Tiller\n        release: istio\n      name: istio-grafana-post-install\n    spec:\n      affinity:\n        nodeAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - preference:\n              matchExpressions:\n              - key: beta.kubernetes.io/arch\n                operator: In\n                values:\n                - amd64\n            weight: 2\n          - preference:\n              matchExpressions:\n              - key: beta.kubernetes.io/arch\n                operator: In\n                values:\n                - ppc64le\n            weight: 2\n          - preference:\n              matchExpressions:\n              - key: beta.kubernetes.io/arch\n                operator: In\n                values:\n                - s390x\n            weight: 2\n          requiredDuringSchedulingIgnoredDuringExecution:\n            nodeSelectorTerms:\n            - matchExpressions:\n              - key: beta.kubernetes.io/arch\n                operator: In\n                values:\n                - amd64\n                - ppc64le\n                - s390x\n      containers:\n      - command:\n        - /bin/bash\n        - /tmp/grafana/run.sh\n        - /tmp/grafana/custom-resources.yaml\n        image: docker.io/istio/kubectl:1.1.6\n        name: kubectl\n        volumeMounts:\n        - mountPath: /tmp/grafana\n          name: tmp-configmap-grafana\n      serviceAccountName: istio-grafana-post-install-account\n      volumes:\n      - configMap:\n          name: istio-grafana-custom-resources\n        name: tmp-configmap-grafana\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"kubectl\" is not set to runAsNonRoot"
  },
  {
    "id": "04589",
    "manifest_path": "data/manifests/the_stack_sample/sample_2101.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  annotations:\n    helm.sh/hook: post-install\n    helm.sh/hook-delete-policy: hook-succeeded\n  labels:\n    app: grafana\n    chart: grafana\n    heritage: Tiller\n    release: istio\n  name: istio-grafana-post-install-1.1.6\n  namespace: istio-system\nspec:\n  template:\n    metadata:\n      labels:\n        app: istio-grafana\n        chart: grafana\n        heritage: Tiller\n        release: istio\n      name: istio-grafana-post-install\n    spec:\n      affinity:\n        nodeAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - preference:\n              matchExpressions:\n              - key: beta.kubernetes.io/arch\n                operator: In\n                values:\n                - amd64\n            weight: 2\n          - preference:\n              matchExpressions:\n              - key: beta.kubernetes.io/arch\n                operator: In\n                values:\n                - ppc64le\n            weight: 2\n          - preference:\n              matchExpressions:\n              - key: beta.kubernetes.io/arch\n                operator: In\n                values:\n                - s390x\n            weight: 2\n          requiredDuringSchedulingIgnoredDuringExecution:\n            nodeSelectorTerms:\n            - matchExpressions:\n              - key: beta.kubernetes.io/arch\n                operator: In\n                values:\n                - amd64\n                - ppc64le\n                - s390x\n      containers:\n      - command:\n        - /bin/bash\n        - /tmp/grafana/run.sh\n        - /tmp/grafana/custom-resources.yaml\n        image: docker.io/istio/kubectl:1.1.6\n        name: kubectl\n        volumeMounts:\n        - mountPath: /tmp/grafana\n          name: tmp-configmap-grafana\n      serviceAccountName: istio-grafana-post-install-account\n      volumes:\n      - configMap:\n          name: istio-grafana-custom-resources\n        name: tmp-configmap-grafana\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"kubectl\" has cpu request 0"
  },
  {
    "id": "04590",
    "manifest_path": "data/manifests/the_stack_sample/sample_2101.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  annotations:\n    helm.sh/hook: post-install\n    helm.sh/hook-delete-policy: hook-succeeded\n  labels:\n    app: grafana\n    chart: grafana\n    heritage: Tiller\n    release: istio\n  name: istio-grafana-post-install-1.1.6\n  namespace: istio-system\nspec:\n  template:\n    metadata:\n      labels:\n        app: istio-grafana\n        chart: grafana\n        heritage: Tiller\n        release: istio\n      name: istio-grafana-post-install\n    spec:\n      affinity:\n        nodeAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - preference:\n              matchExpressions:\n              - key: beta.kubernetes.io/arch\n                operator: In\n                values:\n                - amd64\n            weight: 2\n          - preference:\n              matchExpressions:\n              - key: beta.kubernetes.io/arch\n                operator: In\n                values:\n                - ppc64le\n            weight: 2\n          - preference:\n              matchExpressions:\n              - key: beta.kubernetes.io/arch\n                operator: In\n                values:\n                - s390x\n            weight: 2\n          requiredDuringSchedulingIgnoredDuringExecution:\n            nodeSelectorTerms:\n            - matchExpressions:\n              - key: beta.kubernetes.io/arch\n                operator: In\n                values:\n                - amd64\n                - ppc64le\n                - s390x\n      containers:\n      - command:\n        - /bin/bash\n        - /tmp/grafana/run.sh\n        - /tmp/grafana/custom-resources.yaml\n        image: docker.io/istio/kubectl:1.1.6\n        name: kubectl\n        volumeMounts:\n        - mountPath: /tmp/grafana\n          name: tmp-configmap-grafana\n      serviceAccountName: istio-grafana-post-install-account\n      volumes:\n      - configMap:\n          name: istio-grafana-custom-resources\n        name: tmp-configmap-grafana\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"kubectl\" has memory limit 0"
  },
  {
    "id": "04591",
    "manifest_path": "data/manifests/the_stack_sample/sample_2103.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: task-pv-pod\nspec:\n  volumes:\n  - name: task-pv-storage\n    persistentVolumeClaim:\n      claimName: task-pv-claim\n  containers:\n  - name: task-pv-container\n    image: nginx\n    ports:\n    - containerPort: 80\n      name: http-server\n    volumeMounts:\n    - mountPath: /usr/share/nginx/html\n      name: task-pv-storage\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"task-pv-container\" is using an invalid container image, \"nginx\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "04592",
    "manifest_path": "data/manifests/the_stack_sample/sample_2103.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: task-pv-pod\nspec:\n  volumes:\n  - name: task-pv-storage\n    persistentVolumeClaim:\n      claimName: task-pv-claim\n  containers:\n  - name: task-pv-container\n    image: nginx\n    ports:\n    - containerPort: 80\n      name: http-server\n    volumeMounts:\n    - mountPath: /usr/share/nginx/html\n      name: task-pv-storage\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"task-pv-container\" does not have a read-only root file system"
  },
  {
    "id": "04593",
    "manifest_path": "data/manifests/the_stack_sample/sample_2103.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: task-pv-pod\nspec:\n  volumes:\n  - name: task-pv-storage\n    persistentVolumeClaim:\n      claimName: task-pv-claim\n  containers:\n  - name: task-pv-container\n    image: nginx\n    ports:\n    - containerPort: 80\n      name: http-server\n    volumeMounts:\n    - mountPath: /usr/share/nginx/html\n      name: task-pv-storage\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"task-pv-container\" is not set to runAsNonRoot"
  },
  {
    "id": "04594",
    "manifest_path": "data/manifests/the_stack_sample/sample_2103.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: task-pv-pod\nspec:\n  volumes:\n  - name: task-pv-storage\n    persistentVolumeClaim:\n      claimName: task-pv-claim\n  containers:\n  - name: task-pv-container\n    image: nginx\n    ports:\n    - containerPort: 80\n      name: http-server\n    volumeMounts:\n    - mountPath: /usr/share/nginx/html\n      name: task-pv-storage\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"task-pv-container\" has cpu request 0"
  },
  {
    "id": "04595",
    "manifest_path": "data/manifests/the_stack_sample/sample_2103.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: task-pv-pod\nspec:\n  volumes:\n  - name: task-pv-storage\n    persistentVolumeClaim:\n      claimName: task-pv-claim\n  containers:\n  - name: task-pv-container\n    image: nginx\n    ports:\n    - containerPort: 80\n      name: http-server\n    volumeMounts:\n    - mountPath: /usr/share/nginx/html\n      name: task-pv-storage\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"task-pv-container\" has memory limit 0"
  },
  {
    "id": "04596",
    "manifest_path": "data/manifests/the_stack_sample/sample_2107.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: sensor-gen\n  namespace: kube-system\nspec:\n  replicas: 1\n  selector:\n    app: sensor-gen\n  template:\n    metadata:\n      name: sensor-gen\n      labels:\n        app: sensor-gen\n    spec:\n      containers:\n      - name: sensor-gen\n        image: huanphan/sensor-simulator:0.2\n        ports:\n        - containerPort: 9090\n        volumeMounts:\n        - name: sensor-config\n          mountPath: /SimulateSensor/config\n      volumes:\n      - name: sensor-config\n        configMap:\n          name: sensor-config\n          items:\n          - key: config.cfg\n            path: config.cfg\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"sensor-gen\" does not have a read-only root file system"
  },
  {
    "id": "04597",
    "manifest_path": "data/manifests/the_stack_sample/sample_2107.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: sensor-gen\n  namespace: kube-system\nspec:\n  replicas: 1\n  selector:\n    app: sensor-gen\n  template:\n    metadata:\n      name: sensor-gen\n      labels:\n        app: sensor-gen\n    spec:\n      containers:\n      - name: sensor-gen\n        image: huanphan/sensor-simulator:0.2\n        ports:\n        - containerPort: 9090\n        volumeMounts:\n        - name: sensor-config\n          mountPath: /SimulateSensor/config\n      volumes:\n      - name: sensor-config\n        configMap:\n          name: sensor-config\n          items:\n          - key: config.cfg\n            path: config.cfg\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"sensor-gen\" is not set to runAsNonRoot"
  },
  {
    "id": "04598",
    "manifest_path": "data/manifests/the_stack_sample/sample_2107.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: sensor-gen\n  namespace: kube-system\nspec:\n  replicas: 1\n  selector:\n    app: sensor-gen\n  template:\n    metadata:\n      name: sensor-gen\n      labels:\n        app: sensor-gen\n    spec:\n      containers:\n      - name: sensor-gen\n        image: huanphan/sensor-simulator:0.2\n        ports:\n        - containerPort: 9090\n        volumeMounts:\n        - name: sensor-config\n          mountPath: /SimulateSensor/config\n      volumes:\n      - name: sensor-config\n        configMap:\n          name: sensor-config\n          items:\n          - key: config.cfg\n            path: config.cfg\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"sensor-gen\" has cpu request 0"
  },
  {
    "id": "04599",
    "manifest_path": "data/manifests/the_stack_sample/sample_2107.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: sensor-gen\n  namespace: kube-system\nspec:\n  replicas: 1\n  selector:\n    app: sensor-gen\n  template:\n    metadata:\n      name: sensor-gen\n      labels:\n        app: sensor-gen\n    spec:\n      containers:\n      - name: sensor-gen\n        image: huanphan/sensor-simulator:0.2\n        ports:\n        - containerPort: 9090\n        volumeMounts:\n        - name: sensor-config\n          mountPath: /SimulateSensor/config\n      volumes:\n      - name: sensor-config\n        configMap:\n          name: sensor-config\n          items:\n          - key: config.cfg\n            path: config.cfg\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"sensor-gen\" has memory limit 0"
  },
  {
    "id": "04600",
    "manifest_path": "data/manifests/the_stack_sample/sample_2112.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-4805\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"nginx\" is using an invalid container image, \"nginx\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  }
]