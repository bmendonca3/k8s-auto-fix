[
  {
    "id": "04081",
    "manifest_path": "data/manifests/the_stack_sample/sample_1838.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: image-downloader\n  namespace: default\nspec:\n  selector:\n    matchLabels:\n      name: image-downloader\n  template:\n    metadata:\n      labels:\n        name: image-downloader\n    spec:\n      containers:\n      - name: python-predictor-cpu\n        image: $CORTEX_IMAGE_PYTHON_PREDICTOR_CPU\n        command:\n        - /bin/sh\n        args:\n        - -c\n        - sleep 1000000\n      - name: tensorflow-serving-cpu\n        image: $CORTEX_IMAGE_TENSORFLOW_SERVING_CPU\n        command:\n        - /bin/sh\n        args:\n        - -c\n        - sleep 1000000\n      - name: tensorflow-predictor\n        image: $CORTEX_IMAGE_TENSORFLOW_PREDICTOR\n        command:\n        - /bin/sh\n        args:\n        - -c\n        - sleep 1000000\n      - name: downloader\n        image: $CORTEX_IMAGE_DOWNLOADER\n        command:\n        - /bin/sh\n        args:\n        - -c\n        - sleep 1000000\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"tensorflow-serving-cpu\" has memory limit 0"
  },
  {
    "id": "04082",
    "manifest_path": "data/manifests/the_stack_sample/sample_1840.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: yeah-it-works\nspec:\n  template:\n    spec:\n      containers:\n      - name: yeah-it-works\n        image: python:3.6-alpine\n        command:\n        - python\n        - -c\n        - print('Yeah, it works in a Job!!!')\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"yeah-it-works\" does not have a read-only root file system"
  },
  {
    "id": "04083",
    "manifest_path": "data/manifests/the_stack_sample/sample_1840.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: yeah-it-works\nspec:\n  template:\n    spec:\n      containers:\n      - name: yeah-it-works\n        image: python:3.6-alpine\n        command:\n        - python\n        - -c\n        - print('Yeah, it works in a Job!!!')\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"yeah-it-works\" is not set to runAsNonRoot"
  },
  {
    "id": "04084",
    "manifest_path": "data/manifests/the_stack_sample/sample_1840.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: yeah-it-works\nspec:\n  template:\n    spec:\n      containers:\n      - name: yeah-it-works\n        image: python:3.6-alpine\n        command:\n        - python\n        - -c\n        - print('Yeah, it works in a Job!!!')\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"yeah-it-works\" has cpu request 0"
  },
  {
    "id": "04085",
    "manifest_path": "data/manifests/the_stack_sample/sample_1840.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: yeah-it-works\nspec:\n  template:\n    spec:\n      containers:\n      - name: yeah-it-works\n        image: python:3.6-alpine\n        command:\n        - python\n        - -c\n        - print('Yeah, it works in a Job!!!')\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"yeah-it-works\" has memory limit 0"
  },
  {
    "id": "04086",
    "manifest_path": "data/manifests/the_stack_sample/sample_1844.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: modeldb\n  name: modeldb-artifact-store\nspec:\n  selector:\n    matchLabels:\n      app: modeldb\n      tier: artifact-store\n  template:\n    metadata:\n      labels:\n        app: modeldb\n        tier: artifact-store\n      annotations:\n        sidecar.istio.io/inject: 'true'\n    spec:\n      containers:\n      - env:\n        - name: VERTA_ARTIFACT_CONFIG\n          value: /config/config.yaml\n        image: vertaaiofficial/modeldb-artifact-store:kubeflow\n        imagePullPolicy: Always\n        name: modeldb-artifact-store\n        ports:\n        - containerPort: 8086\n        volumeMounts:\n        - mountPath: /config\n          name: modeldb-artifact-store-config\n          readOnly: true\n      volumes:\n      - configMap:\n          name: modeldb-artifact-store-config\n        name: modeldb-artifact-store-config\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"modeldb-artifact-store\" does not have a read-only root file system"
  },
  {
    "id": "04087",
    "manifest_path": "data/manifests/the_stack_sample/sample_1844.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: modeldb\n  name: modeldb-artifact-store\nspec:\n  selector:\n    matchLabels:\n      app: modeldb\n      tier: artifact-store\n  template:\n    metadata:\n      labels:\n        app: modeldb\n        tier: artifact-store\n      annotations:\n        sidecar.istio.io/inject: 'true'\n    spec:\n      containers:\n      - env:\n        - name: VERTA_ARTIFACT_CONFIG\n          value: /config/config.yaml\n        image: vertaaiofficial/modeldb-artifact-store:kubeflow\n        imagePullPolicy: Always\n        name: modeldb-artifact-store\n        ports:\n        - containerPort: 8086\n        volumeMounts:\n        - mountPath: /config\n          name: modeldb-artifact-store-config\n          readOnly: true\n      volumes:\n      - configMap:\n          name: modeldb-artifact-store-config\n        name: modeldb-artifact-store-config\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"modeldb-artifact-store\" is not set to runAsNonRoot"
  },
  {
    "id": "04088",
    "manifest_path": "data/manifests/the_stack_sample/sample_1844.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: modeldb\n  name: modeldb-artifact-store\nspec:\n  selector:\n    matchLabels:\n      app: modeldb\n      tier: artifact-store\n  template:\n    metadata:\n      labels:\n        app: modeldb\n        tier: artifact-store\n      annotations:\n        sidecar.istio.io/inject: 'true'\n    spec:\n      containers:\n      - env:\n        - name: VERTA_ARTIFACT_CONFIG\n          value: /config/config.yaml\n        image: vertaaiofficial/modeldb-artifact-store:kubeflow\n        imagePullPolicy: Always\n        name: modeldb-artifact-store\n        ports:\n        - containerPort: 8086\n        volumeMounts:\n        - mountPath: /config\n          name: modeldb-artifact-store-config\n          readOnly: true\n      volumes:\n      - configMap:\n          name: modeldb-artifact-store-config\n        name: modeldb-artifact-store-config\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"modeldb-artifact-store\" has cpu request 0"
  },
  {
    "id": "04089",
    "manifest_path": "data/manifests/the_stack_sample/sample_1844.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: modeldb\n  name: modeldb-artifact-store\nspec:\n  selector:\n    matchLabels:\n      app: modeldb\n      tier: artifact-store\n  template:\n    metadata:\n      labels:\n        app: modeldb\n        tier: artifact-store\n      annotations:\n        sidecar.istio.io/inject: 'true'\n    spec:\n      containers:\n      - env:\n        - name: VERTA_ARTIFACT_CONFIG\n          value: /config/config.yaml\n        image: vertaaiofficial/modeldb-artifact-store:kubeflow\n        imagePullPolicy: Always\n        name: modeldb-artifact-store\n        ports:\n        - containerPort: 8086\n        volumeMounts:\n        - mountPath: /config\n          name: modeldb-artifact-store-config\n          readOnly: true\n      volumes:\n      - configMap:\n          name: modeldb-artifact-store-config\n        name: modeldb-artifact-store-config\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"modeldb-artifact-store\" has memory limit 0"
  },
  {
    "id": "04090",
    "manifest_path": "data/manifests/the_stack_sample/sample_1853.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: compliance-operator\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: compliance-operator\n  template:\n    metadata:\n      labels:\n        name: compliance-operator\n      annotations:\n        workload.openshift.io/management: '{\"effect\": \"PreferredDuringScheduling\"}'\n    spec:\n      serviceAccountName: compliance-operator\n      containers:\n      - name: compliance-operator\n        image: quay.io/compliance-operator/compliance-operator:latest\n        command:\n        - compliance-operator\n        - operator\n        imagePullPolicy: Always\n        securityContext:\n          readOnlyRootFilesystem: true\n          allowPrivilegeEscalation: false\n        resources:\n          requests:\n            memory: 20Mi\n            cpu: 10m\n          limits:\n            memory: 200Mi\n            cpu: 100m\n        env:\n        - name: WATCH_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: OPERATOR_NAME\n          value: compliance-operator\n        - name: RELATED_IMAGE_OPENSCAP\n          value: quay.io/compliance-operator/openscap-ocp:1.3.5\n        - name: RELATED_IMAGE_OPERATOR\n          value: quay.io/compliance-operator/compliance-operator:latest\n        - name: RELATED_IMAGE_PROFILE\n          value: quay.io/complianceascode/ocp4:latest\n        volumeMounts:\n        - name: serving-cert\n          mountPath: /var/run/secrets/serving-cert\n          readOnly: true\n      volumes:\n      - name: serving-cert\n        secret:\n          secretName: compliance-operator-serving-cert\n          optional: true\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"compliance-operator\" is using an invalid container image, \"quay.io/compliance-operator/compliance-operator:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "04091",
    "manifest_path": "data/manifests/the_stack_sample/sample_1853.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: compliance-operator\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      name: compliance-operator\n  template:\n    metadata:\n      labels:\n        name: compliance-operator\n      annotations:\n        workload.openshift.io/management: '{\"effect\": \"PreferredDuringScheduling\"}'\n    spec:\n      serviceAccountName: compliance-operator\n      containers:\n      - name: compliance-operator\n        image: quay.io/compliance-operator/compliance-operator:latest\n        command:\n        - compliance-operator\n        - operator\n        imagePullPolicy: Always\n        securityContext:\n          readOnlyRootFilesystem: true\n          allowPrivilegeEscalation: false\n        resources:\n          requests:\n            memory: 20Mi\n            cpu: 10m\n          limits:\n            memory: 200Mi\n            cpu: 100m\n        env:\n        - name: WATCH_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: OPERATOR_NAME\n          value: compliance-operator\n        - name: RELATED_IMAGE_OPENSCAP\n          value: quay.io/compliance-operator/openscap-ocp:1.3.5\n        - name: RELATED_IMAGE_OPERATOR\n          value: quay.io/compliance-operator/compliance-operator:latest\n        - name: RELATED_IMAGE_PROFILE\n          value: quay.io/complianceascode/ocp4:latest\n        volumeMounts:\n        - name: serving-cert\n          mountPath: /var/run/secrets/serving-cert\n          readOnly: true\n      volumes:\n      - name: serving-cert\n        secret:\n          secretName: compliance-operator-serving-cert\n          optional: true\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"compliance-operator\" is not set to runAsNonRoot"
  },
  {
    "id": "04092",
    "manifest_path": "data/manifests/the_stack_sample/sample_1854.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: csi-cinder-nodeplugin\n  namespace: kube-system\nspec:\n  selector:\n    matchLabels:\n      app: csi-cinder-nodeplugin\n  template:\n    metadata:\n      labels:\n        app: csi-cinder-nodeplugin\n    spec:\n      serviceAccount: csi-cinder-node-sa\n      containers:\n      - name: node-driver-registrar\n        image: quay.io/k8scsi/csi-node-driver-registrar:v1.1.0\n        args:\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REG_SOCK_PATH)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REG_SOCK_PATH\n          value: /var/lib/kubelet/plugins/cinder.csi.openstack.org/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        imagePullPolicy: IfNotPresent\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n      - name: cinder-csi-plugin\n        securityContext:\n          privileged: true\n          capabilities:\n            add:\n            - SYS_ADMIN\n          allowPrivilegeEscalation: true\n        image: docker.io/k8scloudprovider/cinder-csi-plugin:latest\n        args:\n        - /bin/cinder-csi-plugin\n        - --nodeid=$(NODE_ID)\n        - --endpoint=$(CSI_ENDPOINT)\n        - --cloud-config=$(CLOUD_CONFIG)\n        env:\n        - name: NODE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CSI_ENDPOINT\n          value: unix://csi/csi.sock\n        - name: CLOUD_CONFIG\n          value: /etc/config/cloud.conf\n        imagePullPolicy: IfNotPresent\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: Bidirectional\n        - name: pods-cloud-data\n          mountPath: /var/lib/cloud/data\n          readOnly: true\n        - name: pods-probe-dir\n          mountPath: /dev\n          mountPropagation: HostToContainer\n        - name: secret-cinderplugin\n          mountPath: /etc/config\n          readOnly: true\n      volumes:\n      - name: socket-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/cinder.csi.openstack.org\n          type: DirectoryOrCreate\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n      - name: pods-cloud-data\n        hostPath:\n          path: /var/lib/cloud/data\n          type: Directory\n      - name: pods-probe-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: secret-cinderplugin\n        secret:\n          secretName: cloud-config\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"cinder-csi-plugin\" is using an invalid container image, \"docker.io/k8scloudprovider/cinder-csi-plugin:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "04093",
    "manifest_path": "data/manifests/the_stack_sample/sample_1854.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: csi-cinder-nodeplugin\n  namespace: kube-system\nspec:\n  selector:\n    matchLabels:\n      app: csi-cinder-nodeplugin\n  template:\n    metadata:\n      labels:\n        app: csi-cinder-nodeplugin\n    spec:\n      serviceAccount: csi-cinder-node-sa\n      containers:\n      - name: node-driver-registrar\n        image: quay.io/k8scsi/csi-node-driver-registrar:v1.1.0\n        args:\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REG_SOCK_PATH)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REG_SOCK_PATH\n          value: /var/lib/kubelet/plugins/cinder.csi.openstack.org/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        imagePullPolicy: IfNotPresent\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n      - name: cinder-csi-plugin\n        securityContext:\n          privileged: true\n          capabilities:\n            add:\n            - SYS_ADMIN\n          allowPrivilegeEscalation: true\n        image: docker.io/k8scloudprovider/cinder-csi-plugin:latest\n        args:\n        - /bin/cinder-csi-plugin\n        - --nodeid=$(NODE_ID)\n        - --endpoint=$(CSI_ENDPOINT)\n        - --cloud-config=$(CLOUD_CONFIG)\n        env:\n        - name: NODE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CSI_ENDPOINT\n          value: unix://csi/csi.sock\n        - name: CLOUD_CONFIG\n          value: /etc/config/cloud.conf\n        imagePullPolicy: IfNotPresent\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: Bidirectional\n        - name: pods-cloud-data\n          mountPath: /var/lib/cloud/data\n          readOnly: true\n        - name: pods-probe-dir\n          mountPath: /dev\n          mountPropagation: HostToContainer\n        - name: secret-cinderplugin\n          mountPath: /etc/config\n          readOnly: true\n      volumes:\n      - name: socket-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/cinder.csi.openstack.org\n          type: DirectoryOrCreate\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n      - name: pods-cloud-data\n        hostPath:\n          path: /var/lib/cloud/data\n          type: Directory\n      - name: pods-probe-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: secret-cinderplugin\n        secret:\n          secretName: cloud-config\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"cinder-csi-plugin\" does not have a read-only root file system"
  },
  {
    "id": "04094",
    "manifest_path": "data/manifests/the_stack_sample/sample_1854.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: csi-cinder-nodeplugin\n  namespace: kube-system\nspec:\n  selector:\n    matchLabels:\n      app: csi-cinder-nodeplugin\n  template:\n    metadata:\n      labels:\n        app: csi-cinder-nodeplugin\n    spec:\n      serviceAccount: csi-cinder-node-sa\n      containers:\n      - name: node-driver-registrar\n        image: quay.io/k8scsi/csi-node-driver-registrar:v1.1.0\n        args:\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REG_SOCK_PATH)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REG_SOCK_PATH\n          value: /var/lib/kubelet/plugins/cinder.csi.openstack.org/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        imagePullPolicy: IfNotPresent\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n      - name: cinder-csi-plugin\n        securityContext:\n          privileged: true\n          capabilities:\n            add:\n            - SYS_ADMIN\n          allowPrivilegeEscalation: true\n        image: docker.io/k8scloudprovider/cinder-csi-plugin:latest\n        args:\n        - /bin/cinder-csi-plugin\n        - --nodeid=$(NODE_ID)\n        - --endpoint=$(CSI_ENDPOINT)\n        - --cloud-config=$(CLOUD_CONFIG)\n        env:\n        - name: NODE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CSI_ENDPOINT\n          value: unix://csi/csi.sock\n        - name: CLOUD_CONFIG\n          value: /etc/config/cloud.conf\n        imagePullPolicy: IfNotPresent\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: Bidirectional\n        - name: pods-cloud-data\n          mountPath: /var/lib/cloud/data\n          readOnly: true\n        - name: pods-probe-dir\n          mountPath: /dev\n          mountPropagation: HostToContainer\n        - name: secret-cinderplugin\n          mountPath: /etc/config\n          readOnly: true\n      volumes:\n      - name: socket-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/cinder.csi.openstack.org\n          type: DirectoryOrCreate\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n      - name: pods-cloud-data\n        hostPath:\n          path: /var/lib/cloud/data\n          type: Directory\n      - name: pods-probe-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: secret-cinderplugin\n        secret:\n          secretName: cloud-config\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"node-driver-registrar\" does not have a read-only root file system"
  },
  {
    "id": "04095",
    "manifest_path": "data/manifests/the_stack_sample/sample_1854.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: csi-cinder-nodeplugin\n  namespace: kube-system\nspec:\n  selector:\n    matchLabels:\n      app: csi-cinder-nodeplugin\n  template:\n    metadata:\n      labels:\n        app: csi-cinder-nodeplugin\n    spec:\n      serviceAccount: csi-cinder-node-sa\n      containers:\n      - name: node-driver-registrar\n        image: quay.io/k8scsi/csi-node-driver-registrar:v1.1.0\n        args:\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REG_SOCK_PATH)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REG_SOCK_PATH\n          value: /var/lib/kubelet/plugins/cinder.csi.openstack.org/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        imagePullPolicy: IfNotPresent\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n      - name: cinder-csi-plugin\n        securityContext:\n          privileged: true\n          capabilities:\n            add:\n            - SYS_ADMIN\n          allowPrivilegeEscalation: true\n        image: docker.io/k8scloudprovider/cinder-csi-plugin:latest\n        args:\n        - /bin/cinder-csi-plugin\n        - --nodeid=$(NODE_ID)\n        - --endpoint=$(CSI_ENDPOINT)\n        - --cloud-config=$(CLOUD_CONFIG)\n        env:\n        - name: NODE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CSI_ENDPOINT\n          value: unix://csi/csi.sock\n        - name: CLOUD_CONFIG\n          value: /etc/config/cloud.conf\n        imagePullPolicy: IfNotPresent\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: Bidirectional\n        - name: pods-cloud-data\n          mountPath: /var/lib/cloud/data\n          readOnly: true\n        - name: pods-probe-dir\n          mountPath: /dev\n          mountPropagation: HostToContainer\n        - name: secret-cinderplugin\n          mountPath: /etc/config\n          readOnly: true\n      volumes:\n      - name: socket-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/cinder.csi.openstack.org\n          type: DirectoryOrCreate\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n      - name: pods-cloud-data\n        hostPath:\n          path: /var/lib/cloud/data\n          type: Directory\n      - name: pods-probe-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: secret-cinderplugin\n        secret:\n          secretName: cloud-config\n",
    "policy_id": "privilege-escalation-container",
    "violation_text": "container \"cinder-csi-plugin\" has AllowPrivilegeEscalation set to true."
  },
  {
    "id": "04096",
    "manifest_path": "data/manifests/the_stack_sample/sample_1854.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: csi-cinder-nodeplugin\n  namespace: kube-system\nspec:\n  selector:\n    matchLabels:\n      app: csi-cinder-nodeplugin\n  template:\n    metadata:\n      labels:\n        app: csi-cinder-nodeplugin\n    spec:\n      serviceAccount: csi-cinder-node-sa\n      containers:\n      - name: node-driver-registrar\n        image: quay.io/k8scsi/csi-node-driver-registrar:v1.1.0\n        args:\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REG_SOCK_PATH)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REG_SOCK_PATH\n          value: /var/lib/kubelet/plugins/cinder.csi.openstack.org/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        imagePullPolicy: IfNotPresent\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n      - name: cinder-csi-plugin\n        securityContext:\n          privileged: true\n          capabilities:\n            add:\n            - SYS_ADMIN\n          allowPrivilegeEscalation: true\n        image: docker.io/k8scloudprovider/cinder-csi-plugin:latest\n        args:\n        - /bin/cinder-csi-plugin\n        - --nodeid=$(NODE_ID)\n        - --endpoint=$(CSI_ENDPOINT)\n        - --cloud-config=$(CLOUD_CONFIG)\n        env:\n        - name: NODE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CSI_ENDPOINT\n          value: unix://csi/csi.sock\n        - name: CLOUD_CONFIG\n          value: /etc/config/cloud.conf\n        imagePullPolicy: IfNotPresent\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: Bidirectional\n        - name: pods-cloud-data\n          mountPath: /var/lib/cloud/data\n          readOnly: true\n        - name: pods-probe-dir\n          mountPath: /dev\n          mountPropagation: HostToContainer\n        - name: secret-cinderplugin\n          mountPath: /etc/config\n          readOnly: true\n      volumes:\n      - name: socket-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/cinder.csi.openstack.org\n          type: DirectoryOrCreate\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n      - name: pods-cloud-data\n        hostPath:\n          path: /var/lib/cloud/data\n          type: Directory\n      - name: pods-probe-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: secret-cinderplugin\n        secret:\n          secretName: cloud-config\n",
    "policy_id": "privileged-container",
    "violation_text": "container \"cinder-csi-plugin\" is privileged"
  },
  {
    "id": "04097",
    "manifest_path": "data/manifests/the_stack_sample/sample_1854.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: csi-cinder-nodeplugin\n  namespace: kube-system\nspec:\n  selector:\n    matchLabels:\n      app: csi-cinder-nodeplugin\n  template:\n    metadata:\n      labels:\n        app: csi-cinder-nodeplugin\n    spec:\n      serviceAccount: csi-cinder-node-sa\n      containers:\n      - name: node-driver-registrar\n        image: quay.io/k8scsi/csi-node-driver-registrar:v1.1.0\n        args:\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REG_SOCK_PATH)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REG_SOCK_PATH\n          value: /var/lib/kubelet/plugins/cinder.csi.openstack.org/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        imagePullPolicy: IfNotPresent\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n      - name: cinder-csi-plugin\n        securityContext:\n          privileged: true\n          capabilities:\n            add:\n            - SYS_ADMIN\n          allowPrivilegeEscalation: true\n        image: docker.io/k8scloudprovider/cinder-csi-plugin:latest\n        args:\n        - /bin/cinder-csi-plugin\n        - --nodeid=$(NODE_ID)\n        - --endpoint=$(CSI_ENDPOINT)\n        - --cloud-config=$(CLOUD_CONFIG)\n        env:\n        - name: NODE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CSI_ENDPOINT\n          value: unix://csi/csi.sock\n        - name: CLOUD_CONFIG\n          value: /etc/config/cloud.conf\n        imagePullPolicy: IfNotPresent\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: Bidirectional\n        - name: pods-cloud-data\n          mountPath: /var/lib/cloud/data\n          readOnly: true\n        - name: pods-probe-dir\n          mountPath: /dev\n          mountPropagation: HostToContainer\n        - name: secret-cinderplugin\n          mountPath: /etc/config\n          readOnly: true\n      volumes:\n      - name: socket-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/cinder.csi.openstack.org\n          type: DirectoryOrCreate\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n      - name: pods-cloud-data\n        hostPath:\n          path: /var/lib/cloud/data\n          type: Directory\n      - name: pods-probe-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: secret-cinderplugin\n        secret:\n          secretName: cloud-config\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"cinder-csi-plugin\" is not set to runAsNonRoot"
  },
  {
    "id": "04098",
    "manifest_path": "data/manifests/the_stack_sample/sample_1854.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: csi-cinder-nodeplugin\n  namespace: kube-system\nspec:\n  selector:\n    matchLabels:\n      app: csi-cinder-nodeplugin\n  template:\n    metadata:\n      labels:\n        app: csi-cinder-nodeplugin\n    spec:\n      serviceAccount: csi-cinder-node-sa\n      containers:\n      - name: node-driver-registrar\n        image: quay.io/k8scsi/csi-node-driver-registrar:v1.1.0\n        args:\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REG_SOCK_PATH)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REG_SOCK_PATH\n          value: /var/lib/kubelet/plugins/cinder.csi.openstack.org/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        imagePullPolicy: IfNotPresent\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n      - name: cinder-csi-plugin\n        securityContext:\n          privileged: true\n          capabilities:\n            add:\n            - SYS_ADMIN\n          allowPrivilegeEscalation: true\n        image: docker.io/k8scloudprovider/cinder-csi-plugin:latest\n        args:\n        - /bin/cinder-csi-plugin\n        - --nodeid=$(NODE_ID)\n        - --endpoint=$(CSI_ENDPOINT)\n        - --cloud-config=$(CLOUD_CONFIG)\n        env:\n        - name: NODE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CSI_ENDPOINT\n          value: unix://csi/csi.sock\n        - name: CLOUD_CONFIG\n          value: /etc/config/cloud.conf\n        imagePullPolicy: IfNotPresent\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: Bidirectional\n        - name: pods-cloud-data\n          mountPath: /var/lib/cloud/data\n          readOnly: true\n        - name: pods-probe-dir\n          mountPath: /dev\n          mountPropagation: HostToContainer\n        - name: secret-cinderplugin\n          mountPath: /etc/config\n          readOnly: true\n      volumes:\n      - name: socket-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/cinder.csi.openstack.org\n          type: DirectoryOrCreate\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n      - name: pods-cloud-data\n        hostPath:\n          path: /var/lib/cloud/data\n          type: Directory\n      - name: pods-probe-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: secret-cinderplugin\n        secret:\n          secretName: cloud-config\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"node-driver-registrar\" is not set to runAsNonRoot"
  },
  {
    "id": "04099",
    "manifest_path": "data/manifests/the_stack_sample/sample_1854.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: csi-cinder-nodeplugin\n  namespace: kube-system\nspec:\n  selector:\n    matchLabels:\n      app: csi-cinder-nodeplugin\n  template:\n    metadata:\n      labels:\n        app: csi-cinder-nodeplugin\n    spec:\n      serviceAccount: csi-cinder-node-sa\n      containers:\n      - name: node-driver-registrar\n        image: quay.io/k8scsi/csi-node-driver-registrar:v1.1.0\n        args:\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REG_SOCK_PATH)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REG_SOCK_PATH\n          value: /var/lib/kubelet/plugins/cinder.csi.openstack.org/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        imagePullPolicy: IfNotPresent\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n      - name: cinder-csi-plugin\n        securityContext:\n          privileged: true\n          capabilities:\n            add:\n            - SYS_ADMIN\n          allowPrivilegeEscalation: true\n        image: docker.io/k8scloudprovider/cinder-csi-plugin:latest\n        args:\n        - /bin/cinder-csi-plugin\n        - --nodeid=$(NODE_ID)\n        - --endpoint=$(CSI_ENDPOINT)\n        - --cloud-config=$(CLOUD_CONFIG)\n        env:\n        - name: NODE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CSI_ENDPOINT\n          value: unix://csi/csi.sock\n        - name: CLOUD_CONFIG\n          value: /etc/config/cloud.conf\n        imagePullPolicy: IfNotPresent\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: Bidirectional\n        - name: pods-cloud-data\n          mountPath: /var/lib/cloud/data\n          readOnly: true\n        - name: pods-probe-dir\n          mountPath: /dev\n          mountPropagation: HostToContainer\n        - name: secret-cinderplugin\n          mountPath: /etc/config\n          readOnly: true\n      volumes:\n      - name: socket-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/cinder.csi.openstack.org\n          type: DirectoryOrCreate\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n      - name: pods-cloud-data\n        hostPath:\n          path: /var/lib/cloud/data\n          type: Directory\n      - name: pods-probe-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: secret-cinderplugin\n        secret:\n          secretName: cloud-config\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"cinder-csi-plugin\" has cpu request 0"
  },
  {
    "id": "04100",
    "manifest_path": "data/manifests/the_stack_sample/sample_1854.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: csi-cinder-nodeplugin\n  namespace: kube-system\nspec:\n  selector:\n    matchLabels:\n      app: csi-cinder-nodeplugin\n  template:\n    metadata:\n      labels:\n        app: csi-cinder-nodeplugin\n    spec:\n      serviceAccount: csi-cinder-node-sa\n      containers:\n      - name: node-driver-registrar\n        image: quay.io/k8scsi/csi-node-driver-registrar:v1.1.0\n        args:\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REG_SOCK_PATH)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REG_SOCK_PATH\n          value: /var/lib/kubelet/plugins/cinder.csi.openstack.org/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        imagePullPolicy: IfNotPresent\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n      - name: cinder-csi-plugin\n        securityContext:\n          privileged: true\n          capabilities:\n            add:\n            - SYS_ADMIN\n          allowPrivilegeEscalation: true\n        image: docker.io/k8scloudprovider/cinder-csi-plugin:latest\n        args:\n        - /bin/cinder-csi-plugin\n        - --nodeid=$(NODE_ID)\n        - --endpoint=$(CSI_ENDPOINT)\n        - --cloud-config=$(CLOUD_CONFIG)\n        env:\n        - name: NODE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CSI_ENDPOINT\n          value: unix://csi/csi.sock\n        - name: CLOUD_CONFIG\n          value: /etc/config/cloud.conf\n        imagePullPolicy: IfNotPresent\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: Bidirectional\n        - name: pods-cloud-data\n          mountPath: /var/lib/cloud/data\n          readOnly: true\n        - name: pods-probe-dir\n          mountPath: /dev\n          mountPropagation: HostToContainer\n        - name: secret-cinderplugin\n          mountPath: /etc/config\n          readOnly: true\n      volumes:\n      - name: socket-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/cinder.csi.openstack.org\n          type: DirectoryOrCreate\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n      - name: pods-cloud-data\n        hostPath:\n          path: /var/lib/cloud/data\n          type: Directory\n      - name: pods-probe-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: secret-cinderplugin\n        secret:\n          secretName: cloud-config\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"node-driver-registrar\" has cpu request 0"
  },
  {
    "id": "04101",
    "manifest_path": "data/manifests/the_stack_sample/sample_1854.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: csi-cinder-nodeplugin\n  namespace: kube-system\nspec:\n  selector:\n    matchLabels:\n      app: csi-cinder-nodeplugin\n  template:\n    metadata:\n      labels:\n        app: csi-cinder-nodeplugin\n    spec:\n      serviceAccount: csi-cinder-node-sa\n      containers:\n      - name: node-driver-registrar\n        image: quay.io/k8scsi/csi-node-driver-registrar:v1.1.0\n        args:\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REG_SOCK_PATH)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REG_SOCK_PATH\n          value: /var/lib/kubelet/plugins/cinder.csi.openstack.org/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        imagePullPolicy: IfNotPresent\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n      - name: cinder-csi-plugin\n        securityContext:\n          privileged: true\n          capabilities:\n            add:\n            - SYS_ADMIN\n          allowPrivilegeEscalation: true\n        image: docker.io/k8scloudprovider/cinder-csi-plugin:latest\n        args:\n        - /bin/cinder-csi-plugin\n        - --nodeid=$(NODE_ID)\n        - --endpoint=$(CSI_ENDPOINT)\n        - --cloud-config=$(CLOUD_CONFIG)\n        env:\n        - name: NODE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CSI_ENDPOINT\n          value: unix://csi/csi.sock\n        - name: CLOUD_CONFIG\n          value: /etc/config/cloud.conf\n        imagePullPolicy: IfNotPresent\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: Bidirectional\n        - name: pods-cloud-data\n          mountPath: /var/lib/cloud/data\n          readOnly: true\n        - name: pods-probe-dir\n          mountPath: /dev\n          mountPropagation: HostToContainer\n        - name: secret-cinderplugin\n          mountPath: /etc/config\n          readOnly: true\n      volumes:\n      - name: socket-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/cinder.csi.openstack.org\n          type: DirectoryOrCreate\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n      - name: pods-cloud-data\n        hostPath:\n          path: /var/lib/cloud/data\n          type: Directory\n      - name: pods-probe-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: secret-cinderplugin\n        secret:\n          secretName: cloud-config\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"cinder-csi-plugin\" has memory limit 0"
  },
  {
    "id": "04102",
    "manifest_path": "data/manifests/the_stack_sample/sample_1854.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: csi-cinder-nodeplugin\n  namespace: kube-system\nspec:\n  selector:\n    matchLabels:\n      app: csi-cinder-nodeplugin\n  template:\n    metadata:\n      labels:\n        app: csi-cinder-nodeplugin\n    spec:\n      serviceAccount: csi-cinder-node-sa\n      containers:\n      - name: node-driver-registrar\n        image: quay.io/k8scsi/csi-node-driver-registrar:v1.1.0\n        args:\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REG_SOCK_PATH)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REG_SOCK_PATH\n          value: /var/lib/kubelet/plugins/cinder.csi.openstack.org/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        imagePullPolicy: IfNotPresent\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n      - name: cinder-csi-plugin\n        securityContext:\n          privileged: true\n          capabilities:\n            add:\n            - SYS_ADMIN\n          allowPrivilegeEscalation: true\n        image: docker.io/k8scloudprovider/cinder-csi-plugin:latest\n        args:\n        - /bin/cinder-csi-plugin\n        - --nodeid=$(NODE_ID)\n        - --endpoint=$(CSI_ENDPOINT)\n        - --cloud-config=$(CLOUD_CONFIG)\n        env:\n        - name: NODE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CSI_ENDPOINT\n          value: unix://csi/csi.sock\n        - name: CLOUD_CONFIG\n          value: /etc/config/cloud.conf\n        imagePullPolicy: IfNotPresent\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: Bidirectional\n        - name: pods-cloud-data\n          mountPath: /var/lib/cloud/data\n          readOnly: true\n        - name: pods-probe-dir\n          mountPath: /dev\n          mountPropagation: HostToContainer\n        - name: secret-cinderplugin\n          mountPath: /etc/config\n          readOnly: true\n      volumes:\n      - name: socket-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/cinder.csi.openstack.org\n          type: DirectoryOrCreate\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n      - name: pods-cloud-data\n        hostPath:\n          path: /var/lib/cloud/data\n          type: Directory\n      - name: pods-probe-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: secret-cinderplugin\n        secret:\n          secretName: cloud-config\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"node-driver-registrar\" has memory limit 0"
  },
  {
    "id": "04103",
    "manifest_path": "data/manifests/the_stack_sample/sample_1855.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: podinfo-ds\n  labels:\n    app.kubernetes.io/name: podinfo-ds\nspec:\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: podinfo-ds\n  template:\n    metadata:\n      annotations:\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9797'\n      labels:\n        app.kubernetes.io/name: podinfo-ds\n    spec:\n      containers:\n      - name: podinfod\n        image: ghcr.io/stefanprodan/podinfo:6.0.0\n        imagePullPolicy: IfNotPresent\n        ports:\n        - name: http\n          containerPort: 9898\n          protocol: TCP\n        - name: http-metrics\n          containerPort: 9797\n          protocol: TCP\n        - name: grpc\n          containerPort: 9999\n          protocol: TCP\n        command:\n        - ./podinfo\n        - --port=9898\n        - --port-metrics=9797\n        - --grpc-port=9999\n        - --grpc-service-name=podinfo\n        - --level=info\n        - --random-delay=false\n        - --random-error=false\n        livenessProbe:\n          httpGet:\n            port: 9898\n            path: /healthz\n          initialDelaySeconds: 5\n          timeoutSeconds: 5\n        readinessProbe:\n          httpGet:\n            port: 9898\n            path: /readyz\n          initialDelaySeconds: 5\n          timeoutSeconds: 5\n        resources:\n          limits:\n            cpu: 1000m\n            memory: 128Mi\n          requests:\n            cpu: 1m\n            memory: 16Mi\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"podinfod\" does not have a read-only root file system"
  },
  {
    "id": "04104",
    "manifest_path": "data/manifests/the_stack_sample/sample_1855.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: podinfo-ds\n  labels:\n    app.kubernetes.io/name: podinfo-ds\nspec:\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: podinfo-ds\n  template:\n    metadata:\n      annotations:\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9797'\n      labels:\n        app.kubernetes.io/name: podinfo-ds\n    spec:\n      containers:\n      - name: podinfod\n        image: ghcr.io/stefanprodan/podinfo:6.0.0\n        imagePullPolicy: IfNotPresent\n        ports:\n        - name: http\n          containerPort: 9898\n          protocol: TCP\n        - name: http-metrics\n          containerPort: 9797\n          protocol: TCP\n        - name: grpc\n          containerPort: 9999\n          protocol: TCP\n        command:\n        - ./podinfo\n        - --port=9898\n        - --port-metrics=9797\n        - --grpc-port=9999\n        - --grpc-service-name=podinfo\n        - --level=info\n        - --random-delay=false\n        - --random-error=false\n        livenessProbe:\n          httpGet:\n            port: 9898\n            path: /healthz\n          initialDelaySeconds: 5\n          timeoutSeconds: 5\n        readinessProbe:\n          httpGet:\n            port: 9898\n            path: /readyz\n          initialDelaySeconds: 5\n          timeoutSeconds: 5\n        resources:\n          limits:\n            cpu: 1000m\n            memory: 128Mi\n          requests:\n            cpu: 1m\n            memory: 16Mi\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"podinfod\" is not set to runAsNonRoot"
  },
  {
    "id": "04105",
    "manifest_path": "data/manifests/the_stack_sample/sample_1864.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-7290\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"nginx\" is using an invalid container image, \"nginx\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "04106",
    "manifest_path": "data/manifests/the_stack_sample/sample_1864.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-7290\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"nginx\" does not have a read-only root file system"
  },
  {
    "id": "04107",
    "manifest_path": "data/manifests/the_stack_sample/sample_1864.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-7290\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"nginx\" is not set to runAsNonRoot"
  },
  {
    "id": "04108",
    "manifest_path": "data/manifests/the_stack_sample/sample_1864.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-7290\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"nginx\" has cpu request 0"
  },
  {
    "id": "04109",
    "manifest_path": "data/manifests/the_stack_sample/sample_1864.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-7290\nspec:\n  containers:\n  - name: nginx\n    image: nginx\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"nginx\" has memory limit 0"
  },
  {
    "id": "04110",
    "manifest_path": "data/manifests/the_stack_sample/sample_1865.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: example-minio-data\nspec:\n  template:\n    spec:\n      containers:\n      - name: minio-client\n        image: minio/mc\n        command:\n        - /bin/sh\n        - -c\n        - 'sleep 100 && mc config host add minio-service http://minio-service:9000\n          minio minio123 && mc mb minio-service/my-bucket && echo ''hello'' > file1.txt\n          && echo ''world'' > file2.txt && mc cp *.txt minio-service/my-bucket '\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"minio-client\" is using an invalid container image, \"minio/mc\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "04111",
    "manifest_path": "data/manifests/the_stack_sample/sample_1865.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: example-minio-data\nspec:\n  template:\n    spec:\n      containers:\n      - name: minio-client\n        image: minio/mc\n        command:\n        - /bin/sh\n        - -c\n        - 'sleep 100 && mc config host add minio-service http://minio-service:9000\n          minio minio123 && mc mb minio-service/my-bucket && echo ''hello'' > file1.txt\n          && echo ''world'' > file2.txt && mc cp *.txt minio-service/my-bucket '\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"minio-client\" does not have a read-only root file system"
  },
  {
    "id": "04112",
    "manifest_path": "data/manifests/the_stack_sample/sample_1865.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: example-minio-data\nspec:\n  template:\n    spec:\n      containers:\n      - name: minio-client\n        image: minio/mc\n        command:\n        - /bin/sh\n        - -c\n        - 'sleep 100 && mc config host add minio-service http://minio-service:9000\n          minio minio123 && mc mb minio-service/my-bucket && echo ''hello'' > file1.txt\n          && echo ''world'' > file2.txt && mc cp *.txt minio-service/my-bucket '\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"minio-client\" is not set to runAsNonRoot"
  },
  {
    "id": "04113",
    "manifest_path": "data/manifests/the_stack_sample/sample_1865.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: example-minio-data\nspec:\n  template:\n    spec:\n      containers:\n      - name: minio-client\n        image: minio/mc\n        command:\n        - /bin/sh\n        - -c\n        - 'sleep 100 && mc config host add minio-service http://minio-service:9000\n          minio minio123 && mc mb minio-service/my-bucket && echo ''hello'' > file1.txt\n          && echo ''world'' > file2.txt && mc cp *.txt minio-service/my-bucket '\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"minio-client\" has cpu request 0"
  },
  {
    "id": "04114",
    "manifest_path": "data/manifests/the_stack_sample/sample_1865.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: example-minio-data\nspec:\n  template:\n    spec:\n      containers:\n      - name: minio-client\n        image: minio/mc\n        command:\n        - /bin/sh\n        - -c\n        - 'sleep 100 && mc config host add minio-service http://minio-service:9000\n          minio minio123 && mc mb minio-service/my-bucket && echo ''hello'' > file1.txt\n          && echo ''world'' > file2.txt && mc cp *.txt minio-service/my-bucket '\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"minio-client\" has memory limit 0"
  },
  {
    "id": "04115",
    "manifest_path": "data/manifests/the_stack_sample/sample_1866.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: dummy-name\nspec:\n  containers:\n  - env:\n    - name: AIRFLOW__CORE__EXECUTOR\n      value: LocalExecutor\n    - name: AIRFLOW__CORE__FERNET_KEY\n      valueFrom:\n        secretKeyRef:\n          name: RELEASE-NAME-fernet-key\n          key: fernet-key\n    - name: AIRFLOW__DATABASE__SQL_ALCHEMY_CONN\n      valueFrom:\n        secretKeyRef:\n          name: RELEASE-NAME-airflow-metadata\n          key: connection\n    - name: AIRFLOW_CONN_AIRFLOW_DB\n      valueFrom:\n        secretKeyRef:\n          name: RELEASE-NAME-airflow-metadata\n          key: connection\n    image: dummy_image\n    imagePullPolicy: IfNotPresent\n    name: base\n    volumeMounts:\n    - mountPath: /opt/airflow/logs\n      name: airflow-logs\n    - mountPath: /opt/airflow/airflow.cfg\n      name: airflow-config\n      readOnly: true\n      subPath: airflow.cfg\n  securityContext:\n    runAsUser: 50000\n    fsGroup: 50000\n  serviceAccountName: RELEASE-NAME-worker-serviceaccount\n  volumes:\n  - emptyDir: {}\n    name: airflow-logs\n  - configMap:\n      name: RELEASE-NAME-airflow-config\n    name: airflow-config\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"base\" is using an invalid container image, \"dummy_image\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "04116",
    "manifest_path": "data/manifests/the_stack_sample/sample_1866.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: dummy-name\nspec:\n  containers:\n  - env:\n    - name: AIRFLOW__CORE__EXECUTOR\n      value: LocalExecutor\n    - name: AIRFLOW__CORE__FERNET_KEY\n      valueFrom:\n        secretKeyRef:\n          name: RELEASE-NAME-fernet-key\n          key: fernet-key\n    - name: AIRFLOW__DATABASE__SQL_ALCHEMY_CONN\n      valueFrom:\n        secretKeyRef:\n          name: RELEASE-NAME-airflow-metadata\n          key: connection\n    - name: AIRFLOW_CONN_AIRFLOW_DB\n      valueFrom:\n        secretKeyRef:\n          name: RELEASE-NAME-airflow-metadata\n          key: connection\n    image: dummy_image\n    imagePullPolicy: IfNotPresent\n    name: base\n    volumeMounts:\n    - mountPath: /opt/airflow/logs\n      name: airflow-logs\n    - mountPath: /opt/airflow/airflow.cfg\n      name: airflow-config\n      readOnly: true\n      subPath: airflow.cfg\n  securityContext:\n    runAsUser: 50000\n    fsGroup: 50000\n  serviceAccountName: RELEASE-NAME-worker-serviceaccount\n  volumes:\n  - emptyDir: {}\n    name: airflow-logs\n  - configMap:\n      name: RELEASE-NAME-airflow-config\n    name: airflow-config\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"base\" does not have a read-only root file system"
  },
  {
    "id": "04117",
    "manifest_path": "data/manifests/the_stack_sample/sample_1866.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: dummy-name\nspec:\n  containers:\n  - env:\n    - name: AIRFLOW__CORE__EXECUTOR\n      value: LocalExecutor\n    - name: AIRFLOW__CORE__FERNET_KEY\n      valueFrom:\n        secretKeyRef:\n          name: RELEASE-NAME-fernet-key\n          key: fernet-key\n    - name: AIRFLOW__DATABASE__SQL_ALCHEMY_CONN\n      valueFrom:\n        secretKeyRef:\n          name: RELEASE-NAME-airflow-metadata\n          key: connection\n    - name: AIRFLOW_CONN_AIRFLOW_DB\n      valueFrom:\n        secretKeyRef:\n          name: RELEASE-NAME-airflow-metadata\n          key: connection\n    image: dummy_image\n    imagePullPolicy: IfNotPresent\n    name: base\n    volumeMounts:\n    - mountPath: /opt/airflow/logs\n      name: airflow-logs\n    - mountPath: /opt/airflow/airflow.cfg\n      name: airflow-config\n      readOnly: true\n      subPath: airflow.cfg\n  securityContext:\n    runAsUser: 50000\n    fsGroup: 50000\n  serviceAccountName: RELEASE-NAME-worker-serviceaccount\n  volumes:\n  - emptyDir: {}\n    name: airflow-logs\n  - configMap:\n      name: RELEASE-NAME-airflow-config\n    name: airflow-config\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"base\" has cpu request 0"
  },
  {
    "id": "04118",
    "manifest_path": "data/manifests/the_stack_sample/sample_1866.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: dummy-name\nspec:\n  containers:\n  - env:\n    - name: AIRFLOW__CORE__EXECUTOR\n      value: LocalExecutor\n    - name: AIRFLOW__CORE__FERNET_KEY\n      valueFrom:\n        secretKeyRef:\n          name: RELEASE-NAME-fernet-key\n          key: fernet-key\n    - name: AIRFLOW__DATABASE__SQL_ALCHEMY_CONN\n      valueFrom:\n        secretKeyRef:\n          name: RELEASE-NAME-airflow-metadata\n          key: connection\n    - name: AIRFLOW_CONN_AIRFLOW_DB\n      valueFrom:\n        secretKeyRef:\n          name: RELEASE-NAME-airflow-metadata\n          key: connection\n    image: dummy_image\n    imagePullPolicy: IfNotPresent\n    name: base\n    volumeMounts:\n    - mountPath: /opt/airflow/logs\n      name: airflow-logs\n    - mountPath: /opt/airflow/airflow.cfg\n      name: airflow-config\n      readOnly: true\n      subPath: airflow.cfg\n  securityContext:\n    runAsUser: 50000\n    fsGroup: 50000\n  serviceAccountName: RELEASE-NAME-worker-serviceaccount\n  volumes:\n  - emptyDir: {}\n    name: airflow-logs\n  - configMap:\n      name: RELEASE-NAME-airflow-config\n    name: airflow-config\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"base\" has memory limit 0"
  },
  {
    "id": "04119",
    "manifest_path": "data/manifests/the_stack_sample/sample_1868.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: vote\n  labels:\n    app: vote\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: vote\n      env: dev\n  template:\n    metadata:\n      labels:\n        app: vote\n        env: dev\n    spec:\n      containers:\n      - name: vote\n        image: dockersamples/examplevotingapp_vote:before\n        ports:\n        - containerPort: 80\n          name: vote\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"vote\" does not have a read-only root file system"
  },
  {
    "id": "04120",
    "manifest_path": "data/manifests/the_stack_sample/sample_1868.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: vote\n  labels:\n    app: vote\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: vote\n      env: dev\n  template:\n    metadata:\n      labels:\n        app: vote\n        env: dev\n    spec:\n      containers:\n      - name: vote\n        image: dockersamples/examplevotingapp_vote:before\n        ports:\n        - containerPort: 80\n          name: vote\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"vote\" is not set to runAsNonRoot"
  }
]