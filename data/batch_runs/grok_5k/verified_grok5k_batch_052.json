[
  {
    "id": "02081",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: selector-test-pod\n  labels:\n    name: selector-test-pod\n    unique-label: bingbang\nspec:\n  containers:\n  - name: kubernetes-pause\n    image: gcr.io/google-containers/pause:2.0\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "02082",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: selector-test-pod\n  labels:\n    name: selector-test-pod\n    unique-label: bingbang\nspec:\n  containers:\n  - name: kubernetes-pause\n    image: gcr.io/google-containers/pause:2.0\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "02083",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: plank\n  labels:\n    app: plank\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: plank\n  template:\n    metadata:\n      labels:\n        app: plank\n    spec:\n      containers:\n      - name: plank\n        image: gcr.io/k8s-prow/plank:v20190920-d724a578b\n        args:\n        - --build-cluster=/etc/cluster/cluster\n        - --dry-run=false\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        - --skip-report=true\n        volumeMounts:\n        - mountPath: /etc/cluster\n          name: cluster\n          readOnly: true\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: cluster\n        secret:\n          defaultMode: 420\n          secretName: build-cluster\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n",
    "errors": []
  },
  {
    "id": "02084",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: plank\n  labels:\n    app: plank\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: plank\n  template:\n    metadata:\n      labels:\n        app: plank\n    spec:\n      containers:\n      - name: plank\n        image: gcr.io/k8s-prow/plank:v20190920-d724a578b\n        args:\n        - --build-cluster=/etc/cluster/cluster\n        - --dry-run=false\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        - --skip-report=true\n        volumeMounts:\n        - mountPath: /etc/cluster\n          name: cluster\n          readOnly: true\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: cluster\n        secret:\n          defaultMode: 420\n          secretName: build-cluster\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n",
    "errors": []
  },
  {
    "id": "02085",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: plank\n  labels:\n    app: plank\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: plank\n  template:\n    metadata:\n      labels:\n        app: plank\n    spec:\n      containers:\n      - name: plank\n        image: gcr.io/k8s-prow/plank:v20190920-d724a578b\n        args:\n        - --build-cluster=/etc/cluster/cluster\n        - --dry-run=false\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        - --skip-report=true\n        volumeMounts:\n        - mountPath: /etc/cluster\n          name: cluster\n          readOnly: true\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: cluster\n        secret:\n          defaultMode: 420\n          secretName: build-cluster\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n",
    "errors": []
  },
  {
    "id": "02086",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: plank\n  labels:\n    app: plank\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: plank\n  template:\n    metadata:\n      labels:\n        app: plank\n    spec:\n      containers:\n      - name: plank\n        image: gcr.io/k8s-prow/plank:v20190920-d724a578b\n        args:\n        - --build-cluster=/etc/cluster/cluster\n        - --dry-run=false\n        - --github-endpoint=http://ghproxy\n        - --github-endpoint=https://api.github.com\n        - --config-path=/etc/config/config.yaml\n        - --job-config-path=/etc/job-config\n        - --skip-report=true\n        volumeMounts:\n        - mountPath: /etc/cluster\n          name: cluster\n          readOnly: true\n        - name: oauth\n          mountPath: /etc/github\n          readOnly: true\n        - name: config\n          mountPath: /etc/config\n          readOnly: true\n        - name: job-config\n          mountPath: /etc/job-config\n          readOnly: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: cluster\n        secret:\n          defaultMode: 420\n          secretName: build-cluster\n      - name: oauth\n        secret:\n          secretName: oauth-token\n      - name: config\n        configMap:\n          name: config\n      - name: job-config\n        configMap:\n          name: job-config\n",
    "errors": []
  },
  {
    "id": "02087",
    "policy_id": "no_latest_tag",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "02088",
    "policy_id": "no_latest_tag",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "02089",
    "policy_id": "read_only_root_fs",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "02090",
    "policy_id": "read_only_root_fs",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "02091",
    "policy_id": "run_as_non_root",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "02092",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "02093",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "02094",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "02095",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "02096",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: busybox\n  labels:\n    app: busybox\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: busybox\n  template:\n    metadata:\n      labels:\n        app: busybox\n    spec:\n      containers:\n      - name: busybox\n        image: busybox:1.28\n        command:\n        - sleep\n        - '3600'\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      affinity:\n        podAntiAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n          - labelSelector:\n              matchExpressions:\n              - key: app\n                operator: In\n                values:\n                - busybox\n            topologyKey: kubernetes.io/hostname\n",
    "errors": []
  },
  {
    "id": "02097",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: busybox\n  labels:\n    app: busybox\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: busybox\n  template:\n    metadata:\n      labels:\n        app: busybox\n    spec:\n      containers:\n      - name: busybox\n        image: busybox:1.28\n        command:\n        - sleep\n        - '3600'\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      affinity:\n        podAntiAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n          - labelSelector:\n              matchExpressions:\n              - key: app\n                operator: In\n                values:\n                - busybox\n            topologyKey: kubernetes.io/hostname\n",
    "errors": []
  },
  {
    "id": "02098",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: busybox\n  labels:\n    app: busybox\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: busybox\n  template:\n    metadata:\n      labels:\n        app: busybox\n    spec:\n      containers:\n      - name: busybox\n        image: busybox:1.28\n        command:\n        - sleep\n        - '3600'\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      affinity:\n        podAntiAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n          - labelSelector:\n              matchExpressions:\n              - key: app\n                operator: In\n                values:\n                - busybox\n            topologyKey: kubernetes.io/hostname\n",
    "errors": []
  },
  {
    "id": "02099",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: busybox\n  labels:\n    app: busybox\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: busybox\n  template:\n    metadata:\n      labels:\n        app: busybox\n    spec:\n      containers:\n      - name: busybox\n        image: busybox:1.28\n        command:\n        - sleep\n        - '3600'\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      affinity:\n        podAntiAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n          - labelSelector:\n              matchExpressions:\n              - key: app\n                operator: In\n                values:\n                - busybox\n            topologyKey: kubernetes.io/hostname\n",
    "errors": []
  },
  {
    "id": "02100",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: hawtio-online\n  labels:\n    app: hawtio\n    deployment: hawtio-online\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: hawtio\n      deployment: hawtio-online\n  template:\n    metadata:\n      labels:\n        app: hawtio\n        deployment: hawtio-online\n    spec:\n      containers:\n      - image: hawtio/online:stable\n        imagePullPolicy: Always\n        name: hawtio-online\n        ports:\n        - name: nginx\n          containerPort: 8443\n        livenessProbe:\n          httpGet:\n            path: /online\n            port: nginx\n            scheme: HTTPS\n          periodSeconds: 10\n          timeoutSeconds: 1\n        readinessProbe:\n          httpGet:\n            path: /online\n            port: nginx\n            scheme: HTTPS\n          initialDelaySeconds: 5\n          periodSeconds: 5\n          timeoutSeconds: 1\n        env:\n        - name: HAWTIO_ONLINE_RBAC_ACL\n          value: /etc/hawtio/rbac/ACL.yaml\n        resources:\n          requests:\n            cpu: '0.2'\n            memory: 32Mi\n          limits:\n            cpu: '1.0'\n            memory: 100Mi\n        volumeMounts:\n        - name: hawtio-online\n          mountPath: /usr/share/nginx/html/online/hawtconfig.json\n          subPath: hawtconfig.json\n        - name: hawtio-integration\n          mountPath: /usr/share/nginx/html/integration/hawtconfig.json\n          subPath: hawtconfig.json\n        - name: hawtio-rbac\n          mountPath: /etc/hawtio/rbac\n        - name: hawtio-online-tls-serving\n          mountPath: /etc/tls/private/serving\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: hawtio-online\n        configMap:\n          name: hawtio-online\n      - name: hawtio-integration\n        configMap:\n          name: hawtio-integration\n      - name: hawtio-rbac\n        configMap:\n          name: hawtio-rbac\n      - name: hawtio-online-tls-serving\n        secret:\n          secretName: hawtio-online-tls-serving\n",
    "errors": []
  },
  {
    "id": "02101",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: hawtio-online\n  labels:\n    app: hawtio\n    deployment: hawtio-online\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: hawtio\n      deployment: hawtio-online\n  template:\n    metadata:\n      labels:\n        app: hawtio\n        deployment: hawtio-online\n    spec:\n      containers:\n      - image: hawtio/online:stable\n        imagePullPolicy: Always\n        name: hawtio-online\n        ports:\n        - name: nginx\n          containerPort: 8443\n        livenessProbe:\n          httpGet:\n            path: /online\n            port: nginx\n            scheme: HTTPS\n          periodSeconds: 10\n          timeoutSeconds: 1\n        readinessProbe:\n          httpGet:\n            path: /online\n            port: nginx\n            scheme: HTTPS\n          initialDelaySeconds: 5\n          periodSeconds: 5\n          timeoutSeconds: 1\n        env:\n        - name: HAWTIO_ONLINE_RBAC_ACL\n          value: /etc/hawtio/rbac/ACL.yaml\n        resources:\n          requests:\n            cpu: '0.2'\n            memory: 32Mi\n          limits:\n            cpu: '1.0'\n            memory: 100Mi\n        volumeMounts:\n        - name: hawtio-online\n          mountPath: /usr/share/nginx/html/online/hawtconfig.json\n          subPath: hawtconfig.json\n        - name: hawtio-integration\n          mountPath: /usr/share/nginx/html/integration/hawtconfig.json\n          subPath: hawtconfig.json\n        - name: hawtio-rbac\n          mountPath: /etc/hawtio/rbac\n        - name: hawtio-online-tls-serving\n          mountPath: /etc/tls/private/serving\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: hawtio-online\n        configMap:\n          name: hawtio-online\n      - name: hawtio-integration\n        configMap:\n          name: hawtio-integration\n      - name: hawtio-rbac\n        configMap:\n          name: hawtio-rbac\n      - name: hawtio-online-tls-serving\n        secret:\n          secretName: hawtio-online-tls-serving\n",
    "errors": []
  },
  {
    "id": "02102",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: hawtio-online\n  labels:\n    app: hawtio\n    deployment: hawtio-online\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: hawtio\n      deployment: hawtio-online\n  template:\n    metadata:\n      labels:\n        app: hawtio\n        deployment: hawtio-online\n    spec:\n      containers:\n      - image: hawtio/online:stable\n        imagePullPolicy: Always\n        name: hawtio-online\n        ports:\n        - name: nginx\n          containerPort: 8443\n        livenessProbe:\n          httpGet:\n            path: /online\n            port: nginx\n            scheme: HTTPS\n          periodSeconds: 10\n          timeoutSeconds: 1\n        readinessProbe:\n          httpGet:\n            path: /online\n            port: nginx\n            scheme: HTTPS\n          initialDelaySeconds: 5\n          periodSeconds: 5\n          timeoutSeconds: 1\n        env:\n        - name: HAWTIO_ONLINE_RBAC_ACL\n          value: /etc/hawtio/rbac/ACL.yaml\n        resources:\n          requests:\n            cpu: '0.2'\n            memory: 32Mi\n          limits:\n            cpu: '1.0'\n            memory: 100Mi\n        volumeMounts:\n        - name: hawtio-online\n          mountPath: /usr/share/nginx/html/online/hawtconfig.json\n          subPath: hawtconfig.json\n        - name: hawtio-integration\n          mountPath: /usr/share/nginx/html/integration/hawtconfig.json\n          subPath: hawtconfig.json\n        - name: hawtio-rbac\n          mountPath: /etc/hawtio/rbac\n        - name: hawtio-online-tls-serving\n          mountPath: /etc/tls/private/serving\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: hawtio-online\n        configMap:\n          name: hawtio-online\n      - name: hawtio-integration\n        configMap:\n          name: hawtio-integration\n      - name: hawtio-rbac\n        configMap:\n          name: hawtio-rbac\n      - name: hawtio-online-tls-serving\n        secret:\n          secretName: hawtio-online-tls-serving\n",
    "errors": []
  },
  {
    "id": "02103",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: hsds\n  name: hsds\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: hsds\n  template:\n    metadata:\n      labels:\n        app: hsds\n    spec:\n      containers:\n      - name: head\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 512M\n          limits:\n            memory: 512M\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 5100\n        env:\n        - name: NODE_TYPE\n          value: head_node\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: sn\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 1G\n          limits:\n            memory: 1G\n        volumeMounts:\n        - name: accounts\n          mountPath: /config/passwd.txt\n          subPath: passwd.txt\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 5101\n        env:\n        - name: NODE_TYPE\n          value: sn\n        - name: PASSWORD_FILE\n          value: /config/passwd.txt\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn1\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6101\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6101'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn2\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6102\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6102'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn3\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6103\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6103'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn4\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6104\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6104'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: rangeget\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6900\n        env:\n        - name: NODE_TYPE\n          value: rangeget\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: accounts\n        secret:\n          secretName: user-password\n      - name: config\n        configMap:\n          name: hsds-config\n",
    "errors": []
  },
  {
    "id": "02104",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: hsds\n  name: hsds\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: hsds\n  template:\n    metadata:\n      labels:\n        app: hsds\n    spec:\n      containers:\n      - name: head\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 512M\n          limits:\n            memory: 512M\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 5100\n        env:\n        - name: NODE_TYPE\n          value: head_node\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: sn\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 1G\n          limits:\n            memory: 1G\n        volumeMounts:\n        - name: accounts\n          mountPath: /config/passwd.txt\n          subPath: passwd.txt\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 5101\n        env:\n        - name: NODE_TYPE\n          value: sn\n        - name: PASSWORD_FILE\n          value: /config/passwd.txt\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn1\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6101\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6101'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn2\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6102\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6102'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn3\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6103\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6103'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn4\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6104\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6104'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: rangeget\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6900\n        env:\n        - name: NODE_TYPE\n          value: rangeget\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: accounts\n        secret:\n          secretName: user-password\n      - name: config\n        configMap:\n          name: hsds-config\n",
    "errors": []
  },
  {
    "id": "02105",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: hsds\n  name: hsds\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: hsds\n  template:\n    metadata:\n      labels:\n        app: hsds\n    spec:\n      containers:\n      - name: head\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 512M\n          limits:\n            memory: 512M\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 5100\n        env:\n        - name: NODE_TYPE\n          value: head_node\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: sn\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 1G\n          limits:\n            memory: 1G\n        volumeMounts:\n        - name: accounts\n          mountPath: /config/passwd.txt\n          subPath: passwd.txt\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 5101\n        env:\n        - name: NODE_TYPE\n          value: sn\n        - name: PASSWORD_FILE\n          value: /config/passwd.txt\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn1\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6101\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6101'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn2\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6102\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6102'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn3\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6103\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6103'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn4\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6104\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6104'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: rangeget\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6900\n        env:\n        - name: NODE_TYPE\n          value: rangeget\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: accounts\n        secret:\n          secretName: user-password\n      - name: config\n        configMap:\n          name: hsds-config\n",
    "errors": []
  },
  {
    "id": "02106",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: hsds\n  name: hsds\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: hsds\n  template:\n    metadata:\n      labels:\n        app: hsds\n    spec:\n      containers:\n      - name: head\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 512M\n          limits:\n            memory: 512M\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 5100\n        env:\n        - name: NODE_TYPE\n          value: head_node\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: sn\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 1G\n          limits:\n            memory: 1G\n        volumeMounts:\n        - name: accounts\n          mountPath: /config/passwd.txt\n          subPath: passwd.txt\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 5101\n        env:\n        - name: NODE_TYPE\n          value: sn\n        - name: PASSWORD_FILE\n          value: /config/passwd.txt\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn1\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6101\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6101'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn2\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6102\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6102'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn3\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6103\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6103'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn4\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6104\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6104'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: rangeget\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6900\n        env:\n        - name: NODE_TYPE\n          value: rangeget\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: accounts\n        secret:\n          secretName: user-password\n      - name: config\n        configMap:\n          name: hsds-config\n",
    "errors": []
  },
  {
    "id": "02107",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: hsds\n  name: hsds\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: hsds\n  template:\n    metadata:\n      labels:\n        app: hsds\n    spec:\n      containers:\n      - name: head\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 512M\n          limits:\n            memory: 512M\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 5100\n        env:\n        - name: NODE_TYPE\n          value: head_node\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: sn\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 1G\n          limits:\n            memory: 1G\n        volumeMounts:\n        - name: accounts\n          mountPath: /config/passwd.txt\n          subPath: passwd.txt\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 5101\n        env:\n        - name: NODE_TYPE\n          value: sn\n        - name: PASSWORD_FILE\n          value: /config/passwd.txt\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn1\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6101\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6101'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn2\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6102\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6102'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn3\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6103\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6103'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn4\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6104\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6104'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: rangeget\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6900\n        env:\n        - name: NODE_TYPE\n          value: rangeget\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: accounts\n        secret:\n          secretName: user-password\n      - name: config\n        configMap:\n          name: hsds-config\n",
    "errors": []
  },
  {
    "id": "02108",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: hsds\n  name: hsds\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: hsds\n  template:\n    metadata:\n      labels:\n        app: hsds\n    spec:\n      containers:\n      - name: head\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 512M\n          limits:\n            memory: 512M\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 5100\n        env:\n        - name: NODE_TYPE\n          value: head_node\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: sn\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 1G\n          limits:\n            memory: 1G\n        volumeMounts:\n        - name: accounts\n          mountPath: /config/passwd.txt\n          subPath: passwd.txt\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 5101\n        env:\n        - name: NODE_TYPE\n          value: sn\n        - name: PASSWORD_FILE\n          value: /config/passwd.txt\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn1\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6101\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6101'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn2\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6102\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6102'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn3\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6103\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6103'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn4\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6104\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6104'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: rangeget\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6900\n        env:\n        - name: NODE_TYPE\n          value: rangeget\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: accounts\n        secret:\n          secretName: user-password\n      - name: config\n        configMap:\n          name: hsds-config\n",
    "errors": []
  },
  {
    "id": "02109",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: hsds\n  name: hsds\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: hsds\n  template:\n    metadata:\n      labels:\n        app: hsds\n    spec:\n      containers:\n      - name: head\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 512M\n          limits:\n            memory: 512M\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 5100\n        env:\n        - name: NODE_TYPE\n          value: head_node\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: sn\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 1G\n          limits:\n            memory: 1G\n        volumeMounts:\n        - name: accounts\n          mountPath: /config/passwd.txt\n          subPath: passwd.txt\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 5101\n        env:\n        - name: NODE_TYPE\n          value: sn\n        - name: PASSWORD_FILE\n          value: /config/passwd.txt\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn1\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6101\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6101'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn2\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6102\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6102'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn3\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6103\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6103'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn4\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6104\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6104'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: rangeget\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6900\n        env:\n        - name: NODE_TYPE\n          value: rangeget\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: accounts\n        secret:\n          secretName: user-password\n      - name: config\n        configMap:\n          name: hsds-config\n",
    "errors": []
  },
  {
    "id": "02110",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: hsds\n  name: hsds\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: hsds\n  template:\n    metadata:\n      labels:\n        app: hsds\n    spec:\n      containers:\n      - name: head\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 512M\n          limits:\n            memory: 512M\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 5100\n        env:\n        - name: NODE_TYPE\n          value: head_node\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: sn\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 1G\n          limits:\n            memory: 1G\n        volumeMounts:\n        - name: accounts\n          mountPath: /config/passwd.txt\n          subPath: passwd.txt\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 5101\n        env:\n        - name: NODE_TYPE\n          value: sn\n        - name: PASSWORD_FILE\n          value: /config/passwd.txt\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn1\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6101\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6101'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn2\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6102\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6102'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn3\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6103\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6103'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn4\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6104\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6104'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: rangeget\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6900\n        env:\n        - name: NODE_TYPE\n          value: rangeget\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: accounts\n        secret:\n          secretName: user-password\n      - name: config\n        configMap:\n          name: hsds-config\n",
    "errors": []
  },
  {
    "id": "02111",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: hsds\n  name: hsds\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: hsds\n  template:\n    metadata:\n      labels:\n        app: hsds\n    spec:\n      containers:\n      - name: head\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 512M\n          limits:\n            memory: 512M\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 5100\n        env:\n        - name: NODE_TYPE\n          value: head_node\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: sn\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 1G\n          limits:\n            memory: 1G\n        volumeMounts:\n        - name: accounts\n          mountPath: /config/passwd.txt\n          subPath: passwd.txt\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 5101\n        env:\n        - name: NODE_TYPE\n          value: sn\n        - name: PASSWORD_FILE\n          value: /config/passwd.txt\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn1\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6101\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6101'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn2\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6102\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6102'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn3\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6103\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6103'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn4\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6104\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6104'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: rangeget\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6900\n        env:\n        - name: NODE_TYPE\n          value: rangeget\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: accounts\n        secret:\n          secretName: user-password\n      - name: config\n        configMap:\n          name: hsds-config\n",
    "errors": []
  },
  {
    "id": "02112",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: hsds\n  name: hsds\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: hsds\n  template:\n    metadata:\n      labels:\n        app: hsds\n    spec:\n      containers:\n      - name: head\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 512M\n          limits:\n            memory: 512M\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 5100\n        env:\n        - name: NODE_TYPE\n          value: head_node\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: sn\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 1G\n          limits:\n            memory: 1G\n        volumeMounts:\n        - name: accounts\n          mountPath: /config/passwd.txt\n          subPath: passwd.txt\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 5101\n        env:\n        - name: NODE_TYPE\n          value: sn\n        - name: PASSWORD_FILE\n          value: /config/passwd.txt\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn1\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6101\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6101'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn2\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6102\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6102'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn3\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6103\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6103'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn4\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6104\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6104'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: rangeget\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6900\n        env:\n        - name: NODE_TYPE\n          value: rangeget\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: accounts\n        secret:\n          secretName: user-password\n      - name: config\n        configMap:\n          name: hsds-config\n",
    "errors": []
  },
  {
    "id": "02113",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: hsds\n  name: hsds\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: hsds\n  template:\n    metadata:\n      labels:\n        app: hsds\n    spec:\n      containers:\n      - name: head\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 512M\n          limits:\n            memory: 512M\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 5100\n        env:\n        - name: NODE_TYPE\n          value: head_node\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: sn\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 1G\n          limits:\n            memory: 1G\n        volumeMounts:\n        - name: accounts\n          mountPath: /config/passwd.txt\n          subPath: passwd.txt\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 5101\n        env:\n        - name: NODE_TYPE\n          value: sn\n        - name: PASSWORD_FILE\n          value: /config/passwd.txt\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn1\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6101\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6101'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn2\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6102\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6102'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn3\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6103\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6103'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn4\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6104\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6104'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: rangeget\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6900\n        env:\n        - name: NODE_TYPE\n          value: rangeget\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: accounts\n        secret:\n          secretName: user-password\n      - name: config\n        configMap:\n          name: hsds-config\n",
    "errors": []
  },
  {
    "id": "02114",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: hsds\n  name: hsds\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: hsds\n  template:\n    metadata:\n      labels:\n        app: hsds\n    spec:\n      containers:\n      - name: head\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 512M\n          limits:\n            memory: 512M\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 5100\n        env:\n        - name: NODE_TYPE\n          value: head_node\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: sn\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 1G\n          limits:\n            memory: 1G\n        volumeMounts:\n        - name: accounts\n          mountPath: /config/passwd.txt\n          subPath: passwd.txt\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 5101\n        env:\n        - name: NODE_TYPE\n          value: sn\n        - name: PASSWORD_FILE\n          value: /config/passwd.txt\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn1\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6101\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6101'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn2\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6102\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6102'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn3\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6103\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6103'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn4\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6104\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6104'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: rangeget\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6900\n        env:\n        - name: NODE_TYPE\n          value: rangeget\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: accounts\n        secret:\n          secretName: user-password\n      - name: config\n        configMap:\n          name: hsds-config\n",
    "errors": []
  },
  {
    "id": "02115",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: hsds\n  name: hsds\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: hsds\n  template:\n    metadata:\n      labels:\n        app: hsds\n    spec:\n      containers:\n      - name: head\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 512M\n          limits:\n            memory: 512M\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 5100\n        env:\n        - name: NODE_TYPE\n          value: head_node\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: sn\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 1G\n          limits:\n            memory: 1G\n        volumeMounts:\n        - name: accounts\n          mountPath: /config/passwd.txt\n          subPath: passwd.txt\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 5101\n        env:\n        - name: NODE_TYPE\n          value: sn\n        - name: PASSWORD_FILE\n          value: /config/passwd.txt\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn1\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6101\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6101'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn2\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6102\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6102'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn3\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6103\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6103'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn4\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6104\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6104'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: rangeget\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6900\n        env:\n        - name: NODE_TYPE\n          value: rangeget\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: accounts\n        secret:\n          secretName: user-password\n      - name: config\n        configMap:\n          name: hsds-config\n",
    "errors": []
  },
  {
    "id": "02116",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: hsds\n  name: hsds\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: hsds\n  template:\n    metadata:\n      labels:\n        app: hsds\n    spec:\n      containers:\n      - name: head\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 512M\n          limits:\n            memory: 512M\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 5100\n        env:\n        - name: NODE_TYPE\n          value: head_node\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: sn\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 1G\n          limits:\n            memory: 1G\n        volumeMounts:\n        - name: accounts\n          mountPath: /config/passwd.txt\n          subPath: passwd.txt\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 5101\n        env:\n        - name: NODE_TYPE\n          value: sn\n        - name: PASSWORD_FILE\n          value: /config/passwd.txt\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn1\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6101\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6101'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn2\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6102\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6102'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn3\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6103\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6103'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn4\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6104\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6104'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: rangeget\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n          limits:\n            memory: 2G\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6900\n        env:\n        - name: NODE_TYPE\n          value: rangeget\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: accounts\n        secret:\n          secretName: user-password\n      - name: config\n        configMap:\n          name: hsds-config\n",
    "errors": []
  },
  {
    "id": "02117",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: hsds\n  name: hsds\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: hsds\n  template:\n    metadata:\n      labels:\n        app: hsds\n    spec:\n      containers:\n      - name: head\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 512M\n            cpu: 100m\n          limits:\n            memory: 512M\n            cpu: 500m\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 5100\n        env:\n        - name: NODE_TYPE\n          value: head_node\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: sn\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 1G\n            cpu: 100m\n          limits:\n            memory: 1G\n            cpu: 500m\n        volumeMounts:\n        - name: accounts\n          mountPath: /config/passwd.txt\n          subPath: passwd.txt\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 5101\n        env:\n        - name: NODE_TYPE\n          value: sn\n        - name: PASSWORD_FILE\n          value: /config/passwd.txt\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn1\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n            cpu: 100m\n          limits:\n            memory: 2G\n            cpu: 500m\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6101\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6101'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn2\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n            cpu: 100m\n          limits:\n            memory: 2G\n            cpu: 500m\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6102\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6102'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn3\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n            cpu: 100m\n          limits:\n            memory: 2G\n            cpu: 500m\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6103\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6103'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn4\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n            cpu: 100m\n          limits:\n            memory: 2G\n            cpu: 500m\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6104\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6104'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: rangeget\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n            cpu: 100m\n          limits:\n            memory: 2G\n            cpu: 500m\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6900\n        env:\n        - name: NODE_TYPE\n          value: rangeget\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: accounts\n        secret:\n          secretName: user-password\n      - name: config\n        configMap:\n          name: hsds-config\n",
    "errors": []
  },
  {
    "id": "02118",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: hsds\n  name: hsds\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: hsds\n  template:\n    metadata:\n      labels:\n        app: hsds\n    spec:\n      containers:\n      - name: head\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 512M\n            cpu: 100m\n          limits:\n            memory: 512M\n            cpu: 500m\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 5100\n        env:\n        - name: NODE_TYPE\n          value: head_node\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: sn\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 1G\n            cpu: 100m\n          limits:\n            memory: 1G\n            cpu: 500m\n        volumeMounts:\n        - name: accounts\n          mountPath: /config/passwd.txt\n          subPath: passwd.txt\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 5101\n        env:\n        - name: NODE_TYPE\n          value: sn\n        - name: PASSWORD_FILE\n          value: /config/passwd.txt\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn1\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n            cpu: 100m\n          limits:\n            memory: 2G\n            cpu: 500m\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6101\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6101'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn2\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n            cpu: 100m\n          limits:\n            memory: 2G\n            cpu: 500m\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6102\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6102'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn3\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n            cpu: 100m\n          limits:\n            memory: 2G\n            cpu: 500m\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6103\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6103'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn4\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n            cpu: 100m\n          limits:\n            memory: 2G\n            cpu: 500m\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6104\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6104'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: rangeget\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n            cpu: 100m\n          limits:\n            memory: 2G\n            cpu: 500m\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6900\n        env:\n        - name: NODE_TYPE\n          value: rangeget\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: accounts\n        secret:\n          secretName: user-password\n      - name: config\n        configMap:\n          name: hsds-config\n",
    "errors": []
  },
  {
    "id": "02119",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: hsds\n  name: hsds\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: hsds\n  template:\n    metadata:\n      labels:\n        app: hsds\n    spec:\n      containers:\n      - name: head\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 512M\n            cpu: 100m\n          limits:\n            memory: 512M\n            cpu: 500m\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 5100\n        env:\n        - name: NODE_TYPE\n          value: head_node\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: sn\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 1G\n            cpu: 100m\n          limits:\n            memory: 1G\n            cpu: 500m\n        volumeMounts:\n        - name: accounts\n          mountPath: /config/passwd.txt\n          subPath: passwd.txt\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 5101\n        env:\n        - name: NODE_TYPE\n          value: sn\n        - name: PASSWORD_FILE\n          value: /config/passwd.txt\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn1\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n            cpu: 100m\n          limits:\n            memory: 2G\n            cpu: 500m\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6101\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6101'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn2\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n            cpu: 100m\n          limits:\n            memory: 2G\n            cpu: 500m\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6102\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6102'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn3\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n            cpu: 100m\n          limits:\n            memory: 2G\n            cpu: 500m\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6103\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6103'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn4\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n            cpu: 100m\n          limits:\n            memory: 2G\n            cpu: 500m\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6104\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6104'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: rangeget\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n            cpu: 100m\n          limits:\n            memory: 2G\n            cpu: 500m\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6900\n        env:\n        - name: NODE_TYPE\n          value: rangeget\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: accounts\n        secret:\n          secretName: user-password\n      - name: config\n        configMap:\n          name: hsds-config\n",
    "errors": []
  },
  {
    "id": "02120",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: hsds\n  name: hsds\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: hsds\n  template:\n    metadata:\n      labels:\n        app: hsds\n    spec:\n      containers:\n      - name: head\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 512M\n            cpu: 100m\n          limits:\n            memory: 512M\n            cpu: 500m\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 5100\n        env:\n        - name: NODE_TYPE\n          value: head_node\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: sn\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 1G\n            cpu: 100m\n          limits:\n            memory: 1G\n            cpu: 500m\n        volumeMounts:\n        - name: accounts\n          mountPath: /config/passwd.txt\n          subPath: passwd.txt\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 5101\n        env:\n        - name: NODE_TYPE\n          value: sn\n        - name: PASSWORD_FILE\n          value: /config/passwd.txt\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn1\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n            cpu: 100m\n          limits:\n            memory: 2G\n            cpu: 500m\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6101\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6101'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn2\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n            cpu: 100m\n          limits:\n            memory: 2G\n            cpu: 500m\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6102\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6102'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn3\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n            cpu: 100m\n          limits:\n            memory: 2G\n            cpu: 500m\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6103\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6103'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: dn4\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n            cpu: 100m\n          limits:\n            memory: 2G\n            cpu: 500m\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6104\n        env:\n        - name: NODE_TYPE\n          value: dn\n        - name: DN_PORT\n          value: '6104'\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      - name: rangeget\n        image: hdfgroup/hsds:v0.7.0beta6\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 2G\n            cpu: 100m\n          limits:\n            memory: 2G\n            cpu: 500m\n        volumeMounts:\n        - name: config\n          mountPath: /config\n        ports:\n        - containerPort: 6900\n        env:\n        - name: NODE_TYPE\n          value: rangeget\n        - name: AWS_ACCESS_KEY_ID\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_access_key_id\n        - name: AWS_SECRET_ACCESS_KEY\n          valueFrom:\n            secretKeyRef:\n              name: aws-auth-keys\n              key: aws_secret_access_key\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: accounts\n        secret:\n          secretName: user-password\n      - name: config\n        configMap:\n          name: hsds-config\n",
    "errors": []
  }
]