[
  {
    "id": "00921",
    "manifest_path": "data/manifests/the_stack_sample/sample_0222.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: quobyte\nspec:\n  containers:\n  - name: quobyte\n    image: kubernetes/pause\n    volumeMounts:\n    - mountPath: /mnt\n      name: quobytevolume\n  volumes:\n  - name: quobytevolume\n    quobyte:\n      registry: registry:7861\n      volume: testVolume\n      readOnly: false\n      user: root\n      group: root\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"quobyte\" has cpu request 0"
  },
  {
    "id": "00922",
    "manifest_path": "data/manifests/the_stack_sample/sample_0222.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: quobyte\nspec:\n  containers:\n  - name: quobyte\n    image: kubernetes/pause\n    volumeMounts:\n    - mountPath: /mnt\n      name: quobytevolume\n  volumes:\n  - name: quobytevolume\n    quobyte:\n      registry: registry:7861\n      volume: testVolume\n      readOnly: false\n      user: root\n      group: root\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"quobyte\" has memory limit 0"
  },
  {
    "id": "00923",
    "manifest_path": "data/manifests/the_stack_sample/sample_0223.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: cron-unbherbarium-lib-unb-ca\n  namespace: dev\n  labels:\n    app: drupal\n    tier: cron\nspec:\n  jobTemplate:\n    template:\n      spec:\n        containers:\n        - name: cron-unbherbarium-lib-unb-ca\n          command:\n          - /scripts/drupalCronEntry.sh\n          env:\n          - name: DEPLOY_ENV\n            value: dev\n          - name: MYSQL_HOSTNAME\n            value: drupal-mysql-lib-unb-ca\n          - name: MYSQL_PORT\n            value: '3306'\n          image: '||DEPLOYMENTIMAGE||'\n          imagePullPolicy: Always\n          volumeMounts:\n          - mountPath: /app/html/sites/default\n            name: drupal-persistent-storage\n        volumes:\n        - name: drupal-persistent-storage\n          persistentVolumeClaim:\n            claimName: unbherbarium-lib-unb-ca\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"cron-unbherbarium-lib-unb-ca\" is using an invalid container image, \"||DEPLOYMENTIMAGE||\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "00924",
    "manifest_path": "data/manifests/the_stack_sample/sample_0223.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: cron-unbherbarium-lib-unb-ca\n  namespace: dev\n  labels:\n    app: drupal\n    tier: cron\nspec:\n  jobTemplate:\n    template:\n      spec:\n        containers:\n        - name: cron-unbherbarium-lib-unb-ca\n          command:\n          - /scripts/drupalCronEntry.sh\n          env:\n          - name: DEPLOY_ENV\n            value: dev\n          - name: MYSQL_HOSTNAME\n            value: drupal-mysql-lib-unb-ca\n          - name: MYSQL_PORT\n            value: '3306'\n          image: '||DEPLOYMENTIMAGE||'\n          imagePullPolicy: Always\n          volumeMounts:\n          - mountPath: /app/html/sites/default\n            name: drupal-persistent-storage\n        volumes:\n        - name: drupal-persistent-storage\n          persistentVolumeClaim:\n            claimName: unbherbarium-lib-unb-ca\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"cron-unbherbarium-lib-unb-ca\" does not have a read-only root file system"
  },
  {
    "id": "00925",
    "manifest_path": "data/manifests/the_stack_sample/sample_0223.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: cron-unbherbarium-lib-unb-ca\n  namespace: dev\n  labels:\n    app: drupal\n    tier: cron\nspec:\n  jobTemplate:\n    template:\n      spec:\n        containers:\n        - name: cron-unbherbarium-lib-unb-ca\n          command:\n          - /scripts/drupalCronEntry.sh\n          env:\n          - name: DEPLOY_ENV\n            value: dev\n          - name: MYSQL_HOSTNAME\n            value: drupal-mysql-lib-unb-ca\n          - name: MYSQL_PORT\n            value: '3306'\n          image: '||DEPLOYMENTIMAGE||'\n          imagePullPolicy: Always\n          volumeMounts:\n          - mountPath: /app/html/sites/default\n            name: drupal-persistent-storage\n        volumes:\n        - name: drupal-persistent-storage\n          persistentVolumeClaim:\n            claimName: unbherbarium-lib-unb-ca\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"cron-unbherbarium-lib-unb-ca\" is not set to runAsNonRoot"
  },
  {
    "id": "00926",
    "manifest_path": "data/manifests/the_stack_sample/sample_0223.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: cron-unbherbarium-lib-unb-ca\n  namespace: dev\n  labels:\n    app: drupal\n    tier: cron\nspec:\n  jobTemplate:\n    template:\n      spec:\n        containers:\n        - name: cron-unbherbarium-lib-unb-ca\n          command:\n          - /scripts/drupalCronEntry.sh\n          env:\n          - name: DEPLOY_ENV\n            value: dev\n          - name: MYSQL_HOSTNAME\n            value: drupal-mysql-lib-unb-ca\n          - name: MYSQL_PORT\n            value: '3306'\n          image: '||DEPLOYMENTIMAGE||'\n          imagePullPolicy: Always\n          volumeMounts:\n          - mountPath: /app/html/sites/default\n            name: drupal-persistent-storage\n        volumes:\n        - name: drupal-persistent-storage\n          persistentVolumeClaim:\n            claimName: unbherbarium-lib-unb-ca\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"cron-unbherbarium-lib-unb-ca\" has cpu request 0"
  },
  {
    "id": "00927",
    "manifest_path": "data/manifests/the_stack_sample/sample_0223.yaml",
    "manifest_yaml": "apiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: cron-unbherbarium-lib-unb-ca\n  namespace: dev\n  labels:\n    app: drupal\n    tier: cron\nspec:\n  jobTemplate:\n    template:\n      spec:\n        containers:\n        - name: cron-unbherbarium-lib-unb-ca\n          command:\n          - /scripts/drupalCronEntry.sh\n          env:\n          - name: DEPLOY_ENV\n            value: dev\n          - name: MYSQL_HOSTNAME\n            value: drupal-mysql-lib-unb-ca\n          - name: MYSQL_PORT\n            value: '3306'\n          image: '||DEPLOYMENTIMAGE||'\n          imagePullPolicy: Always\n          volumeMounts:\n          - mountPath: /app/html/sites/default\n            name: drupal-persistent-storage\n        volumes:\n        - name: drupal-persistent-storage\n          persistentVolumeClaim:\n            claimName: unbherbarium-lib-unb-ca\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"cron-unbherbarium-lib-unb-ca\" has memory limit 0"
  },
  {
    "id": "00928",
    "manifest_path": "data/manifests/the_stack_sample/sample_0225.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: boskos-reaper\n  labels:\n    app: boskos-reaper\n  namespace: test-pods\nspec:\n  selector:\n    matchLabels:\n      app: boskos-reaper\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: boskos-reaper\n    spec:\n      containers:\n      - name: boskos-reaper\n        image: gcr.io/k8s-prow/boskos/reaper:v20200501-e6124e633\n        args:\n        - --boskos-url=http://boskos.test-pods.svc.cluster.local.\n        - --resource-type=gce-project,gke-project,gpu-project,ingress-project,istio-project,scalability-presubmit-project,scalability-project,aws-account,node-e2e-project\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"boskos-reaper\" does not have a read-only root file system"
  },
  {
    "id": "00929",
    "manifest_path": "data/manifests/the_stack_sample/sample_0225.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: boskos-reaper\n  labels:\n    app: boskos-reaper\n  namespace: test-pods\nspec:\n  selector:\n    matchLabels:\n      app: boskos-reaper\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: boskos-reaper\n    spec:\n      containers:\n      - name: boskos-reaper\n        image: gcr.io/k8s-prow/boskos/reaper:v20200501-e6124e633\n        args:\n        - --boskos-url=http://boskos.test-pods.svc.cluster.local.\n        - --resource-type=gce-project,gke-project,gpu-project,ingress-project,istio-project,scalability-presubmit-project,scalability-project,aws-account,node-e2e-project\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"boskos-reaper\" is not set to runAsNonRoot"
  },
  {
    "id": "00930",
    "manifest_path": "data/manifests/the_stack_sample/sample_0225.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: boskos-reaper\n  labels:\n    app: boskos-reaper\n  namespace: test-pods\nspec:\n  selector:\n    matchLabels:\n      app: boskos-reaper\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: boskos-reaper\n    spec:\n      containers:\n      - name: boskos-reaper\n        image: gcr.io/k8s-prow/boskos/reaper:v20200501-e6124e633\n        args:\n        - --boskos-url=http://boskos.test-pods.svc.cluster.local.\n        - --resource-type=gce-project,gke-project,gpu-project,ingress-project,istio-project,scalability-presubmit-project,scalability-project,aws-account,node-e2e-project\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"boskos-reaper\" has cpu request 0"
  },
  {
    "id": "00931",
    "manifest_path": "data/manifests/the_stack_sample/sample_0225.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: boskos-reaper\n  labels:\n    app: boskos-reaper\n  namespace: test-pods\nspec:\n  selector:\n    matchLabels:\n      app: boskos-reaper\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: boskos-reaper\n    spec:\n      containers:\n      - name: boskos-reaper\n        image: gcr.io/k8s-prow/boskos/reaper:v20200501-e6124e633\n        args:\n        - --boskos-url=http://boskos.test-pods.svc.cluster.local.\n        - --resource-type=gce-project,gke-project,gpu-project,ingress-project,istio-project,scalability-presubmit-project,scalability-project,aws-account,node-e2e-project\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"boskos-reaper\" has memory limit 0"
  },
  {
    "id": "00932",
    "manifest_path": "data/manifests/the_stack_sample/sample_0229.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: monitoring-heapster-v6\n  namespace: kube-system\n  labels:\n    k8s-app: heapster\n    version: v6\n    kubernetes.io/cluster-service: 'true'\nspec:\n  replicas: 1\n  selector:\n    k8s-app: heapster\n    version: v6\n  template:\n    metadata:\n      labels:\n        k8s-app: heapster\n        version: v6\n        kubernetes.io/cluster-service: 'true'\n    spec:\n      containers:\n      - image: gcr.io/google_containers/heapster:v0.16.1\n        name: heapster\n        resources:\n          limits:\n            cpu: 100m\n            memory: 300Mi\n        command:\n        - /heapster\n        - --source=kubernetes:''\n        - --sink=gcl\n        - --sink=influxdb:http://monitoring-influxdb:8086\n        - --poll_duration=2m\n        - --stats_resolution=1m\n        volumeMounts:\n        - name: ssl-certs\n          mountPath: /etc/ssl/certs\n          readOnly: true\n      volumes:\n      - name: ssl-certs\n        hostPath:\n          path: /etc/ssl/certs\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"heapster\" does not have a read-only root file system"
  },
  {
    "id": "00933",
    "manifest_path": "data/manifests/the_stack_sample/sample_0229.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: monitoring-heapster-v6\n  namespace: kube-system\n  labels:\n    k8s-app: heapster\n    version: v6\n    kubernetes.io/cluster-service: 'true'\nspec:\n  replicas: 1\n  selector:\n    k8s-app: heapster\n    version: v6\n  template:\n    metadata:\n      labels:\n        k8s-app: heapster\n        version: v6\n        kubernetes.io/cluster-service: 'true'\n    spec:\n      containers:\n      - image: gcr.io/google_containers/heapster:v0.16.1\n        name: heapster\n        resources:\n          limits:\n            cpu: 100m\n            memory: 300Mi\n        command:\n        - /heapster\n        - --source=kubernetes:''\n        - --sink=gcl\n        - --sink=influxdb:http://monitoring-influxdb:8086\n        - --poll_duration=2m\n        - --stats_resolution=1m\n        volumeMounts:\n        - name: ssl-certs\n          mountPath: /etc/ssl/certs\n          readOnly: true\n      volumes:\n      - name: ssl-certs\n        hostPath:\n          path: /etc/ssl/certs\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"heapster\" is not set to runAsNonRoot"
  },
  {
    "id": "00934",
    "manifest_path": "data/manifests/the_stack_sample/sample_0229.yaml",
    "manifest_yaml": "apiVersion: v1\nkind: ReplicationController\nmetadata:\n  name: monitoring-heapster-v6\n  namespace: kube-system\n  labels:\n    k8s-app: heapster\n    version: v6\n    kubernetes.io/cluster-service: 'true'\nspec:\n  replicas: 1\n  selector:\n    k8s-app: heapster\n    version: v6\n  template:\n    metadata:\n      labels:\n        k8s-app: heapster\n        version: v6\n        kubernetes.io/cluster-service: 'true'\n    spec:\n      containers:\n      - image: gcr.io/google_containers/heapster:v0.16.1\n        name: heapster\n        resources:\n          limits:\n            cpu: 100m\n            memory: 300Mi\n        command:\n        - /heapster\n        - --source=kubernetes:''\n        - --sink=gcl\n        - --sink=influxdb:http://monitoring-influxdb:8086\n        - --poll_duration=2m\n        - --stats_resolution=1m\n        volumeMounts:\n        - name: ssl-certs\n          mountPath: /etc/ssl/certs\n          readOnly: true\n      volumes:\n      - name: ssl-certs\n        hostPath:\n          path: /etc/ssl/certs\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"heapster\" has cpu request 0"
  },
  {
    "id": "00935",
    "manifest_path": "data/manifests/the_stack_sample/sample_0230.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: users-deployment\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      component: users\n  template:\n    metadata:\n      labels:\n        component: users\n    spec:\n      containers:\n      - name: users\n        image: sbalasubramanian14/users-api\n        ports:\n        - containerPort: 5000\n        env:\n        - name: DATABASE_HOST\n          value: mysql-cluster-ip-service\n        - name: DATABASE_NAME\n          value: mydatabase\n        - name: DATABASE_USERNAME\n          value: root\n        - name: DATABASE_PASSWORD\n          value: admin@123\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"users\" is using an invalid container image, \"sbalasubramanian14/users-api\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "00936",
    "manifest_path": "data/manifests/the_stack_sample/sample_0230.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: users-deployment\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      component: users\n  template:\n    metadata:\n      labels:\n        component: users\n    spec:\n      containers:\n      - name: users\n        image: sbalasubramanian14/users-api\n        ports:\n        - containerPort: 5000\n        env:\n        - name: DATABASE_HOST\n          value: mysql-cluster-ip-service\n        - name: DATABASE_NAME\n          value: mydatabase\n        - name: DATABASE_USERNAME\n          value: root\n        - name: DATABASE_PASSWORD\n          value: admin@123\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"users\" does not have a read-only root file system"
  },
  {
    "id": "00937",
    "manifest_path": "data/manifests/the_stack_sample/sample_0230.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: users-deployment\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      component: users\n  template:\n    metadata:\n      labels:\n        component: users\n    spec:\n      containers:\n      - name: users\n        image: sbalasubramanian14/users-api\n        ports:\n        - containerPort: 5000\n        env:\n        - name: DATABASE_HOST\n          value: mysql-cluster-ip-service\n        - name: DATABASE_NAME\n          value: mydatabase\n        - name: DATABASE_USERNAME\n          value: root\n        - name: DATABASE_PASSWORD\n          value: admin@123\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"users\" is not set to runAsNonRoot"
  },
  {
    "id": "00938",
    "manifest_path": "data/manifests/the_stack_sample/sample_0230.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: users-deployment\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      component: users\n  template:\n    metadata:\n      labels:\n        component: users\n    spec:\n      containers:\n      - name: users\n        image: sbalasubramanian14/users-api\n        ports:\n        - containerPort: 5000\n        env:\n        - name: DATABASE_HOST\n          value: mysql-cluster-ip-service\n        - name: DATABASE_NAME\n          value: mydatabase\n        - name: DATABASE_USERNAME\n          value: root\n        - name: DATABASE_PASSWORD\n          value: admin@123\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"users\" has cpu request 0"
  },
  {
    "id": "00939",
    "manifest_path": "data/manifests/the_stack_sample/sample_0230.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: users-deployment\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      component: users\n  template:\n    metadata:\n      labels:\n        component: users\n    spec:\n      containers:\n      - name: users\n        image: sbalasubramanian14/users-api\n        ports:\n        - containerPort: 5000\n        env:\n        - name: DATABASE_HOST\n          value: mysql-cluster-ip-service\n        - name: DATABASE_NAME\n          value: mydatabase\n        - name: DATABASE_USERNAME\n          value: root\n        - name: DATABASE_PASSWORD\n          value: admin@123\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"users\" has memory limit 0"
  },
  {
    "id": "00940",
    "manifest_path": "data/manifests/the_stack_sample/sample_0233.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: cilium\n  namespace: kube-system\nspec:\n  selector:\n    matchLabels:\n      k8s-app: cilium\n      kubernetes.io/cluster-service: 'true'\n  template:\n    metadata:\n      labels:\n        k8s-app: cilium\n        kubernetes.io/cluster-service: 'true'\n      annotations:\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n        scheduler.alpha.kubernetes.io/tolerations: '[{\"key\":\"dedicated\",\"operator\":\"Equal\",\"value\":\"master\",\"effect\":\"NoSchedule\"}]'\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9090'\n    spec:\n      serviceAccountName: cilium\n      initContainers:\n      - name: clean-cilium-state\n        image: docker.io/library/busybox:1.28.4\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - if [ \"${CLEAN_CILIUM_STATE}\" = \"true\" ]; then rm -rf /var/run/cilium/state;\n          rm -rf /sys/fs/bpf/tc/globals/cilium_*; fi\n        securityContext:\n          capabilities:\n            add:\n            - NET_ADMIN\n          privileged: true\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        env:\n        - name: CLEAN_CILIUM_STATE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: clean-cilium-state\n      containers:\n      - image: docker.io/cilium/cilium:latest\n        imagePullPolicy: Always\n        name: cilium-agent\n        command:\n        - cilium-agent\n        args:\n        - --debug=$(CILIUM_DEBUG)\n        - --kvstore=etcd\n        - --kvstore-opt=etcd.config=/var/lib/etcd-config/etcd.config\n        - --disable-ipv4=$(DISABLE_IPV4)\n        ports:\n        - name: prometheus\n          containerPort: 9090\n        env:\n        - name: K8S_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CILIUM_DEBUG\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: debug\n        - name: DISABLE_IPV4\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: disable-ipv4\n        - name: CILIUM_PROMETHEUS_SERVE_ADDR\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-metrics-config\n              optional: true\n              key: prometheus-serve-addr\n        - name: CILIUM_LEGACY_HOST_ALLOWS_WORLD\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: legacy-host-allows-world\n        - name: CILIUM_SIDECAR_ISTIO_PROXY_IMAGE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: sidecar-istio-proxy-image\n              optional: true\n        - name: CILIUM_TUNNEL\n          valueFrom:\n            configMapKeyRef:\n              key: tunnel\n              name: cilium-config\n              optional: true\n        - name: CILIUM_MONITOR_AGGREGATION_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              key: monitor-aggregation-level\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTERMESH_CONFIG\n          value: /var/lib/cilium/clustermesh/\n        - name: CILIUM_CLUSTER_NAME\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-name\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTER_ID\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-id\n              name: cilium-config\n              optional: true\n        livenessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 120\n          failureThreshold: 10\n          periodSeconds: 10\n        readinessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 5\n          periodSeconds: 5\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        - name: cni-path\n          mountPath: /host/opt/cni/bin\n        - name: etc-cni-netd\n          mountPath: /host/etc/cni/net.d\n        - name: docker-socket\n          mountPath: /var/run/docker.sock\n          readOnly: true\n        - name: etcd-config-path\n          mountPath: /var/lib/etcd-config\n          readOnly: true\n        - name: etcd-secrets\n          mountPath: /var/lib/etcd-secrets\n          readOnly: true\n        - name: clustermesh-secrets\n          mountPath: /var/lib/cilium/clustermesh\n          readOnly: true\n        securityContext:\n          capabilities:\n            add:\n            - NET_ADMIN\n          privileged: true\n      volumes:\n      - name: cilium-run\n        hostPath:\n          path: /var/run/cilium\n          type: DirectoryOrCreate\n      - name: bpf-maps\n        hostPath:\n          path: /sys/fs/bpf\n          type: DirectoryOrCreate\n      - name: docker-socket\n        hostPath:\n          path: /var/run/docker.sock\n          type: Socket\n      - name: cni-path\n        hostPath:\n          path: /opt/cni/bin\n          type: DirectoryOrCreate\n      - name: etc-cni-netd\n        hostPath:\n          path: /etc/cni/net.d\n          type: DirectoryOrCreate\n      - name: etcd-config-path\n        configMap:\n          name: cilium-config\n          items:\n          - key: etcd-config\n            path: etcd.config\n      - name: etcd-secrets\n        secret:\n          secretName: cilium-etcd-secrets\n          optional: true\n      - name: clustermesh-secrets\n        secret:\n          defaultMode: 420\n          optional: true\n          secretName: cilium-clustermesh\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"cilium-agent\" is using an invalid container image, \"docker.io/cilium/cilium:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "00941",
    "manifest_path": "data/manifests/the_stack_sample/sample_0233.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: cilium\n  namespace: kube-system\nspec:\n  selector:\n    matchLabels:\n      k8s-app: cilium\n      kubernetes.io/cluster-service: 'true'\n  template:\n    metadata:\n      labels:\n        k8s-app: cilium\n        kubernetes.io/cluster-service: 'true'\n      annotations:\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n        scheduler.alpha.kubernetes.io/tolerations: '[{\"key\":\"dedicated\",\"operator\":\"Equal\",\"value\":\"master\",\"effect\":\"NoSchedule\"}]'\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9090'\n    spec:\n      serviceAccountName: cilium\n      initContainers:\n      - name: clean-cilium-state\n        image: docker.io/library/busybox:1.28.4\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - if [ \"${CLEAN_CILIUM_STATE}\" = \"true\" ]; then rm -rf /var/run/cilium/state;\n          rm -rf /sys/fs/bpf/tc/globals/cilium_*; fi\n        securityContext:\n          capabilities:\n            add:\n            - NET_ADMIN\n          privileged: true\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        env:\n        - name: CLEAN_CILIUM_STATE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: clean-cilium-state\n      containers:\n      - image: docker.io/cilium/cilium:latest\n        imagePullPolicy: Always\n        name: cilium-agent\n        command:\n        - cilium-agent\n        args:\n        - --debug=$(CILIUM_DEBUG)\n        - --kvstore=etcd\n        - --kvstore-opt=etcd.config=/var/lib/etcd-config/etcd.config\n        - --disable-ipv4=$(DISABLE_IPV4)\n        ports:\n        - name: prometheus\n          containerPort: 9090\n        env:\n        - name: K8S_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CILIUM_DEBUG\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: debug\n        - name: DISABLE_IPV4\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: disable-ipv4\n        - name: CILIUM_PROMETHEUS_SERVE_ADDR\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-metrics-config\n              optional: true\n              key: prometheus-serve-addr\n        - name: CILIUM_LEGACY_HOST_ALLOWS_WORLD\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: legacy-host-allows-world\n        - name: CILIUM_SIDECAR_ISTIO_PROXY_IMAGE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: sidecar-istio-proxy-image\n              optional: true\n        - name: CILIUM_TUNNEL\n          valueFrom:\n            configMapKeyRef:\n              key: tunnel\n              name: cilium-config\n              optional: true\n        - name: CILIUM_MONITOR_AGGREGATION_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              key: monitor-aggregation-level\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTERMESH_CONFIG\n          value: /var/lib/cilium/clustermesh/\n        - name: CILIUM_CLUSTER_NAME\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-name\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTER_ID\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-id\n              name: cilium-config\n              optional: true\n        livenessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 120\n          failureThreshold: 10\n          periodSeconds: 10\n        readinessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 5\n          periodSeconds: 5\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        - name: cni-path\n          mountPath: /host/opt/cni/bin\n        - name: etc-cni-netd\n          mountPath: /host/etc/cni/net.d\n        - name: docker-socket\n          mountPath: /var/run/docker.sock\n          readOnly: true\n        - name: etcd-config-path\n          mountPath: /var/lib/etcd-config\n          readOnly: true\n        - name: etcd-secrets\n          mountPath: /var/lib/etcd-secrets\n          readOnly: true\n        - name: clustermesh-secrets\n          mountPath: /var/lib/cilium/clustermesh\n          readOnly: true\n        securityContext:\n          capabilities:\n            add:\n            - NET_ADMIN\n          privileged: true\n      volumes:\n      - name: cilium-run\n        hostPath:\n          path: /var/run/cilium\n          type: DirectoryOrCreate\n      - name: bpf-maps\n        hostPath:\n          path: /sys/fs/bpf\n          type: DirectoryOrCreate\n      - name: docker-socket\n        hostPath:\n          path: /var/run/docker.sock\n          type: Socket\n      - name: cni-path\n        hostPath:\n          path: /opt/cni/bin\n          type: DirectoryOrCreate\n      - name: etc-cni-netd\n        hostPath:\n          path: /etc/cni/net.d\n          type: DirectoryOrCreate\n      - name: etcd-config-path\n        configMap:\n          name: cilium-config\n          items:\n          - key: etcd-config\n            path: etcd.config\n      - name: etcd-secrets\n        secret:\n          secretName: cilium-etcd-secrets\n          optional: true\n      - name: clustermesh-secrets\n        secret:\n          defaultMode: 420\n          optional: true\n          secretName: cilium-clustermesh\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"cilium-agent\" does not have a read-only root file system"
  },
  {
    "id": "00942",
    "manifest_path": "data/manifests/the_stack_sample/sample_0233.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: cilium\n  namespace: kube-system\nspec:\n  selector:\n    matchLabels:\n      k8s-app: cilium\n      kubernetes.io/cluster-service: 'true'\n  template:\n    metadata:\n      labels:\n        k8s-app: cilium\n        kubernetes.io/cluster-service: 'true'\n      annotations:\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n        scheduler.alpha.kubernetes.io/tolerations: '[{\"key\":\"dedicated\",\"operator\":\"Equal\",\"value\":\"master\",\"effect\":\"NoSchedule\"}]'\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9090'\n    spec:\n      serviceAccountName: cilium\n      initContainers:\n      - name: clean-cilium-state\n        image: docker.io/library/busybox:1.28.4\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - if [ \"${CLEAN_CILIUM_STATE}\" = \"true\" ]; then rm -rf /var/run/cilium/state;\n          rm -rf /sys/fs/bpf/tc/globals/cilium_*; fi\n        securityContext:\n          capabilities:\n            add:\n            - NET_ADMIN\n          privileged: true\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        env:\n        - name: CLEAN_CILIUM_STATE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: clean-cilium-state\n      containers:\n      - image: docker.io/cilium/cilium:latest\n        imagePullPolicy: Always\n        name: cilium-agent\n        command:\n        - cilium-agent\n        args:\n        - --debug=$(CILIUM_DEBUG)\n        - --kvstore=etcd\n        - --kvstore-opt=etcd.config=/var/lib/etcd-config/etcd.config\n        - --disable-ipv4=$(DISABLE_IPV4)\n        ports:\n        - name: prometheus\n          containerPort: 9090\n        env:\n        - name: K8S_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CILIUM_DEBUG\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: debug\n        - name: DISABLE_IPV4\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: disable-ipv4\n        - name: CILIUM_PROMETHEUS_SERVE_ADDR\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-metrics-config\n              optional: true\n              key: prometheus-serve-addr\n        - name: CILIUM_LEGACY_HOST_ALLOWS_WORLD\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: legacy-host-allows-world\n        - name: CILIUM_SIDECAR_ISTIO_PROXY_IMAGE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: sidecar-istio-proxy-image\n              optional: true\n        - name: CILIUM_TUNNEL\n          valueFrom:\n            configMapKeyRef:\n              key: tunnel\n              name: cilium-config\n              optional: true\n        - name: CILIUM_MONITOR_AGGREGATION_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              key: monitor-aggregation-level\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTERMESH_CONFIG\n          value: /var/lib/cilium/clustermesh/\n        - name: CILIUM_CLUSTER_NAME\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-name\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTER_ID\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-id\n              name: cilium-config\n              optional: true\n        livenessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 120\n          failureThreshold: 10\n          periodSeconds: 10\n        readinessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 5\n          periodSeconds: 5\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        - name: cni-path\n          mountPath: /host/opt/cni/bin\n        - name: etc-cni-netd\n          mountPath: /host/etc/cni/net.d\n        - name: docker-socket\n          mountPath: /var/run/docker.sock\n          readOnly: true\n        - name: etcd-config-path\n          mountPath: /var/lib/etcd-config\n          readOnly: true\n        - name: etcd-secrets\n          mountPath: /var/lib/etcd-secrets\n          readOnly: true\n        - name: clustermesh-secrets\n          mountPath: /var/lib/cilium/clustermesh\n          readOnly: true\n        securityContext:\n          capabilities:\n            add:\n            - NET_ADMIN\n          privileged: true\n      volumes:\n      - name: cilium-run\n        hostPath:\n          path: /var/run/cilium\n          type: DirectoryOrCreate\n      - name: bpf-maps\n        hostPath:\n          path: /sys/fs/bpf\n          type: DirectoryOrCreate\n      - name: docker-socket\n        hostPath:\n          path: /var/run/docker.sock\n          type: Socket\n      - name: cni-path\n        hostPath:\n          path: /opt/cni/bin\n          type: DirectoryOrCreate\n      - name: etc-cni-netd\n        hostPath:\n          path: /etc/cni/net.d\n          type: DirectoryOrCreate\n      - name: etcd-config-path\n        configMap:\n          name: cilium-config\n          items:\n          - key: etcd-config\n            path: etcd.config\n      - name: etcd-secrets\n        secret:\n          secretName: cilium-etcd-secrets\n          optional: true\n      - name: clustermesh-secrets\n        secret:\n          defaultMode: 420\n          optional: true\n          secretName: cilium-clustermesh\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"clean-cilium-state\" does not have a read-only root file system"
  },
  {
    "id": "00943",
    "manifest_path": "data/manifests/the_stack_sample/sample_0233.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: cilium\n  namespace: kube-system\nspec:\n  selector:\n    matchLabels:\n      k8s-app: cilium\n      kubernetes.io/cluster-service: 'true'\n  template:\n    metadata:\n      labels:\n        k8s-app: cilium\n        kubernetes.io/cluster-service: 'true'\n      annotations:\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n        scheduler.alpha.kubernetes.io/tolerations: '[{\"key\":\"dedicated\",\"operator\":\"Equal\",\"value\":\"master\",\"effect\":\"NoSchedule\"}]'\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9090'\n    spec:\n      serviceAccountName: cilium\n      initContainers:\n      - name: clean-cilium-state\n        image: docker.io/library/busybox:1.28.4\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - if [ \"${CLEAN_CILIUM_STATE}\" = \"true\" ]; then rm -rf /var/run/cilium/state;\n          rm -rf /sys/fs/bpf/tc/globals/cilium_*; fi\n        securityContext:\n          capabilities:\n            add:\n            - NET_ADMIN\n          privileged: true\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        env:\n        - name: CLEAN_CILIUM_STATE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: clean-cilium-state\n      containers:\n      - image: docker.io/cilium/cilium:latest\n        imagePullPolicy: Always\n        name: cilium-agent\n        command:\n        - cilium-agent\n        args:\n        - --debug=$(CILIUM_DEBUG)\n        - --kvstore=etcd\n        - --kvstore-opt=etcd.config=/var/lib/etcd-config/etcd.config\n        - --disable-ipv4=$(DISABLE_IPV4)\n        ports:\n        - name: prometheus\n          containerPort: 9090\n        env:\n        - name: K8S_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CILIUM_DEBUG\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: debug\n        - name: DISABLE_IPV4\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: disable-ipv4\n        - name: CILIUM_PROMETHEUS_SERVE_ADDR\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-metrics-config\n              optional: true\n              key: prometheus-serve-addr\n        - name: CILIUM_LEGACY_HOST_ALLOWS_WORLD\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: legacy-host-allows-world\n        - name: CILIUM_SIDECAR_ISTIO_PROXY_IMAGE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: sidecar-istio-proxy-image\n              optional: true\n        - name: CILIUM_TUNNEL\n          valueFrom:\n            configMapKeyRef:\n              key: tunnel\n              name: cilium-config\n              optional: true\n        - name: CILIUM_MONITOR_AGGREGATION_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              key: monitor-aggregation-level\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTERMESH_CONFIG\n          value: /var/lib/cilium/clustermesh/\n        - name: CILIUM_CLUSTER_NAME\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-name\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTER_ID\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-id\n              name: cilium-config\n              optional: true\n        livenessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 120\n          failureThreshold: 10\n          periodSeconds: 10\n        readinessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 5\n          periodSeconds: 5\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        - name: cni-path\n          mountPath: /host/opt/cni/bin\n        - name: etc-cni-netd\n          mountPath: /host/etc/cni/net.d\n        - name: docker-socket\n          mountPath: /var/run/docker.sock\n          readOnly: true\n        - name: etcd-config-path\n          mountPath: /var/lib/etcd-config\n          readOnly: true\n        - name: etcd-secrets\n          mountPath: /var/lib/etcd-secrets\n          readOnly: true\n        - name: clustermesh-secrets\n          mountPath: /var/lib/cilium/clustermesh\n          readOnly: true\n        securityContext:\n          capabilities:\n            add:\n            - NET_ADMIN\n          privileged: true\n      volumes:\n      - name: cilium-run\n        hostPath:\n          path: /var/run/cilium\n          type: DirectoryOrCreate\n      - name: bpf-maps\n        hostPath:\n          path: /sys/fs/bpf\n          type: DirectoryOrCreate\n      - name: docker-socket\n        hostPath:\n          path: /var/run/docker.sock\n          type: Socket\n      - name: cni-path\n        hostPath:\n          path: /opt/cni/bin\n          type: DirectoryOrCreate\n      - name: etc-cni-netd\n        hostPath:\n          path: /etc/cni/net.d\n          type: DirectoryOrCreate\n      - name: etcd-config-path\n        configMap:\n          name: cilium-config\n          items:\n          - key: etcd-config\n            path: etcd.config\n      - name: etcd-secrets\n        secret:\n          secretName: cilium-etcd-secrets\n          optional: true\n      - name: clustermesh-secrets\n        secret:\n          defaultMode: 420\n          optional: true\n          secretName: cilium-clustermesh\n",
    "policy_id": "privilege-escalation-container",
    "violation_text": "container \"cilium-agent\" is Privileged hence allows privilege escalation."
  },
  {
    "id": "00944",
    "manifest_path": "data/manifests/the_stack_sample/sample_0233.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: cilium\n  namespace: kube-system\nspec:\n  selector:\n    matchLabels:\n      k8s-app: cilium\n      kubernetes.io/cluster-service: 'true'\n  template:\n    metadata:\n      labels:\n        k8s-app: cilium\n        kubernetes.io/cluster-service: 'true'\n      annotations:\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n        scheduler.alpha.kubernetes.io/tolerations: '[{\"key\":\"dedicated\",\"operator\":\"Equal\",\"value\":\"master\",\"effect\":\"NoSchedule\"}]'\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9090'\n    spec:\n      serviceAccountName: cilium\n      initContainers:\n      - name: clean-cilium-state\n        image: docker.io/library/busybox:1.28.4\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - if [ \"${CLEAN_CILIUM_STATE}\" = \"true\" ]; then rm -rf /var/run/cilium/state;\n          rm -rf /sys/fs/bpf/tc/globals/cilium_*; fi\n        securityContext:\n          capabilities:\n            add:\n            - NET_ADMIN\n          privileged: true\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        env:\n        - name: CLEAN_CILIUM_STATE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: clean-cilium-state\n      containers:\n      - image: docker.io/cilium/cilium:latest\n        imagePullPolicy: Always\n        name: cilium-agent\n        command:\n        - cilium-agent\n        args:\n        - --debug=$(CILIUM_DEBUG)\n        - --kvstore=etcd\n        - --kvstore-opt=etcd.config=/var/lib/etcd-config/etcd.config\n        - --disable-ipv4=$(DISABLE_IPV4)\n        ports:\n        - name: prometheus\n          containerPort: 9090\n        env:\n        - name: K8S_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CILIUM_DEBUG\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: debug\n        - name: DISABLE_IPV4\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: disable-ipv4\n        - name: CILIUM_PROMETHEUS_SERVE_ADDR\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-metrics-config\n              optional: true\n              key: prometheus-serve-addr\n        - name: CILIUM_LEGACY_HOST_ALLOWS_WORLD\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: legacy-host-allows-world\n        - name: CILIUM_SIDECAR_ISTIO_PROXY_IMAGE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: sidecar-istio-proxy-image\n              optional: true\n        - name: CILIUM_TUNNEL\n          valueFrom:\n            configMapKeyRef:\n              key: tunnel\n              name: cilium-config\n              optional: true\n        - name: CILIUM_MONITOR_AGGREGATION_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              key: monitor-aggregation-level\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTERMESH_CONFIG\n          value: /var/lib/cilium/clustermesh/\n        - name: CILIUM_CLUSTER_NAME\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-name\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTER_ID\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-id\n              name: cilium-config\n              optional: true\n        livenessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 120\n          failureThreshold: 10\n          periodSeconds: 10\n        readinessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 5\n          periodSeconds: 5\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        - name: cni-path\n          mountPath: /host/opt/cni/bin\n        - name: etc-cni-netd\n          mountPath: /host/etc/cni/net.d\n        - name: docker-socket\n          mountPath: /var/run/docker.sock\n          readOnly: true\n        - name: etcd-config-path\n          mountPath: /var/lib/etcd-config\n          readOnly: true\n        - name: etcd-secrets\n          mountPath: /var/lib/etcd-secrets\n          readOnly: true\n        - name: clustermesh-secrets\n          mountPath: /var/lib/cilium/clustermesh\n          readOnly: true\n        securityContext:\n          capabilities:\n            add:\n            - NET_ADMIN\n          privileged: true\n      volumes:\n      - name: cilium-run\n        hostPath:\n          path: /var/run/cilium\n          type: DirectoryOrCreate\n      - name: bpf-maps\n        hostPath:\n          path: /sys/fs/bpf\n          type: DirectoryOrCreate\n      - name: docker-socket\n        hostPath:\n          path: /var/run/docker.sock\n          type: Socket\n      - name: cni-path\n        hostPath:\n          path: /opt/cni/bin\n          type: DirectoryOrCreate\n      - name: etc-cni-netd\n        hostPath:\n          path: /etc/cni/net.d\n          type: DirectoryOrCreate\n      - name: etcd-config-path\n        configMap:\n          name: cilium-config\n          items:\n          - key: etcd-config\n            path: etcd.config\n      - name: etcd-secrets\n        secret:\n          secretName: cilium-etcd-secrets\n          optional: true\n      - name: clustermesh-secrets\n        secret:\n          defaultMode: 420\n          optional: true\n          secretName: cilium-clustermesh\n",
    "policy_id": "privilege-escalation-container",
    "violation_text": "container \"clean-cilium-state\" is Privileged hence allows privilege escalation."
  },
  {
    "id": "00945",
    "manifest_path": "data/manifests/the_stack_sample/sample_0233.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: cilium\n  namespace: kube-system\nspec:\n  selector:\n    matchLabels:\n      k8s-app: cilium\n      kubernetes.io/cluster-service: 'true'\n  template:\n    metadata:\n      labels:\n        k8s-app: cilium\n        kubernetes.io/cluster-service: 'true'\n      annotations:\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n        scheduler.alpha.kubernetes.io/tolerations: '[{\"key\":\"dedicated\",\"operator\":\"Equal\",\"value\":\"master\",\"effect\":\"NoSchedule\"}]'\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9090'\n    spec:\n      serviceAccountName: cilium\n      initContainers:\n      - name: clean-cilium-state\n        image: docker.io/library/busybox:1.28.4\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - if [ \"${CLEAN_CILIUM_STATE}\" = \"true\" ]; then rm -rf /var/run/cilium/state;\n          rm -rf /sys/fs/bpf/tc/globals/cilium_*; fi\n        securityContext:\n          capabilities:\n            add:\n            - NET_ADMIN\n          privileged: true\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        env:\n        - name: CLEAN_CILIUM_STATE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: clean-cilium-state\n      containers:\n      - image: docker.io/cilium/cilium:latest\n        imagePullPolicy: Always\n        name: cilium-agent\n        command:\n        - cilium-agent\n        args:\n        - --debug=$(CILIUM_DEBUG)\n        - --kvstore=etcd\n        - --kvstore-opt=etcd.config=/var/lib/etcd-config/etcd.config\n        - --disable-ipv4=$(DISABLE_IPV4)\n        ports:\n        - name: prometheus\n          containerPort: 9090\n        env:\n        - name: K8S_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CILIUM_DEBUG\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: debug\n        - name: DISABLE_IPV4\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: disable-ipv4\n        - name: CILIUM_PROMETHEUS_SERVE_ADDR\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-metrics-config\n              optional: true\n              key: prometheus-serve-addr\n        - name: CILIUM_LEGACY_HOST_ALLOWS_WORLD\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: legacy-host-allows-world\n        - name: CILIUM_SIDECAR_ISTIO_PROXY_IMAGE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: sidecar-istio-proxy-image\n              optional: true\n        - name: CILIUM_TUNNEL\n          valueFrom:\n            configMapKeyRef:\n              key: tunnel\n              name: cilium-config\n              optional: true\n        - name: CILIUM_MONITOR_AGGREGATION_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              key: monitor-aggregation-level\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTERMESH_CONFIG\n          value: /var/lib/cilium/clustermesh/\n        - name: CILIUM_CLUSTER_NAME\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-name\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTER_ID\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-id\n              name: cilium-config\n              optional: true\n        livenessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 120\n          failureThreshold: 10\n          periodSeconds: 10\n        readinessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 5\n          periodSeconds: 5\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        - name: cni-path\n          mountPath: /host/opt/cni/bin\n        - name: etc-cni-netd\n          mountPath: /host/etc/cni/net.d\n        - name: docker-socket\n          mountPath: /var/run/docker.sock\n          readOnly: true\n        - name: etcd-config-path\n          mountPath: /var/lib/etcd-config\n          readOnly: true\n        - name: etcd-secrets\n          mountPath: /var/lib/etcd-secrets\n          readOnly: true\n        - name: clustermesh-secrets\n          mountPath: /var/lib/cilium/clustermesh\n          readOnly: true\n        securityContext:\n          capabilities:\n            add:\n            - NET_ADMIN\n          privileged: true\n      volumes:\n      - name: cilium-run\n        hostPath:\n          path: /var/run/cilium\n          type: DirectoryOrCreate\n      - name: bpf-maps\n        hostPath:\n          path: /sys/fs/bpf\n          type: DirectoryOrCreate\n      - name: docker-socket\n        hostPath:\n          path: /var/run/docker.sock\n          type: Socket\n      - name: cni-path\n        hostPath:\n          path: /opt/cni/bin\n          type: DirectoryOrCreate\n      - name: etc-cni-netd\n        hostPath:\n          path: /etc/cni/net.d\n          type: DirectoryOrCreate\n      - name: etcd-config-path\n        configMap:\n          name: cilium-config\n          items:\n          - key: etcd-config\n            path: etcd.config\n      - name: etcd-secrets\n        secret:\n          secretName: cilium-etcd-secrets\n          optional: true\n      - name: clustermesh-secrets\n        secret:\n          defaultMode: 420\n          optional: true\n          secretName: cilium-clustermesh\n",
    "policy_id": "privileged-container",
    "violation_text": "container \"cilium-agent\" is privileged"
  },
  {
    "id": "00946",
    "manifest_path": "data/manifests/the_stack_sample/sample_0233.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: cilium\n  namespace: kube-system\nspec:\n  selector:\n    matchLabels:\n      k8s-app: cilium\n      kubernetes.io/cluster-service: 'true'\n  template:\n    metadata:\n      labels:\n        k8s-app: cilium\n        kubernetes.io/cluster-service: 'true'\n      annotations:\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n        scheduler.alpha.kubernetes.io/tolerations: '[{\"key\":\"dedicated\",\"operator\":\"Equal\",\"value\":\"master\",\"effect\":\"NoSchedule\"}]'\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9090'\n    spec:\n      serviceAccountName: cilium\n      initContainers:\n      - name: clean-cilium-state\n        image: docker.io/library/busybox:1.28.4\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - if [ \"${CLEAN_CILIUM_STATE}\" = \"true\" ]; then rm -rf /var/run/cilium/state;\n          rm -rf /sys/fs/bpf/tc/globals/cilium_*; fi\n        securityContext:\n          capabilities:\n            add:\n            - NET_ADMIN\n          privileged: true\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        env:\n        - name: CLEAN_CILIUM_STATE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: clean-cilium-state\n      containers:\n      - image: docker.io/cilium/cilium:latest\n        imagePullPolicy: Always\n        name: cilium-agent\n        command:\n        - cilium-agent\n        args:\n        - --debug=$(CILIUM_DEBUG)\n        - --kvstore=etcd\n        - --kvstore-opt=etcd.config=/var/lib/etcd-config/etcd.config\n        - --disable-ipv4=$(DISABLE_IPV4)\n        ports:\n        - name: prometheus\n          containerPort: 9090\n        env:\n        - name: K8S_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CILIUM_DEBUG\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: debug\n        - name: DISABLE_IPV4\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: disable-ipv4\n        - name: CILIUM_PROMETHEUS_SERVE_ADDR\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-metrics-config\n              optional: true\n              key: prometheus-serve-addr\n        - name: CILIUM_LEGACY_HOST_ALLOWS_WORLD\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: legacy-host-allows-world\n        - name: CILIUM_SIDECAR_ISTIO_PROXY_IMAGE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: sidecar-istio-proxy-image\n              optional: true\n        - name: CILIUM_TUNNEL\n          valueFrom:\n            configMapKeyRef:\n              key: tunnel\n              name: cilium-config\n              optional: true\n        - name: CILIUM_MONITOR_AGGREGATION_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              key: monitor-aggregation-level\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTERMESH_CONFIG\n          value: /var/lib/cilium/clustermesh/\n        - name: CILIUM_CLUSTER_NAME\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-name\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTER_ID\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-id\n              name: cilium-config\n              optional: true\n        livenessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 120\n          failureThreshold: 10\n          periodSeconds: 10\n        readinessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 5\n          periodSeconds: 5\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        - name: cni-path\n          mountPath: /host/opt/cni/bin\n        - name: etc-cni-netd\n          mountPath: /host/etc/cni/net.d\n        - name: docker-socket\n          mountPath: /var/run/docker.sock\n          readOnly: true\n        - name: etcd-config-path\n          mountPath: /var/lib/etcd-config\n          readOnly: true\n        - name: etcd-secrets\n          mountPath: /var/lib/etcd-secrets\n          readOnly: true\n        - name: clustermesh-secrets\n          mountPath: /var/lib/cilium/clustermesh\n          readOnly: true\n        securityContext:\n          capabilities:\n            add:\n            - NET_ADMIN\n          privileged: true\n      volumes:\n      - name: cilium-run\n        hostPath:\n          path: /var/run/cilium\n          type: DirectoryOrCreate\n      - name: bpf-maps\n        hostPath:\n          path: /sys/fs/bpf\n          type: DirectoryOrCreate\n      - name: docker-socket\n        hostPath:\n          path: /var/run/docker.sock\n          type: Socket\n      - name: cni-path\n        hostPath:\n          path: /opt/cni/bin\n          type: DirectoryOrCreate\n      - name: etc-cni-netd\n        hostPath:\n          path: /etc/cni/net.d\n          type: DirectoryOrCreate\n      - name: etcd-config-path\n        configMap:\n          name: cilium-config\n          items:\n          - key: etcd-config\n            path: etcd.config\n      - name: etcd-secrets\n        secret:\n          secretName: cilium-etcd-secrets\n          optional: true\n      - name: clustermesh-secrets\n        secret:\n          defaultMode: 420\n          optional: true\n          secretName: cilium-clustermesh\n",
    "policy_id": "privileged-container",
    "violation_text": "container \"clean-cilium-state\" is privileged"
  },
  {
    "id": "00947",
    "manifest_path": "data/manifests/the_stack_sample/sample_0233.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: cilium\n  namespace: kube-system\nspec:\n  selector:\n    matchLabels:\n      k8s-app: cilium\n      kubernetes.io/cluster-service: 'true'\n  template:\n    metadata:\n      labels:\n        k8s-app: cilium\n        kubernetes.io/cluster-service: 'true'\n      annotations:\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n        scheduler.alpha.kubernetes.io/tolerations: '[{\"key\":\"dedicated\",\"operator\":\"Equal\",\"value\":\"master\",\"effect\":\"NoSchedule\"}]'\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9090'\n    spec:\n      serviceAccountName: cilium\n      initContainers:\n      - name: clean-cilium-state\n        image: docker.io/library/busybox:1.28.4\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - if [ \"${CLEAN_CILIUM_STATE}\" = \"true\" ]; then rm -rf /var/run/cilium/state;\n          rm -rf /sys/fs/bpf/tc/globals/cilium_*; fi\n        securityContext:\n          capabilities:\n            add:\n            - NET_ADMIN\n          privileged: true\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        env:\n        - name: CLEAN_CILIUM_STATE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: clean-cilium-state\n      containers:\n      - image: docker.io/cilium/cilium:latest\n        imagePullPolicy: Always\n        name: cilium-agent\n        command:\n        - cilium-agent\n        args:\n        - --debug=$(CILIUM_DEBUG)\n        - --kvstore=etcd\n        - --kvstore-opt=etcd.config=/var/lib/etcd-config/etcd.config\n        - --disable-ipv4=$(DISABLE_IPV4)\n        ports:\n        - name: prometheus\n          containerPort: 9090\n        env:\n        - name: K8S_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CILIUM_DEBUG\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: debug\n        - name: DISABLE_IPV4\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: disable-ipv4\n        - name: CILIUM_PROMETHEUS_SERVE_ADDR\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-metrics-config\n              optional: true\n              key: prometheus-serve-addr\n        - name: CILIUM_LEGACY_HOST_ALLOWS_WORLD\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: legacy-host-allows-world\n        - name: CILIUM_SIDECAR_ISTIO_PROXY_IMAGE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: sidecar-istio-proxy-image\n              optional: true\n        - name: CILIUM_TUNNEL\n          valueFrom:\n            configMapKeyRef:\n              key: tunnel\n              name: cilium-config\n              optional: true\n        - name: CILIUM_MONITOR_AGGREGATION_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              key: monitor-aggregation-level\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTERMESH_CONFIG\n          value: /var/lib/cilium/clustermesh/\n        - name: CILIUM_CLUSTER_NAME\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-name\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTER_ID\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-id\n              name: cilium-config\n              optional: true\n        livenessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 120\n          failureThreshold: 10\n          periodSeconds: 10\n        readinessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 5\n          periodSeconds: 5\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        - name: cni-path\n          mountPath: /host/opt/cni/bin\n        - name: etc-cni-netd\n          mountPath: /host/etc/cni/net.d\n        - name: docker-socket\n          mountPath: /var/run/docker.sock\n          readOnly: true\n        - name: etcd-config-path\n          mountPath: /var/lib/etcd-config\n          readOnly: true\n        - name: etcd-secrets\n          mountPath: /var/lib/etcd-secrets\n          readOnly: true\n        - name: clustermesh-secrets\n          mountPath: /var/lib/cilium/clustermesh\n          readOnly: true\n        securityContext:\n          capabilities:\n            add:\n            - NET_ADMIN\n          privileged: true\n      volumes:\n      - name: cilium-run\n        hostPath:\n          path: /var/run/cilium\n          type: DirectoryOrCreate\n      - name: bpf-maps\n        hostPath:\n          path: /sys/fs/bpf\n          type: DirectoryOrCreate\n      - name: docker-socket\n        hostPath:\n          path: /var/run/docker.sock\n          type: Socket\n      - name: cni-path\n        hostPath:\n          path: /opt/cni/bin\n          type: DirectoryOrCreate\n      - name: etc-cni-netd\n        hostPath:\n          path: /etc/cni/net.d\n          type: DirectoryOrCreate\n      - name: etcd-config-path\n        configMap:\n          name: cilium-config\n          items:\n          - key: etcd-config\n            path: etcd.config\n      - name: etcd-secrets\n        secret:\n          secretName: cilium-etcd-secrets\n          optional: true\n      - name: clustermesh-secrets\n        secret:\n          defaultMode: 420\n          optional: true\n          secretName: cilium-clustermesh\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"cilium-agent\" is not set to runAsNonRoot"
  },
  {
    "id": "00948",
    "manifest_path": "data/manifests/the_stack_sample/sample_0233.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: cilium\n  namespace: kube-system\nspec:\n  selector:\n    matchLabels:\n      k8s-app: cilium\n      kubernetes.io/cluster-service: 'true'\n  template:\n    metadata:\n      labels:\n        k8s-app: cilium\n        kubernetes.io/cluster-service: 'true'\n      annotations:\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n        scheduler.alpha.kubernetes.io/tolerations: '[{\"key\":\"dedicated\",\"operator\":\"Equal\",\"value\":\"master\",\"effect\":\"NoSchedule\"}]'\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9090'\n    spec:\n      serviceAccountName: cilium\n      initContainers:\n      - name: clean-cilium-state\n        image: docker.io/library/busybox:1.28.4\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - if [ \"${CLEAN_CILIUM_STATE}\" = \"true\" ]; then rm -rf /var/run/cilium/state;\n          rm -rf /sys/fs/bpf/tc/globals/cilium_*; fi\n        securityContext:\n          capabilities:\n            add:\n            - NET_ADMIN\n          privileged: true\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        env:\n        - name: CLEAN_CILIUM_STATE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: clean-cilium-state\n      containers:\n      - image: docker.io/cilium/cilium:latest\n        imagePullPolicy: Always\n        name: cilium-agent\n        command:\n        - cilium-agent\n        args:\n        - --debug=$(CILIUM_DEBUG)\n        - --kvstore=etcd\n        - --kvstore-opt=etcd.config=/var/lib/etcd-config/etcd.config\n        - --disable-ipv4=$(DISABLE_IPV4)\n        ports:\n        - name: prometheus\n          containerPort: 9090\n        env:\n        - name: K8S_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CILIUM_DEBUG\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: debug\n        - name: DISABLE_IPV4\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: disable-ipv4\n        - name: CILIUM_PROMETHEUS_SERVE_ADDR\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-metrics-config\n              optional: true\n              key: prometheus-serve-addr\n        - name: CILIUM_LEGACY_HOST_ALLOWS_WORLD\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: legacy-host-allows-world\n        - name: CILIUM_SIDECAR_ISTIO_PROXY_IMAGE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: sidecar-istio-proxy-image\n              optional: true\n        - name: CILIUM_TUNNEL\n          valueFrom:\n            configMapKeyRef:\n              key: tunnel\n              name: cilium-config\n              optional: true\n        - name: CILIUM_MONITOR_AGGREGATION_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              key: monitor-aggregation-level\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTERMESH_CONFIG\n          value: /var/lib/cilium/clustermesh/\n        - name: CILIUM_CLUSTER_NAME\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-name\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTER_ID\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-id\n              name: cilium-config\n              optional: true\n        livenessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 120\n          failureThreshold: 10\n          periodSeconds: 10\n        readinessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 5\n          periodSeconds: 5\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        - name: cni-path\n          mountPath: /host/opt/cni/bin\n        - name: etc-cni-netd\n          mountPath: /host/etc/cni/net.d\n        - name: docker-socket\n          mountPath: /var/run/docker.sock\n          readOnly: true\n        - name: etcd-config-path\n          mountPath: /var/lib/etcd-config\n          readOnly: true\n        - name: etcd-secrets\n          mountPath: /var/lib/etcd-secrets\n          readOnly: true\n        - name: clustermesh-secrets\n          mountPath: /var/lib/cilium/clustermesh\n          readOnly: true\n        securityContext:\n          capabilities:\n            add:\n            - NET_ADMIN\n          privileged: true\n      volumes:\n      - name: cilium-run\n        hostPath:\n          path: /var/run/cilium\n          type: DirectoryOrCreate\n      - name: bpf-maps\n        hostPath:\n          path: /sys/fs/bpf\n          type: DirectoryOrCreate\n      - name: docker-socket\n        hostPath:\n          path: /var/run/docker.sock\n          type: Socket\n      - name: cni-path\n        hostPath:\n          path: /opt/cni/bin\n          type: DirectoryOrCreate\n      - name: etc-cni-netd\n        hostPath:\n          path: /etc/cni/net.d\n          type: DirectoryOrCreate\n      - name: etcd-config-path\n        configMap:\n          name: cilium-config\n          items:\n          - key: etcd-config\n            path: etcd.config\n      - name: etcd-secrets\n        secret:\n          secretName: cilium-etcd-secrets\n          optional: true\n      - name: clustermesh-secrets\n        secret:\n          defaultMode: 420\n          optional: true\n          secretName: cilium-clustermesh\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"clean-cilium-state\" is not set to runAsNonRoot"
  },
  {
    "id": "00949",
    "manifest_path": "data/manifests/the_stack_sample/sample_0233.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: cilium\n  namespace: kube-system\nspec:\n  selector:\n    matchLabels:\n      k8s-app: cilium\n      kubernetes.io/cluster-service: 'true'\n  template:\n    metadata:\n      labels:\n        k8s-app: cilium\n        kubernetes.io/cluster-service: 'true'\n      annotations:\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n        scheduler.alpha.kubernetes.io/tolerations: '[{\"key\":\"dedicated\",\"operator\":\"Equal\",\"value\":\"master\",\"effect\":\"NoSchedule\"}]'\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9090'\n    spec:\n      serviceAccountName: cilium\n      initContainers:\n      - name: clean-cilium-state\n        image: docker.io/library/busybox:1.28.4\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - if [ \"${CLEAN_CILIUM_STATE}\" = \"true\" ]; then rm -rf /var/run/cilium/state;\n          rm -rf /sys/fs/bpf/tc/globals/cilium_*; fi\n        securityContext:\n          capabilities:\n            add:\n            - NET_ADMIN\n          privileged: true\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        env:\n        - name: CLEAN_CILIUM_STATE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: clean-cilium-state\n      containers:\n      - image: docker.io/cilium/cilium:latest\n        imagePullPolicy: Always\n        name: cilium-agent\n        command:\n        - cilium-agent\n        args:\n        - --debug=$(CILIUM_DEBUG)\n        - --kvstore=etcd\n        - --kvstore-opt=etcd.config=/var/lib/etcd-config/etcd.config\n        - --disable-ipv4=$(DISABLE_IPV4)\n        ports:\n        - name: prometheus\n          containerPort: 9090\n        env:\n        - name: K8S_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CILIUM_DEBUG\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: debug\n        - name: DISABLE_IPV4\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: disable-ipv4\n        - name: CILIUM_PROMETHEUS_SERVE_ADDR\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-metrics-config\n              optional: true\n              key: prometheus-serve-addr\n        - name: CILIUM_LEGACY_HOST_ALLOWS_WORLD\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: legacy-host-allows-world\n        - name: CILIUM_SIDECAR_ISTIO_PROXY_IMAGE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: sidecar-istio-proxy-image\n              optional: true\n        - name: CILIUM_TUNNEL\n          valueFrom:\n            configMapKeyRef:\n              key: tunnel\n              name: cilium-config\n              optional: true\n        - name: CILIUM_MONITOR_AGGREGATION_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              key: monitor-aggregation-level\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTERMESH_CONFIG\n          value: /var/lib/cilium/clustermesh/\n        - name: CILIUM_CLUSTER_NAME\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-name\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTER_ID\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-id\n              name: cilium-config\n              optional: true\n        livenessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 120\n          failureThreshold: 10\n          periodSeconds: 10\n        readinessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 5\n          periodSeconds: 5\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        - name: cni-path\n          mountPath: /host/opt/cni/bin\n        - name: etc-cni-netd\n          mountPath: /host/etc/cni/net.d\n        - name: docker-socket\n          mountPath: /var/run/docker.sock\n          readOnly: true\n        - name: etcd-config-path\n          mountPath: /var/lib/etcd-config\n          readOnly: true\n        - name: etcd-secrets\n          mountPath: /var/lib/etcd-secrets\n          readOnly: true\n        - name: clustermesh-secrets\n          mountPath: /var/lib/cilium/clustermesh\n          readOnly: true\n        securityContext:\n          capabilities:\n            add:\n            - NET_ADMIN\n          privileged: true\n      volumes:\n      - name: cilium-run\n        hostPath:\n          path: /var/run/cilium\n          type: DirectoryOrCreate\n      - name: bpf-maps\n        hostPath:\n          path: /sys/fs/bpf\n          type: DirectoryOrCreate\n      - name: docker-socket\n        hostPath:\n          path: /var/run/docker.sock\n          type: Socket\n      - name: cni-path\n        hostPath:\n          path: /opt/cni/bin\n          type: DirectoryOrCreate\n      - name: etc-cni-netd\n        hostPath:\n          path: /etc/cni/net.d\n          type: DirectoryOrCreate\n      - name: etcd-config-path\n        configMap:\n          name: cilium-config\n          items:\n          - key: etcd-config\n            path: etcd.config\n      - name: etcd-secrets\n        secret:\n          secretName: cilium-etcd-secrets\n          optional: true\n      - name: clustermesh-secrets\n        secret:\n          defaultMode: 420\n          optional: true\n          secretName: cilium-clustermesh\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"cilium-agent\" has cpu request 0"
  },
  {
    "id": "00950",
    "manifest_path": "data/manifests/the_stack_sample/sample_0233.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: cilium\n  namespace: kube-system\nspec:\n  selector:\n    matchLabels:\n      k8s-app: cilium\n      kubernetes.io/cluster-service: 'true'\n  template:\n    metadata:\n      labels:\n        k8s-app: cilium\n        kubernetes.io/cluster-service: 'true'\n      annotations:\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n        scheduler.alpha.kubernetes.io/tolerations: '[{\"key\":\"dedicated\",\"operator\":\"Equal\",\"value\":\"master\",\"effect\":\"NoSchedule\"}]'\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9090'\n    spec:\n      serviceAccountName: cilium\n      initContainers:\n      - name: clean-cilium-state\n        image: docker.io/library/busybox:1.28.4\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - if [ \"${CLEAN_CILIUM_STATE}\" = \"true\" ]; then rm -rf /var/run/cilium/state;\n          rm -rf /sys/fs/bpf/tc/globals/cilium_*; fi\n        securityContext:\n          capabilities:\n            add:\n            - NET_ADMIN\n          privileged: true\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        env:\n        - name: CLEAN_CILIUM_STATE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: clean-cilium-state\n      containers:\n      - image: docker.io/cilium/cilium:latest\n        imagePullPolicy: Always\n        name: cilium-agent\n        command:\n        - cilium-agent\n        args:\n        - --debug=$(CILIUM_DEBUG)\n        - --kvstore=etcd\n        - --kvstore-opt=etcd.config=/var/lib/etcd-config/etcd.config\n        - --disable-ipv4=$(DISABLE_IPV4)\n        ports:\n        - name: prometheus\n          containerPort: 9090\n        env:\n        - name: K8S_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CILIUM_DEBUG\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: debug\n        - name: DISABLE_IPV4\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: disable-ipv4\n        - name: CILIUM_PROMETHEUS_SERVE_ADDR\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-metrics-config\n              optional: true\n              key: prometheus-serve-addr\n        - name: CILIUM_LEGACY_HOST_ALLOWS_WORLD\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: legacy-host-allows-world\n        - name: CILIUM_SIDECAR_ISTIO_PROXY_IMAGE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: sidecar-istio-proxy-image\n              optional: true\n        - name: CILIUM_TUNNEL\n          valueFrom:\n            configMapKeyRef:\n              key: tunnel\n              name: cilium-config\n              optional: true\n        - name: CILIUM_MONITOR_AGGREGATION_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              key: monitor-aggregation-level\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTERMESH_CONFIG\n          value: /var/lib/cilium/clustermesh/\n        - name: CILIUM_CLUSTER_NAME\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-name\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTER_ID\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-id\n              name: cilium-config\n              optional: true\n        livenessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 120\n          failureThreshold: 10\n          periodSeconds: 10\n        readinessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 5\n          periodSeconds: 5\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        - name: cni-path\n          mountPath: /host/opt/cni/bin\n        - name: etc-cni-netd\n          mountPath: /host/etc/cni/net.d\n        - name: docker-socket\n          mountPath: /var/run/docker.sock\n          readOnly: true\n        - name: etcd-config-path\n          mountPath: /var/lib/etcd-config\n          readOnly: true\n        - name: etcd-secrets\n          mountPath: /var/lib/etcd-secrets\n          readOnly: true\n        - name: clustermesh-secrets\n          mountPath: /var/lib/cilium/clustermesh\n          readOnly: true\n        securityContext:\n          capabilities:\n            add:\n            - NET_ADMIN\n          privileged: true\n      volumes:\n      - name: cilium-run\n        hostPath:\n          path: /var/run/cilium\n          type: DirectoryOrCreate\n      - name: bpf-maps\n        hostPath:\n          path: /sys/fs/bpf\n          type: DirectoryOrCreate\n      - name: docker-socket\n        hostPath:\n          path: /var/run/docker.sock\n          type: Socket\n      - name: cni-path\n        hostPath:\n          path: /opt/cni/bin\n          type: DirectoryOrCreate\n      - name: etc-cni-netd\n        hostPath:\n          path: /etc/cni/net.d\n          type: DirectoryOrCreate\n      - name: etcd-config-path\n        configMap:\n          name: cilium-config\n          items:\n          - key: etcd-config\n            path: etcd.config\n      - name: etcd-secrets\n        secret:\n          secretName: cilium-etcd-secrets\n          optional: true\n      - name: clustermesh-secrets\n        secret:\n          defaultMode: 420\n          optional: true\n          secretName: cilium-clustermesh\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"clean-cilium-state\" has cpu request 0"
  },
  {
    "id": "00951",
    "manifest_path": "data/manifests/the_stack_sample/sample_0233.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: cilium\n  namespace: kube-system\nspec:\n  selector:\n    matchLabels:\n      k8s-app: cilium\n      kubernetes.io/cluster-service: 'true'\n  template:\n    metadata:\n      labels:\n        k8s-app: cilium\n        kubernetes.io/cluster-service: 'true'\n      annotations:\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n        scheduler.alpha.kubernetes.io/tolerations: '[{\"key\":\"dedicated\",\"operator\":\"Equal\",\"value\":\"master\",\"effect\":\"NoSchedule\"}]'\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9090'\n    spec:\n      serviceAccountName: cilium\n      initContainers:\n      - name: clean-cilium-state\n        image: docker.io/library/busybox:1.28.4\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - if [ \"${CLEAN_CILIUM_STATE}\" = \"true\" ]; then rm -rf /var/run/cilium/state;\n          rm -rf /sys/fs/bpf/tc/globals/cilium_*; fi\n        securityContext:\n          capabilities:\n            add:\n            - NET_ADMIN\n          privileged: true\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        env:\n        - name: CLEAN_CILIUM_STATE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: clean-cilium-state\n      containers:\n      - image: docker.io/cilium/cilium:latest\n        imagePullPolicy: Always\n        name: cilium-agent\n        command:\n        - cilium-agent\n        args:\n        - --debug=$(CILIUM_DEBUG)\n        - --kvstore=etcd\n        - --kvstore-opt=etcd.config=/var/lib/etcd-config/etcd.config\n        - --disable-ipv4=$(DISABLE_IPV4)\n        ports:\n        - name: prometheus\n          containerPort: 9090\n        env:\n        - name: K8S_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CILIUM_DEBUG\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: debug\n        - name: DISABLE_IPV4\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: disable-ipv4\n        - name: CILIUM_PROMETHEUS_SERVE_ADDR\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-metrics-config\n              optional: true\n              key: prometheus-serve-addr\n        - name: CILIUM_LEGACY_HOST_ALLOWS_WORLD\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: legacy-host-allows-world\n        - name: CILIUM_SIDECAR_ISTIO_PROXY_IMAGE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: sidecar-istio-proxy-image\n              optional: true\n        - name: CILIUM_TUNNEL\n          valueFrom:\n            configMapKeyRef:\n              key: tunnel\n              name: cilium-config\n              optional: true\n        - name: CILIUM_MONITOR_AGGREGATION_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              key: monitor-aggregation-level\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTERMESH_CONFIG\n          value: /var/lib/cilium/clustermesh/\n        - name: CILIUM_CLUSTER_NAME\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-name\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTER_ID\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-id\n              name: cilium-config\n              optional: true\n        livenessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 120\n          failureThreshold: 10\n          periodSeconds: 10\n        readinessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 5\n          periodSeconds: 5\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        - name: cni-path\n          mountPath: /host/opt/cni/bin\n        - name: etc-cni-netd\n          mountPath: /host/etc/cni/net.d\n        - name: docker-socket\n          mountPath: /var/run/docker.sock\n          readOnly: true\n        - name: etcd-config-path\n          mountPath: /var/lib/etcd-config\n          readOnly: true\n        - name: etcd-secrets\n          mountPath: /var/lib/etcd-secrets\n          readOnly: true\n        - name: clustermesh-secrets\n          mountPath: /var/lib/cilium/clustermesh\n          readOnly: true\n        securityContext:\n          capabilities:\n            add:\n            - NET_ADMIN\n          privileged: true\n      volumes:\n      - name: cilium-run\n        hostPath:\n          path: /var/run/cilium\n          type: DirectoryOrCreate\n      - name: bpf-maps\n        hostPath:\n          path: /sys/fs/bpf\n          type: DirectoryOrCreate\n      - name: docker-socket\n        hostPath:\n          path: /var/run/docker.sock\n          type: Socket\n      - name: cni-path\n        hostPath:\n          path: /opt/cni/bin\n          type: DirectoryOrCreate\n      - name: etc-cni-netd\n        hostPath:\n          path: /etc/cni/net.d\n          type: DirectoryOrCreate\n      - name: etcd-config-path\n        configMap:\n          name: cilium-config\n          items:\n          - key: etcd-config\n            path: etcd.config\n      - name: etcd-secrets\n        secret:\n          secretName: cilium-etcd-secrets\n          optional: true\n      - name: clustermesh-secrets\n        secret:\n          defaultMode: 420\n          optional: true\n          secretName: cilium-clustermesh\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"cilium-agent\" has memory limit 0"
  },
  {
    "id": "00952",
    "manifest_path": "data/manifests/the_stack_sample/sample_0233.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: cilium\n  namespace: kube-system\nspec:\n  selector:\n    matchLabels:\n      k8s-app: cilium\n      kubernetes.io/cluster-service: 'true'\n  template:\n    metadata:\n      labels:\n        k8s-app: cilium\n        kubernetes.io/cluster-service: 'true'\n      annotations:\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n        scheduler.alpha.kubernetes.io/tolerations: '[{\"key\":\"dedicated\",\"operator\":\"Equal\",\"value\":\"master\",\"effect\":\"NoSchedule\"}]'\n        prometheus.io/scrape: 'true'\n        prometheus.io/port: '9090'\n    spec:\n      serviceAccountName: cilium\n      initContainers:\n      - name: clean-cilium-state\n        image: docker.io/library/busybox:1.28.4\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - if [ \"${CLEAN_CILIUM_STATE}\" = \"true\" ]; then rm -rf /var/run/cilium/state;\n          rm -rf /sys/fs/bpf/tc/globals/cilium_*; fi\n        securityContext:\n          capabilities:\n            add:\n            - NET_ADMIN\n          privileged: true\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        env:\n        - name: CLEAN_CILIUM_STATE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: clean-cilium-state\n      containers:\n      - image: docker.io/cilium/cilium:latest\n        imagePullPolicy: Always\n        name: cilium-agent\n        command:\n        - cilium-agent\n        args:\n        - --debug=$(CILIUM_DEBUG)\n        - --kvstore=etcd\n        - --kvstore-opt=etcd.config=/var/lib/etcd-config/etcd.config\n        - --disable-ipv4=$(DISABLE_IPV4)\n        ports:\n        - name: prometheus\n          containerPort: 9090\n        env:\n        - name: K8S_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CILIUM_DEBUG\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: debug\n        - name: DISABLE_IPV4\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: disable-ipv4\n        - name: CILIUM_PROMETHEUS_SERVE_ADDR\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-metrics-config\n              optional: true\n              key: prometheus-serve-addr\n        - name: CILIUM_LEGACY_HOST_ALLOWS_WORLD\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              optional: true\n              key: legacy-host-allows-world\n        - name: CILIUM_SIDECAR_ISTIO_PROXY_IMAGE\n          valueFrom:\n            configMapKeyRef:\n              name: cilium-config\n              key: sidecar-istio-proxy-image\n              optional: true\n        - name: CILIUM_TUNNEL\n          valueFrom:\n            configMapKeyRef:\n              key: tunnel\n              name: cilium-config\n              optional: true\n        - name: CILIUM_MONITOR_AGGREGATION_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              key: monitor-aggregation-level\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTERMESH_CONFIG\n          value: /var/lib/cilium/clustermesh/\n        - name: CILIUM_CLUSTER_NAME\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-name\n              name: cilium-config\n              optional: true\n        - name: CILIUM_CLUSTER_ID\n          valueFrom:\n            configMapKeyRef:\n              key: cluster-id\n              name: cilium-config\n              optional: true\n        livenessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 120\n          failureThreshold: 10\n          periodSeconds: 10\n        readinessProbe:\n          exec:\n            command:\n            - cilium\n            - status\n          initialDelaySeconds: 5\n          periodSeconds: 5\n        volumeMounts:\n        - name: bpf-maps\n          mountPath: /sys/fs/bpf\n        - name: cilium-run\n          mountPath: /var/run/cilium\n        - name: cni-path\n          mountPath: /host/opt/cni/bin\n        - name: etc-cni-netd\n          mountPath: /host/etc/cni/net.d\n        - name: docker-socket\n          mountPath: /var/run/docker.sock\n          readOnly: true\n        - name: etcd-config-path\n          mountPath: /var/lib/etcd-config\n          readOnly: true\n        - name: etcd-secrets\n          mountPath: /var/lib/etcd-secrets\n          readOnly: true\n        - name: clustermesh-secrets\n          mountPath: /var/lib/cilium/clustermesh\n          readOnly: true\n        securityContext:\n          capabilities:\n            add:\n            - NET_ADMIN\n          privileged: true\n      volumes:\n      - name: cilium-run\n        hostPath:\n          path: /var/run/cilium\n          type: DirectoryOrCreate\n      - name: bpf-maps\n        hostPath:\n          path: /sys/fs/bpf\n          type: DirectoryOrCreate\n      - name: docker-socket\n        hostPath:\n          path: /var/run/docker.sock\n          type: Socket\n      - name: cni-path\n        hostPath:\n          path: /opt/cni/bin\n          type: DirectoryOrCreate\n      - name: etc-cni-netd\n        hostPath:\n          path: /etc/cni/net.d\n          type: DirectoryOrCreate\n      - name: etcd-config-path\n        configMap:\n          name: cilium-config\n          items:\n          - key: etcd-config\n            path: etcd.config\n      - name: etcd-secrets\n        secret:\n          secretName: cilium-etcd-secrets\n          optional: true\n      - name: clustermesh-secrets\n        secret:\n          defaultMode: 420\n          optional: true\n          secretName: cilium-clustermesh\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"clean-cilium-state\" has memory limit 0"
  },
  {
    "id": "00953",
    "manifest_path": "data/manifests/the_stack_sample/sample_0234.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: kurl-proxy\n  labels:\n    app: kurl-proxy\nspec:\n  selector:\n    matchLabels:\n      app: kurl-proxy\n  template:\n    metadata:\n      labels:\n        app: kurl-proxy\n    spec:\n      containers:\n      - name: proxy\n        image: kurl/proxy\n        env:\n        - name: NODE_PORT\n          value: '30880'\n        - name: UPSTREAM_ORIGIN\n          value: http://127.0.0.1:8800\n        - name: TLS_SECRET_NAME\n          value: kotsadm-tls\n        - name: NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        volumeMounts:\n        - name: kotsadm-config\n          mountPath: /etc/kotsadm\n      serviceAccount: kurl-proxy\n      volumes:\n      - name: kotsadm-config\n        configMap:\n          name: kotsadm-application-metadata\n          optional: true\n",
    "policy_id": "env-var-secret",
    "violation_text": "environment variable TLS_SECRET_NAME in container \"proxy\" found"
  },
  {
    "id": "00954",
    "manifest_path": "data/manifests/the_stack_sample/sample_0234.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: kurl-proxy\n  labels:\n    app: kurl-proxy\nspec:\n  selector:\n    matchLabels:\n      app: kurl-proxy\n  template:\n    metadata:\n      labels:\n        app: kurl-proxy\n    spec:\n      containers:\n      - name: proxy\n        image: kurl/proxy\n        env:\n        - name: NODE_PORT\n          value: '30880'\n        - name: UPSTREAM_ORIGIN\n          value: http://127.0.0.1:8800\n        - name: TLS_SECRET_NAME\n          value: kotsadm-tls\n        - name: NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        volumeMounts:\n        - name: kotsadm-config\n          mountPath: /etc/kotsadm\n      serviceAccount: kurl-proxy\n      volumes:\n      - name: kotsadm-config\n        configMap:\n          name: kotsadm-application-metadata\n          optional: true\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"proxy\" is using an invalid container image, \"kurl/proxy\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "00955",
    "manifest_path": "data/manifests/the_stack_sample/sample_0234.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: kurl-proxy\n  labels:\n    app: kurl-proxy\nspec:\n  selector:\n    matchLabels:\n      app: kurl-proxy\n  template:\n    metadata:\n      labels:\n        app: kurl-proxy\n    spec:\n      containers:\n      - name: proxy\n        image: kurl/proxy\n        env:\n        - name: NODE_PORT\n          value: '30880'\n        - name: UPSTREAM_ORIGIN\n          value: http://127.0.0.1:8800\n        - name: TLS_SECRET_NAME\n          value: kotsadm-tls\n        - name: NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        volumeMounts:\n        - name: kotsadm-config\n          mountPath: /etc/kotsadm\n      serviceAccount: kurl-proxy\n      volumes:\n      - name: kotsadm-config\n        configMap:\n          name: kotsadm-application-metadata\n          optional: true\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"proxy\" does not have a read-only root file system"
  },
  {
    "id": "00956",
    "manifest_path": "data/manifests/the_stack_sample/sample_0234.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: kurl-proxy\n  labels:\n    app: kurl-proxy\nspec:\n  selector:\n    matchLabels:\n      app: kurl-proxy\n  template:\n    metadata:\n      labels:\n        app: kurl-proxy\n    spec:\n      containers:\n      - name: proxy\n        image: kurl/proxy\n        env:\n        - name: NODE_PORT\n          value: '30880'\n        - name: UPSTREAM_ORIGIN\n          value: http://127.0.0.1:8800\n        - name: TLS_SECRET_NAME\n          value: kotsadm-tls\n        - name: NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        volumeMounts:\n        - name: kotsadm-config\n          mountPath: /etc/kotsadm\n      serviceAccount: kurl-proxy\n      volumes:\n      - name: kotsadm-config\n        configMap:\n          name: kotsadm-application-metadata\n          optional: true\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"proxy\" is not set to runAsNonRoot"
  },
  {
    "id": "00957",
    "manifest_path": "data/manifests/the_stack_sample/sample_0234.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: kurl-proxy\n  labels:\n    app: kurl-proxy\nspec:\n  selector:\n    matchLabels:\n      app: kurl-proxy\n  template:\n    metadata:\n      labels:\n        app: kurl-proxy\n    spec:\n      containers:\n      - name: proxy\n        image: kurl/proxy\n        env:\n        - name: NODE_PORT\n          value: '30880'\n        - name: UPSTREAM_ORIGIN\n          value: http://127.0.0.1:8800\n        - name: TLS_SECRET_NAME\n          value: kotsadm-tls\n        - name: NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        volumeMounts:\n        - name: kotsadm-config\n          mountPath: /etc/kotsadm\n      serviceAccount: kurl-proxy\n      volumes:\n      - name: kotsadm-config\n        configMap:\n          name: kotsadm-application-metadata\n          optional: true\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"proxy\" has cpu request 0"
  },
  {
    "id": "00958",
    "manifest_path": "data/manifests/the_stack_sample/sample_0234.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: kurl-proxy\n  labels:\n    app: kurl-proxy\nspec:\n  selector:\n    matchLabels:\n      app: kurl-proxy\n  template:\n    metadata:\n      labels:\n        app: kurl-proxy\n    spec:\n      containers:\n      - name: proxy\n        image: kurl/proxy\n        env:\n        - name: NODE_PORT\n          value: '30880'\n        - name: UPSTREAM_ORIGIN\n          value: http://127.0.0.1:8800\n        - name: TLS_SECRET_NAME\n          value: kotsadm-tls\n        - name: NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        volumeMounts:\n        - name: kotsadm-config\n          mountPath: /etc/kotsadm\n      serviceAccount: kurl-proxy\n      volumes:\n      - name: kotsadm-config\n        configMap:\n          name: kotsadm-application-metadata\n          optional: true\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"proxy\" has memory limit 0"
  },
  {
    "id": "00959",
    "manifest_path": "data/manifests/the_stack_sample/sample_0235.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: client\n  labels:\n    app: client\nspec:\n  replicas: 1\n  template:\n    metadata:\n      name: client\n      labels:\n        app: client\n    spec:\n      containers:\n      - name: client\n        image: alpine\n        imagePullPolicy: IfNotPresent\n        command:\n        - bin/sh\n        - -c\n        - sleep 10086\n  selector:\n    matchLabels:\n      app: client\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"client\" is using an invalid container image, \"alpine\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "00960",
    "manifest_path": "data/manifests/the_stack_sample/sample_0235.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: client\n  labels:\n    app: client\nspec:\n  replicas: 1\n  template:\n    metadata:\n      name: client\n      labels:\n        app: client\n    spec:\n      containers:\n      - name: client\n        image: alpine\n        imagePullPolicy: IfNotPresent\n        command:\n        - bin/sh\n        - -c\n        - sleep 10086\n  selector:\n    matchLabels:\n      app: client\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"client\" does not have a read-only root file system"
  }
]