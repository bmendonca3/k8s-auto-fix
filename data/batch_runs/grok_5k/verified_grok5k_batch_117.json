[
  {
    "id": "04681",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-9533\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    securityContext:\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      privileged: false\n      allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "04682",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-9533\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    securityContext:\n      readOnlyRootFilesystem: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "04683",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-9533\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    securityContext:\n      runAsNonRoot: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "04684",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-9533\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "04685",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-9533\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "04686",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: aqua-gateway\n  name: aqua-gateway\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: aqua-gateway\n  template:\n    metadata:\n      labels:\n        app: aqua-gateway\n      name: aqua-gateway\n    spec:\n      serviceAccount: aqua-sa\n      containers:\n      - name: aqua-gateway\n        image: registry.aquasec.com/gateway:6.5\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          privileged: false\n          readOnlyRootFilesystem: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        env:\n        - name: AQUA_CONSOLE_SECURE_ADDRESS\n          value: aqua-web:443\n        - name: SCALOCK_GATEWAY_PUBLIC_IP\n          value: aqua-gateway\n        - name: SCALOCK_DBUSER\n          value: postgres\n        - name: SCALOCK_DBPASSWORD\n          valueFrom:\n            secretKeyRef:\n              key: password\n              name: aqua-db\n        - name: SCALOCK_DBNAME\n          value: scalock\n        - name: SCALOCK_DBHOST\n          value: aqua-db\n        - name: SCALOCK_DBPORT\n          value: '5432'\n        - name: SCALOCK_AUDIT_DBUSER\n          value: postgres\n        - name: SCALOCK_AUDIT_DBPASSWORD\n          valueFrom:\n            secretKeyRef:\n              key: password\n              name: aqua-db\n        - name: SCALOCK_AUDIT_DBNAME\n          value: slk_audit\n        - name: SCALOCK_AUDIT_DBHOST\n          value: aqua-db\n        - name: SCALOCK_AUDIT_DBPORT\n          value: '5432'\n        ports:\n        - containerPort: 3622\n          protocol: TCP\n        - containerPort: 8443\n          protocol: TCP\n",
    "errors": []
  },
  {
    "id": "04687",
    "policy_id": "drop_capabilities",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: aqua-gateway\n  name: aqua-gateway\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: aqua-gateway\n  template:\n    metadata:\n      labels:\n        app: aqua-gateway\n      name: aqua-gateway\n    spec:\n      serviceAccount: aqua-sa\n      containers:\n      - name: aqua-gateway\n        image: registry.aquasec.com/gateway:6.5\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        env:\n        - name: AQUA_CONSOLE_SECURE_ADDRESS\n          value: aqua-web:443\n        - name: SCALOCK_GATEWAY_PUBLIC_IP\n          value: aqua-gateway\n        - name: SCALOCK_DBUSER\n          value: postgres\n        - name: SCALOCK_DBPASSWORD\n          valueFrom:\n            secretKeyRef:\n              key: password\n              name: aqua-db\n        - name: SCALOCK_DBNAME\n          value: scalock\n        - name: SCALOCK_DBHOST\n          value: aqua-db\n        - name: SCALOCK_DBPORT\n          value: '5432'\n        - name: SCALOCK_AUDIT_DBUSER\n          value: postgres\n        - name: SCALOCK_AUDIT_DBPASSWORD\n          valueFrom:\n            secretKeyRef:\n              key: password\n              name: aqua-db\n        - name: SCALOCK_AUDIT_DBNAME\n          value: slk_audit\n        - name: SCALOCK_AUDIT_DBHOST\n          value: aqua-db\n        - name: SCALOCK_AUDIT_DBPORT\n          value: '5432'\n        ports:\n        - containerPort: 3622\n          protocol: TCP\n        - containerPort: 8443\n          protocol: TCP\n",
    "errors": []
  },
  {
    "id": "04688",
    "policy_id": "no_privileged",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: aqua-gateway\n  name: aqua-gateway\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: aqua-gateway\n  template:\n    metadata:\n      labels:\n        app: aqua-gateway\n      name: aqua-gateway\n    spec:\n      serviceAccount: aqua-sa\n      containers:\n      - name: aqua-gateway\n        image: registry.aquasec.com/gateway:6.5\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        env:\n        - name: AQUA_CONSOLE_SECURE_ADDRESS\n          value: aqua-web:443\n        - name: SCALOCK_GATEWAY_PUBLIC_IP\n          value: aqua-gateway\n        - name: SCALOCK_DBUSER\n          value: postgres\n        - name: SCALOCK_DBPASSWORD\n          valueFrom:\n            secretKeyRef:\n              key: password\n              name: aqua-db\n        - name: SCALOCK_DBNAME\n          value: scalock\n        - name: SCALOCK_DBHOST\n          value: aqua-db\n        - name: SCALOCK_DBPORT\n          value: '5432'\n        - name: SCALOCK_AUDIT_DBUSER\n          value: postgres\n        - name: SCALOCK_AUDIT_DBPASSWORD\n          valueFrom:\n            secretKeyRef:\n              key: password\n              name: aqua-db\n        - name: SCALOCK_AUDIT_DBNAME\n          value: slk_audit\n        - name: SCALOCK_AUDIT_DBHOST\n          value: aqua-db\n        - name: SCALOCK_AUDIT_DBPORT\n          value: '5432'\n        ports:\n        - containerPort: 3622\n          protocol: TCP\n        - containerPort: 8443\n          protocol: TCP\n",
    "errors": []
  },
  {
    "id": "04689",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: aqua-gateway\n  name: aqua-gateway\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: aqua-gateway\n  template:\n    metadata:\n      labels:\n        app: aqua-gateway\n      name: aqua-gateway\n    spec:\n      serviceAccount: aqua-sa\n      containers:\n      - name: aqua-gateway\n        image: registry.aquasec.com/gateway:6.5\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          privileged: false\n          runAsNonRoot: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        env:\n        - name: AQUA_CONSOLE_SECURE_ADDRESS\n          value: aqua-web:443\n        - name: SCALOCK_GATEWAY_PUBLIC_IP\n          value: aqua-gateway\n        - name: SCALOCK_DBUSER\n          value: postgres\n        - name: SCALOCK_DBPASSWORD\n          valueFrom:\n            secretKeyRef:\n              key: password\n              name: aqua-db\n        - name: SCALOCK_DBNAME\n          value: scalock\n        - name: SCALOCK_DBHOST\n          value: aqua-db\n        - name: SCALOCK_DBPORT\n          value: '5432'\n        - name: SCALOCK_AUDIT_DBUSER\n          value: postgres\n        - name: SCALOCK_AUDIT_DBPASSWORD\n          valueFrom:\n            secretKeyRef:\n              key: password\n              name: aqua-db\n        - name: SCALOCK_AUDIT_DBNAME\n          value: slk_audit\n        - name: SCALOCK_AUDIT_DBHOST\n          value: aqua-db\n        - name: SCALOCK_AUDIT_DBPORT\n          value: '5432'\n        ports:\n        - containerPort: 3622\n          protocol: TCP\n        - containerPort: 8443\n          protocol: TCP\n",
    "errors": []
  },
  {
    "id": "04690",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: aqua-gateway\n  name: aqua-gateway\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: aqua-gateway\n  template:\n    metadata:\n      labels:\n        app: aqua-gateway\n      name: aqua-gateway\n    spec:\n      serviceAccount: aqua-sa\n      containers:\n      - name: aqua-gateway\n        image: registry.aquasec.com/gateway:6.5\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        env:\n        - name: AQUA_CONSOLE_SECURE_ADDRESS\n          value: aqua-web:443\n        - name: SCALOCK_GATEWAY_PUBLIC_IP\n          value: aqua-gateway\n        - name: SCALOCK_DBUSER\n          value: postgres\n        - name: SCALOCK_DBPASSWORD\n          valueFrom:\n            secretKeyRef:\n              key: password\n              name: aqua-db\n        - name: SCALOCK_DBNAME\n          value: scalock\n        - name: SCALOCK_DBHOST\n          value: aqua-db\n        - name: SCALOCK_DBPORT\n          value: '5432'\n        - name: SCALOCK_AUDIT_DBUSER\n          value: postgres\n        - name: SCALOCK_AUDIT_DBPASSWORD\n          valueFrom:\n            secretKeyRef:\n              key: password\n              name: aqua-db\n        - name: SCALOCK_AUDIT_DBNAME\n          value: slk_audit\n        - name: SCALOCK_AUDIT_DBHOST\n          value: aqua-db\n        - name: SCALOCK_AUDIT_DBPORT\n          value: '5432'\n        ports:\n        - containerPort: 3622\n          protocol: TCP\n        - containerPort: 8443\n          protocol: TCP\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "04691",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: aqua-gateway\n  name: aqua-gateway\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: aqua-gateway\n  template:\n    metadata:\n      labels:\n        app: aqua-gateway\n      name: aqua-gateway\n    spec:\n      serviceAccount: aqua-sa\n      containers:\n      - name: aqua-gateway\n        image: registry.aquasec.com/gateway:6.5\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        env:\n        - name: AQUA_CONSOLE_SECURE_ADDRESS\n          value: aqua-web:443\n        - name: SCALOCK_GATEWAY_PUBLIC_IP\n          value: aqua-gateway\n        - name: SCALOCK_DBUSER\n          value: postgres\n        - name: SCALOCK_DBPASSWORD\n          valueFrom:\n            secretKeyRef:\n              key: password\n              name: aqua-db\n        - name: SCALOCK_DBNAME\n          value: scalock\n        - name: SCALOCK_DBHOST\n          value: aqua-db\n        - name: SCALOCK_DBPORT\n          value: '5432'\n        - name: SCALOCK_AUDIT_DBUSER\n          value: postgres\n        - name: SCALOCK_AUDIT_DBPASSWORD\n          valueFrom:\n            secretKeyRef:\n              key: password\n              name: aqua-db\n        - name: SCALOCK_AUDIT_DBNAME\n          value: slk_audit\n        - name: SCALOCK_AUDIT_DBHOST\n          value: aqua-db\n        - name: SCALOCK_AUDIT_DBPORT\n          value: '5432'\n        ports:\n        - containerPort: 3622\n          protocol: TCP\n        - containerPort: 8443\n          protocol: TCP\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "04692",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: loadgenerator\nspec:\n  selector:\n    matchLabels:\n      app: loadgenerator\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: loadgenerator\n        version: v1\n      annotations:\n        sidecar.istio.io/rewriteAppHTTPProbers: 'true'\n    spec:\n      containers:\n      - name: main\n        image: sitaramiyer/bookstore-demo:loadgenerator-v0.1.2\n        env:\n        - name: FRONTEND_ADDR\n          value: frontend:80\n        - name: USERS\n          value: '10'\n        resources:\n          requests:\n            cpu: 300m\n            memory: 256Mi\n          limits:\n            cpu: 500m\n            memory: 512Mi\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "04693",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: loadgenerator\nspec:\n  selector:\n    matchLabels:\n      app: loadgenerator\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: loadgenerator\n        version: v1\n      annotations:\n        sidecar.istio.io/rewriteAppHTTPProbers: 'true'\n    spec:\n      containers:\n      - name: main\n        image: sitaramiyer/bookstore-demo:loadgenerator-v0.1.2\n        env:\n        - name: FRONTEND_ADDR\n          value: frontend:80\n        - name: USERS\n          value: '10'\n        resources:\n          requests:\n            cpu: 300m\n            memory: 256Mi\n          limits:\n            cpu: 500m\n            memory: 512Mi\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n",
    "errors": []
  },
  {
    "id": "04694",
    "policy_id": "read_only_root_fs",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": false,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "no containers found in manifest",
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "04695",
    "policy_id": "run_as_non_root",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": false,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "no containers found in manifest",
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "04696",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": false,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "no containers found in manifest",
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "04697",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": false,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "no containers found in manifest",
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "04698",
    "policy_id": "no_latest_tag",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "04699",
    "policy_id": "read_only_root_fs",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "04700",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "04701",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: dss\n  labels:\n    app: dss\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: dss\n  template:\n    metadata:\n      labels:\n        app: dss\n    spec:\n      securityContext:\n        fsGroup: 1000\n      containers:\n      - name: dss\n        image: dss-node-image:stable\n        imagePullPolicy: Always\n        command:\n        - /bin/bash\n        args:\n        - -ci\n        - ./startup.sh\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        - name: DOCKER_HOST\n          value: tcp://localhost:2375\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        volumeMounts:\n        - name: kubectl-config\n          mountPath: /home/ubuntu/.kube\n        - name: shared-storage\n          mountPath: /share\n        - name: gitlab-registry-cred\n          mountPath: /gitlab-repo/credentials\n      - name: dind\n        image: docker:19.03.9-dind\n        resources:\n          requests:\n            cpu: 250m\n            memory: 250Mi\n          limits:\n            cpu: 250m\n            memory: 250Mi\n        env:\n        - name: DOCKER_TLS_CERTDIR\n          value: ''\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        volumeMounts:\n        - name: docker-storage\n          mountPath: /var/lib/docker\n      - name: dood\n        image: docker:19.03.8\n        command:\n        - tail\n        - -f\n        - /dev/null\n        resources:\n          requests:\n            cpu: 200m\n            memory: 250Mi\n          limits:\n            cpu: 200m\n            memory: 250Mi\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        envFrom:\n        - secretRef:\n            name: gitlab-registry-cred\n        volumeMounts:\n        - name: docker-sock\n          mountPath: /var/run\n        - name: shared-storage\n          mountPath: /share\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: docker-storage\n        emptyDir: {}\n      - name: docker-sock\n        hostPath:\n          path: /var/run\n      - name: shared-storage\n        emptyDir: {}\n      - name: kubectl-config\n        secret:\n          secretName: kubectl-config\n          defaultMode: 256\n      - name: gitlab-registry-cred\n        secret:\n          secretName: gitlab-registry-cred\n",
    "errors": []
  },
  {
    "id": "04702",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: dss\n  labels:\n    app: dss\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: dss\n  template:\n    metadata:\n      labels:\n        app: dss\n    spec:\n      securityContext:\n        fsGroup: 1000\n      containers:\n      - name: dss\n        image: dss-node-image:stable\n        imagePullPolicy: Always\n        command:\n        - /bin/bash\n        args:\n        - -ci\n        - ./startup.sh\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        - name: DOCKER_HOST\n          value: tcp://localhost:2375\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        securityContext:\n          privileged: false\n          readOnlyRootFilesystem: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        volumeMounts:\n        - name: kubectl-config\n          mountPath: /home/ubuntu/.kube\n        - name: shared-storage\n          mountPath: /share\n        - name: gitlab-registry-cred\n          mountPath: /gitlab-repo/credentials\n      - name: dind\n        image: docker:19.03.9-dind\n        resources:\n          requests:\n            cpu: 250m\n            memory: 250Mi\n          limits:\n            cpu: 250m\n            memory: 250Mi\n        env:\n        - name: DOCKER_TLS_CERTDIR\n          value: ''\n        securityContext:\n          privileged: false\n          readOnlyRootFilesystem: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        volumeMounts:\n        - name: docker-storage\n          mountPath: /var/lib/docker\n      - name: dood\n        image: docker:19.03.8\n        command:\n        - tail\n        - -f\n        - /dev/null\n        resources:\n          requests:\n            cpu: 200m\n            memory: 250Mi\n          limits:\n            cpu: 200m\n            memory: 250Mi\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        envFrom:\n        - secretRef:\n            name: gitlab-registry-cred\n        volumeMounts:\n        - name: docker-sock\n          mountPath: /var/run\n        - name: shared-storage\n          mountPath: /share\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: docker-storage\n        emptyDir: {}\n      - name: docker-sock\n        hostPath:\n          path: /var/run\n      - name: shared-storage\n        emptyDir: {}\n      - name: kubectl-config\n        secret:\n          secretName: kubectl-config\n          defaultMode: 256\n      - name: gitlab-registry-cred\n        secret:\n          secretName: gitlab-registry-cred\n",
    "errors": []
  },
  {
    "id": "04703",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: dss\n  labels:\n    app: dss\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: dss\n  template:\n    metadata:\n      labels:\n        app: dss\n    spec:\n      securityContext:\n        fsGroup: 1000\n      containers:\n      - name: dss\n        image: dss-node-image:stable\n        imagePullPolicy: Always\n        command:\n        - /bin/bash\n        args:\n        - -ci\n        - ./startup.sh\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        - name: DOCKER_HOST\n          value: tcp://localhost:2375\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        securityContext:\n          privileged: false\n          readOnlyRootFilesystem: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        volumeMounts:\n        - name: kubectl-config\n          mountPath: /home/ubuntu/.kube\n        - name: shared-storage\n          mountPath: /share\n        - name: gitlab-registry-cred\n          mountPath: /gitlab-repo/credentials\n      - name: dind\n        image: docker:19.03.9-dind\n        resources:\n          requests:\n            cpu: 250m\n            memory: 250Mi\n          limits:\n            cpu: 250m\n            memory: 250Mi\n        env:\n        - name: DOCKER_TLS_CERTDIR\n          value: ''\n        securityContext:\n          privileged: false\n          readOnlyRootFilesystem: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        volumeMounts:\n        - name: docker-storage\n          mountPath: /var/lib/docker\n      - name: dood\n        image: docker:19.03.8\n        command:\n        - tail\n        - -f\n        - /dev/null\n        resources:\n          requests:\n            cpu: 200m\n            memory: 250Mi\n          limits:\n            cpu: 200m\n            memory: 250Mi\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        envFrom:\n        - secretRef:\n            name: gitlab-registry-cred\n        volumeMounts:\n        - name: docker-sock\n          mountPath: /var/run\n        - name: shared-storage\n          mountPath: /share\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: docker-storage\n        emptyDir: {}\n      - name: docker-sock\n        hostPath:\n          path: /var/run\n      - name: shared-storage\n        emptyDir: {}\n      - name: kubectl-config\n        secret:\n          secretName: kubectl-config\n          defaultMode: 256\n      - name: gitlab-registry-cred\n        secret:\n          secretName: gitlab-registry-cred\n",
    "errors": []
  },
  {
    "id": "04704",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: dss\n  labels:\n    app: dss\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: dss\n  template:\n    metadata:\n      labels:\n        app: dss\n    spec:\n      securityContext:\n        fsGroup: 1000\n      containers:\n      - name: dss\n        image: dss-node-image:stable\n        imagePullPolicy: Always\n        command:\n        - /bin/bash\n        args:\n        - -ci\n        - ./startup.sh\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        - name: DOCKER_HOST\n          value: tcp://localhost:2375\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        securityContext:\n          privileged: false\n          readOnlyRootFilesystem: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        volumeMounts:\n        - name: kubectl-config\n          mountPath: /home/ubuntu/.kube\n        - name: shared-storage\n          mountPath: /share\n        - name: gitlab-registry-cred\n          mountPath: /gitlab-repo/credentials\n      - name: dind\n        image: docker:19.03.9-dind\n        resources:\n          requests:\n            cpu: 250m\n            memory: 250Mi\n          limits:\n            cpu: 250m\n            memory: 250Mi\n        env:\n        - name: DOCKER_TLS_CERTDIR\n          value: ''\n        securityContext:\n          privileged: false\n          readOnlyRootFilesystem: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        volumeMounts:\n        - name: docker-storage\n          mountPath: /var/lib/docker\n      - name: dood\n        image: docker:19.03.8\n        command:\n        - tail\n        - -f\n        - /dev/null\n        resources:\n          requests:\n            cpu: 200m\n            memory: 250Mi\n          limits:\n            cpu: 200m\n            memory: 250Mi\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        envFrom:\n        - secretRef:\n            name: gitlab-registry-cred\n        volumeMounts:\n        - name: docker-sock\n          mountPath: /var/run\n        - name: shared-storage\n          mountPath: /share\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: docker-storage\n        emptyDir: {}\n      - name: docker-sock\n        hostPath:\n          path: /var/run\n      - name: shared-storage\n        emptyDir: {}\n      - name: kubectl-config\n        secret:\n          secretName: kubectl-config\n          defaultMode: 256\n      - name: gitlab-registry-cred\n        secret:\n          secretName: gitlab-registry-cred\n",
    "errors": []
  },
  {
    "id": "04705",
    "policy_id": "drop_capabilities",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: dss\n  labels:\n    app: dss\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: dss\n  template:\n    metadata:\n      labels:\n        app: dss\n    spec:\n      securityContext:\n        fsGroup: 1000\n      containers:\n      - name: dss\n        image: dss-node-image:stable\n        imagePullPolicy: Always\n        command:\n        - /bin/bash\n        args:\n        - -ci\n        - ./startup.sh\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        - name: DOCKER_HOST\n          value: tcp://localhost:2375\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        volumeMounts:\n        - name: kubectl-config\n          mountPath: /home/ubuntu/.kube\n        - name: shared-storage\n          mountPath: /share\n        - name: gitlab-registry-cred\n          mountPath: /gitlab-repo/credentials\n      - name: dind\n        image: docker:19.03.9-dind\n        resources:\n          requests:\n            cpu: 250m\n            memory: 250Mi\n          limits:\n            cpu: 250m\n            memory: 250Mi\n        env:\n        - name: DOCKER_TLS_CERTDIR\n          value: ''\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        volumeMounts:\n        - name: docker-storage\n          mountPath: /var/lib/docker\n      - name: dood\n        image: docker:19.03.8\n        command:\n        - tail\n        - -f\n        - /dev/null\n        resources:\n          requests:\n            cpu: 200m\n            memory: 250Mi\n          limits:\n            cpu: 200m\n            memory: 250Mi\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        envFrom:\n        - secretRef:\n            name: gitlab-registry-cred\n        volumeMounts:\n        - name: docker-sock\n          mountPath: /var/run\n        - name: shared-storage\n          mountPath: /share\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: docker-storage\n        emptyDir: {}\n      - name: docker-sock\n        hostPath:\n          path: /var/run\n      - name: shared-storage\n        emptyDir: {}\n      - name: kubectl-config\n        secret:\n          secretName: kubectl-config\n          defaultMode: 256\n      - name: gitlab-registry-cred\n        secret:\n          secretName: gitlab-registry-cred\n",
    "errors": []
  },
  {
    "id": "04706",
    "policy_id": "drop_capabilities",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: dss\n  labels:\n    app: dss\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: dss\n  template:\n    metadata:\n      labels:\n        app: dss\n    spec:\n      securityContext:\n        fsGroup: 1000\n      containers:\n      - name: dss\n        image: dss-node-image:stable\n        imagePullPolicy: Always\n        command:\n        - /bin/bash\n        args:\n        - -ci\n        - ./startup.sh\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        - name: DOCKER_HOST\n          value: tcp://localhost:2375\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        volumeMounts:\n        - name: kubectl-config\n          mountPath: /home/ubuntu/.kube\n        - name: shared-storage\n          mountPath: /share\n        - name: gitlab-registry-cred\n          mountPath: /gitlab-repo/credentials\n      - name: dind\n        image: docker:19.03.9-dind\n        resources:\n          requests:\n            cpu: 250m\n            memory: 250Mi\n          limits:\n            cpu: 250m\n            memory: 250Mi\n        env:\n        - name: DOCKER_TLS_CERTDIR\n          value: ''\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        volumeMounts:\n        - name: docker-storage\n          mountPath: /var/lib/docker\n      - name: dood\n        image: docker:19.03.8\n        command:\n        - tail\n        - -f\n        - /dev/null\n        resources:\n          requests:\n            cpu: 200m\n            memory: 250Mi\n          limits:\n            cpu: 200m\n            memory: 250Mi\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        envFrom:\n        - secretRef:\n            name: gitlab-registry-cred\n        volumeMounts:\n        - name: docker-sock\n          mountPath: /var/run\n        - name: shared-storage\n          mountPath: /share\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: docker-storage\n        emptyDir: {}\n      - name: docker-sock\n        hostPath:\n          path: /var/run\n      - name: shared-storage\n        emptyDir: {}\n      - name: kubectl-config\n        secret:\n          secretName: kubectl-config\n          defaultMode: 256\n      - name: gitlab-registry-cred\n        secret:\n          secretName: gitlab-registry-cred\n",
    "errors": []
  },
  {
    "id": "04707",
    "policy_id": "no_privileged",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: dss\n  labels:\n    app: dss\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: dss\n  template:\n    metadata:\n      labels:\n        app: dss\n    spec:\n      securityContext:\n        fsGroup: 1000\n      containers:\n      - name: dss\n        image: dss-node-image:stable\n        imagePullPolicy: Always\n        command:\n        - /bin/bash\n        args:\n        - -ci\n        - ./startup.sh\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        - name: DOCKER_HOST\n          value: tcp://localhost:2375\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        volumeMounts:\n        - name: kubectl-config\n          mountPath: /home/ubuntu/.kube\n        - name: shared-storage\n          mountPath: /share\n        - name: gitlab-registry-cred\n          mountPath: /gitlab-repo/credentials\n      - name: dind\n        image: docker:19.03.9-dind\n        resources:\n          requests:\n            cpu: 250m\n            memory: 250Mi\n          limits:\n            cpu: 250m\n            memory: 250Mi\n        env:\n        - name: DOCKER_TLS_CERTDIR\n          value: ''\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        volumeMounts:\n        - name: docker-storage\n          mountPath: /var/lib/docker\n      - name: dood\n        image: docker:19.03.8\n        command:\n        - tail\n        - -f\n        - /dev/null\n        resources:\n          requests:\n            cpu: 200m\n            memory: 250Mi\n          limits:\n            cpu: 200m\n            memory: 250Mi\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        envFrom:\n        - secretRef:\n            name: gitlab-registry-cred\n        volumeMounts:\n        - name: docker-sock\n          mountPath: /var/run\n        - name: shared-storage\n          mountPath: /share\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: docker-storage\n        emptyDir: {}\n      - name: docker-sock\n        hostPath:\n          path: /var/run\n      - name: shared-storage\n        emptyDir: {}\n      - name: kubectl-config\n        secret:\n          secretName: kubectl-config\n          defaultMode: 256\n      - name: gitlab-registry-cred\n        secret:\n          secretName: gitlab-registry-cred\n",
    "errors": []
  },
  {
    "id": "04708",
    "policy_id": "no_privileged",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: dss\n  labels:\n    app: dss\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: dss\n  template:\n    metadata:\n      labels:\n        app: dss\n    spec:\n      securityContext:\n        fsGroup: 1000\n      containers:\n      - name: dss\n        image: dss-node-image:stable\n        imagePullPolicy: Always\n        command:\n        - /bin/bash\n        args:\n        - -ci\n        - ./startup.sh\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        - name: DOCKER_HOST\n          value: tcp://localhost:2375\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        volumeMounts:\n        - name: kubectl-config\n          mountPath: /home/ubuntu/.kube\n        - name: shared-storage\n          mountPath: /share\n        - name: gitlab-registry-cred\n          mountPath: /gitlab-repo/credentials\n      - name: dind\n        image: docker:19.03.9-dind\n        resources:\n          requests:\n            cpu: 250m\n            memory: 250Mi\n          limits:\n            cpu: 250m\n            memory: 250Mi\n        env:\n        - name: DOCKER_TLS_CERTDIR\n          value: ''\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        volumeMounts:\n        - name: docker-storage\n          mountPath: /var/lib/docker\n      - name: dood\n        image: docker:19.03.8\n        command:\n        - tail\n        - -f\n        - /dev/null\n        resources:\n          requests:\n            cpu: 200m\n            memory: 250Mi\n          limits:\n            cpu: 200m\n            memory: 250Mi\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        envFrom:\n        - secretRef:\n            name: gitlab-registry-cred\n        volumeMounts:\n        - name: docker-sock\n          mountPath: /var/run\n        - name: shared-storage\n          mountPath: /share\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: docker-storage\n        emptyDir: {}\n      - name: docker-sock\n        hostPath:\n          path: /var/run\n      - name: shared-storage\n        emptyDir: {}\n      - name: kubectl-config\n        secret:\n          secretName: kubectl-config\n          defaultMode: 256\n      - name: gitlab-registry-cred\n        secret:\n          secretName: gitlab-registry-cred\n",
    "errors": []
  },
  {
    "id": "04709",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: dss\n  labels:\n    app: dss\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: dss\n  template:\n    metadata:\n      labels:\n        app: dss\n    spec:\n      securityContext:\n        fsGroup: 1000\n      containers:\n      - name: dss\n        image: dss-node-image:stable\n        imagePullPolicy: Always\n        command:\n        - /bin/bash\n        args:\n        - -ci\n        - ./startup.sh\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        - name: DOCKER_HOST\n          value: tcp://localhost:2375\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        securityContext:\n          privileged: false\n          runAsNonRoot: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        volumeMounts:\n        - name: kubectl-config\n          mountPath: /home/ubuntu/.kube\n        - name: shared-storage\n          mountPath: /share\n        - name: gitlab-registry-cred\n          mountPath: /gitlab-repo/credentials\n      - name: dind\n        image: docker:19.03.9-dind\n        resources:\n          requests:\n            cpu: 250m\n            memory: 250Mi\n          limits:\n            cpu: 250m\n            memory: 250Mi\n        env:\n        - name: DOCKER_TLS_CERTDIR\n          value: ''\n        securityContext:\n          privileged: false\n          runAsNonRoot: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        volumeMounts:\n        - name: docker-storage\n          mountPath: /var/lib/docker\n      - name: dood\n        image: docker:19.03.8\n        command:\n        - tail\n        - -f\n        - /dev/null\n        resources:\n          requests:\n            cpu: 200m\n            memory: 250Mi\n          limits:\n            cpu: 200m\n            memory: 250Mi\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        envFrom:\n        - secretRef:\n            name: gitlab-registry-cred\n        volumeMounts:\n        - name: docker-sock\n          mountPath: /var/run\n        - name: shared-storage\n          mountPath: /share\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: docker-storage\n        emptyDir: {}\n      - name: docker-sock\n        hostPath:\n          path: /var/run\n      - name: shared-storage\n        emptyDir: {}\n      - name: kubectl-config\n        secret:\n          secretName: kubectl-config\n          defaultMode: 256\n      - name: gitlab-registry-cred\n        secret:\n          secretName: gitlab-registry-cred\n",
    "errors": []
  },
  {
    "id": "04710",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: dss\n  labels:\n    app: dss\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: dss\n  template:\n    metadata:\n      labels:\n        app: dss\n    spec:\n      securityContext:\n        fsGroup: 1000\n      containers:\n      - name: dss\n        image: dss-node-image:stable\n        imagePullPolicy: Always\n        command:\n        - /bin/bash\n        args:\n        - -ci\n        - ./startup.sh\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        - name: DOCKER_HOST\n          value: tcp://localhost:2375\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        securityContext:\n          privileged: false\n          runAsNonRoot: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        volumeMounts:\n        - name: kubectl-config\n          mountPath: /home/ubuntu/.kube\n        - name: shared-storage\n          mountPath: /share\n        - name: gitlab-registry-cred\n          mountPath: /gitlab-repo/credentials\n      - name: dind\n        image: docker:19.03.9-dind\n        resources:\n          requests:\n            cpu: 250m\n            memory: 250Mi\n          limits:\n            cpu: 250m\n            memory: 250Mi\n        env:\n        - name: DOCKER_TLS_CERTDIR\n          value: ''\n        securityContext:\n          privileged: false\n          runAsNonRoot: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        volumeMounts:\n        - name: docker-storage\n          mountPath: /var/lib/docker\n      - name: dood\n        image: docker:19.03.8\n        command:\n        - tail\n        - -f\n        - /dev/null\n        resources:\n          requests:\n            cpu: 200m\n            memory: 250Mi\n          limits:\n            cpu: 200m\n            memory: 250Mi\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        envFrom:\n        - secretRef:\n            name: gitlab-registry-cred\n        volumeMounts:\n        - name: docker-sock\n          mountPath: /var/run\n        - name: shared-storage\n          mountPath: /share\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: docker-storage\n        emptyDir: {}\n      - name: docker-sock\n        hostPath:\n          path: /var/run\n      - name: shared-storage\n        emptyDir: {}\n      - name: kubectl-config\n        secret:\n          secretName: kubectl-config\n          defaultMode: 256\n      - name: gitlab-registry-cred\n        secret:\n          secretName: gitlab-registry-cred\n",
    "errors": []
  },
  {
    "id": "04711",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: dss\n  labels:\n    app: dss\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: dss\n  template:\n    metadata:\n      labels:\n        app: dss\n    spec:\n      securityContext:\n        fsGroup: 1000\n      containers:\n      - name: dss\n        image: dss-node-image:stable\n        imagePullPolicy: Always\n        command:\n        - /bin/bash\n        args:\n        - -ci\n        - ./startup.sh\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        - name: DOCKER_HOST\n          value: tcp://localhost:2375\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        securityContext:\n          privileged: false\n          runAsNonRoot: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        volumeMounts:\n        - name: kubectl-config\n          mountPath: /home/ubuntu/.kube\n        - name: shared-storage\n          mountPath: /share\n        - name: gitlab-registry-cred\n          mountPath: /gitlab-repo/credentials\n      - name: dind\n        image: docker:19.03.9-dind\n        resources:\n          requests:\n            cpu: 250m\n            memory: 250Mi\n          limits:\n            cpu: 250m\n            memory: 250Mi\n        env:\n        - name: DOCKER_TLS_CERTDIR\n          value: ''\n        securityContext:\n          privileged: false\n          runAsNonRoot: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        volumeMounts:\n        - name: docker-storage\n          mountPath: /var/lib/docker\n      - name: dood\n        image: docker:19.03.8\n        command:\n        - tail\n        - -f\n        - /dev/null\n        resources:\n          requests:\n            cpu: 200m\n            memory: 250Mi\n          limits:\n            cpu: 200m\n            memory: 250Mi\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        envFrom:\n        - secretRef:\n            name: gitlab-registry-cred\n        volumeMounts:\n        - name: docker-sock\n          mountPath: /var/run\n        - name: shared-storage\n          mountPath: /share\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: docker-storage\n        emptyDir: {}\n      - name: docker-sock\n        hostPath:\n          path: /var/run\n      - name: shared-storage\n        emptyDir: {}\n      - name: kubectl-config\n        secret:\n          secretName: kubectl-config\n          defaultMode: 256\n      - name: gitlab-registry-cred\n        secret:\n          secretName: gitlab-registry-cred\n",
    "errors": []
  },
  {
    "id": "04712",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: dss\n  labels:\n    app: dss\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: dss\n  template:\n    metadata:\n      labels:\n        app: dss\n    spec:\n      securityContext:\n        fsGroup: 1000\n      containers:\n      - name: dss\n        image: dss-node-image:stable\n        imagePullPolicy: Always\n        command:\n        - /bin/bash\n        args:\n        - -ci\n        - ./startup.sh\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        - name: DOCKER_HOST\n          value: tcp://localhost:2375\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        volumeMounts:\n        - name: kubectl-config\n          mountPath: /home/ubuntu/.kube\n        - name: shared-storage\n          mountPath: /share\n        - name: gitlab-registry-cred\n          mountPath: /gitlab-repo/credentials\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - name: dind\n        image: docker:19.03.9-dind\n        resources:\n          requests:\n            cpu: 250m\n            memory: 250Mi\n          limits:\n            cpu: 250m\n            memory: 250Mi\n        env:\n        - name: DOCKER_TLS_CERTDIR\n          value: ''\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        volumeMounts:\n        - name: docker-storage\n          mountPath: /var/lib/docker\n      - name: dood\n        image: docker:19.03.8\n        command:\n        - tail\n        - -f\n        - /dev/null\n        resources:\n          requests:\n            cpu: 200m\n            memory: 250Mi\n          limits:\n            cpu: 200m\n            memory: 250Mi\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        envFrom:\n        - secretRef:\n            name: gitlab-registry-cred\n        volumeMounts:\n        - name: docker-sock\n          mountPath: /var/run\n        - name: shared-storage\n          mountPath: /share\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: docker-storage\n        emptyDir: {}\n      - name: docker-sock\n        hostPath:\n          path: /var/run\n      - name: shared-storage\n        emptyDir: {}\n      - name: kubectl-config\n        secret:\n          secretName: kubectl-config\n          defaultMode: 256\n      - name: gitlab-registry-cred\n        secret:\n          secretName: gitlab-registry-cred\n",
    "errors": []
  },
  {
    "id": "04713",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: dss\n  labels:\n    app: dss\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: dss\n  template:\n    metadata:\n      labels:\n        app: dss\n    spec:\n      securityContext:\n        fsGroup: 1000\n      containers:\n      - name: dss\n        image: dss-node-image:stable\n        imagePullPolicy: Always\n        command:\n        - /bin/bash\n        args:\n        - -ci\n        - ./startup.sh\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        - name: DOCKER_HOST\n          value: tcp://localhost:2375\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        volumeMounts:\n        - name: kubectl-config\n          mountPath: /home/ubuntu/.kube\n        - name: shared-storage\n          mountPath: /share\n        - name: gitlab-registry-cred\n          mountPath: /gitlab-repo/credentials\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - name: dind\n        image: docker:19.03.9-dind\n        resources:\n          requests:\n            cpu: 250m\n            memory: 250Mi\n          limits:\n            cpu: 250m\n            memory: 250Mi\n        env:\n        - name: DOCKER_TLS_CERTDIR\n          value: ''\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n        volumeMounts:\n        - name: docker-storage\n          mountPath: /var/lib/docker\n      - name: dood\n        image: docker:19.03.8\n        command:\n        - tail\n        - -f\n        - /dev/null\n        resources:\n          requests:\n            cpu: 200m\n            memory: 250Mi\n          limits:\n            cpu: 200m\n            memory: 250Mi\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        envFrom:\n        - secretRef:\n            name: gitlab-registry-cred\n        volumeMounts:\n        - name: docker-sock\n          mountPath: /var/run\n        - name: shared-storage\n          mountPath: /share\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n      volumes:\n      - name: docker-storage\n        emptyDir: {}\n      - name: docker-sock\n        hostPath:\n          path: /var/run\n      - name: shared-storage\n        emptyDir: {}\n      - name: kubectl-config\n        secret:\n          secretName: kubectl-config\n          defaultMode: 256\n      - name: gitlab-registry-cred\n        secret:\n          secretName: gitlab-registry-cred\n",
    "errors": []
  },
  {
    "id": "04714",
    "policy_id": "read_only_root_fs",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "04715",
    "policy_id": "read_only_root_fs",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "04716",
    "policy_id": "read_only_root_fs",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "04717",
    "policy_id": "read_only_root_fs",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "04718",
    "policy_id": "drop_capabilities",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "04719",
    "policy_id": "drop_capabilities",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  },
  {
    "id": "04720",
    "policy_id": "run_as_non_root",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed"
    ]
  }
]