[
  {
    "id": "04681",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-9533\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    securityContext:\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      privileged: false\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n      readOnlyRootFilesystem: true\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "04682",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-9533\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    securityContext:\n      readOnlyRootFilesystem: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "04683",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-9533\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    securityContext:\n      runAsNonRoot: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      readOnlyRootFilesystem: true\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "04684",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-9533\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n      readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "04685",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: image-demo-9533\nspec:\n  containers:\n  - name: nginx\n    image: nginx:stable\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n      readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "04686",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: aqua-gateway\n  name: aqua-gateway\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: aqua-gateway\n  template:\n    metadata:\n      labels:\n        app: aqua-gateway\n      name: aqua-gateway\n    spec:\n      serviceAccount: aqua-sa\n      containers:\n      - name: aqua-gateway\n        image: registry.aquasec.com/gateway:6.5\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          privileged: false\n          readOnlyRootFilesystem: true\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n        env:\n        - name: AQUA_CONSOLE_SECURE_ADDRESS\n          value: aqua-web:443\n        - name: SCALOCK_GATEWAY_PUBLIC_IP\n          value: aqua-gateway\n        - name: SCALOCK_DBUSER\n          value: postgres\n        - name: SCALOCK_DBPASSWORD\n          valueFrom:\n            secretKeyRef:\n              key: password\n              name: aqua-db\n        - name: SCALOCK_DBNAME\n          value: scalock\n        - name: SCALOCK_DBHOST\n          value: aqua-db\n        - name: SCALOCK_DBPORT\n          value: '5432'\n        - name: SCALOCK_AUDIT_DBUSER\n          value: postgres\n        - name: SCALOCK_AUDIT_DBPASSWORD\n          valueFrom:\n            secretKeyRef:\n              key: password\n              name: aqua-db\n        - name: SCALOCK_AUDIT_DBNAME\n          value: slk_audit\n        - name: SCALOCK_AUDIT_DBHOST\n          value: aqua-db\n        - name: SCALOCK_AUDIT_DBPORT\n          value: '5432'\n        ports:\n        - containerPort: 3622\n          protocol: TCP\n        - containerPort: 8443\n          protocol: TCP\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "04687",
    "policy_id": "drop_capabilities",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: aqua-gateway\n  name: aqua-gateway\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: aqua-gateway\n  template:\n    metadata:\n      labels:\n        app: aqua-gateway\n      name: aqua-gateway\n    spec:\n      serviceAccount: aqua-sa\n      containers:\n      - name: aqua-gateway\n        image: registry.aquasec.com/gateway:6.5\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          privileged: false\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n        env:\n        - name: AQUA_CONSOLE_SECURE_ADDRESS\n          value: aqua-web:443\n        - name: SCALOCK_GATEWAY_PUBLIC_IP\n          value: aqua-gateway\n        - name: SCALOCK_DBUSER\n          value: postgres\n        - name: SCALOCK_DBPASSWORD\n          valueFrom:\n            secretKeyRef:\n              key: password\n              name: aqua-db\n        - name: SCALOCK_DBNAME\n          value: scalock\n        - name: SCALOCK_DBHOST\n          value: aqua-db\n        - name: SCALOCK_DBPORT\n          value: '5432'\n        - name: SCALOCK_AUDIT_DBUSER\n          value: postgres\n        - name: SCALOCK_AUDIT_DBPASSWORD\n          valueFrom:\n            secretKeyRef:\n              key: password\n              name: aqua-db\n        - name: SCALOCK_AUDIT_DBNAME\n          value: slk_audit\n        - name: SCALOCK_AUDIT_DBHOST\n          value: aqua-db\n        - name: SCALOCK_AUDIT_DBPORT\n          value: '5432'\n        ports:\n        - containerPort: 3622\n          protocol: TCP\n        - containerPort: 8443\n          protocol: TCP\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "04688",
    "policy_id": "no_privileged",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: aqua-gateway\n  name: aqua-gateway\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: aqua-gateway\n  template:\n    metadata:\n      labels:\n        app: aqua-gateway\n      name: aqua-gateway\n    spec:\n      serviceAccount: aqua-sa\n      containers:\n      - name: aqua-gateway\n        image: registry.aquasec.com/gateway:6.5\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          privileged: false\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          runAsNonRoot: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n        env:\n        - name: AQUA_CONSOLE_SECURE_ADDRESS\n          value: aqua-web:443\n        - name: SCALOCK_GATEWAY_PUBLIC_IP\n          value: aqua-gateway\n        - name: SCALOCK_DBUSER\n          value: postgres\n        - name: SCALOCK_DBPASSWORD\n          valueFrom:\n            secretKeyRef:\n              key: password\n              name: aqua-db\n        - name: SCALOCK_DBNAME\n          value: scalock\n        - name: SCALOCK_DBHOST\n          value: aqua-db\n        - name: SCALOCK_DBPORT\n          value: '5432'\n        - name: SCALOCK_AUDIT_DBUSER\n          value: postgres\n        - name: SCALOCK_AUDIT_DBPASSWORD\n          valueFrom:\n            secretKeyRef:\n              key: password\n              name: aqua-db\n        - name: SCALOCK_AUDIT_DBNAME\n          value: slk_audit\n        - name: SCALOCK_AUDIT_DBHOST\n          value: aqua-db\n        - name: SCALOCK_AUDIT_DBPORT\n          value: '5432'\n        ports:\n        - containerPort: 3622\n          protocol: TCP\n        - containerPort: 8443\n          protocol: TCP\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "04689",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: aqua-gateway\n  name: aqua-gateway\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: aqua-gateway\n  template:\n    metadata:\n      labels:\n        app: aqua-gateway\n      name: aqua-gateway\n    spec:\n      serviceAccount: aqua-sa\n      containers:\n      - name: aqua-gateway\n        image: registry.aquasec.com/gateway:6.5\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          privileged: false\n          runAsNonRoot: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        env:\n        - name: AQUA_CONSOLE_SECURE_ADDRESS\n          value: aqua-web:443\n        - name: SCALOCK_GATEWAY_PUBLIC_IP\n          value: aqua-gateway\n        - name: SCALOCK_DBUSER\n          value: postgres\n        - name: SCALOCK_DBPASSWORD\n          valueFrom:\n            secretKeyRef:\n              key: password\n              name: aqua-db\n        - name: SCALOCK_DBNAME\n          value: scalock\n        - name: SCALOCK_DBHOST\n          value: aqua-db\n        - name: SCALOCK_DBPORT\n          value: '5432'\n        - name: SCALOCK_AUDIT_DBUSER\n          value: postgres\n        - name: SCALOCK_AUDIT_DBPASSWORD\n          valueFrom:\n            secretKeyRef:\n              key: password\n              name: aqua-db\n        - name: SCALOCK_AUDIT_DBNAME\n          value: slk_audit\n        - name: SCALOCK_AUDIT_DBHOST\n          value: aqua-db\n        - name: SCALOCK_AUDIT_DBPORT\n          value: '5432'\n        ports:\n        - containerPort: 3622\n          protocol: TCP\n        - containerPort: 8443\n          protocol: TCP\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "04690",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: aqua-gateway\n  name: aqua-gateway\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: aqua-gateway\n  template:\n    metadata:\n      labels:\n        app: aqua-gateway\n      name: aqua-gateway\n    spec:\n      serviceAccount: aqua-sa\n      containers:\n      - name: aqua-gateway\n        image: registry.aquasec.com/gateway:6.5\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        env:\n        - name: AQUA_CONSOLE_SECURE_ADDRESS\n          value: aqua-web:443\n        - name: SCALOCK_GATEWAY_PUBLIC_IP\n          value: aqua-gateway\n        - name: SCALOCK_DBUSER\n          value: postgres\n        - name: SCALOCK_DBPASSWORD\n          valueFrom:\n            secretKeyRef:\n              key: password\n              name: aqua-db\n        - name: SCALOCK_DBNAME\n          value: scalock\n        - name: SCALOCK_DBHOST\n          value: aqua-db\n        - name: SCALOCK_DBPORT\n          value: '5432'\n        - name: SCALOCK_AUDIT_DBUSER\n          value: postgres\n        - name: SCALOCK_AUDIT_DBPASSWORD\n          valueFrom:\n            secretKeyRef:\n              key: password\n              name: aqua-db\n        - name: SCALOCK_AUDIT_DBNAME\n          value: slk_audit\n        - name: SCALOCK_AUDIT_DBHOST\n          value: aqua-db\n        - name: SCALOCK_AUDIT_DBPORT\n          value: '5432'\n        ports:\n        - containerPort: 3622\n          protocol: TCP\n        - containerPort: 8443\n          protocol: TCP\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "04691",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: aqua-gateway\n  name: aqua-gateway\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: aqua-gateway\n  template:\n    metadata:\n      labels:\n        app: aqua-gateway\n      name: aqua-gateway\n    spec:\n      serviceAccount: aqua-sa\n      containers:\n      - name: aqua-gateway\n        image: registry.aquasec.com/gateway:6.5\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        env:\n        - name: AQUA_CONSOLE_SECURE_ADDRESS\n          value: aqua-web:443\n        - name: SCALOCK_GATEWAY_PUBLIC_IP\n          value: aqua-gateway\n        - name: SCALOCK_DBUSER\n          value: postgres\n        - name: SCALOCK_DBPASSWORD\n          valueFrom:\n            secretKeyRef:\n              key: password\n              name: aqua-db\n        - name: SCALOCK_DBNAME\n          value: scalock\n        - name: SCALOCK_DBHOST\n          value: aqua-db\n        - name: SCALOCK_DBPORT\n          value: '5432'\n        - name: SCALOCK_AUDIT_DBUSER\n          value: postgres\n        - name: SCALOCK_AUDIT_DBPASSWORD\n          valueFrom:\n            secretKeyRef:\n              key: password\n              name: aqua-db\n        - name: SCALOCK_AUDIT_DBNAME\n          value: slk_audit\n        - name: SCALOCK_AUDIT_DBHOST\n          value: aqua-db\n        - name: SCALOCK_AUDIT_DBPORT\n          value: '5432'\n        ports:\n        - containerPort: 3622\n          protocol: TCP\n        - containerPort: 8443\n          protocol: TCP\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "04692",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: loadgenerator\nspec:\n  selector:\n    matchLabels:\n      app: loadgenerator\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: loadgenerator\n        version: v1\n      annotations:\n        sidecar.istio.io/rewriteAppHTTPProbers: 'true'\n    spec:\n      containers:\n      - name: main\n        image: sitaramiyer/bookstore-demo:loadgenerator-v0.1.2\n        env:\n        - name: FRONTEND_ADDR\n          value: frontend:80\n        - name: USERS\n          value: '10'\n        resources:\n          requests:\n            cpu: 300m\n            memory: 256Mi\n          limits:\n            cpu: 500m\n            memory: 512Mi\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "04693",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: loadgenerator\nspec:\n  selector:\n    matchLabels:\n      app: loadgenerator\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: loadgenerator\n        version: v1\n      annotations:\n        sidecar.istio.io/rewriteAppHTTPProbers: 'true'\n    spec:\n      containers:\n      - name: main\n        image: sitaramiyer/bookstore-demo:loadgenerator-v0.1.2\n        env:\n        - name: FRONTEND_ADDR\n          value: frontend:80\n        - name: USERS\n          value: '10'\n        resources:\n          requests:\n            cpu: 300m\n            memory: 256Mi\n          limits:\n            cpu: 500m\n            memory: 512Mi\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "04694",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: CronJob\nmetadata:\n  name: import-named-polls-cronjob\nspec:\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          containers:\n          - name: import-named-polls\n            image: docker.pkg.github.com/demokratie-live/democracy-development/import-named-polls:0.1.2\n            env:\n            - name: DB_URL\n              valueFrom:\n                configMapKeyRef:\n                  name: bio-api-config\n                  key: DB_URL\n            securityContext:\n              readOnlyRootFilesystem: true\n              privileged: false\n              capabilities:\n                drop:\n                - NET_RAW\n                - NET_ADMIN\n                - SYS_ADMIN\n                - SYS_MODULE\n                - SYS_PTRACE\n                - SYS_CHROOT\n              allowPrivilegeEscalation: false\n              runAsNonRoot: true\n            resources:\n              requests:\n                cpu: 100m\n                memory: 128Mi\n              limits:\n                cpu: 500m\n                memory: 256Mi\n          restartPolicy: OnFailure\n  schedule: 0 0 * * *\n",
    "errors": []
  },
  {
    "id": "04695",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: CronJob\nmetadata:\n  name: import-named-polls-cronjob\nspec:\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          containers:\n          - name: import-named-polls\n            image: docker.pkg.github.com/demokratie-live/democracy-development/import-named-polls:0.1.2\n            env:\n            - name: DB_URL\n              valueFrom:\n                configMapKeyRef:\n                  name: bio-api-config\n                  key: DB_URL\n            securityContext:\n              runAsNonRoot: true\n              privileged: false\n              capabilities:\n                drop:\n                - NET_RAW\n                - NET_ADMIN\n                - SYS_ADMIN\n                - SYS_MODULE\n                - SYS_PTRACE\n                - SYS_CHROOT\n              allowPrivilegeEscalation: false\n              readOnlyRootFilesystem: true\n            resources:\n              requests:\n                cpu: 100m\n                memory: 128Mi\n              limits:\n                cpu: 500m\n                memory: 256Mi\n          restartPolicy: OnFailure\n  schedule: 0 0 * * *\n",
    "errors": []
  },
  {
    "id": "04696",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: CronJob\nmetadata:\n  name: import-named-polls-cronjob\nspec:\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          containers:\n          - name: import-named-polls\n            image: docker.pkg.github.com/demokratie-live/democracy-development/import-named-polls:0.1.2\n            env:\n            - name: DB_URL\n              valueFrom:\n                configMapKeyRef:\n                  name: bio-api-config\n                  key: DB_URL\n            resources:\n              requests:\n                cpu: 100m\n                memory: 128Mi\n              limits:\n                cpu: 500m\n                memory: 256Mi\n            securityContext:\n              privileged: false\n              capabilities:\n                drop:\n                - NET_RAW\n                - NET_ADMIN\n                - SYS_ADMIN\n                - SYS_MODULE\n                - SYS_PTRACE\n                - SYS_CHROOT\n              allowPrivilegeEscalation: false\n              runAsNonRoot: true\n              readOnlyRootFilesystem: true\n          restartPolicy: OnFailure\n  schedule: 0 0 * * *\n",
    "errors": []
  },
  {
    "id": "04697",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: CronJob\nmetadata:\n  name: import-named-polls-cronjob\nspec:\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          containers:\n          - name: import-named-polls\n            image: docker.pkg.github.com/demokratie-live/democracy-development/import-named-polls:0.1.2\n            env:\n            - name: DB_URL\n              valueFrom:\n                configMapKeyRef:\n                  name: bio-api-config\n                  key: DB_URL\n            resources:\n              requests:\n                cpu: 100m\n                memory: 128Mi\n              limits:\n                cpu: 500m\n                memory: 256Mi\n            securityContext:\n              privileged: false\n              capabilities:\n                drop:\n                - NET_RAW\n                - NET_ADMIN\n                - SYS_ADMIN\n                - SYS_MODULE\n                - SYS_PTRACE\n                - SYS_CHROOT\n              allowPrivilegeEscalation: false\n              runAsNonRoot: true\n              readOnlyRootFilesystem: true\n          restartPolicy: OnFailure\n  schedule: 0 0 * * *\n",
    "errors": []
  },
  {
    "id": "04698",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: kubia-deploy\n  namespace: chp16-set1612\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: kubia-deploy\n  template:\n    metadata:\n      name: kubia-deploy\n      labels:\n        app: kubia-deploy\n    spec:\n      securityContext:\n        runAsUser: 1000\n        runAsNonRoot: true\n      serviceAccountName: foo\n      containers:\n      - image: georgebaptista/kubia:stable\n        name: kubia-deploy\n        securityContext:\n          allowPrivilegeEscalation: false\n          privileged: false\n          runAsNonRoot: true\n          runAsUser: 1000\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          readOnlyRootFilesystem: true\n        resources:\n          limits:\n            cpu: 200m\n            memory: 256Mi\n          requests:\n            cpu: 100m\n            memory: 128Mi\n",
    "errors": []
  },
  {
    "id": "04699",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: kubia-deploy\n  namespace: chp16-set1612\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: kubia-deploy\n  template:\n    metadata:\n      name: kubia-deploy\n      labels:\n        app: kubia-deploy\n    spec:\n      securityContext:\n        runAsUser: 1000\n        runAsNonRoot: true\n      serviceAccountName: foo\n      containers:\n      - image: georgebaptista/kubia:stable\n        name: kubia-deploy\n        securityContext:\n          allowPrivilegeEscalation: false\n          privileged: false\n          runAsNonRoot: true\n          runAsUser: 1000\n          readOnlyRootFilesystem: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n        resources:\n          limits:\n            cpu: 200m\n            memory: 256Mi\n          requests:\n            cpu: 100m\n            memory: 128Mi\n",
    "errors": []
  },
  {
    "id": "04700",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: kubia-deploy\n  namespace: chp16-set1612\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: kubia-deploy\n  template:\n    metadata:\n      name: kubia-deploy\n      labels:\n        app: kubia-deploy\n    spec:\n      securityContext:\n        runAsUser: 1000\n        runAsNonRoot: true\n      serviceAccountName: foo\n      containers:\n      - image: georgebaptista/kubia:stable\n        name: kubia-deploy\n        securityContext:\n          allowPrivilegeEscalation: false\n          privileged: false\n          runAsNonRoot: true\n          runAsUser: 1000\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          readOnlyRootFilesystem: true\n        resources:\n          limits:\n            cpu: 200m\n            memory: 256Mi\n          requests:\n            cpu: 100m\n            memory: 128Mi\n",
    "errors": []
  },
  {
    "id": "04701",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: dss\n  labels:\n    app: dss\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: dss\n  template:\n    metadata:\n      labels:\n        app: dss\n    spec:\n      securityContext:\n        fsGroup: 1000\n      containers:\n      - name: dss\n        image: dss-node-image:stable\n        imagePullPolicy: Always\n        command:\n        - /bin/bash\n        args:\n        - -ci\n        - ./startup.sh\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        - name: DOCKER_HOST\n          value: tcp://localhost:2375\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - name: kubectl-config\n          mountPath: /home/ubuntu/.kube\n        - name: shared-storage\n          mountPath: /share\n        - name: gitlab-registry-cred\n          mountPath: /gitlab-repo/credentials\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - name: dind\n        image: docker:19.03.9-dind\n        resources:\n          requests:\n            cpu: 250m\n            memory: 250Mi\n          limits:\n            cpu: 250m\n            memory: 250Mi\n        env:\n        - name: DOCKER_TLS_CERTDIR\n          value: ''\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - name: docker-storage\n          mountPath: /var/lib/docker\n      - name: dood\n        image: docker:19.03.8\n        command:\n        - tail\n        - -f\n        - /dev/null\n        resources:\n          requests:\n            cpu: 200m\n            memory: 250Mi\n          limits:\n            cpu: 200m\n            memory: 250Mi\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        envFrom:\n        - secretRef:\n            name: gitlab-registry-cred\n        volumeMounts:\n        - name: docker-sock\n          mountPath: /var/run\n        - name: shared-storage\n          mountPath: /share\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: docker-storage\n        emptyDir: {}\n      - name: docker-sock\n        emptyDir: {}\n      - name: shared-storage\n        emptyDir: {}\n      - name: kubectl-config\n        secret:\n          secretName: kubectl-config\n          defaultMode: 256\n      - name: gitlab-registry-cred\n        secret:\n          secretName: gitlab-registry-cred\n",
    "errors": []
  },
  {
    "id": "04702",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: dss\n  labels:\n    app: dss\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: dss\n  template:\n    metadata:\n      labels:\n        app: dss\n    spec:\n      securityContext:\n        fsGroup: 1000\n      containers:\n      - name: dss\n        image: dss-node-image:stable\n        imagePullPolicy: Always\n        command:\n        - /bin/bash\n        args:\n        - -ci\n        - ./startup.sh\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        - name: DOCKER_HOST\n          value: tcp://localhost:2375\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        securityContext:\n          privileged: false\n          readOnlyRootFilesystem: true\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n        volumeMounts:\n        - name: kubectl-config\n          mountPath: /home/ubuntu/.kube\n        - name: shared-storage\n          mountPath: /share\n        - name: gitlab-registry-cred\n          mountPath: /gitlab-repo/credentials\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - name: dind\n        image: docker:19.03.9-dind\n        resources:\n          requests:\n            cpu: 250m\n            memory: 250Mi\n          limits:\n            cpu: 250m\n            memory: 250Mi\n        env:\n        - name: DOCKER_TLS_CERTDIR\n          value: ''\n        securityContext:\n          privileged: false\n          readOnlyRootFilesystem: true\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n        volumeMounts:\n        - name: docker-storage\n          mountPath: /var/lib/docker\n      - name: dood\n        image: docker:19.03.8\n        command:\n        - tail\n        - -f\n        - /dev/null\n        resources:\n          requests:\n            cpu: 200m\n            memory: 250Mi\n          limits:\n            cpu: 200m\n            memory: 250Mi\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        envFrom:\n        - secretRef:\n            name: gitlab-registry-cred\n        volumeMounts:\n        - name: docker-sock\n          mountPath: /var/run\n        - name: shared-storage\n          mountPath: /share\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n      volumes:\n      - name: docker-storage\n        emptyDir: {}\n      - name: docker-sock\n        emptyDir: {}\n      - name: shared-storage\n        emptyDir: {}\n      - name: kubectl-config\n        secret:\n          secretName: kubectl-config\n          defaultMode: 256\n      - name: gitlab-registry-cred\n        secret:\n          secretName: gitlab-registry-cred\n",
    "errors": []
  },
  {
    "id": "04703",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: dss\n  labels:\n    app: dss\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: dss\n  template:\n    metadata:\n      labels:\n        app: dss\n    spec:\n      securityContext:\n        fsGroup: 1000\n      containers:\n      - name: dss\n        image: dss-node-image:stable\n        imagePullPolicy: Always\n        command:\n        - /bin/bash\n        args:\n        - -ci\n        - ./startup.sh\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        - name: DOCKER_HOST\n          value: tcp://localhost:2375\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        securityContext:\n          privileged: false\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n        volumeMounts:\n        - name: kubectl-config\n          mountPath: /home/ubuntu/.kube\n        - name: shared-storage\n          mountPath: /share\n        - name: gitlab-registry-cred\n          mountPath: /gitlab-repo/credentials\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - name: dind\n        image: docker:19.03.9-dind\n        resources:\n          requests:\n            cpu: 250m\n            memory: 250Mi\n          limits:\n            cpu: 250m\n            memory: 250Mi\n        env:\n        - name: DOCKER_TLS_CERTDIR\n          value: ''\n        securityContext:\n          privileged: false\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n        volumeMounts:\n        - name: docker-storage\n          mountPath: /var/lib/docker\n      - name: dood\n        image: docker:19.03.8\n        command:\n        - tail\n        - -f\n        - /dev/null\n        resources:\n          requests:\n            cpu: 200m\n            memory: 250Mi\n          limits:\n            cpu: 200m\n            memory: 250Mi\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        envFrom:\n        - secretRef:\n            name: gitlab-registry-cred\n        volumeMounts:\n        - name: docker-sock\n          mountPath: /var/run\n        - name: shared-storage\n          mountPath: /share\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n      volumes:\n      - name: docker-storage\n        emptyDir: {}\n      - name: docker-sock\n        emptyDir: {}\n      - name: shared-storage\n        emptyDir: {}\n      - name: kubectl-config\n        secret:\n          secretName: kubectl-config\n          defaultMode: 256\n      - name: gitlab-registry-cred\n        secret:\n          secretName: gitlab-registry-cred\n",
    "errors": []
  },
  {
    "id": "04704",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: dss\n  labels:\n    app: dss\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: dss\n  template:\n    metadata:\n      labels:\n        app: dss\n    spec:\n      securityContext:\n        fsGroup: 1000\n      containers:\n      - name: dss\n        image: dss-node-image:stable\n        imagePullPolicy: Always\n        command:\n        - /bin/bash\n        args:\n        - -ci\n        - ./startup.sh\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        - name: DOCKER_HOST\n          value: tcp://localhost:2375\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        securityContext:\n          privileged: false\n          readOnlyRootFilesystem: true\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n        volumeMounts:\n        - name: kubectl-config\n          mountPath: /home/ubuntu/.kube\n        - name: shared-storage\n          mountPath: /share\n        - name: gitlab-registry-cred\n          mountPath: /gitlab-repo/credentials\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - name: dind\n        image: docker:19.03.9-dind\n        resources:\n          requests:\n            cpu: 250m\n            memory: 250Mi\n          limits:\n            cpu: 250m\n            memory: 250Mi\n        env:\n        - name: DOCKER_TLS_CERTDIR\n          value: ''\n        securityContext:\n          privileged: false\n          readOnlyRootFilesystem: true\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n        volumeMounts:\n        - name: docker-storage\n          mountPath: /var/lib/docker\n      - name: dood\n        image: docker:19.03.8\n        command:\n        - tail\n        - -f\n        - /dev/null\n        resources:\n          requests:\n            cpu: 200m\n            memory: 250Mi\n          limits:\n            cpu: 200m\n            memory: 250Mi\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        envFrom:\n        - secretRef:\n            name: gitlab-registry-cred\n        volumeMounts:\n        - name: docker-sock\n          mountPath: /var/run\n        - name: shared-storage\n          mountPath: /share\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n      volumes:\n      - name: docker-storage\n        emptyDir: {}\n      - name: docker-sock\n        emptyDir: {}\n      - name: shared-storage\n        emptyDir: {}\n      - name: kubectl-config\n        secret:\n          secretName: kubectl-config\n          defaultMode: 256\n      - name: gitlab-registry-cred\n        secret:\n          secretName: gitlab-registry-cred\n",
    "errors": []
  },
  {
    "id": "04705",
    "policy_id": "drop_capabilities",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: dss\n  labels:\n    app: dss\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: dss\n  template:\n    metadata:\n      labels:\n        app: dss\n    spec:\n      securityContext:\n        fsGroup: 1000\n      containers:\n      - name: dss\n        image: dss-node-image:stable\n        imagePullPolicy: Always\n        command:\n        - /bin/bash\n        args:\n        - -ci\n        - ./startup.sh\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        - name: DOCKER_HOST\n          value: tcp://localhost:2375\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        securityContext:\n          privileged: false\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n        volumeMounts:\n        - name: kubectl-config\n          mountPath: /home/ubuntu/.kube\n        - name: shared-storage\n          mountPath: /share\n        - name: gitlab-registry-cred\n          mountPath: /gitlab-repo/credentials\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - name: dind\n        image: docker:19.03.9-dind\n        resources:\n          requests:\n            cpu: 250m\n            memory: 250Mi\n          limits:\n            cpu: 250m\n            memory: 250Mi\n        env:\n        - name: DOCKER_TLS_CERTDIR\n          value: ''\n        securityContext:\n          privileged: false\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n        volumeMounts:\n        - name: docker-storage\n          mountPath: /var/lib/docker\n      - name: dood\n        image: docker:19.03.8\n        command:\n        - tail\n        - -f\n        - /dev/null\n        resources:\n          requests:\n            cpu: 200m\n            memory: 250Mi\n          limits:\n            cpu: 200m\n            memory: 250Mi\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        envFrom:\n        - secretRef:\n            name: gitlab-registry-cred\n        volumeMounts:\n        - name: docker-sock\n          mountPath: /var/run\n        - name: shared-storage\n          mountPath: /share\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: docker-storage\n        emptyDir: {}\n      - name: docker-sock\n        emptyDir: {}\n      - name: shared-storage\n        emptyDir: {}\n      - name: kubectl-config\n        secret:\n          secretName: kubectl-config\n          defaultMode: 256\n      - name: gitlab-registry-cred\n        secret:\n          secretName: gitlab-registry-cred\n",
    "errors": []
  },
  {
    "id": "04706",
    "policy_id": "drop_capabilities",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: dss\n  labels:\n    app: dss\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: dss\n  template:\n    metadata:\n      labels:\n        app: dss\n    spec:\n      securityContext:\n        fsGroup: 1000\n      containers:\n      - name: dss\n        image: dss-node-image:stable\n        imagePullPolicy: Always\n        command:\n        - /bin/bash\n        args:\n        - -ci\n        - ./startup.sh\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        - name: DOCKER_HOST\n          value: tcp://localhost:2375\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        securityContext:\n          privileged: false\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          runAsNonRoot: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n        volumeMounts:\n        - name: kubectl-config\n          mountPath: /home/ubuntu/.kube\n        - name: shared-storage\n          mountPath: /share\n        - name: gitlab-registry-cred\n          mountPath: /gitlab-repo/credentials\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - name: dind\n        image: docker:19.03.9-dind\n        resources:\n          requests:\n            cpu: 250m\n            memory: 250Mi\n          limits:\n            cpu: 250m\n            memory: 250Mi\n        env:\n        - name: DOCKER_TLS_CERTDIR\n          value: ''\n        securityContext:\n          privileged: false\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          runAsNonRoot: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n        volumeMounts:\n        - name: docker-storage\n          mountPath: /var/lib/docker\n      - name: dood\n        image: docker:19.03.8\n        command:\n        - tail\n        - -f\n        - /dev/null\n        resources:\n          requests:\n            cpu: 200m\n            memory: 250Mi\n          limits:\n            cpu: 200m\n            memory: 250Mi\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        envFrom:\n        - secretRef:\n            name: gitlab-registry-cred\n        volumeMounts:\n        - name: docker-sock\n          mountPath: /var/run\n        - name: shared-storage\n          mountPath: /share\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: docker-storage\n        emptyDir: {}\n      - name: docker-sock\n        emptyDir: {}\n      - name: shared-storage\n        emptyDir: {}\n      - name: kubectl-config\n        secret:\n          secretName: kubectl-config\n          defaultMode: 256\n      - name: gitlab-registry-cred\n        secret:\n          secretName: gitlab-registry-cred\n",
    "errors": []
  },
  {
    "id": "04707",
    "policy_id": "no_privileged",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed: The Deployment \"dss\" is invalid: \n* spec.template.spec.volumes[1].name: Required value\n* spec.template.spec.containers[2].volumeMounts[0].name: Not found: \"docker-sock\""
    ]
  },
  {
    "id": "04708",
    "policy_id": "no_privileged",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: dss\n  labels:\n    app: dss\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: dss\n  template:\n    metadata:\n      labels:\n        app: dss\n    spec:\n      securityContext:\n        fsGroup: 1000\n      containers:\n      - name: dss\n        image: dss-node-image:stable\n        imagePullPolicy: Always\n        command:\n        - /bin/bash\n        args:\n        - -ci\n        - ./startup.sh\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        - name: DOCKER_HOST\n          value: tcp://localhost:2375\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        securityContext:\n          privileged: false\n          runAsNonRoot: true\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n        volumeMounts:\n        - name: kubectl-config\n          mountPath: /home/ubuntu/.kube\n        - name: shared-storage\n          mountPath: /share\n        - name: gitlab-registry-cred\n          mountPath: /gitlab-repo/credentials\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - name: dind\n        image: docker:19.03.9-dind\n        resources:\n          requests:\n            cpu: 250m\n            memory: 250Mi\n          limits:\n            cpu: 250m\n            memory: 250Mi\n        env:\n        - name: DOCKER_TLS_CERTDIR\n          value: ''\n        securityContext:\n          privileged: false\n          runAsNonRoot: true\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n        volumeMounts:\n        - name: docker-storage\n          mountPath: /var/lib/docker\n      - name: dood\n        image: docker:19.03.8\n        command:\n        - tail\n        - -f\n        - /dev/null\n        resources:\n          requests:\n            cpu: 200m\n            memory: 250Mi\n          limits:\n            cpu: 200m\n            memory: 250Mi\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        envFrom:\n        - secretRef:\n            name: gitlab-registry-cred\n        volumeMounts:\n        - name: docker-sock\n          mountPath: /var/run\n        - name: shared-storage\n          mountPath: /share\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: docker-storage\n        emptyDir: {}\n      - name: docker-sock\n        emptyDir: {}\n      - name: shared-storage\n        emptyDir: {}\n      - name: kubectl-config\n        secret:\n          secretName: kubectl-config\n          defaultMode: 256\n      - name: gitlab-registry-cred\n        secret:\n          secretName: gitlab-registry-cred\n",
    "errors": []
  },
  {
    "id": "04709",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: dss\n  labels:\n    app: dss\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: dss\n  template:\n    metadata:\n      labels:\n        app: dss\n    spec:\n      securityContext:\n        fsGroup: 1000\n      containers:\n      - name: dss\n        image: dss-node-image:stable\n        imagePullPolicy: Always\n        command:\n        - /bin/bash\n        args:\n        - -ci\n        - ./startup.sh\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        - name: DOCKER_HOST\n          value: tcp://localhost:2375\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        securityContext:\n          privileged: false\n          runAsNonRoot: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - name: kubectl-config\n          mountPath: /home/ubuntu/.kube\n        - name: shared-storage\n          mountPath: /share\n        - name: gitlab-registry-cred\n          mountPath: /gitlab-repo/credentials\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - name: dind\n        image: docker:19.03.9-dind\n        resources:\n          requests:\n            cpu: 250m\n            memory: 250Mi\n          limits:\n            cpu: 250m\n            memory: 250Mi\n        env:\n        - name: DOCKER_TLS_CERTDIR\n          value: ''\n        securityContext:\n          privileged: false\n          runAsNonRoot: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - name: docker-storage\n          mountPath: /var/lib/docker\n      - name: dood\n        image: docker:19.03.8\n        command:\n        - tail\n        - -f\n        - /dev/null\n        resources:\n          requests:\n            cpu: 200m\n            memory: 250Mi\n          limits:\n            cpu: 200m\n            memory: 250Mi\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        envFrom:\n        - secretRef:\n            name: gitlab-registry-cred\n        volumeMounts:\n        - name: docker-sock\n          mountPath: /var/run\n        - name: shared-storage\n          mountPath: /share\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: docker-storage\n        emptyDir: {}\n      - name: docker-sock\n        emptyDir: {}\n      - name: shared-storage\n        emptyDir: {}\n      - name: kubectl-config\n        secret:\n          secretName: kubectl-config\n          defaultMode: 256\n      - name: gitlab-registry-cred\n        secret:\n          secretName: gitlab-registry-cred\n",
    "errors": []
  },
  {
    "id": "04710",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: dss\n  labels:\n    app: dss\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: dss\n  template:\n    metadata:\n      labels:\n        app: dss\n    spec:\n      securityContext:\n        fsGroup: 1000\n        runAsNonRoot: true\n      containers:\n      - name: dss\n        image: dss-node-image:stable\n        imagePullPolicy: Always\n        command:\n        - /bin/bash\n        args:\n        - -ci\n        - ./startup.sh\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        - name: DOCKER_HOST\n          value: tcp://localhost:2375\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        securityContext:\n          privileged: false\n          runAsNonRoot: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - name: kubectl-config\n          mountPath: /home/ubuntu/.kube\n        - name: shared-storage\n          mountPath: /share\n        - name: gitlab-registry-cred\n          mountPath: /gitlab-repo/credentials\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - name: dind\n        image: docker:19.03.9-dind\n        resources:\n          requests:\n            cpu: 250m\n            memory: 250Mi\n          limits:\n            cpu: 250m\n            memory: 250Mi\n        env:\n        - name: DOCKER_TLS_CERTDIR\n          value: ''\n        securityContext:\n          privileged: false\n          runAsNonRoot: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - name: docker-storage\n          mountPath: /var/lib/docker\n      - name: dood\n        image: docker:19.03.8\n        command:\n        - tail\n        - -f\n        - /dev/null\n        resources:\n          requests:\n            cpu: 200m\n            memory: 250Mi\n          limits:\n            cpu: 200m\n            memory: 250Mi\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        envFrom:\n        - secretRef:\n            name: gitlab-registry-cred\n        volumeMounts:\n        - name: docker-sock\n          mountPath: /var/run\n        - name: shared-storage\n          mountPath: /share\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: docker-storage\n        emptyDir: {}\n      - name: docker-sock\n        emptyDir: {}\n      - name: shared-storage\n        emptyDir: {}\n      - name: kubectl-config\n        secret:\n          secretName: kubectl-config\n          defaultMode: 256\n      - name: gitlab-registry-cred\n        secret:\n          secretName: gitlab-registry-cred\n",
    "errors": []
  },
  {
    "id": "04711",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: dss\n  labels:\n    app: dss\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: dss\n  template:\n    metadata:\n      labels:\n        app: dss\n    spec:\n      securityContext:\n        fsGroup: 1000\n        runAsNonRoot: true\n      containers:\n      - name: dss\n        image: dss-node-image:stable\n        imagePullPolicy: Always\n        command:\n        - /bin/bash\n        args:\n        - -ci\n        - ./startup.sh\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        - name: DOCKER_HOST\n          value: tcp://localhost:2375\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        securityContext:\n          privileged: false\n          runAsNonRoot: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - name: kubectl-config\n          mountPath: /home/ubuntu/.kube\n        - name: shared-storage\n          mountPath: /share\n        - name: gitlab-registry-cred\n          mountPath: /gitlab-repo/credentials\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - name: dind\n        image: docker:19.03.9-dind\n        resources:\n          requests:\n            cpu: 250m\n            memory: 250Mi\n          limits:\n            cpu: 250m\n            memory: 250Mi\n        env:\n        - name: DOCKER_TLS_CERTDIR\n          value: ''\n        securityContext:\n          privileged: false\n          runAsNonRoot: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - name: docker-storage\n          mountPath: /var/lib/docker\n      - name: dood\n        image: docker:19.03.8\n        command:\n        - tail\n        - -f\n        - /dev/null\n        resources:\n          requests:\n            cpu: 200m\n            memory: 250Mi\n          limits:\n            cpu: 200m\n            memory: 250Mi\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        envFrom:\n        - secretRef:\n            name: gitlab-registry-cred\n        volumeMounts:\n        - name: docker-sock\n          mountPath: /var/run\n        - name: shared-storage\n          mountPath: /share\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: docker-storage\n        emptyDir: {}\n      - name: docker-sock\n        emptyDir: {}\n      - name: shared-storage\n        emptyDir: {}\n      - name: kubectl-config\n        secret:\n          secretName: kubectl-config\n          defaultMode: 256\n      - name: gitlab-registry-cred\n        secret:\n          secretName: gitlab-registry-cred\n",
    "errors": []
  },
  {
    "id": "04712",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: dss\n  labels:\n    app: dss\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: dss\n  template:\n    metadata:\n      labels:\n        app: dss\n    spec:\n      securityContext:\n        fsGroup: 1000\n      containers:\n      - name: dss\n        image: dss-node-image:stable\n        imagePullPolicy: Always\n        command:\n        - /bin/bash\n        args:\n        - -ci\n        - ./startup.sh\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        - name: DOCKER_HOST\n          value: tcp://localhost:2375\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - name: kubectl-config\n          mountPath: /home/ubuntu/.kube\n        - name: shared-storage\n          mountPath: /share\n        - name: gitlab-registry-cred\n          mountPath: /gitlab-repo/credentials\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - name: dind\n        image: docker:19.03.9-dind\n        resources:\n          requests:\n            cpu: 250m\n            memory: 250Mi\n          limits:\n            cpu: 250m\n            memory: 250Mi\n        env:\n        - name: DOCKER_TLS_CERTDIR\n          value: ''\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - name: docker-storage\n          mountPath: /var/lib/docker\n      - name: dood\n        image: docker:19.03.8\n        command:\n        - tail\n        - -f\n        - /dev/null\n        resources:\n          requests:\n            cpu: 200m\n            memory: 250Mi\n          limits:\n            cpu: 200m\n            memory: 250Mi\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        envFrom:\n        - secretRef:\n            name: gitlab-registry-cred\n        volumeMounts:\n        - name: docker-sock\n          mountPath: /var/run\n        - name: shared-storage\n          mountPath: /share\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: docker-storage\n        emptyDir: {}\n      - name: docker-sock\n        emptyDir: {}\n      - name: shared-storage\n        emptyDir: {}\n      - name: kubectl-config\n        secret:\n          secretName: kubectl-config\n          defaultMode: 256\n      - name: gitlab-registry-cred\n        secret:\n          secretName: gitlab-registry-cred\n",
    "errors": []
  },
  {
    "id": "04713",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: dss\n  labels:\n    app: dss\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: dss\n  template:\n    metadata:\n      labels:\n        app: dss\n    spec:\n      securityContext:\n        fsGroup: 1000\n      containers:\n      - name: dss\n        image: dss-node-image:stable\n        imagePullPolicy: Always\n        command:\n        - /bin/bash\n        args:\n        - -ci\n        - ./startup.sh\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        - name: DOCKER_HOST\n          value: tcp://localhost:2375\n        - name: POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - name: kubectl-config\n          mountPath: /home/ubuntu/.kube\n        - name: shared-storage\n          mountPath: /share\n        - name: gitlab-registry-cred\n          mountPath: /gitlab-repo/credentials\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - name: dind\n        image: docker:19.03.9-dind\n        resources:\n          requests:\n            cpu: 250m\n            memory: 250Mi\n          limits:\n            cpu: 250m\n            memory: 250Mi\n        env:\n        - name: DOCKER_TLS_CERTDIR\n          value: ''\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - name: docker-storage\n          mountPath: /var/lib/docker\n      - name: dood\n        image: docker:19.03.8\n        command:\n        - tail\n        - -f\n        - /dev/null\n        resources:\n          requests:\n            cpu: 200m\n            memory: 250Mi\n          limits:\n            cpu: 200m\n            memory: 250Mi\n        env:\n        - name: DSS_NODE_TYPE\n          valueFrom:\n            configMapKeyRef:\n              name: dss-node-type\n              key: DSS_NODE_TYPE\n        envFrom:\n        - secretRef:\n            name: gitlab-registry-cred\n        volumeMounts:\n        - name: docker-sock\n          mountPath: /var/run\n        - name: shared-storage\n          mountPath: /share\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      volumes:\n      - name: docker-storage\n        emptyDir: {}\n      - name: docker-sock\n        emptyDir: {}\n      - name: shared-storage\n        emptyDir: {}\n      - name: kubectl-config\n        secret:\n          secretName: kubectl-config\n          defaultMode: 256\n      - name: gitlab-registry-cred\n        secret:\n          secretName: gitlab-registry-cred\n",
    "errors": []
  },
  {
    "id": "04714",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  labels:\n    aci-containers-config-version: dummy\n    network-plugin: aci-containers\n  name: aci-containers-host\n  namespace: aci-containers-system\nspec:\n  selector:\n    matchLabels:\n      name: aci-containers-host\n      network-plugin: aci-containers\n  template:\n    metadata:\n      annotations:\n        prometheus.io/port: '9612'\n        prometheus.io/scrape: 'true'\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n      labels:\n        name: aci-containers-host\n        network-plugin: aci-containers\n    spec:\n      containers:\n      - env:\n        - name: KUBERNETES_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: TENANT\n          value: csrtest\n        - name: NODE_EPG\n          value: aci-containers-nodes\n        - name: OPFLEX_MODE\n          value: overlay\n        - name: DURATION_WAIT_FOR_NETWORK\n          value: '210'\n        image: noirolabs/aci-containers-host:ci_test\n        imagePullPolicy: Always\n        livenessProbe:\n          failureThreshold: 10\n          httpGet:\n            path: /status\n            port: 8090\n            scheme: HTTP\n          initialDelaySeconds: 120\n          periodSeconds: 60\n          successThreshold: 1\n          timeoutSeconds: 30\n        name: aci-containers-host\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          readOnlyRootFilesystem: true\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        volumeMounts:\n        - mountPath: /mnt/cni-bin\n          name: cni-bin\n        - mountPath: /mnt/cni-conf\n          name: cni-conf\n        - mountPath: /usr/local/var\n          name: hostvar\n        - mountPath: /run\n          name: hostrun\n        - mountPath: /usr/local/run\n          name: hostrun\n        - mountPath: /usr/local/etc/opflex-agent-ovs/base-conf.d\n          name: opflex-hostconfig-volume\n        - mountPath: /usr/local/etc/aci-containers/\n          name: host-config-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - env:\n        - name: REBOOT_WITH_OVS\n          value: 'true'\n        - name: SSL_MODE\n          value: disabled\n        image: noirolabs/opflex:ci_test\n        imagePullPolicy: Always\n        name: opflex-agent\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          readOnlyRootFilesystem: true\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        volumeMounts:\n        - mountPath: /usr/local/var\n          name: hostvar\n        - mountPath: /run\n          name: hostrun\n        - mountPath: /usr/local/run\n          name: hostrun\n        - mountPath: /usr/local/etc/opflex-agent-ovs/base-conf.d\n          name: opflex-hostconfig-volume\n        - mountPath: /usr/local/etc/opflex-agent-ovs/conf.d\n          name: opflex-config-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - args:\n        - /usr/local/bin/launch-opflexserver.sh\n        command:\n        - /bin/sh\n        image: noirolabs/opflex:ci_test\n        imagePullPolicy: Always\n        name: opflex-server\n        ports:\n        - containerPort: 19999\n        - containerPort: 9632\n          name: metrics\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          readOnlyRootFilesystem: true\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        volumeMounts:\n        - mountPath: /usr/local/etc/opflex-server\n          name: opflex-server-config-volume\n        - mountPath: /usr/local/var\n          name: hostvar\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      initContainers:\n      - image: noirolabs/cnideploy:6.0.0.0.0ef4718\n        imagePullPolicy: Always\n        name: cnideploy\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          readOnlyRootFilesystem: true\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        volumeMounts:\n        - mountPath: /mnt/cni-bin\n          name: cni-bin\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      serviceAccountName: aci-containers-host-agent\n      volumes:\n      - hostPath:\n          path: /var/lib\n        name: cni-bin\n      - hostPath:\n          path: /etc/kubernetes\n        name: cni-conf\n      - hostPath:\n          path: /var\n        name: hostvar\n      - hostPath:\n          path: /run\n        name: hostrun\n      - configMap:\n          items:\n          - key: host-agent-config\n            path: host-agent.conf\n          name: aci-containers-config\n        name: host-config-volume\n      - emptyDir:\n          medium: Memory\n        name: opflex-hostconfig-volume\n      - configMap:\n          items:\n          - key: opflex-agent-config\n            path: local.conf\n          name: aci-containers-config\n        name: opflex-config-volume\n      - name: opflex-server-config-volume\n",
    "errors": []
  },
  {
    "id": "04715",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  labels:\n    aci-containers-config-version: dummy\n    network-plugin: aci-containers\n  name: aci-containers-host\n  namespace: aci-containers-system\nspec:\n  selector:\n    matchLabels:\n      name: aci-containers-host\n      network-plugin: aci-containers\n  template:\n    metadata:\n      annotations:\n        prometheus.io/port: '9612'\n        prometheus.io/scrape: 'true'\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n      labels:\n        name: aci-containers-host\n        network-plugin: aci-containers\n    spec:\n      containers:\n      - env:\n        - name: KUBERNETES_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: TENANT\n          value: csrtest\n        - name: NODE_EPG\n          value: aci-containers-nodes\n        - name: OPFLEX_MODE\n          value: overlay\n        - name: DURATION_WAIT_FOR_NETWORK\n          value: '210'\n        image: noirolabs/aci-containers-host:ci_test\n        imagePullPolicy: Always\n        livenessProbe:\n          failureThreshold: 10\n          httpGet:\n            path: /status\n            port: 8090\n            scheme: HTTP\n          initialDelaySeconds: 120\n          periodSeconds: 60\n          successThreshold: 1\n          timeoutSeconds: 30\n        name: aci-containers-host\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          readOnlyRootFilesystem: true\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        volumeMounts:\n        - mountPath: /mnt/cni-bin\n          name: cni-bin\n        - mountPath: /mnt/cni-conf\n          name: cni-conf\n        - mountPath: /usr/local/var\n          name: hostvar\n        - mountPath: /run\n          name: hostrun\n        - mountPath: /usr/local/run\n          name: hostrun\n        - mountPath: /usr/local/etc/opflex-agent-ovs/base-conf.d\n          name: opflex-hostconfig-volume\n        - mountPath: /usr/local/etc/aci-containers/\n          name: host-config-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - env:\n        - name: REBOOT_WITH_OVS\n          value: 'true'\n        - name: SSL_MODE\n          value: disabled\n        image: noirolabs/opflex:ci_test\n        imagePullPolicy: Always\n        name: opflex-agent\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          readOnlyRootFilesystem: true\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        volumeMounts:\n        - mountPath: /usr/local/var\n          name: hostvar\n        - mountPath: /run\n          name: hostrun\n        - mountPath: /usr/local/run\n          name: hostrun\n        - mountPath: /usr/local/etc/opflex-agent-ovs/base-conf.d\n          name: opflex-hostconfig-volume\n        - mountPath: /usr/local/etc/opflex-agent-ovs/conf.d\n          name: opflex-config-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - args:\n        - /usr/local/bin/launch-opflexserver.sh\n        command:\n        - /bin/sh\n        image: noirolabs/opflex:ci_test\n        imagePullPolicy: Always\n        name: opflex-server\n        ports:\n        - containerPort: 19999\n        - containerPort: 9632\n          name: metrics\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          readOnlyRootFilesystem: true\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        volumeMounts:\n        - mountPath: /usr/local/etc/opflex-server\n          name: opflex-server-config-volume\n        - mountPath: /usr/local/var\n          name: hostvar\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      initContainers:\n      - image: noirolabs/cnideploy:6.0.0.0.0ef4718\n        imagePullPolicy: Always\n        name: cnideploy\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          readOnlyRootFilesystem: true\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        volumeMounts:\n        - mountPath: /mnt/cni-bin\n          name: cni-bin\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      serviceAccountName: aci-containers-host-agent\n      volumes:\n      - hostPath:\n          path: /var/lib\n        name: cni-bin\n      - hostPath:\n          path: /etc/kubernetes\n        name: cni-conf\n      - hostPath:\n          path: /var\n        name: hostvar\n      - hostPath:\n          path: /run\n        name: hostrun\n      - configMap:\n          items:\n          - key: host-agent-config\n            path: host-agent.conf\n          name: aci-containers-config\n        name: host-config-volume\n      - emptyDir:\n          medium: Memory\n        name: opflex-hostconfig-volume\n      - configMap:\n          items:\n          - key: opflex-agent-config\n            path: local.conf\n          name: aci-containers-config\n        name: opflex-config-volume\n      - name: opflex-server-config-volume\n",
    "errors": []
  },
  {
    "id": "04716",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  labels:\n    aci-containers-config-version: dummy\n    network-plugin: aci-containers\n  name: aci-containers-host\n  namespace: aci-containers-system\nspec:\n  selector:\n    matchLabels:\n      name: aci-containers-host\n      network-plugin: aci-containers\n  template:\n    metadata:\n      annotations:\n        prometheus.io/port: '9612'\n        prometheus.io/scrape: 'true'\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n      labels:\n        name: aci-containers-host\n        network-plugin: aci-containers\n    spec:\n      containers:\n      - env:\n        - name: KUBERNETES_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: TENANT\n          value: csrtest\n        - name: NODE_EPG\n          value: aci-containers-nodes\n        - name: OPFLEX_MODE\n          value: overlay\n        - name: DURATION_WAIT_FOR_NETWORK\n          value: '210'\n        image: noirolabs/aci-containers-host:ci_test\n        imagePullPolicy: Always\n        livenessProbe:\n          failureThreshold: 10\n          httpGet:\n            path: /status\n            port: 8090\n            scheme: HTTP\n          initialDelaySeconds: 120\n          periodSeconds: 60\n          successThreshold: 1\n          timeoutSeconds: 30\n        name: aci-containers-host\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          readOnlyRootFilesystem: true\n          allowPrivilegeEscalation: false\n          privileged: false\n          runAsNonRoot: true\n        volumeMounts:\n        - mountPath: /mnt/cni-bin\n          name: cni-bin\n        - mountPath: /mnt/cni-conf\n          name: cni-conf\n        - mountPath: /usr/local/var\n          name: hostvar\n        - mountPath: /run\n          name: hostrun\n        - mountPath: /usr/local/run\n          name: hostrun\n        - mountPath: /usr/local/etc/opflex-agent-ovs/base-conf.d\n          name: opflex-hostconfig-volume\n        - mountPath: /usr/local/etc/aci-containers/\n          name: host-config-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - env:\n        - name: REBOOT_WITH_OVS\n          value: 'true'\n        - name: SSL_MODE\n          value: disabled\n        image: noirolabs/opflex:ci_test\n        imagePullPolicy: Always\n        name: opflex-agent\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          readOnlyRootFilesystem: true\n          allowPrivilegeEscalation: false\n          privileged: false\n          runAsNonRoot: true\n        volumeMounts:\n        - mountPath: /usr/local/var\n          name: hostvar\n        - mountPath: /run\n          name: hostrun\n        - mountPath: /usr/local/run\n          name: hostrun\n        - mountPath: /usr/local/etc/opflex-agent-ovs/base-conf.d\n          name: opflex-hostconfig-volume\n        - mountPath: /usr/local/etc/opflex-agent-ovs/conf.d\n          name: opflex-config-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - args:\n        - /usr/local/bin/launch-opflexserver.sh\n        command:\n        - /bin/sh\n        image: noirolabs/opflex:ci_test\n        imagePullPolicy: Always\n        name: opflex-server\n        ports:\n        - containerPort: 19999\n        - containerPort: 9632\n          name: metrics\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          readOnlyRootFilesystem: true\n          allowPrivilegeEscalation: false\n          privileged: false\n          runAsNonRoot: true\n        volumeMounts:\n        - mountPath: /usr/local/etc/opflex-server\n          name: opflex-server-config-volume\n        - mountPath: /usr/local/var\n          name: hostvar\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      initContainers:\n      - image: noirolabs/cnideploy:6.0.0.0.0ef4718\n        imagePullPolicy: Always\n        name: cnideploy\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          readOnlyRootFilesystem: true\n          allowPrivilegeEscalation: false\n          privileged: false\n          runAsNonRoot: true\n        volumeMounts:\n        - mountPath: /mnt/cni-bin\n          name: cni-bin\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      serviceAccountName: aci-containers-host-agent\n      volumes:\n      - hostPath:\n          path: /var/lib\n        name: cni-bin\n      - hostPath:\n          path: /etc/kubernetes\n        name: cni-conf\n      - hostPath:\n          path: /var\n        name: hostvar\n      - hostPath:\n          path: /run\n        name: hostrun\n      - configMap:\n          items:\n          - key: host-agent-config\n            path: host-agent.conf\n          name: aci-containers-config\n        name: host-config-volume\n      - emptyDir:\n          medium: Memory\n        name: opflex-hostconfig-volume\n      - configMap:\n          items:\n          - key: opflex-agent-config\n            path: local.conf\n          name: aci-containers-config\n        name: opflex-config-volume\n      - name: opflex-server-config-volume\n",
    "errors": []
  },
  {
    "id": "04717",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  labels:\n    aci-containers-config-version: dummy\n    network-plugin: aci-containers\n  name: aci-containers-host\n  namespace: aci-containers-system\nspec:\n  selector:\n    matchLabels:\n      name: aci-containers-host\n      network-plugin: aci-containers\n  template:\n    metadata:\n      annotations:\n        prometheus.io/port: '9612'\n        prometheus.io/scrape: 'true'\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n      labels:\n        name: aci-containers-host\n        network-plugin: aci-containers\n    spec:\n      containers:\n      - env:\n        - name: KUBERNETES_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: TENANT\n          value: csrtest\n        - name: NODE_EPG\n          value: aci-containers-nodes\n        - name: OPFLEX_MODE\n          value: overlay\n        - name: DURATION_WAIT_FOR_NETWORK\n          value: '210'\n        image: noirolabs/aci-containers-host:ci_test\n        imagePullPolicy: Always\n        livenessProbe:\n          failureThreshold: 10\n          httpGet:\n            path: /status\n            port: 8090\n            scheme: HTTP\n          initialDelaySeconds: 120\n          periodSeconds: 60\n          successThreshold: 1\n          timeoutSeconds: 30\n        name: aci-containers-host\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          readOnlyRootFilesystem: true\n          allowPrivilegeEscalation: false\n          privileged: false\n          runAsNonRoot: true\n        volumeMounts:\n        - mountPath: /mnt/cni-bin\n          name: cni-bin\n        - mountPath: /mnt/cni-conf\n          name: cni-conf\n        - mountPath: /usr/local/var\n          name: hostvar\n        - mountPath: /run\n          name: hostrun\n        - mountPath: /usr/local/run\n          name: hostrun\n        - mountPath: /usr/local/etc/opflex-agent-ovs/base-conf.d\n          name: opflex-hostconfig-volume\n        - mountPath: /usr/local/etc/aci-containers/\n          name: host-config-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - env:\n        - name: REBOOT_WITH_OVS\n          value: 'true'\n        - name: SSL_MODE\n          value: disabled\n        image: noirolabs/opflex:ci_test\n        imagePullPolicy: Always\n        name: opflex-agent\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          readOnlyRootFilesystem: true\n          allowPrivilegeEscalation: false\n          privileged: false\n          runAsNonRoot: true\n        volumeMounts:\n        - mountPath: /usr/local/var\n          name: hostvar\n        - mountPath: /run\n          name: hostrun\n        - mountPath: /usr/local/run\n          name: hostrun\n        - mountPath: /usr/local/etc/opflex-agent-ovs/base-conf.d\n          name: opflex-hostconfig-volume\n        - mountPath: /usr/local/etc/opflex-agent-ovs/conf.d\n          name: opflex-config-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - args:\n        - /usr/local/bin/launch-opflexserver.sh\n        command:\n        - /bin/sh\n        image: noirolabs/opflex:ci_test\n        imagePullPolicy: Always\n        name: opflex-server\n        ports:\n        - containerPort: 19999\n        - containerPort: 9632\n          name: metrics\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          readOnlyRootFilesystem: true\n          allowPrivilegeEscalation: false\n          privileged: false\n          runAsNonRoot: true\n        volumeMounts:\n        - mountPath: /usr/local/etc/opflex-server\n          name: opflex-server-config-volume\n        - mountPath: /usr/local/var\n          name: hostvar\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      initContainers:\n      - image: noirolabs/cnideploy:6.0.0.0.0ef4718\n        imagePullPolicy: Always\n        name: cnideploy\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          readOnlyRootFilesystem: true\n          allowPrivilegeEscalation: false\n          privileged: false\n          runAsNonRoot: true\n        volumeMounts:\n        - mountPath: /mnt/cni-bin\n          name: cni-bin\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      serviceAccountName: aci-containers-host-agent\n      volumes:\n      - emptyDir: {}\n        name: cni-bin\n      - emptyDir: {}\n        name: cni-conf\n      - emptyDir: {}\n        name: hostvar\n      - emptyDir: {}\n        name: hostrun\n      - configMap:\n          items:\n          - key: host-agent-config\n            path: host-agent.conf\n          name: aci-containers-config\n        name: host-config-volume\n      - emptyDir:\n          medium: Memory\n        name: opflex-hostconfig-volume\n      - configMap:\n          items:\n          - key: opflex-agent-config\n            path: local.conf\n          name: aci-containers-config\n        name: opflex-config-volume\n      - name: opflex-server-config-volume\n",
    "errors": []
  },
  {
    "id": "04718",
    "policy_id": "drop_capabilities",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  labels:\n    aci-containers-config-version: dummy\n    network-plugin: aci-containers\n  name: aci-containers-host\n  namespace: aci-containers-system\nspec:\n  selector:\n    matchLabels:\n      name: aci-containers-host\n      network-plugin: aci-containers\n  template:\n    metadata:\n      annotations:\n        prometheus.io/port: '9612'\n        prometheus.io/scrape: 'true'\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n      labels:\n        name: aci-containers-host\n        network-plugin: aci-containers\n    spec:\n      containers:\n      - env:\n        - name: KUBERNETES_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: TENANT\n          value: csrtest\n        - name: NODE_EPG\n          value: aci-containers-nodes\n        - name: OPFLEX_MODE\n          value: overlay\n        - name: DURATION_WAIT_FOR_NETWORK\n          value: '210'\n        image: noirolabs/aci-containers-host:ci_test\n        imagePullPolicy: Always\n        livenessProbe:\n          failureThreshold: 10\n          httpGet:\n            path: /status\n            port: 8090\n            scheme: HTTP\n          initialDelaySeconds: 120\n          periodSeconds: 60\n          successThreshold: 1\n          timeoutSeconds: 30\n        name: aci-containers-host\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          privileged: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /mnt/cni-bin\n          name: cni-bin\n        - mountPath: /mnt/cni-conf\n          name: cni-conf\n        - mountPath: /usr/local/var\n          name: hostvar\n        - mountPath: /run\n          name: hostrun\n        - mountPath: /usr/local/run\n          name: hostrun\n        - mountPath: /usr/local/etc/opflex-agent-ovs/base-conf.d\n          name: opflex-hostconfig-volume\n        - mountPath: /usr/local/etc/aci-containers/\n          name: host-config-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - env:\n        - name: REBOOT_WITH_OVS\n          value: 'true'\n        - name: SSL_MODE\n          value: disabled\n        image: noirolabs/opflex:ci_test\n        imagePullPolicy: Always\n        name: opflex-agent\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          privileged: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /usr/local/var\n          name: hostvar\n        - mountPath: /run\n          name: hostrun\n        - mountPath: /usr/local/run\n          name: hostrun\n        - mountPath: /usr/local/etc/opflex-agent-ovs/base-conf.d\n          name: opflex-hostconfig-volume\n        - mountPath: /usr/local/etc/opflex-agent-ovs/conf.d\n          name: opflex-config-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - args:\n        - /usr/local/bin/launch-opflexserver.sh\n        command:\n        - /bin/sh\n        image: noirolabs/opflex:ci_test\n        imagePullPolicy: Always\n        name: opflex-server\n        ports:\n        - containerPort: 19999\n        - containerPort: 9632\n          name: metrics\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          privileged: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /usr/local/etc/opflex-server\n          name: opflex-server-config-volume\n        - mountPath: /usr/local/var\n          name: hostvar\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      initContainers:\n      - image: noirolabs/cnideploy:6.0.0.0.0ef4718\n        imagePullPolicy: Always\n        name: cnideploy\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          privileged: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /mnt/cni-bin\n          name: cni-bin\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      serviceAccountName: aci-containers-host-agent\n      volumes:\n      - hostPath:\n          path: /var/lib\n        name: cni-bin\n      - hostPath:\n          path: /etc/kubernetes\n        name: cni-conf\n      - hostPath:\n          path: /var\n        name: hostvar\n      - hostPath:\n          path: /run\n        name: hostrun\n      - configMap:\n          items:\n          - key: host-agent-config\n            path: host-agent.conf\n          name: aci-containers-config\n        name: host-config-volume\n      - emptyDir:\n          medium: Memory\n        name: opflex-hostconfig-volume\n      - configMap:\n          items:\n          - key: opflex-agent-config\n            path: local.conf\n          name: aci-containers-config\n        name: opflex-config-volume\n      - name: opflex-server-config-volume\n",
    "errors": []
  },
  {
    "id": "04719",
    "policy_id": "drop_capabilities",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  labels:\n    aci-containers-config-version: dummy\n    network-plugin: aci-containers\n  name: aci-containers-host\n  namespace: aci-containers-system\nspec:\n  selector:\n    matchLabels:\n      name: aci-containers-host\n      network-plugin: aci-containers\n  template:\n    metadata:\n      annotations:\n        prometheus.io/port: '9612'\n        prometheus.io/scrape: 'true'\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n      labels:\n        name: aci-containers-host\n        network-plugin: aci-containers\n    spec:\n      containers:\n      - env:\n        - name: KUBERNETES_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: TENANT\n          value: csrtest\n        - name: NODE_EPG\n          value: aci-containers-nodes\n        - name: OPFLEX_MODE\n          value: overlay\n        - name: DURATION_WAIT_FOR_NETWORK\n          value: '210'\n        image: noirolabs/aci-containers-host:ci_test\n        imagePullPolicy: Always\n        livenessProbe:\n          failureThreshold: 10\n          httpGet:\n            path: /status\n            port: 8090\n            scheme: HTTP\n          initialDelaySeconds: 120\n          periodSeconds: 60\n          successThreshold: 1\n          timeoutSeconds: 30\n        name: aci-containers-host\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /mnt/cni-bin\n          name: cni-bin\n        - mountPath: /mnt/cni-conf\n          name: cni-conf\n        - mountPath: /usr/local/var\n          name: hostvar\n        - mountPath: /run\n          name: hostrun\n        - mountPath: /usr/local/run\n          name: hostrun\n        - mountPath: /usr/local/etc/opflex-agent-ovs/base-conf.d\n          name: opflex-hostconfig-volume\n        - mountPath: /usr/local/etc/aci-containers/\n          name: host-config-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - env:\n        - name: REBOOT_WITH_OVS\n          value: 'true'\n        - name: SSL_MODE\n          value: disabled\n        image: noirolabs/opflex:ci_test\n        imagePullPolicy: Always\n        name: opflex-agent\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /usr/local/var\n          name: hostvar\n        - mountPath: /run\n          name: hostrun\n        - mountPath: /usr/local/run\n          name: hostrun\n        - mountPath: /usr/local/etc/opflex-agent-ovs/base-conf.d\n          name: opflex-hostconfig-volume\n        - mountPath: /usr/local/etc/opflex-agent-ovs/conf.d\n          name: opflex-config-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - args:\n        - /usr/local/bin/launch-opflexserver.sh\n        command:\n        - /bin/sh\n        image: noirolabs/opflex:ci_test\n        imagePullPolicy: Always\n        name: opflex-server\n        ports:\n        - containerPort: 19999\n        - containerPort: 9632\n          name: metrics\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /usr/local/etc/opflex-server\n          name: opflex-server-config-volume\n        - mountPath: /usr/local/var\n          name: hostvar\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      initContainers:\n      - image: noirolabs/cnideploy:6.0.0.0.0ef4718\n        imagePullPolicy: Always\n        name: cnideploy\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /mnt/cni-bin\n          name: cni-bin\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      serviceAccountName: aci-containers-host-agent\n      volumes:\n      - hostPath:\n          path: /var/lib\n        name: cni-bin\n      - hostPath:\n          path: /etc/kubernetes\n        name: cni-conf\n      - hostPath:\n          path: /var\n        name: hostvar\n      - hostPath:\n          path: /run\n        name: hostrun\n      - configMap:\n          items:\n          - key: host-agent-config\n            path: host-agent.conf\n          name: aci-containers-config\n        name: host-config-volume\n      - emptyDir:\n          medium: Memory\n        name: opflex-hostconfig-volume\n      - configMap:\n          items:\n          - key: opflex-agent-config\n            path: local.conf\n          name: aci-containers-config\n        name: opflex-config-volume\n      - name: opflex-server-config-volume\n",
    "errors": []
  },
  {
    "id": "04720",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  labels:\n    aci-containers-config-version: dummy\n    network-plugin: aci-containers\n  name: aci-containers-host\n  namespace: aci-containers-system\nspec:\n  selector:\n    matchLabels:\n      name: aci-containers-host\n      network-plugin: aci-containers\n  template:\n    metadata:\n      annotations:\n        prometheus.io/port: '9612'\n        prometheus.io/scrape: 'true'\n        scheduler.alpha.kubernetes.io/critical-pod: ''\n      labels:\n        name: aci-containers-host\n        network-plugin: aci-containers\n    spec:\n      containers:\n      - env:\n        - name: KUBERNETES_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: TENANT\n          value: csrtest\n        - name: NODE_EPG\n          value: aci-containers-nodes\n        - name: OPFLEX_MODE\n          value: overlay\n        - name: DURATION_WAIT_FOR_NETWORK\n          value: '210'\n        image: noirolabs/aci-containers-host:ci_test\n        imagePullPolicy: Always\n        livenessProbe:\n          failureThreshold: 10\n          httpGet:\n            path: /status\n            port: 8090\n            scheme: HTTP\n          initialDelaySeconds: 120\n          periodSeconds: 60\n          successThreshold: 1\n          timeoutSeconds: 30\n        name: aci-containers-host\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n          privileged: false\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /mnt/cni-bin\n          name: cni-bin\n        - mountPath: /mnt/cni-conf\n          name: cni-conf\n        - mountPath: /usr/local/var\n          name: hostvar\n        - mountPath: /run\n          name: hostrun\n        - mountPath: /usr/local/run\n          name: hostrun\n        - mountPath: /usr/local/etc/opflex-agent-ovs/base-conf.d\n          name: opflex-hostconfig-volume\n        - mountPath: /usr/local/etc/aci-containers/\n          name: host-config-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - env:\n        - name: REBOOT_WITH_OVS\n          value: 'true'\n        - name: SSL_MODE\n          value: disabled\n        image: noirolabs/opflex:ci_test\n        imagePullPolicy: Always\n        name: opflex-agent\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n          privileged: false\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /usr/local/var\n          name: hostvar\n        - mountPath: /run\n          name: hostrun\n        - mountPath: /usr/local/run\n          name: hostrun\n        - mountPath: /usr/local/etc/opflex-agent-ovs/base-conf.d\n          name: opflex-hostconfig-volume\n        - mountPath: /usr/local/etc/opflex-agent-ovs/conf.d\n          name: opflex-config-volume\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      - args:\n        - /usr/local/bin/launch-opflexserver.sh\n        command:\n        - /bin/sh\n        image: noirolabs/opflex:ci_test\n        imagePullPolicy: Always\n        name: opflex-server\n        ports:\n        - containerPort: 19999\n        - containerPort: 9632\n          name: metrics\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n          privileged: false\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /usr/local/etc/opflex-server\n          name: opflex-server-config-volume\n        - mountPath: /usr/local/var\n          name: hostvar\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      initContainers:\n      - image: noirolabs/cnideploy:6.0.0.0.0ef4718\n        imagePullPolicy: Always\n        name: cnideploy\n        securityContext:\n          capabilities:\n            add: []\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n          privileged: false\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        volumeMounts:\n        - mountPath: /mnt/cni-bin\n          name: cni-bin\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      serviceAccountName: aci-containers-host-agent\n      volumes:\n      - name: cni-bin\n        emptyDir: {}\n      - name: cni-conf\n        emptyDir: {}\n      - name: hostvar\n        emptyDir: {}\n      - name: hostrun\n        emptyDir: {}\n      - configMap:\n          items:\n          - key: host-agent-config\n            path: host-agent.conf\n          name: aci-containers-config\n        name: host-config-volume\n      - emptyDir:\n          medium: Memory\n        name: opflex-hostconfig-volume\n      - configMap:\n          items:\n          - key: opflex-agent-config\n            path: local.conf\n          name: aci-containers-config\n        name: opflex-config-volume\n      - name: opflex-server-config-volume\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  }
]