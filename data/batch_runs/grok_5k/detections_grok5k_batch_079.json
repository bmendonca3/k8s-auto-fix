[
  {
    "id": "03161",
    "manifest_path": "data/manifests/the_stack_sample/sample_1338.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: kelvin\nspec:\n  selector:\n    matchLabels:\n      name: kelvin\n  template:\n    metadata:\n      labels:\n        name: kelvin\n        plane: data\n    spec:\n      affinity:\n        nodeAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n            nodeSelectorTerms:\n            - matchExpressions:\n              - key: kubernetes.io/os\n                operator: Exists\n              - key: kubernetes.io/os\n                operator: In\n                values:\n                - linux\n            - matchExpressions:\n              - key: beta.kubernetes.io/os\n                operator: Exists\n              - key: beta.kubernetes.io/os\n                operator: In\n                values:\n                - linux\n      initContainers:\n      - name: qb-wait\n        image: gcr.io/pixie-prod/pixie-prod-artifacts/curl:1.0\n        command:\n        - sh\n        - -c\n        - 'set -x; URL=\"https://${SERVICE_NAME}:${SERVICE_PORT}/healthz\"; until [\n          $(curl -m 0.5 -s -o /dev/null -w \"%{http_code}\" -k ${URL}) -eq 200 ]; do\n          echo \"waiting for ${URL}\" sleep 2; done; '\n        env:\n        - name: SERVICE_NAME\n          value: vizier-query-broker\n        - name: SERVICE_PORT\n          value: '50300'\n      containers:\n      - name: app\n        image: gcr.io/pixie-oss/pixie-dev/vizier/kelvin_image:latest\n        envFrom:\n        - configMapRef:\n            name: pl-tls-config\n        env:\n        - name: PL_HOST_PATH\n          value: /host\n        - name: PL_POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: PL_POD_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: PL_HOST_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.hostIP\n        - name: PL_JWT_SIGNING_KEY\n          valueFrom:\n            secretKeyRef:\n              key: jwt-signing-key\n              name: pl-cluster-secrets\n        - name: PL_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: TCMALLOC_SAMPLE_PARAMETER\n          value: '1048576'\n        ports:\n        - containerPort: 59300\n        volumeMounts:\n        - mountPath: /certs\n          name: certs\n        - name: sys\n          mountPath: /sys\n          readOnly: true\n        resources: {}\n      volumes:\n      - name: certs\n        secret:\n          secretName: service-tls-certs\n      - name: sys\n        hostPath:\n          path: /sys\n          type: Directory\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"app\" has cpu request 0"
  },
  {
    "id": "03162",
    "manifest_path": "data/manifests/the_stack_sample/sample_1338.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: kelvin\nspec:\n  selector:\n    matchLabels:\n      name: kelvin\n  template:\n    metadata:\n      labels:\n        name: kelvin\n        plane: data\n    spec:\n      affinity:\n        nodeAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n            nodeSelectorTerms:\n            - matchExpressions:\n              - key: kubernetes.io/os\n                operator: Exists\n              - key: kubernetes.io/os\n                operator: In\n                values:\n                - linux\n            - matchExpressions:\n              - key: beta.kubernetes.io/os\n                operator: Exists\n              - key: beta.kubernetes.io/os\n                operator: In\n                values:\n                - linux\n      initContainers:\n      - name: qb-wait\n        image: gcr.io/pixie-prod/pixie-prod-artifacts/curl:1.0\n        command:\n        - sh\n        - -c\n        - 'set -x; URL=\"https://${SERVICE_NAME}:${SERVICE_PORT}/healthz\"; until [\n          $(curl -m 0.5 -s -o /dev/null -w \"%{http_code}\" -k ${URL}) -eq 200 ]; do\n          echo \"waiting for ${URL}\" sleep 2; done; '\n        env:\n        - name: SERVICE_NAME\n          value: vizier-query-broker\n        - name: SERVICE_PORT\n          value: '50300'\n      containers:\n      - name: app\n        image: gcr.io/pixie-oss/pixie-dev/vizier/kelvin_image:latest\n        envFrom:\n        - configMapRef:\n            name: pl-tls-config\n        env:\n        - name: PL_HOST_PATH\n          value: /host\n        - name: PL_POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: PL_POD_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: PL_HOST_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.hostIP\n        - name: PL_JWT_SIGNING_KEY\n          valueFrom:\n            secretKeyRef:\n              key: jwt-signing-key\n              name: pl-cluster-secrets\n        - name: PL_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: TCMALLOC_SAMPLE_PARAMETER\n          value: '1048576'\n        ports:\n        - containerPort: 59300\n        volumeMounts:\n        - mountPath: /certs\n          name: certs\n        - name: sys\n          mountPath: /sys\n          readOnly: true\n        resources: {}\n      volumes:\n      - name: certs\n        secret:\n          secretName: service-tls-certs\n      - name: sys\n        hostPath:\n          path: /sys\n          type: Directory\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"qb-wait\" has cpu request 0"
  },
  {
    "id": "03163",
    "manifest_path": "data/manifests/the_stack_sample/sample_1338.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: kelvin\nspec:\n  selector:\n    matchLabels:\n      name: kelvin\n  template:\n    metadata:\n      labels:\n        name: kelvin\n        plane: data\n    spec:\n      affinity:\n        nodeAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n            nodeSelectorTerms:\n            - matchExpressions:\n              - key: kubernetes.io/os\n                operator: Exists\n              - key: kubernetes.io/os\n                operator: In\n                values:\n                - linux\n            - matchExpressions:\n              - key: beta.kubernetes.io/os\n                operator: Exists\n              - key: beta.kubernetes.io/os\n                operator: In\n                values:\n                - linux\n      initContainers:\n      - name: qb-wait\n        image: gcr.io/pixie-prod/pixie-prod-artifacts/curl:1.0\n        command:\n        - sh\n        - -c\n        - 'set -x; URL=\"https://${SERVICE_NAME}:${SERVICE_PORT}/healthz\"; until [\n          $(curl -m 0.5 -s -o /dev/null -w \"%{http_code}\" -k ${URL}) -eq 200 ]; do\n          echo \"waiting for ${URL}\" sleep 2; done; '\n        env:\n        - name: SERVICE_NAME\n          value: vizier-query-broker\n        - name: SERVICE_PORT\n          value: '50300'\n      containers:\n      - name: app\n        image: gcr.io/pixie-oss/pixie-dev/vizier/kelvin_image:latest\n        envFrom:\n        - configMapRef:\n            name: pl-tls-config\n        env:\n        - name: PL_HOST_PATH\n          value: /host\n        - name: PL_POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: PL_POD_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: PL_HOST_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.hostIP\n        - name: PL_JWT_SIGNING_KEY\n          valueFrom:\n            secretKeyRef:\n              key: jwt-signing-key\n              name: pl-cluster-secrets\n        - name: PL_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: TCMALLOC_SAMPLE_PARAMETER\n          value: '1048576'\n        ports:\n        - containerPort: 59300\n        volumeMounts:\n        - mountPath: /certs\n          name: certs\n        - name: sys\n          mountPath: /sys\n          readOnly: true\n        resources: {}\n      volumes:\n      - name: certs\n        secret:\n          secretName: service-tls-certs\n      - name: sys\n        hostPath:\n          path: /sys\n          type: Directory\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"app\" has memory limit 0"
  },
  {
    "id": "03164",
    "manifest_path": "data/manifests/the_stack_sample/sample_1338.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: kelvin\nspec:\n  selector:\n    matchLabels:\n      name: kelvin\n  template:\n    metadata:\n      labels:\n        name: kelvin\n        plane: data\n    spec:\n      affinity:\n        nodeAffinity:\n          requiredDuringSchedulingIgnoredDuringExecution:\n            nodeSelectorTerms:\n            - matchExpressions:\n              - key: kubernetes.io/os\n                operator: Exists\n              - key: kubernetes.io/os\n                operator: In\n                values:\n                - linux\n            - matchExpressions:\n              - key: beta.kubernetes.io/os\n                operator: Exists\n              - key: beta.kubernetes.io/os\n                operator: In\n                values:\n                - linux\n      initContainers:\n      - name: qb-wait\n        image: gcr.io/pixie-prod/pixie-prod-artifacts/curl:1.0\n        command:\n        - sh\n        - -c\n        - 'set -x; URL=\"https://${SERVICE_NAME}:${SERVICE_PORT}/healthz\"; until [\n          $(curl -m 0.5 -s -o /dev/null -w \"%{http_code}\" -k ${URL}) -eq 200 ]; do\n          echo \"waiting for ${URL}\" sleep 2; done; '\n        env:\n        - name: SERVICE_NAME\n          value: vizier-query-broker\n        - name: SERVICE_PORT\n          value: '50300'\n      containers:\n      - name: app\n        image: gcr.io/pixie-oss/pixie-dev/vizier/kelvin_image:latest\n        envFrom:\n        - configMapRef:\n            name: pl-tls-config\n        env:\n        - name: PL_HOST_PATH\n          value: /host\n        - name: PL_POD_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.name\n        - name: PL_POD_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: PL_HOST_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.hostIP\n        - name: PL_JWT_SIGNING_KEY\n          valueFrom:\n            secretKeyRef:\n              key: jwt-signing-key\n              name: pl-cluster-secrets\n        - name: PL_NAMESPACE\n          valueFrom:\n            fieldRef:\n              fieldPath: metadata.namespace\n        - name: TCMALLOC_SAMPLE_PARAMETER\n          value: '1048576'\n        ports:\n        - containerPort: 59300\n        volumeMounts:\n        - mountPath: /certs\n          name: certs\n        - name: sys\n          mountPath: /sys\n          readOnly: true\n        resources: {}\n      volumes:\n      - name: certs\n        secret:\n          secretName: service-tls-certs\n      - name: sys\n        hostPath:\n          path: /sys\n          type: Directory\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"qb-wait\" has memory limit 0"
  },
  {
    "id": "03165",
    "manifest_path": "data/manifests/the_stack_sample/sample_1345.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    kraken.service: redis\n  name: redis\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      kraken.service: redis\n  template:\n    metadata:\n      labels:\n        kraken.service: redis\n    spec:\n      containers:\n      - name: redis\n        image: redis:6\n        ports:\n        - name: redis\n          containerPort: 6379\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"redis\" does not have a read-only root file system"
  },
  {
    "id": "03166",
    "manifest_path": "data/manifests/the_stack_sample/sample_1345.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    kraken.service: redis\n  name: redis\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      kraken.service: redis\n  template:\n    metadata:\n      labels:\n        kraken.service: redis\n    spec:\n      containers:\n      - name: redis\n        image: redis:6\n        ports:\n        - name: redis\n          containerPort: 6379\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"redis\" is not set to runAsNonRoot"
  },
  {
    "id": "03167",
    "manifest_path": "data/manifests/the_stack_sample/sample_1345.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    kraken.service: redis\n  name: redis\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      kraken.service: redis\n  template:\n    metadata:\n      labels:\n        kraken.service: redis\n    spec:\n      containers:\n      - name: redis\n        image: redis:6\n        ports:\n        - name: redis\n          containerPort: 6379\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"redis\" has cpu request 0"
  },
  {
    "id": "03168",
    "manifest_path": "data/manifests/the_stack_sample/sample_1345.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    kraken.service: redis\n  name: redis\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      kraken.service: redis\n  template:\n    metadata:\n      labels:\n        kraken.service: redis\n    spec:\n      containers:\n      - name: redis\n        image: redis:6\n        ports:\n        - name: redis\n          containerPort: 6379\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"redis\" has memory limit 0"
  },
  {
    "id": "03169",
    "manifest_path": "data/manifests/the_stack_sample/sample_1346.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: serviceCenter\n  labels:\n    app: serviceCenter\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: serviceCenter\n  template:\n    metadata:\n      labels:\n        app: serviceCenter\n    spec:\n      containers:\n      - name: serviceCenter\n        image: username/serviceCenter:latest\n        ports:\n        - containerPort: 8080\n        readinessProbe:\n          httpGet:\n            path: /actuator/health\n            port: 8080\n          initialDelaySeconds: 10\n          timeoutSeconds: 2\n          periodSeconds: 5\n          failureThreshold: 10\n        livenessProbe:\n          httpGet:\n            path: /actuator/health\n            port: 8080\n          initialDelaySeconds: 120\n          timeoutSeconds: 2\n          periodSeconds: 5\n          failureThreshold: 5\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"serviceCenter\" is using an invalid container image, \"username/serviceCenter:latest\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "03170",
    "manifest_path": "data/manifests/the_stack_sample/sample_1346.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: serviceCenter\n  labels:\n    app: serviceCenter\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: serviceCenter\n  template:\n    metadata:\n      labels:\n        app: serviceCenter\n    spec:\n      containers:\n      - name: serviceCenter\n        image: username/serviceCenter:latest\n        ports:\n        - containerPort: 8080\n        readinessProbe:\n          httpGet:\n            path: /actuator/health\n            port: 8080\n          initialDelaySeconds: 10\n          timeoutSeconds: 2\n          periodSeconds: 5\n          failureThreshold: 10\n        livenessProbe:\n          httpGet:\n            path: /actuator/health\n            port: 8080\n          initialDelaySeconds: 120\n          timeoutSeconds: 2\n          periodSeconds: 5\n          failureThreshold: 5\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"serviceCenter\" does not have a read-only root file system"
  },
  {
    "id": "03171",
    "manifest_path": "data/manifests/the_stack_sample/sample_1346.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: serviceCenter\n  labels:\n    app: serviceCenter\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: serviceCenter\n  template:\n    metadata:\n      labels:\n        app: serviceCenter\n    spec:\n      containers:\n      - name: serviceCenter\n        image: username/serviceCenter:latest\n        ports:\n        - containerPort: 8080\n        readinessProbe:\n          httpGet:\n            path: /actuator/health\n            port: 8080\n          initialDelaySeconds: 10\n          timeoutSeconds: 2\n          periodSeconds: 5\n          failureThreshold: 10\n        livenessProbe:\n          httpGet:\n            path: /actuator/health\n            port: 8080\n          initialDelaySeconds: 120\n          timeoutSeconds: 2\n          periodSeconds: 5\n          failureThreshold: 5\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"serviceCenter\" is not set to runAsNonRoot"
  },
  {
    "id": "03172",
    "manifest_path": "data/manifests/the_stack_sample/sample_1346.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: serviceCenter\n  labels:\n    app: serviceCenter\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: serviceCenter\n  template:\n    metadata:\n      labels:\n        app: serviceCenter\n    spec:\n      containers:\n      - name: serviceCenter\n        image: username/serviceCenter:latest\n        ports:\n        - containerPort: 8080\n        readinessProbe:\n          httpGet:\n            path: /actuator/health\n            port: 8080\n          initialDelaySeconds: 10\n          timeoutSeconds: 2\n          periodSeconds: 5\n          failureThreshold: 10\n        livenessProbe:\n          httpGet:\n            path: /actuator/health\n            port: 8080\n          initialDelaySeconds: 120\n          timeoutSeconds: 2\n          periodSeconds: 5\n          failureThreshold: 5\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"serviceCenter\" has cpu request 0"
  },
  {
    "id": "03173",
    "manifest_path": "data/manifests/the_stack_sample/sample_1346.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: serviceCenter\n  labels:\n    app: serviceCenter\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: serviceCenter\n  template:\n    metadata:\n      labels:\n        app: serviceCenter\n    spec:\n      containers:\n      - name: serviceCenter\n        image: username/serviceCenter:latest\n        ports:\n        - containerPort: 8080\n        readinessProbe:\n          httpGet:\n            path: /actuator/health\n            port: 8080\n          initialDelaySeconds: 10\n          timeoutSeconds: 2\n          periodSeconds: 5\n          failureThreshold: 10\n        livenessProbe:\n          httpGet:\n            path: /actuator/health\n            port: 8080\n          initialDelaySeconds: 120\n          timeoutSeconds: 2\n          periodSeconds: 5\n          failureThreshold: 5\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"serviceCenter\" has memory limit 0"
  },
  {
    "id": "03174",
    "manifest_path": "data/manifests/the_stack_sample/sample_1347.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: eventstore\nspec:\n  selector:\n    matchLabels:\n      app: eventstore\n  replicas: 3\n  template:\n    metadata:\n      labels:\n        app: eventstore\n    spec:\n      containers:\n      - name: eventstore\n        image: eventstore/eventstore:release-5.0.2\n        volumeMounts:\n        - mountPath: /usr/data/eventstore\n          name: eventstore-pv-storage\n        env:\n        - name: EVENTSTORE_INT_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: EVENTSTORE_EXT_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: EVENTSTORE_INT_TCP_PORT\n          value: '1111'\n        - name: EVENTSTORE_EXT_TCP_PORT\n          value: '1112'\n        - name: EVENTSTORE_INT_HTTP_PORT\n          value: '2114'\n        - name: EVENTSTORE_EXT_HTTP_PORT\n          value: '2113'\n        - name: EVENTSTORE_CLUSTER_SIZE\n          value: '2'\n        - name: EVENTSTORE_CLUSTER_DNS\n          value: eventstore.default.svc.cluster.local\n        - name: EVENTSTORE_CLUSTER_GOSSIP_PORT\n          value: '2114'\n        - name: EVENTSTORE_GOSSIP_ALLOWED_DIFFERENCE_MS\n          value: '600000'\n        - name: EVENTSTORE_INT_HTTP_PREFIXES\n          value: http://*:2114/\n        - name: EVENTSTORE_EXT_HTTP_PREFIXES\n          value: http://*:2113/\n        ports:\n        - containerPort: 2113\n        - containerPort: 2114\n        - containerPort: 1111\n        - containerPort: 1112\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"eventstore\" does not have a read-only root file system"
  },
  {
    "id": "03175",
    "manifest_path": "data/manifests/the_stack_sample/sample_1347.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: eventstore\nspec:\n  selector:\n    matchLabels:\n      app: eventstore\n  replicas: 3\n  template:\n    metadata:\n      labels:\n        app: eventstore\n    spec:\n      containers:\n      - name: eventstore\n        image: eventstore/eventstore:release-5.0.2\n        volumeMounts:\n        - mountPath: /usr/data/eventstore\n          name: eventstore-pv-storage\n        env:\n        - name: EVENTSTORE_INT_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: EVENTSTORE_EXT_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: EVENTSTORE_INT_TCP_PORT\n          value: '1111'\n        - name: EVENTSTORE_EXT_TCP_PORT\n          value: '1112'\n        - name: EVENTSTORE_INT_HTTP_PORT\n          value: '2114'\n        - name: EVENTSTORE_EXT_HTTP_PORT\n          value: '2113'\n        - name: EVENTSTORE_CLUSTER_SIZE\n          value: '2'\n        - name: EVENTSTORE_CLUSTER_DNS\n          value: eventstore.default.svc.cluster.local\n        - name: EVENTSTORE_CLUSTER_GOSSIP_PORT\n          value: '2114'\n        - name: EVENTSTORE_GOSSIP_ALLOWED_DIFFERENCE_MS\n          value: '600000'\n        - name: EVENTSTORE_INT_HTTP_PREFIXES\n          value: http://*:2114/\n        - name: EVENTSTORE_EXT_HTTP_PREFIXES\n          value: http://*:2113/\n        ports:\n        - containerPort: 2113\n        - containerPort: 2114\n        - containerPort: 1111\n        - containerPort: 1112\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"eventstore\" is not set to runAsNonRoot"
  },
  {
    "id": "03176",
    "manifest_path": "data/manifests/the_stack_sample/sample_1347.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: eventstore\nspec:\n  selector:\n    matchLabels:\n      app: eventstore\n  replicas: 3\n  template:\n    metadata:\n      labels:\n        app: eventstore\n    spec:\n      containers:\n      - name: eventstore\n        image: eventstore/eventstore:release-5.0.2\n        volumeMounts:\n        - mountPath: /usr/data/eventstore\n          name: eventstore-pv-storage\n        env:\n        - name: EVENTSTORE_INT_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: EVENTSTORE_EXT_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: EVENTSTORE_INT_TCP_PORT\n          value: '1111'\n        - name: EVENTSTORE_EXT_TCP_PORT\n          value: '1112'\n        - name: EVENTSTORE_INT_HTTP_PORT\n          value: '2114'\n        - name: EVENTSTORE_EXT_HTTP_PORT\n          value: '2113'\n        - name: EVENTSTORE_CLUSTER_SIZE\n          value: '2'\n        - name: EVENTSTORE_CLUSTER_DNS\n          value: eventstore.default.svc.cluster.local\n        - name: EVENTSTORE_CLUSTER_GOSSIP_PORT\n          value: '2114'\n        - name: EVENTSTORE_GOSSIP_ALLOWED_DIFFERENCE_MS\n          value: '600000'\n        - name: EVENTSTORE_INT_HTTP_PREFIXES\n          value: http://*:2114/\n        - name: EVENTSTORE_EXT_HTTP_PREFIXES\n          value: http://*:2113/\n        ports:\n        - containerPort: 2113\n        - containerPort: 2114\n        - containerPort: 1111\n        - containerPort: 1112\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"eventstore\" has cpu request 0"
  },
  {
    "id": "03177",
    "manifest_path": "data/manifests/the_stack_sample/sample_1347.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: eventstore\nspec:\n  selector:\n    matchLabels:\n      app: eventstore\n  replicas: 3\n  template:\n    metadata:\n      labels:\n        app: eventstore\n    spec:\n      containers:\n      - name: eventstore\n        image: eventstore/eventstore:release-5.0.2\n        volumeMounts:\n        - mountPath: /usr/data/eventstore\n          name: eventstore-pv-storage\n        env:\n        - name: EVENTSTORE_INT_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: EVENTSTORE_EXT_IP\n          valueFrom:\n            fieldRef:\n              fieldPath: status.podIP\n        - name: EVENTSTORE_INT_TCP_PORT\n          value: '1111'\n        - name: EVENTSTORE_EXT_TCP_PORT\n          value: '1112'\n        - name: EVENTSTORE_INT_HTTP_PORT\n          value: '2114'\n        - name: EVENTSTORE_EXT_HTTP_PORT\n          value: '2113'\n        - name: EVENTSTORE_CLUSTER_SIZE\n          value: '2'\n        - name: EVENTSTORE_CLUSTER_DNS\n          value: eventstore.default.svc.cluster.local\n        - name: EVENTSTORE_CLUSTER_GOSSIP_PORT\n          value: '2114'\n        - name: EVENTSTORE_GOSSIP_ALLOWED_DIFFERENCE_MS\n          value: '600000'\n        - name: EVENTSTORE_INT_HTTP_PREFIXES\n          value: http://*:2114/\n        - name: EVENTSTORE_EXT_HTTP_PREFIXES\n          value: http://*:2113/\n        ports:\n        - containerPort: 2113\n        - containerPort: 2114\n        - containerPort: 1111\n        - containerPort: 1112\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"eventstore\" has memory limit 0"
  },
  {
    "id": "03178",
    "manifest_path": "data/manifests/the_stack_sample/sample_1349.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: certbotdns\n  labels:\n    purpose: certbot\nspec:\n  template:\n    spec:\n      serviceAccountName: certbot\n      containers:\n      - name: certbotdns\n        image: mbuckrogers/gcednscertbot\n        args:\n        - --server=$(LE_SERVER)\n        - -n\n        - -v\n        - --dns-google\n        - --dns-google-propagation-seconds=60\n        - --email=$(EMAIL)\n        - --agree-tos\n        - --dns-google-credentials=$(GOOGLE_APPLICATION_CREDENTIALS)\n        - --deploy-hook=deployhook.sh\n        - -d $(DOMAINS)\n        - certonly\n        imagePullPolicy: Always\n        volumeMounts:\n        - name: google-cloud-key\n          mountPath: /var/secrets/google\n        - name: certs-storage\n          mountPath: /etc/letsencrypt/\n        env:\n        - name: GOOGLE_APPLICATION_CREDENTIALS\n          value: /var/secrets/google/key.json\n        envFrom:\n        - configMapRef:\n            name: certbot-config\n      volumes:\n      - name: google-cloud-key\n        secret:\n          secretName: dns-key\n      - name: certs-storage\n        gcePersistentDisk:\n          pdName: certbot-disk\n          fsType: ext4\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"certbotdns\" is using an invalid container image, \"mbuckrogers/gcednscertbot\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "03179",
    "manifest_path": "data/manifests/the_stack_sample/sample_1349.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: certbotdns\n  labels:\n    purpose: certbot\nspec:\n  template:\n    spec:\n      serviceAccountName: certbot\n      containers:\n      - name: certbotdns\n        image: mbuckrogers/gcednscertbot\n        args:\n        - --server=$(LE_SERVER)\n        - -n\n        - -v\n        - --dns-google\n        - --dns-google-propagation-seconds=60\n        - --email=$(EMAIL)\n        - --agree-tos\n        - --dns-google-credentials=$(GOOGLE_APPLICATION_CREDENTIALS)\n        - --deploy-hook=deployhook.sh\n        - -d $(DOMAINS)\n        - certonly\n        imagePullPolicy: Always\n        volumeMounts:\n        - name: google-cloud-key\n          mountPath: /var/secrets/google\n        - name: certs-storage\n          mountPath: /etc/letsencrypt/\n        env:\n        - name: GOOGLE_APPLICATION_CREDENTIALS\n          value: /var/secrets/google/key.json\n        envFrom:\n        - configMapRef:\n            name: certbot-config\n      volumes:\n      - name: google-cloud-key\n        secret:\n          secretName: dns-key\n      - name: certs-storage\n        gcePersistentDisk:\n          pdName: certbot-disk\n          fsType: ext4\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"certbotdns\" does not have a read-only root file system"
  },
  {
    "id": "03180",
    "manifest_path": "data/manifests/the_stack_sample/sample_1349.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: certbotdns\n  labels:\n    purpose: certbot\nspec:\n  template:\n    spec:\n      serviceAccountName: certbot\n      containers:\n      - name: certbotdns\n        image: mbuckrogers/gcednscertbot\n        args:\n        - --server=$(LE_SERVER)\n        - -n\n        - -v\n        - --dns-google\n        - --dns-google-propagation-seconds=60\n        - --email=$(EMAIL)\n        - --agree-tos\n        - --dns-google-credentials=$(GOOGLE_APPLICATION_CREDENTIALS)\n        - --deploy-hook=deployhook.sh\n        - -d $(DOMAINS)\n        - certonly\n        imagePullPolicy: Always\n        volumeMounts:\n        - name: google-cloud-key\n          mountPath: /var/secrets/google\n        - name: certs-storage\n          mountPath: /etc/letsencrypt/\n        env:\n        - name: GOOGLE_APPLICATION_CREDENTIALS\n          value: /var/secrets/google/key.json\n        envFrom:\n        - configMapRef:\n            name: certbot-config\n      volumes:\n      - name: google-cloud-key\n        secret:\n          secretName: dns-key\n      - name: certs-storage\n        gcePersistentDisk:\n          pdName: certbot-disk\n          fsType: ext4\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"certbotdns\" is not set to runAsNonRoot"
  },
  {
    "id": "03181",
    "manifest_path": "data/manifests/the_stack_sample/sample_1349.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: certbotdns\n  labels:\n    purpose: certbot\nspec:\n  template:\n    spec:\n      serviceAccountName: certbot\n      containers:\n      - name: certbotdns\n        image: mbuckrogers/gcednscertbot\n        args:\n        - --server=$(LE_SERVER)\n        - -n\n        - -v\n        - --dns-google\n        - --dns-google-propagation-seconds=60\n        - --email=$(EMAIL)\n        - --agree-tos\n        - --dns-google-credentials=$(GOOGLE_APPLICATION_CREDENTIALS)\n        - --deploy-hook=deployhook.sh\n        - -d $(DOMAINS)\n        - certonly\n        imagePullPolicy: Always\n        volumeMounts:\n        - name: google-cloud-key\n          mountPath: /var/secrets/google\n        - name: certs-storage\n          mountPath: /etc/letsencrypt/\n        env:\n        - name: GOOGLE_APPLICATION_CREDENTIALS\n          value: /var/secrets/google/key.json\n        envFrom:\n        - configMapRef:\n            name: certbot-config\n      volumes:\n      - name: google-cloud-key\n        secret:\n          secretName: dns-key\n      - name: certs-storage\n        gcePersistentDisk:\n          pdName: certbot-disk\n          fsType: ext4\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"certbotdns\" has cpu request 0"
  },
  {
    "id": "03182",
    "manifest_path": "data/manifests/the_stack_sample/sample_1349.yaml",
    "manifest_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: certbotdns\n  labels:\n    purpose: certbot\nspec:\n  template:\n    spec:\n      serviceAccountName: certbot\n      containers:\n      - name: certbotdns\n        image: mbuckrogers/gcednscertbot\n        args:\n        - --server=$(LE_SERVER)\n        - -n\n        - -v\n        - --dns-google\n        - --dns-google-propagation-seconds=60\n        - --email=$(EMAIL)\n        - --agree-tos\n        - --dns-google-credentials=$(GOOGLE_APPLICATION_CREDENTIALS)\n        - --deploy-hook=deployhook.sh\n        - -d $(DOMAINS)\n        - certonly\n        imagePullPolicy: Always\n        volumeMounts:\n        - name: google-cloud-key\n          mountPath: /var/secrets/google\n        - name: certs-storage\n          mountPath: /etc/letsencrypt/\n        env:\n        - name: GOOGLE_APPLICATION_CREDENTIALS\n          value: /var/secrets/google/key.json\n        envFrom:\n        - configMapRef:\n            name: certbot-config\n      volumes:\n      - name: google-cloud-key\n        secret:\n          secretName: dns-key\n      - name: certs-storage\n        gcePersistentDisk:\n          pdName: certbot-disk\n          fsType: ext4\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"certbotdns\" has memory limit 0"
  },
  {
    "id": "03183",
    "manifest_path": "data/manifests/the_stack_sample/sample_1354.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: openstack-cinder-csi-driver-node\n  namespace: openshift-cluster-csi-drivers\n  annotations:\n    config.openshift.io/inject-proxy: csi-driver\nspec:\n  selector:\n    matchLabels:\n      app: openstack-cinder-csi-driver-node\n  template:\n    metadata:\n      labels:\n        app: openstack-cinder-csi-driver-node\n    spec:\n      serviceAccount: openstack-cinder-csi-driver-node-sa\n      containers:\n      - name: csi-driver\n        securityContext:\n          privileged: true\n          capabilities:\n            add:\n            - SYS_ADMIN\n          allowPrivilegeEscalation: true\n        image: ${DRIVER_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - /bin/cinder-csi-plugin\n        - --nodeid=$(NODE_ID)\n        - --endpoint=$(CSI_ENDPOINT)\n        - --cloud-config=$(CLOUD_CONFIG)\n        - --v=${LOG_LEVEL}\n        env:\n        - name: NODE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CSI_ENDPOINT\n          value: unix://csi/csi.sock\n        - name: CLOUD_CONFIG\n          value: /etc/kubernetes/config/cloud.conf\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: Bidirectional\n        - name: pods-probe-dir\n          mountPath: /dev\n          mountPropagation: HostToContainer\n        - name: secret-cinderplugin\n          mountPath: /etc/kubernetes/secret\n          readOnly: true\n        - name: config-cinderplugin\n          mountPath: /etc/kubernetes/config\n          readOnly: true\n        - name: cacert\n          mountPath: /etc/kubernetes/static-pod-resources/configmaps/cloud-config\n        ports:\n        - name: healthz\n          containerPort: 10300\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 10\n          timeoutSeconds: 10\n          periodSeconds: 30\n          failureThreshold: 5\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      - name: node-driver-registrar\n        image: ${NODE_DRIVER_REGISTRAR_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - --v=5\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REG_SOCK_PATH)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REG_SOCK_PATH\n          value: /var/lib/kubelet/plugins/cinder.csi.openstack.org/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      - name: csi-liveness-probe\n        image: ${LIVENESS_PROBE_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - --csi-address=/csi/csi.sock\n        - --probe-timeout=10s\n        - --health-port=10300\n        - --v=${LOG_LEVEL}\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      volumes:\n      - name: socket-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/cinder.csi.openstack.org\n          type: DirectoryOrCreate\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n      - name: pods-probe-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: secret-cinderplugin\n        secret:\n          secretName: openstack-cloud-credentials\n          items:\n          - key: clouds.yaml\n            path: clouds.yaml\n      - name: config-cinderplugin\n        configMap:\n          name: openstack-cinder-config\n          items:\n          - key: cloud.conf\n            path: cloud.conf\n          - key: multiaz-cloud.conf\n            path: multiaz-cloud.conf\n      - name: cacert\n        configMap:\n          name: cloud-provider-config\n          items:\n          - key: ca-bundle.pem\n            path: ca-bundle.pem\n          optional: true\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"csi-driver\" is using an invalid container image, \"${DRIVER_IMAGE}\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "03184",
    "manifest_path": "data/manifests/the_stack_sample/sample_1354.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: openstack-cinder-csi-driver-node\n  namespace: openshift-cluster-csi-drivers\n  annotations:\n    config.openshift.io/inject-proxy: csi-driver\nspec:\n  selector:\n    matchLabels:\n      app: openstack-cinder-csi-driver-node\n  template:\n    metadata:\n      labels:\n        app: openstack-cinder-csi-driver-node\n    spec:\n      serviceAccount: openstack-cinder-csi-driver-node-sa\n      containers:\n      - name: csi-driver\n        securityContext:\n          privileged: true\n          capabilities:\n            add:\n            - SYS_ADMIN\n          allowPrivilegeEscalation: true\n        image: ${DRIVER_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - /bin/cinder-csi-plugin\n        - --nodeid=$(NODE_ID)\n        - --endpoint=$(CSI_ENDPOINT)\n        - --cloud-config=$(CLOUD_CONFIG)\n        - --v=${LOG_LEVEL}\n        env:\n        - name: NODE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CSI_ENDPOINT\n          value: unix://csi/csi.sock\n        - name: CLOUD_CONFIG\n          value: /etc/kubernetes/config/cloud.conf\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: Bidirectional\n        - name: pods-probe-dir\n          mountPath: /dev\n          mountPropagation: HostToContainer\n        - name: secret-cinderplugin\n          mountPath: /etc/kubernetes/secret\n          readOnly: true\n        - name: config-cinderplugin\n          mountPath: /etc/kubernetes/config\n          readOnly: true\n        - name: cacert\n          mountPath: /etc/kubernetes/static-pod-resources/configmaps/cloud-config\n        ports:\n        - name: healthz\n          containerPort: 10300\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 10\n          timeoutSeconds: 10\n          periodSeconds: 30\n          failureThreshold: 5\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      - name: node-driver-registrar\n        image: ${NODE_DRIVER_REGISTRAR_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - --v=5\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REG_SOCK_PATH)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REG_SOCK_PATH\n          value: /var/lib/kubelet/plugins/cinder.csi.openstack.org/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      - name: csi-liveness-probe\n        image: ${LIVENESS_PROBE_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - --csi-address=/csi/csi.sock\n        - --probe-timeout=10s\n        - --health-port=10300\n        - --v=${LOG_LEVEL}\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      volumes:\n      - name: socket-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/cinder.csi.openstack.org\n          type: DirectoryOrCreate\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n      - name: pods-probe-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: secret-cinderplugin\n        secret:\n          secretName: openstack-cloud-credentials\n          items:\n          - key: clouds.yaml\n            path: clouds.yaml\n      - name: config-cinderplugin\n        configMap:\n          name: openstack-cinder-config\n          items:\n          - key: cloud.conf\n            path: cloud.conf\n          - key: multiaz-cloud.conf\n            path: multiaz-cloud.conf\n      - name: cacert\n        configMap:\n          name: cloud-provider-config\n          items:\n          - key: ca-bundle.pem\n            path: ca-bundle.pem\n          optional: true\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"csi-liveness-probe\" is using an invalid container image, \"${LIVENESS_PROBE_IMAGE}\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "03185",
    "manifest_path": "data/manifests/the_stack_sample/sample_1354.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: openstack-cinder-csi-driver-node\n  namespace: openshift-cluster-csi-drivers\n  annotations:\n    config.openshift.io/inject-proxy: csi-driver\nspec:\n  selector:\n    matchLabels:\n      app: openstack-cinder-csi-driver-node\n  template:\n    metadata:\n      labels:\n        app: openstack-cinder-csi-driver-node\n    spec:\n      serviceAccount: openstack-cinder-csi-driver-node-sa\n      containers:\n      - name: csi-driver\n        securityContext:\n          privileged: true\n          capabilities:\n            add:\n            - SYS_ADMIN\n          allowPrivilegeEscalation: true\n        image: ${DRIVER_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - /bin/cinder-csi-plugin\n        - --nodeid=$(NODE_ID)\n        - --endpoint=$(CSI_ENDPOINT)\n        - --cloud-config=$(CLOUD_CONFIG)\n        - --v=${LOG_LEVEL}\n        env:\n        - name: NODE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CSI_ENDPOINT\n          value: unix://csi/csi.sock\n        - name: CLOUD_CONFIG\n          value: /etc/kubernetes/config/cloud.conf\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: Bidirectional\n        - name: pods-probe-dir\n          mountPath: /dev\n          mountPropagation: HostToContainer\n        - name: secret-cinderplugin\n          mountPath: /etc/kubernetes/secret\n          readOnly: true\n        - name: config-cinderplugin\n          mountPath: /etc/kubernetes/config\n          readOnly: true\n        - name: cacert\n          mountPath: /etc/kubernetes/static-pod-resources/configmaps/cloud-config\n        ports:\n        - name: healthz\n          containerPort: 10300\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 10\n          timeoutSeconds: 10\n          periodSeconds: 30\n          failureThreshold: 5\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      - name: node-driver-registrar\n        image: ${NODE_DRIVER_REGISTRAR_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - --v=5\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REG_SOCK_PATH)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REG_SOCK_PATH\n          value: /var/lib/kubelet/plugins/cinder.csi.openstack.org/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      - name: csi-liveness-probe\n        image: ${LIVENESS_PROBE_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - --csi-address=/csi/csi.sock\n        - --probe-timeout=10s\n        - --health-port=10300\n        - --v=${LOG_LEVEL}\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      volumes:\n      - name: socket-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/cinder.csi.openstack.org\n          type: DirectoryOrCreate\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n      - name: pods-probe-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: secret-cinderplugin\n        secret:\n          secretName: openstack-cloud-credentials\n          items:\n          - key: clouds.yaml\n            path: clouds.yaml\n      - name: config-cinderplugin\n        configMap:\n          name: openstack-cinder-config\n          items:\n          - key: cloud.conf\n            path: cloud.conf\n          - key: multiaz-cloud.conf\n            path: multiaz-cloud.conf\n      - name: cacert\n        configMap:\n          name: cloud-provider-config\n          items:\n          - key: ca-bundle.pem\n            path: ca-bundle.pem\n          optional: true\n",
    "policy_id": "latest-tag",
    "violation_text": "The container \"node-driver-registrar\" is using an invalid container image, \"${NODE_DRIVER_REGISTRAR_IMAGE}\". Please use images that are not blocked by the `BlockList` criteria : [\".*:(latest)$\" \"^[^:]*$\" \"(.*/[^:]+)$\"]"
  },
  {
    "id": "03186",
    "manifest_path": "data/manifests/the_stack_sample/sample_1354.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: openstack-cinder-csi-driver-node\n  namespace: openshift-cluster-csi-drivers\n  annotations:\n    config.openshift.io/inject-proxy: csi-driver\nspec:\n  selector:\n    matchLabels:\n      app: openstack-cinder-csi-driver-node\n  template:\n    metadata:\n      labels:\n        app: openstack-cinder-csi-driver-node\n    spec:\n      serviceAccount: openstack-cinder-csi-driver-node-sa\n      containers:\n      - name: csi-driver\n        securityContext:\n          privileged: true\n          capabilities:\n            add:\n            - SYS_ADMIN\n          allowPrivilegeEscalation: true\n        image: ${DRIVER_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - /bin/cinder-csi-plugin\n        - --nodeid=$(NODE_ID)\n        - --endpoint=$(CSI_ENDPOINT)\n        - --cloud-config=$(CLOUD_CONFIG)\n        - --v=${LOG_LEVEL}\n        env:\n        - name: NODE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CSI_ENDPOINT\n          value: unix://csi/csi.sock\n        - name: CLOUD_CONFIG\n          value: /etc/kubernetes/config/cloud.conf\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: Bidirectional\n        - name: pods-probe-dir\n          mountPath: /dev\n          mountPropagation: HostToContainer\n        - name: secret-cinderplugin\n          mountPath: /etc/kubernetes/secret\n          readOnly: true\n        - name: config-cinderplugin\n          mountPath: /etc/kubernetes/config\n          readOnly: true\n        - name: cacert\n          mountPath: /etc/kubernetes/static-pod-resources/configmaps/cloud-config\n        ports:\n        - name: healthz\n          containerPort: 10300\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 10\n          timeoutSeconds: 10\n          periodSeconds: 30\n          failureThreshold: 5\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      - name: node-driver-registrar\n        image: ${NODE_DRIVER_REGISTRAR_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - --v=5\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REG_SOCK_PATH)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REG_SOCK_PATH\n          value: /var/lib/kubelet/plugins/cinder.csi.openstack.org/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      - name: csi-liveness-probe\n        image: ${LIVENESS_PROBE_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - --csi-address=/csi/csi.sock\n        - --probe-timeout=10s\n        - --health-port=10300\n        - --v=${LOG_LEVEL}\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      volumes:\n      - name: socket-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/cinder.csi.openstack.org\n          type: DirectoryOrCreate\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n      - name: pods-probe-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: secret-cinderplugin\n        secret:\n          secretName: openstack-cloud-credentials\n          items:\n          - key: clouds.yaml\n            path: clouds.yaml\n      - name: config-cinderplugin\n        configMap:\n          name: openstack-cinder-config\n          items:\n          - key: cloud.conf\n            path: cloud.conf\n          - key: multiaz-cloud.conf\n            path: multiaz-cloud.conf\n      - name: cacert\n        configMap:\n          name: cloud-provider-config\n          items:\n          - key: ca-bundle.pem\n            path: ca-bundle.pem\n          optional: true\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"csi-driver\" does not have a read-only root file system"
  },
  {
    "id": "03187",
    "manifest_path": "data/manifests/the_stack_sample/sample_1354.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: openstack-cinder-csi-driver-node\n  namespace: openshift-cluster-csi-drivers\n  annotations:\n    config.openshift.io/inject-proxy: csi-driver\nspec:\n  selector:\n    matchLabels:\n      app: openstack-cinder-csi-driver-node\n  template:\n    metadata:\n      labels:\n        app: openstack-cinder-csi-driver-node\n    spec:\n      serviceAccount: openstack-cinder-csi-driver-node-sa\n      containers:\n      - name: csi-driver\n        securityContext:\n          privileged: true\n          capabilities:\n            add:\n            - SYS_ADMIN\n          allowPrivilegeEscalation: true\n        image: ${DRIVER_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - /bin/cinder-csi-plugin\n        - --nodeid=$(NODE_ID)\n        - --endpoint=$(CSI_ENDPOINT)\n        - --cloud-config=$(CLOUD_CONFIG)\n        - --v=${LOG_LEVEL}\n        env:\n        - name: NODE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CSI_ENDPOINT\n          value: unix://csi/csi.sock\n        - name: CLOUD_CONFIG\n          value: /etc/kubernetes/config/cloud.conf\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: Bidirectional\n        - name: pods-probe-dir\n          mountPath: /dev\n          mountPropagation: HostToContainer\n        - name: secret-cinderplugin\n          mountPath: /etc/kubernetes/secret\n          readOnly: true\n        - name: config-cinderplugin\n          mountPath: /etc/kubernetes/config\n          readOnly: true\n        - name: cacert\n          mountPath: /etc/kubernetes/static-pod-resources/configmaps/cloud-config\n        ports:\n        - name: healthz\n          containerPort: 10300\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 10\n          timeoutSeconds: 10\n          periodSeconds: 30\n          failureThreshold: 5\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      - name: node-driver-registrar\n        image: ${NODE_DRIVER_REGISTRAR_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - --v=5\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REG_SOCK_PATH)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REG_SOCK_PATH\n          value: /var/lib/kubelet/plugins/cinder.csi.openstack.org/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      - name: csi-liveness-probe\n        image: ${LIVENESS_PROBE_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - --csi-address=/csi/csi.sock\n        - --probe-timeout=10s\n        - --health-port=10300\n        - --v=${LOG_LEVEL}\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      volumes:\n      - name: socket-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/cinder.csi.openstack.org\n          type: DirectoryOrCreate\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n      - name: pods-probe-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: secret-cinderplugin\n        secret:\n          secretName: openstack-cloud-credentials\n          items:\n          - key: clouds.yaml\n            path: clouds.yaml\n      - name: config-cinderplugin\n        configMap:\n          name: openstack-cinder-config\n          items:\n          - key: cloud.conf\n            path: cloud.conf\n          - key: multiaz-cloud.conf\n            path: multiaz-cloud.conf\n      - name: cacert\n        configMap:\n          name: cloud-provider-config\n          items:\n          - key: ca-bundle.pem\n            path: ca-bundle.pem\n          optional: true\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"csi-liveness-probe\" does not have a read-only root file system"
  },
  {
    "id": "03188",
    "manifest_path": "data/manifests/the_stack_sample/sample_1354.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: openstack-cinder-csi-driver-node\n  namespace: openshift-cluster-csi-drivers\n  annotations:\n    config.openshift.io/inject-proxy: csi-driver\nspec:\n  selector:\n    matchLabels:\n      app: openstack-cinder-csi-driver-node\n  template:\n    metadata:\n      labels:\n        app: openstack-cinder-csi-driver-node\n    spec:\n      serviceAccount: openstack-cinder-csi-driver-node-sa\n      containers:\n      - name: csi-driver\n        securityContext:\n          privileged: true\n          capabilities:\n            add:\n            - SYS_ADMIN\n          allowPrivilegeEscalation: true\n        image: ${DRIVER_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - /bin/cinder-csi-plugin\n        - --nodeid=$(NODE_ID)\n        - --endpoint=$(CSI_ENDPOINT)\n        - --cloud-config=$(CLOUD_CONFIG)\n        - --v=${LOG_LEVEL}\n        env:\n        - name: NODE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CSI_ENDPOINT\n          value: unix://csi/csi.sock\n        - name: CLOUD_CONFIG\n          value: /etc/kubernetes/config/cloud.conf\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: Bidirectional\n        - name: pods-probe-dir\n          mountPath: /dev\n          mountPropagation: HostToContainer\n        - name: secret-cinderplugin\n          mountPath: /etc/kubernetes/secret\n          readOnly: true\n        - name: config-cinderplugin\n          mountPath: /etc/kubernetes/config\n          readOnly: true\n        - name: cacert\n          mountPath: /etc/kubernetes/static-pod-resources/configmaps/cloud-config\n        ports:\n        - name: healthz\n          containerPort: 10300\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 10\n          timeoutSeconds: 10\n          periodSeconds: 30\n          failureThreshold: 5\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      - name: node-driver-registrar\n        image: ${NODE_DRIVER_REGISTRAR_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - --v=5\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REG_SOCK_PATH)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REG_SOCK_PATH\n          value: /var/lib/kubelet/plugins/cinder.csi.openstack.org/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      - name: csi-liveness-probe\n        image: ${LIVENESS_PROBE_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - --csi-address=/csi/csi.sock\n        - --probe-timeout=10s\n        - --health-port=10300\n        - --v=${LOG_LEVEL}\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      volumes:\n      - name: socket-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/cinder.csi.openstack.org\n          type: DirectoryOrCreate\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n      - name: pods-probe-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: secret-cinderplugin\n        secret:\n          secretName: openstack-cloud-credentials\n          items:\n          - key: clouds.yaml\n            path: clouds.yaml\n      - name: config-cinderplugin\n        configMap:\n          name: openstack-cinder-config\n          items:\n          - key: cloud.conf\n            path: cloud.conf\n          - key: multiaz-cloud.conf\n            path: multiaz-cloud.conf\n      - name: cacert\n        configMap:\n          name: cloud-provider-config\n          items:\n          - key: ca-bundle.pem\n            path: ca-bundle.pem\n          optional: true\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"node-driver-registrar\" does not have a read-only root file system"
  },
  {
    "id": "03189",
    "manifest_path": "data/manifests/the_stack_sample/sample_1354.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: openstack-cinder-csi-driver-node\n  namespace: openshift-cluster-csi-drivers\n  annotations:\n    config.openshift.io/inject-proxy: csi-driver\nspec:\n  selector:\n    matchLabels:\n      app: openstack-cinder-csi-driver-node\n  template:\n    metadata:\n      labels:\n        app: openstack-cinder-csi-driver-node\n    spec:\n      serviceAccount: openstack-cinder-csi-driver-node-sa\n      containers:\n      - name: csi-driver\n        securityContext:\n          privileged: true\n          capabilities:\n            add:\n            - SYS_ADMIN\n          allowPrivilegeEscalation: true\n        image: ${DRIVER_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - /bin/cinder-csi-plugin\n        - --nodeid=$(NODE_ID)\n        - --endpoint=$(CSI_ENDPOINT)\n        - --cloud-config=$(CLOUD_CONFIG)\n        - --v=${LOG_LEVEL}\n        env:\n        - name: NODE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CSI_ENDPOINT\n          value: unix://csi/csi.sock\n        - name: CLOUD_CONFIG\n          value: /etc/kubernetes/config/cloud.conf\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: Bidirectional\n        - name: pods-probe-dir\n          mountPath: /dev\n          mountPropagation: HostToContainer\n        - name: secret-cinderplugin\n          mountPath: /etc/kubernetes/secret\n          readOnly: true\n        - name: config-cinderplugin\n          mountPath: /etc/kubernetes/config\n          readOnly: true\n        - name: cacert\n          mountPath: /etc/kubernetes/static-pod-resources/configmaps/cloud-config\n        ports:\n        - name: healthz\n          containerPort: 10300\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 10\n          timeoutSeconds: 10\n          periodSeconds: 30\n          failureThreshold: 5\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      - name: node-driver-registrar\n        image: ${NODE_DRIVER_REGISTRAR_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - --v=5\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REG_SOCK_PATH)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REG_SOCK_PATH\n          value: /var/lib/kubelet/plugins/cinder.csi.openstack.org/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      - name: csi-liveness-probe\n        image: ${LIVENESS_PROBE_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - --csi-address=/csi/csi.sock\n        - --probe-timeout=10s\n        - --health-port=10300\n        - --v=${LOG_LEVEL}\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      volumes:\n      - name: socket-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/cinder.csi.openstack.org\n          type: DirectoryOrCreate\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n      - name: pods-probe-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: secret-cinderplugin\n        secret:\n          secretName: openstack-cloud-credentials\n          items:\n          - key: clouds.yaml\n            path: clouds.yaml\n      - name: config-cinderplugin\n        configMap:\n          name: openstack-cinder-config\n          items:\n          - key: cloud.conf\n            path: cloud.conf\n          - key: multiaz-cloud.conf\n            path: multiaz-cloud.conf\n      - name: cacert\n        configMap:\n          name: cloud-provider-config\n          items:\n          - key: ca-bundle.pem\n            path: ca-bundle.pem\n          optional: true\n",
    "policy_id": "privilege-escalation-container",
    "violation_text": "container \"csi-driver\" has AllowPrivilegeEscalation set to true."
  },
  {
    "id": "03190",
    "manifest_path": "data/manifests/the_stack_sample/sample_1354.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: openstack-cinder-csi-driver-node\n  namespace: openshift-cluster-csi-drivers\n  annotations:\n    config.openshift.io/inject-proxy: csi-driver\nspec:\n  selector:\n    matchLabels:\n      app: openstack-cinder-csi-driver-node\n  template:\n    metadata:\n      labels:\n        app: openstack-cinder-csi-driver-node\n    spec:\n      serviceAccount: openstack-cinder-csi-driver-node-sa\n      containers:\n      - name: csi-driver\n        securityContext:\n          privileged: true\n          capabilities:\n            add:\n            - SYS_ADMIN\n          allowPrivilegeEscalation: true\n        image: ${DRIVER_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - /bin/cinder-csi-plugin\n        - --nodeid=$(NODE_ID)\n        - --endpoint=$(CSI_ENDPOINT)\n        - --cloud-config=$(CLOUD_CONFIG)\n        - --v=${LOG_LEVEL}\n        env:\n        - name: NODE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CSI_ENDPOINT\n          value: unix://csi/csi.sock\n        - name: CLOUD_CONFIG\n          value: /etc/kubernetes/config/cloud.conf\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: Bidirectional\n        - name: pods-probe-dir\n          mountPath: /dev\n          mountPropagation: HostToContainer\n        - name: secret-cinderplugin\n          mountPath: /etc/kubernetes/secret\n          readOnly: true\n        - name: config-cinderplugin\n          mountPath: /etc/kubernetes/config\n          readOnly: true\n        - name: cacert\n          mountPath: /etc/kubernetes/static-pod-resources/configmaps/cloud-config\n        ports:\n        - name: healthz\n          containerPort: 10300\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 10\n          timeoutSeconds: 10\n          periodSeconds: 30\n          failureThreshold: 5\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      - name: node-driver-registrar\n        image: ${NODE_DRIVER_REGISTRAR_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - --v=5\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REG_SOCK_PATH)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REG_SOCK_PATH\n          value: /var/lib/kubelet/plugins/cinder.csi.openstack.org/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      - name: csi-liveness-probe\n        image: ${LIVENESS_PROBE_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - --csi-address=/csi/csi.sock\n        - --probe-timeout=10s\n        - --health-port=10300\n        - --v=${LOG_LEVEL}\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      volumes:\n      - name: socket-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/cinder.csi.openstack.org\n          type: DirectoryOrCreate\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n      - name: pods-probe-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: secret-cinderplugin\n        secret:\n          secretName: openstack-cloud-credentials\n          items:\n          - key: clouds.yaml\n            path: clouds.yaml\n      - name: config-cinderplugin\n        configMap:\n          name: openstack-cinder-config\n          items:\n          - key: cloud.conf\n            path: cloud.conf\n          - key: multiaz-cloud.conf\n            path: multiaz-cloud.conf\n      - name: cacert\n        configMap:\n          name: cloud-provider-config\n          items:\n          - key: ca-bundle.pem\n            path: ca-bundle.pem\n          optional: true\n",
    "policy_id": "privileged-container",
    "violation_text": "container \"csi-driver\" is privileged"
  },
  {
    "id": "03191",
    "manifest_path": "data/manifests/the_stack_sample/sample_1354.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: openstack-cinder-csi-driver-node\n  namespace: openshift-cluster-csi-drivers\n  annotations:\n    config.openshift.io/inject-proxy: csi-driver\nspec:\n  selector:\n    matchLabels:\n      app: openstack-cinder-csi-driver-node\n  template:\n    metadata:\n      labels:\n        app: openstack-cinder-csi-driver-node\n    spec:\n      serviceAccount: openstack-cinder-csi-driver-node-sa\n      containers:\n      - name: csi-driver\n        securityContext:\n          privileged: true\n          capabilities:\n            add:\n            - SYS_ADMIN\n          allowPrivilegeEscalation: true\n        image: ${DRIVER_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - /bin/cinder-csi-plugin\n        - --nodeid=$(NODE_ID)\n        - --endpoint=$(CSI_ENDPOINT)\n        - --cloud-config=$(CLOUD_CONFIG)\n        - --v=${LOG_LEVEL}\n        env:\n        - name: NODE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CSI_ENDPOINT\n          value: unix://csi/csi.sock\n        - name: CLOUD_CONFIG\n          value: /etc/kubernetes/config/cloud.conf\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: Bidirectional\n        - name: pods-probe-dir\n          mountPath: /dev\n          mountPropagation: HostToContainer\n        - name: secret-cinderplugin\n          mountPath: /etc/kubernetes/secret\n          readOnly: true\n        - name: config-cinderplugin\n          mountPath: /etc/kubernetes/config\n          readOnly: true\n        - name: cacert\n          mountPath: /etc/kubernetes/static-pod-resources/configmaps/cloud-config\n        ports:\n        - name: healthz\n          containerPort: 10300\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 10\n          timeoutSeconds: 10\n          periodSeconds: 30\n          failureThreshold: 5\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      - name: node-driver-registrar\n        image: ${NODE_DRIVER_REGISTRAR_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - --v=5\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REG_SOCK_PATH)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REG_SOCK_PATH\n          value: /var/lib/kubelet/plugins/cinder.csi.openstack.org/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      - name: csi-liveness-probe\n        image: ${LIVENESS_PROBE_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - --csi-address=/csi/csi.sock\n        - --probe-timeout=10s\n        - --health-port=10300\n        - --v=${LOG_LEVEL}\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      volumes:\n      - name: socket-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/cinder.csi.openstack.org\n          type: DirectoryOrCreate\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n      - name: pods-probe-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: secret-cinderplugin\n        secret:\n          secretName: openstack-cloud-credentials\n          items:\n          - key: clouds.yaml\n            path: clouds.yaml\n      - name: config-cinderplugin\n        configMap:\n          name: openstack-cinder-config\n          items:\n          - key: cloud.conf\n            path: cloud.conf\n          - key: multiaz-cloud.conf\n            path: multiaz-cloud.conf\n      - name: cacert\n        configMap:\n          name: cloud-provider-config\n          items:\n          - key: ca-bundle.pem\n            path: ca-bundle.pem\n          optional: true\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"csi-driver\" is not set to runAsNonRoot"
  },
  {
    "id": "03192",
    "manifest_path": "data/manifests/the_stack_sample/sample_1354.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: openstack-cinder-csi-driver-node\n  namespace: openshift-cluster-csi-drivers\n  annotations:\n    config.openshift.io/inject-proxy: csi-driver\nspec:\n  selector:\n    matchLabels:\n      app: openstack-cinder-csi-driver-node\n  template:\n    metadata:\n      labels:\n        app: openstack-cinder-csi-driver-node\n    spec:\n      serviceAccount: openstack-cinder-csi-driver-node-sa\n      containers:\n      - name: csi-driver\n        securityContext:\n          privileged: true\n          capabilities:\n            add:\n            - SYS_ADMIN\n          allowPrivilegeEscalation: true\n        image: ${DRIVER_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - /bin/cinder-csi-plugin\n        - --nodeid=$(NODE_ID)\n        - --endpoint=$(CSI_ENDPOINT)\n        - --cloud-config=$(CLOUD_CONFIG)\n        - --v=${LOG_LEVEL}\n        env:\n        - name: NODE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CSI_ENDPOINT\n          value: unix://csi/csi.sock\n        - name: CLOUD_CONFIG\n          value: /etc/kubernetes/config/cloud.conf\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: Bidirectional\n        - name: pods-probe-dir\n          mountPath: /dev\n          mountPropagation: HostToContainer\n        - name: secret-cinderplugin\n          mountPath: /etc/kubernetes/secret\n          readOnly: true\n        - name: config-cinderplugin\n          mountPath: /etc/kubernetes/config\n          readOnly: true\n        - name: cacert\n          mountPath: /etc/kubernetes/static-pod-resources/configmaps/cloud-config\n        ports:\n        - name: healthz\n          containerPort: 10300\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 10\n          timeoutSeconds: 10\n          periodSeconds: 30\n          failureThreshold: 5\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      - name: node-driver-registrar\n        image: ${NODE_DRIVER_REGISTRAR_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - --v=5\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REG_SOCK_PATH)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REG_SOCK_PATH\n          value: /var/lib/kubelet/plugins/cinder.csi.openstack.org/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      - name: csi-liveness-probe\n        image: ${LIVENESS_PROBE_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - --csi-address=/csi/csi.sock\n        - --probe-timeout=10s\n        - --health-port=10300\n        - --v=${LOG_LEVEL}\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      volumes:\n      - name: socket-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/cinder.csi.openstack.org\n          type: DirectoryOrCreate\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n      - name: pods-probe-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: secret-cinderplugin\n        secret:\n          secretName: openstack-cloud-credentials\n          items:\n          - key: clouds.yaml\n            path: clouds.yaml\n      - name: config-cinderplugin\n        configMap:\n          name: openstack-cinder-config\n          items:\n          - key: cloud.conf\n            path: cloud.conf\n          - key: multiaz-cloud.conf\n            path: multiaz-cloud.conf\n      - name: cacert\n        configMap:\n          name: cloud-provider-config\n          items:\n          - key: ca-bundle.pem\n            path: ca-bundle.pem\n          optional: true\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"csi-liveness-probe\" is not set to runAsNonRoot"
  },
  {
    "id": "03193",
    "manifest_path": "data/manifests/the_stack_sample/sample_1354.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: openstack-cinder-csi-driver-node\n  namespace: openshift-cluster-csi-drivers\n  annotations:\n    config.openshift.io/inject-proxy: csi-driver\nspec:\n  selector:\n    matchLabels:\n      app: openstack-cinder-csi-driver-node\n  template:\n    metadata:\n      labels:\n        app: openstack-cinder-csi-driver-node\n    spec:\n      serviceAccount: openstack-cinder-csi-driver-node-sa\n      containers:\n      - name: csi-driver\n        securityContext:\n          privileged: true\n          capabilities:\n            add:\n            - SYS_ADMIN\n          allowPrivilegeEscalation: true\n        image: ${DRIVER_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - /bin/cinder-csi-plugin\n        - --nodeid=$(NODE_ID)\n        - --endpoint=$(CSI_ENDPOINT)\n        - --cloud-config=$(CLOUD_CONFIG)\n        - --v=${LOG_LEVEL}\n        env:\n        - name: NODE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CSI_ENDPOINT\n          value: unix://csi/csi.sock\n        - name: CLOUD_CONFIG\n          value: /etc/kubernetes/config/cloud.conf\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: Bidirectional\n        - name: pods-probe-dir\n          mountPath: /dev\n          mountPropagation: HostToContainer\n        - name: secret-cinderplugin\n          mountPath: /etc/kubernetes/secret\n          readOnly: true\n        - name: config-cinderplugin\n          mountPath: /etc/kubernetes/config\n          readOnly: true\n        - name: cacert\n          mountPath: /etc/kubernetes/static-pod-resources/configmaps/cloud-config\n        ports:\n        - name: healthz\n          containerPort: 10300\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 10\n          timeoutSeconds: 10\n          periodSeconds: 30\n          failureThreshold: 5\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      - name: node-driver-registrar\n        image: ${NODE_DRIVER_REGISTRAR_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - --v=5\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REG_SOCK_PATH)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REG_SOCK_PATH\n          value: /var/lib/kubelet/plugins/cinder.csi.openstack.org/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      - name: csi-liveness-probe\n        image: ${LIVENESS_PROBE_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - --csi-address=/csi/csi.sock\n        - --probe-timeout=10s\n        - --health-port=10300\n        - --v=${LOG_LEVEL}\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      volumes:\n      - name: socket-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/cinder.csi.openstack.org\n          type: DirectoryOrCreate\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n      - name: pods-probe-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: secret-cinderplugin\n        secret:\n          secretName: openstack-cloud-credentials\n          items:\n          - key: clouds.yaml\n            path: clouds.yaml\n      - name: config-cinderplugin\n        configMap:\n          name: openstack-cinder-config\n          items:\n          - key: cloud.conf\n            path: cloud.conf\n          - key: multiaz-cloud.conf\n            path: multiaz-cloud.conf\n      - name: cacert\n        configMap:\n          name: cloud-provider-config\n          items:\n          - key: ca-bundle.pem\n            path: ca-bundle.pem\n          optional: true\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"node-driver-registrar\" is not set to runAsNonRoot"
  },
  {
    "id": "03194",
    "manifest_path": "data/manifests/the_stack_sample/sample_1354.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: openstack-cinder-csi-driver-node\n  namespace: openshift-cluster-csi-drivers\n  annotations:\n    config.openshift.io/inject-proxy: csi-driver\nspec:\n  selector:\n    matchLabels:\n      app: openstack-cinder-csi-driver-node\n  template:\n    metadata:\n      labels:\n        app: openstack-cinder-csi-driver-node\n    spec:\n      serviceAccount: openstack-cinder-csi-driver-node-sa\n      containers:\n      - name: csi-driver\n        securityContext:\n          privileged: true\n          capabilities:\n            add:\n            - SYS_ADMIN\n          allowPrivilegeEscalation: true\n        image: ${DRIVER_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - /bin/cinder-csi-plugin\n        - --nodeid=$(NODE_ID)\n        - --endpoint=$(CSI_ENDPOINT)\n        - --cloud-config=$(CLOUD_CONFIG)\n        - --v=${LOG_LEVEL}\n        env:\n        - name: NODE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CSI_ENDPOINT\n          value: unix://csi/csi.sock\n        - name: CLOUD_CONFIG\n          value: /etc/kubernetes/config/cloud.conf\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: Bidirectional\n        - name: pods-probe-dir\n          mountPath: /dev\n          mountPropagation: HostToContainer\n        - name: secret-cinderplugin\n          mountPath: /etc/kubernetes/secret\n          readOnly: true\n        - name: config-cinderplugin\n          mountPath: /etc/kubernetes/config\n          readOnly: true\n        - name: cacert\n          mountPath: /etc/kubernetes/static-pod-resources/configmaps/cloud-config\n        ports:\n        - name: healthz\n          containerPort: 10300\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 10\n          timeoutSeconds: 10\n          periodSeconds: 30\n          failureThreshold: 5\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      - name: node-driver-registrar\n        image: ${NODE_DRIVER_REGISTRAR_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - --v=5\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REG_SOCK_PATH)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REG_SOCK_PATH\n          value: /var/lib/kubelet/plugins/cinder.csi.openstack.org/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      - name: csi-liveness-probe\n        image: ${LIVENESS_PROBE_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - --csi-address=/csi/csi.sock\n        - --probe-timeout=10s\n        - --health-port=10300\n        - --v=${LOG_LEVEL}\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      volumes:\n      - name: socket-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/cinder.csi.openstack.org\n          type: DirectoryOrCreate\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n      - name: pods-probe-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: secret-cinderplugin\n        secret:\n          secretName: openstack-cloud-credentials\n          items:\n          - key: clouds.yaml\n            path: clouds.yaml\n      - name: config-cinderplugin\n        configMap:\n          name: openstack-cinder-config\n          items:\n          - key: cloud.conf\n            path: cloud.conf\n          - key: multiaz-cloud.conf\n            path: multiaz-cloud.conf\n      - name: cacert\n        configMap:\n          name: cloud-provider-config\n          items:\n          - key: ca-bundle.pem\n            path: ca-bundle.pem\n          optional: true\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"csi-driver\" has memory limit 0"
  },
  {
    "id": "03195",
    "manifest_path": "data/manifests/the_stack_sample/sample_1354.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: openstack-cinder-csi-driver-node\n  namespace: openshift-cluster-csi-drivers\n  annotations:\n    config.openshift.io/inject-proxy: csi-driver\nspec:\n  selector:\n    matchLabels:\n      app: openstack-cinder-csi-driver-node\n  template:\n    metadata:\n      labels:\n        app: openstack-cinder-csi-driver-node\n    spec:\n      serviceAccount: openstack-cinder-csi-driver-node-sa\n      containers:\n      - name: csi-driver\n        securityContext:\n          privileged: true\n          capabilities:\n            add:\n            - SYS_ADMIN\n          allowPrivilegeEscalation: true\n        image: ${DRIVER_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - /bin/cinder-csi-plugin\n        - --nodeid=$(NODE_ID)\n        - --endpoint=$(CSI_ENDPOINT)\n        - --cloud-config=$(CLOUD_CONFIG)\n        - --v=${LOG_LEVEL}\n        env:\n        - name: NODE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CSI_ENDPOINT\n          value: unix://csi/csi.sock\n        - name: CLOUD_CONFIG\n          value: /etc/kubernetes/config/cloud.conf\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: Bidirectional\n        - name: pods-probe-dir\n          mountPath: /dev\n          mountPropagation: HostToContainer\n        - name: secret-cinderplugin\n          mountPath: /etc/kubernetes/secret\n          readOnly: true\n        - name: config-cinderplugin\n          mountPath: /etc/kubernetes/config\n          readOnly: true\n        - name: cacert\n          mountPath: /etc/kubernetes/static-pod-resources/configmaps/cloud-config\n        ports:\n        - name: healthz\n          containerPort: 10300\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 10\n          timeoutSeconds: 10\n          periodSeconds: 30\n          failureThreshold: 5\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      - name: node-driver-registrar\n        image: ${NODE_DRIVER_REGISTRAR_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - --v=5\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REG_SOCK_PATH)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REG_SOCK_PATH\n          value: /var/lib/kubelet/plugins/cinder.csi.openstack.org/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      - name: csi-liveness-probe\n        image: ${LIVENESS_PROBE_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - --csi-address=/csi/csi.sock\n        - --probe-timeout=10s\n        - --health-port=10300\n        - --v=${LOG_LEVEL}\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      volumes:\n      - name: socket-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/cinder.csi.openstack.org\n          type: DirectoryOrCreate\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n      - name: pods-probe-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: secret-cinderplugin\n        secret:\n          secretName: openstack-cloud-credentials\n          items:\n          - key: clouds.yaml\n            path: clouds.yaml\n      - name: config-cinderplugin\n        configMap:\n          name: openstack-cinder-config\n          items:\n          - key: cloud.conf\n            path: cloud.conf\n          - key: multiaz-cloud.conf\n            path: multiaz-cloud.conf\n      - name: cacert\n        configMap:\n          name: cloud-provider-config\n          items:\n          - key: ca-bundle.pem\n            path: ca-bundle.pem\n          optional: true\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"csi-liveness-probe\" has memory limit 0"
  },
  {
    "id": "03196",
    "manifest_path": "data/manifests/the_stack_sample/sample_1354.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: openstack-cinder-csi-driver-node\n  namespace: openshift-cluster-csi-drivers\n  annotations:\n    config.openshift.io/inject-proxy: csi-driver\nspec:\n  selector:\n    matchLabels:\n      app: openstack-cinder-csi-driver-node\n  template:\n    metadata:\n      labels:\n        app: openstack-cinder-csi-driver-node\n    spec:\n      serviceAccount: openstack-cinder-csi-driver-node-sa\n      containers:\n      - name: csi-driver\n        securityContext:\n          privileged: true\n          capabilities:\n            add:\n            - SYS_ADMIN\n          allowPrivilegeEscalation: true\n        image: ${DRIVER_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - /bin/cinder-csi-plugin\n        - --nodeid=$(NODE_ID)\n        - --endpoint=$(CSI_ENDPOINT)\n        - --cloud-config=$(CLOUD_CONFIG)\n        - --v=${LOG_LEVEL}\n        env:\n        - name: NODE_ID\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        - name: CSI_ENDPOINT\n          value: unix://csi/csi.sock\n        - name: CLOUD_CONFIG\n          value: /etc/kubernetes/config/cloud.conf\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: kubelet-dir\n          mountPath: /var/lib/kubelet\n          mountPropagation: Bidirectional\n        - name: pods-probe-dir\n          mountPath: /dev\n          mountPropagation: HostToContainer\n        - name: secret-cinderplugin\n          mountPath: /etc/kubernetes/secret\n          readOnly: true\n        - name: config-cinderplugin\n          mountPath: /etc/kubernetes/config\n          readOnly: true\n        - name: cacert\n          mountPath: /etc/kubernetes/static-pod-resources/configmaps/cloud-config\n        ports:\n        - name: healthz\n          containerPort: 10300\n          protocol: TCP\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: healthz\n          initialDelaySeconds: 10\n          timeoutSeconds: 10\n          periodSeconds: 30\n          failureThreshold: 5\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      - name: node-driver-registrar\n        image: ${NODE_DRIVER_REGISTRAR_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - --v=5\n        - --csi-address=$(ADDRESS)\n        - --kubelet-registration-path=$(DRIVER_REG_SOCK_PATH)\n        env:\n        - name: ADDRESS\n          value: /csi/csi.sock\n        - name: DRIVER_REG_SOCK_PATH\n          value: /var/lib/kubelet/plugins/cinder.csi.openstack.org/csi.sock\n        - name: KUBE_NODE_NAME\n          valueFrom:\n            fieldRef:\n              fieldPath: spec.nodeName\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        - name: registration-dir\n          mountPath: /registration\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      - name: csi-liveness-probe\n        image: ${LIVENESS_PROBE_IMAGE}\n        imagePullPolicy: IfNotPresent\n        args:\n        - --csi-address=/csi/csi.sock\n        - --probe-timeout=10s\n        - --health-port=10300\n        - --v=${LOG_LEVEL}\n        volumeMounts:\n        - name: socket-dir\n          mountPath: /csi\n        resources:\n          requests:\n            memory: 50Mi\n            cpu: 10m\n      volumes:\n      - name: socket-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins/cinder.csi.openstack.org\n          type: DirectoryOrCreate\n      - name: registration-dir\n        hostPath:\n          path: /var/lib/kubelet/plugins_registry/\n          type: Directory\n      - name: kubelet-dir\n        hostPath:\n          path: /var/lib/kubelet\n          type: Directory\n      - name: pods-probe-dir\n        hostPath:\n          path: /dev\n          type: Directory\n      - name: secret-cinderplugin\n        secret:\n          secretName: openstack-cloud-credentials\n          items:\n          - key: clouds.yaml\n            path: clouds.yaml\n      - name: config-cinderplugin\n        configMap:\n          name: openstack-cinder-config\n          items:\n          - key: cloud.conf\n            path: cloud.conf\n          - key: multiaz-cloud.conf\n            path: multiaz-cloud.conf\n      - name: cacert\n        configMap:\n          name: cloud-provider-config\n          items:\n          - key: ca-bundle.pem\n            path: ca-bundle.pem\n          optional: true\n",
    "policy_id": "unset-memory-requirements",
    "violation_text": "container \"node-driver-registrar\" has memory limit 0"
  },
  {
    "id": "03197",
    "manifest_path": "data/manifests/the_stack_sample/sample_1355.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: hsds-bucket-watch\n  name: hsds-bucket-watch\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: hsds-bucket-watch\n  template:\n    metadata:\n      labels:\n        app: hsds-bucket-watch\n    spec:\n      serviceAccountName: hsds-eks-policy\n      containers:\n      - name: watch\n        image: hdfgroup/bucket_loader:v0.3\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 128M\n          limits:\n            memory: 256M\n        volumeMounts:\n        - name: bucket-config\n          mountPath: /config/config.yml\n          subPath: config.yml\n        env:\n        - name: RUN_COMMAND\n          value: watch\n        - name: PASSWORD_FILE\n          value: /config/passwd.txt\n        - name: HS_USERNAME\n          valueFrom:\n            secretKeyRef:\n              name: hs-loader-keys\n              key: hs_username\n        - name: HS_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: hs-loader-keys\n              key: hs_password\n      volumes:\n      - name: accounts\n        secret:\n          secretName: user-password\n      - name: bucket-config\n        configMap:\n          name: hsds-bucket-loader-config\n      - name: hsds-config\n        configMap:\n          name: hsds-config\n      - name: hsds-override\n        configMap:\n          name: hsds-override\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"watch\" does not have a read-only root file system"
  },
  {
    "id": "03198",
    "manifest_path": "data/manifests/the_stack_sample/sample_1355.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: hsds-bucket-watch\n  name: hsds-bucket-watch\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: hsds-bucket-watch\n  template:\n    metadata:\n      labels:\n        app: hsds-bucket-watch\n    spec:\n      serviceAccountName: hsds-eks-policy\n      containers:\n      - name: watch\n        image: hdfgroup/bucket_loader:v0.3\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 128M\n          limits:\n            memory: 256M\n        volumeMounts:\n        - name: bucket-config\n          mountPath: /config/config.yml\n          subPath: config.yml\n        env:\n        - name: RUN_COMMAND\n          value: watch\n        - name: PASSWORD_FILE\n          value: /config/passwd.txt\n        - name: HS_USERNAME\n          valueFrom:\n            secretKeyRef:\n              name: hs-loader-keys\n              key: hs_username\n        - name: HS_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: hs-loader-keys\n              key: hs_password\n      volumes:\n      - name: accounts\n        secret:\n          secretName: user-password\n      - name: bucket-config\n        configMap:\n          name: hsds-bucket-loader-config\n      - name: hsds-config\n        configMap:\n          name: hsds-config\n      - name: hsds-override\n        configMap:\n          name: hsds-override\n",
    "policy_id": "run-as-non-root",
    "violation_text": "container \"watch\" is not set to runAsNonRoot"
  },
  {
    "id": "03199",
    "manifest_path": "data/manifests/the_stack_sample/sample_1355.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: hsds-bucket-watch\n  name: hsds-bucket-watch\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: hsds-bucket-watch\n  template:\n    metadata:\n      labels:\n        app: hsds-bucket-watch\n    spec:\n      serviceAccountName: hsds-eks-policy\n      containers:\n      - name: watch\n        image: hdfgroup/bucket_loader:v0.3\n        imagePullPolicy: IfNotPresent\n        resources:\n          requests:\n            memory: 128M\n          limits:\n            memory: 256M\n        volumeMounts:\n        - name: bucket-config\n          mountPath: /config/config.yml\n          subPath: config.yml\n        env:\n        - name: RUN_COMMAND\n          value: watch\n        - name: PASSWORD_FILE\n          value: /config/passwd.txt\n        - name: HS_USERNAME\n          valueFrom:\n            secretKeyRef:\n              name: hs-loader-keys\n              key: hs_username\n        - name: HS_PASSWORD\n          valueFrom:\n            secretKeyRef:\n              name: hs-loader-keys\n              key: hs_password\n      volumes:\n      - name: accounts\n        secret:\n          secretName: user-password\n      - name: bucket-config\n        configMap:\n          name: hsds-bucket-loader-config\n      - name: hsds-config\n        configMap:\n          name: hsds-config\n      - name: hsds-override\n        configMap:\n          name: hsds-override\n",
    "policy_id": "unset-cpu-requirements",
    "violation_text": "container \"watch\" has cpu request 0"
  },
  {
    "id": "03200",
    "manifest_path": "data/manifests/the_stack_sample/sample_1359.yaml",
    "manifest_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: red\n  labels:\n    app: red\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: red\n  template:\n    metadata:\n      labels:\n        app: red\n    spec:\n      containers:\n      - name: red\n        image: nginx:1.19.2\n        volumeMounts:\n        - name: html\n          mountPath: /usr/share/nginx/html\n        resources:\n          requests:\n            cpu: 100m\n            memory: 100Mi\n          limits:\n            cpu: 100m\n            memory: 100Mi\n      volumes:\n      - name: html\n        configMap:\n          name: red\n          items:\n          - key: body\n            path: index.html\n",
    "policy_id": "no-read-only-root-fs",
    "violation_text": "container \"red\" does not have a read-only root file system"
  }
]