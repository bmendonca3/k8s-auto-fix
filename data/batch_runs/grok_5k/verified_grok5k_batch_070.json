[
  {
    "id": "02801",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: verifier-vcs-add-profiles\nspec:\n  template:\n    spec:\n      volumes:\n      - name: script\n        configMap:\n          name: verifier-vcs-add-profiles-script\n      initContainers:\n      - name: wait\n        image: busybox:stable\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        args:\n        - -c\n        - sleep 5\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - name: healthcheck-ready\n        image: busybox:stable\n        imagePullPolicy: IfNotPresent\n        command:\n        - /bin/sh\n        args:\n        - -c\n        - 'while [[ \"$(wget -T 5 -S --spider http://${VERIFIER_VCS_SERVICE_HOST}/healthcheck\n          2>&1 | grep ''200 OK'')\" == \"\" ]];\n\n          do echo \"waiting for endpoint\";\n\n          sleep 5;\n\n          done;\n\n          '\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      containers:\n      - name: verifier-vcs-add-profiles\n        image: alpine:stable\n        imagePullPolicy: IfNotPresent\n        command:\n        - /bin/sh\n        args:\n        - /opt/vcs_verifier_configure.sh\n        volumeMounts:\n        - name: script\n          mountPath: /opt\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      restartPolicy: OnFailure\n",
    "errors": []
  },
  {
    "id": "02802",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: verifier-vcs-add-profiles\nspec:\n  template:\n    spec:\n      volumes:\n      - name: script\n        configMap:\n          name: verifier-vcs-add-profiles-script\n      initContainers:\n      - name: wait\n        image: busybox:stable\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        args:\n        - -c\n        - sleep 5\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - name: healthcheck-ready\n        image: busybox:stable\n        imagePullPolicy: IfNotPresent\n        command:\n        - /bin/sh\n        args:\n        - -c\n        - 'while [[ \"$(wget -T 5 -S --spider http://${VERIFIER_VCS_SERVICE_HOST}/healthcheck\n          2>&1 | grep ''200 OK'')\" == \"\" ]];\n\n          do echo \"waiting for endpoint\";\n\n          sleep 5;\n\n          done;\n\n          '\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      containers:\n      - name: verifier-vcs-add-profiles\n        image: alpine:stable\n        imagePullPolicy: IfNotPresent\n        command:\n        - /bin/sh\n        args:\n        - /opt/vcs_verifier_configure.sh\n        volumeMounts:\n        - name: script\n          mountPath: /opt\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      restartPolicy: OnFailure\n",
    "errors": []
  },
  {
    "id": "02803",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: verifier-vcs-add-profiles\nspec:\n  template:\n    spec:\n      volumes:\n      - name: script\n        configMap:\n          name: verifier-vcs-add-profiles-script\n      initContainers:\n      - name: wait\n        image: busybox:stable\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        args:\n        - -c\n        - sleep 5\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      - name: healthcheck-ready\n        image: busybox:stable\n        imagePullPolicy: IfNotPresent\n        command:\n        - /bin/sh\n        args:\n        - -c\n        - 'while [[ \"$(wget -T 5 -S --spider http://${VERIFIER_VCS_SERVICE_HOST}/healthcheck\n          2>&1 | grep ''200 OK'')\" == \"\" ]];\n\n          do echo \"waiting for endpoint\";\n\n          sleep 5;\n\n          done;\n\n          '\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      containers:\n      - name: verifier-vcs-add-profiles\n        image: alpine:stable\n        imagePullPolicy: IfNotPresent\n        command:\n        - /bin/sh\n        args:\n        - /opt/vcs_verifier_configure.sh\n        volumeMounts:\n        - name: script\n          mountPath: /opt\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n      restartPolicy: OnFailure\n",
    "errors": []
  },
  {
    "id": "02804",
    "policy_id": "read_only_root_fs",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed: Error from server (Forbidden): error when creating \"STDIN\": pods \"cockroachdb-client-secure\" is forbidden: error looking up service account default/cockroachdb: serviceaccount \"cockroachdb\" not found"
    ]
  },
  {
    "id": "02805",
    "policy_id": "run_as_non_root",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed: Error from server (Forbidden): error when creating \"STDIN\": pods \"cockroachdb-client-secure\" is forbidden: error looking up service account default/cockroachdb: serviceaccount \"cockroachdb\" not found"
    ]
  },
  {
    "id": "02806",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed: Error from server (Forbidden): error when creating \"STDIN\": pods \"cockroachdb-client-secure\" is forbidden: error looking up service account default/cockroachdb: serviceaccount \"cockroachdb\" not found"
    ]
  },
  {
    "id": "02807",
    "policy_id": "set_requests_limits",
    "accepted": false,
    "ok_schema": false,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": null,
    "errors": [
      "kubectl dry-run failed: Error from server (Forbidden): error when creating \"STDIN\": pods \"cockroachdb-client-secure\" is forbidden: error looking up service account default/cockroachdb: serviceaccount \"cockroachdb\" not found"
    ]
  },
  {
    "id": "02808",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: task-4\nspec:\n  containers:\n  - image: ubuntu:stable\n    name: ubuntu\n    command:\n    - /bin/bash\n    - -c\n    args:\n    - sleep 3600\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      privileged: false\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n      readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "02809",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: task-4\nspec:\n  containers:\n  - image: ubuntu:stable\n    name: ubuntu\n    command:\n    - /bin/bash\n    - -c\n    args:\n    - sleep 3600\n    securityContext:\n      readOnlyRootFilesystem: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "02810",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: task-4\nspec:\n  containers:\n  - image: ubuntu:stable\n    name: ubuntu\n    command:\n    - /bin/bash\n    - -c\n    args:\n    - sleep 3600\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      runAsNonRoot: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      readOnlyRootFilesystem: true\n  securityContext:\n    runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "02811",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: task-4\nspec:\n  containers:\n  - image: ubuntu:stable\n    name: ubuntu\n    command:\n    - /bin/bash\n    - -c\n    args:\n    - sleep 3600\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n      readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "02812",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: task-4\nspec:\n  containers:\n  - image: ubuntu:stable\n    name: ubuntu\n    command:\n    - /bin/bash\n    - -c\n    args:\n    - sleep 3600\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    securityContext:\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n      readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "02813",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: phpmyadmin\nspec:\n  selector:\n    matchLabels:\n      app: phpmyadmin\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: phpmyadmin\n    spec:\n      containers:\n      - image: my_phpmyadmin:stable\n        name: phpmyadmin\n        imagePullPolicy: Never\n        ports:\n        - name: php-port\n          containerPort: 5000\n        livenessProbe:\n          exec:\n            command:\n            - sh\n            - -c\n            - service telegraf status && service nginx status && service mariadb status\n              && service php-fpm7 status\n          initialDelaySeconds: 5\n          periodSeconds: 5\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "02814",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: phpmyadmin\nspec:\n  selector:\n    matchLabels:\n      app: phpmyadmin\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: phpmyadmin\n    spec:\n      containers:\n      - image: my_phpmyadmin:stable\n        name: phpmyadmin\n        imagePullPolicy: Never\n        ports:\n        - name: php-port\n          containerPort: 5000\n        livenessProbe:\n          exec:\n            command:\n            - sh\n            - -c\n            - service telegraf status && service nginx status && service mariadb status\n              && service php-fpm7 status\n          initialDelaySeconds: 5\n          periodSeconds: 5\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "02815",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: phpmyadmin\nspec:\n  selector:\n    matchLabels:\n      app: phpmyadmin\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: phpmyadmin\n    spec:\n      containers:\n      - image: my_phpmyadmin:stable\n        name: phpmyadmin\n        imagePullPolicy: Never\n        ports:\n        - name: php-port\n          containerPort: 5000\n        livenessProbe:\n          exec:\n            command:\n            - sh\n            - -c\n            - service telegraf status && service nginx status && service mariadb status\n              && service php-fpm7 status\n          initialDelaySeconds: 5\n          periodSeconds: 5\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "02816",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: phpmyadmin\nspec:\n  selector:\n    matchLabels:\n      app: phpmyadmin\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: phpmyadmin\n    spec:\n      containers:\n      - image: my_phpmyadmin:stable\n        name: phpmyadmin\n        imagePullPolicy: Never\n        ports:\n        - name: php-port\n          containerPort: 5000\n        livenessProbe:\n          exec:\n            command:\n            - sh\n            - -c\n            - service telegraf status && service nginx status && service mariadb status\n              && service php-fpm7 status\n          initialDelaySeconds: 5\n          periodSeconds: 5\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "02817",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: phpmyadmin\nspec:\n  selector:\n    matchLabels:\n      app: phpmyadmin\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        app: phpmyadmin\n    spec:\n      containers:\n      - image: my_phpmyadmin:stable\n        name: phpmyadmin\n        imagePullPolicy: Never\n        ports:\n        - name: php-port\n          containerPort: 5000\n        livenessProbe:\n          exec:\n            command:\n            - sh\n            - -c\n            - service telegraf status && service nginx status && service mariadb status\n              && service php-fpm7 status\n          initialDelaySeconds: 5\n          periodSeconds: 5\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "02818",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: hrz\nspec:\n  selector:\n    matchLabels:\n      app: hrz\n  template:\n    metadata:\n      labels:\n        app: hrz\n    spec:\n      containers:\n      - name: sitecore-horizon\n        env:\n        - name: Sitecore_Plugins__Filters__ContentHub\n          value: +ContentHub\n        image: busybox:stable\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n",
    "errors": []
  },
  {
    "id": "02819",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: hrz\nspec:\n  selector:\n    matchLabels:\n      app: hrz\n  template:\n    metadata:\n      labels:\n        app: hrz\n    spec:\n      containers:\n      - name: sitecore-horizon\n        env:\n        - name: Sitecore_Plugins__Filters__ContentHub\n          value: +ContentHub\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        image: busybox:stable\n",
    "errors": []
  },
  {
    "id": "02820",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: hrz\nspec:\n  selector:\n    matchLabels:\n      app: hrz\n  template:\n    metadata:\n      labels:\n        app: hrz\n    spec:\n      containers:\n      - name: sitecore-horizon\n        env:\n        - name: Sitecore_Plugins__Filters__ContentHub\n          value: +ContentHub\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        image: busybox:stable\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "02821",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: hrz\nspec:\n  selector:\n    matchLabels:\n      app: hrz\n  template:\n    metadata:\n      labels:\n        app: hrz\n    spec:\n      containers:\n      - name: sitecore-horizon\n        env:\n        - name: Sitecore_Plugins__Filters__ContentHub\n          value: +ContentHub\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        image: busybox:stable\n",
    "errors": []
  },
  {
    "id": "02822",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: hrz\nspec:\n  selector:\n    matchLabels:\n      app: hrz\n  template:\n    metadata:\n      labels:\n        app: hrz\n    spec:\n      containers:\n      - name: sitecore-horizon\n        env:\n        - name: Sitecore_Plugins__Filters__ContentHub\n          value: +ContentHub\n        resources:\n          requests:\n            cpu: 100m\n            memory: 128Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        image: busybox:stable\n",
    "errors": []
  },
  {
    "id": "02823",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: gcsb-run\n  namespace: gcsb\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: gcsb-run\n  template:\n    metadata:\n      labels:\n        app: gcsb-run\n    spec:\n      serviceAccountName: gcsb\n      containers:\n      - name: gcsb-run\n        image: gcr.io/<project>/gcsb:stable\n        command:\n        - /gcsb\n        - run\n        args:\n        - --project=YOUR_PROJECT_ID\n        - --instance=YOUR_INSTANCE_ID\n        - --database=YOUR_DATABASE\n        - --table=YOUR_TABLE\n        - --operations=1000000\n        - --threads=10\n        - --reads=50\n        - --writes=50\n        - --sample-size=5\n        resources:\n          requests:\n            cpu: '6'\n            memory: 4Gi\n          limits:\n            cpu: '6'\n            memory: 4Gi\n        securityContext:\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          privileged: false\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "02824",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: gcsb-run\n  namespace: gcsb\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: gcsb-run\n  template:\n    metadata:\n      labels:\n        app: gcsb-run\n    spec:\n      serviceAccountName: gcsb\n      containers:\n      - name: gcsb-run\n        image: gcr.io/<project>/gcsb:stable\n        command:\n        - /gcsb\n        - run\n        args:\n        - --project=YOUR_PROJECT_ID\n        - --instance=YOUR_INSTANCE_ID\n        - --database=YOUR_DATABASE\n        - --table=YOUR_TABLE\n        - --operations=1000000\n        - --threads=10\n        - --reads=50\n        - --writes=50\n        - --sample-size=5\n        resources:\n          requests:\n            cpu: '6'\n            memory: 4Gi\n          limits:\n            cpu: '6'\n            memory: 4Gi\n        securityContext:\n          readOnlyRootFilesystem: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "02825",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: gcsb-run\n  namespace: gcsb\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: gcsb-run\n  template:\n    metadata:\n      labels:\n        app: gcsb-run\n    spec:\n      serviceAccountName: gcsb\n      containers:\n      - name: gcsb-run\n        image: gcr.io/<project>/gcsb:stable\n        command:\n        - /gcsb\n        - run\n        args:\n        - --project=YOUR_PROJECT_ID\n        - --instance=YOUR_INSTANCE_ID\n        - --database=YOUR_DATABASE\n        - --table=YOUR_TABLE\n        - --operations=1000000\n        - --threads=10\n        - --reads=50\n        - --writes=50\n        - --sample-size=5\n        resources:\n          requests:\n            cpu: '6'\n            memory: 4Gi\n          limits:\n            cpu: '6'\n            memory: 4Gi\n        securityContext:\n          runAsNonRoot: true\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "02826",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: openshift-oauth-apiserver\n  name: apiserver\n  labels:\n    app: openshift-oauth-apiserver\n    apiserver: 'true'\nspec:\n  selector:\n    matchLabels:\n      app: openshift-oauth-apiserver\n      apiserver: 'true'\n  template:\n    metadata:\n      name: openshift-oauth-apiserver\n      labels:\n        app: openshift-oauth-apiserver\n        apiserver: 'true'\n    spec:\n      serviceAccountName: oauth-apiserver-sa\n      initContainers:\n      - name: fix-audit-permissions\n        image: ${IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - chmod 0700 /var/log/oauth-apiserver && touch /var/log/oauth-apiserver/audit.log\n          && chmod 0600 /var/log/oauth-apiserver/*\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 15m\n            memory: 50Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        volumeMounts:\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n      containers:\n      - name: oauth-apiserver\n        image: ${IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        command:\n        - /bin/bash\n        - -ec\n        args:\n        - \"if [ -s /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem ]; then\\n\\\n          \\  echo \\\"Copying system trust bundle\\\"\\n  cp -f /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem\\\n          \\ /etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem\\nfi\\nexec oauth-apiserver\\\n          \\ start \\\\\\n  --secure-port=8443 \\\\\\n  --audit-log-path=/var/log/oauth-apiserver/audit.log\\\n          \\ \\\\\\n  --audit-log-format=json \\\\\\n  --audit-log-maxsize=100 \\\\\\n  --audit-log-maxbackup=10\\\n          \\ \\\\\\n  --etcd-cafile=/var/run/configmaps/etcd-serving-ca/ca-bundle.crt\\\n          \\ \\\\\\n  --etcd-keyfile=/var/run/secrets/etcd-client/tls.key \\\\\\n  --etcd-certfile=/var/run/secrets/etcd-client/tls.crt\\\n          \\ \\\\\\n  --shutdown-delay-duration=3s \\\\\\n  --tls-private-key-file=/var/run/secrets/serving-cert/tls.key\\\n          \\ \\\\\\n  --tls-cert-file=/var/run/secrets/serving-cert/tls.crt \\\\\\n  ${FLAGS}\\n\"\n        resources:\n          requests:\n            memory: 200Mi\n            cpu: 150m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        ports:\n        - containerPort: 8443\n        volumeMounts:\n        - mountPath: /var/run/configmaps/audit\n          name: audit-policies\n        - mountPath: /var/run/secrets/etcd-client\n          name: etcd-client\n        - mountPath: /var/run/configmaps/etcd-serving-ca\n          name: etcd-serving-ca\n        - mountPath: /var/run/configmaps/trusted-ca-bundle\n          name: trusted-ca-bundle\n        - mountPath: /var/run/secrets/serving-cert\n          name: serving-cert\n        - mountPath: /var/run/secrets/encryption-config\n          name: encryption-config\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n        livenessProbe:\n          initialDelaySeconds: 30\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: healthz\n        readinessProbe:\n          failureThreshold: 10\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: readyz\n      volumes:\n      - name: audit-policies\n        configMap:\n          name: audit-${REVISION}\n      - name: etcd-client\n        secret:\n          secretName: etcd-client\n      - name: etcd-serving-ca\n        configMap:\n          name: etcd-serving-ca\n      - name: serving-cert\n        secret:\n          secretName: serving-cert\n      - name: trusted-ca-bundle\n        configMap:\n          name: trusted-ca-bundle\n          optional: true\n          items:\n          - key: ca-bundle.crt\n            path: tls-ca-bundle.pem\n      - name: encryption-config\n        secret:\n          secretName: encryption-config-${REVISION}\n          optional: true\n      - name: audit-dir\n        emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "02827",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: openshift-oauth-apiserver\n  name: apiserver\n  labels:\n    app: openshift-oauth-apiserver\n    apiserver: 'true'\nspec:\n  selector:\n    matchLabels:\n      app: openshift-oauth-apiserver\n      apiserver: 'true'\n  template:\n    metadata:\n      name: openshift-oauth-apiserver\n      labels:\n        app: openshift-oauth-apiserver\n        apiserver: 'true'\n    spec:\n      serviceAccountName: oauth-apiserver-sa\n      initContainers:\n      - name: fix-audit-permissions\n        image: ${IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - chmod 0700 /var/log/oauth-apiserver && touch /var/log/oauth-apiserver/audit.log\n          && chmod 0600 /var/log/oauth-apiserver/*\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 15m\n            memory: 50Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        volumeMounts:\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n      containers:\n      - name: oauth-apiserver\n        image: ${IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        command:\n        - /bin/bash\n        - -ec\n        args:\n        - \"if [ -s /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem ]; then\\n\\\n          \\  echo \\\"Copying system trust bundle\\\"\\n  cp -f /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem\\\n          \\ /etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem\\nfi\\nexec oauth-apiserver\\\n          \\ start \\\\\\n  --secure-port=8443 \\\\\\n  --audit-log-path=/var/log/oauth-apiserver/audit.log\\\n          \\ \\\\\\n  --audit-log-format=json \\\\\\n  --audit-log-maxsize=100 \\\\\\n  --audit-log-maxbackup=10\\\n          \\ \\\\\\n  --etcd-cafile=/var/run/configmaps/etcd-serving-ca/ca-bundle.crt\\\n          \\ \\\\\\n  --etcd-keyfile=/var/run/secrets/etcd-client/tls.key \\\\\\n  --etcd-certfile=/var/run/secrets/etcd-client/tls.crt\\\n          \\ \\\\\\n  --shutdown-delay-duration=3s \\\\\\n  --tls-private-key-file=/var/run/secrets/serving-cert/tls.key\\\n          \\ \\\\\\n  --tls-cert-file=/var/run/secrets/serving-cert/tls.crt \\\\\\n  ${FLAGS}\\n\"\n        resources:\n          requests:\n            memory: 200Mi\n            cpu: 150m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        ports:\n        - containerPort: 8443\n        volumeMounts:\n        - mountPath: /var/run/configmaps/audit\n          name: audit-policies\n        - mountPath: /var/run/secrets/etcd-client\n          name: etcd-client\n        - mountPath: /var/run/configmaps/etcd-serving-ca\n          name: etcd-serving-ca\n        - mountPath: /var/run/configmaps/trusted-ca-bundle\n          name: trusted-ca-bundle\n        - mountPath: /var/run/secrets/serving-cert\n          name: serving-cert\n        - mountPath: /var/run/secrets/encryption-config\n          name: encryption-config\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n        livenessProbe:\n          initialDelaySeconds: 30\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: healthz\n        readinessProbe:\n          failureThreshold: 10\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: readyz\n      volumes:\n      - name: audit-policies\n        configMap:\n          name: audit-${REVISION}\n      - name: etcd-client\n        secret:\n          secretName: etcd-client\n      - name: etcd-serving-ca\n        configMap:\n          name: etcd-serving-ca\n      - name: serving-cert\n        secret:\n          secretName: serving-cert\n      - name: trusted-ca-bundle\n        configMap:\n          name: trusted-ca-bundle\n          optional: true\n          items:\n          - key: ca-bundle.crt\n            path: tls-ca-bundle.pem\n      - name: encryption-config\n        secret:\n          secretName: encryption-config-${REVISION}\n          optional: true\n      - name: audit-dir\n        emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "02828",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: openshift-oauth-apiserver\n  name: apiserver\n  labels:\n    app: openshift-oauth-apiserver\n    apiserver: 'true'\nspec:\n  selector:\n    matchLabels:\n      app: openshift-oauth-apiserver\n      apiserver: 'true'\n  template:\n    metadata:\n      name: openshift-oauth-apiserver\n      labels:\n        app: openshift-oauth-apiserver\n        apiserver: 'true'\n    spec:\n      serviceAccountName: oauth-apiserver-sa\n      initContainers:\n      - name: fix-audit-permissions\n        image: ${IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - chmod 0700 /var/log/oauth-apiserver && touch /var/log/oauth-apiserver/audit.log\n          && chmod 0600 /var/log/oauth-apiserver/*\n        securityContext:\n          privileged: false\n          readOnlyRootFilesystem: true\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 15m\n            memory: 50Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        volumeMounts:\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n      containers:\n      - name: oauth-apiserver\n        image: ${IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        command:\n        - /bin/bash\n        - -ec\n        args:\n        - \"if [ -s /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem ]; then\\n\\\n          \\  echo \\\"Copying system trust bundle\\\"\\n  cp -f /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem\\\n          \\ /etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem\\nfi\\nexec oauth-apiserver\\\n          \\ start \\\\\\n  --secure-port=8443 \\\\\\n  --audit-log-path=/var/log/oauth-apiserver/audit.log\\\n          \\ \\\\\\n  --audit-log-format=json \\\\\\n  --audit-log-maxsize=100 \\\\\\n  --audit-log-maxbackup=10\\\n          \\ \\\\\\n  --etcd-cafile=/var/run/configmaps/etcd-serving-ca/ca-bundle.crt\\\n          \\ \\\\\\n  --etcd-keyfile=/var/run/secrets/etcd-client/tls.key \\\\\\n  --etcd-certfile=/var/run/secrets/etcd-client/tls.crt\\\n          \\ \\\\\\n  --shutdown-delay-duration=3s \\\\\\n  --tls-private-key-file=/var/run/secrets/serving-cert/tls.key\\\n          \\ \\\\\\n  --tls-cert-file=/var/run/secrets/serving-cert/tls.crt \\\\\\n  ${FLAGS}\\n\"\n        resources:\n          requests:\n            memory: 200Mi\n            cpu: 150m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          readOnlyRootFilesystem: true\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n        ports:\n        - containerPort: 8443\n        volumeMounts:\n        - mountPath: /var/run/configmaps/audit\n          name: audit-policies\n        - mountPath: /var/run/secrets/etcd-client\n          name: etcd-client\n        - mountPath: /var/run/configmaps/etcd-serving-ca\n          name: etcd-serving-ca\n        - mountPath: /var/run/configmaps/trusted-ca-bundle\n          name: trusted-ca-bundle\n        - mountPath: /var/run/secrets/serving-cert\n          name: serving-cert\n        - mountPath: /var/run/secrets/encryption-config\n          name: encryption-config\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n        - mountPath: /etc/pki/ca-trust/extracted\n          name: ca-trust-dir\n        livenessProbe:\n          initialDelaySeconds: 30\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: healthz\n        readinessProbe:\n          failureThreshold: 10\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: readyz\n      volumes:\n      - name: audit-policies\n        configMap:\n          name: audit-${REVISION}\n      - name: etcd-client\n        secret:\n          secretName: etcd-client\n      - name: etcd-serving-ca\n        configMap:\n          name: etcd-serving-ca\n      - name: serving-cert\n        secret:\n          secretName: serving-cert\n      - name: trusted-ca-bundle\n        configMap:\n          name: trusted-ca-bundle\n          optional: true\n          items:\n          - key: ca-bundle.crt\n            path: tls-ca-bundle.pem\n      - name: encryption-config\n        secret:\n          secretName: encryption-config-${REVISION}\n          optional: true\n      - name: audit-dir\n        emptyDir: {}\n      - name: ca-trust-dir\n        emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "02829",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: openshift-oauth-apiserver\n  name: apiserver\n  labels:\n    app: openshift-oauth-apiserver\n    apiserver: 'true'\nspec:\n  selector:\n    matchLabels:\n      app: openshift-oauth-apiserver\n      apiserver: 'true'\n  template:\n    metadata:\n      name: openshift-oauth-apiserver\n      labels:\n        app: openshift-oauth-apiserver\n        apiserver: 'true'\n    spec:\n      serviceAccountName: oauth-apiserver-sa\n      initContainers:\n      - name: fix-audit-permissions\n        image: ${IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - chmod 0700 /var/log/oauth-apiserver && touch /var/log/oauth-apiserver/audit.log\n          && chmod 0600 /var/log/oauth-apiserver/*\n        securityContext:\n          privileged: false\n          readOnlyRootFilesystem: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 15m\n            memory: 50Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        volumeMounts:\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n      containers:\n      - name: oauth-apiserver\n        image: ${IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        command:\n        - /bin/bash\n        - -ec\n        args:\n        - \"if [ -s /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem ]; then\\n\\\n          \\  echo \\\"Copying system trust bundle\\\"\\n  cp -f /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem\\\n          \\ /etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem\\nfi\\nexec oauth-apiserver\\\n          \\ start \\\\\\n  --secure-port=8443 \\\\\\n  --audit-log-path=/var/log/oauth-apiserver/audit.log\\\n          \\ \\\\\\n  --audit-log-format=json \\\\\\n  --audit-log-maxsize=100 \\\\\\n  --audit-log-maxbackup=10\\\n          \\ \\\\\\n  --etcd-cafile=/var/run/configmaps/etcd-serving-ca/ca-bundle.crt\\\n          \\ \\\\\\n  --etcd-keyfile=/var/run/secrets/etcd-client/tls.key \\\\\\n  --etcd-certfile=/var/run/secrets/etcd-client/tls.crt\\\n          \\ \\\\\\n  --shutdown-delay-duration=3s \\\\\\n  --tls-private-key-file=/var/run/secrets/serving-cert/tls.key\\\n          \\ \\\\\\n  --tls-cert-file=/var/run/secrets/serving-cert/tls.crt \\\\\\n  ${FLAGS}\\n\"\n        resources:\n          requests:\n            memory: 200Mi\n            cpu: 150m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          readOnlyRootFilesystem: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n        ports:\n        - containerPort: 8443\n        volumeMounts:\n        - mountPath: /var/run/configmaps/audit\n          name: audit-policies\n        - mountPath: /var/run/secrets/etcd-client\n          name: etcd-client\n        - mountPath: /var/run/configmaps/etcd-serving-ca\n          name: etcd-serving-ca\n        - mountPath: /var/run/configmaps/trusted-ca-bundle\n          name: trusted-ca-bundle\n        - mountPath: /var/run/secrets/serving-cert\n          name: serving-cert\n        - mountPath: /var/run/secrets/encryption-config\n          name: encryption-config\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n        - mountPath: /etc/pki/ca-trust/extracted/pem\n          name: ca-trust\n        livenessProbe:\n          initialDelaySeconds: 30\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: healthz\n        readinessProbe:\n          failureThreshold: 10\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: readyz\n      volumes:\n      - name: audit-policies\n        configMap:\n          name: audit-${REVISION}\n      - name: etcd-client\n        secret:\n          secretName: etcd-client\n      - name: etcd-serving-ca\n        configMap:\n          name: etcd-serving-ca\n      - name: serving-cert\n        secret:\n          secretName: serving-cert\n      - name: trusted-ca-bundle\n        configMap:\n          name: trusted-ca-bundle\n          optional: true\n          items:\n          - key: ca-bundle.crt\n            path: tls-ca-bundle.pem\n      - name: encryption-config\n        secret:\n          secretName: encryption-config-${REVISION}\n          optional: true\n      - name: audit-dir\n        emptyDir: {}\n      - name: ca-trust\n        emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "02830",
    "policy_id": "drop_capabilities",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: openshift-oauth-apiserver\n  name: apiserver\n  labels:\n    app: openshift-oauth-apiserver\n    apiserver: 'true'\nspec:\n  selector:\n    matchLabels:\n      app: openshift-oauth-apiserver\n      apiserver: 'true'\n  template:\n    metadata:\n      name: openshift-oauth-apiserver\n      labels:\n        app: openshift-oauth-apiserver\n        apiserver: 'true'\n    spec:\n      serviceAccountName: oauth-apiserver-sa\n      initContainers:\n      - name: fix-audit-permissions\n        image: ${IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - chmod 0700 /var/log/oauth-apiserver && touch /var/log/oauth-apiserver/audit.log\n          && chmod 0600 /var/log/oauth-apiserver/*\n        securityContext:\n          privileged: false\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 15m\n            memory: 50Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        volumeMounts:\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n      containers:\n      - name: oauth-apiserver\n        image: ${IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        command:\n        - /bin/bash\n        - -ec\n        args:\n        - \"if [ -s /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem ]; then\\n\\\n          \\  echo \\\"Copying system trust bundle\\\"\\n  cp -f /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem\\\n          \\ /etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem\\nfi\\nexec oauth-apiserver\\\n          \\ start \\\\\\n  --secure-port=8443 \\\\\\n  --audit-log-path=/var/log/oauth-apiserver/audit.log\\\n          \\ \\\\\\n  --audit-log-format=json \\\\\\n  --audit-log-maxsize=100 \\\\\\n  --audit-log-maxbackup=10\\\n          \\ \\\\\\n  --etcd-cafile=/var/run/configmaps/etcd-serving-ca/ca-bundle.crt\\\n          \\ \\\\\\n  --etcd-keyfile=/var/run/secrets/etcd-client/tls.key \\\\\\n  --etcd-certfile=/var/run/secrets/etcd-client/tls.crt\\\n          \\ \\\\\\n  --shutdown-delay-duration=3s \\\\\\n  --tls-private-key-file=/var/run/secrets/serving-cert/tls.key\\\n          \\ \\\\\\n  --tls-cert-file=/var/run/secrets/serving-cert/tls.crt \\\\\\n  ${FLAGS}\\n\"\n        resources:\n          requests:\n            memory: 200Mi\n            cpu: 150m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        ports:\n        - containerPort: 8443\n        volumeMounts:\n        - mountPath: /var/run/configmaps/audit\n          name: audit-policies\n        - mountPath: /var/run/secrets/etcd-client\n          name: etcd-client\n        - mountPath: /var/run/configmaps/etcd-serving-ca\n          name: etcd-serving-ca\n        - mountPath: /var/run/configmaps/trusted-ca-bundle\n          name: trusted-ca-bundle\n        - mountPath: /var/run/secrets/serving-cert\n          name: serving-cert\n        - mountPath: /var/run/secrets/encryption-config\n          name: encryption-config\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n        livenessProbe:\n          initialDelaySeconds: 30\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: healthz\n        readinessProbe:\n          failureThreshold: 10\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: readyz\n      volumes:\n      - name: audit-policies\n        configMap:\n          name: audit-${REVISION}\n      - name: etcd-client\n        secret:\n          secretName: etcd-client\n      - name: etcd-serving-ca\n        configMap:\n          name: etcd-serving-ca\n      - name: serving-cert\n        secret:\n          secretName: serving-cert\n      - name: trusted-ca-bundle\n        configMap:\n          name: trusted-ca-bundle\n          optional: true\n          items:\n          - key: ca-bundle.crt\n            path: tls-ca-bundle.pem\n      - name: encryption-config\n        secret:\n          secretName: encryption-config-${REVISION}\n          optional: true\n      - name: audit-dir\n        emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "02831",
    "policy_id": "drop_capabilities",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: openshift-oauth-apiserver\n  name: apiserver\n  labels:\n    app: openshift-oauth-apiserver\n    apiserver: 'true'\nspec:\n  selector:\n    matchLabels:\n      app: openshift-oauth-apiserver\n      apiserver: 'true'\n  template:\n    metadata:\n      name: openshift-oauth-apiserver\n      labels:\n        app: openshift-oauth-apiserver\n        apiserver: 'true'\n    spec:\n      serviceAccountName: oauth-apiserver-sa\n      initContainers:\n      - name: fix-audit-permissions\n        image: ${IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - chmod 0700 /var/log/oauth-apiserver && touch /var/log/oauth-apiserver/audit.log\n          && chmod 0600 /var/log/oauth-apiserver/*\n        securityContext:\n          privileged: false\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 15m\n            memory: 50Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        volumeMounts:\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n      containers:\n      - name: oauth-apiserver\n        image: ${IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        command:\n        - /bin/bash\n        - -ec\n        args:\n        - \"if [ -s /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem ]; then\\n\\\n          \\  echo \\\"Copying system trust bundle\\\"\\n  cp -f /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem\\\n          \\ /etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem\\nfi\\nexec oauth-apiserver\\\n          \\ start \\\\\\n  --secure-port=8443 \\\\\\n  --audit-log-path=/var/log/oauth-apiserver/audit.log\\\n          \\ \\\\\\n  --audit-log-format=json \\\\\\n  --audit-log-maxsize=100 \\\\\\n  --audit-log-maxbackup=10\\\n          \\ \\\\\\n  --etcd-cafile=/var/run/configmaps/etcd-serving-ca/ca-bundle.crt\\\n          \\ \\\\\\n  --etcd-keyfile=/var/run/secrets/etcd-client/tls.key \\\\\\n  --etcd-certfile=/var/run/secrets/etcd-client/tls.crt\\\n          \\ \\\\\\n  --shutdown-delay-duration=3s \\\\\\n  --tls-private-key-file=/var/run/secrets/serving-cert/tls.key\\\n          \\ \\\\\\n  --tls-cert-file=/var/run/secrets/serving-cert/tls.crt \\\\\\n  ${FLAGS}\\n\"\n        resources:\n          requests:\n            memory: 200Mi\n            cpu: 150m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          allowPrivilegeEscalation: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        ports:\n        - containerPort: 8443\n        volumeMounts:\n        - mountPath: /var/run/configmaps/audit\n          name: audit-policies\n        - mountPath: /var/run/secrets/etcd-client\n          name: etcd-client\n        - mountPath: /var/run/configmaps/etcd-serving-ca\n          name: etcd-serving-ca\n        - mountPath: /var/run/configmaps/trusted-ca-bundle\n          name: trusted-ca-bundle\n        - mountPath: /var/run/secrets/serving-cert\n          name: serving-cert\n        - mountPath: /var/run/secrets/encryption-config\n          name: encryption-config\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n        livenessProbe:\n          initialDelaySeconds: 30\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: healthz\n        readinessProbe:\n          failureThreshold: 10\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: readyz\n      volumes:\n      - name: audit-policies\n        configMap:\n          name: audit-${REVISION}\n      - name: etcd-client\n        secret:\n          secretName: etcd-client\n      - name: etcd-serving-ca\n        configMap:\n          name: etcd-serving-ca\n      - name: serving-cert\n        secret:\n          secretName: serving-cert\n      - name: trusted-ca-bundle\n        configMap:\n          name: trusted-ca-bundle\n          optional: true\n          items:\n          - key: ca-bundle.crt\n            path: tls-ca-bundle.pem\n      - name: encryption-config\n        secret:\n          secretName: encryption-config-${REVISION}\n          optional: true\n      - name: audit-dir\n        emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "02832",
    "policy_id": "no_privileged",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: openshift-oauth-apiserver\n  name: apiserver\n  labels:\n    app: openshift-oauth-apiserver\n    apiserver: 'true'\nspec:\n  selector:\n    matchLabels:\n      app: openshift-oauth-apiserver\n      apiserver: 'true'\n  template:\n    metadata:\n      name: openshift-oauth-apiserver\n      labels:\n        app: openshift-oauth-apiserver\n        apiserver: 'true'\n    spec:\n      serviceAccountName: oauth-apiserver-sa\n      initContainers:\n      - name: fix-audit-permissions\n        image: ${IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - chmod 0700 /var/log/oauth-apiserver && touch /var/log/oauth-apiserver/audit.log\n          && chmod 0600 /var/log/oauth-apiserver/*\n        securityContext:\n          privileged: false\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n        resources:\n          requests:\n            cpu: 15m\n            memory: 50Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        volumeMounts:\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n      containers:\n      - name: oauth-apiserver\n        image: ${IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        command:\n        - /bin/bash\n        - -ec\n        args:\n        - \"if [ -s /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem ]; then\\n\\\n          \\  echo \\\"Copying system trust bundle\\\"\\n  cp -f /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem\\\n          \\ /etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem\\nfi\\nexec oauth-apiserver\\\n          \\ start \\\\\\n  --secure-port=8443 \\\\\\n  --audit-log-path=/var/log/oauth-apiserver/audit.log\\\n          \\ \\\\\\n  --audit-log-format=json \\\\\\n  --audit-log-maxsize=100 \\\\\\n  --audit-log-maxbackup=10\\\n          \\ \\\\\\n  --etcd-cafile=/var/run/configmaps/etcd-serving-ca/ca-bundle.crt\\\n          \\ \\\\\\n  --etcd-keyfile=/var/run/secrets/etcd-client/tls.key \\\\\\n  --etcd-certfile=/var/run/secrets/etcd-client/tls.crt\\\n          \\ \\\\\\n  --shutdown-delay-duration=3s \\\\\\n  --tls-private-key-file=/var/run/secrets/serving-cert/tls.key\\\n          \\ \\\\\\n  --tls-cert-file=/var/run/secrets/serving-cert/tls.crt \\\\\\n  ${FLAGS}\\n\"\n        resources:\n          requests:\n            memory: 200Mi\n            cpu: 150m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          runAsNonRoot: true\n        ports:\n        - containerPort: 8443\n        volumeMounts:\n        - mountPath: /var/run/configmaps/audit\n          name: audit-policies\n        - mountPath: /var/run/secrets/etcd-client\n          name: etcd-client\n        - mountPath: /var/run/configmaps/etcd-serving-ca\n          name: etcd-serving-ca\n        - mountPath: /var/run/configmaps/trusted-ca-bundle\n          name: trusted-ca-bundle\n        - mountPath: /var/run/secrets/serving-cert\n          name: serving-cert\n        - mountPath: /var/run/secrets/encryption-config\n          name: encryption-config\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n        livenessProbe:\n          initialDelaySeconds: 30\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: healthz\n        readinessProbe:\n          failureThreshold: 10\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: readyz\n      volumes:\n      - name: audit-policies\n        configMap:\n          name: audit-${REVISION}\n      - name: etcd-client\n        secret:\n          secretName: etcd-client\n      - name: etcd-serving-ca\n        configMap:\n          name: etcd-serving-ca\n      - name: serving-cert\n        secret:\n          secretName: serving-cert\n      - name: trusted-ca-bundle\n        configMap:\n          name: trusted-ca-bundle\n          optional: true\n          items:\n          - key: ca-bundle.crt\n            path: tls-ca-bundle.pem\n      - name: encryption-config\n        secret:\n          secretName: encryption-config-${REVISION}\n          optional: true\n      - name: audit-dir\n        emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "02833",
    "policy_id": "no_privileged",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: openshift-oauth-apiserver\n  name: apiserver\n  labels:\n    app: openshift-oauth-apiserver\n    apiserver: 'true'\nspec:\n  selector:\n    matchLabels:\n      app: openshift-oauth-apiserver\n      apiserver: 'true'\n  template:\n    metadata:\n      name: openshift-oauth-apiserver\n      labels:\n        app: openshift-oauth-apiserver\n        apiserver: 'true'\n    spec:\n      serviceAccountName: oauth-apiserver-sa\n      initContainers:\n      - name: fix-audit-permissions\n        image: ${IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - chmod 0700 /var/log/oauth-apiserver && touch /var/log/oauth-apiserver/audit.log\n          && chmod 0600 /var/log/oauth-apiserver/*\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 15m\n            memory: 50Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        volumeMounts:\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n      containers:\n      - name: oauth-apiserver\n        image: ${IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        command:\n        - /bin/bash\n        - -ec\n        args:\n        - \"if [ -s /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem ]; then\\n\\\n          \\  echo \\\"Copying system trust bundle\\\"\\n  cp -f /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem\\\n          \\ /etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem\\nfi\\nexec oauth-apiserver\\\n          \\ start \\\\\\n  --secure-port=8443 \\\\\\n  --audit-log-path=/var/log/oauth-apiserver/audit.log\\\n          \\ \\\\\\n  --audit-log-format=json \\\\\\n  --audit-log-maxsize=100 \\\\\\n  --audit-log-maxbackup=10\\\n          \\ \\\\\\n  --etcd-cafile=/var/run/configmaps/etcd-serving-ca/ca-bundle.crt\\\n          \\ \\\\\\n  --etcd-keyfile=/var/run/secrets/etcd-client/tls.key \\\\\\n  --etcd-certfile=/var/run/secrets/etcd-client/tls.crt\\\n          \\ \\\\\\n  --shutdown-delay-duration=3s \\\\\\n  --tls-private-key-file=/var/run/secrets/serving-cert/tls.key\\\n          \\ \\\\\\n  --tls-cert-file=/var/run/secrets/serving-cert/tls.crt \\\\\\n  ${FLAGS}\\n\"\n        resources:\n          requests:\n            memory: 200Mi\n            cpu: 150m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        ports:\n        - containerPort: 8443\n        volumeMounts:\n        - mountPath: /var/run/configmaps/audit\n          name: audit-policies\n        - mountPath: /var/run/secrets/etcd-client\n          name: etcd-client\n        - mountPath: /var/run/configmaps/etcd-serving-ca\n          name: etcd-serving-ca\n        - mountPath: /var/run/configmaps/trusted-ca-bundle\n          name: trusted-ca-bundle\n        - mountPath: /var/run/secrets/serving-cert\n          name: serving-cert\n        - mountPath: /var/run/secrets/encryption-config\n          name: encryption-config\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n        livenessProbe:\n          initialDelaySeconds: 30\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: healthz\n        readinessProbe:\n          failureThreshold: 10\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: readyz\n      volumes:\n      - name: audit-policies\n        configMap:\n          name: audit-${REVISION}\n      - name: etcd-client\n        secret:\n          secretName: etcd-client\n      - name: etcd-serving-ca\n        configMap:\n          name: etcd-serving-ca\n      - name: serving-cert\n        secret:\n          secretName: serving-cert\n      - name: trusted-ca-bundle\n        configMap:\n          name: trusted-ca-bundle\n          optional: true\n          items:\n          - key: ca-bundle.crt\n            path: tls-ca-bundle.pem\n      - name: encryption-config\n        secret:\n          secretName: encryption-config-${REVISION}\n          optional: true\n      - name: audit-dir\n        emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "02834",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: openshift-oauth-apiserver\n  name: apiserver\n  labels:\n    app: openshift-oauth-apiserver\n    apiserver: 'true'\nspec:\n  selector:\n    matchLabels:\n      app: openshift-oauth-apiserver\n      apiserver: 'true'\n  template:\n    metadata:\n      name: openshift-oauth-apiserver\n      labels:\n        app: openshift-oauth-apiserver\n        apiserver: 'true'\n    spec:\n      serviceAccountName: oauth-apiserver-sa\n      initContainers:\n      - name: fix-audit-permissions\n        image: ${IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - chmod 0700 /var/log/oauth-apiserver && touch /var/log/oauth-apiserver/audit.log\n          && chmod 0600 /var/log/oauth-apiserver/*\n        securityContext:\n          privileged: false\n          runAsNonRoot: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 15m\n            memory: 50Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        volumeMounts:\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n      containers:\n      - name: oauth-apiserver\n        image: ${IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        command:\n        - /bin/bash\n        - -ec\n        args:\n        - \"if [ -s /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem ]; then\\n\\\n          \\  echo \\\"Copying system trust bundle\\\"\\n  cp -f /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem\\\n          \\ /etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem\\nfi\\nexec oauth-apiserver\\\n          \\ start \\\\\\n  --secure-port=8443 \\\\\\n  --audit-log-path=/var/log/oauth-apiserver/audit.log\\\n          \\ \\\\\\n  --audit-log-format=json \\\\\\n  --audit-log-maxsize=100 \\\\\\n  --audit-log-maxbackup=10\\\n          \\ \\\\\\n  --etcd-cafile=/var/run/configmaps/etcd-serving-ca/ca-bundle.crt\\\n          \\ \\\\\\n  --etcd-keyfile=/var/run/secrets/etcd-client/tls.key \\\\\\n  --etcd-certfile=/var/run/secrets/etcd-client/tls.crt\\\n          \\ \\\\\\n  --shutdown-delay-duration=3s \\\\\\n  --tls-private-key-file=/var/run/secrets/serving-cert/tls.key\\\n          \\ \\\\\\n  --tls-cert-file=/var/run/secrets/serving-cert/tls.crt \\\\\\n  ${FLAGS}\\n\"\n        resources:\n          requests:\n            memory: 200Mi\n            cpu: 150m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          runAsNonRoot: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        ports:\n        - containerPort: 8443\n        volumeMounts:\n        - mountPath: /var/run/configmaps/audit\n          name: audit-policies\n        - mountPath: /var/run/secrets/etcd-client\n          name: etcd-client\n        - mountPath: /var/run/configmaps/etcd-serving-ca\n          name: etcd-serving-ca\n        - mountPath: /var/run/configmaps/trusted-ca-bundle\n          name: trusted-ca-bundle\n        - mountPath: /var/run/secrets/serving-cert\n          name: serving-cert\n        - mountPath: /var/run/secrets/encryption-config\n          name: encryption-config\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n        livenessProbe:\n          initialDelaySeconds: 30\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: healthz\n        readinessProbe:\n          failureThreshold: 10\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: readyz\n      volumes:\n      - name: audit-policies\n        configMap:\n          name: audit-${REVISION}\n      - name: etcd-client\n        secret:\n          secretName: etcd-client\n      - name: etcd-serving-ca\n        configMap:\n          name: etcd-serving-ca\n      - name: serving-cert\n        secret:\n          secretName: serving-cert\n      - name: trusted-ca-bundle\n        configMap:\n          name: trusted-ca-bundle\n          optional: true\n          items:\n          - key: ca-bundle.crt\n            path: tls-ca-bundle.pem\n      - name: encryption-config\n        secret:\n          secretName: encryption-config-${REVISION}\n          optional: true\n      - name: audit-dir\n        emptyDir: {}\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "02835",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: openshift-oauth-apiserver\n  name: apiserver\n  labels:\n    app: openshift-oauth-apiserver\n    apiserver: 'true'\nspec:\n  selector:\n    matchLabels:\n      app: openshift-oauth-apiserver\n      apiserver: 'true'\n  template:\n    metadata:\n      name: openshift-oauth-apiserver\n      labels:\n        app: openshift-oauth-apiserver\n        apiserver: 'true'\n    spec:\n      serviceAccountName: oauth-apiserver-sa\n      initContainers:\n      - name: fix-audit-permissions\n        image: ${IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - chmod 0700 /var/log/oauth-apiserver && touch /var/log/oauth-apiserver/audit.log\n          && chmod 0600 /var/log/oauth-apiserver/*\n        securityContext:\n          privileged: false\n          runAsNonRoot: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 15m\n            memory: 50Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        volumeMounts:\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n      containers:\n      - name: oauth-apiserver\n        image: ${IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        command:\n        - /bin/bash\n        - -ec\n        args:\n        - \"if [ -s /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem ]; then\\n\\\n          \\  echo \\\"Copying system trust bundle\\\"\\n  cp -f /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem\\\n          \\ /etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem\\nfi\\nexec oauth-apiserver\\\n          \\ start \\\\\\n  --secure-port=8443 \\\\\\n  --audit-log-path=/var/log/oauth-apiserver/audit.log\\\n          \\ \\\\\\n  --audit-log-format=json \\\\\\n  --audit-log-maxsize=100 \\\\\\n  --audit-log-maxbackup=10\\\n          \\ \\\\\\n  --etcd-cafile=/var/run/configmaps/etcd-serving-ca/ca-bundle.crt\\\n          \\ \\\\\\n  --etcd-keyfile=/var/run/secrets/etcd-client/tls.key \\\\\\n  --etcd-certfile=/var/run/secrets/etcd-client/tls.crt\\\n          \\ \\\\\\n  --shutdown-delay-duration=3s \\\\\\n  --tls-private-key-file=/var/run/secrets/serving-cert/tls.key\\\n          \\ \\\\\\n  --tls-cert-file=/var/run/secrets/serving-cert/tls.crt \\\\\\n  ${FLAGS}\\n\"\n        resources:\n          requests:\n            memory: 200Mi\n            cpu: 150m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          runAsNonRoot: true\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n        ports:\n        - containerPort: 8443\n        volumeMounts:\n        - mountPath: /var/run/configmaps/audit\n          name: audit-policies\n        - mountPath: /var/run/secrets/etcd-client\n          name: etcd-client\n        - mountPath: /var/run/configmaps/etcd-serving-ca\n          name: etcd-serving-ca\n        - mountPath: /var/run/configmaps/trusted-ca-bundle\n          name: trusted-ca-bundle\n        - mountPath: /var/run/secrets/serving-cert\n          name: serving-cert\n        - mountPath: /var/run/secrets/encryption-config\n          name: encryption-config\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n        livenessProbe:\n          initialDelaySeconds: 30\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: healthz\n        readinessProbe:\n          failureThreshold: 10\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: readyz\n      volumes:\n      - name: audit-policies\n        configMap:\n          name: audit-${REVISION}\n      - name: etcd-client\n        secret:\n          secretName: etcd-client\n      - name: etcd-serving-ca\n        configMap:\n          name: etcd-serving-ca\n      - name: serving-cert\n        secret:\n          secretName: serving-cert\n      - name: trusted-ca-bundle\n        configMap:\n          name: trusted-ca-bundle\n          optional: true\n          items:\n          - key: ca-bundle.crt\n            path: tls-ca-bundle.pem\n      - name: encryption-config\n        secret:\n          secretName: encryption-config-${REVISION}\n          optional: true\n      - name: audit-dir\n        emptyDir: {}\n      securityContext:\n        runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "02836",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: openshift-oauth-apiserver\n  name: apiserver\n  labels:\n    app: openshift-oauth-apiserver\n    apiserver: 'true'\nspec:\n  selector:\n    matchLabels:\n      app: openshift-oauth-apiserver\n      apiserver: 'true'\n  template:\n    metadata:\n      name: openshift-oauth-apiserver\n      labels:\n        app: openshift-oauth-apiserver\n        apiserver: 'true'\n    spec:\n      serviceAccountName: oauth-apiserver-sa\n      initContainers:\n      - name: fix-audit-permissions\n        image: ${IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - chmod 0700 /var/log/oauth-apiserver && touch /var/log/oauth-apiserver/audit.log\n          && chmod 0600 /var/log/oauth-apiserver/*\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 15m\n            memory: 50Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        volumeMounts:\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n      containers:\n      - name: oauth-apiserver\n        image: ${IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        command:\n        - /bin/bash\n        - -ec\n        args:\n        - \"if [ -s /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem ]; then\\n\\\n          \\  echo \\\"Copying system trust bundle\\\"\\n  cp -f /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem\\\n          \\ /etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem\\nfi\\nexec oauth-apiserver\\\n          \\ start \\\\\\n  --secure-port=8443 \\\\\\n  --audit-log-path=/var/log/oauth-apiserver/audit.log\\\n          \\ \\\\\\n  --audit-log-format=json \\\\\\n  --audit-log-maxsize=100 \\\\\\n  --audit-log-maxbackup=10\\\n          \\ \\\\\\n  --etcd-cafile=/var/run/configmaps/etcd-serving-ca/ca-bundle.crt\\\n          \\ \\\\\\n  --etcd-keyfile=/var/run/secrets/etcd-client/tls.key \\\\\\n  --etcd-certfile=/var/run/secrets/etcd-client/tls.crt\\\n          \\ \\\\\\n  --shutdown-delay-duration=3s \\\\\\n  --tls-private-key-file=/var/run/secrets/serving-cert/tls.key\\\n          \\ \\\\\\n  --tls-cert-file=/var/run/secrets/serving-cert/tls.crt \\\\\\n  ${FLAGS}\\n\"\n        resources:\n          requests:\n            memory: 200Mi\n            cpu: 150m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        ports:\n        - containerPort: 8443\n        volumeMounts:\n        - mountPath: /var/run/configmaps/audit\n          name: audit-policies\n        - mountPath: /var/run/secrets/etcd-client\n          name: etcd-client\n        - mountPath: /var/run/configmaps/etcd-serving-ca\n          name: etcd-serving-ca\n        - mountPath: /var/run/configmaps/trusted-ca-bundle\n          name: trusted-ca-bundle\n        - mountPath: /var/run/secrets/serving-cert\n          name: serving-cert\n        - mountPath: /var/run/secrets/encryption-config\n          name: encryption-config\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n        livenessProbe:\n          initialDelaySeconds: 30\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: healthz\n        readinessProbe:\n          failureThreshold: 10\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: readyz\n      volumes:\n      - name: audit-policies\n        configMap:\n          name: audit-${REVISION}\n      - name: etcd-client\n        secret:\n          secretName: etcd-client\n      - name: etcd-serving-ca\n        configMap:\n          name: etcd-serving-ca\n      - name: serving-cert\n        secret:\n          secretName: serving-cert\n      - name: trusted-ca-bundle\n        configMap:\n          name: trusted-ca-bundle\n          optional: true\n          items:\n          - key: ca-bundle.crt\n            path: tls-ca-bundle.pem\n      - name: encryption-config\n        secret:\n          secretName: encryption-config-${REVISION}\n          optional: true\n      - name: audit-dir\n        emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "02837",
    "policy_id": "set_requests_limits",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: openshift-oauth-apiserver\n  name: apiserver\n  labels:\n    app: openshift-oauth-apiserver\n    apiserver: 'true'\nspec:\n  selector:\n    matchLabels:\n      app: openshift-oauth-apiserver\n      apiserver: 'true'\n  template:\n    metadata:\n      name: openshift-oauth-apiserver\n      labels:\n        app: openshift-oauth-apiserver\n        apiserver: 'true'\n    spec:\n      serviceAccountName: oauth-apiserver-sa\n      initContainers:\n      - name: fix-audit-permissions\n        image: ${IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        command:\n        - sh\n        - -c\n        - chmod 0700 /var/log/oauth-apiserver && touch /var/log/oauth-apiserver/audit.log\n          && chmod 0600 /var/log/oauth-apiserver/*\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        resources:\n          requests:\n            cpu: 15m\n            memory: 50Mi\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        volumeMounts:\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n      containers:\n      - name: oauth-apiserver\n        image: ${IMAGE}:stable\n        imagePullPolicy: IfNotPresent\n        command:\n        - /bin/bash\n        - -ec\n        args:\n        - \"if [ -s /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem ]; then\\n\\\n          \\  echo \\\"Copying system trust bundle\\\"\\n  cp -f /var/run/configmaps/trusted-ca-bundle/tls-ca-bundle.pem\\\n          \\ /etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem\\nfi\\nexec oauth-apiserver\\\n          \\ start \\\\\\n  --secure-port=8443 \\\\\\n  --audit-log-path=/var/log/oauth-apiserver/audit.log\\\n          \\ \\\\\\n  --audit-log-format=json \\\\\\n  --audit-log-maxsize=100 \\\\\\n  --audit-log-maxbackup=10\\\n          \\ \\\\\\n  --etcd-cafile=/var/run/configmaps/etcd-serving-ca/ca-bundle.crt\\\n          \\ \\\\\\n  --etcd-keyfile=/var/run/secrets/etcd-client/tls.key \\\\\\n  --etcd-certfile=/var/run/secrets/etcd-client/tls.crt\\\n          \\ \\\\\\n  --shutdown-delay-duration=3s \\\\\\n  --tls-private-key-file=/var/run/secrets/serving-cert/tls.key\\\n          \\ \\\\\\n  --tls-cert-file=/var/run/secrets/serving-cert/tls.crt \\\\\\n  ${FLAGS}\\n\"\n        resources:\n          requests:\n            memory: 200Mi\n            cpu: 150m\n          limits:\n            cpu: 500m\n            memory: 256Mi\n        securityContext:\n          privileged: false\n          capabilities:\n            drop:\n            - NET_RAW\n            - NET_ADMIN\n            - SYS_ADMIN\n            - SYS_MODULE\n            - SYS_PTRACE\n            - SYS_CHROOT\n          allowPrivilegeEscalation: false\n          runAsNonRoot: true\n          readOnlyRootFilesystem: true\n        ports:\n        - containerPort: 8443\n        volumeMounts:\n        - mountPath: /var/run/configmaps/audit\n          name: audit-policies\n        - mountPath: /var/run/secrets/etcd-client\n          name: etcd-client\n        - mountPath: /var/run/configmaps/etcd-serving-ca\n          name: etcd-serving-ca\n        - mountPath: /var/run/configmaps/trusted-ca-bundle\n          name: trusted-ca-bundle\n        - mountPath: /var/run/secrets/serving-cert\n          name: serving-cert\n        - mountPath: /var/run/secrets/encryption-config\n          name: encryption-config\n        - mountPath: /var/log/oauth-apiserver\n          name: audit-dir\n        livenessProbe:\n          initialDelaySeconds: 30\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: healthz\n        readinessProbe:\n          failureThreshold: 10\n          httpGet:\n            scheme: HTTPS\n            port: 8443\n            path: readyz\n      volumes:\n      - name: audit-policies\n        configMap:\n          name: audit-${REVISION}\n      - name: etcd-client\n        secret:\n          secretName: etcd-client\n      - name: etcd-serving-ca\n        configMap:\n          name: etcd-serving-ca\n      - name: serving-cert\n        secret:\n          secretName: serving-cert\n      - name: trusted-ca-bundle\n        configMap:\n          name: trusted-ca-bundle\n          optional: true\n          items:\n          - key: ca-bundle.crt\n            path: tls-ca-bundle.pem\n      - name: encryption-config\n        secret:\n          secretName: encryption-config-${REVISION}\n          optional: true\n      - name: audit-dir\n        emptyDir: {}\n",
    "errors": []
  },
  {
    "id": "02838",
    "policy_id": "no_latest_tag",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: readiness-pod\n  labels:\n    test: readiness\n  namespace: default\nspec:\n  containers:\n  - name: readiness\n    env:\n    - name: APP_START_DELAY\n      value: '60'\n    image: kodekloud/webapp-delayed-start:stable\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    imagePullPolicy: Always\n    ports:\n    - containerPort: 8080\n      protocol: TCP\n    readinessProbe:\n      httpGet:\n        path: /ready\n        port: 8080\n      initialDelaySeconds: 30\n      periodSeconds: 5\n    securityContext:\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      privileged: false\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n      readOnlyRootFilesystem: true\n",
    "errors": []
  },
  {
    "id": "02839",
    "policy_id": "read_only_root_fs",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: readiness-pod\n  labels:\n    test: readiness\n  namespace: default\nspec:\n  containers:\n  - name: readiness\n    env:\n    - name: APP_START_DELAY\n      value: '60'\n    image: kodekloud/webapp-delayed-start:stable\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    imagePullPolicy: Always\n    ports:\n    - containerPort: 8080\n      protocol: TCP\n    readinessProbe:\n      httpGet:\n        path: /ready\n        port: 8080\n      initialDelaySeconds: 30\n      periodSeconds: 5\n    securityContext:\n      readOnlyRootFilesystem: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      runAsNonRoot: true\n",
    "errors": []
  },
  {
    "id": "02840",
    "policy_id": "run_as_non_root",
    "accepted": true,
    "ok_schema": true,
    "ok_policy": true,
    "ok_safety": true,
    "ok_rescan": true,
    "patched_yaml": "apiVersion: v1\nkind: Pod\nmetadata:\n  name: readiness-pod\n  labels:\n    test: readiness\n  namespace: default\nspec:\n  containers:\n  - name: readiness\n    env:\n    - name: APP_START_DELAY\n      value: '60'\n    image: kodekloud/webapp-delayed-start:stable\n    resources:\n      requests:\n        cpu: 100m\n        memory: 128Mi\n      limits:\n        cpu: 500m\n        memory: 256Mi\n    imagePullPolicy: Always\n    ports:\n    - containerPort: 8080\n      protocol: TCP\n    readinessProbe:\n      httpGet:\n        path: /ready\n        port: 8080\n      initialDelaySeconds: 30\n      periodSeconds: 5\n    securityContext:\n      runAsNonRoot: true\n      privileged: false\n      capabilities:\n        drop:\n        - NET_RAW\n        - NET_ADMIN\n        - SYS_ADMIN\n        - SYS_MODULE\n        - SYS_PTRACE\n        - SYS_CHROOT\n      allowPrivilegeEscalation: false\n      readOnlyRootFilesystem: true\n",
    "errors": []
  }
]