apiVersion: v1
kind: ConfigMap
metadata:
  name: node-local-dns
  namespace: kube-system
data:
  Corefile: "{{ .Values.domain }}:53 {\n    errors\n    cache {\n            success\
    \ 9984 30\n            denial 9984 5\n    }\n    reload\n    loop\n    bind {{\
    \ .Values.nodeLocal }} {{ .Values.dnsServer }}\n    forward . {{ .Values.clusterDNS\
    \ }} {\n            force_tcp\n    }\n    prometheus :{{ .Values.prometheus.port\
    \ }}\n    health {{ .Values.nodeLocal }}:8080\n    }\nin-addr.arpa:53 {\n    errors\n\
    \    cache 30\n    reload\n    loop\n    bind {{ .Values.nodeLocal }} {{ .Values.dnsServer\
    \ }}\n    forward . {{ .Values.clusterDNS }} {\n            force_tcp\n    }\n\
    \    prometheus :{{ .Values.prometheus.port }}\n    }\nip6.arpa:53 {\n    errors\n\
    \    cache 30\n    reload\n    loop\n    bind {{ .Values.nodeLocal }} {{ .Values.dnsServer\
    \ }}\n    forward . {{ .Values.clusterDNS }} {\n            force_tcp\n    }\n\
    \    prometheus :{{ .Values.prometheus.port }}\n    }\n.:53 {\n    errors\n  \
    \  cache 30\n    reload\n    loop\n    bind {{ .Values.nodeLocal }} {{ .Values.dnsServer\
    \ }}\n    forward . __PILLAR__UPSTREAM__SERVERS__ {\n            force_tcp\n \
    \   }\n    prometheus :{{ .Values.prometheus.port }}\n    }"
